!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="https://assets.smcdn.cn/sheet/",n(n.s=700)}({0:function(t,e){t.exports=React},1:function(t,e,n){"use strict";var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},i=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(e,"__esModule",{value:!0});var s=n(18),c=n(38),u={},l=function(t){return u[t]||(u[t]=d()),u[t]};e.getS18n=l;var p=function(){u={}};e.DEBUG_reset=p;var f=function(){return u};e.DEBUG_getInstances=f;var d=function(){var t,e,n="zh-CN",u="zh-CN",d={},h=function(t,e){if(!s.isValidLocaleResource(e))throw new Error("fetched locale resource is invalid");d[t]=r(r({},d[t]||{}),e)},m=function(t,n){return o(void 0,void 0,void 0,function(){var r;return i(this,function(o){switch(o.label){case 0:return!n&&d[t]?[3,2]:e?[4,e(t)]:[3,2];case 1:r=o.sent(),h(t,r),o.label=2;case 2:return[2]}})})},v=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("string"==typeof t[0]){var r=t[0],o=t[1],i=o&&"string"==typeof o._?o._:void 0,s=i?r+"#"+i:r;if(!s)return"";var l=c.getTextResult(s,d[n]);if("string"==typeof l)return l;var p=c.getTextResult(s,d[u]);return"string"==typeof p?p:r}if(t[0]&&"number"==typeof t[0].length){var f=t[0],h=t.slice(1);return c.getInterpolateResult(f,h,d[n])||c.getInterpolateResult(f,h,d[u])||c.interweave(f,h)}return console.warn.apply(console,a(["[s18n] invalid input:"],t)),""};return v.configure=function(n){if(n.fetchLocale){if("function"!=typeof n.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");e=n.fetchLocale}if(n.fetchLocaleSync){if("function"!=typeof n.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");t=n.fetchLocaleSync}},v.addLocaleResource=h,v.setLocaleAsync=function(t,e){return o(void 0,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:if("string"!=typeof t)throw new Error("'locale' is required");return[4,m(t)];case 1:return r.sent(),n=t,"string"==typeof e&&(m(e),u=e),[2]}})})},v.setLocaleSync=function(e){if("string"!=typeof e)throw new Error("'locale' is required");if(t){var r=t(e);h(e,r)}n=e},v.getLocale=function(){return n},v.DEBUG_getLocaleResources=function(){return d},v.getS18n=l,v.DEBUG_reset=p,v.DEBUG_getInstances=f,v},h=l("__default_namespace__");t.exports=h,e.default=h},10:function(t,e){t.exports=function(t){return!!t&&"object"==typeof t}},100:function(t,e){t.exports=function(t){return this.__data__.get(t)}},101:function(t,e){t.exports=function(t){return this.__data__.has(t)}},102:function(t,e,n){var r=n(13),o=n(31),i=200;t.exports=function(t,e){var n=this.__data__;return n instanceof r&&n.__data__.length==i&&(n=this.__data__=new o(n.__data__)),n.set(t,e),this}},103:function(t,e,n){var r=n(104),o=n(13),i=n(40);t.exports=function(){this.__data__={hash:new r,map:new(i||o),string:new r}}},104:function(t,e,n){var r=n(105),o=n(106),i=n(107),a=n(108),s=n(109);function c(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,t.exports=c},105:function(t,e,n){var r=n(15);t.exports=function(){this.__data__=r?r(null):{}}},106:function(t,e){t.exports=function(t){return this.has(t)&&delete this.__data__[t]}},107:function(t,e,n){var r=n(15),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===o?void 0:n}return i.call(e,t)?e[t]:void 0}},108:function(t,e,n){var r=n(15),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:o.call(e,t)}},109:function(t,e,n){var r=n(15),o="__lodash_hash_undefined__";t.exports=function(t,e){return this.__data__[t]=r&&void 0===e?o:e,this}},11:function(t,e,n){"use strict";e.h=function(t){var e=document.createEvent("Event");e.initEvent("click",!0,!0),t.dispatchEvent(e)},e.e=function(t){return/^http:\/\//.test(t)},e.g=function(t,e){return new Array(e+1).join(t)},n.d(e,"d",function(){return i}),n.d(e,"c",function(){return a}),n.d(e,"f",function(){return s}),e.b=function(t,e){var n="";if(t&&e){var r=e.permissions.query.shimo.getFilePermission(),i=!r||r.permissions.editable,a=!r||r.permissions.commentable;i||(n=a?o()("只评模式下不可使用"):o()("只读模式下不可使用"))}return n},e.a=function(t){var e=c.get(t);if(null!=e)return e;var n=document.createElement("canvas").getContext("2d");n.font="bold 12px Arial";var r=n.measureText(t).width+28,o=Math.ceil(r);return c.set(t,o),o};var r=n(1),o=n.n(r);var i="ActiveXObject"in window,a=window.navigator.userAgent.indexOf("Edge")>-1,s=window.navigator.userAgent.indexOf("Windows")>-1;var c=new Map},110:function(t,e,n){var r=n(16);t.exports=function(t){return r(this,t).delete(t)}},111:function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},112:function(t,e,n){var r=n(16);t.exports=function(t){return r(this,t).get(t)}},113:function(t,e,n){var r=n(16);t.exports=function(t){return r(this,t).has(t)}},114:function(t,e,n){var r=n(16);t.exports=function(t,e){return r(this,t).set(t,e),this}},115:function(t,e,n){var r=n(67);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},116:function(t,e,n){var r=n(122);t.exports=function(t){var e=r(t),n=e%1;return e==e?n?e-n:e:0}},1182:function(t,e,n){"use strict";var r;!function(t){t.InsertRemarks="InsertRemarks",t.RemoveRemarks="RemoveRemarks",t.RemarksEditorMounted="RemarksEditorMounted"}(r||(r={})),e.a=r},12:function(t,e,n){var r=n(41),o=n(81),i=n(68),a=n(17),s=n(34),c=n(36);t.exports=function(t){var e=c(t);if(!e&&!a(t))return o(t);var n=i(t),u=!!n,l=n||[],p=l.length;for(var f in t)!r(t,f)||u&&("length"==f||s(f,p))||e&&"constructor"==f||l.push(f);return l}},120:function(t,e){var n="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,n),this}},121:function(t,e){t.exports=function(t){return this.__data__.has(t)}},122:function(t,e,n){var r=n(61),o=1/0,i=1.7976931348623157e308;t.exports=function(t){return t?(t=r(t))===o||t===-o?(t<0?-1:1)*i:t==t?t:0:0===t?t:0}},123:function(t,e,n){"use strict";var r;n.d(e,"b",function(){return r}),e.a=function(t){r=t}},126:function(t,e,n){var r=n(46),o=n(57),i=n(128),a=n(129),s=n(42),c=n(5),u=n(28),l=n(130),p=2,f="[object Arguments]",d="[object Array]",h="[object Object]",m=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,v,b,_){var g=c(t),y=c(e),x=d,w=d;g||(x=(x=s(t))==f?h:x),y||(w=(w=s(e))==f?h:w);var E=x==h&&!u(t),k=w==h&&!u(e),C=x==w;if(C&&!E)return _||(_=new r),g||l(t)?o(t,e,n,v,b,_):i(t,e,x,n,v,b,_);if(!(b&p)){var O=E&&m.call(t,"__wrapped__"),T=k&&m.call(e,"__wrapped__");if(O||T){var S=O?t.value():t,A=T?e.value():e;return _||(_=new r),n(S,A,v,b,_)}}return!!C&&(_||(_=new r),a(t,e,n,v,b,_))}},127:function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},128:function(t,e,n){var r=n(47),o=n(67),i=n(57),a=n(48),s=n(45),c=1,u=2,l="[object Boolean]",p="[object Date]",f="[object Error]",d="[object Map]",h="[object Number]",m="[object RegExp]",v="[object Set]",b="[object String]",_="[object Symbol]",g="[object ArrayBuffer]",y="[object DataView]",x=r?r.prototype:void 0,w=x?x.valueOf:void 0;t.exports=function(t,e,n,r,x,E,k){switch(n){case y:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case g:return!(t.byteLength!=e.byteLength||!r(new o(t),new o(e)));case l:case p:return+t==+e;case f:return t.name==e.name&&t.message==e.message;case h:return t!=+t?e!=+e:t==+e;case m:case b:return t==e+"";case d:var C=a;case v:var O=E&u;if(C||(C=s),t.size!=e.size&&!O)return!1;var T=k.get(t);return T?T==e:(E|=c,k.set(t,e),i(C(t),C(e),r,x,E,k));case _:if(w)return w.call(t)==w.call(e)}return!1}},129:function(t,e,n){var r=n(41),o=n(12),i=2;t.exports=function(t,e,n,a,s,c){var u=s&i,l=o(t),p=l.length;if(p!=o(e).length&&!u)return!1;for(var f=p;f--;){var d=l[f];if(!(u?d in e:r(e,d)))return!1}var h=c.get(t);if(h)return h==e;var m=!0;c.set(t,e);for(var v=u;++f<p;){var b=t[d=l[f]],_=e[d];if(a)var g=u?a(_,b,d,e,t,c):a(b,_,d,t,e,c);if(!(void 0===g?b===_||n(b,_,a,s,c):g)){m=!1;break}v||(v="constructor"==d)}if(m&&!v){var y=t.constructor,x=e.constructor;y!=x&&"constructor"in t&&"constructor"in e&&!("function"==typeof y&&y instanceof y&&"function"==typeof x&&x instanceof x)&&(m=!1)}return c.delete(t),m}},13:function(t,e,n){var r=n(93),o=n(94),i=n(95),a=n(96),s=n(97);function c(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,t.exports=c},130:function(t,e,n){var r=n(20),o=n(10),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;var a=Object.prototype.toString;t.exports=function(t){return o(t)&&r(t.length)&&!!i[a.call(t)]}},131:function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},132:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(58),a=n(11),s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(t){function e(e){var n=t.call(this,e)||this;return n.onOpen=function(t){n.props.onOpen&&n.props.onOpen(),t&&(t.markAsOld(),n.forceUpdate())},n}return s(e,t),e.prototype.render=function(){var t=function(t){return t?(t instanceof Array?t:[t]).find(function(t){return t.visible}):void 0}(this.props.feature),e=t&&t.tooltip,n=this.props.tabName(),r=Object(a.a)(n);return o.a.createElement(i.a,{head:o.a.createElement("span",{className:"tabMenuHead",style:{width:r}},n,e),customClass:"tabMenu tab-"+this.props.tab,smattr:this.props.smattr,disabled:this.props.disabled,onOpen:this.onOpen.bind(this,t),editor:this.props.editor,tab:this.props.tab},this.props.children)},e.compName="TabMenu",e}(o.a.Component);e.a=c},133:function(t,e,n){"use strict";e.a=function(t){return o.a.createElement(i.a,{head:o.a.cloneElement(t.head,{className:"dropMenuHead indicator "+(t.head.props.className||"")}),disabled:t.disabled,customClass:t.customClass,onClose:t.onClose,onOpen:t.onOpen,smattr:t.smattr},t.children)};var r=n(0),o=n.n(r),i=n(58)},134:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(11),a=n(2),s=(n.n(a),n(27)),c=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),u=a.sheets.menu.MenuContext,l=function(t){function e(e){var n=t.call(this,e)||this;return n.showSubMenu=function(){!n.props.disabled&&n.setState({showSubMenu:!0})},n.hideSubMenu=function(){n.setState({showSubMenu:!1})},n.state={showSubMenu:!1},n}return c(e,t),e.prototype.render=function(){this.checkShowSubStatus();var t=this.props,e=t.editor,n=t.disabled,r=Object(i.b)(!!n,e),a=this.context.searchResultPath.split("->").indexOf(this.props.text)>-1?"menuItem--highlight":"",c=this.state.showSubMenu;return o.a.createElement("div",{ref:"containerDom",className:"menu--submenu",onMouseLeave:this.hideSubMenu},o.a.createElement("div",{ref:"itemDom",className:"menuItem "+(this.props.disabled?"disabled":"")+" "+a,onMouseEnter:this.showSubMenu},void 0!==this.props.icon&&o.a.createElement("span",{className:"menuItem--icon "+(this.props.icon?"icon--"+this.props.icon:"")}),o.a.createElement("span",{className:"menuItem--text"},this.props.text),o.a.createElement("span",{className:"menuItem--placer"}),o.a.createElement("span",{className:"menuItem--arrow"})),o.a.createElement(s.a,{showPopup:c,itemDom:this.refs.itemDom},this.props.children),r)},e.prototype.checkShowSubStatus=function(){if(!!this.context.searchResultPath&&!!this.context.searchResultPath.length){var t=this.context.searchResultPath.split("->"),e=t.indexOf(this.props.text),n=e>-1&&e<t.length-1;this.state.showSubMenu!==n&&this.setState({showSubMenu:n})}},e.compName="SubMenu",e}(o.a.Component);e.a=l,l.contextType=u},135:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(3),a=n.n(i),s=n(59),c=n(11),u=n(2),l=(n.n(u),n(27)),p=n(60),f=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=u.sheets.menu.MenuContext,h=function(t){function e(e){var n=t.call(this,e)||this;return n.hideTooltip=function(){n.setState({showTooltip:!1})},n.showTooltip=function(){n.setState({showTooltip:!0})},n.state={showTooltip:!1,showHighlight:!1},n}return f(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.disabled,r=e.customClass,i=e.active,a="fake"===n?"fakeDisabled":n?"disabled":"",s=r||"",c=this.props.className||"",u=this.props.isSearchItem?"item--search-result":"",l=i?"active":"";return o.a.createElement(d.Consumer,null,function(e){return o.a.createElement("div",{className:"menuItem tooltip--docker "+a+" "+s+" "+c+" "+function(e){var n,r=e.searchResultPath.split("->"),o=t.props.searchDisplay||t.props.text;return(null===(n=o)||void 0===n?void 0:n.length)&&r[r.length-1]===o&&!t.props.isSearchItem?"menuItem--highlight":""}(e)+" "+l+" "+u,onClick:function(n){return t.onClick(n,e)},"data-smattr":t.props.smattr,onMouseLeave:t.hideTooltip,onMouseEnter:t.showTooltip},void 0!==t.props.checked&&o.a.createElement("span",{className:"menuItem--check "+(t.props.checked?"menuItem--check__checked":"")}),void 0!==t.props.icon&&t.getIcon(t.props.icon),t.props.text&&o.a.createElement("span",{className:"menuItem--text"},t.props.text),t.props.showEnterpriseLabel&&!1,t.props.text&&!c.includes("fontDisplayImg")&&o.a.createElement("span",{className:"menuItem--placer"}),t.props.children,t.MenuTip)})},e.prototype.componentDidMount=function(){this.scrollHighlightItem()},e.prototype.componentDidUpdate=function(){this.scrollHighlightItem()},e.prototype.scrollHighlightItem=function(){var t=a.a.findDOMNode(this);t&&t.classList.contains("menuItem--highlight")&&setTimeout(function(){t.scrollIntoView(!1)})},Object.defineProperty(e.prototype,"MenuTip",{get:function(){var t=this.props,e=t.disabled,n=t.editor,r=t.tip,i=this.state.showTooltip,s=Object(c.b)(!!e,n)||r,u="string"==typeof s;return s?o.a.createElement(l.a,{showPopup:i,itemDom:a.a.findDOMNode(this),className:"menu--tooltip-popup"+(u?" normal--tip":"")},u?o.a.createElement("div",{className:"menu-normal-tip-wrapper",style:{position:"relative",display:"flex",alignItems:"center"}},o.a.createElement(p.a,{option:s,direction:"right"})):s):null},enumerable:!0,configurable:!0}),e.prototype.onClick=function(t,e){!this.props.disabled&&this.props.onTap&&this.props.onTap(t),this.props.stopPropagation||setTimeout(function(){return e.closeMenu()})},e.prototype.getIcon=function(t){return Object(c.e)(t)?o.a.createElement("span",{className:"menuItem--icon",style:Object(s.a)(t)}):o.a.createElement("span",{className:"menuItem--icon "+(t?"icon--"+t:"")})},e.compName="MenuItem",e}(o.a.Component);e.a=h,h.contextType=d},136:function(t,e,n){"use strict";e.a=function(){return o.a.createElement("div",{className:"menu--divider"})};var r=n(0),o=n.n(r)},137:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(11),a=n(59),s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onTap=function(){e.props.onTap&&e.props.onTap()},e}return s(e,t),e.prototype.render=function(){var t="toolBar--iconBtn "+(this.props.disabled?"disabled":"")+" "+(this.props.selected?"selected":"")+" indicator";return this.props.children?o.a.createElement("span",{className:t+" tooltip--docker",onClick:this.onTap,"data-smattr":this.props.smattr},this.getIcon(this.props.icon)):this.props.tooltip?o.a.createElement("span",{className:t,"data-tooltip":this.props.tooltip,onClick:this.onTap,"data-smattr":this.props.smattr},this.getIcon(this.props.icon)):o.a.createElement("span",{className:t,onClick:this.onTap,"data-smattr":this.props.smattr},this.getIcon(this.props.icon))},e.prototype.getIcon=function(t){return Object(i.e)(t)?o.a.createElement("span",{style:Object(a.a)(t)},this.props.children):o.a.createElement("span",{className:"toolBar--icon icon--"+t},this.props.children)},e}(o.a.Component);e.a=c},138:function(t,e,n){"use strict";e.d=function(t){return o.a.createElement("span",{className:u(t,"toolBar--tool")},t.children)},n.d(e,"c",function(){return l}),e.a=function(t){return o.a.createElement("span",{className:u(t,"toolBar--iconDropTool indicator "+(t.selected?"fakeIndicator":""))},t.children)},e.b=function(t){return o.a.createElement("span",{className:u(t,"toolBar--tool toolBar--tool__oneline")},t.children)},e.e=function(t){return o.a.createElement("span",{className:u(t,"toolBar--tool toolBar--tool__twolines")},t.children)};var r=n(0),o=n.n(r),i=n(11),a=n(21),s=n.n(a),c=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function u(t,e){var n,r=t.disabled,o=t.customClass;return s()(((n={})[e]=!0,n[o||""]=o,n.disabled=r,n))}var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delegateClick=function(t){var n=e.refs.textTool,r=n.lastElementChild;if(t.target===n||t.target===r){var o=n.querySelector(".toolBar--icon");setTimeout(function(){return Object(i.h)(o)})}},e}return c(e,t),e.prototype.render=function(){return o.a.createElement("span",{ref:"textTool",className:u(this.props,"toolBar--tool toolBar--textTool"),onClick:this.delegateClick},this.props.children)},e}(o.a.Component)},14:function(t,e,n){var r=n(33);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},141:function(t,e,n){var r=n(92),o=n(171);t.exports=function t(e,n,i,a,s){var c=-1,u=e.length;for(i||(i=o),s||(s=[]);++c<u;){var l=e[c];n>0&&i(l)?n>1?t(l,n-1,i,a,s):r(s,l):a||(s[s.length]=l)}return s}},145:function(t,e,n){"use strict";n.p=("string"==typeof __SM_CDN_HOST__?__SM_CDN_HOST__:"https://assets.smcdn.cn")+"/sheet/"},148:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isRetina=function(){return window.devicePixelRatio>=2},e.isDingTalk=function(){return/dingtalk/i.test(n)},e.isDingtalk=function(){return!!n.match(/mobile.*dingtalk/i)},e.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},e.isWechatPc=r,e.isWxworkPc=o,e.isWechat=function(){return!!/micromessenger/.test(n)&&!r()},e.isMobile=function(){return!r()&&!o()&&!!n.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},e.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},e.isIOS=i,e.isAndroid=function(){return!!/(android)/g.test(n)},e.isAndroidApp=function(){return!!/shimo-android-app/g.test(n)},e.isIE=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},e.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},e.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},e.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},e.isWebIOS=function(){if(!window.cow.iOS&&i())return!0;return!1},e.isIphone6=function(){var t=!1;i()&&screen.height>568&&(t=!0);return t},e.isInWxMp=function(){return!(!navigator.userAgent.match(/micromessenger/i)||!navigator.userAgent.match(/miniprogram/i))||"miniprogram"===window.__wxjs_environment};var n=window.navigator.userAgent.toLowerCase();function r(){return!!/micromessenger.*?windowswechat/.test(n)}function o(){return!!/wxwork.*?micromessenger.*?wechat/i.test(n)}function i(){return!!/(ipad|iphone|ipod)/g.test(n)}},15:function(t,e,n){var r=n(8)(Object,"create");t.exports=r},152:function(t,e){var n=Object.getOwnPropertySymbols;function r(t){return n(Object(t))}n||(r=function(){return[]}),t.exports=r},159:function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length;++n<r&&!1!==e(t[n],n,t););return t}},16:function(t,e,n){var r=n(111);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},161:function(t,e,n){var r=n(66);t.exports=function(t,e){return r(t,e)}},162:function(t,e,n){var r=n(74),o=n(141),i=n(172),a=n(78),s=n(30),c=a(function(t,e){return null==t?{}:i(t,r(o(e,1),s))});t.exports=c},169:function(t,e,n){(function(t){var r=n(179),o=n(4),i={function:!0,object:!0},a=i[typeof e]&&e&&!e.nodeType?e:void 0,s=i[typeof t]&&t&&!t.nodeType?t:void 0,c=(s&&s.exports===a?a:void 0)?o.Buffer:void 0,u=c?function(t){return t instanceof c}:r(!1);t.exports=u}).call(e,n(32)(t))},17:function(t,e,n){var r=n(73),o=n(19),i=n(20);t.exports=function(t){return null!=t&&i(r(t))&&!o(t)}},171:function(t,e,n){var r=n(29),o=n(5);t.exports=function(t){return o(t)||r(t)}},172:function(t,e,n){var r=n(65);t.exports=function(t,e){return t=Object(t),r(e,function(e,n){return n in t&&(e[n]=t[n]),e},{})}},179:function(t,e){t.exports=function(t){return function(){return t}}},18:function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(37);e.isValidLocaleResource=function(t){return!!t&&(!Array.isArray(t)&&("object"===(void 0===t?"undefined":r(t))&&Object.keys(t).every(function(e){var n=t[e];return null==n||"string"==typeof n||"object"===(void 0===n?"undefined":r(n))})))},e.sourceTextToKey=function(t){switch(t.type){case"string":var e=t.id,n=t.text;return e?n+"#"+e:n;case"interpolated":var r=t.textParts.length;return 1===r?t.textParts[0]:2===r?t.textParts[0]+"%s"+t.textParts[1]:t.textParts.map(function(e,n){return n===t.textParts.length-1?e:e+"%"+(n+1)}).join("");default:return o.assertNever(t)}}},19:function(t,e,n){var r=n(6),o="[object Function]",i="[object GeneratorFunction]",a=Object.prototype.toString;t.exports=function(t){var e=r(t)?a.call(t):"";return e==o||e==i}},192:function(t,e,n){var r=n(46),o=n(159),i=n(64),a=n(197),s=n(198),c=n(199),u=n(200),l=n(201),p=n(42),f=n(203),d=n(204),h=n(213),m=n(5),v=n(169),b=n(28),_=n(6),g=n(12),y="[object Arguments]",x="[object Function]",w="[object GeneratorFunction]",E="[object Object]",k={};k[y]=k["[object Array]"]=k["[object ArrayBuffer]"]=k["[object DataView]"]=k["[object Boolean]"]=k["[object Date]"]=k["[object Float32Array]"]=k["[object Float64Array]"]=k["[object Int8Array]"]=k["[object Int16Array]"]=k["[object Int32Array]"]=k["[object Map]"]=k["[object Number]"]=k[E]=k["[object RegExp]"]=k["[object Set]"]=k["[object String]"]=k["[object Symbol]"]=k["[object Uint8Array]"]=k["[object Uint8ClampedArray]"]=k["[object Uint16Array]"]=k["[object Uint32Array]"]=!0,k["[object Error]"]=k[x]=k["[object WeakMap]"]=!1,t.exports=function t(e,n,C,O,T,S,A){var R;if(O&&(R=S?O(e,T,S,A):O(e)),void 0!==R)return R;if(!_(e))return e;var j=m(e);if(j){if(R=f(e),!n)return c(e,R)}else{var M=p(e),I=M==x||M==w;if(v(e))return s(e,n);if(M==E||M==y||I&&!S){if(b(e))return S?e:{};if(R=h(I?{}:e),!n)return u(e,a(R,e))}else{if(!k[M])return S?e:{};R=d(e,M,t,n)}}A||(A=new r);var N=A.get(e);if(N)return N;if(A.set(e,R),!j)var L=C?l(e):g(e);return o(L||e,function(r,o){L&&(r=e[o=r]),i(R,o,t(r,n,C,O,o,e,A))}),R}},196:function(t,e,n){var r=n(192);t.exports=function(t){return r(t,!0,!0)}},197:function(t,e,n){var r=n(77),o=n(12);t.exports=function(t,e){return t&&r(e,o(e),t)}},198:function(t,e){t.exports=function(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}},199:function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},2:function(t,e){t.exports=shimo.sdk.sheet},20:function(t,e){var n=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}},200:function(t,e,n){var r=n(77),o=n(152);t.exports=function(t,e){return r(t,o(t),e)}},201:function(t,e,n){var r=n(202),o=n(152),i=n(12);t.exports=function(t){return r(t,i,o)}},202:function(t,e,n){var r=n(92),o=n(5);t.exports=function(t,e,n){var i=e(t);return o(t)?i:r(i,n(t))}},203:function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,r=t.constructor(e);return e&&"string"==typeof t[0]&&n.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},204:function(t,e,n){var r=n(115),o=n(205),i=n(206),a=n(208),s=n(209),c=n(211),u=n(212),l="[object Boolean]",p="[object Date]",f="[object Map]",d="[object Number]",h="[object RegExp]",m="[object Set]",v="[object String]",b="[object Symbol]",_="[object ArrayBuffer]",g="[object DataView]",y="[object Float32Array]",x="[object Float64Array]",w="[object Int8Array]",E="[object Int16Array]",k="[object Int32Array]",C="[object Uint8Array]",O="[object Uint8ClampedArray]",T="[object Uint16Array]",S="[object Uint32Array]";t.exports=function(t,e,n,A){var R=t.constructor;switch(e){case _:return r(t);case l:case p:return new R(+t);case g:return o(t,A);case y:case x:case w:case E:case k:case C:case O:case T:case S:return u(t,A);case f:return i(t,A,n);case d:case v:return new R(t);case h:return a(t);case m:return s(t,A,n);case b:return c(t)}}},205:function(t,e,n){var r=n(115);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},206:function(t,e,n){var r=n(207),o=n(65),i=n(48);t.exports=function(t,e,n){var a=e?n(i(t),!0):i(t);return o(a,r,new t.constructor)}},207:function(t,e){t.exports=function(t,e){return t.set(e[0],e[1]),t}},208:function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},209:function(t,e,n){var r=n(210),o=n(65),i=n(45);t.exports=function(t,e,n){var a=e?n(i(t),!0):i(t);return o(a,r,new t.constructor)}},21:function(t,e,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var t=[],e=0;e<arguments.length;e++){var r=arguments[e];if(r){var i=typeof r;if("string"===i||"number"===i)t.push(r);else if(Array.isArray(r)&&r.length){var a=o.apply(null,r);a&&t.push(a)}else if("object"===i)for(var s in r)n.call(r,s)&&r[s]&&t.push(s)}}return t.join(" ")}void 0!==t&&t.exports?(o.default=o,t.exports=o):void 0===(r=function(){return o}.apply(e,[]))||(t.exports=r)}()},210:function(t,e){t.exports=function(t,e){return t.add(e),t}},211:function(t,e,n){var r=n(47),o=r?r.prototype:void 0,i=o?o.valueOf:void 0;t.exports=function(t){return i?Object(i.call(t)):{}}},2118:function(t,e,n){"use strict";var r=n(1),o=n.n(r),i=n(2119),a=n.n(i),s=n(2120),c=n.n(s);o.a.addLocaleResource("en-US",a.a),o.a.addLocaleResource("ja-JP",c.a),o.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2119:function(t,e){t.exports={"备注":"Remarks","保存":"Save","按enter发送，shift+enter换行":"Press Enter to send, Shift+Enter to wrap"}},212:function(t,e,n){var r=n(115);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},2120:function(t,e){t.exports={"备注":"備考","保存":"保存する","按enter发送，shift+enter换行":"Enterで送信。Shift+Enterで改行"}},2121:function(t,e,n){"use strict";e.b=function(){a("Worksheet").register("remarks",{priority:4999,init:function(){this.remarks=new o.a},afterCellPainted:function(t){var e=t.sheetArea,n=t.ctx,r=t.cell,o=t.isPrinting;o||3!==e||function(t,e){var n=e.row,r=e.col,o=e.x,i=e.y,a=e.width,u=e.height,l=this.remarks;a>0&&u>0&&l.get(n,r)&&this.isRangeReadable(n,r,1,1)&&(t.save(),t.beginPath(),t.fillStyle=c,t.moveTo(o+a-s,i),t.lineTo(o+a,i),t.lineTo(o+a,i+s),t.lineTo(o+a-s,i),t.fill(),t.restore())}.call(this,n,r)},onLayoutChanged:function(t){var e=t.changeType;["addRows","addColumns","deletingRows","deletingColumns"].includes(e)&&this.remarks.onLayoutChanged.call(this.remarks,t)},toJson:function(t){t.remarks=this.remarks.fromJson()},fromJson:function(t){t&&t.remarks&&(this.remarks=new o.a(t.remarks))}})},e.a=function(t){var e=i._getFeatureManager("Worksheet")._features.find(function(t){return"remarks"===t.name});t.forEach(function(t){return e.init.call(t)})};var r=n(2),o=(n.n(r),n(2122)),i=r.sheets.Core.Spread.Sheets,a=i._getFeatureManager,s=8,c="#a0a2a5"},2122:function(t,e,n){"use strict";var r=n(196),o=n.n(r),i=n(701),a=n(904),s=function(){function t(t){void 0===t&&(t={}),this._remarks=t}return t.prototype.get=function(t,e){return this._remarks[t+"-"+e]},t.prototype.set=function(t,e,n){n.width=n.width||a.b,n.height=n.height||a.a,this._remarks[t+"-"+e]=Object.assign(n,{row:t,col:e})},t.prototype.remove=function(t,e){delete this._remarks[t+"-"+e]},t.prototype.clear=function(){this._remarks={}},t.prototype.fromJson=function(){return o()(this._remarks)},t.prototype.onLayoutChanged=function(t){var e,n=t.row,r=t.col,o=t.rowCount,a=t.colCount,s=t.changeType,c={};for(var u in this._remarks){var l=u.split("-").map(Number),p=l[0],f=l[1];if("addRows"===s||"addColumns"===s){if("addRows"===s?n<=p:r<=f){var d="addRows"===s?p+o+"-"+f:p+"-"+(f+a);Object(i.i)(c,this._remarks,u,d)}}else if("deletingRows"===s||"deletingColumns"===s){var h="deletingRows"===s?p>=n+o:f>=r+a;if("deletingRows"===s?p>=n&&p<n+o:f>=r&&f<r+a)Object.assign(c,((e={})[u]=null,e));else if(h){d="deletingRows"===s?p-o+"-"+f:p+"-"+(f-a);Object(i.i)(c,this._remarks,u,d)}}}Object(i.j)(c,this._remarks)},t}();e.a=s},2123:function(t,e,n){"use strict";var r,o=n(1),i=n.n(o),a=n(0),s=n.n(a),c=n(43),u=n(35),l=n(83),p=function(t){return t.isEditing||!t.editor.spread||!t.permission.hasSelections||!t.editor.permissions.query.canEditRange({sheetId:t.editor.spread.getActiveSheet().id,range:t.selection.selectedCell})};function f(t){return s.a.createElement(u.e,{editor:t.editor,icon:"remarks",text:i()("备注"),disabled:p(t),onTap:function(){l.M.visible&&l.M.markAsOld(),r.insertRemarks()}},l.M.visible&&s.a.createElement("span",{className:"badge"}))}e.a=function(t){var e;return r=t,{tabList:(e={},e[c.b.insert]=f,e)}}},2124:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(3),a=n.n(i),s=n(1),c=n.n(s),u=n(2),l=(n.n(u),n(701)),p=n(700),f=n(904),d=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=u.sheets.Core,m=h.Spread.Sheets.RichTextEditor,v=h.Spread.Sheets.Events,b=v.CellClick,_=v.LayoutChanged,g=v.CellDoubleClick,y=u.sheets.sheet.getActiveCell,x=m.parseHtml2TextStyles,w=m.parseTextStyles2RichText,E=function(t){function e(e){var n=t.call(this,e)||this;return n.insertRemarks=function(){var t=n.props.editor.spread.gcSpread,e=t.getActiveSheet(),r=y(e),o=r.row,i=r.col;t.focus(!1);var a=n.props.richTextEditor,s=e.remarks.get(o,i),c=s&&s.content||"",u=s&&s.richText||[];a.setRichTextContent(c,u,p.ZOOM_FACTOR,!1,0,!0),n.activeCell={row:o,col:i},a.editableDiv.setAttribute("contenteditable","true"),n.setState({show:!0})},n.__onCellClick=function(t,e){var r=e.row,o=e.col,i=e.sheet,a=n.props.richTextEditor;if(i.isEditing())return n.setState({show:!1});if(Object(l.a)(i,r,o)){var s=i.remarks.get(r,o);s&&a.setRichTextContent(s.content,s.richText||[],p.ZOOM_FACTOR,!1,0,!0),n.setState({show:!!s}),n.activeCell={row:r,col:o};var c=i.isRangeEditable(r,o,1,1);a.editableDiv.setAttribute("contenteditable",""+c)}},n.__onCellDoubleClick=function(){n.setState({show:!1})},n.__onLayoutChanged=function(){if(n.state.show&&n.activeCell){var t=n.props.richTextEditor,e=n.props.editor.spread.gcSpread.getActiveSheet(),r=n.activeCell,o=r.row,i=r.col,a=e.remarks.get(o,i);a&&t.setRichTextContent(a.content,a.richText||[],p.ZOOM_FACTOR,!1,0,!0)}},n.__closeRemarksBox=function(){n.setState({show:!1,isEditing:!1}),n.__compareAndSave()},n.__startEdit=function(){"false"!==n.props.richTextEditor.editableDiv.getAttribute("contenteditable")&&n.setState({isEditing:!0},function(){n.props.richTextEditor.editableDiv.focus(),n.props.richTextEditor.selectionHelper.setCaretToEnd()})},n.__compareAndSave=function(){var t=n.activeCell,e=t.row,r=t.col,o=n.props,i=o.editor,a=o.richTextEditor,s=i.spread.gcSpread.getActiveSheet(),c=s.remarks.get(e,r),u=x(a.editableDiv,p.ZOOM_FACTOR,a.editableDivId);if(u&&u.length){var d=u.map(function(t){return t.text}).join(""),h=w(d,p.DEFAULT_STYLE,u,!0,!1),m=h.richTextItems,v=h.cellStyle;v&&(Object(l.c)(v),m.forEach(function(t){Object.keys(v).forEach(function(e){return!t.style[e]&&(t.style[e]=v[e])})}));var b=v||p.DEFAULT_STYLE;Object(l.c)(b);var _=[{data:d.length,style:b}],g=m&&m.length>0?m:_;if(!c||c.content!==d||!Object(l.h)(c.richText||[],g)){var y=c&&c.width||f.b,E=c&&c.height||f.a,k=Object(l.d)({row:e,col:r,content:d,sheet:s,richText:g,width:y,height:E});s.remarks.set(e,r,{content:d,richText:g,width:y,height:E}),i.calcOperator({operator:k,label:"remarks"}),s.repaint()}}},n.state={show:!1,isEditing:!1},n}return d(e,t),e.prototype.componentDidMount=function(){this.__initMobileRemarksEditor();var t=this.props.editor.spread.gcSpread;t.bind(b,this.__onCellClick),t.bind(g,this.__onCellDoubleClick),t.bind(_,this.__onLayoutChanged)},e.prototype.render=function(){var t=this.state,e=t.show,n=t.isEditing;return[n&&o.a.createElement("div",{key:"overlay",className:"m-remarks-box-mask"}),o.a.createElement("div",{key:"wrapper",className:"m-remarks-box-wrapper"+(e?"":" m-remarks-box-hide")+(n?" m-remarks-top":"")},o.a.createElement("div",{className:"m-remarks-box-header"},o.a.createElement("span",{className:"m-remarks-title"},c()("备注")),o.a.createElement("span",{className:"m-remarks-close",onClick:this.__closeRemarksBox},c()("保存"))),o.a.createElement("div",{ref:"remarksEditorWrapper",className:"m-remarks-box-editor-wrapper"}),o.a.createElement("div",{className:"m-remarks-editor-overlay"+(n?" hide":""),onClick:this.__startEdit}))]},e.prototype.__initMobileRemarksEditor=function(){var t=this.props.richTextEditor.editableDiv,e=a.a.findDOMNode(this.refs.remarksEditorWrapper);e&&e.appendChild(t)},e}(o.a.Component);e.a=E},2125:function(t,e,n){"use strict";e.a=function(t){return r=t,{component:h}};var r,o=n(0),i=n.n(o),a=n(62),s=n(49),c=n(1),u=n.n(c),l=n(50),p=n(2),f=(n.n(p),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),d=p.sheets.track,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__insertRemarks=function(){d(2,"18039"),r.insertRemarks()},e}return f(e,t),e.prototype.render=function(){return i.a.createElement(a.a,{key:"online-file"},i.a.createElement(s.a,{disabled:this.__isDisabled(),icon:"remarks",text:u()("备注"),onClick:this.__insertRemarks}))},e.prototype.__isDisabled=function(){var t=this.props;return t.isEditing||!t.editor.spread||!t.permission.hasSelections||!t.editor.permissions.query.canEditRange({sheetId:t.editor.spread.getActiveSheet().id,range:t.selection.selectedCell})},e}(l.a)},2126:function(t,e,n){var r=n(2127);"string"==typeof r&&(r=[[t.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(25)(r,o);r.locals&&(t.exports=r.locals)},2127:function(t,e,n){(t.exports=n(24)(!1)).push([t.i,"#sm-remarks-editor {\n  box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2);\n  background-color: #f7f7f7;\n  padding: 10px 15px !important;\n  width: calc(100% - 30px);\n  height: calc(100% - 20px);\n  overflow-y: auto !important;\n  position: relative;\n  -webkit-user-select: initial;\n  -khtml-user-select: initial;\n  -moz-user-select: initial;\n  -o-user-select: initial;\n  -ms-user-select: initial;\n  user-select: initial; }\n  #sm-remarks-editor[contenteditable='false'] {\n    background-color: #f7f7f7 !important;\n    cursor: not-allowed; }\n  #sm-remarks-editor::-webkit-scrollbar {\n    width: 6px;\n    background-color: transparent; }\n  #sm-remarks-editor::-webkit-scrollbar-thumb {\n    border-radius: 3px;\n    background-color: #d8d8d8; }\n  #sm-remarks-editor .mention-user,\n  #sm-remarks-editor .mention-doc {\n    color: #0066cc !important;\n    text-decoration: none; }\n    #sm-remarks-editor .mention-user:hover,\n    #sm-remarks-editor .mention-doc:hover {\n      color: #0066cc !important; }\n  #sm-remarks-editor:focus {\n    background-color: #ffffff;\n    box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.2); }\n\n.remarks-box-wrapper {\n  display: block;\n  position: absolute; }\n  .remarks-box-wrapper.hide {\n    display: none; }\n  .remarks-box-wrapper .remarks-input-placeholder {\n    position: absolute;\n    z-index: 2;\n    color: #cdcdcd;\n    left: 15px;\n    font-size: 12px;\n    pointer-events: none;\n    margin-top: 10px; }\n  .remarks-box-wrapper:hover #sm-remarks-editor {\n    background-color: #ffffff;\n    z-index: 1; }\n  .remarks-box-wrapper .remarks-editor-wrapper {\n    width: 260px;\n    height: 74px;\n    min-width: 260px;\n    min-height: 74px;\n    position: relative; }\n  .remarks-box-wrapper .remarks-box-resize {\n    display: block;\n    cursor: se-resize;\n    width: 16px;\n    height: 16px;\n    background-image: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIxNnB4IiBoZWlnaHQ9IjE2cHgiIHZpZXdCb3g9IjAgMCAxNiAxNiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4gICAgICAgIDx0aXRsZT5SZWN0YW5nbGUgMjwvdGl0bGU+ICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPiAgICA8ZGVmcz48L2RlZnM+ICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiPiAgICAgICAgPGcgaWQ9Ikdyb3VwLTE3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2LjAwMDAwMCwgNi4wMDAwMDApIiBzdHJva2U9IiM5Nzk3OTciPiAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjUsMC41IEwwLjUsNi41IiBpZD0iTGluZSI+PC9wYXRoPiAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjUsNC41IEw0LjUsNi41IiBpZD0iTGluZSI+PC9wYXRoPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+);\n    background-repeat: no-repeat;\n    background-size: 100%;\n    bottom: 0;\n    right: 0;\n    position: absolute;\n    z-index: 10;\n    user-select: none; }\n\n.m-remarks-box-wrapper {\n  box-shadow: 0 0 10px 0 rgba(65, 70, 75, 0.25);\n  background-color: #ffffff;\n  position: fixed;\n  width: 100%;\n  height: 310px;\n  bottom: 0;\n  transition: transform 0.3s ease; }\n  .m-remarks-box-wrapper .m-remarks-box-header {\n    margin-top: 11px;\n    text-align: center;\n    font-size: 15px; }\n    .m-remarks-box-wrapper .m-remarks-box-header .m-remarks-title {\n      color: #41464b;\n      font-weight: 600; }\n    .m-remarks-box-wrapper .m-remarks-box-header .m-remarks-close {\n      position: absolute;\n      right: 10px;\n      color: #6da0e3;\n      padding: 0 10px; }\n  .m-remarks-box-wrapper.m-remarks-box-hide {\n    transform: translateY(320px); }\n  .m-remarks-box-wrapper.m-remarks-top {\n    top: 0;\n    transform: translateY(0);\n    box-shadow: none; }\n  .m-remarks-box-wrapper .m-remarks-editor-overlay {\n    height: calc(100% - 28px);\n    position: absolute;\n    width: 100%;\n    z-index: 100;\n    top: 28px; }\n    .m-remarks-box-wrapper .m-remarks-editor-overlay.hide {\n      display: none; }\n  .m-remarks-box-wrapper #sm-mobile-remarks-editor {\n    padding: 0 20px !important;\n    height: 200px;\n    margin-top: 25px; }\n\n.m-remarks-box-mask {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  background: #ffffff;\n  top: 0; }\n",""])},213:function(t,e,n){var r=n(214),o=n(54),i=n(36);t.exports=function(t){return"function"!=typeof t.constructor||i(t)?{}:r(o(t))}},214:function(t,e,n){var r=n(6),o=Object.create;t.exports=function(t){return r(t)?o(t):{}}},22:function(t,e,n){var r=n(10),o="[object Symbol]",i=Object.prototype.toString;t.exports=function(t){return"symbol"==typeof t||r(t)&&i.call(t)==o}},24:function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var o=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(r),i=r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"});return[n].concat(i).concat([o]).join("\n")}return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},25:function(t,e,n){var r={},o=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),i=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var n=function(t){return document.querySelector(t)}.call(this,t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),a=null,s=0,c=[],u=n(91);function l(t,e){for(var n=0;n<t.length;n++){var o=t[n],i=r[o.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](o.parts[a]);for(;a<o.parts.length;a++)i.parts.push(v(o.parts[a],e))}else{var s=[];for(a=0;a<o.parts.length;a++)s.push(v(o.parts[a],e));r[o.id]={id:o.id,refs:1,parts:s}}}}function p(t,e){for(var n=[],r={},o=0;o<t.length;o++){var i=t[o],a=e.base?i[0]+e.base:i[0],s={css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(s):n.push(r[a]={id:a,parts:[s]})}return n}function f(t,e){var n=i(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=c[c.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),c.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=i(t.insertInto+" "+t.insertAt.before);n.insertBefore(e,o)}}function d(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=c.indexOf(t);e>=0&&c.splice(e,1)}function h(t){var e=document.createElement("style");return t.attrs.type="text/css",m(e,t.attrs),f(t,e),e}function m(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function v(t,e){var n,r,o,i;if(e.transform&&t.css){if(!(i=e.transform(t.css)))return function(){};t.css=i}if(e.singleton){var c=s++;n=a||(a=h(e)),r=_.bind(null,n,c,!1),o=_.bind(null,n,c,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",m(e,t.attrs),f(t,e),e}(e),r=function(t,e,n){var r=n.css,o=n.sourceMap,i=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||i)&&(r=u(r));o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([r],{type:"text/css"}),s=t.href;t.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,e),o=function(){d(n),n.href&&URL.revokeObjectURL(n.href)}):(n=h(e),r=function(t,e){var n=e.css,r=e.media;r&&t.setAttribute("media",r);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),o=function(){d(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=p(t,e);return l(n,e),function(t){for(var o=[],i=0;i<n.length;i++){var a=n[i];(s=r[a.id]).refs--,o.push(s)}t&&l(p(t,e),e);for(i=0;i<o.length;i++){var s;if(0===(s=o[i]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete r[s.id]}}}};var b=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}();function _(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}},26:function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},27:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(3),a=n.n(i),s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(t){function e(e){var n=t.call(this,e)||this;return n.direction="right",n.align="bottom",n.adjustStyle=function(){var t=n.props.className,e=window.innerHeight,r=window.innerWidth,o=n.refs.contentDom,i=o.getBoundingClientRect().width,a=n.props.itemDom.getBoundingClientRect(),s=a.bottom,c=a.left,u=a.right,l=a.top,p=document.querySelector(".tab-help").getBoundingClientRect().left,f=!!document.querySelector(".tab-help.menu__open"),d=t&&t.indexOf("tooltip")>-1,h={position:"fixed",left:f&&!d&&c<p?u-(u-c)/2:u,top:l,zIndex:1e3,overflowY:"auto"};d&&delete h.overflowY;var m=s-78,v=e-s-30,b=o.scrollHeight;b>v&&(b<m||v/e<.25?(h.maxHeight=m,h.top=s-Math.min(b,m),n.align="top"):h.maxHeight=v),r-u-i<50&&(h.left=c-i,n.direction="left"),n.setState({style:h})},n.state={style:null},n}return s(e,t),e.prototype.componentDidUpdate=function(t,e){this.props.showPopup&&!t.showPopup&&this.adjustStyle()},e.prototype.render=function(){var t=this.props,e=t.showPopup,n=t.className,r="menu--content menu--content__submenu";return n&&(r+=" "+n),r+="right"===this.direction?" submenu--right":" submenu--left",r+="bottom"===this.align?" submenu--bottom":" submenu--top",e?a.a.createPortal(o.a.createElement("div",{ref:"contentDom",className:r,style:this.state.style},this.props.children),document.getElementsByClassName("tabStrip")[0]):null},e}(o.a.Component);e.a=c},28:function(t,e){t.exports=function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}},29:function(t,e,n){var r=n(63),o="[object Arguments]",i=Object.prototype,a=i.hasOwnProperty,s=i.toString,c=i.propertyIsEnumerable;t.exports=function(t){return r(t)&&a.call(t,"callee")&&(!c.call(t,"callee")||s.call(t)==o)}},3:function(t,e){t.exports=ReactDOM},30:function(t,e,n){var r=n(22),o=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}},31:function(t,e,n){var r=n(103),o=n(110),i=n(112),a=n(113),s=n(114);function c(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,t.exports=c},32:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},33:function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},34:function(t,e){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){return!!(e=null==e?n:e)&&("number"==typeof t||r.test(t))&&t>-1&&t%1==0&&t<e}},35:function(t,e,n){"use strict";var r=n(132),o=n(133),i=n(134),a=n(135),s=n(136),c=n(137),u=n(60);n(27);n.d(e,"h",function(){return r.a}),n.d(e,"a",function(){return o.a}),n.d(e,"g",function(){return i.a}),n.d(e,"e",function(){return a.a}),n.d(e,"d",function(){return s.a}),n.d(e,"b",function(){return c.a}),n.d(e,"k",function(){return u.a});var l=n(138);n.d(e,"j",function(){return l.d}),n.d(e,"i",function(){return l.c}),n.d(e,"f",function(){return l.b}),n.d(e,"l",function(){return l.e}),n.d(e,"c",function(){return l.a})},36:function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},37:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertNever=function(t){throw new Error("unexpected type: "+JSON.stringify(t))}},38:function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(18);e.interweave=function(t,e){return t.map(function(n,r){return r===t.length-1?n:""+n+e[r]}).join("")},e.getTextResult=function(t,e){return e&&e[t]};var i=/%(s|\d)/g;e.getInterpolateResult=function(t,e,n){try{if(!n)return;var a=o.sourceTextToKey({type:"interpolated",textParts:t}),s=n[a];if(!s)return;var c={},u=0;a.replace(i,function(t){return c[t]=e[u],u+=1,t});return"string"==typeof s?function(t,e){return t.replace(i,function(n){return null!==e[n]?String(e[n]):(console.warn("[s18n] interpolation failed:",{str:t,valueMap:e}),n)})}(s,c):"object"===(void 0===s?"undefined":r(s))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(s))}catch(r){var l={parts:t,values:e,resource:n};return console.error("[s18n] error when translating: ",l),void console.error(r)}}},39:function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},4:function(t,e,n){(function(t,r){var o=n(87),i={function:!0,object:!0},a=i[typeof e]&&e&&!e.nodeType?e:void 0,s=i[typeof t]&&t&&!t.nodeType?t:void 0,c=o(a&&s&&"object"==typeof r&&r),u=o(i[typeof self]&&self),l=o(i[typeof window]&&window),p=o(i[typeof this]&&this),f=c||l!==(p&&p.window)&&l||u||p||Function("return this")();t.exports=f}).call(e,n(32)(t),n(26))},40:function(t,e,n){var r=n(8)(n(4),"Map");t.exports=r},41:function(t,e,n){var r=n(54),o=Object.prototype.hasOwnProperty;t.exports=function(t,e){return o.call(t,e)||"object"==typeof t&&e in t&&null===r(t)}},42:function(t,e,n){var r=n(88),o=n(40),i=n(89),a=n(69),s=n(90),c=n(39),u=Object.prototype.toString,l=c(r),p=c(o),f=c(i),d=c(a),h=c(s);function m(t){return u.call(t)}(r&&"[object DataView]"!=m(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=m(new o)||i&&"[object Promise]"!=m(i.resolve())||a&&"[object Set]"!=m(new a)||s&&"[object WeakMap]"!=m(new s))&&(m=function(t){var e=u.call(t),n="[object Object]"==e?t.constructor:void 0,r=n?c(n):void 0;if(r)switch(r){case l:return"[object DataView]";case p:return"[object Map]";case f:return"[object Promise]";case d:return"[object Set]";case h:return"[object WeakMap]"}return e}),t.exports=m},43:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return a}),n.d(e,"c",function(){return s});var r,o=n(1),i=n.n(o);!function(t){t.edit="edit",t.insert="insert",t.format="format",t.data="data",t.view="view",t.form="form",t.plugins="plugins",t.help="help",t.formula="formula"}(r||(r={}));var a={edit:i()("编辑"),insert:i()("插入"),format:i()("格式"),data:i()("数据"),view:i()("视图"),form:i()("表单"),plugins:i()("插件"),help:i()("帮助")},s={form:2,plugins:1,help:-1}},44:function(t,e,n){var r=n(5),o=n(10),i="[object String]",a=Object.prototype.toString;t.exports=function(t){return"string"==typeof t||!r(t)&&o(t)&&a.call(t)==i}},45:function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},46:function(t,e,n){var r=n(13),o=n(98),i=n(99),a=n(100),s=n(101),c=n(102);function u(t){this.__data__=new r(t)}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=s,u.prototype.set=c,t.exports=u},47:function(t,e,n){var r=n(4).Symbol;t.exports=r},48:function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}},49:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__onClick=function(t){e.props.onClick&&e.props.onClick(t)},e}return i(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.icon,r=e.text;return o.a.createElement("span",{onClick:function(e){return t.__onClick(e)},key:"icon",className:this.__getClassName()},n&&o.a.createElement("i",{className:"icon-"+n}),r&&o.a.createElement("span",null,r))},e.prototype.__getClassName=function(){var t=this.props,e=t.icon,n=t.text,r=t.selected,o=t.disabled,i=t.hasTapBtn;return(n&&e?"m-icon-text-button":n?"m-text-button":"m-icon-button")+(r?" m-menu-selected":"")+(o?" m-menu-disabled":"")+(i?" m-menu-btn":"")},e}(o.a.Component);e.a=a},5:function(t,e){var n=Array.isArray;t.exports=n},50:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(0),o=n.n(r),i=n(161),a=n.n(i),s=n(162),c=n.n(s),u=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=!1,e.permissionUpdateKeys=["canEditRange"],e.reRender=function(){e.forceUpdate()},e}return u(e,t),e.prototype.shouldComponentUpdate=function(t,e){return e!==this.state||(!0===this.selectionUpdateKeys||(!1!==this.selectionUpdateKeys&&!a()(c()(t.selection,this.selectionUpdateKeys),c()(this.props.selection,this.selectionUpdateKeys))||(!a()(c()(t.permission,this.permissionUpdateKeys),c()(this.props.permission,this.permissionUpdateKeys))||!a()(t.isEditing,this.props.isEditing))))},e}(o.a.Component)},54:function(t,e){var n=Object.getPrototypeOf;t.exports=function(t){return n(Object(t))}},55:function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},57:function(t,e,n){var r=n(76),o=n(127),i=1,a=2;t.exports=function(t,e,n,s,c,u){var l=c&a,p=t.length,f=e.length;if(p!=f&&!(l&&f>p))return!1;var d=u.get(t);if(d)return d==e;var h=-1,m=!0,v=c&i?new r:void 0;for(u.set(t,e);++h<p;){var b=t[h],_=e[h];if(s)var g=l?s(_,b,h,e,t,u):s(b,_,h,t,e,u);if(void 0!==g){if(g)continue;m=!1;break}if(v){if(!o(e,function(t,e){if(!v.has(e)&&(b===t||n(b,t,s,c,u)))return v.add(e)})){m=!1;break}}else if(b!==_&&!n(b,_,s,c,u)){m=!1;break}}return u.delete(t),m}},58:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(3),a=n.n(i),s=n(2),c=(n.n(s),n(84)),u=n(43),l=n(123),p=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=s.sheets.menu.MenuContext,d=function(t){function e(e){var n=t.call(this,e)||this;return n.direction="right",n.__onMouseHoverSearchResult=function(t,e){var r=!1,o=n.props.tab;r=o===u.b.help?n.state.open:t===o,n.setState({open:r,searchResultPath:e})},n.__onMouseLeaveSearchResult=function(){n.setState({open:n.state.open,searchResultPath:""})},n.toggleOpen=function(){n.setState({open:!n.state.open,style:null})},n.close=function(){n.setState({open:!1,style:null})},n.checkClick=function(t){var e=a.a.findDOMNode(n),r=t.target;!e.contains(r)&&n.state.open&&n.close()},n.adjustStyle=function(){var t=a.a.findDOMNode(n).lastElementChild.getBoundingClientRect(),e=t.top,r=t.bottom,o=t.right,i=t.width,s=t.left,c={},l=window.innerHeight-50;r>l&&(c.maxHeight=l-e,c.overflowY="auto");var p=document.querySelector(".tab-help.menu__open"),f=a.a.findDOMNode(n).querySelector(".dropMenuHead");p&&n.props.tab!==u.b.help&&!f?o>p.getBoundingClientRect().left&&s>i&&(n.direction="left"):n.direction="right";n.setState({style:c})},n.state={open:!1,style:null,searchResultPath:""},n}return p(e,t),e.prototype.componentDidMount=function(){this.bindClick(),l.b&&(l.b.on(c.a.ToggleMenuOpen,this.__onMouseHoverSearchResult),l.b.on(c.a.MouseLeaveSearchResult,this.__onMouseLeaveSearchResult))},e.prototype.componentDidUpdate=function(t,e){var n;(!this.state.open||e.open||this.state.style?!this.state.open&&e.open&&this.props.onClose&&this.props.onClose():(this.props.onOpen&&this.props.onOpen(),this.adjustStyle()),this.state.style)&&(null===(n=a.a.findDOMNode(this).querySelector(".menuItem--highlight"))||void 0===n||n.scrollIntoView(!1))},e.prototype.componentWillUnmount=function(){this.unbindClick(),l.b&&(l.b.off(c.a.ToggleMenuOpen,this.__onMouseHoverSearchResult),l.b.off(c.a.MouseLeaveSearchResult,this.__onMouseLeaveSearchResult))},e.prototype.render=function(){var t=this,e="menu "+(this.props.customClass?this.props.customClass:"")+" "+(this.state.open?"menu__open":"")+" "+(this.props.disabled?"disabled":""),n="right"===this.direction?"open--right":"open--left";return o.a.createElement(f.Provider,{value:{closeMenu:this.close,searchResultPath:this.state.searchResultPath}},o.a.createElement("div",{className:e,"data-smattr":this.props.smattr},o.a.cloneElement(this.props.head,{onClick:function(e){var n=t.props.head.props.onClick;n&&n(e),t.toggleOpen()}}),this.state.open&&o.a.createElement("div",{className:"menu--body "+n},o.a.createElement("div",{className:"menu--content",style:this.state.style},this.renderChildren()))))},e.prototype.bindClick=function(){document.addEventListener("click",this.checkClick,!1)},e.prototype.unbindClick=function(){document.removeEventListener("click",this.checkClick,!1)},e.prototype.renderChildren=function(){var t=this.props.children;if("function"==typeof t){if(t.cache)return t.cache;var e=t();return t.cache=e,e}return t},e}(o.a.Component);e.a=d},59:function(t,e,n){"use strict";e.a=function(t){return{background:'url("'+t+'") center no-repeat'}}},6:function(t,e){t.exports=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}},60:function(t,e,n){"use strict";e.a=function(t){return t.option?o.a.createElement("span",{className:"tooltip tooltip__"+(t.direction||"down"),style:t.style},o.a.createElement("span",null,t.option),t.detail&&o.a.createElement("br",null),t.detail&&o.a.createElement("span",null,t.detail)):null};var r=n(0),o=n.n(r)},61:function(t,e,n){var r=n(19),o=n(6),i=n(22),a=NaN,s=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,p=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return a;if(o(t)){var e=r(t.valueOf)?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var n=u.test(t);return n||l.test(t)?p(t.slice(2),n?2:8):c.test(t)?a:+t}},62:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.disabled,r=e.className,i="m-menu-group-item"+(r?" "+r:"")+(n?" m-menu-disabled":"");return o.a.createElement("div",{className:i,onClick:function(){return t.__onClick()}},this.props.children)},e.prototype.__onClick=function(){this.props.onClick&&this.props.onClick()},e}(o.a.Component);e.a=a},63:function(t,e,n){var r=n(17),o=n(10);t.exports=function(t){return o(t)&&r(t)}},64:function(t,e,n){var r=n(33),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var i=t[e];o.call(t,e)&&r(i,n)&&(void 0!==n||e in t)||(t[e]=n)}},65:function(t,e){t.exports=function(t,e,n,r){var o=-1,i=t.length;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}},66:function(t,e,n){var r=n(126),o=n(6),i=n(10);t.exports=function t(e,n,a,s,c){return e===n||(null==e||null==n||!o(e)&&!i(n)?e!=e&&n!=n:r(e,n,t,a,s,c))}},67:function(t,e,n){var r=n(4).Uint8Array;t.exports=r},68:function(t,e,n){var r=n(82),o=n(29),i=n(5),a=n(20),s=n(44);t.exports=function(t){var e=t?t.length:void 0;return a(e)&&(i(t)||s(t)||o(t))?r(e,String):null}},69:function(t,e,n){var r=n(8)(n(4),"Set");t.exports=r},700:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"ZOOM_FACTOR",function(){return A}),n.d(e,"PLUGIN_NAME",function(){return R}),n.d(e,"EDITABLE_DIV_ID",function(){return q}),n.d(e,"DEFAULT_STYLE",function(){return Q});var r=n(145),o=(n.n(r),n(2118),n(1)),i=n.n(o),a=n(2),s=(n.n(a),n(2121)),c=n(2123),u=n(701),l=n(1182),p=n(904),f=n(0),d=n.n(f),h=n(3),m=n.n(h),v=n(2124),b=n(2125),_=n(2126),g=(n.n(_),n(148)),y=(n.n(g),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),x=this&&this.__assign||function(){return(x=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},w=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function s(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(a,s)}c((r=r.apply(t,e||[])).next())})},E=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},k=a.sheets.Core,C=k.Spread.Sheets.RichTextEditor,O=a.sheets.changeset,T=a.sheets.CellAppendant,S=a.sheets.range,A=1,R="Remarks",j=a.sheets,M=j.Plugin,I=j.Events,N=j.constants,L=j.path,P=j.root,U=j.utils,D=j.cell,B=C.RichTextEditor,F=O.findRawTableOpById,H=O.processCellsDataAttributes,z=T.HorizontalAlign,G=T.VerticalAlign,W=S.isCellInRange,Z=N.DEFAULT_FONT,V=N.ERR_CODE,Y=L.setByPath,K=U.replaceState,J=D.checkIsCellHiddenByOutline,X=k.Spread.Sheets.Events.CellClick,$=Object(g.isMobile)(),q=$?"sm-mobile-remarks-editor":"sm-remarks-editor",Q={font:Z,textDecoration:0},tt=function(t){function e(n){var r=t.call(this,{name:R,Constructor:e,config:n})||this;return r.isEditing=!1,r.isRemarksEditorMounted=!1,r.getMenuConfig=function(){return Object(c.a)({insertRemarks:r.insertRemarks})},r.getMobileMenuConfig=function(){return Object(b.a)({insertRemarks:r.insertRemarks})},r.getCellAppendant=function(){return{remarks:r,priority:999,component:p.c,align:[z.right,G.center],disableRender:$}},r.destroy=function(){r.editor.off(I.AfterSheetRendered,r.__afterSheetRendered),r.editor.off(I.AfterCellsChanged,r.renderCellRemarks),r.editor.off(I.AfterChangeApplied,r.renderCellRemarks),r.editor.off(I.AfterAddOrDeleteCells,r.updateAfterAddOrDeleteCells)},r.insertRemarks=function(){$?r.mobileRemarksBox.current&&r.mobileRemarksBox.current.insertRemarks():r.emit(l.a.InsertRemarks)},r.removeRangeRemarks=function(t,e){var n=t.remarks._remarks,o=Object.keys(n).reduce(function(n,r){var o=r.split("-").map(Number),i=o[0],a=o[1];return e.some(function(t){return W(i,a,t)})&&(t.remarks.remove(i,a),n.push({row:i,col:a})),n},[]);o.length&&(t.repaint(),r.emit(l.a.RemoveRemarks,o),r.editor.calcOperator({operator:Object(u.e)(t,o),label:"remarks"}))},r.removeCellRemarks=function(t,e,n){t.remarks.remove(e,n);var o=[{row:e,col:n}];t.repaint(),r.emit(l.a.RemoveRemarks,o),r.editor.calcOperator({operator:Object(u.e)(t,o),label:"remarks"})},r.updateCellRemarks=function(t,e,n,o){var i={content:o,richText:[],width:p.b,height:p.a},a=Object(u.d)(x(x({},i),{sheet:t,row:e,col:n}));t.remarks.set(e,n,i),t.repaint(),r.editor.calcOperator({operator:a,label:"remarks"})},r.getCellRemarksContent=function(t,e,n){var r=t.remarks.get(e,n);if(r)return r.content},r.initAfterEditorRendered=function(){r.initRemarksEditor(),r.install(),$&&!r.options.useCustomUi&&r.__initMobileRemarksBox()},r.__afterSheetRendered=function(t){r.renderCellRemarks(t),r.__locateRemarks()},r.__locateRemarks=function(){var t=window.location.hash.substring(1)||"",e=r.editor.spread,n=e.gcSpread.getActiveSheet();if(/^[a-zA-Z0-9]{16}$/.test(t)){var o=t.slice(0,t.length-11),i=t.slice(t.length-11);if(n.guid()!==o)e.setActiveSheet(o);else{var a=n.remarks._remarks,s=Object.keys(a).find(function(t){return a[t].mentionGuid===i});if(s){var c=s.split("-").map(Number),u=c[0],p=c[1];r.isRemarksEditorMounted?r.__showLocatedRemarks(n,u,p):r.on(l.a.RemarksEditorMounted,r.__showLocatedRemarks.bind(r,n,u,p))}}}},r.__showLocatedRemarks=function(t,e,n){t.setActiveCell(e,n),t.showCell(e,n,k.Spread.Sheets.VerticalPosition.center,k.Spread.Sheets.HorizontalPosition.center),!J(t,e,n)&&t._trigger(X,{row:e,col:n,sheet:t,sheetName:t.name()}),K()},r.updateAfterAddOrDeleteCells=function(t){var e=t.sheet,n=t.range,r=t.isAdd,o=t.dir,i=e.remarks._remarks,a=n.row,s=n.col,c=n.rowCount,l=n.colCount,p={};for(var f in i){var d=f.split("-").map(Number),h=d[0],m=d[1],v=h>=a&&h<a+c,b=m>=s&&m<s+l;if(r){if(y="right"===o?v&&m>=s&&m+l<e.getColumnCount():b&&h>=a&&h+c<e.getRowCount()){var _="right"===o?h+"-"+(m+l):h+c+"-"+m;Object(u.i)(p,i,f,_)}}else{var g=W(h,m,n),y="left"===o?v&&m>=s+l:b&&h>=a+c;if(g)delete i[f];else if(y){_="left"===o?h+"-"+(m-l):h-c+"-"+m;Object(u.i)(p,i,f,_)}}}Object(u.j)(p,i)},r.setRemarks=function(t,e){var n=r.editor,o=n.spread.getSheet(e).gcSheet,i=H(n.fileType,t);try{i.length&&r.renderCellRemarks({cellsData:i,sheet:o})}catch(t){n.emit(I.Track,V.TRACK_SHEET_PARSE_REMARKS_ERROR,{msg:t&&t.stack})}},r.editor=n.editor,r.options=n,$&&(r.mobileRemarksBox=d.a.createRef()),r.bindEditorEvents(),Object(s.b)(),r.editor.isRendered?(Object(s.a)(r.editor.spread.gcSpread.sheets),r.initAfterEditorRendered(),r.initRenderRemarks()):r.editor.on(I.Rendered,r.initAfterEditorRendered),r}return y(e,t),e.prototype.setLocale=function(t){i.a.setLocaleSync(t)},e.prototype.renderCellRemarks=function(t){if(t.sheet){var e=t.sheet.gcSheet||t.sheet,n=t.cellsData;if(!n||!e)return;n.forEach(function(t){var n=t[0],r=t[1],o=t[3];if("string"==typeof o.remarks){var i=JSON.parse(o.remarks),a=i.richText,s=i.content,c=i.width,l=i.height,p=i.mentionGuid,f=Object(u.g)(e,a);e.remarks.set(n,r,{content:s,richText:f,width:c,height:l,mentionGuid:p})}else o.hasOwnProperty("remarks")&&null==o.remarks&&e.remarks.remove(n,r)})}},e.prototype.initRemarksEditor=function(){this.richTextEditor=new B({isMobile:$,editableDivId:q,isCellEditor:!1}),this.richTextEditor.editableDiv.style.font=Z,this.editor.spreadOptions.isHistoryPreview&&this.richTextEditor.editableDiv.setAttribute("contenteditable","false"),$&&this.richTextEditor.editableDiv.removeAttribute("smattr")},e.prototype.__initMobileRemarksBox=function(){m.a.render(d.a.createElement(v.a,{ref:this.mobileRemarksBox,richTextEditor:this.richTextEditor,editor:this.editor}),this.pluginContainer)},e.prototype.bindEditorEvents=function(){this.editor.on(I.AfterSheetRendered,this.__afterSheetRendered),this.editor.on(I.AfterCellsChanged,this.renderCellRemarks),this.editor.on(I.AfterChangeApplied,this.renderCellRemarks),this.editor.on(I.AfterAddOrDeleteCells,this.updateAfterAddOrDeleteCells)},e.prototype.initRenderRemarks=function(){return w(this,void 0,Promise,function(){var t,e,n,r,o=this;return E(this,function(i){switch(i.label){case 0:return t=this.editor,!(e=t.spread.sheets.reduce(function(e,n){var r=t.sheetStates.getState(n.id)[0];return"fullRendered"===(void 0===r?"":r)&&e.push(n),e},[])).length&&e.push(t.spread.getActiveSheet()),n=t.disableRenderOptimization?t.spread.sheets:e,[4,t.getContent()];case 1:return r=i.sent(),n.forEach(function(t){var e=F(r,t.id);o.setRemarks(e,t.id),t.gcSheet.repaint()}),this.__locateRemarks(),[2]}})})},e}(M);e.default=tt,Y(P,"shimo.sdk.sheet.plugins.Remarks",tt)},701:function(t,e,n){"use strict";e.d=function(t){var e=t.row,n=t.col,r=t.sheet,i=t.content,a=t.richText,s=t.width,c=t.height,u=t.mentionGuid;a.forEach(function(t){t.style&&!t.style.font&&(t.style.font=o.DEFAULT_STYLE.font)});var l={content:i,width:s,height:c};u&&Object.assign(l,{mentionGuid:u});var p=f(a,o.DEFAULT_STYLE,!0);p&&Object.assign(l,{richText:JSON.parse(p)});var d={remarks:JSON.stringify(l)},h=[e,n,{attrs:d}];return{fnName:"cellAttrs2Changeset",params:[r.guid(),[h]]}},e.e=function(t,e){var n=e.map(function(t){var e=t.row,n=t.col;return[e,n,{attrs:{remarks:null}}]});return{fnName:"cellAttrs2Changeset",params:[t.guid(),n]}},e.g=function(t,e){var n=[];return e&&e.forEach(function(e){var r=e.attributes||{},o=Object.keys(r).length>0,i={data:e.data,style:o?l.calcStyleByAttrs(t,r,{}):{}};r.extension&&(i.extension=r.extension),n.push(i)}),n},e.f=function(t){return(d(t.editableDiv,o.ZOOM_FACTOR,t.editableDivId)||[]).map(function(t){return t.text}).join("")},e.c=function(t){0===t.textDecoration&&delete t.textDecoration},e.h=function(t,e){return n(t),n(e),a()(t,e);function n(t){t.forEach(function(t){t.style.font||(t.style.font=o.DEFAULT_STYLE.font)})}},e.j=function(t,e){Object.keys(t).forEach(function(n){if(t[n]){var r=n.split("-").map(Number),o=r[0],i=r[1];e[n]=Object.assign(t[n],{row:o,col:i})}else delete e[n]})},e.i=function(t,e,n,r){t[n]||(t[n]=null);t[r]=e[n]},e.a=function(t,e,n){return null!==e&&null!==n&&e>=0&&n>=0&&t.isRangeReadable(e,n,1,1)},e.b=function(t,e,n,r){var o=n.reduce(m,[]),i=e.reduce(m,[]),a=o.filter(function(t){return!i.includes(t)}),s=t.pluginManager.get("MentionPlugin");if(s&&a.length){var c=s.instance,u=h(11),l=r+u;return c&&c.mentionUsers(l,a),u}};var r=n(2),o=(n.n(r),n(700)),i=n(161),a=n.n(i),s=r.sheets.Core.Spread.Sheets.RichTextEditor,c=r.sheets,u=c.cell,l=c.cellCommand,p=c.utils,f=u.gcRichText2CSRichText,d=s.parseHtml2TextStyles,h=p.genId;function m(t,e){return e.extension&&"mention"===e.extension.type&&e.extension.data&&"user"===e.extension.data.type&&t.push(e.extension.data.id),t}},73:function(t,e,n){var r=n(55)("length");t.exports=r},74:function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}},76:function(t,e,n){var r=n(31),o=n(120),i=n(121);function a(t){var e=-1,n=t?t.length:0;for(this.__data__=new r;++e<n;)this.add(t[e])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,t.exports=a},77:function(t,e,n){var r=n(64);t.exports=function(t,e,n,o){n||(n={});for(var i=-1,a=e.length;++i<a;){var s=e[i],c=o?o(n[s],t[s],s,n,t):t[s];r(n,s,c)}return n}},78:function(t,e,n){var r=n(131),o=n(116),i="Expected a function",a=Math.max;t.exports=function(t,e){if("function"!=typeof t)throw new TypeError(i);return e=a(void 0===e?t.length-1:o(e),0),function(){for(var n=arguments,o=-1,i=a(n.length-e,0),s=Array(i);++o<i;)s[o]=n[e+o];switch(e){case 0:return t.call(this,s);case 1:return t.call(this,n[0],s);case 2:return t.call(this,n[0],n[1],s)}var c=Array(e+1);for(o=-1;++o<e;)c[o]=n[o];return c[e]=s,r(t,this,c)}}},8:function(t,e,n){var r=n(86);t.exports=function(t,e){var n=t[e];return r(n)?n:void 0}},81:function(t,e){var n=Object.keys;t.exports=function(t){return n(Object(t))}},82:function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},83:function(t,e,n){"use strict";n.d(e,"j",function(){return b}),n.d(e,"i",function(){return _}),n.d(e,"c",function(){return g}),n.d(e,"k",function(){return y}),n.d(e,"e",function(){return x}),n.d(e,"g",function(){return w}),n.d(e,"p",function(){return E}),n.d(e,"X",function(){return k}),n.d(e,"S",function(){return C}),n.d(e,"b",function(){return O}),n.d(e,"x",function(){return T}),n.d(e,"d",function(){return S}),n.d(e,"v",function(){return A}),n.d(e,"U",function(){return R}),n.d(e,"R",function(){return j}),n.d(e,"s",function(){return M}),n.d(e,"u",function(){return I}),n.d(e,"Q",function(){return N}),n.d(e,"n",function(){return L}),n.d(e,"o",function(){return P}),n.d(e,"r",function(){return U}),n.d(e,"l",function(){return D}),n.d(e,"T",function(){return B}),n.d(e,"m",function(){return F}),n.d(e,"V",function(){return H}),n.d(e,"q",function(){return z}),n.d(e,"t",function(){return G}),n.d(e,"w",function(){return W}),n.d(e,"y",function(){return Z}),n.d(e,"W",function(){return V}),n.d(e,"a",function(){return Y}),n.d(e,"h",function(){return K}),n.d(e,"C",function(){return J}),n.d(e,"P",function(){return X}),n.d(e,"L",function(){return $}),n.d(e,"G",function(){return q}),n.d(e,"N",function(){return Q}),n.d(e,"J",function(){return tt}),n.d(e,"D",function(){return et}),n.d(e,"K",function(){return nt}),n.d(e,"B",function(){return rt}),n.d(e,"z",function(){return ot}),n.d(e,"M",function(){return it}),n.d(e,"F",function(){return at}),n.d(e,"E",function(){return st}),n.d(e,"H",function(){return ct}),n.d(e,"I",function(){return ut}),n.d(e,"O",function(){return lt}),n.d(e,"A",function(){return pt}),n.d(e,"f",function(){return ft});var r=n(1),o=n.n(r),i=n(2),a=(n.n(i),n(0)),s=n.n(a),c=i.sheets.track,u=i.sheets.newFeature,l=u.isNewFeature,p=u.features,f=u.MenuTooltip,d=u.markAsOld,h=u.fetchFeaturesComplete,m=u.shouldShowMenuTip,v=u.shouldShowContextTip,b=ht(p.ADVANCED_SORT,o()("新功能！按指定列排序"),"2016"),_=ht(p.OPTIONAL_PASTE,o()("选择性粘贴：可选择指定的粘贴项"),"7001"),g=ht(p.CUSTOM_FORMAT_TOOLBAR,o()("新增更多格式"),"5116"),y=ht(p.SWITCH_TOOLBAR,o()("点击切换工具栏")),x=(ht(p.FORMULA_VALIDATION,o()("新增范围列表和自定义公式")),ht(p.CUSTOM_FORMULA_TOOLBAR,o()("新增 XLOOKUP 函数"))),w=ht(p.ITER_CALC,o()("公式支持迭代计算啦")),E=ht(p.TABMENU_CLEAR_REPEAT,o()("新增功能：删除重复项")),k=ht(p.TABMENU_SPLIT_COLUMNS,o()("新增功能：分列")),C=ht(p.TABMENU_PIVOT_TABLE,o()("新增功能：数据透视表")),O=ht(p.CONDITIONAL_FORMAT_UPGRADE_2,o()("支持数据条和色阶")),T=ht(p.TAB_MENU_GRID_LINE,o()("去除网格线")),S=ht(p.FIND_REPLACE,o()("支持使用 ? 和 * 进行模糊查询")),A=ht(p.TAB_MENU_FULL_SCREEN,o()("新功能：全屏模式")),R=(ht(p.TAB_MENU_HIDE_TOOLBAR,o()("这里可隐藏工具栏哦"),void 0,!1),ht(p.TABMENU_SHEETS_COMBINATION,o()("新增功能：合并工作表"))),j=ht(p.TAB_MENU_MERGE_CELL,o()("支持水平和垂直合并")),M=ht(p.TAB_MENU_DIAGONAL_BORDER,o()("支持绘制斜边框线")),I=ht(p.TAB_MENU_FONT_FAMILY,o()("新增功能：字体")),N=ht(p.TABMENU_MENTION,o()("可@人或链接到文件")),L=ht(p.TABMENU_CHECKBOX,o()("新增功能：复选框")),P=ht(p.TABMENU_CHECKLIST,o()("一键生成任务清单")),U=ht(p.TABMENU_DATE_MENTION,o()("新功能：日期提醒")),D=ht(p.TABMENU_ATTACHMENT,o()("新功能：上传附件")),B=ht(p.TABMENU_REMARKS,o()("新功能：备注")),F=ht(p.TABMENU_CHART_GANTT_FUNNEL,o()("图表新增：甘特图、漏斗图等")),H=ht(p.TABMENU_SHEETS_COMBINATION_UPDATE_SWITCH,o()("合并工作表支持多表汇总自动更新")),z=ht(p.CUSTOM_NAMES_FEATURE_TOOLTIPS,o()("新功能：给一片区域定义名称")),G=ht(p.TABMENU_FILE_SLIMMING,o()("新功能：文件瘦身")),W=ht(p.TABMENU_FUNCTION_SEARCH,o()("不知道功能在哪？在这里搜索试试")),Z=(ht(p.TABMENU_UNIT_CONVERSION,o()("新功能：单位换算")),ht(p.TABMENU_GROUP,o()("新功能：分组"))),V=ht(p.TABMENU_SHOW_FORMULA_TIP,o()("新功能：显示公式")),Y=(ht(p.TABMENU_REMIND,o()("新功能：关注选区或整个表格")),dt(p.ADVANCED_SORT_OPEN)),K=dt(p.CUSTOM_FORMAT_DROPDOWNMENU,"5116"),J=dt(p.TABMENU_ITEM_CLEAR_REPEAT),X=dt(p.TABMENU_ITEM_SPLIT_COLUMNS),$=dt(p.TABMENU_ITEM_PIVOT_TABLE),q=dt(p.TAB_MENU_ITEM_GRID_LINE),Q=(dt(p.TAB_MENU_ITEM_FULL_SCREEN),dt(p.TABMENU_ITEM_SHEETS_COMBINATION)),tt=dt(p.HIGHLIGHT_POSITION),et=dt(p.CUSTOM_NAMES_TAB_MENU_TIP),nt=dt(p.TABMENU_ITEM_MENTION),rt=dt(p.TABMENU_ITEM_CHECKBOX),ot=dt(p.TABMENU_ITEM_ATTACHMENT),it=dt(p.TABMENU_ITEM_REMARKS),at=dt(p.TABMENU_ITEM_FILE_SLIMMING),st=(dt(p.TABMENU_ITEM_CHECKLIST),dt(p.TABMENU_ITEM_DATE_MENTION)),ct=dt(p.TABMENU_ITEM_GROUP),ut=dt(p.TABMENU_GROUP_TIP),lt=dt(p.TABMENU_ITEM_SHOW_FORMULA),pt=dt(p.TABMENU_ITEM_CHART_GANTT_FUNNEL),ft=(dt(p.TABMENU_REMIND_HELP_TIP),dt(p.IMPORT_RANGE_QUICK_REF_TIP));function dt(t,e){return{get visible(){return h()&&v(t)},markAsOld:function(){l(t)&&(d(t),e&&c(2,e))}}}function ht(t,e,n,r){return void 0===r&&(r=!0),{get visible(){return h()&&m(t,r)},tooltip:s.a.createElement(f,{feature:t,content:e}),markAsOld:function(){l(t)&&(d(t),n&&c(2,n))}}}},84:function(t,e,n){"use strict";var r;!function(t){t.ToolBarLayoutChanged="Toolbar:ToolBarLayoutChanged",t.ToolBarMenuLayoutChanged="Toolbar:ToolBarMenuLayoutChanged",t.SelectionChanged="Toolbar:SelectionChanged",t.PermissionChanged="Toolbar:PermissionChanged",t.StartInsertLink="Toolbar:StartInsertLink",t.PaintBrushSelected="Toolbar:PaintBrushSelected",t.FrozenChanged="Toolbar:FrozenChanged",t.FilterChanged="Toolbar:FilterChanged",t.ToggleMenuOpen="Toolbar:ToggleMenuOpen",t.MouseLeaveSearchResult="Toolbar:MouseLeaveSearchResult"}(r||(r={})),e.a=r},86:function(t,e,n){var r=n(19),o=n(28),i=n(6),a=n(39),s=/^\[object .+?Constructor\]$/,c=Object.prototype,u=Function.prototype.toString,l=c.hasOwnProperty,p=RegExp("^"+u.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!!i(t)&&(r(t)||o(t)?p:s).test(a(t))}},87:function(t,e){t.exports=function(t){return t&&t.Object===Object?t:null}},88:function(t,e,n){var r=n(8)(n(4),"DataView");t.exports=r},89:function(t,e,n){var r=n(8)(n(4),"Promise");t.exports=r},90:function(t,e,n){var r=n(8)(n(4),"WeakMap");t.exports=r},904:function(t,e,n){"use strict";n.d(e,"b",function(){return P}),n.d(e,"a",function(){return U});var r,o=n(2),i=(n.n(o),n(0)),a=n.n(i),s=n(3),c=n.n(s),u=n(700),l=n(1182),p=n(701),f=n(1),d=n.n(f),h=n(148),m=(n.n(h),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),v=o.sheets.Core,b=v.Spread.Sheets.RichTextEditor,_=o.sheets.CellAppendant,g=_.isCellAppendantActive,y=_.AppendantComponent,x=o.sheets,w=x.Events,E=x.sheet,k=x.track,C=E.getActiveCell,O=b.parseGcStyle2InlineStyle,T=b.parseHtml2TextStyles,S=b.parseTextStyles2RichText,A=v.Spread.Sheets.Events,R=A.CellClick,j=A.CellDoubleClick,M=A.LayoutChanged,I=A.TopRowChanged,N=A.LeftColumnChanged,L=Object(h.isIE)()?"keyup":"input";!function(t){t[t.ENTER=13]="ENTER",t[t.ESC=27]="ESC",t[t.Z=90]="Z",t[t.Y=89]="Y"}(r||(r={}));var P=260,U=74,D=600,B=300,F=function(t){function e(e){var n=t.call(this,e)||this;return n.hoveredCell=null,n.mentionPop=null,n.isResizing=!1,n.__changeMountedState=function(){n.props.remarks.isRemarksEditorMounted=!0,n.props.remarks.emit(l.a.RemarksEditorMounted)},n._rebindGcEvents=function(){n._unbindGcEvents(),n._bindGcEvents()},n.__bindRemarksEditorEvents=function(){var t=n.props.remarks.richTextEditor.editableDiv;t.addEventListener("focusin",n._onFocus),t.addEventListener(L,n._onContentChange),t.addEventListener("paste",n._onContentChange),t.addEventListener("keydown",n._onKeyDown),t.addEventListener("click",n._onClick)},n.__unbindRemarksEditorEvents=function(){var t=n.props.remarks.richTextEditor.editableDiv;t.removeEventListener("focusin",n._onFocus),t.removeEventListener(L,n._onContentChange),t.removeEventListener("paste",n._onContentChange),t.removeEventListener("keydown",n._onKeyDown),t.removeEventListener("click",n._onClick)},n._hideOnSheetScroll=function(){!n.state.activeCell&&n.state.show&&n.setState({show:!1,content:""})},n._onFocus=function(){var t=n.props.remarks,e=t.editor;if("false"!==t.richTextEditor.editableDiv.getAttribute("contenteditable")){var r=e.spread.gcSpread.getActiveSheet();if(!n.state.activeCell&&n.hoveredCell){var o=n.hoveredCell,i=o.row,a=o.col;n.setState({activeCell:{row:i,col:a,remarks:r.remarks.get(i,a),sheet:r}}),n.hoveredCell=null}n._activeEditor(!1),n.forceUpdate()}},n.resetState=function(){n.setState({show:!1,content:"",activeCell:null}),n.props.remarks.isEditing&&(n.props.remarks.editor.emit(w.RemarksFocusChanged,!1),n.props.remarks.isEditing=!1)},n._onKeyDown=function(t){var e=n.mentionPop&&n.mentionPop.inMention,o=Object(p.f)(n.props.remarks.richTextEditor).replace(/\s/g,""),i=t.keyCode===r.ENTER;if(!i||t.shiftKey||t.ctrlKey||t.altKey||t.metaKey||e)if(t.keyCode===r.ESC){if(!o.length){var a=n.props.remarks.editor.spread.gcSpread.getActiveSheet();n._removeRemarks(a),n.resetState()}}else(t.keyCode===r.Z||t.keyCode===r.Y||i)&&n._onContentChange();else{n._endInput();var s=n.state.activeCell;if(o.length&&s){var c=s.row,u=s.col,l=s.sheet.remarks.get(c,u);n.setState({activeCell:Object.assign(s,{remarks:l})})}else n.resetState();t.preventDefault()}},n._onClick=function(t){if(t.target){var e=t.target;if("a"===e.tagName.toLowerCase()){var r=e.dataset,o=r.docType,i=r.fileGuid;o&&i&&"user"!==o&&(window.open("/"+o+"/"+i),t.preventDefault())}n.props.remarks.editor.spread.gcSpread.focus(!1)}},n._onContentChange=function(){n.setState({content:Object(p.f)(n.props.remarks.richTextEditor)})},n._activeEditor=function(t){var e=n.props.remarks,r=e.editor,o=e.richTextEditor,i=r.spread.gcSpread.getActiveSheet(),a=n.state.activeCell,s=a.row,c=a.col;n.props.remarks.isEditing=!0,r.spread.gcSpread.focus(!1),r.emit(w.RemarksFocusChanged,!0);var l=i.remarks.get(s,c),p=O(u.DEFAULT_STYLE,u.ZOOM_FACTOR);if(o.activate(i,p,!1),t){var f=l||{},d=f.content,h=void 0===d?"":d,m=f.richText,v=void 0===m?[]:m,b=f.width,_=void 0===b?P:b,g=f.height,y=void 0===g?U:g;o.setRichTextContent(h,v,u.ZOOM_FACTOR,!1,0),n.setState({width:_,height:y}),h.length&&o.selectionHelper.setCaretToEnd(),n.setState({content:h})}},n._insertRemarks=function(){k(2,"14000");var t=n.props.remarks.editor,e=t.spread.gcSpread.getActiveSheet(),r=C(e),o=r.row,i=r.col,a={row:o,col:i,remarks:{content:"",row:o,col:i},sheet:e};e.remarks.get(o,i)||(e.remarks.set(o,i,{content:""}),e.repaint()),n.setState({show:!0,activeCell:a},function(){n._activeEditor(!0),t.emit(w.CellAppendantPositionChanged,{cell:a})}),n._setEditableStatus(!0)},n._onRemarksRemoved=function(t){if(n.state.activeCell){var e=n.state.activeCell,r=e.row,o=e.col;t.some(function(t){return t.row===r&&t.col===o})&&n.resetState()}},n._endInput=function(t){var e=n.props.remarks,r=e.editor,o=e.richTextEditor;if(n.props.remarks.isEditing){r.spread.gcSpread.focus(!0),r.emit(w.RemarksFocusChanged,!1),n.props.remarks.isEditing=!1;var i=Object(p.f)(o).replace(/\s/g,""),a=t||r.spread.gcSpread.getActiveSheet();i.length?n._setRemarks(a):n._removeRemarks(a)}},n._setRemarks=function(t){if(n.state.activeCell){var e=n.state.activeCell,r=e.row,o=e.col,i=n.props.remarks,a=i.editor,s=i.richTextEditor,c=t.remarks.get(r,o),l=T(s.editableDiv,u.ZOOM_FACTOR,s.editableDivId);if(!l||!l.length)return;var f=l.map(function(t){return t.text}).join(""),d=S(f,u.DEFAULT_STYLE,l,!0,!1),h=d.richTextItems,m=d.cellStyle;m&&(Object(p.c)(m),h.forEach(function(t){Object.keys(m).forEach(function(e){return!t.style[e]&&(t.style[e]=m[e])})}));var v=m||u.DEFAULT_STYLE;Object(p.c)(v);var b=[{data:f.length,style:v}],_=h&&h.length>0?h:b,g=n.state,y=g.width,x=g.height;if(!c||c.content!==f||c.width!==y||c.height!==x||!Object(p.h)(c.richText||[],_)){var w=Object(p.b)(a,c&&c.richText||[],_,t.guid()),E=Object(p.d)({row:r,col:o,content:f,sheet:t,richText:_,width:y,height:x,mentionGuid:w});t.remarks.set(r,o,{content:f,richText:_,width:y,height:x,mentionGuid:w}),a.calcOperator({operator:E,label:"remarks"}),t.repaint()}}},n._removeRemarks=function(t){var e=n.state.activeCell,r=e.row,o=e.col,i=n.props.remarks.editor,a=t.remarks.get(r,o);if(t.remarks.remove(r,o),a&&a.content){var s=Object(p.e)(t,[{row:r,col:o}]);i.calcOperator({operator:s,label:"remarks"})}t.repaint()},n._onLayoutChanged=function(){var t=n.props.remarks,e=t.editor,r=t.richTextEditor,o=e.spread.gcSpread.getActiveSheet(),i=n.state.activeCell;if(n.state.show&&i){var a=i.row,s=i.col,c=i.remarks,l=i.sheet;if(c&&(c.content||o!==l)){var p=c.row,f=c.col,d=o.remarks.get(p,f),h=!(c===d||!d||d.row!==p||d.col!==f),m=c===d||h;if(m||n.state.show){if(n.setState({show:m,content:m&&d?d.content:"",activeCell:Object.assign(i,{row:p,col:f})}),h&&d){r.setRichTextContent(d.content,d.richText||[],u.ZOOM_FACTOR,!1,void 0,!0);var v=d.width,b=void 0===v?P:v,_=d.height,g=void 0===_?U:_;n.setState({width:b,height:g})}!m||a===p&&s===f||e.emit(w.CellAppendantPositionChanged,{cell:{row:p,col:f}}),o!==l&&n._endInput(l),!m&&n.resetState()}}}},n._handleMouseClick=function(t){var e=t.type,r=n.props.remarks.editor.spread.gcSpread.getActiveSheet(),o="CellClick"===e?"click":"hide",i=C(r),a=i.row,s=i.col;Object(p.a)(r,a,s)&&n._toggleRemarks(r,i,o)},n._handleMouseMove=function(){var t=n.props.remarks.editor.spread.gcSpread.getActiveSheet();if(t&&t._currentTarget){var e=t._currentTarget,r=e.row,o=e.col,i=e.rowViewportIndex,a=e.colViewportIndex;-1===i||-1===a||null==r||null==o?!n.state.activeCell&&n.resetState():Object(p.a)(t,r,o)&&n._toggleRemarks(t,{row:r,col:o},"hover")}},n._toggleRemarks=function(t,e,r){var o=e.row,i=e.col,a=n.props.remarks,s=a.editor,c=a.richTextEditor,l=a.isEditing,p="click"===r,f=n.state.activeCell,d=t.remarks.get(o,i),h=!1;if("hover"===r){if(h=!!d,f||g(s))return;h&&(n.hoveredCell=e)}else if(p){var m=f&&f.row===o&&f.col===i;h=m?!n.state.show:!!d}l&&n._endInput(),f=h&&d&&p?{row:o,col:i,remarks:d,sheet:t}:null;var v={show:h,content:h&&d?d.content:"",activeCell:f};if(h&&d){c.setRichTextContent(d.content,d.richText||[],u.ZOOM_FACTOR,!1,0,!0);var b=d.width,_=void 0===b?P:b,y=d.height,x=void 0===y?U:y;Object.assign(v,{width:_,height:x}),n._setEditableStatus(t.isRangeEditable(o,i,1,1))}n.setState(v,function(){h&&d&&s.emit(w.CellAppendantPositionChanged,{cell:e})})},n._startResize=function(t){var e=n.props.remarks.editor.spread.gcSpread.getActiveSheet(),r=t.target;if(r&&"remarks-box-resize"===r.id){var o=n.state,i=o.width,a=o.height;if(n.isResizing=!0,n.startX=t.pageX,n.startY=t.pageY,n.startResizingWidth=i,n.startResizingHeight=a,!n.state.activeCell&&n.hoveredCell){var s=n.hoveredCell,c=s.row,u=s.col,l={row:c,col:u,remarks:e.remarks.get(c,u),sheet:e};n.hoveredCell=null,n.setState({activeCell:l})}t.stopPropagation()}},n._doResize=function(t){var e=t.pageX,r=t.pageY;if(n.isResizing){var o=n.startResizingWidth+e-n.startX,i=n.startResizingHeight+r-n.startY;n.setState({width:Math.min(Math.max(P,o),D),height:Math.min(Math.max(U,i),B)})}},n._endResize=function(){if(n.isResizing){n.isResizing=!1;var t=n.props.remarks.editor.spread.gcSpread.getActiveSheet();n._setRemarks(t)}},n.state={show:!1,content:"",width:P,height:U,activeCell:null},n}return m(e,t),e.prototype.componentDidMount=function(){var t=this.props.remarks,e=t.editor;e.on(w.AfterHoveredCellChanged,this._handleMouseMove),e.on(w.SetContentSucceeded,this._rebindGcEvents),t.on(l.a.InsertRemarks,this._insertRemarks),t.on(l.a.RemoveRemarks,this._onRemarksRemoved),this._bindGcEvents(),this._bindResizeEvents(),this._initEditor(),this.__bindRemarksEditorEvents(),this.__changeMountedState()},e.prototype.componentWillUnmount=function(){var t=this.props.remarks,e=t.editor;e.off(w.AfterHoveredCellChanged,this._handleMouseMove),e.off(w.SetContentSucceeded,this._rebindGcEvents),t.off(l.a.InsertRemarks,this._insertRemarks),t.off(l.a.RemoveRemarks,this._onRemarksRemoved),this._unbindGcEvents(),this._unbindResizeEvents(),this.__unbindRemarksEditorEvents()},e.prototype.render=function(){var t=this.state,e=t.show,n=t.content,r=t.width,o=t.height,i=t.activeCell,s=!n.length,c=e&&i;return a.a.createElement("div",{className:"remarks-box-wrapper"+(e?"":" hide"),spellCheck:!1,ref:"remarksBoxWrapper","data-show-type":c?"active":e?"hover":""},a.a.createElement("div",{className:"remarks-input-placeholder"+(s?"":" hide")},d()("按enter发送，shift+enter换行")),a.a.createElement("div",{className:"remarks-editor-wrapper",ref:"remarksEditorWrapper",style:{width:r,height:o}},a.a.createElement("div",{ref:"resizeIcon",className:"remarks-box-resize",id:"remarks-box-resize"})))},e.prototype._initEditor=function(){var t=this.props.remarks.richTextEditor.editableDiv,e=c.a.findDOMNode(this.refs.remarksEditorWrapper);e&&e.appendChild(t),this._initMention()},e.prototype._bindResizeEvents=function(){document.addEventListener("mousedown",this._startResize),document.addEventListener("mousemove",this._doResize),document.addEventListener("mouseup",this._endResize)},e.prototype._unbindResizeEvents=function(){document.removeEventListener("mousedown",this._startResize),document.removeEventListener("mousemove",this._doResize),document.removeEventListener("mouseup",this._endResize)},e.prototype._bindGcEvents=function(){var t=this.props.remarks.editor.spread.gcSpread;t.bind(M,this._onLayoutChanged),t.bind(R,this._handleMouseClick),t.bind(j,this._handleMouseClick),t.bind(I,this._hideOnSheetScroll),t.bind(N,this._hideOnSheetScroll)},e.prototype._unbindGcEvents=function(){var t=this.props.remarks.editor.spread.gcSpread;t.unbind(M,this._onLayoutChanged),t.unbind(R,this._handleMouseClick),t.unbind(j,this._handleMouseClick),t.unbind(I,this._hideOnSheetScroll),t.unbind(N,this._hideOnSheetScroll)},e.prototype._initMention=function(){var t=this,e=this.props.remarks,n=e.editor,r=e.richTextEditor,o=n.pluginManager.get("MentionPlugin");o&&o.instance?this.__createMention(o.instance,r.editableDiv):n.on(w.PluginInstalled,function(e){var n=e.name,o=e.instance;"MentionPlugin"===n&&o&&t.__createMention(o,r.editableDiv)})},e.prototype.__createMention=function(t,e){this.mentionPop=t.createMention({editor:e,id:"sheet-remarks-mention"})},e.prototype._setEditableStatus=function(t){this.props.remarks.richTextEditor.editableDiv.setAttribute("contenteditable",""+t),this.refs.resizeIcon.style.display=t?"block":"none"},e}(y);e.c=F},91:function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var o,i=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?t:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},92:function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},93:function(t,e){t.exports=function(){this.__data__=[]}},94:function(t,e,n){var r=n(14),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():o.call(e,n,1),0))}},95:function(t,e,n){var r=n(14);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},96:function(t,e,n){var r=n(14);t.exports=function(t){return r(this.__data__,t)>-1}},97:function(t,e,n){var r=n(14);t.exports=function(t,e){var n=this.__data__,o=r(n,t);return o<0?n.push([t,e]):n[o][1]=e,this}},98:function(t,e,n){var r=n(13);t.exports=function(){this.__data__=new r}},99:function(t,e){t.exports=function(t){return this.__data__.delete(t)}}})});