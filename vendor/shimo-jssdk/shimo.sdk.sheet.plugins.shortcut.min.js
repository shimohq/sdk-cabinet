!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://assets.smcdn.cn/sheet/",r(r.s=1246)}({1:function(e,t,r){"use strict";var n=function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function u(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(c,u)}a((n=n.apply(e,t||[])).next())})},i=function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},c=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],c=0,u=i.length;c<u;c++,o++)n[o]=i[c];return n};Object.defineProperty(t,"__esModule",{value:!0});var u=r(18),a=r(38),s={},l=function(e){return s[e]||(s[e]=g()),s[e]};t.getS18n=l;var f=function(){s={}};t.DEBUG_reset=f;var h=function(){return s};t.DEBUG_getInstances=h;var g=function(){var e,t,r="zh-CN",s="zh-CN",g={},p=function(e,t){if(!u.isValidLocaleResource(t))throw new Error("fetched locale resource is invalid");g[e]=n(n({},g[e]||{}),t)},d=function(e,r){return o(void 0,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return!r&&g[e]?[3,2]:t?[4,t(e)]:[3,2];case 1:n=o.sent(),p(e,n),o.label=2;case 2:return[2]}})})},m=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("string"==typeof e[0]){var n=e[0],o=e[1],i=o&&"string"==typeof o._?o._:void 0,u=i?n+"#"+i:n;if(!u)return"";var l=a.getTextResult(u,g[r]);if("string"==typeof l)return l;var f=a.getTextResult(u,g[s]);return"string"==typeof f?f:n}if(e[0]&&"number"==typeof e[0].length){var h=e[0],p=e.slice(1);return a.getInterpolateResult(h,p,g[r])||a.getInterpolateResult(h,p,g[s])||a.interweave(h,p)}return console.warn.apply(console,c(["[s18n] invalid input:"],e)),""};return m.configure=function(r){if(r.fetchLocale){if("function"!=typeof r.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");t=r.fetchLocale}if(r.fetchLocaleSync){if("function"!=typeof r.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");e=r.fetchLocaleSync}},m.addLocaleResource=p,m.setLocaleAsync=function(e,t){return o(void 0,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:if("string"!=typeof e)throw new Error("'locale' is required");return[4,d(e)];case 1:return n.sent(),r=e,"string"==typeof t&&(d(t),s=t),[2]}})})},m.setLocaleSync=function(t){if("string"!=typeof t)throw new Error("'locale' is required");if(e){var n=e(t);p(t,n)}r=t},m.getLocale=function(){return r},m.DEBUG_getLocaleResources=function(){return g},m.getS18n=l,m.DEBUG_reset=f,m.DEBUG_getInstances=h,m},p=l("__default_namespace__");e.exports=p,t.default=p},10:function(e,t){e.exports=function(e){return!!e&&"object"==typeof e}},116:function(e,t,r){var n=r(122);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},12:function(e,t,r){var n=r(41),o=r(81),i=r(68),c=r(17),u=r(34),a=r(36);e.exports=function(e){var t=a(e);if(!t&&!c(e))return o(e);var r=i(e),s=!!r,l=r||[],f=l.length;for(var h in e)!n(e,h)||s&&("length"==h||u(h,f))||t&&"constructor"==h||l.push(h);return l}},122:function(e,t,r){var n=r(61),o=1/0,i=1.7976931348623157e308;e.exports=function(e){return e?(e=n(e))===o||e===-o?(e<0?-1:1)*i:e==e?e:0:0===e?e:0}},1246:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){var n=r(148),o=(r.n(n),r(236)),i=r.n(o),c=r(2),u=(r.n(c),r(960)),a=(r(1247),r(1)),s=r.n(a),l=r(1250),f=this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),h=this&&this.__assign||function(){return(h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},g=c.sheets.Core,p=c.sheets.range.searchSelectionRange,d=c.sheets.direction.Direction,m=c.sheets,v=m.root,w=m.track,y=m.path,C=m.alert,S=m.Events,b=m.shortcut,x=m.Plugin,O=m.clipboard,k=m.sheet,R=y.setByPath,E=C.showAlert,A=b.binder,P=O.doPaste,j=g.Spread.Sheets,_=j.HorizontalPosition,M=j.VerticalPosition,T=k.isSelectedColumns,I=k.isSelectedRows,D=(k.getActiveCell,k.getCell,c.sheets),B=D.selection,F=D.cell,L=(c.Editor,F.isActiveCellHasFormula),N=F.getActiveCellAttrByName,K=F.isMentionCell,G=F.isCheckBoxCellType,H=F.isDateMentionCell,W=F.hasCSEFormulaCellsInRange,q=F.getCellOffsetInView,z=B.getCurSelection,Z=B.getAllSelections,J=n.isMac(),U=n.isFireFox(),V="Shortcut",$={b:66,e:69,i:73,u:85,p:80,k:75,m:77,minus:189,minus_firefox:173,equal:187,equal_firefox:61,zero:48,f4:115,f2:113,f:70,s:83,x:88,y:89,d:68,semicolons:186,semicolons_firefox:59,colon:222},Y=function(t){function r(e){var n=t.call(this,{name:V,Constructor:r,config:e})||this,o=e.editor;return n.editor=o,n.options=e,o.isRendered?n.init():n.editor.once(S.Rendered,n.init.bind(n)),e.commonShortcuts&&e.commonShortcuts.length&&n.bindCommonShortCuts(e.commonShortcuts),n.bindDialogShortCuts(),n.handlerMouseWheelFunc=n.handlerMouseWheel.bind(n),window.addEventListener("mousewheel",n.handlerMouseWheelFunc),window.addEventListener("DOMMouseScroll",n.handlerMouseWheelFunc),n.install(),n}return f(r,t),r.prototype.setLocale=function(e){s.a.setLocaleSync(e)},r.prototype.handlerMouseWheel=function(e){if(e.altKey){e.preventDefault();var t=e.wheelDelta||-1*e.detail,r=this.editor.spread.getActiveSheet();r.gcSheet.isEditing()||this.setSheetZoom(r,t>0?50:-50)}},r.prototype.bindCommonShortCuts=function(e){e.forEach(function(e){var t=e.key,r=e.fn;return A.bind(t,r)})},r.prototype.unbindCommonShortCuts=function(e){e.forEach(function(e){var t=e.key;return A.unbind(t)})},r.prototype.bindDialogShortCuts=function(){A.bind("enter",function(){var t=e(".sm-btn-shortcut-confirm");t=t.filter(function(e){return t.eq(e).width()>0&&!t.eq(e).parents().hasClass("hidden")});var r=e(document.activeElement),n=t.length;return!(n&&!r.is("input")&&!r.is("textarea"))||(t.eq(n-1).click(),!1)}),A.bind("escape",function(){var t=e(".sm-icon-shortcut-close");(t=t.filter(function(e){return t.eq(e).width()>0&&!t.eq(e).parents().hasClass("hidden")})).length&&t.eq(t.length-1).click()})},r.prototype.init=function(){var e=this.getShortcutsOpts(),t=e.commandManager,r=e.commandKeys;this.setConstrainedShortcuts(t,r)},r.prototype.getShortcutsOpts=function(){return{commandManager:this.getGcSpread().commandManager(),commandKeys:i()(g.Spread.Commands.Key,$)}},r.prototype.setConstrainedShortcuts=function(e,t){var r=this,n=["left","up","right","down"],o=this.editor.pluginManager.get("PivotTable")&&this.editor.pluginManager.get("PivotTable").instance;e.register("custom-search",function(){return r.editor.emit(S.ToggleSearch),w(2,"0046"),!0}),e.register("custom-active-cell",function(){var e=r.getGcSheet();if(!e.isRangeEditable(e.getSelections()))return!0;r.getGcSheet().startEdit()}),e.register("custom-link",function(){var e=r.getGcSheet(),t=e.getSelections(),n=t[0],i=n.row,c=n.col;if(K(e,i,c))return E({title:s()("包含 @ 的单元格不能插入链接"),type:"error"}),!0;if(G(e.getCellType(i,c)))return E({title:s()("复选框不可直接编辑，请删除后再插入"),type:"error"}),!0;if(H(e,i,c))return E({title:s()("日期提醒不可直接编辑，请删除后再插入"),type:"error"}),!0;var u=!o||!o.pivotRangeHelpers.isPivotTableExcludedCell(e,i,c);return!!(!e.isRangeEditable(t)||L(e)||e.isArrayComputedCell(i,c)&&u)||(r.getSheet().actions.showInsertLinkDialog(e),w(2,"0044"),!0)}),e.register("custom-checkbox",function(){var e=r.getGcSheet(),t=e.getSelections(),n=t[0],i=n.row,c=n.col;if(H(e,i,c))return E({title:s()("日期提醒不可直接编辑，请删除后再插入"),type:"error"}),!0;var u=!o||!o.pivotRangeHelpers.isPivotTableExcludedCell(e,i,c);return!!(!e.isRangeEditable(t)||e.isArrayComputedCell(i,c)&&u||e.isCSEFormulaCell(i,c)||W(e,z(e)))||(r.getSheet().insertCheckbox(),w(2,"8103"),!0)}),e.register("custom-merge-cell",function(){var e=r.getSheet(),t=r.getGcSheet();return!(!t.isEditing()&&t.isRangeEditable(t.getSelections()))||(e.actions.mergeOrUnmergeCells(),w(2,"0035"),!0)});var i=function(e){var t=r.editor,n=r.getGcSheet(),o=t.pluginManager.get("Outline");o&&o.instance&&(e?o.instance.group(n):o.instance.ungroup(n))};e.register("custom-group",function(){return i(!0),!0}),e.register("custom-ungroup",function(){return i(!1),!0}),e.register("custom-show-formula",function(){w(2,"8905");var e=r.getGcSpread(),t=r.getGcSheet();return e.options.showFormula=!e.options.showFormula,t.repaint(),!0}),[t.equal,t.minus].forEach(function(n){var o=n===t.equal;e.register("custom-"+(o?"add":"delete")+"-row-col",function(){var e=r.getSheet(),t=e.gcSheet;if(t.isEditing())return!0;var n=e.getCurSelection(),i=n.row,c=n.rowCount,u=n.colCount,a=n.col,s=I(t),l=T(t),f=t.getSelections(),h=u===e.getColumnCount(),g=c===e.getRowCount();return s&&l||!s&&!l||!t.isRangeEditable(f)?(r.showContextMenu(t,i,a,u,c),!0):s?o?(e.addRows(i,c,d.Up),!0):(g?r.showContextMenu(t,i,a,u,c):e.removeRows(i,c),!0):!l||(o?e.addColumns(a,u,d.Left):h?r.showContextMenu(t,i,a,u,c):e.removeColumns(a,u),!0)},n,!J,!0,!1,J)}),e.register("custom-comment",function(){var e=r.getGcSheet(),t=z(e);if(!r.editor.permissions.query.canCommentRange({sheetId:e.guid(),range:t}))return!0;var n=r.editor.pluginManager.get("Comment");return n&&n.instance&&n.instance.startComment(),!0}),e.register("custom-midline",function(){var e=r.getGcSheet(),t=r.editor.spread.getActiveSheet();return!e.isRangeEditable(e.getSelections())||(e.isEditing()?e.setEditingStyle(e.getActiveRowIndex(),e.getActiveColumnIndex(),"strikeThrough"):t.actions.setStyle(t.gcSheet,Z(t.gcSheet),"strike",!N(t.gcSheet,"strike")),w(2,"0031"),!0)}),n.forEach(function(t){e.register("custom-"+t,function(e){return function(){var t=r.editor.spread.getActiveSheet();if(!t.gcSheet.isEditing()){var n=t.getActiveCellPosition(),o=r.getNextCellPosByDirection(e,h({},n),t);return t.setActiveCell(o.row,o.column),t.gcSheet.showCell(o.row,o.column,1,1),!0}}}(t))}),e.register("custom-shift-left",function(){var e=r.editor.spread.getActiveSheet(),t=e.gcSheet.getSelections();if(!e.gcSheet.isEditing()&&t.length){var n,o=e.getActiveCellPosition(),i=t[t.length-1],c=i.col+i.colCount-1;n=o.column===c?{row:o.row,column:i.col}:{row:o.row,column:c};var u=r.getNextCellPosByDirection("left",h({},n),e);u.row=-1===u.row?0:u.row,u.column=-1===u.column?0:u.column;var a=r.checkCellInRange(u,i),s=i.row,l=i.rowCount,f=void 0,g=void 0;a?(f=Math.min(u.column,o.column),g=Math.abs(o.column-u.column)+1):(f=u.column,g=Math.abs(o.column-f)+1);var p={row:s,col:f,rowCount:l,colCount:g};return e.setSelectionWithActiveCell(o,p),e.gcSheet.showColumn(f,_.left),!0}}),e.register("custom-shift-right",function(){var e=r.editor.spread.getActiveSheet(),t=e.gcSheet.getSelections();if(!e.gcSheet.isEditing()&&t.length){var n,o=e.getActiveCellPosition(),i=t[t.length-1],c=i.col;n=o.column===c?{row:o.row,column:i.col+i.colCount-1}:{row:o.row,column:c};var u=r.getNextCellPosByDirection("right",h({},n),e);u.row=-1===u.row?0:u.row,u.column=-1===u.column?0:u.column;var a=r.checkCellInRange(u,i),s=i.row,l=i.rowCount,f=void 0,g=void 0;a?(f=u.column,g=Math.abs(o.column-u.column)+1):(f=o.column,g=Math.abs(u.column-o.column)+1);var p={row:s,col:f,rowCount:l,colCount:g};return e.setSelectionWithActiveCell(o,p),e.gcSheet.showColumn(f+g-1,_.right),!0}}),e.register("custom-shift-up",function(){var e=r.editor.spread.getActiveSheet(),t=e.gcSheet.getSelections();if(!e.gcSheet.isEditing()&&t.length){var n,o=e.getActiveCellPosition(),i=t[t.length-1],c=Math.max(o.row,i.row+i.rowCount-1);n=o.row===c?{row:i.row,column:o.column}:{row:i.row+i.rowCount-1,column:o.column};var u=r.getNextCellPosByDirection("up",h({},n),e);u.row=-1===u.row?0:u.row,u.column=-1===u.column?0:u.column;var a=r.checkCellInRange(u,i),s=i.col,l=i.colCount,f=void 0,g=void 0;a?(f=0===u.row?0:o.row,g=Math.abs(o.row-u.row)+1):(f=u.row,g=Math.abs(o.row-f)+1);var p={row:f,col:s,rowCount:g,colCount:l};return e.setSelectionWithActiveCell(o,p),e.gcSheet.showRow(f,M.top),!0}}),e.register("custom-shift-down",function(){var e=r.editor.spread.getActiveSheet(),t=e.gcSheet.getSelections();if(!e.gcSheet.isEditing()&&t.length){var n,o=e.getActiveCellPosition(),i=t[t.length-1],c=Math.min(o.row,i.row);n=o.row===c?{row:i.row+i.rowCount-1,column:o.column}:{row:i.row,column:o.column};var u=r.getNextCellPosByDirection("down",h({},n),e);u.row=-1===u.row?0:u.row,u.column=-1===u.column?0:u.column;var a=r.checkCellInRange(u,i),s=i.col,l=i.colCount,f=void 0,g=void 0;a?(f=u.row,g=Math.abs(o.row-u.row)+1):(f=o.row,g=Math.abs(o.row-u.row)+1);var p={row:f,col:s,rowCount:g,colCount:l};return e.setSelectionWithActiveCell(o,p),e.gcSheet.showRow(f+g-1,M.bottom),!0}}),e.register("custom-a",function(){var e=r.editor.spread.getActiveSheet(),t=e.gcSheet.pictures;if(t.getSelected().length>0)return t.selectAll(),!0;var n=e.getCurSelection(),o=e.getRowCount(),i=e.getColumnCount();if((0!==n.row||0!==n.col||n.rowCount!==o||n.colCount!==i)&&!e.gcSheet.isEditing()){if(r.checkActiveCellWithNullCellInColOrRow(e,o,i))return;var c=p(e.gcSheet,Object.assign({},n));if(1===c.colCount&&1===c.rowCount)return;if(JSON.stringify(n)===JSON.stringify(c))return;return e.gcSheet.setSelection(c.row,c.col,c.rowCount,c.colCount),!0}}),e.register("custom-insertTime",function(){var e=r.getGcSheet(),t=e.getSelections();if(!e.isRangeEditable(t))return!0;if(r.isCheckBoxCell(e))return E({title:s()("复选框不可直接编辑，请删除后再插入"),type:"error"}),!0;var n=t[0],o=n.row,i=n.col;return H(e,o,i)?(E({title:s()("日期提醒不可直接编辑，请删除后再插入"),type:"error"}),!0):(r.insertDateTime("time"),!0)}),e.register("custom-insertDate",function(){var e=r.getGcSheet(),t=e.getSelections();if(!e.isRangeEditable(t))return!0;if(r.isCheckBoxCell(e))return E({title:s()("复选框不可直接编辑，请删除后再插入"),type:"error"}),!0;var n=t[0],o=n.row,i=n.col;return H(e,o,i)?(E({title:s()("日期提醒不可直接编辑，请删除后再插入"),type:"error"}),!0):(r.insertDateTime("date"),!0)}),e.register("custom-insertDateTime",function(){var e=r.getGcSheet(),t=e.getSelections();if(!e.isRangeEditable(t))return!0;if(r.isCheckBoxCell(e))return E({title:s()("复选框不可直接编辑，请删除后再插入"),type:"error"}),!0;var n=t[0],o=n.row,i=n.col;return H(e,o,i)?(E({title:s()("日期提醒不可直接编辑，请删除后再插入"),type:"error"}),!0):(r.insertDateTime(),!0)}),e.register("custom-newtab-open-desk",function(){return window.open(location.origin+"/desktop","_blank"),!0});var c=this.editor.spread.gcSpread._clipboardHelper,a=c._getPasteOptionsConfig(),f=a.value,g=a.style,m=a.span,v=a.conditionalFormat,y=a.columnWidth,C=a.all;[{key:"value",pasteOption:f},{key:"style",pasteOption:g^m^v^y}].forEach(function(t){e.register("custom-paste-"+t.key,function(){var e=t.pasteOption;return!Object(u.c)(r.editor)&&(c._isCutting&&(e=C),w(2,"value"===t.key?"7016":"7017"),P(r.editor,{pasteOption:e}),!0)})}),e.register("custom-print",function(){return!0}),e.register("custom-fill-area",function(){var e=r.getGcSheet(),t=e.getSelections();return(1!==t.length||1!==t[0].rowCount||1!==t[0].colCount)&&(Object(u.b)(r.editor,e,t),!0)});["left","right"].forEach(function(n){e.register("custom-switch-sheet",function(){var e=r.editor.spread,t=e.getVisibleSheets();if(!(t.length<2)){var o,i=e.getActiveSheet().id;t.forEach(function(e,t){e.id===i&&(o=t)});var c=t["left"===n?0===o?t.length-1:o-1:o===t.length-1?0:o+1].id;e.setActiveSheet(c),e.gcSpread.getTab()._moveActiveTabIntoView()}},t[n],!1,!1,!0,!1)}),e.register("custom-intelligent-fill",function(e){var t=r.getSheet(),n=t.gcSheet,o=t.getCurSelection(),i=o.rowCount,c=o.colCount,u=n.getSelections();i<2||c>1||Object(l.a)(r.editor,n,u)},t.e,!0,!1,!1,!1),e.register("customn-select-entire-row",function(){var e=r.getSheet();if(e.gcSheet.isEditing())return!0;var t=e.getCurSelection(),n=t.row,o=t.rowCount,i=e.getActiveCellPosition();return e.setSelectionWithActiveCell(i,{row:n,rowCount:o,col:-1,colCount:e.getColumnCount()}),!0},t.space,!1,!0,!1,!1),e.register("customn-select-entire-col",function(){var e=r.getSheet();if(e.gcSheet.isEditing())return!0;var t=e.getCurSelection(),n=t.col,o=t.colCount,i=e.getActiveCellPosition();return e.setSelectionWithActiveCell(i,{row:-1,rowCount:e.getRowCount(),col:n,colCount:o}),!0},t.space,!1,!0,!0,!1),e.setShortcutKey("custom-active-cell",t.f2,!1,!1,!1,!1),e.setShortcutKey("custom-merge-cell",t.d,!1,!0,!0,!1),e.setShortcutKey("custom-link",t.k,!J,!1,!1,J),e.setShortcutKey("custom-checkbox",t.y,!J,!0,!1,J),e.setShortcutKey("custom-repeat-operation",t.f4,!1,!1,!1,!1),e.setShortcutKey("custom-comment",t.m,!J,!0,!1,J),e.setShortcutKey("custom-search",t.f,!J,!1,!1,J),e.setShortcutKey("custom-midline",t.s,!J,!0,!1,J),n.forEach(function(r){e.setShortcutKey("custom-"+r,t[r],!J,!1,!1,J),e.setShortcutKey("custom-shift-"+r,t[r],!J,!0,!1,J)}),e.setShortcutKey("custom-a",t.a,!J,!1,!1,J),e.setShortcutKey("custom-insertTime",U?t.semicolons_firefox:t.semicolons,!J,!0,!1,J),e.setShortcutKey("custom-insertDate",U?t.semicolons_firefox:t.semicolons,!J,!1,!1,J),e.setShortcutKey("custom-insertDateTime",U?t.semicolons_firefox:t.semicolons,!J,!1,!0,J),e.setShortcutKey("custom-newtab-open-desk",t.e,!J,!0,!1,J),e.setShortcutKey("custom-paste-value",t.v,!J,!0,!1,J),e.setShortcutKey("custom-paste-style",t.v,!J,!1,!0,J),e.setShortcutKey("custom-fill-area",t.enter,!J,!1,!1,J),e.setShortcutKey("custom-group",t.right,!1,!0,!0,!1),e.setShortcutKey("custom-ungroup",t.left,!1,!0,!0,!1),e.setShortcutKey("custom-show-formula",t.colon,!J,!1,!1,J),n.forEach(function(r){var n="up"===r||"down"===r?"row":"col";e.setShortcutKey("custom-insert-"+n+"-"+r,t[r],!0,!0,!1,!1)}),this.addScaleHotKey(e,t)},r.prototype.isCheckBoxCell=function(e){var t=e.getActiveRowIndex(),r=e.getActiveColumnIndex();return G(e.getCellType(t,r))},r.prototype.getDateTime=function(){var e=new Date;return{date:e.getFullYear()+"/"+(e.getMonth()+1<10?"0"+(e.getMonth()+1)+"/":e.getMonth()+1+"/")+e.getDate(),time:e.getHours()+":"+(e.getMinutes()+":")+e.getSeconds()}},r.prototype.insertDateTime=function(e){var t=this.editor.spread.getActiveSheet(),r=t.gcSheet,n=t.getActiveCellPosition(),o=this.getDateTime(),i=o.date,c=o.time,u="time"===e?c:"date"===e?i:i+" "+c;if(r.isEditing()){var a=r._getRichTextEditor();a&&(a.setRichTextContent(u,[],r._zoomFactor,!1,u.length),a.eventCallbacks&&a.eventCallbacks.input&&a.eventCallbacks.input())}else t.setValue(n.row,n.column,u)},r.prototype.addScaleHotKey=function(e,t){var r=this;e.register("custom-scale-minus",function(){var e=r.editor.spread.getActiveSheet();if(!e.gcSheet.isEditing())return r.setSheetZoom(e,-50),!0}),e.register("custom-scale-plus",function(){var e=r.editor.spread.getActiveSheet();if(!e.gcSheet.isEditing())return r.setSheetZoom(e,50),!0}),e.register("custom-scale-reset",function(){var e=r.editor.spread.getActiveSheet();if(!e.gcSheet.isEditing())return r.resetSheetZoom(e),!0}),e.setShortcutKey("custom-scale-minus",U?t.minus_firefox:t.minus,!1,!1,!0,!1),e.setShortcutKey("custom-scale-plus",U?t.equal_firefox:t.equal,!1,!1,!0,!1),e.setShortcutKey("custom-scale-reset",t.zero,!1,!0,!0,!1)},r.prototype.setSheetZoom=function(e,t){var r=100*this.editor.store.getState().sheetZoom.zoomInfo.zoom,n=Math.round(r+t);(n=Math.min(Math.max(n,25),400))!==r&&e.actions.changeSheetZoom(n/100),E({title:n+"%",customCls:"alert-middle",duration:1e3})},r.prototype.resetSheetZoom=function(e){100!==100*this.editor.store.getState().sheetZoom.zoomInfo.zoom&&e.actions.changeSheetZoom(1),E({title:"100%",customCls:"alert-middle",duration:1e3})},r.prototype.getGcSpread=function(){return this.editor.spread.gcSpread},r.prototype.getSheet=function(){return this.editor.spread.getActiveSheet()},r.prototype.getGcSheet=function(){return this.editor.spread.getActiveSheet().gcSheet},r.prototype.destory=function(){this.options.commonShortcuts&&this.options.commonShortcuts.length&&this.unbindCommonShortCuts(this.options.commonShortcuts)},r.prototype.getNextCellPosByDirection=function(e,t,r){var n,o=r.getRowCount(),i=r.getColumnCount(),c=[],u=t.column,a=t.row;switch(e){case"left":for(;t.column-- >=1;)this.isCellHasContent(r,t)&&c.push(t.column);return 0===c.length?{row:t.row,column:0}:(n=this.getContinuousNextNumber(c,u),{row:t.row,column:n});case"up":for(;t.row-- >=1;)this.isCellHasContent(r,t)&&c.push(t.row);return 0===c.length?{row:0,column:t.column}:{row:this.getContinuousNextNumber(c,a),column:t.column};case"right":for(;++t.column<=i-1;)this.isCellHasContent(r,t)&&c.push(t.column);return 0===c.length?{row:t.row,column:i-1}:(n=this.getContinuousNextNumber(c,u),{row:t.row,column:n});case"down":for(;++t.row<=o-1;)this.isCellHasContent(r,t)&&c.push(t.row);return 0===c.length?{row:o-1,column:i}:{row:this.getContinuousNextNumber(c,a),column:t.column}}},r.prototype.isCellHasContent=function(e,t){var r=e.gcSheet,n=r.getStyle(t.row,t.column);return Boolean(null!==r.getValue(t.row,t.column)||n&&n.backgroundImage)},r.prototype.checkActiveCellWithNullCellInColOrRow=function(e,t,r){var n=e.getActiveCellPosition(),o=n.row,i=n.column;if(this.isCellHasContent(e,{row:o,column:i}))return!1;for(var c=!1,u=!1,a=0;a<r;a++)if(a!==i&&this.isCellHasContent(e,{row:o,column:a})){u=!0;break}if(!u)return!0;for(var s=0;s<t;s++)if(s!==o&&this.isCellHasContent(e,{row:s,column:i})){c=!0;break}return!(u&&c)},r.prototype.checkCellInRange=function(e,t){var r=t.row+t.rowCount-1,n=t.col+t.colCount-1,o=t.row,i=t.col;return e.row<=r&&e.row>=o&&e.column<=n&&e.column>=i},r.prototype.getContinuousNextNumber=function(e,t){for(var r=0;r<e.length;r++){var n=e[r],o=n===t+1||n===t-1;if(!o)return 0!==r||o?t:n;t=n}return t},r.prototype.showContextMenu=function(t,r,n,o,i){var c=t.getCellRect(r,n),u=c.x,a=c.y;(u<0||a<0)&&t.showCell(r,n,M.nearest,_.nearest);var s=q(t,r,n),l=s.x,f=s.y,h=e(".sm-sheet-view"),g=h.width(),p=h.height()+h.offset().top,d=50*o+l,m=10*i+f;d>g&&(d=50),m>p&&(m=50);var v=new MouseEvent("contextmenu",{clientX:d,clientY:m,bubbles:!0});document.querySelector("#sm-canvas-container-viewport").dispatchEvent(v)},r}(x);t.default=Y,R(v,"shimo.sdk.sheet.plugins.Shortcut",Y)}.call(t,r(144))},1247:function(e,t,r){"use strict";var n=r(1),o=r.n(n),i=r(1248),c=r.n(i),u=r(1249),a=r.n(u);o.a.addLocaleResource("en-US",c.a),o.a.addLocaleResource("ja-JP",a.a),o.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},1248:function(e,t){e.exports={"编辑的单元格已被锁定":"Editing cells has been locked","您选择的范围里包含部分数组公式，无法填充":"The range you selected contains a partial array formula that cannot be filled","您选择的范围里包含数据透视表，无法填充":"The range you selected contains a pivot table and cannot be filled","包含 @ 的单元格不能插入链接":"Cells containing @ cannot insert links","复选框不可直接编辑，请删除后再插入":"CheckBox cannot be edited directly, please delete and insert","日期提醒不可直接编辑，请删除后再插入":"Date mention cannot be edited directly, please delete and insert"}},1249:function(e,t){e.exports={"编辑的单元格已被锁定":"編集したセルがロックされています","您选择的范围里包含部分数组公式，无法填充":"選択した範囲には、入力できない部分配列数式が含まれています","您选择的范围里包含数据透视表，无法填充":"選択した範囲にはピボットテーブルが含まれているため、入力できません","包含 @ 的单元格不能插入链接":"@を含むセルはリンクを挿入できません","复选框不可直接编辑，请删除后再插入":"チェックボックスを直接編集することはできません。削除して挿入してください","日期提醒不可直接编辑，请删除后再插入":"日付の通知は直接編集できません。削除して挿入してください"}},1250:function(e,t,r){"use strict";t.a=function(e,t,r){var n=m(t),c=n.row,s=n.col,l=Object(i.a)(r,c,s);if(!e.permissions.query.canEditSheet({sheetId:t.guid()}))return;if(!t.isRangeEditable(l))return w({title:u()("编辑的单元格已被锁定"),type:"error"});if(r.some(function(e){return t._hasPartArrayFormulas(e.row,e.col,e.rowCount,e.colCount)}))return w({title:u()("您选择的范围里包含部分数组公式，无法填充"),type:"error"});var f=e.pluginManager.get("PivotTable"),h=f?f.instance.pivotRangeHelpers.hasPivotTableInRange:null;if(h&&r.some(function(e){return h(t,e)}))return w({title:u()("您选择的范围里包含数据透视表，无法填充"),type:"error"});var g=function(e,t,r){var n,i=e.getText(t,r);if(!(i=i&&i.trim()))return;if(r>0){var c=e.isRangeReadableByLock(t,r-1,1,1),u=e.getText(t,r-1);c&&u&&u.length&&(n=b(i,u))}if(n)return a(a({},n),{direction:o.a.Forward});r>0&&(n=x(e,i,t,r,o.a.Forward));if(n)return n;if(r<e.getColumnCount()-1){var c=e.isRangeReadableByLock(t,r+1,1,1),s=e.getText(t,r+1);c&&s&&s.length&&(n=b(i,s))}if(n)return a(a({},n),{direction:o.a.Backward});r<e.getColumnCount()-1&&(n=x(e,i,t,r,o.a.Backward));if(n)return n}(t,c,s);if(!g)return;var p=function(e,t,r){var n=[],o=[];return t.forEach(function(t){for(var i=S(e,t),c=i.row,u=i.col,a=i.rowCount,s=(i.colCount,c+1);s<c+a;s++)if(!e._isRowFilterOut||!e._isRowFilterOut(s)){var l=e.getSpan(s,u),f=v(e,s,u),h=v(e,s,u).attrs,g=void 0;if(l&&l.row!==s)g=e.getValue(s,u);else{var p=e.getValue(s,u);g=(g=O(r,e,s,u))&&g.length?isNaN(+g)?g:+g:p}n.push([s,u,f,{value:g,attrs:h}]),o.push([s,u,g,h])}}),{newCells:o,collectedCells:n}}(t,r,g),k=p.newCells,R=p.collectedCells,E=[{fnName:"editCell2Changeset",params:e.opProcessor([t.guid(),R,{skipParseFormat:!0}])}];y({obj:t,func:C,suspendCalcService:!0})(t,k),e.emit(d.AfterCellsChanged,{sheet:t,cellsData:k}),e.actions.calcOperator({operator:E,isCalcInWorker:k.length>1e3,label:"intelligentFillAreaShortCut"})};var n=r(2),o=(r.n(n),r(1251)),i=r(960),c=r(1),u=r.n(c),a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},s=n.sheets.range,l=n.sheets,f=l.sheet,h=l.alert,g=l.perf,p=l.cellCommand,d=l.Events,m=f.getActiveCell,v=f.getCell,w=h.showAlert,y=g.paintWrap,C=p.setBulkCells,S=s.fixRange;function b(e,t){if((t=t&&t.trim())===e)return{name:o.b.CutOff,isEqual:!0};var r=t.indexOf(e),n=t[r-1],i=t[r+e.length],c=n?t.slice(0,r-1).split(n).length:0,u=i?t.slice(0,r+e.length).split(i).length:0;return r>-1?{name:o.b.CutOff,cutHeadChar:t[r-1],cutTailChar:t[r+e.length],headCharCount:c,tailCharCount:u}:void 0}function x(e,t,r,n,i){var c,u=!1,a="";if(i===o.a.Forward)for(var s=n-1;s>-1;){var l=e.isRangeReadableByLock(r,s,1,1);if((g=e.getText(r,s))&&g.trim().length&&l){var f=g+a;if(t.indexOf(f)>-1&&(u=!0,a=f,f&&(c=s),s--),-1===t.indexOf(f))break}else s--}if(i===o.a.Backward)for(var h=n+1;h<e.getColumnCount();){var g;l=e.isRangeReadableByLock(r,h,1,1);if((g=e.getText(r,h))&&g.trim().length&&l){f=a+g;if(t.indexOf(f)>-1&&(u=!0,a=f,f&&(c=h),h++),-1===t.indexOf(f))break}else h++}if(u){var p=t.indexOf(a),d=t.slice(0,p),m=t.slice(a.length+p);return{name:o.b.Join,direction:i,toCol:c,paddingHeadChar:d,paddingTailChar:m}}}function O(e,t,r,n){switch(e.name){case o.b.CutOff:var i="",c=e.cutHeadChar,u=e.cutTailChar,a=e.isEqual,s=e.headCharCount,l=e.tailCharCount;if(e.direction===o.a.Forward?t.isRangeReadableByLock(r,n-1,1,1)&&(i=t.getText(r,n-1)):t.isRangeReadableByLock(r,n+1,1,1)&&(i=t.getText(r,n+1)),i&&i.length)return function(e,t,r,n,o,i){if(n)return r;var c,u,a;if(e){var s="",l=r.split(e);s=l.filter(function(e,t){return t<o}).join(e),c=s.length,a=c>-1}if(t){var s=void 0,l=r.split(t);s=l.filter(function(e,t){return t<i}).join(t),u=s.length,a=u>-1}if(!a)return;return c=c?c+1:0,u=u||r.length,r.slice(c,u)}(c,u,i,!!a,s,l);break;case o.b.Join:var f=e.toCol;return function(e,t,r,n,i,c,u){var a,s="";if(n===o.a.Forward)for(a=u-1;a>i-1;)if(e.isRangeReadableByLock(c,a,1,1)){var l=e.getText(c,a);s=l+s,a--}else a--;else for(a=u+1;a<i+1;)if(e.isRangeReadableByLock(c,a,1,1)){var l=e.getText(c,a);s+=l,a++}else a++;return""+t+s+r}(t,e.paddingHeadChar,e.paddingTailChar,e.direction,f,r,n)}}},1251:function(e,t,r){"use strict";var n,o;r.d(t,"b",function(){return n}),r.d(t,"a",function(){return o}),function(e){e[e.CutOff=0]="CutOff",e[e.Join=1]="Join"}(n||(n={})),function(e){e[e.Forward=0]="Forward",e[e.Backward=1]="Backward"}(o||(o={}))},131:function(e,t){e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},144:function(e,t){e.exports=Zepto},148:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isRetina=function(){return window.devicePixelRatio>=2},t.isDingTalk=function(){return/dingtalk/i.test(r)},t.isDingtalk=function(){return!!r.match(/mobile.*dingtalk/i)},t.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},t.isWechatPc=n,t.isWxworkPc=o,t.isWechat=function(){return!!/micromessenger/.test(r)&&!n()},t.isMobile=function(){return!n()&&!o()&&!!r.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},t.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},t.isIOS=i,t.isAndroid=function(){return!!/(android)/g.test(r)},t.isAndroidApp=function(){return!!/shimo-android-app/g.test(r)},t.isIE=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},t.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},t.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},t.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},t.isWebIOS=function(){if(!window.cow.iOS&&i())return!0;return!1},t.isIphone6=function(){var e=!1;i()&&screen.height>568&&(e=!0);return e},t.isInWxMp=function(){return!(!navigator.userAgent.match(/micromessenger/i)||!navigator.userAgent.match(/miniprogram/i))||"miniprogram"===window.__wxjs_environment};var r=window.navigator.userAgent.toLowerCase();function n(){return!!/micromessenger.*?windowswechat/.test(r)}function o(){return!!/wxwork.*?micromessenger.*?wechat/i.test(r)}function i(){return!!/(ipad|iphone|ipod)/g.test(r)}},17:function(e,t,r){var n=r(73),o=r(19),i=r(20);e.exports=function(e){return null!=e&&i(n(e))&&!o(e)}},18:function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(37);t.isValidLocaleResource=function(e){return!!e&&(!Array.isArray(e)&&("object"===(void 0===e?"undefined":n(e))&&Object.keys(e).every(function(t){var r=e[t];return null==r||"string"==typeof r||"object"===(void 0===r?"undefined":n(r))})))},t.sourceTextToKey=function(e){switch(e.type){case"string":var t=e.id,r=e.text;return t?r+"#"+t:r;case"interpolated":var n=e.textParts.length;return 1===n?e.textParts[0]:2===n?e.textParts[0]+"%s"+e.textParts[1]:e.textParts.map(function(t,r){return r===e.textParts.length-1?t:t+"%"+(r+1)}).join("");default:return o.assertNever(e)}}},19:function(e,t,r){var n=r(6),o="[object Function]",i="[object GeneratorFunction]",c=Object.prototype.toString;e.exports=function(e){var t=n(e)?c.call(e):"";return t==o||t==i}},2:function(e,t){e.exports=shimo.sdk.sheet},20:function(e,t){var r=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=r}},22:function(e,t,r){var n=r(10),o="[object Symbol]",i=Object.prototype.toString;e.exports=function(e){return"symbol"==typeof e||n(e)&&i.call(e)==o}},236:function(e,t,r){var n=r(64),o=r(77),i=r(258),c=r(17),u=r(36),a=r(12),s=Object.prototype,l=s.hasOwnProperty,f=!s.propertyIsEnumerable.call({valueOf:1},"valueOf"),h=i(function(e,t){if(f||u(t)||c(t))o(t,a(t),e);else for(var r in t)l.call(t,r)&&n(e,r,t[r])});e.exports=h},258:function(e,t,r){var n=r(259),o=r(78);e.exports=function(e){return o(function(t,r){var o=-1,i=r.length,c=i>1?r[i-1]:void 0,u=i>2?r[2]:void 0;for(c=e.length>3&&"function"==typeof c?(i--,c):void 0,u&&n(r[0],r[1],u)&&(c=i<3?void 0:c,i=1),t=Object(t);++o<i;){var a=r[o];a&&e(t,a,o,c)}return t})}},259:function(e,t,r){var n=r(33),o=r(17),i=r(34),c=r(6);e.exports=function(e,t,r){if(!c(r))return!1;var u=typeof t;return!!("number"==u?o(r)&&i(t,r.length):"string"==u&&t in r)&&n(r[t],e)}},29:function(e,t,r){var n=r(63),o="[object Arguments]",i=Object.prototype,c=i.hasOwnProperty,u=i.toString,a=i.propertyIsEnumerable;e.exports=function(e){return n(e)&&c.call(e,"callee")&&(!a.call(e,"callee")||u.call(e)==o)}},33:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},34:function(e,t){var r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){return!!(t=null==t?r:t)&&("number"==typeof e||n.test(e))&&e>-1&&e%1==0&&e<t}},36:function(e,t){var r=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},37:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertNever=function(e){throw new Error("unexpected type: "+JSON.stringify(e))}},38:function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(18);t.interweave=function(e,t){return e.map(function(r,n){return n===e.length-1?r:""+r+t[n]}).join("")},t.getTextResult=function(e,t){return t&&t[e]};var i=/%(s|\d)/g;t.getInterpolateResult=function(e,t,r){try{if(!r)return;var c=o.sourceTextToKey({type:"interpolated",textParts:e}),u=r[c];if(!u)return;var a={},s=0;c.replace(i,function(e){return a[e]=t[s],s+=1,e});return"string"==typeof u?function(e,t){return e.replace(i,function(r){return null!==t[r]?String(t[r]):(console.warn("[s18n] interpolation failed:",{str:e,valueMap:t}),r)})}(u,a):"object"===(void 0===u?"undefined":n(u))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(u))}catch(n){var l={parts:e,values:t,resource:r};return console.error("[s18n] error when translating: ",l),void console.error(n)}}},41:function(e,t,r){var n=r(54),o=Object.prototype.hasOwnProperty;e.exports=function(e,t){return o.call(e,t)||"object"==typeof e&&t in e&&null===n(e)}},44:function(e,t,r){var n=r(5),o=r(10),i="[object String]",c=Object.prototype.toString;e.exports=function(e){return"string"==typeof e||!n(e)&&o(e)&&c.call(e)==i}},5:function(e,t){var r=Array.isArray;e.exports=r},54:function(e,t){var r=Object.getPrototypeOf;e.exports=function(e){return r(Object(e))}},55:function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},6:function(e,t){e.exports=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}},61:function(e,t,r){var n=r(19),o=r(6),i=r(22),c=NaN,u=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,f=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return c;if(o(e)){var t=n(e.valueOf)?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(u,"");var r=s.test(e);return r||l.test(e)?f(e.slice(2),r?2:8):a.test(e)?c:+e}},63:function(e,t,r){var n=r(17),o=r(10);e.exports=function(e){return o(e)&&n(e)}},64:function(e,t,r){var n=r(33),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var i=e[t];o.call(e,t)&&n(i,r)&&(void 0!==r||t in e)||(e[t]=r)}},68:function(e,t,r){var n=r(82),o=r(29),i=r(5),c=r(20),u=r(44);e.exports=function(e){var t=e?e.length:void 0;return c(t)&&(i(e)||u(e)||o(e))?n(t,String):null}},73:function(e,t,r){var n=r(55)("length");e.exports=n},77:function(e,t,r){var n=r(64);e.exports=function(e,t,r,o){r||(r={});for(var i=-1,c=t.length;++i<c;){var u=t[i],a=o?o(r[u],e[u],u,r,e):e[u];n(r,u,a)}return r}},78:function(e,t,r){var n=r(131),o=r(116),i="Expected a function",c=Math.max;e.exports=function(e,t){if("function"!=typeof e)throw new TypeError(i);return t=c(void 0===t?e.length-1:o(t),0),function(){for(var r=arguments,o=-1,i=c(r.length-t,0),u=Array(i);++o<i;)u[o]=r[t+o];switch(t){case 0:return e.call(this,u);case 1:return e.call(this,r[0],u);case 2:return e.call(this,r[0],r[1],u)}var a=Array(t+1);for(o=-1;++o<t;)a[o]=r[o];return a[t]=u,n(e,this,a)}}},81:function(e,t){var r=Object.keys;e.exports=function(e){return r(Object(e))}},82:function(e,t){e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},960:function(e,t,r){"use strict";t.c=function(e){return e.spread.getActiveSheet().gcSheet.isEditing()},t.b=function(e,t,r){var n=w(t),o=n.row,c=n.col,u=b(r,o,c);if(!e.permissions.query.canEditSheet({sheetId:t.guid()}))return;if(!t.isRangeEditable(u))return d({title:i()("编辑的单元格已被锁定"),type:"error"});if(r.some(function(e){return t._hasPartArrayFormulas(e.row,e.col,e.rowCount,e.colCount)}))return d({title:i()("您选择的范围里包含部分数组公式，无法填充"),type:"error"});var a=e.pluginManager.get("PivotTable"),s=a?a.instance.pivotRangeHelpers.hasPivotTableInRange:null;if(s&&r.some(function(e){return s(t,e)}))return d({title:i()("您选择的范围里包含数据透视表，无法填充"),type:"error"});var l=t.isEditing(),f=y(t,o,c);if(l)try{var m=t.endEdit(!1,!1,!1);if(!m)return}catch(e){console.log(e)}var x=function(e,t,r,n,o){var i=r.fromRow,c=r.fromCol,u=[],a=[],s=y(e,i,c);return t.forEach(function(t){for(var r=v(e,t),l=r.row,f=r.col,h=r.rowCount,g=r.colCount,d=l;d<l+h;d++)if(!e._isRowFilterOut||!e._isRowFilterOut(d))for(var m=function(t){if(d!==i||t!==c||o){var r=y(e,d,t),l=e.getSpan(d,t);if(o){var f={formula:s.attrs.formula||null};["link","linkToolTip","backgroundImage","backgroundImageLayout","backgroundImageSize","mentionGuid","checkbox"].forEach(function(e){var t;return r.attrs.hasOwnProperty(e)&&Object.assign(f,((t={})[e]=null,t))}),s.attrs.richText?["bold","italic","underline","strike","color","font-size","font-family","richText","format"].forEach(function(e){var t;return Object.assign(f,((t={})[e]=s.attrs[e]||null,t))}):Object.assign(f,{richText:null});var h=s.attrs.autoFormatter;if(h){var g=r.attrs.format;g&&!p({formatter:g},{autoFormatter:h})||Object.assign(f,{format:h})}var m=Object.assign({},r.attrs,f),v=d===i&&t===c?n:r,w=!l||l.row===d&&l.col===t?s.value:v.value;u.push([d,t,v,{value:w,attrs:m}]),a.push([d,t,w,m])}else{var C=s.attrs;for(var S in C)S.indexOf("comment")>-1&&delete C[S];var b=r.attrs,x=Object.keys(b).reduce(function(e,t){return e[t]=t.indexOf("comment")>-1?b[t]:null,e},{});m=Object.assign(x,C,{rowspan:b.rowspan,colspan:b.colspan}),w=!l||l.row===d&&l.col===t?s.value:r.value,u.push([d,t,r,{value:w,attrs:m}]),a.push([d,t,w,m])}}},w=f;w<f+g;w++)m(w)}),{newCells:a,collectedCells:u}}(t,r,{fromRow:o,fromCol:c},f,l),O=x.newCells,k=x.collectedCells,R=[{fnName:"editCell2Changeset",params:e.opProcessor([t.guid(),k,{skipParseFormat:!0}])}];if(!l){var E={row:o,col:c,rowCount:1,colCount:1},A={sheet:t,fillRanges:u,selectedRanges:r,srcRange:E};e.hookManager.triggerHook(h.CollectOperatorAfterFillAreaByShortcut,A,R)}S({obj:t,func:C,suspendCalcService:!0})(t,O),e.emit(g.AfterCellsChanged,{sheet:t,cellsData:O}),e.actions.calcOperator({operator:R,isCalcInWorker:O.length>1e3,label:"fillAreaShortCut"})},t.a=b;var n=r(2),o=(r.n(n),r(1)),i=r.n(o),c=n.sheets.range,u=n.sheets,a=u.alert,s=u.sheet,l=u.cellCommand,f=u.perf,h=u.Hooks,g=u.Events,p=u.formatter.isSatisfiedResetRule,d=a.showAlert,m=c.isCellInRange,v=c.fixRange,w=s.getActiveCell,y=s.getCell,C=l.setBulkCells,S=f.paintWrap;function b(e,t,r){return e.reduce(function(e,n){if(m(t,r,n)){var o=n.row,i=n.col,c=n.rowCount,u=n.colCount;c>1&&e.push({row:Math.max(0,t>o?o:o+1),col:Math.max(0,i),rowCount:c-1,colCount:u}),u>1&&e.push({row:Math.max(0,t>o?o+c-1:o),col:Math.max(0,r>i?i:i+1),rowCount:1,colCount:u-1})}else e.push(n);return e},[])}}})});