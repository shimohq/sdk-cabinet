!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://assets.smcdn.cn/sheet/",n(n.s=1447)}({0:function(e,t){e.exports=React},1:function(e,t,n){"use strict";var o=function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},r=function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,s)}c((o=o.apply(e,t||[])).next())})},i=function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(t,"__esModule",{value:!0});var s=n(18),c=n(38),l={},u=function(e){return l[e]||(l[e]=d()),l[e]};t.getS18n=u;var m=function(){l={}};t.DEBUG_reset=m;var p=function(){return l};t.DEBUG_getInstances=p;var d=function(){var e,t,n="zh-CN",l="zh-CN",d={},f=function(e,t){if(!s.isValidLocaleResource(t))throw new Error("fetched locale resource is invalid");d[e]=o(o({},d[e]||{}),t)},h=function(e,n){return r(void 0,void 0,void 0,function(){var o;return i(this,function(r){switch(r.label){case 0:return!n&&d[e]?[3,2]:t?[4,t(e)]:[3,2];case 1:o=r.sent(),f(e,o),r.label=2;case 2:return[2]}})})},v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("string"==typeof e[0]){var o=e[0],r=e[1],i=r&&"string"==typeof r._?r._:void 0,s=i?o+"#"+i:o;if(!s)return"";var u=c.getTextResult(s,d[n]);if("string"==typeof u)return u;var m=c.getTextResult(s,d[l]);return"string"==typeof m?m:o}if(e[0]&&"number"==typeof e[0].length){var p=e[0],f=e.slice(1);return c.getInterpolateResult(p,f,d[n])||c.getInterpolateResult(p,f,d[l])||c.interweave(p,f)}return console.warn.apply(console,a(["[s18n] invalid input:"],e)),""};return v.configure=function(n){if(n.fetchLocale){if("function"!=typeof n.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");t=n.fetchLocale}if(n.fetchLocaleSync){if("function"!=typeof n.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");e=n.fetchLocaleSync}},v.addLocaleResource=f,v.setLocaleAsync=function(e,t){return r(void 0,void 0,void 0,function(){return i(this,function(o){switch(o.label){case 0:if("string"!=typeof e)throw new Error("'locale' is required");return[4,h(e)];case 1:return o.sent(),n=e,"string"==typeof t&&(h(t),l=t),[2]}})})},v.setLocaleSync=function(t){if("string"!=typeof t)throw new Error("'locale' is required");if(e){var o=e(t);f(t,o)}n=t},v.getLocale=function(){return n},v.DEBUG_getLocaleResources=function(){return d},v.getS18n=u,v.DEBUG_reset=m,v.DEBUG_getInstances=p,v},f=u("__default_namespace__");e.exports=f,t.default=f},10:function(e,t){e.exports=function(e){return!!e&&"object"==typeof e}},100:function(e,t){e.exports=function(e){return this.__data__.get(e)}},101:function(e,t){e.exports=function(e){return this.__data__.has(e)}},102:function(e,t,n){var o=n(13),r=n(31),i=200;e.exports=function(e,t){var n=this.__data__;return n instanceof o&&n.__data__.length==i&&(n=this.__data__=new r(n.__data__)),n.set(e,t),this}},103:function(e,t,n){var o=n(104),r=n(13),i=n(40);e.exports=function(){this.__data__={hash:new o,map:new(i||r),string:new o}}},104:function(e,t,n){var o=n(105),r=n(106),i=n(107),a=n(108),s=n(109);function c(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}c.prototype.clear=o,c.prototype.delete=r,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,e.exports=c},105:function(e,t,n){var o=n(15);e.exports=function(){this.__data__=o?o(null):{}}},106:function(e,t){e.exports=function(e){return this.has(e)&&delete this.__data__[e]}},107:function(e,t,n){var o=n(15),r="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(o){var n=t[e];return n===r?void 0:n}return i.call(t,e)?t[e]:void 0}},108:function(e,t,n){var o=n(15),r=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return o?void 0!==t[e]:r.call(t,e)}},109:function(e,t,n){var o=n(15),r="__lodash_hash_undefined__";e.exports=function(e,t){return this.__data__[e]=o&&void 0===t?r:t,this}},11:function(e,t,n){"use strict";t.h=function(e){var t=document.createEvent("Event");t.initEvent("click",!0,!0),e.dispatchEvent(t)},t.e=function(e){return/^http:\/\//.test(e)},t.g=function(e,t){return new Array(t+1).join(e)},n.d(t,"d",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"f",function(){return s}),t.b=function(e,t){var n="";if(e&&t){var o=t.permissions.query.shimo.getFilePermission(),i=!o||o.permissions.editable,a=!o||o.permissions.commentable;i||(n=a?r()("只评模式下不可使用"):r()("只读模式下不可使用"))}return n},t.a=function(e){var t=c.get(e);if(null!=t)return t;var n=document.createElement("canvas").getContext("2d");n.font="bold 12px Arial";var o=n.measureText(e).width+28,r=Math.ceil(o);return c.set(e,r),r};var o=n(1),r=n.n(o);var i="ActiveXObject"in window,a=window.navigator.userAgent.indexOf("Edge")>-1,s=window.navigator.userAgent.indexOf("Windows")>-1;var c=new Map},110:function(e,t,n){var o=n(16);e.exports=function(e){return o(this,e).delete(e)}},111:function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},112:function(e,t,n){var o=n(16);e.exports=function(e){return o(this,e).get(e)}},113:function(e,t,n){var o=n(16);e.exports=function(e){return o(this,e).has(e)}},114:function(e,t,n){var o=n(16);e.exports=function(e,t){return o(this,e).set(e,t),this}},116:function(e,t,n){var o=n(122);e.exports=function(e){var t=o(e),n=t%1;return t==t?n?t-n:t:0}},12:function(e,t,n){var o=n(41),r=n(81),i=n(68),a=n(17),s=n(34),c=n(36);e.exports=function(e){var t=c(e);if(!t&&!a(e))return r(e);var n=i(e),l=!!n,u=n||[],m=u.length;for(var p in e)!o(e,p)||l&&("length"==p||s(p,m))||t&&"constructor"==p||u.push(p);return u}},120:function(e,t){var n="__lodash_hash_undefined__";e.exports=function(e){return this.__data__.set(e,n),this}},121:function(e,t){e.exports=function(e){return this.__data__.has(e)}},122:function(e,t,n){var o=n(61),r=1/0,i=1.7976931348623157e308;e.exports=function(e){return e?(e=o(e))===r||e===-r?(e<0?-1:1)*i:e==e?e:0:0===e?e:0}},123:function(e,t,n){"use strict";var o;n.d(t,"b",function(){return o}),t.a=function(e){o=e}},126:function(e,t,n){var o=n(46),r=n(57),i=n(128),a=n(129),s=n(42),c=n(5),l=n(28),u=n(130),m=2,p="[object Arguments]",d="[object Array]",f="[object Object]",h=Object.prototype.hasOwnProperty;e.exports=function(e,t,n,v,g,b){var y=c(e),C=c(t),w=d,x=d;y||(w=(w=s(e))==p?f:w),C||(x=(x=s(t))==p?f:x);var _=w==f&&!l(e),S=x==f&&!l(t),O=w==x;if(O&&!_)return b||(b=new o),y||u(e)?r(e,t,n,v,g,b):i(e,t,w,n,v,g,b);if(!(g&m)){var E=_&&h.call(e,"__wrapped__"),A=S&&h.call(t,"__wrapped__");if(E||A){var k=E?e.value():e,j=A?t.value():t;return b||(b=new o),n(k,j,v,g,b)}}return!!O&&(b||(b=new o),a(e,t,n,v,g,b))}},127:function(e,t){e.exports=function(e,t){for(var n=-1,o=e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}},128:function(e,t,n){var o=n(47),r=n(67),i=n(57),a=n(48),s=n(45),c=1,l=2,u="[object Boolean]",m="[object Date]",p="[object Error]",d="[object Map]",f="[object Number]",h="[object RegExp]",v="[object Set]",g="[object String]",b="[object Symbol]",y="[object ArrayBuffer]",C="[object DataView]",w=o?o.prototype:void 0,x=w?w.valueOf:void 0;e.exports=function(e,t,n,o,w,_,S){switch(n){case C:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case y:return!(e.byteLength!=t.byteLength||!o(new r(e),new r(t)));case u:case m:return+e==+t;case p:return e.name==t.name&&e.message==t.message;case f:return e!=+e?t!=+t:e==+t;case h:case g:return e==t+"";case d:var O=a;case v:var E=_&l;if(O||(O=s),e.size!=t.size&&!E)return!1;var A=S.get(e);return A?A==t:(_|=c,S.set(e,t),i(O(e),O(t),o,w,_,S));case b:if(x)return x.call(e)==x.call(t)}return!1}},129:function(e,t,n){var o=n(41),r=n(12),i=2;e.exports=function(e,t,n,a,s,c){var l=s&i,u=r(e),m=u.length;if(m!=r(t).length&&!l)return!1;for(var p=m;p--;){var d=u[p];if(!(l?d in t:o(t,d)))return!1}var f=c.get(e);if(f)return f==t;var h=!0;c.set(e,t);for(var v=l;++p<m;){var g=e[d=u[p]],b=t[d];if(a)var y=l?a(b,g,d,t,e,c):a(g,b,d,e,t,c);if(!(void 0===y?g===b||n(g,b,a,s,c):y)){h=!1;break}v||(v="constructor"==d)}if(h&&!v){var C=e.constructor,w=t.constructor;C!=w&&"constructor"in e&&"constructor"in t&&!("function"==typeof C&&C instanceof C&&"function"==typeof w&&w instanceof w)&&(h=!1)}return c.delete(e),h}},13:function(e,t,n){var o=n(93),r=n(94),i=n(95),a=n(96),s=n(97);function c(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}c.prototype.clear=o,c.prototype.delete=r,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,e.exports=c},130:function(e,t,n){var o=n(20),r=n(10),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;var a=Object.prototype.toString;e.exports=function(e){return r(e)&&o(e.length)&&!!i[a.call(e)]}},131:function(e,t){e.exports=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},132:function(e,t,n){"use strict";var o=n(0),r=n.n(o),i=n(58),a=n(11),s=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),c=function(e){function t(t){var n=e.call(this,t)||this;return n.onOpen=function(e){n.props.onOpen&&n.props.onOpen(),e&&(e.markAsOld(),n.forceUpdate())},n}return s(t,e),t.prototype.render=function(){var e=function(e){return e?(e instanceof Array?e:[e]).find(function(e){return e.visible}):void 0}(this.props.feature),t=e&&e.tooltip,n=this.props.tabName(),o=Object(a.a)(n);return r.a.createElement(i.a,{head:r.a.createElement("span",{className:"tabMenuHead",style:{width:o}},n,t),customClass:"tabMenu tab-"+this.props.tab,smattr:this.props.smattr,disabled:this.props.disabled,onOpen:this.onOpen.bind(this,e),editor:this.props.editor,tab:this.props.tab},this.props.children)},t.compName="TabMenu",t}(r.a.Component);t.a=c},133:function(e,t,n){"use strict";t.a=function(e){return r.a.createElement(i.a,{head:r.a.cloneElement(e.head,{className:"dropMenuHead indicator "+(e.head.props.className||"")}),disabled:e.disabled,customClass:e.customClass,onClose:e.onClose,onOpen:e.onOpen,smattr:e.smattr},e.children)};var o=n(0),r=n.n(o),i=n(58)},134:function(e,t,n){"use strict";var o=n(0),r=n.n(o),i=n(11),a=n(2),s=(n.n(a),n(27)),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),l=a.sheets.menu.MenuContext,u=function(e){function t(t){var n=e.call(this,t)||this;return n.showSubMenu=function(){!n.props.disabled&&n.setState({showSubMenu:!0})},n.hideSubMenu=function(){n.setState({showSubMenu:!1})},n.state={showSubMenu:!1},n}return c(t,e),t.prototype.render=function(){this.checkShowSubStatus();var e=this.props,t=e.editor,n=e.disabled,o=Object(i.b)(!!n,t),a=this.context.searchResultPath.split("->").indexOf(this.props.text)>-1?"menuItem--highlight":"",c=this.state.showSubMenu;return r.a.createElement("div",{ref:"containerDom",className:"menu--submenu",onMouseLeave:this.hideSubMenu},r.a.createElement("div",{ref:"itemDom",className:"menuItem "+(this.props.disabled?"disabled":"")+" "+a,onMouseEnter:this.showSubMenu},void 0!==this.props.icon&&r.a.createElement("span",{className:"menuItem--icon "+(this.props.icon?"icon--"+this.props.icon:"")}),r.a.createElement("span",{className:"menuItem--text"},this.props.text),r.a.createElement("span",{className:"menuItem--placer"}),r.a.createElement("span",{className:"menuItem--arrow"})),r.a.createElement(s.a,{showPopup:c,itemDom:this.refs.itemDom},this.props.children),o)},t.prototype.checkShowSubStatus=function(){if(!!this.context.searchResultPath&&!!this.context.searchResultPath.length){var e=this.context.searchResultPath.split("->"),t=e.indexOf(this.props.text),n=t>-1&&t<e.length-1;this.state.showSubMenu!==n&&this.setState({showSubMenu:n})}},t.compName="SubMenu",t}(r.a.Component);t.a=u,u.contextType=l},135:function(e,t,n){"use strict";var o=n(0),r=n.n(o),i=n(3),a=n.n(i),s=n(59),c=n(11),l=n(2),u=(n.n(l),n(27)),m=n(60),p=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),d=l.sheets.menu.MenuContext,f=function(e){function t(t){var n=e.call(this,t)||this;return n.hideTooltip=function(){n.setState({showTooltip:!1})},n.showTooltip=function(){n.setState({showTooltip:!0})},n.state={showTooltip:!1,showHighlight:!1},n}return p(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.disabled,o=t.customClass,i=t.active,a="fake"===n?"fakeDisabled":n?"disabled":"",s=o||"",c=this.props.className||"",l=this.props.isSearchItem?"item--search-result":"",u=i?"active":"";return r.a.createElement(d.Consumer,null,function(t){return r.a.createElement("div",{className:"menuItem tooltip--docker "+a+" "+s+" "+c+" "+function(t){var n,o=t.searchResultPath.split("->"),r=e.props.searchDisplay||e.props.text;return(null===(n=r)||void 0===n?void 0:n.length)&&o[o.length-1]===r&&!e.props.isSearchItem?"menuItem--highlight":""}(t)+" "+u+" "+l,onClick:function(n){return e.onClick(n,t)},"data-smattr":e.props.smattr,onMouseLeave:e.hideTooltip,onMouseEnter:e.showTooltip},void 0!==e.props.checked&&r.a.createElement("span",{className:"menuItem--check "+(e.props.checked?"menuItem--check__checked":"")}),void 0!==e.props.icon&&e.getIcon(e.props.icon),e.props.text&&r.a.createElement("span",{className:"menuItem--text"},e.props.text),e.props.showEnterpriseLabel&&r.a.createElement("span",{className:"enterprise-feature-tag"}),e.props.text&&!c.includes("fontDisplayImg")&&r.a.createElement("span",{className:"menuItem--placer"}),e.props.children,e.MenuTip)})},t.prototype.componentDidMount=function(){this.scrollHighlightItem()},t.prototype.componentDidUpdate=function(){this.scrollHighlightItem()},t.prototype.scrollHighlightItem=function(){var e=a.a.findDOMNode(this);e&&e.classList.contains("menuItem--highlight")&&setTimeout(function(){e.scrollIntoView(!1)})},Object.defineProperty(t.prototype,"MenuTip",{get:function(){var e=this.props,t=e.disabled,n=e.editor,o=e.tip,i=this.state.showTooltip,s=Object(c.b)(!!t,n)||o,l="string"==typeof s;return s?r.a.createElement(u.a,{showPopup:i,itemDom:a.a.findDOMNode(this),className:"menu--tooltip-popup"+(l?" normal--tip":"")},l?r.a.createElement("div",{className:"menu-normal-tip-wrapper",style:{position:"relative",display:"flex",alignItems:"center"}},r.a.createElement(m.a,{option:s,direction:"right"})):s):null},enumerable:!0,configurable:!0}),t.prototype.onClick=function(e,t){!this.props.disabled&&this.props.onTap&&this.props.onTap(e),this.props.stopPropagation||setTimeout(function(){return t.closeMenu()})},t.prototype.getIcon=function(e){return Object(c.e)(e)?r.a.createElement("span",{className:"menuItem--icon",style:Object(s.a)(e)}):r.a.createElement("span",{className:"menuItem--icon "+(e?"icon--"+e:"")})},t.compName="MenuItem",t}(r.a.Component);t.a=f,f.contextType=d},136:function(e,t,n){"use strict";t.a=function(){return r.a.createElement("div",{className:"menu--divider"})};var o=n(0),r=n.n(o)},137:function(e,t,n){"use strict";var o=n(0),r=n.n(o),i=n(11),a=n(59),s=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onTap=function(){t.props.onTap&&t.props.onTap()},t}return s(t,e),t.prototype.render=function(){var e="toolBar--iconBtn "+(this.props.disabled?"disabled":"")+" "+(this.props.selected?"selected":"")+" indicator";return this.props.children?r.a.createElement("span",{className:e+" tooltip--docker",onClick:this.onTap,"data-smattr":this.props.smattr},this.getIcon(this.props.icon)):this.props.tooltip?r.a.createElement("span",{className:e,"data-tooltip":this.props.tooltip,onClick:this.onTap,"data-smattr":this.props.smattr},this.getIcon(this.props.icon)):r.a.createElement("span",{className:e,onClick:this.onTap,"data-smattr":this.props.smattr},this.getIcon(this.props.icon))},t.prototype.getIcon=function(e){return Object(i.e)(e)?r.a.createElement("span",{style:Object(a.a)(e)},this.props.children):r.a.createElement("span",{className:"toolBar--icon icon--"+e},this.props.children)},t}(r.a.Component);t.a=c},138:function(e,t,n){"use strict";t.d=function(e){return r.a.createElement("span",{className:l(e,"toolBar--tool")},e.children)},n.d(t,"c",function(){return u}),t.a=function(e){return r.a.createElement("span",{className:l(e,"toolBar--iconDropTool indicator "+(e.selected?"fakeIndicator":""))},e.children)},t.b=function(e){return r.a.createElement("span",{className:l(e,"toolBar--tool toolBar--tool__oneline")},e.children)},t.e=function(e){return r.a.createElement("span",{className:l(e,"toolBar--tool toolBar--tool__twolines")},e.children)};var o=n(0),r=n.n(o),i=n(11),a=n(21),s=n.n(a),c=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function l(e,t){var n,o=e.disabled,r=e.customClass;return s()(((n={})[t]=!0,n[r||""]=r,n.disabled=o,n))}var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.delegateClick=function(e){var n=t.refs.textTool,o=n.lastElementChild;if(e.target===n||e.target===o){var r=n.querySelector(".toolBar--icon");setTimeout(function(){return Object(i.h)(r)})}},t}return c(t,e),t.prototype.render=function(){return r.a.createElement("span",{ref:"textTool",className:l(this.props,"toolBar--tool toolBar--textTool"),onClick:this.delegateClick},this.props.children)},t}(r.a.Component)},14:function(e,t,n){var o=n(33);e.exports=function(e,t){for(var n=e.length;n--;)if(o(e[n][0],t))return n;return-1}},141:function(e,t,n){var o=n(92),r=n(171);e.exports=function e(t,n,i,a,s){var c=-1,l=t.length;for(i||(i=r),s||(s=[]);++c<l;){var u=t[c];n>0&&i(u)?n>1?e(u,n-1,i,a,s):o(s,u):a||(s[s.length]=u)}return s}},144:function(e,t){e.exports=Zepto},1447:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"CommentEvents",function(){return I}),n.d(t,"PLUGIN_NAME",function(){return P});var o=n(145),r=(n.n(o),n(1)),i=n.n(r),a=(n(1448),n(370)),s=n.n(a),c=n(2),l=(n.n(c),n(1451)),u=n(1453),m=n(528),p=n(593),d=n(987),f=n(1456),h=n(1457),v=n(1458),g=n(0),b=n.n(g),y=n(3),C=n.n(y),w=n(1461),x=n(148),_=(n.n(x),n(1464)),S=n(1465),O=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),E=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,s)}c((o=o.apply(e,t||[])).next())})},A=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},k=c.sheets.changeset,j=c.sheets.range,M=c.sheets.CellAppendant,I=p.a,P="Comment",R=c.sheets,T=R.sheet,N=R.selection,L=R.track,B=R.root,D=R.path,U=R.Plugin,H=R.Hooks,Q=R.position,G=R.perf,K=R.utils,z=R.Events,q=D.setByPath,F=N.getCurSelection,V=T.getActivePictures,W=T.getSheetAttrs,Z=T.setSheetAttrs,J=K.showAlert,Y=k.findRawTableOpById,X=k.processCellsDataAttributes,$=Q.stringifyPosition,ee=Q.parsePosition,te=j.isCellInRange,ne=G.paintWrap,oe=k.FileType,re=M.HorizontalAlign,ie=M.VerticalAlign,ae=Object(x.isMobile)(),se=function(e){function t(n){var o=e.call(this,{name:P,Constructor:t,config:n})||this;o.CommentEvents=I,o.commentSelected=!1,o.updateSidebar=function(){o.sidebar.current&&o.sidebar.current.update()},o.getMenuConfig=function(){return Object(h.a)({startComment:o.startComment})},o.getCellAppendant=function(){var e=o.options;return{editor:e.editor,currentUser:e.currentUser,defaultAnonymousUser:e.defaultAnonymousUser,commentModel:o.commentModel,priority:1e3,component:u.a,align:[re.right,ie.center],disableRender:ae}},o.getMobileMenuConfig=function(){return Object(_.a)({startComment:o.startComment})},o.startComment=function(){var e=o.options.editor.spread.getActiveSheet().gcSheet;if(V(e).length)return J({title:i()("不能对图片进行评论"),type:"error"});var t=F(e),n=t.row,r=t.col,a=o.commentModel.start({sheet:e,row:n,col:r});"error"===a.type&&J({title:a.message||i()("开始评论失败，请稍后重试"),type:"error"}),L(2,"2055")},o.initAfterEditorRendered=function(){o.__initModel(),o.__initSidebar(),o.__initMobilePanel(),Object(v.c)(o.options.editor,o.commentModel),o.parseCommentTableAttrs(),o.install()},o.applySheetChange=function(e){if(e&&e.insertSheetsAttrs)return o.updateSidebar();o.setCellComment(e)},o.applyCommentTableAttrs=function(e){var t,n=o.options.editor,r=e.id;if(r){var i=n.spread.getSheet(r),a=i&&i.gcSheet;if(a){var s=W(a,m.a)||{};for(var c in e)if(c.indexOf("comment-")>-1){var l=e[c];l?Object(m.f)(a,((t={})[c]={row:ee(l).row,col:ee(l).col},t)):s[c]&&delete s[c]}var u=n.spread.gcSpread.getTab();u&&u.repaint(),o.updateSidebar()}}},o.setCellComment=function(e){e&&e.sheet&&setTimeout(function(){var t=e.cellsData,n=o.options.editor,r=e.sheet,i=r.gcSheet||r;if(r&&t){i.suspendPaint();var a=o.commentModel&&o.commentModel.allComments||[],c=function(e){return a.some(function(t){return-1!==e.indexOf(t.selection_guid)})};s()(t,function(e){Object(m.e)({gcSheet:i,cell:e,editor:n,type:"initRender",shouldRenderBorder:c})}),i.resumePaint(),o.updateSidebar()}o.locateCommentAfterRendered()})},o.handleCommentIconClick=function(e){var t=e.sheet,n=e.sheetTabIndex,r=e.position,i=e.pageX,a=e.isSameSheet;if(r&&i&&a){var s=o.options.editor.spread.gcSpread.getTab(),c=s._tabs,l=s._tabLeftPadding,u=s._iconMarginRight,m=c.find(function(e){return e.i===n});if(!m)return;var p=m.icons,d=p.findIndex(function(e){return"comment"===e.name});if(d>-1){for(var f=l,h=p[d],v=0;v<d;v++){f+=p[v].width+u}i-r>f&&i-r<f+h.width&&o.commentModel.locateComment(t.comments._unreadComments[0].selection_guid)}}};var r=n.editor;return o.options=n,o.sidebar=b.a.createRef(),o.mobileCommentPanel=b.a.createRef(),o.initEvents(),o.registerHooks(),Object(v.b)(),r.isRendered?(Object(v.a)(o.options.editor.spread.gcSpread.sheets),o.initAfterEditorRendered(),o.initRenderCellComment()):r.on(z.Rendered,o.initAfterEditorRendered),o}return O(t,e),t.prototype.setLocale=function(e){i.a.setLocaleSync(e)},t.prototype.showSidebar=function(){this.emit(I.ShowCommentSidebar),this.sidebar.current&&this.sidebar.current.show()},t.prototype.hideSidebar=function(){this.sidebar.current&&this.sidebar.current.hide()},t.prototype.destroy=function(){var e=this.options.editor;this.commentModel&&this.commentModel.destroy(),this.query&&e.off(z.Rendered,this.query),e.off(z.AfterSheetRendered,this.applySheetChange),e.off(z.AfterCellsChanged,this.applySheetChange),e.off(z.AfterChangeApplied,this.setCellComment),e.off(z.SheetTabClick,this.handleCommentIconClick),e.off(z.Change,this.updateSidebar),e.off(z.PermissionChanged,this.updateSidebar),e.off(z.RecalculateAllEnd,this.updateSidebar)},t.prototype.destory=function(){this.destroy()},t.prototype.test=function(){f.a.test(this.commentModel)},t.prototype.parseCommentTableAttrs=function(e){return E(this,void 0,Promise,function(){var t,n,o,r,i;return A(this,function(a){switch(a.label){case 0:return(t=this.options.editor).fileType!==oe.Modoc?[3,3]:(n=e)?[3,2]:[4,t.getContent()];case 1:n=a.sent(),a.label=2;case 2:for(o=n.getIter();o.hasNext();)r=o.next(),i=r.getAttributes(),this.applyCommentTableAttrs(i);a.label=3;case 3:return[2]}})})},t.prototype.__initSidebar=function(){var e=this.options.editor;!ae&&C.a.render(b.a.createElement(w.a,{editor:e,ref:this.sidebar,commentModel:this.commentModel}),this.pluginContainer)},t.prototype.__initMobilePanel=function(){var e=this.options,t=e.editor,n=e.useCustomUi,o=e.currentUser,r=e.defaultAnonymousUser;ae&&!n&&C.a.render(b.a.createElement(S.a,{currentUser:o,defaultAnonymousUser:r,ref:this.mobileCommentPanel,editor:t,commentModel:this.commentModel}),this.pluginContainer)},t.prototype.__initModel=function(){return this.commentModel=new l.a(this.options),this.options.editor.commentProcessor=this.commentModel,this.commentModel.query(),this.commentModel},t.prototype.initEvents=function(){this.options.editor.on(z.AfterSheetRendered,this.applySheetChange),this.options.editor.on(z.AfterChangeApplied,this.applySheetChange),this.options.editor.on(z.AfterCellsChanged,this.setCellComment),this.options.editor.on(z.SheetTabClick,this.handleCommentIconClick),this.options.editor.on(z.Change,this.updateSidebar),this.options.editor.on(z.PermissionChanged,this.updateSidebar),this.options.editor.on(z.RecalculateAllEnd,this.updateSidebar)},t.prototype.registerHooks=function(){var e=this.options.editor.hookManager.registerHook;e(H.CollectOperatorAfterRowOrColChanged,this.updateCommentTableAttrsAfterRowOrColChanged.bind(this)),e(H.CollectOperatorAfterDragDropped,this.updateCommentTableAttrsAfterDragDropped.bind(this)),e(H.CollectOperatorAfterPasted,this.updateCommentTableAttrsAfterPasted.bind(this)),e(H.CollectOperatorAfterMergedCells,this.updateCommentTableAttrsAfterMergeCells.bind(this)),e(H.CollectOperatorAfterSorted,this.updateCommentTableAttrsAfterSorted.bind(this)),e(H.CollectOperatorAfterAddOrDeleteCells,this.updateCommentTableAttrsAfterAddOrDeleteCells.bind(this))},t.prototype.updateCommentTableAttrsAfterAddOrDeleteCells=function(e,t){var n=e.movedRange,o=e.range,r=e.isAdd,i=e.sheet,a=e.dir,s=i.gcSheet,c=W(s,m.a)||{},l=s.comments,u={},p="right"===a?o.colCount:"left"===a?-o.colCount:0,d="down"===a?o.rowCount:"up"===a?-o.rowCount:0;for(var f in c){var h=c[f];if(h){var v=h.row,g=h.col;te(v,g,n)&&(u[f]=$(v+d,g+p),c[f]={row:v+d,col:g+p}),!r&&te(v,g,o)&&(delete c[f],u[f]=null)}}var b=function(e,t){for(var n=e.row,o=e.col,r=e.rowCount,i=e.colCount,a=[],s=n;s<n+r;s++)for(var c=o;c<o+i;c++){var u=l.get(s,c);if(u){l.remove(s,c);var m=s+d,f=c+p;t&&a.push({newRow:m,newCol:f,comment:u})}}a.forEach(function(e){var t=e.newRow,n=e.newCol,o=e.comment;return l.addInternal(t,n,o)})};return ne({obj:s,func:function(){!r&&b(o,!1),b(n,!0)}})(),Object.keys(u).length&&(t.push({fnName:"tableAttrs2Cs",params:[s.guid(),u]}),!r&&this.options.editor.spread.gcSpread.getTab().repaint()),t},t.prototype.updateCommentTableAttrsAfterRowOrColChanged=function(e,t){var n=e.count,o=e.index,r=e.isAdd,i=e.type,a=e.sheet,s=a,c={},l=W(a,m.a)||{};if(r)for(var u in l){if(g=l[u])if(o<=("col"===i?g.col:g.row)){"col"===i?g.col+=n:g.row+=n;var p=$(g.row,g.col);c[u]=p,g=p}}else{var d="col"===i?s.getRowCount():o+n,f="row"===i?s.getColumnCount():o+n,h="row"===i?o:0,v="col"===i?o:0;for(var u in l){var g;if((g=l[u])&&(g.row>=h&&g.col>=v))if(g.row<d&&g.col<f)c[u]=null,delete l[u];else if(g.row>=d||g.col>=f){var b=g.row>=d?g.row-n:g.row,y=g.col>=f?g.col-n:g.col;p=$(b,y);c[u]=p,l[u]={row:b,col:y}}}}return Object.keys(c).length&&(t.push({fnName:"tableAttrs2Cs",params:[a.guid(),c]}),!r&&this.options.editor.spread.gcSpread.getTab().repaint()),t},t.prototype.updateCommentTableAttrsAfterDragDropped=function(e,t){var n=e.args,o=n.fromRow,r=n.fromCol,i=n.toRow,a=n.toCol,s=n.sheet,c=n.insert,l=n.rowCount,u=n.colCount,p=[o,r,i,a].map(function(e){return Math.max(0,e)}),d=p[0],f=p[1],h=p[2],v=p[3];-1===l&&(l=s.getRowCount()),-1===u&&(u=s.getColumnCount());var g={row:d,col:f,rowCount:l,colCount:u},b={row:h,col:v,rowCount:l,colCount:u},y={},C=W(s,m.a)||{};for(var w in C){var x=C[w];if(x){var _=x.row,S=x.col;if(c||te(_,S,g)||!te(_,S,b)||(y[w]=null,delete C[w]),te(_,S,g)){var O=h+_-d+(c&&h>d?-l:0),E=v+S-f+(c&&v>f?-u:0);y[w]=$(O,E),C[w]={row:O,col:E}}if(c&&!te(_,S,g)){O=_,E=S;(d<_&&h>_||d>_&&h<=_)&&(O=d<_?_-l:_+l),(f<S&&v>S||f>S&&v<=S)&&(E=f<S?S-u:S+u),y[w]=$(O,E),C[w]={row:O,col:E}}}}return Object.keys(y).length&&t.push({fnName:"tableAttrs2Cs",params:[s.guid(),y]}),t},t.prototype.updateCommentTableAttrsAfterPasted=function(e,t){var n,o=e.fromSheet,r=e.sheet,i=e.fromRange,a=e.isCutting,s=e.actualCellRange,c=e.isFromSameSheet;if(a&&o&&r){var l=Math.max(0,i.row),u=Math.max(0,i.col),p=s.row,d=s.col,f={},h={},v={row:l,col:u,rowCount:s.rowCount,colCount:s.colCount},g=W(o,m.a)||{},b=W(r,m.a)||{};for(var y in b){if(x=g[y]){var C=x.row,w=x.col;(te(C,w,s)&&!te(C,w,v)||!c)&&(h[y]=null)}}for(var y in g){var x;if(x=g[y]){C=x.row,w=x.col;if(te(C,w,v)){var _=p+C-l,S=d+w-u;c?(f[y]=$(_,S),g[y]={row:_,col:S}):(f[y]=null,delete g[y],h[y]=$(_,S),Z(r,m.a,Object.assign(b,((n={})[y]={row:_,col:S},n))))}}}Object.keys(f).length&&t.push({fnName:"tableAttrs2Cs",params:[o.guid(),f]}),Object.keys(h).length&&(t.push({fnName:"tableAttrs2Cs",params:[r.guid(),h]}),this.options.editor.spread.gcSpread.getTab().repaint())}return t},t.prototype.updateCommentTableAttrsAfterMergeCells=function(e,t){var n=e.sheet,o=e.cellsChangeAry,r=n.attrs.comments||{},i=o.reduce(function(e,t){var n=t[0],o=t[1],i=t[3].attrs;for(var a in i)/comment-?/.test(a)&&r[a]&&(null==i[a]?e[a]||(e[a]=null,delete r[a]):(e[a]=$(n,o),r[a]={row:n,col:o}));return e},{});return Object.keys(i).length&&t.push({fnName:"tableAttrs2Cs",params:[n.guid(),i]}),t},t.prototype.updateCommentTableAttrsAfterSorted=function(e,t){var n=e.swappedNodes,o=e.sheet,r=e.range,i=o.attrs.comments||{},a=Object.keys(i).reduce(function(e,t){var n=i[t],o=n.row,a=n.col;return te(o,a,r)&&(e[o+"-"+a]?e[o+"-"+a]+=","+t:e[o+"-"+a]=t),e},{}),s=n.reduce(function(e,t){var n=t[0],o=t[1],r=function(t,n,o){var r=n.row,s=n.col;o.split(",").forEach(function(t){e[t]=$(r,s),i[t]={row:r,col:s},a[r+"-"+s]?a[r+"-"+s]+=","+t:a[r+"-"+s]=t}),delete a[t.row+"-"+t.col]},s=a[o.row+"-"+o.col],c=a[n.row+"-"+n.col];return s&&r(o,n,s),c&&r(n,o,c),e},{});return Object.keys(s).length&&t.push({fnName:"tableAttrs2Cs",params:[o.guid(),s]}),t},t.prototype.initRenderCellComment=function(){return E(this,void 0,Promise,function(){var e,t,n,o,r,i=this;return A(this,function(a){switch(a.label){case 0:return e=this.options.editor,t=e.sheetStates.sheetStates,!(n=e.spread.sheets.reduce(function(e,n){var o=(t[n.id]||[])[0];return"fullRendered"===(void 0===o?"":o)&&e.push(n),e},[])).length&&n.push(e.spread.getActiveSheet()),o=e.disableRenderOptimization?e.spread.sheets:n,[4,e.getContent()];case 1:return r=a.sent(),o.forEach(function(e){var t=Y(r,e.id);i.parseCellComments(t,e.id)}),[2]}})})},t.prototype.parseCellComments=function(e,t){var n=this.options.editor,o=n.spread.getSheet(t).gcSheet,r=X(n.fileType,e).filter(function(e){var t=e[3];return Object.keys(t).some(function(e){return/comment-?/.test(e)})});r.length&&this.setCellComment({cellsData:r,sheet:o})},t.prototype.locateCommentAfterRendered=function(){var e=this;this.commentModel&&(this.commentModel.loading?this.commentModel.on(I.Loaded,function(){return e.commentModel.locateCommentByHash()}):this.commentModel.locateCommentByHash())},t.Utils=d,t}(U);t.default=se,q(B,"shimo.sdk.sheet.plugins.Comment",se)},1448:function(e,t,n){"use strict";var o=n(1),r=n.n(o),i=n(1449),a=n.n(i),s=n(1450),c=n.n(s);r.a.addLocaleResource("en-US",a.a),r.a.addLocaleResource("ja-JP",c.a),r.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},1449:function(e,t){e.exports={"开始":"Start","新增":"Add","删除":"Delete","关闭":"Close","离线状态无法%s评论":"Can't %s comment when offline","这是一条评论":"This is a comment","路人":"Passerby","不能对图片进行评论":"Can't comment on image","开始评论失败，请稍后重试":"Comment failed. Try again later.","添加评论":"Add comment","评论":"Comment","登录后才可使用":"Can be used after logging in","全部评论":"All comments","無":"Empty","暂无单元格评论":"No cell comment","标记全部已读":"Mark All as read","已标记所有评论为已读":"Marked all comments as read","该评论所在的工作表已被隐藏，可在工作表目录中取消隐藏":"The worksheet for the comment has been hidden and can be unhidden in the worksheet directory","空":"Empty","中间还有%s条评论":"There's %s more comment in the middle","删除评论":"Delete comment","确认要永久删除该评论吗？":"Delete the comment permanently?","新增评论失败，请稍后重试":"Adding new comment failed. Try again later","结束讨论":"Resolve discussion","结束讨论后该讨论将被彻底删除，确定结束吗？":"Resolve discussion will delete all the comments completely, resolve anyway?","删除评论失败，请稍后重试":"Deleting comment failed, Try again later","按enter发送，shift+enter换行":"Press Enter to send, Shift+Enter to wrap","取消":"Cancel","确定":"Confirm","完成":"Finish","发送":"Send","添加评论...":"Add Comment...","留下你的第一句评论吧":"Leave your first comment","只读模式下不可使用":"Not available in read-only mode","获取评论列表失败":"Failed to get comment list"}},145:function(e,t,n){"use strict";n.p=("string"==typeof __SM_CDN_HOST__?__SM_CDN_HOST__:"https://assets.smcdn.cn")+"/sheet/"},1450:function(e,t){e.exports={"开始":"開始","新增":"追加","删除":"削除","关闭":"閉じる","离线状态无法%s评论":"オフライン時はコメントを%sできません","这是一条评论":"コメント","路人":"未登録ユーザー","不能对图片进行评论":"画像にコメントできません","开始评论失败，请稍后重试":"コメントに失敗しました。しばらくしてからもう一度お試しください","添加评论":"コメントを追加","评论":"コメント","登录后才可使用":"ログイン後に使用できます","全部评论":"すべてのコメント","無":"いいえ","暂无单元格评论":"セルコメントなし","标记全部已读":"すべて既読にする","已标记所有评论为已读":"すべてのコメントを既読にしました","该评论所在的工作表已被隐藏，可在工作表目录中取消隐藏":"コメントのワークシートは非表示になっており、ワークシートディレクトリで非表示にすることができます","空":"空です","中间还有%s条评论":"真ん中に%sつのコメントがあります。","删除评论":"コメントを削除","确认要永久删除该评论吗？":"コメントを完全に削除しますか？","新增评论失败，请稍后重试":"新しいコメントの追加に失敗しました。しばらくしてからもう一度お試しください","结束讨论":"討論を終える","结束讨论后该讨论将被彻底删除，确定结束吗？":"ディスカッションの解決は、全てのコメントを完全に削除します。ディスカッションは解決しましたか?","删除评论失败，请稍后重试":"コメントの削除に失敗しました。しばらくしてからもう一度お試しください","按enter发送，shift+enter换行":"Enterで送信。Shift+Enterで改行","取消":"キャンセル","确定":"確定","完成":"成り合う","发送":"はっそうする","添加评论...":"コメントをつける...","留下你的第一句评论吧":"最初のコメントを残す","获取评论列表失败":"コメントリストを取得できませんでした"}},1451:function(e,t,n){"use strict";n.d(t,"a",function(){return L});var o,r=n(1),i=n.n(r),a=n(232),s=(n.n(a),n(236)),c=n.n(s),l=n(2),u=(n.n(l),n(593)),m=n(266),p=(n.n(m),n(528)),d=n(987),f=n(1452),h=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),v=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},g=this&&this.__assign||function(){return(g=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},b=l.sheets.Core,y=b.Spread.Sheets,C=b.Spread.Sheets.Events,w=C.CellClick,x=C.CellDoubleClick,_=C.LayoutChanged,S=l.sheets,O=S.Events,E=S.track,A=S.sheet,k=S.alert,j=S.utils,M=S.cell,I=A.getSheetAttrs,P=k.showAlert,R=j.replaceState,T=M.checkIsCellHiddenByOutline,N=l.sheets.ajax.ajax,L=function(e){function t(t){var n=e.call(this)||this;return n.isCommentBoxMounted=!1,n.needLocatedCommentGuid="",n.rebindGcEvents=function(){n.unbindGcEvents(),n.bindGcEvents(),n.query()},n.options=t,n.isLoading=!1,n.comments=[],n.offlined=!!t.offlined,n.gcSpread=n.options.editor.spread.gcSpread,n.checkOffline=n.checkOffline.bind(n),n.create=n.create.bind(n),n.close=n.close.bind(n),n.delete=n.delete.bind(n),n.cancel=n.cancel.bind(n),n.markCommentAsRead=n.markCommentAsRead.bind(n),n.updateCommentsByPush=n.updateCommentsByPush.bind(n),n.layoutChanged=n.layoutChanged.bind(n),n.toggle=n.toggle.bind(n),n.cellBySelectionGuid=d.cellBySelectionGuid,n.requestService=g(g({},f),t.requestService),n.bindEvents(),n.options.editor.on(O.SetContentSucceeded,n.rebindGcEvents),n.bindLoopQuery(),n}return h(t,e),Object.defineProperty(t.prototype,"allComments",{get:function(){return this.comments},set:function(e){this.comments=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"loading",{get:function(){return this.isLoading},enumerable:!0,configurable:!0}),t.prototype.query=function(){var e=this,t=this.options,n=t.guid,o=t.editor,r=t.queryCommentOptions,a=t.headers,s=void 0===a?{}:a;return Object(p.d)(o)?Promise.reject():(this.isLoading=!0,this.requestService.queryComments({guid:n,options:r,headers:s}).then(function(t){return t instanceof Array&&(e.allComments=t),e.isLoading=!1,o.spread&&e.renderSpread({spread:o.spread.gcSpread}),e.emit(u.a.Loaded,e.allComments),t}).catch(function(t){throw P({title:i()("获取评论列表失败"),type:"error"}),e.isLoading=!1,t}))},t.prototype.start=function(e){var t=e.sheet,n=e.row,o=e.col;t.gcSheet&&(t=t.gcSheet),t=t;var r=this.checkOffline("start");if("success"!==r.type)return r;E(2,"0047");var i=t.comments.get(n,o);return(!i||i.renderBorder&&!i.renderBorder())&&(i=this.addSheetComment({sheet:t,row:n,col:o,isRender:!0})),this.currentCellComment=i,this.emit(u.a.Start,{cell:{row:n,col:o},commentList:this.allComments,cellComment:i}),r},t.prototype.create=function(e){var t=this,n=e.comment,o=e.row,r=e.col,i=e.user,a=this.checkOffline("create");if("success"!==a.type)return Promise.reject(a);var s=this.options.editor.spread.gcSpread.getActiveSheet(),c=s.comments.get(o,r);if(c&&c.renderBorder||(c=this.addSheetComment({sheet:s,row:o,col:r,isRender:!0})),this.currentCellComment=c,!n.selection_guid||!n.selectionGuid){var l=c.guid()[0];n.selection_guid=l,n.selectionGuid=l}var m=this.allComments.filter(function(e){return e.selection_guid===n.selection_guid});if(this.currentCellComment&&!m.length){var d=this.options.editor.spread.getActiveSheet(),f={row:o,col:r,guid:this.currentCellComment.guid()[0]};this.options.editor.calcOperator({operator:Object(p.b)(d.gcSheet,f,this.options.editor,"create"),label:"comment",isDisableRecords:!0})}var h=g(g({},n),{User:i,hasRead:!0,isSending:!0});this.allComments.push(h),this.emit(u.a.Update,this.allComments);var v=this.options,b=v.guid,y=v.createCommentOptions,C=v.headers,w=void 0===C?{}:C;return this.requestService.createComment({guid:b,comment:n,options:y,headers:w}).then(function(e){if(e&&e.created_at){var o=t.allComments.findIndex(function(e){return e.commentGuid===h.commentGuid}),r=Object.assign({},h,{created_at:e.created_at,isSending:!1});t.allComments.splice(o,1,r)}else P({type:"error",title:"评论发送失败"}),t.allComments=t.allComments.filter(function(e){return e.comment_guid!==n.comment_guid});return t.emit(u.a.Update,t.allComments),e}).catch(function(e){throw P({type:"error",title:"评论发送失败"}),t.allComments=t.allComments.filter(function(e){return e.comment_guid!==n.comment_guid}),t.emit(u.a.Update,t.allComments),e})},t.prototype.delete=function(e){var t=this,n=this.checkOffline("create");if("success"!==n.type)return Promise.reject(n);for(var o=this.options.deleteCommentOptions,r=this.allComments.length,i=null,a=0;a<r;++a)if(this.allComments[a].comment_guid===e){i=this.allComments[a],this.allComments=this.allComments.slice(0,a).concat(this.allComments.slice(a+1));break}return i?this.requestService.deleteComment({commentId:e,options:o,headers:this.options.headers||{}}).then(function(e){return t.emit(u.a.Update,t.allComments),E(2,"0071"),e}).catch(function(e){throw t.allComments=t.allComments.concat(i),t.emit(u.a.Update,t.allComments),e}):Promise.resolve()},t.prototype.close=function(e){var t=this,n=e.sheet,o=e.row,r=e.col,i=e.options,a=this.checkOffline("create");if("success"!==a.type)return Promise.reject(a);var s=n.gcSheet.comments.get(o,r),l=c()({},this.options.closeCommentOptions),m=i||l;return this.allComments=this.allComments.filter(function(e){return-1===s.guid().indexOf(e.selection_guid)}),this.cancel({sheet:n,row:s._rowIndex,col:s._colIndex,needCalcOperator:!0}),this.requestService.closeComment({guid:this.options.guid,selectionGuid:s.guid()[0],options:m,headers:this.options.headers||{}}).then(function(){t.emit(u.a.Update,t.allComments),E(2,"0070")})},t.prototype.markCommentAsRead=function(e){var t=this;if(this.offlined)return Promise.reject();if(!(e=e.filter(function(e){return!1===e.hasRead})).length)return Promise.resolve();var n=e.reduce(function(n,o,r){var i=t.allComments.findIndex(function(e){return e.comment_guid===o.comment_guid});i>-1&&(t.allComments[i].hasRead=!0);var a=r+1===e.length;return n+o.comment_guid+(a?"":",")},"");return this.gcSpread.getTab().repaint(),this.emit(u.a.Update,this.allComments),this.requestService.readComment({guid:this.options.guid,params:{comments:n},headers:this.options.headers||{}})},t.prototype.cancel=function(e){var t=e.sheet,n=e.row,o=e.col,r=e.needCalcOperator,i=void 0!==r&&r,a=t.gcSheet,s=a.comments.get(n,o);if(s&&this.allComments&&!this.allComments.filter(function(e){return-1!==s.guid().indexOf(e.selection_guid)}).length){var c={row:n,col:o,guid:""};i&&this.options.editor.calcOperator({operator:Object(p.b)(a,c,this.options.editor,"cancel"),label:"comment",isDisableRecords:!0}),this.removeSheetComment({sheet:t.gcSheet,row:n,col:o})}},t.prototype.commentsByRowAndCol=function(e){var t=e.sheet,n=e.row,o=e.col;t.gcSheet&&(t=t.gcSheet);var r=(t=t).comments.get(n,o);if(r)return this.commentById(r.guid())},t.prototype.updateCommentsByPush=function(e){var t=e.db_event,n=e.data,o=this.options.editor.permissions.query.shimo.getUserPermission(),r=o&&o.id===n.user_id;switch(t){case"create":this.allComments.filter(function(e){return e.comment_guid===n.comment_guid}).length||(this.allComments=this.allComments.concat(Object.assign(n,{hasRead:r})),this.renderSheet({sheet:this.gcSpread.getActiveSheet(),comment:n}));break;case"update":this.allComments=this.allComments.filter(function(e){return e.comment_guid!==n.comment_guid});break;case"closeComments":this.allComments=this.allComments.filter(function(e){return e.selection_guid!==n.selection_guid})}this.emit(u.a.Update,this.allComments),this.gcSpread.getTab().repaint()},t.prototype.commentById=function(e){return this.allComments.filter(function(t){return-1!==e.indexOf(t.selection_guid)})},t.prototype.destory=function(){this.destroy()},t.prototype.destroy=function(){this.options.editor.off(O.Offlined,this.updateOffline),this.interval&&clearInterval(this.interval)},t.prototype.checkOffline=function(e){var t={start:i()("开始"),create:i()("新增"),delete:i()("删除"),close:i()("关闭")};return this.offlined?{message:i()(o||(o=v(["离线状态无法","评论"],["离线状态无法","评论"])),t[e]||""),type:"error"}:{type:"success"}},t.prototype.genCommentId=function(){return Object(a.genGuid)()},t.prototype.locateComment=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=this.options.editor.spread.gcSpread,r=t[0],i=t[1],a=t[2],s="string"==typeof t[0];s&&(a=o.sheets.find(function(e){var n=(I(e,p.a)||{})[t[0]];return!!n&&(r=n.row,i=n.col,!0)})),a&&a.guid()!==o.getActiveSheet().guid()&&this.options.editor.spread.setActiveSheet(a.guid()),(a&&a.comments&&a.comments.all()||[]).length?this.isCommentBoxMounted?this.showLocatedComment(a,r,i):this.on(u.a.CommentBoxMounted,function(){return e.showLocatedComment(a,r,i)}):s&&(this.needLocatedCommentGuid=t[0])},t.prototype.locateCommentByHash=function(){var e=window.location.hash.substring(1)||this.needLocatedCommentGuid;e&&(e.split("-").length>2&&(e=e.substring(0,e.lastIndexOf("-"))),/^comment-[a-zA-Z0-9]{16}$/.test(e)&&(this.needLocatedCommentGuid="",this.locateComment(e)))},t.prototype.showLocatedComment=function(e,t,n){e.setActiveCell(t,n),e.showCell(t,n,y.VerticalPosition.center,y.HorizontalPosition.center),!T(e,t,n)&&e._trigger(w,{row:t,col:n,sheet:e,sheetName:e.name()}),R()},t.prototype.bindEvents=function(){var e=this.options.editor;e.on(O.Offlined,this.updateOffline.bind(this)),e.on(O.AfterHoveredCellChanged,this.toggle),this.bindGcEvents()},t.prototype.bindGcEvents=function(){var e=this.options.editor.spread.gcSpread;e.bind(_,this.layoutChanged),e.bind(w,this.toggle),e.bind(x,this.toggle)},t.prototype.unbindGcEvents=function(){var e=this.options.editor.spread.gcSpread;e.unbind(_,this.layoutChanged),e.unbind(w,this.toggle),e.unbind(x,this.toggle)},t.prototype.updateOffline=function(e){this.offlined&&!e&&this.query(),this.offlined=e},t.prototype.addSheetComment=function(e){var t=e.sheet,n=e.row,o=e.col,r=e.guid,i=e.isRender;t.gcSheet&&(t=t.gcSheet),t=t;var a=r||"comment-"+this.genCommentId(),s=t.comments.add(n,o,[a],i);return this.options.editor.emit(l.sheets.Events.ActiveCellAttrsChanged),s},t.prototype.shouldRenderBorder=function(e){var t=this.allComments;return!(!e||!t.length)&&t.some(function(t){return-1!==e.indexOf(t.selection_guid)})},t.prototype.removeSheetComment=function(e){var t=e.sheet,n=e.row,o=e.col;t.gcSheet&&(t=t.gcSheet),(t=t).comments.remove(n,o)},t.prototype.renderSpread=function(e){var t=this,n=e.spread;n.sheets.forEach(function(e){return t.renderSheet({sheet:e})}),n.getTab().repaint()},t.prototype.renderSheet=function(e){var t=this,n=e.sheet,o=e.comment;n.gcSheet&&(n=n.gcSheet);var r=(n=n).comments.all();if(r.length)if(o){var i=r.filter(function(e){return-1!==e.guid().indexOf(o.selection_guid)}),a=i&&i[0];a&&a.renderBorder&&!a.renderBorder()&&(a.renderBorder(!0),n.repaint())}else{var s=[];r.forEach(function(e){e.renderBorder&&!e.renderBorder()&&t.shouldRenderBorder(e.guid())&&s.push(e)}),s.length&&(n.suspendPaint(),s.forEach(function(e){return e.renderBorder(!0)}),n.resumePaint())}},t.prototype.bindLoopQuery=function(){var e=this,t=this.options,n=t.usePollingInsteadOfSocket,o=t.editor,r=this.options.queryCommentOptions;n&&n.interval&&(this.interval=setInterval(function(){N(null,g(g({},r),{headers:e.options.headers})).then(function(t){t.length===e.allComments.length&&JSON.stringify(t)===JSON.stringify(e.allComments)||(e.allComments=t,e.renderSpread({spread:o.spread.gcSpread}),e.emit(u.a.Update,e.allComments))})},n.interval))},t.prototype.layoutChanged=function(){this.emit(u.a.LayoutChange,this.allComments)},t.prototype.toggle=function(e,t){var n=this.options.editor.spread.gcSpread.getActiveSheet(),o=e.cell,r=e.type,i="";if(i="CellClick"===r?"click":"CellDoubleClick"===r?"hide":"hover",!o){if(!t)return;o=t}if(!n||null==o.row||null==o.col||this.options.editor.permissions.query.canReadRange({sheetId:n.guid(),range:{row:o.row,col:o.col,rowCount:1,colCount:1}})){var a=n&&n.comments.get(o.row,o.col);this.emit(u.a.Toggle,{comment:a,commentList:this.allComments,type:i})}},t}(m.EventEmitter)},1452:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queryComments=function(e){var t=e.guid,n=e.options,o=e.headers;return a(r(r({url:"/lizard-api/files/"+t+"/comments"},n),{headers:o}))},t.deleteComment=function(e){var t=e.commentId,n=e.options,o=e.headers,i=n&&n.url||"/lizard-api/comments/"+t;return i=i.replace("{comment-id}",t),a(r(r({method:"DELETE"},n),{url:i,headers:o}))},t.closeComment=function(e){var t=e.guid,n=e.selectionGuid,o=e.options,i=e.headers,s=o&&o.url||"/lizard-api/files/"+t+"/comments/close/"+n;return s=s.replace("{selectionGuid}",n),a(r(r({method:"DELETE"},o),{url:s,headers:i}))},t.readComment=function(e){var t=e.guid,n=e.params,o=e.options,i=void 0===o?{}:o,s=e.headers;return a(r(r({url:"/lizard-api/files/"+t+"/comments/read",method:"POST",params:n},i),{headers:s}))},t.createComment=function(e){var t=e.guid,n=e.comment,o=e.options,i=e.headers;return a(r(r({url:"/lizard-api/comments?target_type=file&guid="+t,method:"POST",params:n},o),{headers:i}))};var o=n(2),r=(n.n(o),this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),i=o.sheets.ajax.ajax;function a(e){return i(null,e)}},1453:function(e,t,n){"use strict";(function(e){var o=n(1),r=n.n(o),i=n(0),a=n.n(i),s=n(3),c=n.n(s),l=n(232),u=(n.n(l),n(2)),m=(n.n(u),n(1454)),p=n(593),d=n(148),f=(n.n(d),n(1455)),h=n.n(f),v=n(528),g=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),b=this&&this.__assign||function(){return(b=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},y=u.sheets.Core,C=u.sheets.CellAppendant,w=y.Spread.Sheets.RichTextEditor,x=u.sheets,_=x.perf,S=x.Events,O=x.track,E=u.sheets.utils,A=E.showAlert,k=E.confirm,j=_.suspendFloatingObjects,M=y.Spread.Sheets,I=C.isCellAppendantActive,P=C.AppendantComponent,R=w.breakLine,T=function(t){function n(e){var n=t.call(this,e)||this;return n.toggleComment=function(e){var t=e.comment,o=e.commentList,r=e.type,i=n.props.editor.permissions.query.canCommentFile(),a=n.props.editor.spreadOptions.isHistoryPreview;if(!(!i&&!a||n.hasContent(n.state.inputVal)||(n.state.isActive||n.mouseOnComment)&&"hover"===r)){var s=n.state.cellComment,c=t&&s&&t===s,l=t&&t.renderBorder&&!t.renderBorder();if("hide"===r||!t||l||n.state.isActive&&c)return n.hide();n.show({commentList:o,cellComment:t,isActive:"click"===r,type:r})}},n.hideForSheetScrolled=function(){!n.state.isActive&&n.hide()},n.hide=function(){if(n.state.isShow){var e=n.props.editor.spread.getActiveSheet();if(n.state.cellComment){var t=n.state.cellComment,o=t._rowIndex,r=t._colIndex;n.props.commentModel.cancel({sheet:e,row:o,col:r})}n.setState({isShow:!1,isActive:!1,cellComment:null})}},n.startComment=function(e){var t=e.cell,o=e.cellComment,r=e.commentList;n.state.cellComment&&n.state.cellComment!==o&&n.hide();var i=n.props.commentModel.checkOffline("start");if(i&&"success"!==i.type)return A({title:i.message,type:"error"});var a=n.props.editor.spread.gcSpread.getActiveSheet(),s=t.row,c=t.col;a.showCell(s,c,M.VerticalPosition.center,M.HorizontalPosition.center),n.show({commentList:r,cellComment:o,isActive:!0}),n._focusInput()},n.updateCurrentCellCommentList=function(e){var t=n.state,o=t.cellComment,r=t.isActive;if(o){var i=Object(v.c)(e,o.guid());n.setState({commentList:i}),r&&n.props.commentModel.markCommentAsRead(i)}},n.updateLayoutChange=function(){var e=n.state.cellComment;if(e){var t=n.props.editor.spread.getActiveSheet(),o=e._rowIndex,r=e._colIndex,i=t&&t.gcSheet.comments.get(o,r),a=!!i&&i===e;if(a||n.state.isShow){var s={isShow:a};!a&&Object.assign(s,{isActive:!1}),n.setState(s),a&&n.props.editor.emit(S.CellAppendantPositionChanged,{cell:{row:o,col:r}})}}},n.state={commentList:[],isShow:!1,isActive:!1,inputVal:"",cellComment:null},n.mouseOnComment=!1,n.addComment=n.addComment.bind(n),n.cancelComment=n.cancelComment.bind(n),n.deleteComment=n.deleteComment.bind(n),n.closeComments=n.closeComments.bind(n),n.onClick=n.onClick.bind(n),n.onMouseOver=n.onMouseOver.bind(n),n.onMouseOut=n.onMouseOut.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n}return g(n,t),n.prototype.componentDidMount=function(){var t=this;this.bindEvents(),this.changeCommentBoxMountedState(),e(this.refs.body).on("mousewheel DOMMouseScroll",function(e){var t=e.currentTarget;if(t.scrollHeight!==t.offsetHeight){var n=e.originalEvent||e,o=(n.wheelDelta||-n.detail)>0?"up":"down";("up"===o&&0===t.scrollTop||"down"===o&&t.scrollTop===t.scrollHeight-t.offsetHeight)&&e.preventDefault()}}),Object(d.isIE)()&&e(this.refs.input).on("keyup",function(e){e.target&&t.onInput(e.target.innerHTML)}),this.initMention()},n.prototype.componentWillUnmount=function(){this.unbindEvents()},n.prototype.bindEvents=function(){var e=this.props.editor;e.on(S.TopRowChanged,this.hideForSheetScrolled),e.on(S.LeftColumnChanged,this.hideForSheetScrolled),this.props.commentModel.on(p.a.Start,this.startComment),this.props.commentModel.on(p.a.Toggle,this.toggleComment),this.props.commentModel.on(p.a.Update,this.updateCurrentCellCommentList),this.props.commentModel.on(p.a.LayoutChange,this.updateLayoutChange),this.refs.input.addEventListener("keydown",this.onKeyDown)},n.prototype.unbindEvents=function(){var e=this.props.editor;e.off(S.TopRowChanged,this.hideForSheetScrolled),e.off(S.LeftColumnChanged,this.hideForSheetScrolled),this.props.commentModel.off(p.a.Start,this.startComment),this.props.commentModel.off(p.a.Toggle,this.toggleComment),this.props.commentModel.off(p.a.Update,this.updateCurrentCellCommentList),this.props.commentModel.off(p.a.LayoutChange,this.updateLayoutChange),this.refs.input.removeEventListener("keydown",this.onKeyDown)},n.prototype.initMention=function(){var e=this,t=this.props.editor,n=t.pluginManager.get("MentionPlugin");n&&n.instance?this.__createMention(n.instance,this.refs.input):t.on(S.PluginInstalled,function(t){var n=t.name,o=t.instance;"MentionPlugin"===n&&o&&e.__createMention(o,e.refs.input)})},n.prototype.changeCommentBoxMountedState=function(){this.props.commentModel.isCommentBoxMounted=!0,this.props.commentModel.emit(p.a.CommentBoxMounted)},n.prototype.show=function(e){var t=e.commentList,n=e.cellComment,o=e.isActive,r=e.type;this.state.cellComment&&this.state.cellComment!==n&&this.hide();var i={row:n._rowIndex,col:n._colIndex};"hover"===r&&I(this.props.editor)||(this.mouseOnComment=!1,t=Object(v.c)(t,n.guid()),this.setState({commentList:t,cellComment:n,isShow:!0,isActive:o}),o&&this.props.commentModel.markCommentAsRead(t),this.props.editor.emit(S.CellAppendantPositionChanged,{cell:i}))},n.prototype.addComment=function(e){var t=this,n=this.props.commentModel.checkOffline("create");if(n&&"success"!==n.type)return A({title:n.message,type:"error"});e.stopPropagation();var o="",i=this.refs.input;o=i.getElementsByTagName("a").length?i.innerHTML.replace(/(\s|&nbsp;)+$/g,"").replace(/<br>/g,"\n").replace(/<\/?((?!a)(\!\-\-)*([a-z]+)).*?>/gi,""):i.innerText.replace(/(\s|&nbsp;)+$/g,"").replace(/(\s|<br>)+$/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");var a=this.props.editor.spread.gcSpread.getActiveSheet(),s=Object(l.genGuid)(),c=(new Date).toISOString(),u=this.state.cellComment.guid()[0],m={selection_guid:u,selectionGuid:u,comment_guid:s,commentGuid:s,content:o,created_at:c,createdAt:c,selection_title:a.guid()||"",selectionTitle:a.guid()||"",user_id:this.props.currentUser.id,userId:this.props.currentUser.id};this.setState({commentList:this.state.commentList.concat(b(b({},m),{User:this.props.currentUser}))}),this._clearInput(),this._focusInput(),setTimeout(function(){t.refs.body.scrollTop=t.refs.body.scrollHeight}),function(e){var t=e.match(/mention/gi),n=e.match(/mention-user/gi);t&&t.map(function(){O(2,"2058")}),n&&n.map(function(){O(2,"2059")}),O(2,"2057")}(o),this.props.commentModel.create({comment:m,user:this.props.currentUser,row:this.state.cellComment._rowIndex,col:this.state.cellComment._colIndex}).catch(function(e){A({title:e.message||r()("新增评论失败，请稍后重试"),type:"error"})})},n.prototype.closeComments=function(){var e=this,t=this.props.commentModel.checkOffline("close");if(t&&"success"!==t.type)return A({title:t.message,type:"error"});k({title:r()("结束讨论"),description:r()("结束讨论后该讨论将被彻底删除，确定结束吗？"),confirmFun:function(){var t=e.props.editor.spread,n=t&&t.getActiveSheet()||{};e._clearInput(),e.setState({commentList:[],inputVal:""}),e.props.commentModel.close({sheet:n,row:e.state.cellComment._rowIndex,col:e.state.cellComment._colIndex}),e.hide()}})},n.prototype.deleteComment=function(e){var t=this.props.commentModel.checkOffline("delete");if(t&&"success"!==t.type)return A({title:t.message,type:"error"});this.setState({commentList:this.state.commentList.filter(function(t){return t.comment_guid!==e})}),this.props.commentModel.delete(e).catch(function(e){A({title:e.message||r()("删除评论失败，请稍后重试"),type:"error"})})},n.prototype.cancelComment=function(e){this._clearInput(),e.stopPropagation(),!this.state.commentList.length&&this.hide()},n.prototype.onInput=function(e){this.setState({inputVal:e});var t=this.state.cellComment;t&&t.isEditing(!!e)},n.prototype.onClick=function(){var e=this;this.state.isActive||this.setState({isActive:!0},function(){if(e.state.cellComment){var t=e.state.cellComment,n=t._rowIndex,o=t._colIndex;e.props.editor.emit(S.CellAppendantPositionChanged,{cell:{row:n,col:o}})}e._focusInput()})},n.prototype.onMouseOver=function(){this.mouseOnComment=!0},n.prototype.onMouseOut=function(){this.mouseOnComment=!1},n.prototype.hasContent=function(e){return!(!e||!e.replace(/<\/?[^>]*>/gim,"").replace(/&nbsp;|\s/g,"").length)},n.prototype.onKeyDown=function(e){var t=13===e.keyCode,n=e.shiftKey,o=e.altKey,r=e.target;if(t&&(!this.mentionPop||!this.mentionPop.inMention))if(!n&&!o&&r&&this.hasContent(r.innerHTML))this.addComment(e),e.preventDefault();else if(o&&!Object(d.isSafari)()){var i=this.refs.input,a=i.lastChild;if(!a||"BR"!==a.tagName){var s=document.createElement("br");i.appendChild(s)}R(i),this.onInput(e.target.innerHTML)}},n.prototype.handlePaste=function(){var t=this;setTimeout(function(){var n=new RegExp("SHEET_COMMENT_A_TAG","g"),o=c.a.findDOMNode(t.refs.input);e(o).find("a").forEach(function(e){return e.innerText&&e.href&&(e.innerText+="SHEET_COMMENT_A_TAG")});for(var r=o.getElementsByTagName("a"),i=o.innerText,a=0;a<r.length;a++){var s=r[a],l=i.indexOf(s.innerText);s.innerText&&s.href&&l>-1&&(i=i.split(s.innerText).join("<a href="+s.href+">"+s.innerText+"</a>"))}i=i.replace(/\n/g,"<br>").replace(n,"").replace(/</g,"&lt;").replace(/>/g,"&gt;"),o.innerHTML=i;var u=window.getSelection();if(u&&0===u.anchorOffset){var m=document.createRange();m.selectNodeContents(o),m.collapse(!1),u.removeAllRanges(),u.addRange(m)}})},n.prototype._clearInput=function(){this.refs.input.innerHTML="",this.onInput(""),this.mentionPop&&this.mentionPop.hide()},n.prototype._focusInput=function(){var e=this,t=this.props.editor.spread.gcSpread,n=t.getActiveSheet();j(function(){t.focus(!1)},n)(),setTimeout(function(){e.refs.input&&e.refs.input.focus()})},n.prototype.render=function(){var e=this,t=this.state,n=t.isActive,o=t.isShow,i=t.commentList,s=t.inputVal,c=!i.length,l=!(s&&s.replace("<br>","")),u=this.hasContent(s),p=n||c,d=n&&!c,f=n?"active":"";return a.a.createElement("div",{className:"doc-comment-container",style:{display:o?"block":"none"},ref:"container",onClick:this.onClick,onMouseEnter:this.onMouseOver,onMouseLeave:this.onMouseOut,"data-show-type":n&&o?"active":o?"hover":""},a.a.createElement("div",{ref:"box",className:"doc-comment-box "+f},d&&a.a.createElement("div",{className:"doc-comment-header",ref:"header"},a.a.createElement("a",{onClick:this.closeComments,className:"doc-comment-close"},a.a.createElement("span",{className:"doc-comment-close-icon"}),r()("结束讨论"))),a.a.createElement("div",{className:"doc-comment-body",ref:"body"},i.map(function(t){return a.a.createElement(m.a,{user:e.props.currentUser,defaultAnonymousUser:e.props.defaultAnonymousUser,deleteComment:e.deleteComment,comment:t,key:t.comment_guid})})),p&&!c&&a.a.createElement("div",{className:"doc-footer-divide"}),a.a.createElement("div",{className:"doc-comment-footer"+(p?"":" hide"),ref:"footer"},a.a.createElement("img",{className:"doc-comment-avatar",src:this.props.currentUser.avatar||h.a}),l&&a.a.createElement("div",{className:"doc-comment-input-placeholder"},r()("按enter发送，shift+enter换行")),a.a.createElement("div",{contentEditable:!0,onInput:function(t){return e.onInput(t.target.innerHTML)},ref:"input",className:"doc-comment-input",onPaste:function(){return e.handlePaste()},spellCheck:!1}),u&&a.a.createElement("div",{className:"doc-comment-btn-box"},a.a.createElement("a",{onClick:this.cancelComment,className:"doc-comment-btn doc-comment-cancel sm-button"},r()("取消")),a.a.createElement("a",{onClick:this.addComment,className:"doc-comment-btn doc-comment-send sm-button sm-button-ok sm-btn-shortcut-confirm"},r()("确定"))))))},n.prototype.__createMention=function(e,t){this.mentionPop=e.createMention({editor:t,id:"sheet-comment-mention"})},n}(P);t.a=T}).call(t,n(144))},1454:function(e,t,n){"use strict";var o=n(1),r=n.n(o),i=n(0),a=n.n(i),s=n(2),c=(n.n(s),n(735)),l=n.n(c),u=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),m=s.sheets.utils,p=m.confirm,d=m.dateTime.format,f=function(e){function t(t){var n=e.call(this,t)||this;return n.deleteComment=n._deleteComment.bind(n),n}return u(t,e),t.prototype._deleteComment=function(){var e=this;p({title:r()("删除评论"),description:r()("确认要永久删除该评论吗？"),confirmFun:function(){e.props.deleteComment(e.props.comment.comment_guid)}})},t.prototype.render=function(){var e=this.props.comment,t=this.props.user,n=e.content,o=e.created_at,i=e.isSending,s=e.User||this.props.defaultAnonymousUser,c=s.avatar,u=s.name,m=s.id,p="";return t.id===m&&(p="current-user"),a.a.createElement("div",{className:"doc-comment-item "+p},a.a.createElement("img",{className:"doc-comment-avatar",src:c||l.a}),a.a.createElement("span",{className:"doc-comment-online"}),a.a.createElement("div",{className:"doc-comment-text"},i?a.a.createElement("span",{className:"sm-sheet-loading-rotate"}):[a.a.createElement("span",{key:"doc-comment-time",className:"doc-comment-time"},d(o)),a.a.createElement("span",{key:"doc-comment-delete",className:"doc-comment-delete",onClick:this.deleteComment},r()("删除"))],a.a.createElement("span",{className:"doc-comment-name"},u),a.a.createElement("br",null),a.a.createElement("span",{className:"doc-comment-content ",dangerouslySetInnerHTML:{__html:n.replace(/\n/g,"<br>")}})))},t}(i.Component);t.a=f},1455:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAADwCAMAAAAJixmgAAABjFBMVEUAAABSV1dDSE1gYGdBRktBRktBR0tBR0xCRktBRktCRktBRktCRkxCRkxCSEtCRk5CR0tCR0xFTlJBRktBR0tCR0tCR0xBSExDR0xDR0xCS09JSVBCRktCR0tCR0tNT1lCR0xCR0tCRkxBR0tCR0xBR0tCRktCSE1ER05CSU1GRk1FTEz////////////////Y2tv////w8PC5u71VWV3///////////9cYWX////9/f3///9BRkv///9XW2Do6enCxMXKy8yrra9CR0z4+PjZ2tu6vL6Ul5pFSk/9/f37+/v5+fpITVLz8/OztbdKT1NlaW1bYGS/wcN9gIPh4uPq6+uipadPVFhUWV1MUVZ3e37c3d6eoaPw8PDU1ddrb3NRVlvFx8iNkJN0eHxhZWqlp6mbnaCQk5aEh4pxdXlucnZobHDQ0dL09fXs7e29v8BYXGDl5ufNz9C2uLrX2NmvsbOXmp2KjZBfY2fe3+DIysuAhIeytLbj5OXS09Soqq2Hio56fYG4urvx8fJMAsAiAAAAPHRSTlMACjgF9vvj1qjw7N20glQ6cGUTy7Cfknt1Tx0R4dnEGNG+ubeXiWlZS0IoJUdS5p/GD/Ty2M/Myci9eC60+N3iAAARhklEQVR42uTb2VcaSRQG8ALBXaMmxtGomSyTZXLmZZ6/q2i7gICAgAJuuO9r1LglZvnHZ0C6C+gGurtqJEx+j0k8J9+pqlt1q1r2YJ4733a0vW588XtLfXOTy+12NTXXt/z+ovF1W8db53P2P+Jwdj591eBCWa6GV087nQ5W4xzve560oBxFQb6WJz3vazV1V/vTx25UEo5vRFDI/fhpexerLXXOtscw5RMR7W97Uexxm7OO1QhHe2MzzBqljMWNBHSaG9trYHbX9TY2wYJ9ujc1sQ69psben3ucH3U3wZogqXwTCRhl7n7Efk5/Pe9oQCnJhWUYOaY8wRQMNXT8jDXM+Xd8y4tSTolmEtCLUr5rlOBqdLKfS+8gYkSHkwEY+podwE/QmSXu6iKN0gZ72U/D0TkAYD5bbrcU6CUXKWskoR951ecoKhjo/DmKdt2bemQs5cZpDTrn2iq9QQHlgHL866is/k31a3ZdZ3/xYHkiKLTnI82tF3nCpJqEKf2dVY7cPgDVNal8Y4WmKM9+CNwW5QwrMGmgnVXPh5fgZsicFXBHlHMBA7Px2RD0Xn5g1eFocyHPBJlzBm6Y7o0lobdNRCfL0HO1VaV6vWtBgWnKORguNkaag9GQwbFjGnqJYHZ5bCjQa3nHHlrfE30bkDOKYh7K+R4NIM8q5YSh0dWEpWMYeNLHHlJdjwt2As8Z//mZYd+oCkZhwNXzgPXa2QBICKwE6d7CkE74gLjbAAw0ONkD+c0NKYF3yayrdRhw/8YewrNWQE7gWTLtYA1GWp+x/9yjesgKfEbm+dMwUq9vluVPZ1mBEz7Kio8YiFOh4DFQhWnd1QpICzxJ96LQ8x5Sntj5twBKae1i8vHpLDHwUi6NAr0t4k7XwT3otO5wQ2LgIR9lrUJPOSHNioIK3B3sP/EHIC0wn9GHXsMbEk08hMr+YPLVdUNiYF6jJ2AgRpobmNFdxyRztEJu4Ii6w4bKXu3tw5xWB5Pq2SAkB76jnC3ojJNmGSYNSj2D9DVAcmDvImVMEcVQLEUaD0xrkNg//dkPOYETUN1Q1uQYUUr//KKauoR5/X8ySZzNkBT4uOh+NqbsE40ApXqKaVjR7JSU1wVZgSPIifgoI4VZ/TodIdVYApa4pCT+sxnSAq8X3lSPAGtEdIp8y6TZgEXNEmZ1Xz840cBh3Ev7syt0HQhNEdEOOO8VqQ5DsKq/T3g/aoBJtyYC7+HeBmWcq1vQErgN0mzDugbB3ckxCLMmKgXmqzV5QP8aDmm3AFGo9qZ40wA7Bh1MQF0rzOKpFseLBSmDz91N+pdvl7+2xEP6Ce2/hC2tIqfMbpg3QpWtISOUPXTc4d5Jdnbrb31mYVO3SH9kwT5V9o0v03lvfrHzLSMjzCf0SQAWifdOHbCAH4D3J4vNU04KAIb82vMoP2dcZfJ750nlW4N9NvvjR25YEStdtGbUFBGtun2FShmmjI+FE3oUAtyPmA1d9bBkmP9fSxTwq6j2WrwAbpOyVvmE5hPepvouZl0rrPlR+ny0kImwEUaGckZE35Fnzk8Z/l0+of3rENNq4z4WFvnVDmcZWeGvCeQEblJp5FwQ0akX+T7mfpA0WxD1m+QFrKfQvasUv7aInUeTKBQZI1oq+sOw/s3cIvFl/KweFilTmUFa2YFqjTJ845mpzH0hWgkYFjVuPgRx9c/kLmC97a21iGLY1p6l8q8jbxUUO/ZTnsMhyNBqbQGLCxN3hxzv9CYMzBLn34MAe8vY6Ya4dTJ/TEz6SfMJkridpluGBkhwSdqXwbsoTzkiLh6FJA1m24geyBChnGGUwfNyngTk6GGm9LlgRwKwF1iZoSIHWwpkcPUxM57AlvjiyMaOF5pjU4H1eXlhF/eEmfAO9nzOjo3n0xzuDVUOzPPqxVYDEPeOVeRogT3zao3yLBsGXj4z+kTc6yHVYowKLM6mIarFwSppg01LpBk1CDz0g2hRV67n+E/NDyWvqZD/+x4EtbEKPrhg0ylpvhgEXskmuEGByxNSzQQA5Y6KDY/uKhDg+sDKewm7RnjFSesDRynLt4o8a0Ftr95E1rafdA5v1wQyv2RltcM2dT76F7zQBQ7FDTq/Va0h5B/N7sXJwI/v0TnY1M7KqBuAbSt0b8SoSp+TRh1jZZRUR0lo0l/IWGx6ewg2DNSx0jpRmu3AwcnJBR9pfFFkhFa0v/+KfMpqkEoZnli9hFWdZQa4H/Z5dIH1+P1N+DPleNIokp6gMr7Aov7SQ/wGlYkHpn1gy69WpCgM7MQkBsYbVoKjHpWJBx67S86oxfk2CUPezTHS859Oz27twKp6h40VLBB4OFBI2TtRhzqMko49VOjwPBVARZZW8QAElAmMQpN+yorfoDQljb1T4hYvArBtgBnqhRmigZPayB2FUVIiRvs7WDujnNEQRPQyI4MwSSTwtzhl+LOjvLTtLXdOvb5Eaim71FchZpAZcEKAycDJ7/e16uPxuNoRDcHARa6m3YWw65mKpyDKyfQaIaByYD68vokI8IW0bnJSZ9Off8EVCkFYI9PpckFApcB8eH0z67zVMMEzBwlcXQKPwZylwKl4Nm6Y/2tz4ruQoIMVa4CA8oG14fVPR3S/Zvlj3IifOP8OxDXoHs8gwETgWaLgRtrgm58JGBmmPLOQ4JHA5yuc+cCJ4YsQ8nw0HfhgU4EE3UV9UhMEmAgMBQWmTQaeukhCiqY68VOWpcCwF3gMsvRK2YRrKHDBVuxogj01FLjJIePuroYCo13KjK6hwI1MU9cMu2oocHOdjEaphgLDKfCexNVQ4Damegz7aijwY60zhIAaCowuKZtSDQVWN6anEGElsHIZXZiJJaoV+KmUJWwy8HFqc2LeTxmrVQnMF7HDDREVAx+uTX5cOiDNWbRagd0OlvEeQqw9tcQ3Lqu3hvFe0ndo+sDe9e1z0hmbWFOAKgbu4d9lieKBl75tHl1NkY5v/2sIQFUDP2EZLZDCQ+XENo/BWbjxgEwt2ZoFcaG9m80TKil4uwzOUmCCVA7hzmF7euZ0fpHKmFq58ULHdGAvZHIKvwqvUXnjk3PQsRI4BJk6xc9Z41Ta4d06jPHAniEjcVIlIQc/a72CkBsqYeyo3Pdk38mkNGR6Jf7GonwmA779TyGUM0MmJSAHf3FxQcwq6XxeOEYF12RSBDK5GHsOQYEgFQhOL6OyfbNr+BJSPWdOiBolbur6xgszzsxW6XVI5WRvISrio5z5izRMujIbOAyp3rIOCBsh4m/dJg2bDOxLQKoOGTeW3+hfK2FYsVg+8AnxXzmWqo29hjBlfOp6D9aMlX/tnr/fyVMKJHst5ZUllIZVPnXZz8HIKAVXPoUgXyN7gWoIUNbBQgCGlIiC/8QL9juqIZRdoFshPLTfWQuq4mhkYR1V0MLq8UupZ834pTSzJvxSmpgLvxQXc+OX4v6nvPv+aiII4gC+uVRJIaBIU+y9P7t+x0JQL2CEADYIgiBIsSH2Xv5xHyk3uRhM2bshPj6/5bfsu7ndm22z8Rq84UJ6w3VaG25Y2nAfHmFsKGHh5CFtv4BJ3k7h9HCIiPrf3BvCetmlQpC0SDnLfLRfVkjthaQxsrzoHYK8vSoKSZ+p2Pi0CWFRFYek92T3KAFZcXUAkp6SXX8asg4oA5LmyOb6JIQZagckzdqauwRxO5RsutRL7C3k+XhBXMYKsWnIC/KWBxnDxHohbw9vapHxmth1yNvK25ZkjBO7CnktvDFNxlViydsQZ/DWQxl9VGQI4jy8uVSEScXmIS3M24dlPKBi9yBtC28Ql/GELEmiYUhr5yMAMhbJMkq0DGmH+JCHjBGyvOSNo2L8Hj7GI+M9Wd5xJRMxm/mglpA5ssxwqXQxW/konpC3ZElPEL2ErBgfthRyjSyD40SjkNXKx2mFcMXhPlwnSg5C0mZVEIUQ3hW8nE2NFyEpqgoMyEj083QlMuK9lmG79EDCFFmGs0PUYwhq8ipLCCKGyPIdC0SUSkBOSLEYRPwky1OkpTPEmP1qGgnTZPkJM5lttxC+mkYypmfJ8gR4QaIJU0gV64SEYbIM5i6VfwExnaUXiAngY3sTyN8Sl4aQTV5l0wYBKT6DCSAjOhvfpuya4b77xcMwME+SI3GzKhGE65bI8r3ws8+EiKAqFYfr5snyHoUHPgMR8dqvatWXKSn+/ltqhYmvapUdin+R5SGQL3byFRJCismlTI8oyxp+V0hsYDJUGT1w2fOSWsq3aNUtuK9HMbmvrXTp4v9MPjN2X2cdl+LrG7GX6iwsvCRfwW3bNcoeaMiQZQFZKVo1B7e1aBS20DBc0kkX7k0fh8sCHo3SJRpGKYeHol4+5u+m/RrFaTTcTvK6EnJ+CCybcnEa6bd4iSzvkPOEskbhqhaNAlM6bv3VZyHRR1mLcE3ZAlMys3ncZ/GCwzcOcdfENIrEaeBVBw5hq9camIJrdmuUAdTyiiw3UTBC5PJQ7DuiUehRhz0ZzuGliOUEXBLVKOWp5y1ZXiGPx+YxuCPs0SjWqudG2S2HK5TzCe44qFGOV8/9JBX8Avvh7q68LRoFlzXNk+UH2BRPY7rA1yVZUtvuJlmuwMLba5Mf4Lx2yaLpdokJW+bAZnmsclzQK1kW327SPiXNFtw70OM3VNU64LB79hlaZqYobwUO61A1iMBZPCi9SMBmhfKSQ3BURNWiOwAnpcnyBXZjPJUJJwW6VU2a/XCKPaLHYGf+poIROMffrJj8a7xMBSkTJe5w/23CMR2Kyb/Gi2tHNG/tcXROPqJq1xqAU1bIsoS/POLH/wDOCLQqJv0a2+42HUcp/urUzyFqfIFdWzKeti85lDIn7Kmyvriq0z7os91P3PcQZcySs0G9T9WtDQ74TJYVlHOl39EDiW2qft4I9N2oeAD+GrGn0BTxKg2eHuiaIaqUEU0SG1iClh6P0tIdhKZvRBVz3k/E7k5BQ7BbaeraBi2fiSrPajxJEnuWQN22dSlth5ug4fZVDtYPWNNNcuToeNNh5QDDh/rdq+5sZbqfSH809hnKEUYT6vVqgBdYTPzDFyrSP4J6NBnKIYe3oU7XyLKAf3nQR7pFpbcdVo7pCqIu87Zvjoqxz54voVbBLuWg7h7U4QpnDR8H8W/mKBWbeILa9HQrR3kiqFniGRWk0qhkMknFUouoRcSjHOZtQ63mqCA5hsp6yWbgJ6rX5lW69HOnJR5qMqjC7WWy6X+Pau1Troj7UYOpq1TjqsJCkuwyqIo/rlzSHEDVTJ65GU6gOl+oxOOHqCzQrFzTGkG1bvK/NlGlwVEqsTyESiKtyk0dflQlwym9iap9eE4lBqYrhHOHKkM+rD8na2kv+5mkUsMPxMPZrjuCisYGKG/FBKslMlhqGmuJdCsJHf6q25tBra7R3559EA9nOyOIf5kptHdgHjUb/Eh/G5gt010HDSXG2+7Dmhb6CrG4gDqkJ6iM1Nxt2PjavUpS15aK7X3zCnWZ7KNyXjw1wbZ0KWkHwyhnPh/Pye8m6jTWT2XdzUwhJ3xQrQNP1Ld2wjDxE/X7QWvofzkJwBf1qPVxZDfsEnco59sV6JijNT3C7iNq/cS2A2zwE2X1vUtATy+tZTSm1pW3ZRv3r+P5YTMNbStkk3r8JfMuM9t7+uQltd68+wPIGknRqufTcEDiJbHHMyZWBfZ7VSPwtGwHzN78n3sARyQeW+PRCLK2t3hUw+i8kEt/v47AKeanfP93H6t6OlUjOXo8G83vTDjHzEb1NROAL2SoRnLqBK06eQaOSrwl+pIAgvFW1VByj/fiZaWa2zbBSYvz2NTWrBpL7vGeP6qyvJ0hB9u8KdTZGP1y6eM9d1QxTyzUBAc0hWIN1C1bjhGdPaZKeI3oZmjZHDUa7tnmneDm2rTGtm72ow7+zVtjDdZLVc1zqH1LGDUIb2k/1IhxXBOP0bJ1T9CHf/IF92xtMf77thbbYRyIR/eGdu0MB5o2+fx+36amQHjnrtDeaPyAsUNJ+QNBtw1r+mzMOwAAAABJRU5ErkJggg=="},1456:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var o=n(1),r=n.n(o),i=0,a={test:function(e,t){!function(e,t,n){e.forEach(function(e){setTimeout(function(){e(t)},i+=n)})}([this.start.bind(this),this.cancel.bind(this),this.start.bind(this),this.create.bind(this),this.create.bind(this),this.delete.bind(this),this.close.bind(this)],e||window.CommentModel,t||1e3)},start:function(e){e.start({sheet:e.options.editor.spread.getActiveSheet().gcSheet,row:0,col:0})},cancel:function(e){e.cancel({sheet:e.options.editor.spread.getActiveSheet(),row:0,col:0,needCalcOperator:!0})},create:function(e){var t=""+new Date;e.create({comment:{comment_guid:t,commentGuid:t,content:r()("这是一条评论")+t,created_at:(new Date).toISOString(),createdAt:(new Date).toISOString(),selection_title:e.options.editor.spread.getActiveSheet().gcSheet.guid()||"",selectionTitle:e.options.editor.spread.getActiveSheet().gcSheet.guid()||"",user_id:window.cow.currentUser.id,userId:window.cow.currentUser.id},row:0,col:0,user:{id:0,name:r()("路人"),avatar:"https://assets.smcdn.cn/static/unmd5/default-avatar-luren.2.png",isVerified:!0}})},delete:function(e){var t=e.commentsByRowAndCol({sheet:e.options.editor.spread.getActiveSheet(),row:0,col:0});t&&e.delete(t[0].comment_guid)},close:function(e){e.close({sheet:e.options.editor.spread.getActiveSheet(),row:0,col:0})}}},1457:function(e,t,n){"use strict";var o,r=n(1),i=n.n(r),a=n(0),s=n.n(a),c=n(2),l=(n.n(c),n(43)),u=n(35),m=n(528),p=c.sheets.shortcutKey.getTip,d=function(e){return Object(m.d)(e.editor)||e.isEditing||!e.editor.spread||!e.permission.hasSelections||!e.editor.permissions.query.canCommentRange({sheetId:e.editor.spread.getActiveSheet().id,range:e.selection.selectedCell})};function f(e){return s.a.createElement(u.j,{disabled:d(e)},s.a.createElement(u.b,{icon:"comment",selected:e.selection.commentSelected,onTap:o.startComment},s.a.createElement(u.k,{option:i()("添加评论"),detail:p("comment")})))}function h(e){return s.a.createElement(u.e,{editor:e.editor,icon:"comment",text:i()("评论"),disabled:d(e),onTap:o.startComment,tip:Object(m.d)(e.editor)?i()("登录后才可使用"):""},s.a.createElement("span",{className:"menuItem--shortcut"},p("comment")))}function v(e){return s.a.createElement(u.i,{disabled:d(e)},s.a.createElement(u.b,{icon:"comment",selected:e.selection.commentSelected,onTap:o.startComment},s.a.createElement(u.k,{option:i()("添加评论"),detail:p("comment")})),s.a.createElement("br",null),s.a.createElement("span",null,i()("评论")))}t.a=function(e){var t;return o=e,{singleTool:f,doubleTool:v,tabList:(t={},t[l.b.insert]=h,t)}}},1458:function(e,t,n){"use strict";t.c=function(e,t){var n;s("SheetTabBase").register("comment",((n={})[a.SheetTabBase.getSheetTabIcons]=function(n){var o=t&&t.allComments||[],r=n.sheet,i=n.tabIcons,a=n.font,s=r.attrs.comments||{},u=e.spread.gcSpread.getActiveSheet(),m=u===r,d=o.reduce(function(e,t){var n=s[t.selection_guid];return n&&!n.isOld&&!1===t.hasRead&&r.isRangeReadable(n.row,n.col,1,1)&&e.push(Object.assign(t,n)),e},[]).sort(function(e,t){return e.row<t.row?-1:e.row===t.row&&e.col<t.col?-1:1});if(r.comments._unreadComments=d,d.length>0){var f=d.length.toString(),h=m?c:l,v=function(e,t,n){var o=function(e,t){var n=document.createElement("canvas").getContext("2d");return n.save(),n.scale(p,p),n.font=t,n.restore(),n.measureText(e).width}(t,n),r=document.createElement("canvas"),i=window.devicePixelRatio||1,a=t.length>1?3:7,s=Math.max(o+a,14);r.width=s*i,r.height=14*i;var c=r.getContext("2d");c.scale(i,i),c.fillStyle=e,c.fillRect(0,0,s,12),c.fill(),c.save(),c.scale(p,p),c.font=n,c.fillStyle="#ffffff",c.textBaseline="middle";var l=(s-o)/2+1;return c.fillText(t,l,8),c.restore(),c.beginPath(),c.fillStyle=e,c.moveTo(2,12),c.lineTo(2,14),c.lineTo(7,12),c.fill(),c.closePath(),{image:r,width:s,height:14,offsetY:1,name:"comment",priority:90}}(h,f,a);i.push(v)}},n))},t.b=function(){s("Worksheet").register("comments",{init:function(){this.comments=new r.a(this)},onLayoutChanged:function(e){var t=this.comments,n=e.changeType,o=e.row,r=e.rowCount,i=e.col,a=e.colCount;"addRows"===n?t.onRowsAdded(o,r):"deletingRows"===n?t.onRowsRemoved(o,r):"addColumns"===n?t.onColumnsAdded(i,a):"deletingColumns"===n&&t.onColumnsRemoved(i,a)},afterCellPainted:function(e){e.isPrinting||3!==e.sheetArea||function(e,t,n){var o=n.row,r=n.col,i=n.x,a=n.y,s=n.width,c=n.height;if(3===t&&this.isRangeReadable(o,r,1,1)){var l=this.comments.get(o,r),p=this.options.commentColor||u;l&&l.renderBorder()&&e&&s>0&&c>0&&(e.save(),e.rect(i,a,s,c),e.clip(),e.fillStyle=p,e.beginPath(),e.moveTo(i+s-m,a),e.lineTo(i+s,a),e.lineTo(i+s,a+m),e.lineTo(i+s-m,a),e.fill(),e.restore(),e.save(),e.lineWidth=2,e.strokeStyle=p,e.strokeRect(i,a,s-1,c-1),e.restore())}}.call(this,e.ctx,e.sheetArea,e.cell)}})},t.a=function(e){var t=i._getFeatureManager("Worksheet")._features.find(function(e){return"comments"===e.name});e.forEach(function(e){return t.init.call(e)})};var o=n(2),r=(n.n(o),n(1459)),i=o.sheets.Core.Spread.Sheets,a=i.HookNames,s=i._getFeatureManager,c="#6da0e3",l="#a5a5a5",u="#f5d57a",m=8,p=.83},1459:function(e,t,n){"use strict";var o=n(1460),r=function(){function e(e){this._sheet=e,this._commentList=[],this._unreadComments=[]}return e.prototype.add=function(e,t,n,r){var i=new o.a(n,r);return this.addInternal(e,t,i),i},e.prototype.get=function(e,t){return this._sheet._getModel().getValueForKey(e,t,"comment")},e.prototype.remove=function(e,t){var n=this.removeInternal(e,t),o=this._sheet;n&&o._invalidate()},e.prototype.clear=function(e){for(var t=this._commentList,n=t.length-1;n>=0;n--){var o=t[n],r=o._rowIndex,i=o._colIndex;(!e||r>=e.row&&r<e.row+e.rowCount&&i>=e.col&&i<e.col+e.colCount)&&this.remove(r,i)}},e.prototype.all=function(){return this._commentList},e.prototype.onRowsAdded=function(e,t){for(var n=this._commentList,o=0;o<n.length;o++){var r=n[o];e<=r._rowIndex&&(r._rowIndex+=t)}},e.prototype.onColumnsAdded=function(e,t){for(var n=this._commentList,o=0;o<n.length;o++){var r=n[o];e<=r._colIndex&&(r._colIndex+=t)}},e.prototype.onRowsRemoved=function(e,t){var n,o,r=this._commentList;for(o=r.length-1;o>=0;o--){var i=(n=r[o])._rowIndex,a=n._colIndex;i>=e&&i<e+t&&this.remove(i,a)}for(o=0;o<r.length;o++)e<(n=r[o])._rowIndex&&(n._rowIndex-=t)},e.prototype.onColumnsRemoved=function(e,t){var n,o,r=this._commentList;for(o=r.length-1;o>=0;o--){var i=(n=r[o])._rowIndex,a=n._colIndex;a>=e&&a<e+t&&this.remove(i,a)}for(o=0;o<r.length;o++)e<(n=r[o])._colIndex&&(n._colIndex-=t)},e.prototype.addInternal=function(e,t,n){(this.removeInternal(e,t),n)&&(n._rowIndex=e,n._colIndex=t,this._commentList.push(n),this._sheet._getModel().setValueForKey(e,t,"comment",n),this._sheet._invalidate())},e.prototype.removeInternal=function(e,t){var n=this._sheet,o=this.get(e,t);if(o){var r=this._commentList.findIndex(function(e){return e===o});this._commentList.splice(r,1),n._getModel().setValueForKey(e,t,"comment",void 0)}return o},e}();t.a=r},1460:function(e,t,n){"use strict";var o=function(){function e(e,t){void 0===e&&(e=[]),void 0===t&&(t=!1),this._rowIndex=-1,this._colIndex=-1,this._ps={guid:e,renderBorder:t}}return e.prototype.guid=function(e){return void 0!==e&&(this._ps.guid=e),this._ps.guid},e.prototype.renderBorder=function(e){return void 0!==e&&(this._ps.renderBorder=e),this._ps.renderBorder},e.prototype.isEditing=function(e){return void 0!==e&&(this._isEditing=e),this._isEditing},e}();t.a=o},1461:function(e,t,n){"use strict";var o,r=n(0),i=n.n(r),a=n(3),s=n.n(a),c=n(2),l=(n.n(c),n(528)),u=n(1),m=n.n(u),p=n(593),d=n(1462),f=(n.n(d),n(735)),h=n.n(f),v=n(736),g=(n.n(v),n(166)),b=n.n(g),y=n(147),C=n.n(y),w=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),x=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},_=this&&this.__assign||function(){return(_=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},S=c.sheets.sheet,O=c.sheets.position,E=c.sheets.link,A=c.sheets.utils,k=O.stringifyPosition,j=S.getSheetAttrs,M=A.showAlert,I=E.isCellLinkType,P=E.getLinkValue,R=2,T=50,N=function(e){function t(t){var n=e.call(this,t)||this;return n.update=C()(function(){n.state.show&&n._setCommentList()},300,{leading:!1,trailing:!0}),n.currentPage=1,n.show=function(){n._setCommentList()},n.hide=function(){n.state.show&&(n.currentPage=1,n.setState({show:!1,selectedCommentIndex:-1}))},n.updateSidebarCellContent=function(){if(n.state.show){var e=n.props.editor.spread.getActiveSheet(),t=n.state.commentList.map(function(t){var n=t.row,o=t.col,r=t.sheetId;return e.id===r&&(t.cellContent=e.gcSheet.getValue(n,o)),t});n.setState({commentList:t})}},n._sortCommentList=function(e,t){return e.order===t.order?e.row<t.row?-1:e.row===t.row&&e.col<t.col?-1:1:e.order<t.order?-1:1},n._matchSheetsComments=function(e,t,n,o){var r=e[o.selection_guid];if(r){var i=r.row,a=r.col,s=r.order,c=r.sheetName,l=r.sheetId,u=t.find(function(e){return e.name===c}).gcSheet;if(u.isRangeReadable(i,a,1,1)){var m=n.find(function(e){return e.row===i&&e.col===a&&e.order===s});if(m)m.childCommentList.push(o),m.childCommentList.sort(function(e,t){return e.created_at<t.created_at?-1:1});else{var p=I(u,i,a)?P(u,i,a):u.getText(i,a);n.push({row:i,col:a,order:s,sheetName:c,sheetId:l,cellContent:p,childCommentList:[o]})}}}return n},n._onSidebarScroll=function(){var e=s.a.findDOMNode(n.refs.sidebarContent);e.scrollTop+e.offsetHeight===e.scrollHeight&&n.state.commentList.length<n.allCommentsList.length&&(n.currentPage++,n._setCommentList())},n._setCommentList=function(){n.allCommentsList=n._getAllCommentsList(),n.setState({show:!0,commentList:n.allCommentsList.slice(0,n.currentPage*T)})},n._setActiveComment=function(e,t){var o=t.row,r=t.col,i=t.sheetId,a=n.props.editor.spread.getSheet(i);if(n.setState({selectedCommentIndex:e}),a)return!1===a.sheetVisible?M({title:m()("该评论所在的工作表已被隐藏，可在工作表目录中取消隐藏"),type:"error"}):void n.props.commentModel.locateComment(o,r,a.gcSheet)},n.state={show:!1,commentList:[],selectedCommentIndex:-1},n.allCommentsList=[],n}return w(t,e),t.prototype.componentDidMount=function(){this.props.commentModel.on(p.a.Update,this.update)},t.prototype.componentWillUnmount=function(){this.props.commentModel.off(p.a.Update,this.update)},t.prototype.render=function(){var e=this,t=this.state,n=t.show,o=t.commentList,r=t.selectedCommentIndex,a=o.reduce(function(e,t){return e+t.childCommentList.length},0);return i.a.createElement("div",{className:"comment-sidebar"+(n?"":" hide")},i.a.createElement("div",{className:"f-row f-m-between comment-sidebar-title"},i.a.createElement("span",{className:"bold"},m()("全部评论")," (",a,")"),i.a.createElement("span",{className:"icon-close hicon",onClick:this.hide})),i.a.createElement("div",{className:"comment-sidebar-content",ref:"sidebarContent",onScroll:this._onSidebarScroll},o.length?o.map(function(t,o){return i.a.createElement("div",{key:o,className:"comment-item-wrapper",onClick:function(){return e._setActiveComment(o,t)}},i.a.createElement(L,{item:t,show:n,isSelected:r===o}))}):i.a.createElement("div",{className:"empty-comment-list"},i.a.createElement("div",{className:"title"},m()("無")),i.a.createElement("div",{className:"desc"},m()("暂无单元格评论")))),i.a.createElement("div",{className:"read-all-comments",onClick:function(){return e._readAllComments()}},i.a.createElement("span",{className:o.length?"has-comment":""},m()("标记全部已读"))))},t.prototype._readAllComments=function(){var e=this.props.commentModel;this.state.commentList.length&&(e.markCommentAsRead(e.allComments),M({title:m()("已标记所有评论为已读")}))},t.prototype._getAllCommentsList=function(){var e=this.props.editor.spread.sheets,t=this._getSheetsCommentAttrs(e);return this.props.commentModel.allComments.reduce(this._matchSheetsComments.bind(null,t,e),[]).sort(this._sortCommentList)},t.prototype._getSheetsCommentAttrs=function(e){return e.reduce(function(e,t){var n=j(t.gcSheet,l.a)||{},o={};return Object.keys(n).forEach(function(e){return o[e]=_({order:t.order,sheetName:t.name,sheetId:t.id},n[e])}),Object.assign(e,o)},{})},t}(i.a.Component);function L(e){var t=e.item,n=t.row,a=t.col,s=t.sheetName,c=t.childCommentList,l=t.cellContent,u=c.length,p=c[0],d=c[u-1],f=u-R,h=f>0?[p,{type:"moreCommentToggler"},d]:c,v=Object(r.useState)(h),g=v[0],y=v[1],C=Object(r.useState)(!1),w=C[0],_=C[1];Object(r.useEffect)(function(){e.show||(y(h),_(!1))},[e.show]),Object(r.useEffect)(function(){y(w?c:h)},[e.item]);var S=b()(l)||"string"==typeof l&&!l.trim();return i.a.createElement("div",{className:"sidebar-comment-item"+(e.isSelected?" selected-comment":"")},i.a.createElement("div",{className:"sidebar-comment-item-header"},i.a.createElement("div",{className:"comment-sheet-name"},s.length>8?s.substring(0,8)+"...":s," - ",k(n,a)),i.a.createElement("div",{className:"comment-cell-content "+(S?" empty-cell-content":""),dangerouslySetInnerHTML:{__html:S?m()("空"):l.toString().replace(/\n/g,"<br>")}})),i.a.createElement("div",{className:"sidebar-comment-item-content"},g.map(function(e,t){return i.a.createElement(B,{key:t,comment:e},i.a.createElement("div",{className:"more-comment-toggler",style:{backgroundColor:p.hasRead||d.hasRead?"#fff":"#f0f7ff"},onClick:function(e){y(c),_(!0),e.stopPropagation()}},m()(o||(o=x(["中间还有","条评论"],["中间还有","条评论"])),f)))})))}function B(e){var t=e.comment,n=e.children;if(t.type)return n;var o=t,r=o.User,a=o.created_at,s=o.content,c=o.hasRead,l=r||{},u=l.avatar,m=void 0===u?"":u,p=l.name,d=void 0===p?"":p;return i.a.createElement("div",{className:"child-comment"+(c?"":" un-read")},i.a.createElement("img",{className:"comment-avatar",src:m||h.a}),i.a.createElement("div",{className:"comment-text"},i.a.createElement("span",{className:"comment-time"},Object(v.format)(a)),i.a.createElement("span",{className:"comment-name"},d),i.a.createElement("div",{className:"comment-content",dangerouslySetInnerHTML:{__html:s.replace(/\n/g,"<br>")}})))}t.a=N},1462:function(e,t,n){var o=n(1463);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(25)(o,r);o.locals&&(e.exports=o.locals)},1463:function(e,t,n){(e.exports=n(24)(!1)).push([e.i,".comment-sidebar {\n  box-sizing: border-box;\n  position: fixed;\n  width: 350px;\n  height: calc(100% - 55px);\n  top: 55px;\n  right: 0;\n  padding-top: 20px;\n  z-index: 101;\n  color: #333333;\n  box-shadow: 0 1px 6px #cccccc;\n  background-color: #fafafa;\n  -webkit-font-smoothing: antialiased;\n  font-size: 12px; }\n  .comment-sidebar .comment-sidebar-title {\n    font-size: 16px;\n    font-weight: 600;\n    padding-bottom: 13px;\n    margin: 0 30px;\n    border-bottom: 1px solid #e5e5e5; }\n    .comment-sidebar .comment-sidebar-title .icon-close {\n      cursor: pointer; }\n  .comment-sidebar .comment-sidebar-content {\n    padding: 0 30px;\n    overflow-y: overlay;\n    overflow-x: hidden;\n    height: calc(100% - 86px); }\n    .comment-sidebar .comment-sidebar-content::-webkit-scrollbar {\n      width: 6px;\n      background-color: transparent; }\n    .comment-sidebar .comment-sidebar-content::-webkit-scrollbar-thumb {\n      border-radius: 3px;\n      background-color: #d8d8d8; }\n    .comment-sidebar .comment-sidebar-content .sidebar-comment-item {\n      margin-bottom: 16px;\n      border-radius: 2px;\n      border: solid 1px #dddddd;\n      background-color: #ffffff;\n      cursor: pointer; }\n      .comment-sidebar .comment-sidebar-content .sidebar-comment-item.selected-comment .comment-avatar {\n        opacity: 1 !important; }\n      .comment-sidebar .comment-sidebar-content .sidebar-comment-item.selected-comment .comment-content {\n        color: #333333 !important; }\n      .comment-sidebar .comment-sidebar-content .sidebar-comment-item:first-child {\n        margin-top: 16px; }\n      .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-header {\n        font-size: 12px;\n        background-color: #f7f7f7;\n        color: #8e8f9b;\n        padding: 10px 15px 9px 15px; }\n        .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-header .comment-sheet-name {\n          line-height: 1; }\n        .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-header .comment-cell-content {\n          color: #000000;\n          line-height: 1.5;\n          padding-top: 8px;\n          color: #000;\n          max-height: 36px;\n          overflow: hidden;\n          font-size: 12px;\n          word-break: break-word;\n          position: relative;\n          display: -webkit-box;\n          -webkit-line-clamp: 2;\n          -webkit-box-orient: vertical; }\n          .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-header .comment-cell-content.empty-cell-content {\n            color: #a5a5a5;\n            font-style: italic; }\n      .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content {\n        border-top: 1px solid #dddddd; }\n        .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .more-comment-toggler {\n          font-size: 12px;\n          line-height: 1.5;\n          text-align: justify;\n          color: #6da0e3;\n          cursor: pointer;\n          padding: 5px 54px; }\n        .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment {\n          padding: 10px 15px; }\n          .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment.un-read {\n            background-color: #f0f7ff; }\n            .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment.un-read .comment-content:after,\n            .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment.un-read .comment-time {\n              background-color: #f0f7ff; }\n          .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment:first-child {\n            padding-top: 15px; }\n          .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment:last-child {\n            padding-bottom: 15px; }\n          .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment .comment-name {\n            line-height: 1;\n            font-size: 12px;\n            color: #a2a2a2;\n            width: 120px;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            box-sizing: border-box;\n            display: inline-block;\n            overflow: hidden; }\n          .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment .comment-time {\n            color: #a2a2a2;\n            position: absolute;\n            right: 0;\n            background: #fff; }\n          .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment .comment-avatar {\n            display: inline-block;\n            vertical-align: top;\n            position: relative;\n            width: 30px;\n            height: 30px;\n            border-radius: 50%;\n            top: 2px;\n            opacity: 0.5; }\n          .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment .comment-text {\n            position: relative;\n            display: inline-block;\n            width: calc(100% - 40px);\n            min-height: 30px;\n            margin-left: 10px; }\n          .comment-sidebar .comment-sidebar-content .sidebar-comment-item .sidebar-comment-item-content .child-comment .comment-content {\n            line-height: 1.5;\n            color: #000;\n            padding-top: 4px;\n            max-height: 36px;\n            overflow: hidden;\n            font-size: 12px;\n            word-break: break-word;\n            position: relative;\n            color: #a5a5a5;\n            display: -webkit-box;\n            -webkit-line-clamp: 2;\n            -webkit-box-orient: vertical; }\n    .comment-sidebar .comment-sidebar-content .empty-comment-list {\n      color: #ccc;\n      text-align: center;\n      display: flex;\n      justify-content: center;\n      flex-direction: column;\n      height: 100%; }\n      .comment-sidebar .comment-sidebar-content .empty-comment-list .title {\n        font-size: 50px;\n        color: #ccc;\n        line-height: 100px; }\n      .comment-sidebar .comment-sidebar-content .empty-comment-list .desc {\n        color: #a5a5a5;\n        font-size: 12px; }\n  .comment-sidebar .read-all-comments {\n    border-top: 1px solid #e5e5e5;\n    font-size: 12px;\n    line-height: 1.5;\n    color: #cccccc;\n    margin: 0 30px;\n    position: fixed;\n    width: 290px;\n    bottom: 20px;\n    padding-top: 16px;\n    user-select: none; }\n    .comment-sidebar .read-all-comments span.has-comment {\n      color: #666666;\n      cursor: pointer; }\n      .comment-sidebar .read-all-comments span.has-comment:hover {\n        color: #6da0e3; }\n",""])},1464:function(e,t,n){"use strict";t.a=function(e){return o=e,{component:f}};var o,r=n(0),i=n.n(r),a=n(62),s=n(49),c=n(1),l=n.n(c),u=n(50),m=n(2),p=(n.n(m),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),d=m.sheets.track,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.__startComment=function(){d(2,"18038"),o.startComment()},t}return p(t,e),t.prototype.render=function(){return i.a.createElement(a.a,null,i.a.createElement(s.a,{disabled:this.__isDisabled(),icon:"comment",text:l()("评论"),onClick:this.__startComment}))},t.prototype.__isDisabled=function(){var e=this.props;return e.isEditing||!e.editor.spread||!e.permission.hasSelections||!e.editor.permissions.query.canCommentRange({sheetId:e.editor.spread.getActiveSheet().id,range:e.selection.selectedCell})},t}(u.a)},1465:function(e,t,n){"use strict";var o=n(0),r=n.n(o),i=n(2),a=(n.n(i),n(1)),s=n.n(a),c=n(593),l=n(1466),u=(n.n(l),n(528)),m=n(735),p=n.n(m),d=n(232),f=(n.n(d),this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),h=this&&this.__assign||function(){return(h=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},v=i.sheets.utils,g=v.dateTime,b=v.showAlert,y=v.confirm,C=g.format,w=function(e){function t(t){var n=e.call(this,t)||this;return n.__toggleCommentList=function(e){var t=e.type,o=e.commentList,r=e.comment,i=r?Object(u.c)(o,r.guid()):[],a=n.props.editor.spread.gcSpread.getActiveSheet(),s="hide"!==t&&!a.isEditing()&&!!r;!s&&n.__onClosePanel(),n.setState({showPanel:s,commentList:i,cellComment:r})},n.__updateCommentList=function(e){var t=n.state,o=t.cellComment,r=t.showPanel;if(o&&r){var i=Object(u.c)(e,o.guid());n.setState({commentList:i}),n.props.commentModel.markCommentAsRead(i)}},n.__startComment=function(e){var t=e.cellComment,o=e.commentList,r=Object(u.c)(o,t.guid());n.setState({showPanel:!0,commentList:r,cellComment:t})},n.__closePanel=function(){var e=n.state.isEditing;n.setState({showPanel:e,isEditing:!1}),n.__onClosePanel()},n.__addComment=function(){n.__checkIsOffline("create")||n.setState({isEditing:!0},function(){n.refs.commentInput.focus()})},n.__createComment=function(){if(!n.__checkIsOffline("create")){var e=n.props.editor.spread.gcSpread.getActiveSheet(),t=Object(d.genGuid)(),o=(new Date).toISOString(),r=n.state.cellComment.guid()[0],i={selection_guid:r,selectionGuid:r,comment_guid:t,commentGuid:t,content:n.refs.commentInput.innerText,created_at:o,createdAt:o,selection_title:e.guid()||"",selectionTitle:e.guid()||"",user_id:n.props.currentUser.id,userId:n.props.currentUser.id};n.setState({commentList:n.state.commentList.concat(h(h({},i),{User:n.props.currentUser})),isEditing:!1},function(){var e=n.refs.commentList;e&&(e.scrollTop=e.scrollHeight)}),n.props.commentModel.create({comment:i,user:n.props.currentUser,row:n.state.cellComment._rowIndex,col:n.state.cellComment._colIndex}).catch(function(e){b({title:e.message||s()("新增评论失败，请稍后重试"),type:"error"})})}},n.__closeComments=function(){n.__checkIsOffline("close")||y({title:s()("结束讨论"),description:s()("结束讨论后该讨论将被彻底删除，确定结束吗？"),confirmFun:function(){var e=n.props.editor.spread,t=e&&e.getActiveSheet()||{};n.props.commentModel.close({sheet:t,row:n.state.cellComment._rowIndex,col:n.state.cellComment._colIndex}),n.setState({showPanel:!1})}})},n.__deleteComment=function(e){n.__checkIsOffline("delete")||y({title:s()("删除评论"),description:s()("确认要永久删除该评论吗？"),confirmFun:function(){n.setState({commentList:n.state.commentList.filter(function(t){return t.comment_guid!==e})}),n.props.commentModel.delete(e).catch(function(e){b({title:e.message||s()("删除评论失败，请稍后重试"),type:"error"})})}})},n.state={showPanel:!1,isEditing:!1,commentList:[],cellComment:null,content:""},n}return f(t,e),t.prototype.componentDidMount=function(){this.props.commentModel.on(c.a.Update,this.__updateCommentList),this.props.commentModel.on(c.a.Toggle,this.__toggleCommentList),this.props.commentModel.on(c.a.Start,this.__startComment)},t.prototype.render=function(){var e=this.state,t=e.isEditing,n=e.showPanel;return[t&&r.a.createElement("div",{className:"m-comment-mask",key:"mask"}),r.a.createElement("div",{key:"panel",className:"m-comment-panel"+(n?"":" m-comment-panel-hide")+(t?" m-comment-panel-top":"")},this.CommentHeader,!t&&this.CommentFakeInput,t&&this.CommentInput,this.CommentList)]},Object.defineProperty(t.prototype,"CommentHeader",{get:function(){var e=this.state,t=e.isEditing,n=e.commentList.length;return r.a.createElement("div",{className:"m-comment-header"},!t&&n?r.a.createElement("span",{className:"m-close-comment",onClick:this.__closeComments},s()("结束讨论")):null,r.a.createElement("span",{className:"m-comment-title"},s()("评论"),n?" ("+n+")":""),r.a.createElement("span",{className:"m-close-panel",onClick:this.__closePanel},t?s()("取消"):s()("完成")))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CommentInput",{get:function(){var e=this,t=this.state.content;return r.a.createElement("div",{className:"m-comment-input-wrapper"},r.a.createElement("div",{className:"m-comment-input",onInput:function(t){var n=t.target.innerText;e.setState({content:n.trim()})},ref:"commentInput",contentEditable:"true"}),r.a.createElement("div",{className:"m-comment-send"+(t.length?"":" m-comment-send-disabled"),onClick:this.__createComment},s()("发送")))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CommentFakeInput",{get:function(){return r.a.createElement("div",{className:"m-comment-fake-input-wrapper"},r.a.createElement("div",{className:"m-comment-fake-input",onClick:this.__addComment},s()("添加评论...")))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CommentList",{get:function(){var e=this,t=this.state,n=t.isEditing,o=t.commentList,i=this.props,a=i.currentUser,c=i.defaultAnonymousUser;return r.a.createElement("div",{ref:"commentList",className:"m-comment-list"+(n?" hide":"")},o.length?o.map(function(t,n){return r.a.createElement(x,{key:n,comment:t,currentUser:a,defaultAnonymousUser:c,deleteComment:e.__deleteComment})}):r.a.createElement("div",{className:"m-no-comment"},r.a.createElement("span",{className:"m-no-comment-icon"}),r.a.createElement("span",{className:"m-no-comment-tip"},s()("留下你的第一句评论吧"))))},enumerable:!0,configurable:!0}),t.prototype.__onClosePanel=function(){var e=this.state,t=e.cellComment,n=e.commentList;if(t&&!n.length){var o=t._rowIndex,r=t._colIndex,i=this.props.editor.spread.gcSpread.getActiveSheet();i.comments.remove(o,r),i.repaint()}},t.prototype.__checkIsOffline=function(e){var t=this.props.commentModel.checkOffline(e);return!(!t||"success"===t.type)&&(b({title:t.message,type:"error"}),!0)},t}(r.a.Component);function x(e){var t=e.comment,n=e.currentUser,o=t.content,i=t.created_at,a=t.isSending,c=t.User||e.defaultAnonymousUser,l=c.avatar,u=c.name,m=c.id===n.id;return r.a.createElement("div",{className:"m-comment-item"},r.a.createElement("img",{className:"m-comment-avatar",src:l||p.a}),r.a.createElement("div",{className:"m-comment-center"},r.a.createElement("div",null,r.a.createElement("span",{className:"m-comment-username"},u),r.a.createElement("span",{className:"m-comment-time"},C(i))),r.a.createElement("div",{className:"m-comment-content",dangerouslySetInnerHTML:{__html:o.replace(/\n/g,"<br>")}})),a?r.a.createElement("div",{className:"sm-sheet-loading-rotate m-comment-sending"}):m?r.a.createElement("div",{className:"m-comment-delete",onClick:function(){return e.deleteComment(t.comment_guid)}},s()("删除")):null)}t.a=w},1466:function(e,t,n){var o=n(1467);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(25)(o,r);o.locals&&(e.exports=o.locals)},1467:function(e,t,n){var o=n(71);(e.exports=n(24)(!1)).push([e.i,".m-comment-mask {\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  background: #ffffff;\n  top: 0; }\n\n.m-comment-panel {\n  box-shadow: 0 0 10px 0 rgba(65, 70, 75, 0.25);\n  background-color: #ffffff;\n  position: fixed;\n  width: 100%;\n  height: 310px;\n  bottom: 0;\n  transition: transform 0.3s ease; }\n  .m-comment-panel.m-comment-panel-hide {\n    transform: translateY(320px); }\n  .m-comment-panel.m-comment-panel-top {\n    top: 0;\n    transform: translateY(0);\n    box-shadow: none; }\n  .m-comment-panel .m-comment-header {\n    font-size: 15px;\n    text-align: center;\n    margin-top: 12px; }\n    .m-comment-panel .m-comment-header .m-comment-title {\n      color: #41464b;\n      font-weight: 600; }\n    .m-comment-panel .m-comment-header .m-close-comment,\n    .m-comment-panel .m-comment-header .m-close-panel {\n      position: absolute;\n      padding: 0 10px; }\n    .m-comment-panel .m-comment-header .m-close-comment {\n      left: 10px;\n      color: #cd4747; }\n    .m-comment-panel .m-comment-header .m-close-panel {\n      right: 10px;\n      color: #6da0e3; }\n  .m-comment-panel .m-comment-fake-input-wrapper {\n    padding: 0 20px;\n    margin-top: 20px; }\n    .m-comment-panel .m-comment-fake-input-wrapper .m-comment-fake-input {\n      height: 40px;\n      border-radius: 2px;\n      border: solid 1px #e5e5e5;\n      background-color: #fafafa;\n      color: #a5a5a5;\n      font-size: 14px;\n      display: flex;\n      align-items: center;\n      line-height: normal;\n      padding-left: 15px; }\n  .m-comment-panel .m-comment-list {\n    padding: 0 20px;\n    height: 219px;\n    overflow-y: auto;\n    -webkit-overflow-scrolling: touch; }\n    .m-comment-panel .m-comment-list .m-comment-item {\n      display: flex;\n      margin-top: 20px; }\n      .m-comment-panel .m-comment-list .m-comment-item:last-child {\n        margin-bottom: 20px; }\n      .m-comment-panel .m-comment-list .m-comment-item .m-comment-avatar {\n        width: 30px;\n        height: 30px;\n        border-radius: 50px;\n        margin-top: 5px; }\n      .m-comment-panel .m-comment-list .m-comment-item .m-comment-center {\n        width: calc(100% - 82px);\n        padding-left: 12px; }\n        .m-comment-panel .m-comment-list .m-comment-item .m-comment-center .m-comment-username {\n          font-size: 15px;\n          font-weight: 600;\n          color: #c6c7c9; }\n        .m-comment-panel .m-comment-list .m-comment-item .m-comment-center .m-comment-time {\n          font-size: 13px;\n          color: #c6c7c9;\n          padding-left: 8px; }\n        .m-comment-panel .m-comment-list .m-comment-item .m-comment-center .m-comment-content {\n          color: #41464b;\n          font-size: 15px;\n          margin-top: 5px;\n          word-break: break-all; }\n      .m-comment-panel .m-comment-list .m-comment-item .m-comment-delete {\n        color: #cd4747;\n        font-size: 15px;\n        flex: 1;\n        display: flex;\n        justify-content: flex-end; }\n      .m-comment-panel .m-comment-list .m-comment-item .m-comment-sending {\n        width: 14px;\n        height: 14px; }\n    .m-comment-panel .m-comment-list .m-no-comment {\n      height: 100%;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      flex-direction: column; }\n      .m-comment-panel .m-comment-list .m-no-comment .m-no-comment-icon {\n        width: 20px;\n        height: 20px;\n        background: url("+o(n(1468))+") center no-repeat;\n        background-size: contain; }\n      .m-comment-panel .m-comment-list .m-no-comment .m-no-comment-tip {\n        color: #c6c7c9;\n        font-size: 12px;\n        padding-top: 6px; }\n  .m-comment-panel .m-comment-input-wrapper {\n    padding: 20px; }\n    .m-comment-panel .m-comment-input-wrapper .m-comment-input {\n      border-radius: 2px;\n      border: solid 1px #cccccc !important;\n      background-color: #fafafa;\n      height: 180px;\n      padding: 10px 15px;\n      color: #41464b;\n      outline: none; }\n    .m-comment-panel .m-comment-input-wrapper .m-comment-send {\n      position: absolute;\n      color: #6da0e3;\n      font-size: 15px;\n      right: 30px;\n      transform: translateY(-30px); }\n      .m-comment-panel .m-comment-input-wrapper .m-comment-send.m-comment-send-disabled {\n        opacity: 0.4;\n        pointer-events: none; }\n",""])},1468:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj4KICAgIDxnIGZpbGw9IiNDNkM3QzkiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTM0LjExMyAxMC4wNzFMMTUuNzI4IDI4LjQ1NmwtOS4xOTIgMi4xMjEgMi4xMi05LjE5MkwyNy4wNDMgM2w3LjA3IDcuMDcxem0tNy4wNzEgNC4yNDNsLTQuMjQzLTQuMjQzTDEwLjA3MSAyMi44bC0xLjI0IDUuNDcgNS40ODMtMS4yMjcgMTIuNzI4LTEyLjcyOHptNC4yNDItNC4yNDNsLTQuMjQyLTQuMjQzLTIuODI5IDIuODI5IDQuMjQzIDQuMjQyIDIuODI4LTIuODI4ek01IDMzaDMydjJINXoiLz4KICAgIDwvZz4KPC9zdmc+Cg=="},147:function(e,t,n){var o=n(6),r=n(180),i=n(61),a="Expected a function",s=Math.max,c=Math.min;e.exports=function(e,t,n){var l,u,m,p,d,f=0,h=0,v=!1,g=!1,b=!0;if("function"!=typeof e)throw new TypeError(a);function y(t){var n=l,o=u;return l=u=void 0,h=t,p=e.apply(o,n)}function C(e){var n=e-f;return!f||n>=t||n<0||g&&e-h>=m}function w(){var e=r();if(C(e))return x(e);d=setTimeout(w,function(e){var n=t-(e-f);return g?c(n,m-(e-h)):n}(e))}function x(e){return clearTimeout(d),d=void 0,b&&l?y(e):(l=u=void 0,p)}function _(){var e=r(),n=C(e);if(l=arguments,u=this,f=e,n){if(void 0===d)return function(e){return h=e,d=setTimeout(w,t),v?y(e):p}(f);if(g)return clearTimeout(d),d=setTimeout(w,t),y(f)}return void 0===d&&(d=setTimeout(w,t)),p}return t=i(t)||0,o(n)&&(v=!!n.leading,m=(g="maxWait"in n)?s(i(n.maxWait)||0,t):m,b="trailing"in n?!!n.trailing:b),_.cancel=function(){void 0!==d&&clearTimeout(d),f=h=0,l=u=d=void 0},_.flush=function(){return void 0===d?p:x(r())},_}},148:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isRetina=function(){return window.devicePixelRatio>=2},t.isDingTalk=function(){return/dingtalk/i.test(n)},t.isDingtalk=function(){return!!n.match(/mobile.*dingtalk/i)},t.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},t.isWechatPc=o,t.isWxworkPc=r,t.isWechat=function(){return!!/micromessenger/.test(n)&&!o()},t.isMobile=function(){return!o()&&!r()&&!!n.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},t.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},t.isIOS=i,t.isAndroid=function(){return!!/(android)/g.test(n)},t.isAndroidApp=function(){return!!/shimo-android-app/g.test(n)},t.isIE=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},t.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},t.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},t.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},t.isWebIOS=function(){if(!window.cow.iOS&&i())return!0;return!1},t.isIphone6=function(){var e=!1;i()&&screen.height>568&&(e=!0);return e},t.isInWxMp=function(){return!(!navigator.userAgent.match(/micromessenger/i)||!navigator.userAgent.match(/miniprogram/i))||"miniprogram"===window.__wxjs_environment};var n=window.navigator.userAgent.toLowerCase();function o(){return!!/micromessenger.*?windowswechat/.test(n)}function r(){return!!/wxwork.*?micromessenger.*?wechat/i.test(n)}function i(){return!!/(ipad|iphone|ipod)/g.test(n)}},15:function(e,t,n){var o=n(8)(Object,"create");e.exports=o},151:function(e,t,n){var o=n(238),r=n(244),i=n(194),a=n(5),s=n(250);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?a(e)?r(e[0],e[1]):o(e):s(e)}},156:function(e,t,n){var o=n(157),r=n(70),i=n(30);e.exports=function(e,t){for(var n=0,a=(t=r(t,e)?[t]:o(t)).length;null!=e&&n<a;)e=e[i(t[n++])];return n&&n==a?e:void 0}},157:function(e,t,n){var o=n(5),r=n(245);e.exports=function(e){return o(e)?e:r(e)}},159:function(e,t){e.exports=function(e,t){for(var n=-1,o=e.length;++n<o&&!1!==t(e[n],n,e););return e}},16:function(e,t,n){var o=n(111);e.exports=function(e,t){var n=e.__data__;return o(t)?n["string"==typeof t?"string":"hash"]:n.map}},161:function(e,t,n){var o=n(66);e.exports=function(e,t){return o(e,t)}},162:function(e,t,n){var o=n(74),r=n(141),i=n(172),a=n(78),s=n(30),c=a(function(e,t){return null==e?{}:i(e,o(r(t,1),s))});e.exports=c},163:function(e,t,n){var o=n(6);e.exports=function(e){return e==e&&!o(e)}},164:function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},166:function(e,t){e.exports=function(e){return null==e}},17:function(e,t,n){var o=n(73),r=n(19),i=n(20);e.exports=function(e){return null!=e&&i(o(e))&&!r(e)}},171:function(e,t,n){var o=n(29),r=n(5);e.exports=function(e){return r(e)||o(e)}},172:function(e,t,n){var o=n(65);e.exports=function(e,t){return e=Object(e),o(t,function(t,n){return n in e&&(t[n]=e[n]),t},{})}},18:function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var r=n(37);t.isValidLocaleResource=function(e){return!!e&&(!Array.isArray(e)&&("object"===(void 0===e?"undefined":o(e))&&Object.keys(e).every(function(t){var n=e[t];return null==n||"string"==typeof n||"object"===(void 0===n?"undefined":o(n))})))},t.sourceTextToKey=function(e){switch(e.type){case"string":var t=e.id,n=e.text;return t?n+"#"+t:n;case"interpolated":var o=e.textParts.length;return 1===o?e.textParts[0]:2===o?e.textParts[0]+"%s"+e.textParts[1]:e.textParts.map(function(t,n){return n===e.textParts.length-1?t:t+"%"+(n+1)}).join("");default:return r.assertNever(e)}}},180:function(e,t){var n=Date.now;e.exports=n},19:function(e,t,n){var o=n(6),r="[object Function]",i="[object GeneratorFunction]",a=Object.prototype.toString;e.exports=function(e){var t=o(e)?a.call(e):"";return t==r||t==i}},192:function(e,t,n){var o=n(193);e.exports=function(e){return null==e?"":o(e)}},193:function(e,t,n){var o=n(47),r=n(22),i=1/0,a=o?o.prototype:void 0,s=a?a.toString:void 0;e.exports=function(e){if("string"==typeof e)return e;if(r(e))return s?s.call(e):"";var t=e+"";return"0"==t&&1/e==-i?"-0":t}},194:function(e,t){e.exports=function(e){return e}},2:function(e,t){e.exports=shimo.sdk.sheet},20:function(e,t){var n=9007199254740991;e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}},21:function(e,t,n){var o;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function r(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var i=typeof o;if("string"===i||"number"===i)e.push(o);else if(Array.isArray(o)&&o.length){var a=r.apply(null,o);a&&e.push(a)}else if("object"===i)for(var s in o)n.call(o,s)&&o[s]&&e.push(s)}}return e.join(" ")}void 0!==e&&e.exports?(r.default=r,e.exports=r):void 0===(o=function(){return r}.apply(t,[]))||(e.exports=o)}()},214:function(e,t,n){var o=n(296),r=n(297)(o);e.exports=r},22:function(e,t,n){var o=n(10),r="[object Symbol]",i=Object.prototype.toString;e.exports=function(e){return"symbol"==typeof e||o(e)&&i.call(e)==r}},232:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.genGuid=function(e){var t=17,n=e?e+"-":"";for(;t-=1;)n+=r[parseInt(62*Math.random())];return n},t.nodeText=function(e){return e.innerText||e.textContent||e.nodeValue||""},t.getCookie=function(e){var t=("; "+document.cookie).split("; "+e+"=");if(2===t.length)return t.pop().split(";").shift()},t.isNumeric=i,t.getFractionLen=function(e){var t=String(e),n=0;!isNaN(Number(e))&&t.indexOf(".")>-1&&(n=t.split(".")[1].length);return n},t.isBigNumber=function(e){if(i(e)&&e.toString().trim().split(".")[0].length>15)return!0;return!1},t.isValidNumber=function(e){if(i(e)&&e.toString().length<=16)return!0;return!1},t.strToNum=function(e){if(i(e)&&e.toString().length<=16)return Number(e,10);return e},t.translateNumber=function(e){var t,n,r,i,a,s,c,l,u,m,p,d,f,h;if(i=(0,o.default)("零"),t=["",(0,o.default)("一"),(0,o.default)("二"),(0,o.default)("三"),(0,o.default)("四"),(0,o.default)("五"),(0,o.default)("六"),(0,o.default)("七"),(0,o.default)("八"),(0,o.default)("九")],r=["",(0,o.default)("十"),(0,o.default)("百"),(0,o.default)("千")],n=["",(0,o.default)("万"),(0,o.default)("亿"),(0,o.default)("兆")],""===e)return"";if(""===(e=e.replace(/^0+/g,"")))return i;for(f="",c=!0,m=!1,l=u=0,d=e.length;d>=0?u<d:u>d;l=d>=0?++u:--u)p=e.length-1-l,a=parseInt(e[l]),s=(p-(h=p%r.length))/r.length,0!==a&&(m&&(f+=i),(1!==a||1!==h||!c||0===s&&m)&&(f+=t[a]),f+=r[h]),c=c&&0===a,0!==h||c||(f+=n[s]),m=0===a&&(0!==h||c),0===h&&(c=!0);return f};var o=function(e){return e&&e.__esModule?e:{default:e}}(n(1));var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function i(e){var t=e&&e.toString();return!/^0+\d+$/.test(t)&&t-parseFloat(t)+1>=0}},234:function(e,t,n){var o=n(241)(n(12));e.exports=o},235:function(e,t,n){var o=n(156);e.exports=function(e,t,n){var r=null==e?void 0:o(e,t);return void 0===r?n:r}},236:function(e,t,n){var o=n(64),r=n(77),i=n(258),a=n(17),s=n(36),c=n(12),l=Object.prototype,u=l.hasOwnProperty,m=!l.propertyIsEnumerable.call({valueOf:1},"valueOf"),p=i(function(e,t){if(m||s(t)||a(t))r(t,c(t),e);else for(var n in t)u.call(t,n)&&o(e,n,t[n])});e.exports=p},238:function(e,t,n){var o=n(239),r=n(240),i=n(164);e.exports=function(e){var t=r(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(n){return n===e||o(n,e,t)}}},239:function(e,t,n){var o=n(46),r=n(66),i=1,a=2;e.exports=function(e,t,n,s){var c=n.length,l=c,u=!s;if(null==e)return!l;for(e=Object(e);c--;){var m=n[c];if(u&&m[2]?m[1]!==e[m[0]]:!(m[0]in e))return!1}for(;++c<l;){var p=(m=n[c])[0],d=e[p],f=m[1];if(u&&m[2]){if(void 0===d&&!(p in e))return!1}else{var h=new o;if(s)var v=s(d,f,p,e,t,h);if(!(void 0===v?r(f,d,s,i|a,h):v))return!1}}return!0}},24:function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var r=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(o),i=o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"});return[n].concat(i).concat([r]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},r=0;r<this.length;r++){var i=this[r][0];"number"==typeof i&&(o[i]=!0)}for(r=0;r<e.length;r++){var a=e[r];"number"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},240:function(e,t,n){var o=n(163),r=n(234);e.exports=function(e){for(var t=r(e),n=t.length;n--;)t[n][2]=o(t[n][1]);return t}},241:function(e,t,n){var o=n(242),r=n(42),i=n(48),a=n(243),s="[object Map]",c="[object Set]";e.exports=function(e){return function(t){var n=r(t);return n==s?i(t):n==c?a(t):o(t,e(t))}}},242:function(e,t,n){var o=n(74);e.exports=function(e,t){return o(t,function(t){return[t,e[t]]})}},243:function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}},244:function(e,t,n){var o=n(66),r=n(235),i=n(247),a=n(70),s=n(163),c=n(164),l=n(30),u=1,m=2;e.exports=function(e,t){return a(e)&&s(t)?c(l(e),t):function(n){var a=r(n,e);return void 0===a&&a===t?i(n,e):o(t,a,void 0,u|m)}}},245:function(e,t,n){var o=n(246),r=n(192),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,a=/\\(\\)?/g,s=o(function(e){var t=[];return r(e).replace(i,function(e,n,o,r){t.push(o?r.replace(a,"$1"):n||e)}),t});e.exports=s},246:function(e,t,n){var o=n(31),r="Expected a function";function i(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(r);var n=function(){var o=arguments,r=t?t.apply(this,o):o[0],i=n.cache;if(i.has(r))return i.get(r);var a=e.apply(this,o);return n.cache=i.set(r,a),a};return n.cache=new(i.Cache||o),n}i.Cache=o,e.exports=i},247:function(e,t,n){var o=n(248),r=n(249);e.exports=function(e,t){return null!=e&&r(e,t,o)}},248:function(e,t){e.exports=function(e,t){return t in Object(e)}},249:function(e,t,n){var o=n(157),r=n(29),i=n(5),a=n(34),s=n(70),c=n(20),l=n(44),u=n(30);e.exports=function(e,t,n){for(var m,p=-1,d=(t=s(t,e)?[t]:o(t)).length;++p<d;){var f=u(t[p]);if(!(m=null!=e&&n(e,f)))break;e=e[f]}return m||!!(d=e?e.length:0)&&c(d)&&a(f,d)&&(i(e)||l(e)||r(e))}},25:function(e,t,n){var o={},r=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),i=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),a=null,s=0,c=[],l=n(90);function u(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=o[r.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](r.parts[a]);for(;a<r.parts.length;a++)i.parts.push(v(r.parts[a],t))}else{var s=[];for(a=0;a<r.parts.length;a++)s.push(v(r.parts[a],t));o[r.id]={id:r.id,refs:1,parts:s}}}}function m(e,t){for(var n=[],o={},r=0;r<e.length;r++){var i=e[r],a=t.base?i[0]+t.base:i[0],s={css:i[1],media:i[2],sourceMap:i[3]};o[a]?o[a].parts.push(s):n.push(o[a]={id:a,parts:[s]})}return n}function p(e,t){var n=i(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var o=c[c.length-1];if("top"===e.insertAt)o?o.nextSibling?n.insertBefore(t,o.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),c.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var r=i(e.insertInto+" "+e.insertAt.before);n.insertBefore(t,r)}}function d(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function f(e){var t=document.createElement("style");return e.attrs.type="text/css",h(t,e.attrs),p(e,t),t}function h(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function v(e,t){var n,o,r,i;if(t.transform&&e.css){if(!(i=t.transform(e.css)))return function(){};e.css=i}if(t.singleton){var c=s++;n=a||(a=f(t)),o=b.bind(null,n,c,!1),r=b.bind(null,n,c,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",h(t,e.attrs),p(e,t),t}(t),o=function(e,t,n){var o=n.css,r=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||i)&&(o=l(o));r&&(o+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([o],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(a),s&&URL.revokeObjectURL(s)}.bind(null,n,t),r=function(){d(n),n.href&&URL.revokeObjectURL(n.href)}):(n=f(t),o=function(e,t){var n=t.css,o=t.media;o&&e.setAttribute("media",o);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),r=function(){d(n)});return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=r()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=m(e,t);return u(n,t),function(e){for(var r=[],i=0;i<n.length;i++){var a=n[i];(s=o[a.id]).refs--,r.push(s)}e&&u(m(e,t),t);for(i=0;i<r.length;i++){var s;if(0===(s=r[i]).refs){for(var c=0;c<s.parts.length;c++)s.parts[c]();delete o[s.id]}}}};var g=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function b(e,t,n,o){var r=n?"":o.css;if(e.styleSheet)e.styleSheet.cssText=g(t,r);else{var i=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}},250:function(e,t,n){var o=n(55),r=n(251),i=n(70),a=n(30);e.exports=function(e){return i(e)?o(a(e)):r(e)}},251:function(e,t,n){var o=n(156);e.exports=function(e){return function(t){return o(t,e)}}},252:function(e,t,n){var o=n(273)();e.exports=o},258:function(e,t,n){var o=n(259),r=n(78);e.exports=function(e){return r(function(t,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(n[0],n[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++r<i;){var c=n[r];c&&e(t,c,r,a)}return t})}},259:function(e,t,n){var o=n(33),r=n(17),i=n(34),a=n(6);e.exports=function(e,t,n){if(!a(n))return!1;var s=typeof t;return!!("number"==s?r(n)&&i(t,n.length):"string"==s&&t in n)&&o(n[t],e)}},26:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},266:function(e,t,n){"use strict";var o=Object.prototype.hasOwnProperty,r="~";function i(){}function a(e,t,n,o,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var a=new function(e,t,n){this.fn=e,this.context=t,this.once=n||!1}(n,o||e,i),s=r?r+t:t;return e._events[s]?e._events[s].fn?e._events[s]=[e._events[s],a]:e._events[s].push(a):(e._events[s]=a,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function c(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(r=!1)),c.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)o.call(e,t)&&n.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},c.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var o=0,i=n.length,a=new Array(i);o<i;o++)a[o]=n[o].fn;return a},c.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},c.prototype.emit=function(e,t,n,o,i,a){var s=r?r+e:e;if(!this._events[s])return!1;var c,l,u=this._events[s],m=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),m){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,o),!0;case 5:return u.fn.call(u.context,t,n,o,i),!0;case 6:return u.fn.call(u.context,t,n,o,i,a),!0}for(l=1,c=new Array(m-1);l<m;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var p,d=u.length;for(l=0;l<d;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),m){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,n);break;case 4:u[l].fn.call(u[l].context,t,n,o);break;default:if(!c)for(p=1,c=new Array(m-1);p<m;p++)c[p-1]=arguments[p];u[l].fn.apply(u[l].context,c)}}return!0},c.prototype.on=function(e,t,n){return a(this,e,t,n,!1)},c.prototype.once=function(e,t,n){return a(this,e,t,n,!0)},c.prototype.removeListener=function(e,t,n,o){var i=r?r+e:e;if(!this._events[i])return this;if(!t)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==t||o&&!a.once||n&&a.context!==n||s(this,i);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==t||o&&!a[c].once||n&&a[c].context!==n)&&l.push(a[c]);l.length?this._events[i]=1===l.length?l[0]:l:s(this,i)}return this},c.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c},27:function(e,t,n){"use strict";var o=n(0),r=n.n(o),i=n(3),a=n.n(i),s=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),c=function(e){function t(t){var n=e.call(this,t)||this;return n.direction="right",n.align="bottom",n.adjustStyle=function(){var e=n.props.className,t=window.innerHeight,o=window.innerWidth,r=n.refs.contentDom,i=r.getBoundingClientRect().width,a=n.props.itemDom.getBoundingClientRect(),s=a.bottom,c=a.left,l=a.right,u=a.top,m=document.querySelector(".tab-help").getBoundingClientRect().left,p=!!document.querySelector(".tab-help.menu__open"),d=e&&e.indexOf("tooltip")>-1,f={position:"fixed",left:p&&!d&&c<m?l-(l-c)/2:l,top:u,zIndex:1e3,overflowY:"auto"};d&&delete f.overflowY;var h=s-78,v=t-s-30,g=r.scrollHeight;g>v&&(g<h||v/t<.25?(f.maxHeight=h,f.top=s-Math.min(g,h),n.align="top"):f.maxHeight=v),o-l-i<50&&(f.left=c-i,n.direction="left"),n.setState({style:f})},n.state={style:null},n}return s(t,e),t.prototype.componentDidUpdate=function(e,t){this.props.showPopup&&!e.showPopup&&this.adjustStyle()},t.prototype.render=function(){var e=this.props,t=e.showPopup,n=e.className,o="menu--content menu--content__submenu";return n&&(o+=" "+n),o+="right"===this.direction?" submenu--right":" submenu--left",o+="bottom"===this.align?" submenu--bottom":" submenu--top",t?a.a.createPortal(r.a.createElement("div",{ref:"contentDom",className:o,style:this.state.style},this.props.children),document.getElementsByClassName("tabStrip")[0]):null},t}(r.a.Component);t.a=c},273:function(e,t){e.exports=function(e){return function(t,n,o){for(var r=-1,i=Object(t),a=o(t),s=a.length;s--;){var c=a[e?s:++r];if(!1===n(i[c],c,i))break}return t}}},28:function(e,t){e.exports=function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}},29:function(e,t,n){var o=n(63),r="[object Arguments]",i=Object.prototype,a=i.hasOwnProperty,s=i.toString,c=i.propertyIsEnumerable;e.exports=function(e){return o(e)&&a.call(e,"callee")&&(!c.call(e,"callee")||s.call(e)==r)}},296:function(e,t,n){var o=n(252),r=n(12);e.exports=function(e,t){return e&&o(e,t,r)}},297:function(e,t,n){var o=n(17);e.exports=function(e,t){return function(n,r){if(null==n)return n;if(!o(n))return e(n,r);for(var i=n.length,a=t?i:-1,s=Object(n);(t?a--:++a<i)&&!1!==r(s[a],a,s););return n}}},3:function(e,t){e.exports=ReactDOM},30:function(e,t,n){var o=n(22),r=1/0;e.exports=function(e){if("string"==typeof e||o(e))return e;var t=e+"";return"0"==t&&1/e==-r?"-0":t}},31:function(e,t,n){var o=n(103),r=n(110),i=n(112),a=n(113),s=n(114);function c(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}c.prototype.clear=o,c.prototype.delete=r,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,e.exports=c},32:function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},33:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},34:function(e,t){var n=9007199254740991,o=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||o.test(e))&&e>-1&&e%1==0&&e<t}},35:function(e,t,n){"use strict";var o=n(132),r=n(133),i=n(134),a=n(135),s=n(136),c=n(137),l=n(60);n(27);n.d(t,"h",function(){return o.a}),n.d(t,"a",function(){return r.a}),n.d(t,"g",function(){return i.a}),n.d(t,"e",function(){return a.a}),n.d(t,"d",function(){return s.a}),n.d(t,"b",function(){return c.a}),n.d(t,"k",function(){return l.a});var u=n(138);n.d(t,"j",function(){return u.d}),n.d(t,"i",function(){return u.c}),n.d(t,"f",function(){return u.b}),n.d(t,"l",function(){return u.e}),n.d(t,"c",function(){return u.a})},36:function(e,t){var n=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||n)}},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertNever=function(e){throw new Error("unexpected type: "+JSON.stringify(e))}},370:function(e,t,n){var o=n(159),r=n(214),i=n(151),a=n(5);e.exports=function(e,t){return(a(e)?o:r)(e,i(t,3))}},38:function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var r=n(18);t.interweave=function(e,t){return e.map(function(n,o){return o===e.length-1?n:""+n+t[o]}).join("")},t.getTextResult=function(e,t){return t&&t[e]};var i=/%(s|\d)/g;t.getInterpolateResult=function(e,t,n){try{if(!n)return;var a=r.sourceTextToKey({type:"interpolated",textParts:e}),s=n[a];if(!s)return;var c={},l=0;a.replace(i,function(e){return c[e]=t[l],l+=1,e});return"string"==typeof s?function(e,t){return e.replace(i,function(n){return null!==t[n]?String(t[n]):(console.warn("[s18n] interpolation failed:",{str:e,valueMap:t}),n)})}(s,c):"object"===(void 0===s?"undefined":o(s))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(s))}catch(o){var u={parts:e,values:t,resource:n};return console.error("[s18n] error when translating: ",u),void console.error(o)}}},383:function(e,t){e.exports=function(e){return function(t){return e(t)}}},39:function(e,t){var n=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return n.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},4:function(e,t,n){(function(e,o){var r=n(86),i={function:!0,object:!0},a=i[typeof t]&&t&&!t.nodeType?t:void 0,s=i[typeof e]&&e&&!e.nodeType?e:void 0,c=r(a&&s&&"object"==typeof o&&o),l=r(i[typeof self]&&self),u=r(i[typeof window]&&window),m=r(i[typeof this]&&this),p=c||u!==(m&&m.window)&&u||l||m||Function("return this")();e.exports=p}).call(t,n(32)(e),n(26))},40:function(e,t,n){var o=n(8)(n(4),"Map");e.exports=o},41:function(e,t,n){var o=n(54),r=Object.prototype.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)||"object"==typeof e&&t in e&&null===o(e)}},42:function(e,t,n){var o=n(87),r=n(40),i=n(88),a=n(69),s=n(89),c=n(39),l=Object.prototype.toString,u=c(o),m=c(r),p=c(i),d=c(a),f=c(s);function h(e){return l.call(e)}(o&&"[object DataView]"!=h(new o(new ArrayBuffer(1)))||r&&"[object Map]"!=h(new r)||i&&"[object Promise]"!=h(i.resolve())||a&&"[object Set]"!=h(new a)||s&&"[object WeakMap]"!=h(new s))&&(h=function(e){var t=l.call(e),n="[object Object]"==t?e.constructor:void 0,o=n?c(n):void 0;if(o)switch(o){case u:return"[object DataView]";case m:return"[object Map]";case p:return"[object Promise]";case d:return"[object Set]";case f:return"[object WeakMap]"}return t}),e.exports=h},43:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return a}),n.d(t,"c",function(){return s});var o,r=n(1),i=n.n(r);!function(e){e.edit="edit",e.insert="insert",e.format="format",e.data="data",e.view="view",e.form="form",e.plugins="plugins",e.help="help",e.formula="formula"}(o||(o={}));var a={edit:i()("编辑"),insert:i()("插入"),format:i()("格式"),data:i()("数据"),view:i()("视图"),form:i()("表单"),plugins:i()("插件"),help:i()("帮助")},s={form:2,plugins:1,help:-1}},44:function(e,t,n){var o=n(5),r=n(10),i="[object String]",a=Object.prototype.toString;e.exports=function(e){return"string"==typeof e||!o(e)&&r(e)&&a.call(e)==i}},45:function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}},46:function(e,t,n){var o=n(13),r=n(98),i=n(99),a=n(100),s=n(101),c=n(102);function l(e){this.__data__=new o(e)}l.prototype.clear=r,l.prototype.delete=i,l.prototype.get=a,l.prototype.has=s,l.prototype.set=c,e.exports=l},47:function(e,t,n){var o=n(4).Symbol;e.exports=o},48:function(e,t){e.exports=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,o){n[++t]=[o,e]}),n}},49:function(e,t,n){"use strict";var o=n(0),r=n.n(o),i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.__onClick=function(e){t.props.onClick&&t.props.onClick(e)},t}return i(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.icon,o=t.text;return r.a.createElement("span",{onClick:function(t){return e.__onClick(t)},key:"icon",className:this.__getClassName()},n&&r.a.createElement("i",{className:"icon-"+n}),o&&r.a.createElement("span",null,o))},t.prototype.__getClassName=function(){var e=this.props,t=e.icon,n=e.text,o=e.selected,r=e.disabled,i=e.hasTapBtn;return(n&&t?"m-icon-text-button":n?"m-text-button":"m-icon-button")+(o?" m-menu-selected":"")+(r?" m-menu-disabled":"")+(i?" m-menu-btn":"")},t}(r.a.Component);t.a=a},5:function(e,t){var n=Array.isArray;e.exports=n},50:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var o=n(0),r=n.n(o),i=n(161),a=n.n(i),s=n(162),c=n.n(s),l=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.selectionUpdateKeys=!1,t.permissionUpdateKeys=["canEditRange"],t.reRender=function(){t.forceUpdate()},t}return l(t,e),t.prototype.shouldComponentUpdate=function(e,t){return t!==this.state||(!0===this.selectionUpdateKeys||(!1!==this.selectionUpdateKeys&&!a()(c()(e.selection,this.selectionUpdateKeys),c()(this.props.selection,this.selectionUpdateKeys))||(!a()(c()(e.permission,this.permissionUpdateKeys),c()(this.props.permission,this.permissionUpdateKeys))||!a()(e.isEditing,this.props.isEditing))))},t}(r.a.Component)},528:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),t.b=function(e,t,n,o){var i,a=n.fileType===d.Modoc,s={},c=t.row,l=t.col,u=t.guid,m=e.guid(),f={},h=[],v=!1;if(u)f[u]=u,a&&(s[u]=p(c,l)),v=!0;else{var g=e.comments.get(c,l);g&&g.guid().forEach(function(e){f[e]=null,a&&(s[e]=null)}),f.comment=null}Object.keys(s).length&&(h.push({fnName:"tableAttrs2Cs",params:[m,s]}),b(e,u?((i={})[u]={row:c,col:l},i):s));var C=[m,[[c,l,{attrs:f}]]];return y({gcSheet:e,cell:[c,l,null,r({},f)],editor:n,type:o,shouldRenderBorder:v}),h.push({fnName:"cellAttrs2Changeset",params:C}),h},t.f=b,t.e=y,t.c=function(e,t){var n=e.filter(function(e){return-1!==t.indexOf(e.selection_guid)});if(n.length&&n[n.length-1].isSending)return n;return n.sort(function(e,t){return e.created_at<t.created_at?-1:e.created_at>t.created_at?1:0})},n.d(t,"d",function(){return C});var o=n(2),r=(n.n(o),this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)}),i=o.sheets.changeset,a="comments",s=o.sheets,c=s.sheet,l=s.position,u=c.setSheetAttrs,m=c.getSheetAttrs,p=l.stringifyPosition,d=i.FileType,f=10,h=o.sheets,v=h.Events,g=h.constants.ERR_CODE;function b(e,t){var n=m(e,a)||{},o=Object.assign(n,t);u(e,a,o)}function y(e){var t=e.gcSheet,n=e.cell,o=e.editor,r=e.type,i=e.shouldRenderBorder,s=n[0],c=n[1],l=n[3],u={};for(var p in l)p.startsWith("comment")&&(u[p]=l[p]);var d=Object.keys(u).length;if(d){d>f&&o.emit(v.Track,g.TRACK_CELL_TO_MANY_COMMENT,{sheetId:t.guid(),ua:navigator.userAgent,commentGuidCount:d,row:s,col:c,type:r});var h=t.comments,b=h.get(s,c),y=m(t,a)||{};if(Object.keys(u).every(function(e){return!l[e]})&&b&&b.isEditing&&!b.isEditing())return o.spread.gcSpread.getTab().repaint(),Object.keys(u).forEach(function(e){return delete y[e]}),h.remove(s,c);var C=b?b.guid().reduce(function(e,t){var n;return Object.assign(e,((n={})[t]=t,n))},{}):{},w=Object.assign(C,u),x=[];for(var p in w){var _=w[p];_&&!x.includes(_)&&x.push(_)}if(x.length){var S="boolean"==typeof i?i:i(x);b?(b.guid(x),S&&b.renderBorder(!0)):h.add(s,c,x,S),x.forEach(function(e){y[e]?Object.assign(y[e],{row:s,col:c}):y[e]={row:s,col:c,isOld:!0}})}}}var C=function(e){var t=e.permissions.query.shimo.getUserPermission();return!t||t.id<0}},54:function(e,t){var n=Object.getPrototypeOf;e.exports=function(e){return n(Object(e))}},55:function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},57:function(e,t,n){var o=n(76),r=n(127),i=1,a=2;e.exports=function(e,t,n,s,c,l){var u=c&a,m=e.length,p=t.length;if(m!=p&&!(u&&p>m))return!1;var d=l.get(e);if(d)return d==t;var f=-1,h=!0,v=c&i?new o:void 0;for(l.set(e,t);++f<m;){var g=e[f],b=t[f];if(s)var y=u?s(b,g,f,t,e,l):s(g,b,f,e,t,l);if(void 0!==y){if(y)continue;h=!1;break}if(v){if(!r(t,function(e,t){if(!v.has(t)&&(g===e||n(g,e,s,c,l)))return v.add(t)})){h=!1;break}}else if(g!==b&&!n(g,b,s,c,l)){h=!1;break}}return l.delete(e),h}},58:function(e,t,n){"use strict";var o=n(0),r=n.n(o),i=n(3),a=n.n(i),s=n(2),c=(n.n(s),n(91)),l=n(43),u=n(123),m=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),p=s.sheets.menu.MenuContext,d=function(e){function t(t){var n=e.call(this,t)||this;return n.direction="right",n.__onMouseHoverSearchResult=function(e,t){var o=!1,r=n.props.tab;o=r===l.b.help?n.state.open:e===r,n.setState({open:o,searchResultPath:t})},n.__onMouseLeaveSearchResult=function(){n.setState({open:n.state.open,searchResultPath:""})},n.toggleOpen=function(){n.setState({open:!n.state.open,style:null})},n.close=function(){n.setState({open:!1,style:null})},n.checkClick=function(e){var t=a.a.findDOMNode(n),o=e.target;!t.contains(o)&&n.state.open&&n.close()},n.adjustStyle=function(){var e=a.a.findDOMNode(n).lastElementChild.getBoundingClientRect(),t=e.top,o=e.bottom,r=e.right,i=e.width,s=e.left,c={},u=window.innerHeight-50;o>u&&(c.maxHeight=u-t,c.overflowY="auto");var m=document.querySelector(".tab-help.menu__open"),p=a.a.findDOMNode(n).querySelector(".dropMenuHead");m&&n.props.tab!==l.b.help&&!p?r>m.getBoundingClientRect().left&&s>i&&(n.direction="left"):n.direction="right";n.setState({style:c})},n.state={open:!1,style:null,searchResultPath:""},n}return m(t,e),t.prototype.componentDidMount=function(){this.bindClick(),u.b&&(u.b.on(c.a.ToggleMenuOpen,this.__onMouseHoverSearchResult),u.b.on(c.a.MouseLeaveSearchResult,this.__onMouseLeaveSearchResult))},t.prototype.componentDidUpdate=function(e,t){var n;(!this.state.open||t.open||this.state.style?!this.state.open&&t.open&&this.props.onClose&&this.props.onClose():(this.props.onOpen&&this.props.onOpen(),this.adjustStyle()),this.state.style)&&(null===(n=a.a.findDOMNode(this).querySelector(".menuItem--highlight"))||void 0===n||n.scrollIntoView(!1))},t.prototype.componentWillUnmount=function(){this.unbindClick(),u.b&&(u.b.off(c.a.ToggleMenuOpen,this.__onMouseHoverSearchResult),u.b.off(c.a.MouseLeaveSearchResult,this.__onMouseLeaveSearchResult))},t.prototype.render=function(){var e=this,t="menu "+(this.props.customClass?this.props.customClass:"")+" "+(this.state.open?"menu__open":"")+" "+(this.props.disabled?"disabled":""),n="right"===this.direction?"open--right":"open--left";return r.a.createElement(p.Provider,{value:{closeMenu:this.close,searchResultPath:this.state.searchResultPath}},r.a.createElement("div",{className:t,"data-smattr":this.props.smattr},r.a.cloneElement(this.props.head,{onClick:function(t){var n=e.props.head.props.onClick;n&&n(t),e.toggleOpen()}}),this.state.open&&r.a.createElement("div",{className:"menu--body "+n},r.a.createElement("div",{className:"menu--content",style:this.state.style},this.renderChildren()))))},t.prototype.bindClick=function(){document.addEventListener("click",this.checkClick,!1)},t.prototype.unbindClick=function(){document.removeEventListener("click",this.checkClick,!1)},t.prototype.renderChildren=function(){var e=this.props.children;if("function"==typeof e){if(e.cache)return e.cache;var t=e();return e.cache=t,t}return e},t}(r.a.Component);t.a=d},59:function(e,t,n){"use strict";t.a=function(e){return{background:'url("'+e+'") center no-repeat'}}},593:function(e,t,n){"use strict";var o;n.d(t,"a",function(){return o}),function(e){e.LayoutChange="layoutChange",e.Loaded="loadComments",e.Toggle="toggleComment",e.Start="startComment",e.Update="updateComment",e.ShowCommentSidebar="showCommentSidebar",e.CommentBoxMounted="CommentBoxMounted"}(o||(o={}))},6:function(e,t){e.exports=function(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}},60:function(e,t,n){"use strict";t.a=function(e){return e.option?r.a.createElement("span",{className:"tooltip tooltip__"+(e.direction||"down"),style:e.style},r.a.createElement("span",null,e.option),e.detail&&r.a.createElement("br",null),e.detail&&r.a.createElement("span",null,e.detail)):null};var o=n(0),r=n.n(o)},61:function(e,t,n){var o=n(19),r=n(6),i=n(22),a=NaN,s=/^\s+|\s+$/g,c=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,u=/^0o[0-7]+$/i,m=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return a;if(r(e)){var t=o(e.valueOf)?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=l.test(e);return n||u.test(e)?m(e.slice(2),n?2:8):c.test(e)?a:+e}},62:function(e,t,n){"use strict";var o=n(0),r=n.n(o),i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.disabled,o=t.className,i="m-menu-group-item"+(o?" "+o:"")+(n?" m-menu-disabled":"");return r.a.createElement("div",{className:i,onClick:function(){return e.__onClick()}},this.props.children)},t.prototype.__onClick=function(){this.props.onClick&&this.props.onClick()},t}(r.a.Component);t.a=a},63:function(e,t,n){var o=n(17),r=n(10);e.exports=function(e){return r(e)&&o(e)}},64:function(e,t,n){var o=n(33),r=Object.prototype.hasOwnProperty;e.exports=function(e,t,n){var i=e[t];r.call(e,t)&&o(i,n)&&(void 0!==n||t in e)||(e[t]=n)}},65:function(e,t){e.exports=function(e,t,n,o){var r=-1,i=e.length;for(o&&i&&(n=e[++r]);++r<i;)n=t(n,e[r],r,e);return n}},66:function(e,t,n){var o=n(126),r=n(6),i=n(10);e.exports=function e(t,n,a,s,c){return t===n||(null==t||null==n||!r(t)&&!i(n)?t!=t&&n!=n:o(t,n,e,a,s,c))}},67:function(e,t,n){var o=n(4).Uint8Array;e.exports=o},68:function(e,t,n){var o=n(82),r=n(29),i=n(5),a=n(20),s=n(44);e.exports=function(e){var t=e?e.length:void 0;return a(t)&&(i(e)||s(e)||r(e))?o(t,String):null}},69:function(e,t,n){var o=n(8)(n(4),"Set");e.exports=o},70:function(e,t,n){var o=n(5),r=n(22),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(o(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!r(e))||a.test(e)||!i.test(e)||null!=t&&e in Object(t)}},71:function(e,t){e.exports=function(e){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},73:function(e,t,n){var o=n(55)("length");e.exports=o},735:function(e,t){e.exports="data:image/png;base64,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"},736:function(e,t,n){(function(e){Object.defineProperty(t,"__esModule",{value:!0});var o=m(["","分钟前"],["","分钟前"]),r=m(["今天 ",""],["今天 ",""]),i=m(["昨天 ",""],["昨天 ",""]);t.autoRefresh=function(t){var n=(0,s.default)(t)?e(t):t;p.push(n)},t.format=f,t.sortByDate=function(e){var t=0,n=[[]];return(0,c.default)(e,function e(o){return function(e){switch(t){case 0:return v(e);case 1:return v(e,864e5);case 2:return v(e,6048e5);case 3:return v(e,2592e6);default:return!0}}(o.lastUsedAt)?n[t].push(o):(n[++t]=[],e(o))}),n},t.sortByDay=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lastUsedAt",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={},r=[];for(var i in(0,c.default)(e,function(e){var n=new Date(e[t]),r=n.getFullYear()+"/"+h(n.getMonth()+1)+"/"+h(n.getDate());o.hasOwnProperty(r)||(o[r]=[]),o[r].push(e)}),o)o.hasOwnProperty(i)&&r.push({timestamp:i,timeLabel:f(i,!1,!1,!0,"／"),files:o[i]});var a=n?"desc":"asc";return(0,l.default)(r,["timestamp"],[a])};var a=u(n(1)),s=u(n(44)),c=u(n(370)),l=u(n(737));function u(e){return e&&e.__esModule?e:{default:e}}function m(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var p=[];function d(t){t.find("[data-time]").each(function(t){var n=e(t);return n.html(f(n.attr("data-time"),"1"===n.attr("full")))})}function f(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"/",l=new Date,u=+l/1e3,m=new Date(e),p=u-+new Date(e)/1e3;if(n){if(p<60)return(0,a.default)("刚刚");if(p<3600)return(0,a.default)(o,parseInt(p/60,10))}var d=new Date(l.getFullYear()+"/"+(l.getMonth()+1)+"/"+l.getDate()+" 00:00:00")-new Date(e)+864e5,f=h(m.getHours())+":"+h(m.getMinutes());if(d>0&&d<=864e5)return s?(0,a.default)("今天"):(0,a.default)(r,f);if(d>864e5&&d<=1728e5)return s?(0,a.default)("昨天"):(0,a.default)(i,f);var v=""+(m.getMonth()+1)+c+m.getDate()+" "+f;return s&&(v=""+(m.getMonth()+1)+c+m.getDate()),(t||m.getFullYear()!==l.getFullYear())&&(v=""+m.getFullYear()+c+v),v}function h(e){return e<10?"0"+e:e}function v(e,t){var n=null;n=t?new Date(new Date(e).valueOf()+t):new Date(e);var o=new Date;return n.setHours(0,0,0,0)>=o.setHours(0,0,0,0)}window.setInterval(function(){for(var e=0;e<p.length;e++){d(p[e])}},15e3)}).call(t,n(144))},737:function(e,t,n){var o=n(738),r=n(5);e.exports=function(e,t,n,i){return null==e?[]:(r(t)||(t=null==t?[]:[t]),r(n=i?void 0:n)||(n=null==n?[]:[n]),o(e,t,n))}},738:function(e,t,n){var o=n(74),r=n(151),i=n(739),a=n(740),s=n(383),c=n(741),l=n(194);e.exports=function(e,t,n){var u=-1;t=o(t.length?t:[l],s(r));var m=i(e,function(e,n,r){return{criteria:o(t,function(t){return t(e)}),index:++u,value:e}});return a(m,function(e,t){return c(e,t,n)})}},739:function(e,t,n){var o=n(214),r=n(17);e.exports=function(e,t){var n=-1,i=r(e)?Array(e.length):[];return o(e,function(e,o,r){i[++n]=t(e,o,r)}),i}},74:function(e,t){e.exports=function(e,t){for(var n=-1,o=e.length,r=Array(o);++n<o;)r[n]=t(e[n],n,e);return r}},740:function(e,t){e.exports=function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}},741:function(e,t,n){var o=n(742);e.exports=function(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,s=i.length,c=n.length;++r<s;){var l=o(i[r],a[r]);if(l)return r>=c?l:l*("desc"==n[r]?-1:1)}return e.index-t.index}},742:function(e,t,n){var o=n(22);e.exports=function(e,t){if(e!==t){var n=void 0!==e,r=null===e,i=e==e,a=o(e),s=void 0!==t,c=null===t,l=t==t,u=o(t);if(!c&&!u&&!a&&e>t||a&&s&&l&&!c&&!u||r&&s&&l||!n&&l||!i)return 1;if(!r&&!a&&!u&&e<t||u&&n&&i&&!r&&!a||c&&n&&i||!s&&i||!l)return-1}return 0}},76:function(e,t,n){var o=n(31),r=n(120),i=n(121);function a(e){var t=-1,n=e?e.length:0;for(this.__data__=new o;++t<n;)this.add(e[t])}a.prototype.add=a.prototype.push=r,a.prototype.has=i,e.exports=a},77:function(e,t,n){var o=n(64);e.exports=function(e,t,n,r){n||(n={});for(var i=-1,a=t.length;++i<a;){var s=t[i],c=r?r(n[s],e[s],s,n,e):e[s];o(n,s,c)}return n}},78:function(e,t,n){var o=n(131),r=n(116),i="Expected a function",a=Math.max;e.exports=function(e,t){if("function"!=typeof e)throw new TypeError(i);return t=a(void 0===t?e.length-1:r(t),0),function(){for(var n=arguments,r=-1,i=a(n.length-t,0),s=Array(i);++r<i;)s[r]=n[t+r];switch(t){case 0:return e.call(this,s);case 1:return e.call(this,n[0],s);case 2:return e.call(this,n[0],n[1],s)}var c=Array(t+1);for(r=-1;++r<t;)c[r]=n[r];return c[t]=s,o(e,this,c)}}},8:function(e,t,n){var o=n(85);e.exports=function(e,t){var n=e[t];return o(n)?n:void 0}},81:function(e,t){var n=Object.keys;e.exports=function(e){return n(Object(e))}},82:function(e,t){e.exports=function(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}},85:function(e,t,n){var o=n(19),r=n(28),i=n(6),a=n(39),s=/^\[object .+?Constructor\]$/,c=Object.prototype,l=Function.prototype.toString,u=c.hasOwnProperty,m=RegExp("^"+l.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!!i(e)&&(o(e)||r(e)?m:s).test(a(e))}},86:function(e,t){e.exports=function(e){return e&&e.Object===Object?e:null}},87:function(e,t,n){var o=n(8)(n(4),"DataView");e.exports=o},88:function(e,t,n){var o=n(8)(n(4),"Promise");e.exports=o},89:function(e,t,n){var o=n(8)(n(4),"WeakMap");e.exports=o},90:function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,o=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var r,i=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(r=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:o+i.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},91:function(e,t,n){"use strict";var o;!function(e){e.ToolBarLayoutChanged="Toolbar:ToolBarLayoutChanged",e.SelectionChanged="Toolbar:SelectionChanged",e.PermissionChanged="Toolbar:PermissionChanged",e.StartInsertLink="Toolbar:StartInsertLink",e.PaintBrushSelected="Toolbar:PaintBrushSelected",e.FrozenChanged="Toolbar:FrozenChanged",e.FilterChanged="Toolbar:FilterChanged",e.ToggleMenuOpen="Toolbar:ToggleMenuOpen",e.MouseLeaveSearchResult="Toolbar:MouseLeaveSearchResult"}(o||(o={})),t.a=o},92:function(e,t){e.exports=function(e,t){for(var n=-1,o=t.length,r=e.length;++n<o;)e[r+n]=t[n];return e}},93:function(e,t){e.exports=function(){this.__data__=[]}},94:function(e,t,n){var o=n(14),r=Array.prototype.splice;e.exports=function(e){var t=this.__data__,n=o(t,e);return!(n<0||(n==t.length-1?t.pop():r.call(t,n,1),0))}},95:function(e,t,n){var o=n(14);e.exports=function(e){var t=this.__data__,n=o(t,e);return n<0?void 0:t[n][1]}},96:function(e,t,n){var o=n(14);e.exports=function(e){return o(this.__data__,e)>-1}},97:function(e,t,n){var o=n(14);e.exports=function(e,t){var n=this.__data__,r=o(n,e);return r<0?n.push([e,t]):n[r][1]=t,this}},98:function(e,t,n){var o=n(13);e.exports=function(){this.__data__=new o}},987:function(e,t,n){"use strict";function o(e){var t=e.sheet,n=[];if(t.gcSheet&&(t=t.gcSheet),(t=t).comments)for(var o=function(e){return e.comments.sort(function(e,t){return e._rowIndex!==t._rowIndex?e._rowIndex-t._rowIndex:e._colIndex-t._colIndex})}({comments:t.comments.all()}),r=0;r<o.length;++r){var i=o[r];n.push({_rowIndex:i._rowIndex,_colIndex:i._colIndex,selectionGuid:i.guid()})}return n}function r(e){var t=e.commentList,n=e.guid;return t.filter(function(e){return-1!==n.indexOf(e.selection_guid)}).sort(i)}function i(e,t){return e.created_at<t.created_at?-1:e.created_at>t.created_at?1:0}Object.defineProperty(t,"__esModule",{value:!0}),t.editorComments=function(e){for(var t={},n=e.editor.spread.gcSpread,r=0;r<n.sheets.length;++r){var i=n.sheets[r];if(i.comments){var a=i.guid();t[a]=o({sheet:i})}}return t},t.sheetComments=o,t.cellBySelectionGuid=function(e){var t=e.sheet,n=e.selectionGuid;t.gcSheet&&(t=t.gcSheet);if(!(t=t).comments)return;for(var o=t.comments.all(),r=0;r<o.length;++r){var i=o[r];if(-1!==i.guid().indexOf(n))return{row:i._rowIndex,col:i._colIndex}}},t.commentsByRowAndCol=function(e){var t=e.commentList,n=e.sheet,o=e.row,i=e.col;n.gcSheet&&(n=n.gcSheet);var a=(n=n).comments.get(o,i);if(!a)return;return r({commentList:t,guid:a.guid()})},t.showComment=function(e){var t=e.sheet,n=e.row,o=e.col,r=e.rowOffset;t.gcSheet&&(t=t.gcSheet);(t=t).setActiveCell(n,o),t.showCell(n,o,1,1,r)},t.commentsBySelectionGuid=r},99:function(e,t){e.exports=function(e){return this.__data__.delete(e)}}})});