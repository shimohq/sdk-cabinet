!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://assets.smcdn.cn/sheet/",n(n.s=2290)}({0:function(e,t){e.exports=React},1:function(e,t,n){"use strict";var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){e.done?o(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,s)}c((r=r.apply(e,t||[])).next())})},i=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},a=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(t,"__esModule",{value:!0});var s=n(18),c=n(38),u={},l=function(e){return u[e]||(u[e]=p()),u[e]};t.getS18n=l;var f=function(){u={}};t.DEBUG_reset=f;var d=function(){return u};t.DEBUG_getInstances=d;var p=function(){var e,t,n="zh-CN",u="zh-CN",p={},h=function(e,t){if(!s.isValidLocaleResource(t))throw new Error("fetched locale resource is invalid");p[e]=r(r({},p[e]||{}),t)},v=function(e,n){return o(void 0,void 0,void 0,function(){var r;return i(this,function(o){switch(o.label){case 0:return!n&&p[e]?[3,2]:t?[4,t(e)]:[3,2];case 1:r=o.sent(),h(e,r),o.label=2;case 2:return[2]}})})},g=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("string"==typeof e[0]){var r=e[0],o=e[1],i=o&&"string"==typeof o._?o._:void 0,s=i?r+"#"+i:r;if(!s)return"";var l=c.getTextResult(s,p[n]);if("string"==typeof l)return l;var f=c.getTextResult(s,p[u]);return"string"==typeof f?f:r}if(e[0]&&"number"==typeof e[0].length){var d=e[0],h=e.slice(1);return c.getInterpolateResult(d,h,p[n])||c.getInterpolateResult(d,h,p[u])||c.interweave(d,h)}return console.warn.apply(console,a(["[s18n] invalid input:"],e)),""};return g.configure=function(n){if(n.fetchLocale){if("function"!=typeof n.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");t=n.fetchLocale}if(n.fetchLocaleSync){if("function"!=typeof n.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");e=n.fetchLocaleSync}},g.addLocaleResource=h,g.setLocaleAsync=function(e,t){return o(void 0,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:if("string"!=typeof e)throw new Error("'locale' is required");return[4,v(e)];case 1:return r.sent(),n=e,"string"==typeof t&&(v(t),u=t),[2]}})})},g.setLocaleSync=function(t){if("string"!=typeof t)throw new Error("'locale' is required");if(e){var r=e(t);h(t,r)}n=t},g.getLocale=function(){return n},g.DEBUG_getLocaleResources=function(){return p},g.getS18n=l,g.DEBUG_reset=f,g.DEBUG_getInstances=d,g},h=l("__default_namespace__");e.exports=h,t.default=h},148:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isRetina=function(){return window.devicePixelRatio>=2},t.isDingTalk=function(){return/dingtalk/i.test(n)},t.isDingtalk=function(){return!!n.match(/mobile.*dingtalk/i)},t.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},t.isWechatPc=r,t.isWxworkPc=o,t.isWechat=function(){return!!/micromessenger/.test(n)&&!r()},t.isMobile=function(){return!r()&&!o()&&!!n.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},t.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},t.isIOS=i,t.isAndroid=function(){return!!/(android)/g.test(n)},t.isAndroidApp=function(){return!!/shimo-android-app/g.test(n)},t.isIE=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},t.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},t.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},t.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},t.isWebIOS=function(){if(!window.cow.iOS&&i())return!0;return!1},t.isIphone6=function(){var e=!1;i()&&screen.height>568&&(e=!0);return e},t.isInWxMp=function(){return!(!navigator.userAgent.match(/micromessenger/i)||!navigator.userAgent.match(/miniprogram/i))||"miniprogram"===window.__wxjs_environment};var n=window.navigator.userAgent.toLowerCase();function r(){return!!/micromessenger.*?windowswechat/.test(n)}function o(){return!!/wxwork.*?micromessenger.*?wechat/i.test(n)}function i(){return!!/(ipad|iphone|ipod)/g.test(n)}},18:function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(37);t.isValidLocaleResource=function(e){return!!e&&(!Array.isArray(e)&&("object"===(void 0===e?"undefined":r(e))&&Object.keys(e).every(function(t){var n=e[t];return null==n||"string"==typeof n||"object"===(void 0===n?"undefined":r(n))})))},t.sourceTextToKey=function(e){switch(e.type){case"string":var t=e.id,n=e.text;return t?n+"#"+t:n;case"interpolated":var r=e.textParts.length;return 1===r?e.textParts[0]:2===r?e.textParts[0]+"%s"+e.textParts[1]:e.textParts.map(function(t,n){return n===e.textParts.length-1?t:t+"%"+(n+1)}).join("");default:return o.assertNever(e)}}},2:function(e,t){e.exports=shimo.sdk.sheet},21:function(e,t,n){var r;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e=[],t=0;t<arguments.length;t++){var r=arguments[t];if(r){var i=typeof r;if("string"===i||"number"===i)e.push(r);else if(Array.isArray(r)&&r.length){var a=o.apply(null,r);a&&e.push(a)}else if("object"===i)for(var s in r)n.call(r,s)&&r[s]&&e.push(s)}}return e.join(" ")}void 0!==e&&e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},2290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),o=n.n(r),i=(n(2291),n(0)),a=n.n(i),s=n(3),c=n.n(s),u=n(2),l=(n.n(u),n(2294)),f=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=u.sheets,p=d.root,h=d.path,v=d.Plugin,g=h.setByPath,m="SheetMenu",y=(u.Editor,function(e){function t(n){var r=n.editor,o=n.container,i=e.call(this,{name:m,Constructor:t,config:arguments[0]})||this;return i.editor=r,o&&i.initContainer(o),i.install(),i}return f(t,e),t.prototype.setLocale=function(e){o.a.setLocaleSync(e)},t.prototype.render=function(e){var t=e.container;this.container=t,this.initContainer(t)},t.prototype.destroy=function(){this.container&&c.a.unmountComponentAtNode(this.container)},t.prototype.initContainer=function(e){e.style.zIndex||(e.style.zIndex="10"),c.a.render(a.a.createElement(l.a,{editor:this.editor}),e)},t}(v));t.default=y,g(p,"shimo.sdk.sheet.plugins.MobileSheetTab",y)},2291:function(e,t,n){"use strict";var r=n(1),o=n.n(r),i=n(2292),a=n.n(i),s=n(2293),c=n.n(s);o.a.addLocaleResource("en-US",a.a),o.a.addLocaleResource("ja-JP",c.a),o.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2292:function(e,t){e.exports={"名称为%s的工作表已存在，请输入其他名称！":"A worksheet with the name %s already exists. Please enter a different name!","工作表%s":"Worksheet %s","新增工作表":"New worksheet","取消":"Cancel","确认":"Confirm"}},2293:function(e,t){e.exports={"名称为%s的工作表已存在，请输入其他名称！":" %s という名前のワークシートは既に存在します。別の名前を入力してください。","工作表%s":"ワークシート %s","新增工作表":"新しいワークシート","取消":"キャンセル","确认":"確定"}},2294:function(e,t,n){"use strict";var r,o,i,a=n(1),s=n.n(a),c=n(0),u=n.n(c),l=n(2),f=(n.n(l),n(148)),d=(n.n(f),n(21)),p=n.n(d),h=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),v=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},g=l.sheets.Events,m=Object(f.isInWxMp)(),y=function(e){function t(t){var n=e.call(this,t)||this;return n.toggleNewSheetDialog=function(){n.setState({newSheetDialogShow:!n.state.newSheetDialogShow})},n.toggleSheetTabList=function(){n.setState({sheetListDialogShow:!n.state.sheetListDialogShow})},n.onAddNewSheet=function(){if(n.nameInputRef.current){var e=n.nameInputRef.current.value;if(!e)return;if(n.isDuplicateSheetName(e))return alert(s()(r||(r=v(["名称为","的工作表已存在，请输入其他名称！"],["名称为","的工作表已存在，请输入其他名称！"])),e));n.props.editor.spread.appendSheet({name:e.trim().replace(/[\\\/:,?*\[\]]/gi,"").slice(0,31)})}n.toggleNewSheetDialog();var t=n.props.editor.spread.gcSpread;setTimeout(function(){return t._doWindowResize()})},n.isDuplicateSheetName=function(e){for(var t=n.props.editor.spread.sheets,r=0;r<t.length;r++)if(e===t[r].name)return!0;return!1},n.onChangeActiveSheet=function(e,t){e&&(e.preventDefault(),e.stopPropagation(),e.nativeEvent.preventDefault(),e.nativeEvent.stopImmediatePropagation(),e.nativeEvent.stopPropagation());var r=n.props.editor.spread.getSheetByName(t);r&&n.props.editor.spread.setActiveSheet(r.id)},n.getSheetsInfo=function(){return n.props.editor.spread.gcSpread.sheets.map(function(e){return{name:e.name(),visible:e.visible()}})},n.afterNewSheetInserted=function(e){var t=e.newSheet;t&&(n.onChangeActiveSheet(null,t.name),n.moveActiveTabIntoView())},n._getActiveSheetIndex=function(){if(n.props.editor.isRendered){var e=n.props.editor.spread.gcSpread,t=e.getActiveSheet();return e.sheets.findIndex(function(e){return e.name()===t.name()})}return 0},n._updateActiveSheet=function(){n.setState({activeSheetIndex:n._getActiveSheetIndex()}),n.moveActiveTabIntoView()},n._onMobileKeyboardToggle=function(e){n.setState({showSheetTab:e})},n.moveActiveTabIntoView=function(){setTimeout(function(){var e=document.querySelector(".tab-active");e&&(e.scrollIntoViewIfNeeded&&e.scrollIntoViewIfNeeded(!0),!e.scrollIntoViewIfNeeded&&e.scrollIntoView&&e.scrollIntoView({behavior:"smooth"}))})},n.onSheetTabListItemClick=function(e,t,r){t&&(n.toggleSheetTabList(),!r&&n.onChangeActiveSheet(null,e))},n.onBlur=function(){document.body.scrollTop=0},n.renderAddNewSheetDialog=function(){return u.a.createElement("div",{className:"sheet-tab--dialog-container sheet-tab-add-dialog-container"},u.a.createElement("div",{className:"sheet-tab-add-dialog"},u.a.createElement("div",{className:"sheet-tab-add-dialog-title"},s()("新增工作表")),u.a.createElement("div",{className:"sheet-tab-add-dialog-input"},u.a.createElement("input",{onBlur:n.onBlur,ref:n.nameInputRef,type:"text",minLength:1,maxLength:31,required:!0,autoFocus:!0,defaultValue:n.defaultSheetName})),u.a.createElement("div",{className:"sheet-tab-add-dialog-actions"},u.a.createElement("span",{className:"actions-cancel",onClick:n.toggleNewSheetDialog},s()("取消")),u.a.createElement("span",{className:"actions-ok",onClick:n.onAddNewSheet},s()("确认")))))},n.renderSheetListDialog=function(e){var t=n.props.editor.spread.getActiveSheet().name;return u.a.createElement("div",{className:"sheet-tab--dialog-container sheet-tab-list-container",onClick:n.toggleSheetTabList},u.a.createElement("div",{className:"sheet-tab-list-dialog-wrapper"},u.a.createElement("div",{className:"sheet-tab-list-dialog"},e.map(function(e){var r=e.name,o=e.visible;return u.a.createElement("div",{className:p()({"sheet-tab-list-item":!0,"sheet-tab-list-item-hide":!o,"sheet-tab-list-item-active":t===r}),key:r,onClick:function(){return n.onSheetTabListItemClick(r,o,t===r)}},u.a.createElement("span",{className:"tab-list-item-text"},r)," ",u.a.createElement("span",{className:"tab-list-item-unhide-btn"}))}))))},n.renderSheetTabs=function(e){var t=n.state.activeSheetIndex;return u.a.createElement("div",{className:"sheet-tabs"+(m?"":" smooth-scroll")},e.map(function(e,r){var o=e.name;return e.visible?u.a.createElement("div",{key:o,className:p()({tab:!0,"tab-active":r===t}),onClick:function(e){return n.onChangeActiveSheet(e,o)}},u.a.createElement("span",null,o)):null}).filter(function(e){return!!e}))},n.state={activeSheetIndex:n._getActiveSheetIndex(),newSheetDialogShow:!1,sheetListDialogShow:!1,showSheetTab:!0},n.nameInputRef=u.a.createRef(),n}return h(t,e),t.prototype.componentDidMount=function(){this.props.editor.on(g.Rendered,this._updateActiveSheet),this.props.editor.on(g.SheetSwitched,this._updateActiveSheet),this.props.editor.on(g.AfterChangeApplied,this._updateActiveSheet),this.props.editor.on(g.NewSheetInserted,this.afterNewSheetInserted),this.props.editor.on(g.DeleteSheet,this._updateActiveSheet),this.props.editor.on(g.PermissionChanged,this._updateActiveSheet),this.props.editor.on(g.RenamedSheet,this._updateActiveSheet),this.props.editor.on(g.ToggleMobileKeyboard,this._onMobileKeyboardToggle)},t.prototype.componentWillUnMount=function(){this.props.editor.off(g.Rendered,this._updateActiveSheet),this.props.editor.off(g.SheetSwitched,this._updateActiveSheet),this.props.editor.off(g.AfterChangeApplied,this._updateActiveSheet),this.props.editor.off(g.NewSheetInserted,this.afterNewSheetInserted),this.props.editor.off(g.DeleteSheet,this._updateActiveSheet),this.props.editor.off(g.PermissionChanged,this._updateActiveSheet),this.props.editor.off(g.RenamedSheet,this._updateActiveSheet),this.props.editor.off(g.ToggleMobileKeyboard,this._onMobileKeyboardToggle)},Object.defineProperty(t.prototype,"defaultSheetName",{get:function(){for(var e=this.props.editor.spread.sheets,t=e.map(function(e){return e.name}),n=e[0],r=(n.nextIndex?n.nextIndex:t.length)+1;-1!==t.indexOf(s()(o||(o=v(["工作表",""],["工作表",""])),r));)r++;return s()(i||(i=v(["工作表",""],["工作表",""])),r)},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e=this.props.editor;if(!e.isRendered)return null;var t=this.state,n=t.newSheetDialogShow,r=t.sheetListDialogShow,o=t.showSheetTab,i=this.getSheetsInfo(),a=e.spread.gcSpread.options.newTabVisible;return u.a.createElement("div",{className:"sm-m-sheet-tab"},u.a.createElement("div",{className:"sm-sheet-multi-sheet-wrap"+(o?"":" m-sheet-tab-hide")},a&&u.a.createElement("div",{className:"sheet-tab-add",onClick:this.toggleNewSheetDialog}),u.a.createElement("div",{className:"sheet-tab-list",onClick:this.toggleSheetTabList}),this.renderSheetTabs(i)),r&&this.renderSheetListDialog(i),n&&this.renderAddNewSheetDialog())},t}(c.Component);t.a=y},3:function(e,t){e.exports=ReactDOM},37:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertNever=function(e){throw new Error("unexpected type: "+JSON.stringify(e))}},38:function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(18);t.interweave=function(e,t){return e.map(function(n,r){return r===e.length-1?n:""+n+t[r]}).join("")},t.getTextResult=function(e,t){return t&&t[e]};var i=/%(s|\d)/g;t.getInterpolateResult=function(e,t,n){try{if(!n)return;var a=o.sourceTextToKey({type:"interpolated",textParts:e}),s=n[a];if(!s)return;var c={},u=0;a.replace(i,function(e){return c[e]=t[u],u+=1,e});return"string"==typeof s?function(e,t){return e.replace(i,function(n){return null!==t[n]?String(t[n]):(console.warn("[s18n] interpolation failed:",{str:e,valueMap:t}),n)})}(s,c):"object"===(void 0===s?"undefined":r(s))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(s))}catch(r){var l={parts:e,values:t,resource:n};return console.error("[s18n] error when translating: ",l),void console.error(r)}}}})});