!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="https://assets.smcdn.cn/sheet/",n(n.s=703)}([,function(t,e,n){"use strict";var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t,e,n,r){return new(n||(n=Promise))(function(o,a){function c(t){try{u(r.next(t))}catch(t){a(t)}}function i(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(c,i)}u((r=r.apply(t,e||[])).next())})},a=function(t,e){var n,r,o,a,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,r=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(!(o=(o=c.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){c.label=a[1];break}if(6===a[0]&&c.label<o[1]){c.label=o[1],o=a;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(a);break}o[2]&&c.ops.pop(),c.trys.pop();continue}a=e.call(t,c)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}},c=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var a=arguments[e],c=0,i=a.length;c<i;c++,o++)r[o]=a[c];return r};Object.defineProperty(e,"__esModule",{value:!0});var i=n(18),u=n(38),f={},s=function(t){return f[t]||(f[t]=v()),f[t]};e.getS18n=s;var l=function(){f={}};e.DEBUG_reset=l;var p=function(){return f};e.DEBUG_getInstances=p;var v=function(){var t,e,n="zh-CN",f="zh-CN",v={},d=function(t,e){if(!i.isValidLocaleResource(e))throw new Error("fetched locale resource is invalid");v[t]=r(r({},v[t]||{}),e)},b=function(t,n){return o(void 0,void 0,void 0,function(){var r;return a(this,function(o){switch(o.label){case 0:return!n&&v[t]?[3,2]:e?[4,e(t)]:[3,2];case 1:r=o.sent(),d(t,r),o.label=2;case 2:return[2]}})})},h=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("string"==typeof t[0]){var r=t[0],o=t[1],a=o&&"string"==typeof o._?o._:void 0,i=a?r+"#"+a:r;if(!i)return"";var s=u.getTextResult(i,v[n]);if("string"==typeof s)return s;var l=u.getTextResult(i,v[f]);return"string"==typeof l?l:r}if(t[0]&&"number"==typeof t[0].length){var p=t[0],d=t.slice(1);return u.getInterpolateResult(p,d,v[n])||u.getInterpolateResult(p,d,v[f])||u.interweave(p,d)}return console.warn.apply(console,c(["[s18n] invalid input:"],t)),""};return h.configure=function(n){if(n.fetchLocale){if("function"!=typeof n.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");e=n.fetchLocale}if(n.fetchLocaleSync){if("function"!=typeof n.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");t=n.fetchLocaleSync}},h.addLocaleResource=d,h.setLocaleAsync=function(t,e){return o(void 0,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:if("string"!=typeof t)throw new Error("'locale' is required");return[4,b(t)];case 1:return r.sent(),n=t,"string"==typeof e&&(b(e),f=e),[2]}})})},h.setLocaleSync=function(e){if("string"!=typeof e)throw new Error("'locale' is required");if(t){var r=t(e);d(e,r)}n=e},h.getLocale=function(){return n},h.DEBUG_getLocaleResources=function(){return v},h.getS18n=s,h.DEBUG_reset=l,h.DEBUG_getInstances=p,h},d=s("__default_namespace__");t.exports=d,e.default=d},function(t,e){t.exports=shimo.sdk.sheet},,function(t,e,n){(function(t,r){var o=n(87),a={function:!0,object:!0},c=a[typeof e]&&e&&!e.nodeType?e:void 0,i=a[typeof t]&&t&&!t.nodeType?t:void 0,u=o(c&&i&&"object"==typeof r&&r),f=o(a[typeof self]&&self),s=o(a[typeof window]&&window),l=o(a[typeof this]&&this),p=u||s!==(l&&l.window)&&s||f||l||Function("return this")();t.exports=p}).call(e,n(32)(t),n(26))},function(t,e){var n=Array.isArray;t.exports=n},function(t,e){t.exports=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}},,function(t,e,n){var r=n(86);t.exports=function(t,e){var n=t[e];return r(n)?n:void 0}},,function(t,e){t.exports=function(t){return!!t&&"object"==typeof t}},,function(t,e,n){var r=n(41),o=n(81),a=n(68),c=n(17),i=n(34),u=n(36);t.exports=function(t){var e=u(t);if(!e&&!c(t))return o(t);var n=a(t),f=!!n,s=n||[],l=s.length;for(var p in t)!r(t,p)||f&&("length"==p||i(p,l))||e&&"constructor"==p||s.push(p);return s}},function(t,e,n){var r=n(93),o=n(94),a=n(95),c=n(96),i=n(97);function u(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=c,u.prototype.set=i,t.exports=u},function(t,e,n){var r=n(33);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e,n){var r=n(8)(Object,"create");t.exports=r},function(t,e,n){var r=n(111);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){var r=n(73),o=n(19),a=n(20);t.exports=function(t){return null!=t&&a(r(t))&&!o(t)}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(37);e.isValidLocaleResource=function(t){return!!t&&(!Array.isArray(t)&&("object"===(void 0===t?"undefined":r(t))&&Object.keys(t).every(function(e){var n=t[e];return null==n||"string"==typeof n||"object"===(void 0===n?"undefined":r(n))})))},e.sourceTextToKey=function(t){switch(t.type){case"string":var e=t.id,n=t.text;return e?n+"#"+e:n;case"interpolated":var r=t.textParts.length;return 1===r?t.textParts[0]:2===r?t.textParts[0]+"%s"+t.textParts[1]:t.textParts.map(function(e,n){return n===t.textParts.length-1?e:e+"%"+(n+1)}).join("");default:return o.assertNever(t)}}},function(t,e,n){var r=n(6),o="[object Function]",a="[object GeneratorFunction]",c=Object.prototype.toString;t.exports=function(t){var e=r(t)?c.call(t):"";return e==o||e==a}},function(t,e){var n=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}},,function(t,e,n){var r=n(10),o="[object Symbol]",a=Object.prototype.toString;t.exports=function(t){return"symbol"==typeof t||r(t)&&a.call(t)==o}},,,,function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},,function(t,e){t.exports=function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}},function(t,e,n){var r=n(63),o="[object Arguments]",a=Object.prototype,c=a.hasOwnProperty,i=a.toString,u=a.propertyIsEnumerable;t.exports=function(t){return r(t)&&c.call(t,"callee")&&(!u.call(t,"callee")||i.call(t)==o)}},function(t,e,n){var r=n(22),o=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}},function(t,e,n){var r=n(103),o=n(110),a=n(112),c=n(113),i=n(114);function u(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=c,u.prototype.set=i,t.exports=u},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){return!!(e=null==e?n:e)&&("number"==typeof t||r.test(t))&&t>-1&&t%1==0&&t<e}},,function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertNever=function(t){throw new Error("unexpected type: "+JSON.stringify(t))}},function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(18);e.interweave=function(t,e){return t.map(function(n,r){return r===t.length-1?n:""+n+e[r]}).join("")},e.getTextResult=function(t,e){return e&&e[t]};var a=/%(s|\d)/g;e.getInterpolateResult=function(t,e,n){try{if(!n)return;var c=o.sourceTextToKey({type:"interpolated",textParts:t}),i=n[c];if(!i)return;var u={},f=0;c.replace(a,function(t){return u[t]=e[f],f+=1,t});return"string"==typeof i?function(t,e){return t.replace(a,function(n){return null!==e[n]?String(e[n]):(console.warn("[s18n] interpolation failed:",{str:t,valueMap:e}),n)})}(i,u):"object"===(void 0===i?"undefined":r(i))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(i))}catch(r){var s={parts:t,values:e,resource:n};return console.error("[s18n] error when translating: ",s),void console.error(r)}}},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){var r=n(8)(n(4),"Map");t.exports=r},function(t,e,n){var r=n(54),o=Object.prototype.hasOwnProperty;t.exports=function(t,e){return o.call(t,e)||"object"==typeof t&&e in t&&null===r(t)}},function(t,e,n){var r=n(88),o=n(40),a=n(89),c=n(69),i=n(90),u=n(39),f=Object.prototype.toString,s=u(r),l=u(o),p=u(a),v=u(c),d=u(i);function b(t){return f.call(t)}(r&&"[object DataView]"!=b(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=b(new o)||a&&"[object Promise]"!=b(a.resolve())||c&&"[object Set]"!=b(new c)||i&&"[object WeakMap]"!=b(new i))&&(b=function(t){var e=f.call(t),n="[object Object]"==e?t.constructor:void 0,r=n?u(n):void 0;if(r)switch(r){case s:return"[object DataView]";case l:return"[object Map]";case p:return"[object Promise]";case v:return"[object Set]";case d:return"[object WeakMap]"}return e}),t.exports=b},,function(t,e,n){var r=n(5),o=n(10),a="[object String]",c=Object.prototype.toString;t.exports=function(t){return"string"==typeof t||!r(t)&&o(t)&&c.call(t)==a}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},function(t,e,n){var r=n(13),o=n(98),a=n(99),c=n(100),i=n(101),u=n(102);function f(t){this.__data__=new r(t)}f.prototype.clear=o,f.prototype.delete=a,f.prototype.get=c,f.prototype.has=i,f.prototype.set=u,t.exports=f},function(t,e,n){var r=n(4).Symbol;t.exports=r},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}},,,,,,function(t,e){var n=Object.getPrototypeOf;t.exports=function(t){return n(Object(t))}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},,function(t,e,n){var r=n(76),o=n(127),a=1,c=2;t.exports=function(t,e,n,i,u,f){var s=u&c,l=t.length,p=e.length;if(l!=p&&!(s&&p>l))return!1;var v=f.get(t);if(v)return v==e;var d=-1,b=!0,h=u&a?new r:void 0;for(f.set(t,e);++d<l;){var y=t[d],g=e[d];if(i)var x=s?i(g,y,d,e,t,f):i(y,g,d,t,e,f);if(void 0!==x){if(x)continue;b=!1;break}if(h){if(!o(e,function(t,e){if(!h.has(e)&&(y===t||n(y,t,i,u,f)))return h.add(e)})){b=!1;break}}else if(y!==g&&!n(y,g,i,u,f)){b=!1;break}}return f.delete(t),b}},,,,function(t,e,n){var r=n(19),o=n(6),a=n(22),c=NaN,i=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,f=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(a(t))return c;if(o(t)){var e=r(t.valueOf)?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var n=f.test(t);return n||s.test(t)?l(t.slice(2),n?2:8):u.test(t)?c:+t}},,function(t,e,n){var r=n(17),o=n(10);t.exports=function(t){return o(t)&&r(t)}},function(t,e,n){var r=n(33),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var a=t[e];o.call(t,e)&&r(a,n)&&(void 0!==n||e in t)||(t[e]=n)}},function(t,e){t.exports=function(t,e,n,r){var o=-1,a=t.length;for(r&&a&&(n=t[++o]);++o<a;)n=e(n,t[o],o,t);return n}},function(t,e,n){var r=n(126),o=n(6),a=n(10);t.exports=function t(e,n,c,i,u){return e===n||(null==e||null==n||!o(e)&&!a(n)?e!=e&&n!=n:r(e,n,t,c,i,u))}},function(t,e,n){var r=n(4).Uint8Array;t.exports=r},function(t,e,n){var r=n(82),o=n(29),a=n(5),c=n(20),i=n(44);t.exports=function(t){var e=t?t.length:void 0;return c(e)&&(a(t)||i(t)||o(t))?r(e,String):null}},function(t,e,n){var r=n(8)(n(4),"Set");t.exports=r},function(t,e,n){var r=n(5),o=n(22),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,c=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!o(t))||c.test(t)||!a.test(t)||null!=e&&t in Object(e)}},,,function(t,e,n){var r=n(55)("length");t.exports=r},function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}},,function(t,e,n){var r=n(31),o=n(120),a=n(121);function c(t){var e=-1,n=t?t.length:0;for(this.__data__=new r;++e<n;)this.add(t[e])}c.prototype.add=c.prototype.push=o,c.prototype.has=a,t.exports=c},function(t,e,n){var r=n(64);t.exports=function(t,e,n,o){n||(n={});for(var a=-1,c=e.length;++a<c;){var i=e[a],u=o?o(n[i],t[i],i,n,t):t[i];r(n,i,u)}return n}},,,,function(t,e){var n=Object.keys;t.exports=function(t){return n(Object(t))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},,,,function(t,e,n){var r=n(19),o=n(28),a=n(6),c=n(39),i=/^\[object .+?Constructor\]$/,u=Object.prototype,f=Function.prototype.toString,s=u.hasOwnProperty,l=RegExp("^"+f.call(s).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!!a(t)&&(r(t)||o(t)?l:i).test(c(t))}},function(t,e){t.exports=function(t){return t&&t.Object===Object?t:null}},function(t,e,n){var r=n(8)(n(4),"DataView");t.exports=r},function(t,e,n){var r=n(8)(n(4),"Promise");t.exports=r},function(t,e,n){var r=n(8)(n(4),"WeakMap");t.exports=r},,function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},function(t,e){t.exports=function(){this.__data__=[]}},function(t,e,n){var r=n(14),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():o.call(e,n,1),0))}},function(t,e,n){var r=n(14);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(14);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(14);t.exports=function(t,e){var n=this.__data__,o=r(n,t);return o<0?n.push([t,e]):n[o][1]=e,this}},function(t,e,n){var r=n(13);t.exports=function(){this.__data__=new r}},function(t,e){t.exports=function(t){return this.__data__.delete(t)}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(13),o=n(31),a=200;t.exports=function(t,e){var n=this.__data__;return n instanceof r&&n.__data__.length==a&&(n=this.__data__=new o(n.__data__)),n.set(t,e),this}},function(t,e,n){var r=n(104),o=n(13),a=n(40);t.exports=function(){this.__data__={hash:new r,map:new(a||o),string:new r}}},function(t,e,n){var r=n(105),o=n(106),a=n(107),c=n(108),i=n(109);function u(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=c,u.prototype.set=i,t.exports=u},function(t,e,n){var r=n(15);t.exports=function(){this.__data__=r?r(null):{}}},function(t,e){t.exports=function(t){return this.has(t)&&delete this.__data__[t]}},function(t,e,n){var r=n(15),o="__lodash_hash_undefined__",a=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===o?void 0:n}return a.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(15),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:o.call(e,t)}},function(t,e,n){var r=n(15),o="__lodash_hash_undefined__";t.exports=function(t,e){return this.__data__[t]=r&&void 0===e?o:e,this}},function(t,e,n){var r=n(16);t.exports=function(t){return r(this,t).delete(t)}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(16);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(16);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(16);t.exports=function(t,e){return r(this,t).set(t,e),this}},function(t,e,n){var r=n(67);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},,,,,function(t,e){var n="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,n),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},,,,,function(t,e,n){var r=n(46),o=n(57),a=n(128),c=n(129),i=n(42),u=n(5),f=n(28),s=n(130),l=2,p="[object Arguments]",v="[object Array]",d="[object Object]",b=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,h,y,g){var x=u(t),j=u(e),_=v,w=v;x||(_=(_=i(t))==p?d:_),j||(w=(w=i(e))==p?d:w);var m=_==d&&!f(t),O=w==d&&!f(e),S=_==w;if(S&&!m)return g||(g=new r),x||s(t)?o(t,e,n,h,y,g):a(t,e,_,n,h,y,g);if(!(y&l)){var A=m&&b.call(t,"__wrapped__"),C=O&&b.call(e,"__wrapped__");if(A||C){var I=A?t.value():t,R=C?e.value():e;return g||(g=new r),n(I,R,h,y,g)}}return!!S&&(g||(g=new r),c(t,e,n,h,y,g))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},function(t,e,n){var r=n(47),o=n(67),a=n(57),c=n(48),i=n(45),u=1,f=2,s="[object Boolean]",l="[object Date]",p="[object Error]",v="[object Map]",d="[object Number]",b="[object RegExp]",h="[object Set]",y="[object String]",g="[object Symbol]",x="[object ArrayBuffer]",j="[object DataView]",_=r?r.prototype:void 0,w=_?_.valueOf:void 0;t.exports=function(t,e,n,r,_,m,O){switch(n){case j:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case x:return!(t.byteLength!=e.byteLength||!r(new o(t),new o(e)));case s:case l:return+t==+e;case p:return t.name==e.name&&t.message==e.message;case d:return t!=+t?e!=+e:t==+e;case b:case y:return t==e+"";case v:var S=c;case h:var A=m&f;if(S||(S=i),t.size!=e.size&&!A)return!1;var C=O.get(t);return C?C==e:(m|=u,O.set(t,e),a(S(t),S(e),r,_,m,O));case g:if(w)return w.call(t)==w.call(e)}return!1}},function(t,e,n){var r=n(41),o=n(12),a=2;t.exports=function(t,e,n,c,i,u){var f=i&a,s=o(t),l=s.length;if(l!=o(e).length&&!f)return!1;for(var p=l;p--;){var v=s[p];if(!(f?v in e:r(e,v)))return!1}var d=u.get(t);if(d)return d==e;var b=!0;u.set(t,e);for(var h=f;++p<l;){var y=t[v=s[p]],g=e[v];if(c)var x=f?c(g,y,v,e,t,u):c(y,g,v,t,e,u);if(!(void 0===x?y===g||n(y,g,c,i,u):x)){b=!1;break}h||(h="constructor"==v)}if(b&&!h){var j=t.constructor,_=e.constructor;j!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof j&&j instanceof j&&"function"==typeof _&&_ instanceof _)&&(b=!1)}return u.delete(t),b}},function(t,e,n){var r=n(20),o=n(10),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1;var c=Object.prototype.toString;t.exports=function(t){return o(t)&&r(t.length)&&!!a[c.call(t)]}},,,,,,,,,,,,,,function(t,e){t.exports=Zepto},,,function(t,e,n){var r=n(6),o=n(180),a=n(61),c="Expected a function",i=Math.max,u=Math.min;t.exports=function(t,e,n){var f,s,l,p,v,d=0,b=0,h=!1,y=!1,g=!0;if("function"!=typeof t)throw new TypeError(c);function x(e){var n=f,r=s;return f=s=void 0,b=e,p=t.apply(r,n)}function j(t){var n=t-d;return!d||n>=e||n<0||y&&t-b>=l}function _(){var t=o();if(j(t))return w(t);v=setTimeout(_,function(t){var n=e-(t-d);return y?u(n,l-(t-b)):n}(t))}function w(t){return clearTimeout(v),v=void 0,g&&f?x(t):(f=s=void 0,p)}function m(){var t=o(),n=j(t);if(f=arguments,s=this,d=t,n){if(void 0===v)return function(t){return b=t,v=setTimeout(_,e),h?x(t):p}(d);if(y)return clearTimeout(v),v=setTimeout(_,e),x(d)}return void 0===v&&(v=setTimeout(_,e)),p}return e=a(e)||0,r(n)&&(h=!!n.leading,l=(y="maxWait"in n)?i(a(n.maxWait)||0,e):l,g="trailing"in n?!!n.trailing:g),m.cancel=function(){void 0!==v&&clearTimeout(v),d=b=0,f=s=v=void 0},m.flush=function(){return void 0===v?p:w(o())},m}},,,,function(t,e,n){var r=n(240),o=n(246),a=n(195),c=n(5),i=n(252);t.exports=function(t){return"function"==typeof t?t:null==t?a:"object"==typeof t?c(t)?o(t[0],t[1]):r(t):i(t)}},function(t,e){var n=Object.getOwnPropertySymbols;function r(t){return n(Object(t))}n||(r=function(){return[]}),t.exports=r},,,,function(t,e,n){var r=n(157),o=n(70),a=n(30);t.exports=function(t,e){for(var n=0,c=(e=o(e,t)?[e]:r(e)).length;null!=t&&n<c;)t=t[a(e[n++])];return n&&n==c?t:void 0}},function(t,e,n){var r=n(5),o=n(247);t.exports=function(t){return r(t)?t:o(t)}},,function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length;++n<r&&!1!==e(t[n],n,t););return t}},,,,function(t,e,n){var r=n(6);t.exports=function(t){return t==t&&!r(t)}},function(t,e){t.exports=function(t,e){return function(n){return null!=n&&n[t]===e&&(void 0!==e||t in Object(n))}}},,,,,function(t,e,n){(function(t){var r=n(179),o=n(4),a={function:!0,object:!0},c=a[typeof e]&&e&&!e.nodeType?e:void 0,i=a[typeof t]&&t&&!t.nodeType?t:void 0,u=(i&&i.exports===c?c:void 0)?o.Buffer:void 0,f=u?function(t){return t instanceof u}:r(!1);t.exports=f}).call(e,n(32)(t))},,,,,,,,,,function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var n=Date.now;t.exports=n},,,,,,,,,,,,function(t,e,n){var r=n(46),o=n(159),a=n(64),c=n(197),i=n(198),u=n(199),f=n(200),s=n(201),l=n(42),p=n(203),v=n(204),d=n(213),b=n(5),h=n(169),y=n(28),g=n(6),x=n(12),j="[object Arguments]",_="[object Function]",w="[object GeneratorFunction]",m="[object Object]",O={};O[j]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object DataView]"]=O["[object Boolean]"]=O["[object Date]"]=O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Map]"]=O["[object Number]"]=O[m]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object Symbol]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O["[object Error]"]=O[_]=O["[object WeakMap]"]=!1,t.exports=function t(e,n,S,A,C,I,R){var E;if(A&&(E=I?A(e,C,I,R):A(e)),void 0!==E)return E;if(!g(e))return e;var U=b(e);if(U){if(E=p(e),!n)return u(e,E)}else{var P=l(e),T=P==_||P==w;if(h(e))return i(e,n);if(P==m||P==j||T&&!I){if(y(e))return I?e:{};if(E=d(T?{}:e),!n)return f(e,c(E,e))}else{if(!O[P])return I?e:{};E=v(e,P,t,n)}}R||(R=new r);var M=R.get(e);if(M)return M;if(R.set(e,E),!U)var k=S?s(e):x(e);return o(k||e,function(r,o){k&&(r=e[o=r]),a(E,o,t(r,n,S,A,o,e,R))}),E}},function(t,e,n){var r=n(194);t.exports=function(t){return null==t?"":r(t)}},function(t,e,n){var r=n(47),o=n(22),a=1/0,c=r?r.prototype:void 0,i=c?c.toString:void 0;t.exports=function(t){if("string"==typeof t)return t;if(o(t))return i?i.call(t):"";var e=t+"";return"0"==e&&1/t==-a?"-0":e}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(192);t.exports=function(t){return r(t,!0,!0)}},function(t,e,n){var r=n(77),o=n(12);t.exports=function(t,e){return t&&r(e,o(e),t)}},function(t,e){t.exports=function(t,e){if(e)return t.slice();var n=new t.constructor(t.length);return t.copy(n),n}},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},function(t,e,n){var r=n(77),o=n(152);t.exports=function(t,e){return r(t,o(t),e)}},function(t,e,n){var r=n(202),o=n(152),a=n(12);t.exports=function(t){return r(t,a,o)}},function(t,e,n){var r=n(92),o=n(5);t.exports=function(t,e,n){var a=e(t);return o(t)?a:r(a,n(t))}},function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,r=t.constructor(e);return e&&"string"==typeof t[0]&&n.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},function(t,e,n){var r=n(115),o=n(205),a=n(206),c=n(208),i=n(209),u=n(211),f=n(212),s="[object Boolean]",l="[object Date]",p="[object Map]",v="[object Number]",d="[object RegExp]",b="[object Set]",h="[object String]",y="[object Symbol]",g="[object ArrayBuffer]",x="[object DataView]",j="[object Float32Array]",_="[object Float64Array]",w="[object Int8Array]",m="[object Int16Array]",O="[object Int32Array]",S="[object Uint8Array]",A="[object Uint8ClampedArray]",C="[object Uint16Array]",I="[object Uint32Array]";t.exports=function(t,e,n,R){var E=t.constructor;switch(e){case g:return r(t);case s:case l:return new E(+t);case x:return o(t,R);case j:case _:case w:case m:case O:case S:case A:case C:case I:return f(t,R);case p:return a(t,R,n);case v:case h:return new E(t);case d:return c(t);case b:return i(t,R,n);case y:return u(t)}}},function(t,e,n){var r=n(115);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},function(t,e,n){var r=n(207),o=n(65),a=n(48);t.exports=function(t,e,n){var c=e?n(a(t),!0):a(t);return o(c,r,new t.constructor)}},function(t,e){t.exports=function(t,e){return t.set(e[0],e[1]),t}},function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,n){var r=n(210),o=n(65),a=n(45);t.exports=function(t,e,n){var c=e?n(a(t),!0):a(t);return o(c,r,new t.constructor)}},function(t,e){t.exports=function(t,e){return t.add(e),t}},function(t,e,n){var r=n(47),o=r?r.prototype:void 0,a=o?o.valueOf:void 0;t.exports=function(t){return a?Object(a.call(t)):{}}},function(t,e,n){var r=n(115);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e,n){var r=n(214),o=n(54),a=n(36);t.exports=function(t){return"function"!=typeof t.constructor||a(t)?{}:r(o(t))}},function(t,e,n){var r=n(6),o=Object.create;t.exports=function(t){return r(t)?o(t):{}}},function(t,e,n){var r=n(301),o=n(302)(r);t.exports=o},,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(243)(n(12));t.exports=r},function(t,e,n){var r=n(156);t.exports=function(t,e,n){var o=null==t?void 0:r(t,e);return void 0===o?n:o}},,,,function(t,e,n){var r=n(241),o=n(242),a=n(164);t.exports=function(t){var e=o(t);return 1==e.length&&e[0][2]?a(e[0][0],e[0][1]):function(n){return n===t||r(n,t,e)}}},function(t,e,n){var r=n(46),o=n(66),a=1,c=2;t.exports=function(t,e,n,i){var u=n.length,f=u,s=!i;if(null==t)return!f;for(t=Object(t);u--;){var l=n[u];if(s&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++u<f;){var p=(l=n[u])[0],v=t[p],d=l[1];if(s&&l[2]){if(void 0===v&&!(p in t))return!1}else{var b=new r;if(i)var h=i(v,d,p,t,e,b);if(!(void 0===h?o(d,v,i,a|c,b):h))return!1}}return!0}},function(t,e,n){var r=n(163),o=n(235);t.exports=function(t){for(var e=o(t),n=e.length;n--;)e[n][2]=r(e[n][1]);return e}},function(t,e,n){var r=n(244),o=n(42),a=n(48),c=n(245),i="[object Map]",u="[object Set]";t.exports=function(t){return function(e){var n=o(e);return n==i?a(e):n==u?c(e):r(e,t(e))}}},function(t,e,n){var r=n(74);t.exports=function(t,e){return r(e,function(e){return[e,t[e]]})}},function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=[t,t]}),n}},function(t,e,n){var r=n(66),o=n(236),a=n(249),c=n(70),i=n(163),u=n(164),f=n(30),s=1,l=2;t.exports=function(t,e){return c(t)&&i(e)?u(f(t),e):function(n){var c=o(n,t);return void 0===c&&c===e?a(n,t):r(e,c,void 0,s|l)}}},function(t,e,n){var r=n(248),o=n(193),a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,c=/\\(\\)?/g,i=r(function(t){var e=[];return o(t).replace(a,function(t,n,r,o){e.push(r?o.replace(c,"$1"):n||t)}),e});t.exports=i},function(t,e,n){var r=n(31),o="Expected a function";function a(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(o);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],a=n.cache;if(a.has(o))return a.get(o);var c=t.apply(this,r);return n.cache=a.set(o,c),c};return n.cache=new(a.Cache||r),n}a.Cache=r,t.exports=a},function(t,e,n){var r=n(250),o=n(251);t.exports=function(t,e){return null!=t&&o(t,e,r)}},function(t,e){t.exports=function(t,e){return e in Object(t)}},function(t,e,n){var r=n(157),o=n(29),a=n(5),c=n(34),i=n(70),u=n(20),f=n(44),s=n(30);t.exports=function(t,e,n){for(var l,p=-1,v=(e=i(e,t)?[e]:r(e)).length;++p<v;){var d=s(e[p]);if(!(l=null!=t&&n(t,d)))break;t=t[d]}return l||!!(v=t?t.length:0)&&u(v)&&c(d,v)&&(a(t)||f(t)||o(t))}},function(t,e,n){var r=n(55),o=n(253),a=n(70),c=n(30);t.exports=function(t){return a(t)?r(c(t)):o(t)}},function(t,e,n){var r=n(156);t.exports=function(t){return function(e){return r(e,t)}}},function(t,e,n){var r=n(275)();t.exports=r},,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports=function(t){return function(e,n,r){for(var o=-1,a=Object(e),c=r(e),i=c.length;i--;){var u=c[t?i:++o];if(!1===n(a[u],u,a))break}return e}}},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(254),o=n(12);t.exports=function(t,e){return t&&r(t,e,o)}},function(t,e,n){var r=n(17);t.exports=function(t,e){return function(n,o){if(null==n)return n;if(!r(n))return t(n,o);for(var a=n.length,c=e?a:-1,i=Object(n);(e?c--:++c<a)&&!1!==o(i[c],c,i););return n}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(159),o=n(215),a=n(151),c=n(5);t.exports=function(t,e){return(c(t)?r:o)(t,a(e,3))}},,,,,,,function(t,e){t.exports=function(t,e,n){for(var r=t.length,o=n?r:-1;n?o--:++o<r;)if(e(t[o],o,t))return o;return-1}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var o=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},function(t,e){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);t.exports=function(t,e){var r=e||0,o=n;return[o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]]].join("")}},,,,,,,,,,,,,,,,,,function(t,e){t.exports=function(t){var e=t?t.length:0;return e?t[e-1]:void 0}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(254),o=n(151),a=n(521);t.exports=function(t,e){return null==t?t:r(t,o(e,3),a)}},function(t,e,n){var r=n(547),o=n(68),a=n(34),c=n(36),i=Object.prototype.hasOwnProperty;t.exports=function(t){for(var e=-1,n=c(t),u=r(t),f=u.length,s=o(t),l=!!s,p=s||[],v=p.length;++e<f;){var d=u[e];l&&("length"==d||a(d,v))||"constructor"==d&&(n||!i.call(t,d))||p.push(d)}return p}},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){var r=n(548),o=n(549),a=Object.prototype,c=r?r.enumerate:void 0,i=a.propertyIsEnumerable;function u(t){t=null==t?t:Object(t);var e=[];for(var n in t)e.push(n);return e}c&&!i.call({valueOf:1},"valueOf")&&(u=function(t){return o(c(t))}),t.exports=u},function(t,e,n){var r=n(4).Reflect;t.exports=r},function(t,e){t.exports=function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}},function(t,e,n){var r=n(215),o=n(551),a=n(380),c=n(151),i=n(5);t.exports=function(t,e){if(e=c(e,3),i(t)){var n=a(t,e);return n>-1?t[n]:void 0}return o(t,e,r)}},function(t,e){t.exports=function(t,e,n,r){var o;return n(t,function(t,n,a){if(e(t,n,a))return o=r?n:t,!1}),o}},function(t,e,n){var r=n(553),o=n(554),a=o;a.v1=r,a.v4=o,t.exports=a},function(t,e,n){var r,o,a=n(454),c=n(455),i=0,u=0;t.exports=function(t,e,n){var f=e&&n||0,s=e||[],l=(t=t||{}).node||r,p=void 0!==t.clockseq?t.clockseq:o;if(null==l||null==p){var v=a();null==l&&(l=r=[1|v[0],v[1],v[2],v[3],v[4],v[5]]),null==p&&(p=o=16383&(v[6]<<8|v[7]))}var d=void 0!==t.msecs?t.msecs:(new Date).getTime(),b=void 0!==t.nsecs?t.nsecs:u+1,h=d-i+(b-u)/1e4;if(h<0&&void 0===t.clockseq&&(p=p+1&16383),(h<0||d>i)&&void 0===t.nsecs&&(b=0),b>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");i=d,u=b,o=p;var y=(1e4*(268435455&(d+=122192928e5))+b)%4294967296;s[f++]=y>>>24&255,s[f++]=y>>>16&255,s[f++]=y>>>8&255,s[f++]=255&y;var g=d/4294967296*1e4&268435455;s[f++]=g>>>8&255,s[f++]=255&g,s[f++]=g>>>24&15|16,s[f++]=g>>>16&255,s[f++]=p>>>8|128,s[f++]=255&p;for(var x=0;x<6;++x)s[f+x]=l[x];return e||c(s)}},function(t,e,n){var r=n(454),o=n(455);t.exports=function(t,e,n){var a=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var c=(t=t||{}).random||(t.rng||r)();if(c[6]=15&c[6]|64,c[8]=63&c[8]|128,e)for(var i=0;i<16;++i)e[a+i]=c[i];return e||o(c)}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports=function(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var a=Array(o);++r<o;)a[r]=t[r+e];return a}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"Helper",function(){return y});var r=n(2),o=(n.n(r),n(704)),a=n(708),c=n(1),i=n.n(c),u=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=r.sheets,s=f.root,l=f.path,p=f.Events,v=f.Plugin,d=l.setByPath,b=(r.Editor,"Collaborators"),h=function(t){function e(n){var r=n.editor,o=t.call(this,{name:b,Constructor:e,config:arguments[0]})||this;return o.updateCollabName=function(t){var e=t.cell;if(e){var n=o.editor.spread.gcSpread.getActiveSheet(),r=o.collaborators,c=n.getSpan(e.row,e.col);Object(a.e)({sheet:n,collaborators:r},c||e)}},o.updateCollab=function(){if(o.editor.isRendered){var t=o.editor.spread.gcSpread.getActiveSheet(),e=o.collaborators;Object(a.f)({sheet:t,collaborators:e})}},o.updateCollabAfterRowOrColChanged=function(){var t=o.editor.spread.gcSpread.getActiveSheet(),e=o.collaborators;Object(a.g)({sheet:t,collaborators:e})},o.editor=r,o._dataManage=o._initManager(),o._listenEditorEvents(),o.install(),o}return u(e,t),e.prototype.setLocale=function(t){i.a.setLocaleSync(t)},e.prototype.onUserSelect=function(t){"sheet"===t.docType&&this._dataManage.onReceiveSelected(t)},e.prototype.onUserLeave=function(t){var e=this;t.leaveUsers.forEach(function(t){e._dataManage.onUserLeave(t)})},Object.defineProperty(e.prototype,"collaborators",{get:function(){return this._dataManage.collaborators},enumerable:!0,configurable:!0}),e.prototype._initManager=function(){var t=new o.a;return t.onUpdateUI(this.updateCollab),t},e.prototype._listenEditorEvents=function(){var t=this;this.editor.on(p.AfterHoveredCellChanged,this.updateCollabName),this.editor.on(p.SheetSwitched,this.updateCollab),this.editor.on(p.AfterSelectedCellChanged,function(e){var n=e.cell,r=e.sheet,o=n.row,a=n.col,c={row:o,col:a,endRow:o,endCol:a};t.emit("userSelect",{docType:"sheet",range:c,sheetId:r.guid()})}),this.editor.on(p.AfterSelectionChanged,this.updateCollab),this.editor.on(p.RowOrColChanged,this.updateCollabAfterRowOrColChanged),this.editor.on(p.AfterChangeApplied,this.updateCollabAfterRowOrColChanged),this.editor.on(p.OnCalcOperator,this.updateCollab)},e}(v);e.default=h;var y={addCollabBorder:a.a,removeCollabName:a.d,addCollabName:a.b,removeAllCollabs:a.c};d(s,"shimo.sdk.sheet.plugins.Collaborators",h)},function(t,e,n){"use strict";var r=n(705),o=n.n(r),a=n(196),c=n.n(a),i=n(147),u=n.n(i),f=n(1),s=n.n(f),l=function(){},p=function(){function t(){var t=this;this.sendOnSelect=l,this._triggerUpdateUI=u()(function(){"function"==typeof t._onUpdateUI&&t._onUpdateUI(t._collaborators)},500,{maxWait:5e3}),this._collaborators={}}return t.prototype.onUpdateUI=function(t){this._onUpdateUI=t},t.prototype.onReceiveSelected=function(t){var e=c()(this._collaborators);e=function(t,e){var n=e.sheetId;e.userInfo.id<0&&(e.userInfo.name=s()("路人"));var r,a=0,c=0;t[n]||(t[n]=[]);for(r=t[n],a=0,c=r.length;a<c;a++)if(e.userInfo.id===r[a].userInfo.id){r[a].range=e.range;break}a===c&&r.push(e);for(var i in t)if(i!==n+""){var u=t[i];o()(u,function(t){return t.userInfo.id===e.userInfo.id})}return t}(e,t),this._updateData(e)},t.prototype.onUserLeave=function(t){var e=c()(this._collaborators);e=function(t,e){for(var n in t){var r=t[n];o()(r,function(t){return t.userInfo.id===e.id})}return t}(e,t),this._updateData(e)},Object.defineProperty(t.prototype,"collaborators",{get:function(){return this._collaborators},enumerable:!0,configurable:!0}),t.prototype._updateData=function(t){this._collaborators=t,this._triggerUpdateUI()},t}();e.a=p},function(t,e,n){var r=n(151),o=n(706);t.exports=function(t,e){var n=[];if(!t||!t.length)return n;var a=-1,c=[],i=t.length;for(e=r(e,3);++a<i;){var u=t[a];e(u,a,t)&&(n.push(u),c.push(a))}return o(t,c),n}},function(t,e,n){var r=n(157),o=n(34),a=n(70),c=n(473),i=n(707),u=n(30),f=Array.prototype.splice;t.exports=function(t,e){for(var n=t?e.length:0,s=n-1;n--;){var l=e[n];if(n==s||l!==p){var p=l;if(o(l))f.call(t,l,1);else if(a(l,t))delete t[u(l)];else{var v=r(l),d=i(t,v);null!=d&&delete d[u(c(v))]}}}return t}},function(t,e,n){var r=n(156),o=n(649);t.exports=function(t,e){return 1==e.length?t:r(t,o(e,0,-1))}},function(t,e,n){"use strict";(function(t){e.c=function(t){var e=t.floatingObjects,n=e.all();c()(n,function(t){var n=t._ps.name;n.match(/^collab-/)&&e.remove(n)})},e.f=function(t){var e=t.sheet,n=t.collaborators,r=y(e,n),o=r.collabIdsToRemove,a=r.collabsToUpdate;(o.length||a.length)&&v({obj:e,func:g})(e,{collabIdsToRemove:o,collabsToUpdate:a})},e.e=x,e.d=j,e.b=_,e.a=w,e.g=function(t){var e=t.sheet,n=t.collaborators;(function(t){var e=t.sheet,n=t.collaborators,r=e.guid(),o=n[r]||[],a=o.map(function(t){var e=t.userInfo;return""+e.id});O(e).forEach(function(t){var e=""+A(t.name()),n=a.indexOf(e);if(n>-1){var r=o[n],c=t._ps,i=c.startRow,u=c.startColumn;r.range={row:i,col:u,endRow:i,endCol:u}}})})({sheet:e,collaborators:n}),function(t){var e=t.sheet,n=t.collaborators,r=y(e,n);g(e,r)}({sheet:e,collaborators:n}),function(t){var e=t.sheet,n=t.collaborators,r=m(e);r&&x({sheet:e,collaborators:n},{row:r.startRow(),col:r.startColumn()})}({sheet:e,collaborators:n})};var r=n(520),o=n.n(r),a=n(373),c=n.n(a),i=n(709),u=n.n(i),f=n(550),s=n.n(f),l=n(2),p=(n.n(l),n(552)),v=(n.n(p),l.sheets.perf.paintWrap),d=l.sheets.Core,b=130,h={row:0,col:0,endRow:0,endCol:0};function y(t,e){var n=e[t.guid()]||[],r=n.map(function(t){return""+t.userInfo.id}),o={collabIdsToRemove:[],collabsToUpdate:[]};return O(t).forEach(function(t){var e=""+A(t.name());-1===r.indexOf(e)&&o.collabIdsToRemove.push(e)}),n.forEach(function(e){var n=e.userInfo,r=e.range;if(function(t,e){var n=void 0===e?h:e,r=n.row,o=n.col,a=t.filterRowsVisibleInfo,c=a?a.rowsVisibleInfo:{},i=t.attrs||{},u=i.rowVisible,f=void 0===u?[]:u,l=i.colVisible,p=void 0===l?[]:l,v=!1===c[r],d=!!s()(f,function(t){var e=t[0],n=t[1];return r>=e&&r<=n}),b=!!s()(p,function(t){var e=t[0],n=t[1];return o>=e&&o<=n});return v||d||b}(t,r)){var a=""+n.id;o.collabIdsToRemove.push(a)}else o.collabsToUpdate.push(e)}),o}function g(t,e){var n=e.collabIdsToRemove,r=e.collabsToUpdate;n.forEach(function(e){!function(t,e){var n="collab-border-"+e,r=t.floatingObjects;r.get(n)&&r.remove(n)}(t,e)}),r.forEach(function(e){var n=e.userInfo,r=e.range,a=""+n.id,c=S(t,a);c?function(t,e,n){var r=C(t,n);o()(r,function(t,n){t!==e[n]()&&e[n](t)})}(t,c,r):w(t,{userInfo:n,range:r})})}function x(t,e){for(var n,r=t.sheet,o=t.collaborators,a=e.row,c=e.col,i=o[""+r.guid()]||[],u=0,f=i.length;u<f;u++){var s=i[u].range||h;if(s.row===a&&s.col===c){n=i[u];break}}j(r),n&&S(r,""+n.userInfo.id)&&_(r,{range:n.range,userInfo:n.userInfo})}function j(t){var e=t.floatingObjects,n=m(t);n&&e.remove(n.name())}function _(e,n){var r=n.range,a=n.userInfo,c=a.name,i=a.color,u=function(e){return t("#font-container").text(e).css("font-size","9pt").width()}(c)||0,f=Math.min(u+8,b),s=new d.Spread.Sheets.FloatingObjects.FloatingObject("collab-name-"+Object(p.v4)(),0,0,f,18),l=document.createElement("div"),v=l.style;s.range=r;var h=function(t,e){var n=e.range||{},r=e.width(),o=e.height(),a=I(t,n),c=a.row,i=a.col,u=a.rangeWidth,f=0===c||t._scrollTopRow===c;return{startRow:c,startColumn:i,startRowOffset:f?0:-o,startColumnOffset:u+1-r}}(e,s);s.dynamicSize(!1),s.allowMove(!1),s.allowResize(!1),s.disableSelect(!0),v.background=i,l.innerText=c,l.className="collab-floating-object collab-floating-name",s.content(l),o()(h,function(t,e){s[e](t)}),e.floatingObjects.add(s)}function w(t,e,n){var r=e.range,a=e.userInfo,c=a.id,i=a.color,u="collab-border-"+(n?Object(p.v4)():c),f=i,s=C(t,r),l=new d.Spread.Sheets.FloatingObjects.FloatingObject(u),v=document.createElement("div"),b=v.style;l.dynamicMove(!0),l.dynamicSize(!1),l.allowMove(!1),l.allowResize(!1),l.disableSelect(!0),b.borderColor=f,v.className="collab-floating-object collab-floating-border",l.content(v),t.floatingObjects.add(l),o()(s,function(t,e){l[e](t)})}function m(t){var e=t.floatingObjects.all();return s()(e,function(t){return(t.name()||"").match(/^collab-name/)})}function O(t){var e=t.floatingObjects.all();return u()(e,function(t){return-1!==t.name().indexOf("collab-border")})}function S(t,e){return t.floatingObjects.get("collab-border-"+e)}function A(t){return t&&t.substring(14)}function C(t,e){var n=I(t,e),r=n.row,o=n.col;return{width:n.rangeWidth+1,height:n.rangeHeight+1,startRow:r,startColumn:o,endRow:r,endColumn:o,startRowOffset:0,startColumnOffset:0}}function I(t,e){void 0===e&&(e=h);var n=e.row,r=e.col,o=e.endRow?e.endRow:n,a=e.endCol?e.endCol:r,c=0,i=0,u=t.getSpan(n,r);if(u){var f=u.rowCount,s=u.colCount;o=(n=u.row)+f-1,a=(r=u.col)+s-1}for(var l=n;l<=o;l++)c+=t.getRowHeight(l,3,!0);for(l=r;l<=a;l++)i+=t.getColumnWidth(l);return{row:n,col:r,endRow:o,endCol:a,rangeWidth:i,rangeHeight:c}}}).call(e,n(144))},function(t,e,n){var r=n(710),o=n(711),a=n(151),c=n(5);t.exports=function(t,e){return(c(t)?r:o)(t,a(e,3))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length,o=0,a=[];++n<r;){var c=t[n];e(c,n,t)&&(a[o++]=c)}return a}},function(t,e,n){var r=n(215);t.exports=function(t,e){var n=[];return r(t,function(t,r,o){e(t,r,o)&&n.push(t)}),n}}])});