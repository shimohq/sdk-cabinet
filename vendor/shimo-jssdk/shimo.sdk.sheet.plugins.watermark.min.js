!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="https://assets.smcdn.cn/sheet/",r(r.s=2085)}({1:function(e,t,r){"use strict";var n=function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{s(n.next(e))}catch(e){i(e)}}function u(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){e.done?o(e.value):function(e){return e instanceof r?e:new r(function(t){t(e)})}(e.value).then(a,u)}s((n=n.apply(e,t||[])).next())})},i=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n};Object.defineProperty(t,"__esModule",{value:!0});var u=r(18),s=r(38),c={},f=function(e){return c[e]||(c[e]=h()),c[e]};t.getS18n=f;var l=function(){c={}};t.DEBUG_reset=l;var p=function(){return c};t.DEBUG_getInstances=p;var h=function(){var e,t,r="zh-CN",c="zh-CN",h={},d=function(e,t){if(!u.isValidLocaleResource(t))throw new Error("fetched locale resource is invalid");h[e]=n(n({},h[e]||{}),t)},y=function(e,r){return o(void 0,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return!r&&h[e]?[3,2]:t?[4,t(e)]:[3,2];case 1:n=o.sent(),d(e,n),o.label=2;case 2:return[2]}})})},v=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if("string"==typeof e[0]){var n=e[0],o=e[1],i=o&&"string"==typeof o._?o._:void 0,u=i?n+"#"+i:n;if(!u)return"";var f=s.getTextResult(u,h[r]);if("string"==typeof f)return f;var l=s.getTextResult(u,h[c]);return"string"==typeof l?l:n}if(e[0]&&"number"==typeof e[0].length){var p=e[0],d=e.slice(1);return s.getInterpolateResult(p,d,h[r])||s.getInterpolateResult(p,d,h[c])||s.interweave(p,d)}return console.warn.apply(console,a(["[s18n] invalid input:"],e)),""};return v.configure=function(r){if(r.fetchLocale){if("function"!=typeof r.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");t=r.fetchLocale}if(r.fetchLocaleSync){if("function"!=typeof r.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");e=r.fetchLocaleSync}},v.addLocaleResource=d,v.setLocaleAsync=function(e,t){return o(void 0,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:if("string"!=typeof e)throw new Error("'locale' is required");return[4,y(e)];case 1:return n.sent(),r=e,"string"==typeof t&&(y(t),c=t),[2]}})})},v.setLocaleSync=function(t){if("string"!=typeof t)throw new Error("'locale' is required");if(e){var n=e(t);d(t,n)}r=t},v.getLocale=function(){return r},v.DEBUG_getLocaleResources=function(){return h},v.getS18n=f,v.DEBUG_reset=l,v.DEBUG_getInstances=p,v},d=f("__default_namespace__");e.exports=d,t.default=d},18:function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(37);t.isValidLocaleResource=function(e){return!!e&&(!Array.isArray(e)&&("object"===(void 0===e?"undefined":n(e))&&Object.keys(e).every(function(t){var r=e[t];return null==r||"string"==typeof r||"object"===(void 0===r?"undefined":n(r))})))},t.sourceTextToKey=function(e){switch(e.type){case"string":var t=e.id,r=e.text;return t?r+"#"+t:r;case"interpolated":var n=e.textParts.length;return 1===n?e.textParts[0]:2===n?e.textParts[0]+"%s"+e.textParts[1]:e.textParts.map(function(t,r){return r===e.textParts.length-1?t:t+"%"+(r+1)}).join("");default:return o.assertNever(e)}}},2:function(e,t){e.exports=shimo.sdk.sheet},2085:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2086),o=r(2),i=(r.n(o),this&&this.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}()),a=o.sheets,u=a.Plugin,s=a.path,c=a.root,f=a.Events,l=s.setByPath,p="Watermark",h=function(e){function t(r){var o=e.call(this,{name:p,Constructor:t,config:r})||this;return o.waterMark="",o.init=function(){var e=o.opts,t=e.fileGuid,r=e.watermarkApi;if(e.forceShow)return o.show();if(t){var i=r||"/lizard-api/files/"+t+"/watermark";Object(n.b)(i).then(function(e){e&&o.show()})}},o.show=function(){var e=o.opts,t=e.name,r=void 0===t?"":t,i=e.style,a=e.userId,u=void 0===a?"":a,s=o.waterMark||(o.waterMark=Object(n.a)(r,i,u).url),c=o.opts.editor;c&&c.spread&&c.spread.updateOptions({waterMark:s})},o.hide=function(){var e=o.opts.editor;e&&e.spread&&e.spread.updateOptions({waterMark:null})},o.opts=r,o.init(),o.install(),o.opts.editor.on(f.SetContentSucceeded,o.init),o}return i(t,e),t.prototype.setLocale=function(){},t}(u);t.default=h,l(c,"shimo.sdk.sheet.plugins.Watermark",h)},2086:function(e,t,r){"use strict";t.b=s,t.a=f;var n,o=r(1),i=r.n(o),a=r(2),u=(r.n(a),a.sheets.ajax);function s(e){return void 0!==n?Promise.resolve(n):u.ajax(null,{url:e,method:"GET"}).then(function(e){return n=!!e.status})}var c={fontSize:15,fontFamily:'"PingFang SC","Helvetica",'+i()('"Tahoma","Arial","Microsoft YaHei","微软雅黑","黑体","Heiti","sans-serif",')+i()('"SimSun","宋体","serif"'),fontWeight:"200",width:204,height:150,angle:-15,visibleColor:"rgba(33,33,33, 0.1)",invisibleColor:"rgba(254, 254, 254, 0.2)"};function f(e,t,r){return function(e){var t=e.fontSize,r=e.fontWeight,n=e.angle,o=e.width,a=e.height,u=document.createElement("canvas");u.width=o,u.height=a,u.style.width=o+"px",u.style.height=a+"px";var s=u.getContext("2d");if(s){var c=Math.abs(n),f=Math.cos(c*Math.PI/180),d=Math.sin(c*Math.PI/180),y=n/c*c*Math.PI/180;s.font=r+" "+t+"px sans-serif";var v=function(e,t){var r=t.measureText(i()("永永永永永永永永")).width;return{name:h(t,r,e.name),userId:e.userId&&h(t,r,e.userId)}}(e,s),b=v.name,g=v.userId,w=p(s,b,t,d,f),m=g?p(s,g,t,d,f):void 0;return Object.assign(e,{cosValue:f,sinValue:d,rotateAngle:y}),l(s,v,e,w,!0,m),l(s,v,e,w,!1,m),{url:u.toDataURL()}}return{url:""}}(Object.assign({name:e,userId:r},c,t))}function l(e,t,r,n,o,i){var a=n.width,u=n.offsetX,s=n.height,c=t.userId,f=t.name,l=r.width,p=r.height,h=r.offset,d=void 0===h?{x:0,y:0}:h,y=r.fontSize,v=r.cosValue,b=r.rotateAngle,g=r.visibleColor,w=r.invisibleColor;e.save(),e.fillStyle=o?g:w;var m=(l-a)/2+u+d.x,x=p/3*(o?1:2)+s+d.y;e.translate(m,x),e.rotate(b),e.fillText(f,0,0);var _=i?i.width:0;c&&e.fillText(c,(a-_)/2*v,y*v),e.restore()}function p(e,t,r,n,o){var i=e.measureText(t).width;return{width:r*n+i*o,height:i*n+r*o,offsetX:r*n,offsetY:i*n}}function h(e,t,r){if(e.measureText(r).width>t)for(var n=r,o=r.slice(r.length-3),i=1;i<r.length-3;i++)if(n=r.slice(0,i)+" ... "+o,e.measureText(n).width>t){r=r.slice(0,i-1)+" ... "+o;break}return r}},37:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertNever=function(e){throw new Error("unexpected type: "+JSON.stringify(e))}},38:function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(t,"__esModule",{value:!0});var o=r(18);t.interweave=function(e,t){return e.map(function(r,n){return n===e.length-1?r:""+r+t[n]}).join("")},t.getTextResult=function(e,t){return t&&t[e]};var i=/%(s|\d)/g;t.getInterpolateResult=function(e,t,r){try{if(!r)return;var a=o.sourceTextToKey({type:"interpolated",textParts:e}),u=r[a];if(!u)return;var s={},c=0;a.replace(i,function(e){return s[e]=t[c],c+=1,e});return"string"==typeof u?function(e,t){return e.replace(i,function(r){return null!==t[r]?String(t[r]):(console.warn("[s18n] interpolation failed:",{str:e,valueMap:t}),r)})}(u,s):"object"===(void 0===u?"undefined":n(u))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(u))}catch(n){var f={parts:e,values:t,resource:r};return console.error("[s18n] error when translating: ",f),void console.error(n)}}}})});