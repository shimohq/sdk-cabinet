!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://assets-cdn.shimo.im/sheet/",r(r.s=932)}([function(t,e){t.exports=React},function(t,e){t.exports=shimo.sdk.sheet},function(t,e){var r=Array.isArray;t.exports=r},function(module,exports,__webpack_require__){"use strict";var _arguments2=arguments,_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},__awaiter=function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})};Object.defineProperty(exports,"__esModule",{value:!0});var locale_1=__webpack_require__(82),interweave=function(t,e){return t.map(function(r,n){return n===t.length-1?r:""+r+e[n]}).join("")},currentLocale="zh-CN",fallbackLocale="zh-CN",localeCache={},fetchLocale=function(t){throw new Error("'fetchLocale' is not provided, see: 's18n.configure()'")},fetchLocaleSync=void 0,updateLocaleResource=function(t,e){return __awaiter(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){var n;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!e&&localeCache[t]){r.next=11;break}if(fetchLocale){r.next=3;break}throw new Error("'fetchLocale' is not provided, see: 's18n.configure()'");case 3:return r.next=5,fetchLocale(t);case 5:if(n=r.sent,locale_1.isValidLocaleResource(n)){r.next=10;break}throw new Error("fetched locale resource is invalid");case 10:localeCache[t]=n;case 11:case"end":return r.stop()}},r,this)}))},getTextResult=function(t,e){return e&&e[t]},PLACEHOLDER_RE=/%(s|\d)/g,getInterpolateResult=function getInterpolateResult(parts,values,resource){try{if(!resource)return;var key=locale_1.rawTextToKey({type:"interpolated",textParts:parts}),translation=resource[key];if(!translation)return;var valueMap={},i=0;key.replace(PLACEHOLDER_RE,function(t){return valueMap[t]=values[i],i+=1,t});var interpolate=function(t,e){return t.replace(PLACEHOLDER_RE,function(r){return null!==e[r]?String(e[r]):(console.warn("[s18n] interpolation failed:",{str:t,valueMap:e}),r)})};if("string"==typeof translation)return interpolate(translation,valueMap);if("object"===(void 0===translation?"undefined":_typeof(translation))){for(var conditions=Object.keys(translation),index=0;index<conditions.length;index++){var conditionTemplate=conditions[index],conditionInterpolated=interpolate(conditionTemplate,valueMap),passed=eval(conditionInterpolated);if(passed)return interpolate(translation[conditionTemplate],valueMap)}return}return void console.warn("[s18n] Unexpected value: "+JSON.stringify(translation))}catch(t){return console.error("[s18n] error when translating: ",_arguments2),void console.error(t)}},s18n=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];if(1===e.length){var n=e[0],o=getTextResult(n,localeCache[currentLocale]);if("string"==typeof o)return o;var i=getTextResult(n,localeCache[fallbackLocale]);return"string"==typeof i?i:n}var a=e[0],u=e.slice(1);return getInterpolateResult(a,u,localeCache[currentLocale])||getInterpolateResult(a,u,localeCache[fallbackLocale])||interweave(a,u)};s18n.configure=function(t){if(t.fetchLocale){if("function"!=typeof t.fetchLocale)throw new Error("fetchLocale should be an async function resolving with locale resource");fetchLocale=t.fetchLocale}else{if(!t.fetchLocaleSync)throw new Error("Requiring at least one parameter: fetchLocale or fetchLocaleSync");fetchLocaleSync=t.fetchLocaleSync}},s18n.setLocaleAsync=function(t,e){return __awaiter(void 0,void 0,void 0,regeneratorRuntime.mark(function r(){return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if("string"==typeof t){r.next=2;break}throw new Error("'locale' is required");case 2:return r.next=4,updateLocaleResource(t);case 4:currentLocale=t,"string"==typeof e&&(updateLocaleResource(e),fallbackLocale=e);case 6:case"end":return r.stop()}},r,this)}))},s18n.setLocaleSync=function(t){if("string"!=typeof t)throw new Error("'locale' is required");if(!fetchLocaleSync)throw new Error("'fetchLocaleSync' is not provided, see: 's18n.configure()'");var e=fetchLocaleSync(t);if(!locale_1.isValidLocaleResource(e))throw new Error("fetched locale resource is invalid");localeCache[t]=e,currentLocale=t},module.exports=s18n,exports.default=s18n},function(t,e,r){(function(t,n){var o=r(76),i={function:!0,object:!0},a=i[typeof e]&&e&&!e.nodeType?e:void 0,u=i[typeof t]&&t&&!t.nodeType?t:void 0,s=o(a&&u&&"object"==typeof n&&n),c=o(i[typeof self]&&self),f=o(i[typeof window]&&window),l=o(i[typeof this]&&this),p=s||f!==(l&&l.window)&&f||c||l||Function("return this")();t.exports=p}).call(e,r(27)(t),r(20))},function(t,e){t.exports=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}},function(t,e){t.exports=function(t){return!!t&&"object"==typeof t}},function(t,e,r){var n=r(75);t.exports=function(t,e){var r=t[e];return n(r)?r:void 0}},function(t,e,r){t.exports=r(148)()},function(t,e,r){var n=r(66),o=r(14),i=r(13);t.exports=function(t){return null!=t&&i(n(t))&&!o(t)}},function(t,e,r){var n=r(34),o=r(64),i=r(54),a=r(9),u=r(21),s=r(29);t.exports=function(t){var e=s(t);if(!e&&!a(t))return o(t);var r=i(t),c=!!r,f=r||[],l=f.length;for(var p in t)!n(t,p)||c&&("length"==p||u(p,l))||e&&"constructor"==p||f.push(p);return f}},function(t,e){t.exports=ReactDOM},function(t,e,r){var n=r(6),o="[object Symbol]",i=Object.prototype.toString;t.exports=function(t){return"symbol"==typeof t||n(t)&&i.call(t)==o}},function(t,e){var r=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}},function(t,e,r){var n=r(5),o="[object Function]",i="[object GeneratorFunction]",a=Object.prototype.toString;t.exports=function(t){var e=n(t)?a.call(t):"";return e==o||e==i}},function(t,e,r){var n=r(89),o=r(90),i=r(91),a=r(92),u=r(93);function s(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,t.exports=s},function(t,e,r){var n=r(25);t.exports=function(t,e){for(var r=t.length;r--;)if(n(t[r][0],e))return r;return-1}},function(t,e,r){var n=r(7)(Object,"create");t.exports=n},function(t,e,r){var n=r(107);t.exports=function(t,e){var r=t.__data__;return n(e)?r["string"==typeof e?"string":"hash"]:r.map}},function(t,e,r){var n=r(12),o=1/0;t.exports=function(t){if("string"==typeof t||n(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e){var r=9007199254740991,n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,r){var n=r(2),o=r(12),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!o(t))||a.test(t)||!i.test(t)||null!=e&&t in Object(e)}},function(t,e,r){"use strict";e.e=function(t){var e=document.createEvent("Event");e.initEvent("click",!0,!0),t.dispatchEvent(e)},e.c=function(t){return/^http:\/\//.test(t)},r.d(e,"b",function(){return n}),r.d(e,"a",function(){return o}),r.d(e,"d",function(){return i});var n="ActiveXObject"in window,o=window.navigator.userAgent.indexOf("Edge")>-1,i=window.navigator.userAgent.indexOf("Windows")>-1},function(t,e,r){"use strict";var n=r(217),o=r(314),i=Object.prototype.toString;function a(t){return"[object Array]"===i.call(t)}function u(t){return null!==t&&"object"==typeof t}function s(t){return"[object Function]"===i.call(t)}function c(t,e){if(null!==t&&void 0!==t)if("object"!=typeof t&&(t=[t]),a(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.call(null,t[o],o,t)}t.exports={isArray:a,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:o,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:u,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:s,isStream:function(t){return u(t)&&s(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function t(){var e={};function r(r,n){"object"==typeof e[n]&&"object"==typeof r?e[n]=t(e[n],r):e[n]=r}for(var n=0,o=arguments.length;n<o;n++)c(arguments[n],r);return e},extend:function(t,e,r){return c(e,function(e,o){t[o]=r&&"function"==typeof e?n(e,r):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e){t.exports=function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){var n=r(2),o=r(6),i="[object String]",a=Object.prototype.toString;t.exports=function(t){return"string"==typeof t||!n(t)&&o(t)&&a.call(t)==i}},function(t,e){var r=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}},function(t,e,r){var n=r(99),o=r(106),i=r(108),a=r(109),u=r(110);function s(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,t.exports=s},function(t,e,r){var n=r(61),o="[object Arguments]",i=Object.prototype,a=i.hasOwnProperty,u=i.toString,s=i.propertyIsEnumerable;t.exports=function(t){return n(t)&&a.call(t,"callee")&&(!s.call(t,"callee")||u.call(t)==o)}},function(t,e,r){var n=r(77),o=r(39),i=r(78),a=r(67),u=r(79),s=r(36),c=Object.prototype.toString,f=s(n),l=s(o),p=s(i),d=s(a),h=s(u);function v(t){return c.call(t)}(n&&"[object DataView]"!=v(new n(new ArrayBuffer(1)))||o&&"[object Map]"!=v(new o)||i&&"[object Promise]"!=v(i.resolve())||a&&"[object Set]"!=v(new a)||u&&"[object WeakMap]"!=v(new u))&&(v=function(t){var e=c.call(t),r="[object Object]"==e?t.constructor:void 0,n=r?s(r):void 0;if(n)switch(n){case f:return"[object DataView]";case l:return"[object Map]";case p:return"[object Promise]";case d:return"[object Set]";case h:return"[object WeakMap]"}return e}),t.exports=v},function(t,e,r){var n=r(128),o=r(135),i=r(117),a=r(2),u=r(141);t.exports=function(t){return"function"==typeof t?t:null==t?i:"object"==typeof t?a(t)?o(t[0],t[1]):n(t):u(t)}},function(t,e,r){var n=r(42),o=Object.prototype.hasOwnProperty;t.exports=function(t,e){return o.call(t,e)||"object"==typeof t&&e in t&&null===n(t)}},function(t,e,r){"use strict";var n=r(182),o=r(183),i=r(184),a=r(185),u=r(186),s=r(187),c=r(188);r.d(e,"h",function(){return n.a}),r.d(e,"a",function(){return o.a}),r.d(e,"g",function(){return i.a}),r.d(e,"e",function(){return a.a}),r.d(e,"d",function(){return u.a}),r.d(e,"b",function(){return s.a}),r.d(e,"k",function(){return c.a});var f=r(189);r.d(e,"j",function(){return f.d}),r.d(e,"i",function(){return f.c}),r.d(e,"f",function(){return f.b}),r.d(e,"l",function(){return f.e}),r.d(e,"c",function(){return f.a})},function(t,e){var r=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},function(t,e,r){var n=r(15),o=r(94),i=r(95),a=r(96),u=r(97),s=r(98);function c(t){this.__data__=new n(t)}c.prototype.clear=o,c.prototype.delete=i,c.prototype.get=a,c.prototype.has=u,c.prototype.set=s,t.exports=c},function(t,e,r){var n=r(7)(r(4),"Map");t.exports=n},function(t,e,r){var n=r(4).Symbol;t.exports=n},function(t,e){t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}},function(t,e){var r=Object.getPrototypeOf;t.exports=function(t){return r(Object(t))}},,,,function(t,e){t.exports=Zepto},function(t,e,r){var n;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var i=typeof n;if("string"===i||"number"===i)t.push(n);else if(Array.isArray(n)&&n.length){var a=o.apply(null,n);a&&t.push(a)}else if("object"===i)for(var u in n)r.call(n,u)&&n[u]&&t.push(u)}}return t.join(" ")}void 0!==t&&t.exports?(o.default=o,t.exports=o):void 0===(n=function(){return o}.apply(e,[]))||(t.exports=n)}()},,function(t,e,r){var n=r(111),o=r(5),i=r(6);t.exports=function t(e,r,a,u,s){return e===r||(null==e||null==r||!o(e)&&!i(r)?e!=e&&r!=r:n(e,r,t,a,u,s))}},function(t,e,r){var n=r(70),o=r(85),i=1,a=2;t.exports=function(t,e,r,u,s,c){var f=s&a,l=t.length,p=e.length;if(l!=p&&!(f&&p>l))return!1;var d=c.get(t);if(d)return d==e;var h=-1,v=!0,m=s&i?new n:void 0;for(c.set(t,e);++h<l;){var y=t[h],b=e[h];if(u)var g=f?u(b,y,h,e,t,c):u(y,b,h,t,e,c);if(void 0!==g){if(g)continue;v=!1;break}if(m){if(!o(e,function(t,e){if(!m.has(e)&&(y===t||r(y,t,u,s,c)))return m.add(e)})){v=!1;break}}else if(y!==b&&!r(y,b,u,s,c)){v=!1;break}}return c.delete(t),v}},function(t,e){t.exports=function(t,e){for(var r=-1,n=t.length,o=Array(n);++r<n;)o[r]=e(t[r],r,t);return o}},function(t,e,r){var n=r(14),o=r(5),i=r(12),a=NaN,u=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,f=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return a;if(o(t)){var e=n(t.valueOf)?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(u,"");var r=c.test(t);return r||f.test(t)?l(t.slice(2),r?2:8):s.test(t)?a:+t}},,function(t,e,r){var n=r(65),o=r(31),i=r(2),a=r(13),u=r(28);t.exports=function(t){var e=t?t.length:void 0;return a(e)&&(i(t)||u(t)||o(t))?n(e,String):null}},function(t,e,r){var n=r(56),o=r(22),i=r(19);t.exports=function(t,e){for(var r=0,a=(e=o(e,t)?[e]:n(e)).length;null!=t&&r<a;)t=t[i(e[r++])];return r&&r==a?t:void 0}},function(t,e,r){var n=r(2),o=r(136);t.exports=function(t){return n(t)?t:o(t)}},function(t,e,r){var n=r(25),o=Object.prototype.hasOwnProperty;t.exports=function(t,e,r){var i=t[e];o.call(t,e)&&n(i,r)&&(void 0!==r||e in t)||(t[e]=r)}},function(t,e){t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}},function(t,e,r){var n=r(145),o=r(146)(n);t.exports=o},,function(t,e,r){var n=r(9),o=r(6);t.exports=function(t){return o(t)&&n(t)}},function(t,e,r){var n=r(5);t.exports=function(t){return t==t&&!n(t)}},function(t,e){t.exports=function(t,e){return function(r){return null!=r&&r[t]===e&&(void 0!==e||t in Object(r))}}},function(t,e){var r=Object.keys;t.exports=function(t){return r(Object(t))}},function(t,e){t.exports=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}},function(t,e,r){var n=r(37)("length");t.exports=n},function(t,e,r){var n=r(7)(r(4),"Set");t.exports=n},function(t,e,r){var n=r(57);t.exports=function(t,e,r,o){r||(r={});for(var i=-1,a=e.length;++i<a;){var u=e[i],s=o?o(r[u],t[u],u,r,t):t[u];n(r,u,s)}return r}},function(t,e,r){var n=r(81);t.exports=function(t){var e=n(t),r=e%1;return e==e?r?e-r:e:0}},function(t,e,r){var n=r(30),o=r(112),i=r(113);function a(t){var e=-1,r=t?t.length:0;for(this.__data__=new n;++e<r;)this.add(t[e])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,t.exports=a},function(t,e,r){var n=r(4).Uint8Array;t.exports=n},,function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o=r(246);e.clone=function(t){return"object"!=typeof t||null===t?t:o(t,function(t){if("object"==typeof t&&t&&"function"==typeof t.clone)return t.clone()})},e.freeze=function(t){return t},e.isFrozen=function(t){return!1};var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ops=e,this.index=0,this.offset=0}return n(t,[{key:"hasNext",value:function(){return this.peekLength()<1/0}},{key:"next",value:function(t){t||(t=1/0);var e=this.ops[this.index];if(!e)return null;var r=this.offset,n=e.length;if(0===r&&n===t)return this.index+=1,e;t>=n-r?(t=n-r,this.index+=1,this.offset=0):this.offset+=t;var o={action:e.action,attributes:e.attributes};switch(e.action){case"remove":o.data=t;break;case"retain":if("number"==typeof e.data)o.data=t;else{if("string"==typeof e.data)throw new Error("retain with a string is not allowed");o.data=e.data}break;case"insert":"string"==typeof e.data?o.data=e.data.substr(r,t):"number"==typeof e.data?o.data=t:o.data=e.data}return e.createInstance(o)}},{key:"peekLength",value:function(){var t=this.ops[this.index];return t?t.length-this.offset:1/0}},{key:"peekAction",value:function(){var t=this.ops[this.index];return t?t.action:"retain"}}]),t}();e.OperatorIterator=i,e.parsePosition=function(t){for(var e=0,r=0,n=0;n<t.length;n++){var o=t[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+t);e=10*e+o-48}}return{row:e-1,col:r-1}},e.stringifyPosition=function(t,e){if(!(t>=0&&e>=0))throw new Error("Invalid cell position "+t+":"+e);for(var r=e+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(t+1)}},function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,o="~";function i(){}function a(t,e,r,n,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new function(t,e,r){this.fn=t,this.context=e,this.once=r||!1}(r,n||t,i),u=o?o+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),s.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(o?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t){var e=o?o+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,a=new Array(i);n<i;n++)a[n]=r[n].fn;return a},s.prototype.listenerCount=function(t){var e=o?o+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,n,i,a){var u=o?o+t:t;if(!this._events[u])return!1;var s,c,f=this._events[u],l=arguments.length;if(f.fn){switch(f.once&&this.removeListener(t,f.fn,void 0,!0),l){case 1:return f.fn.call(f.context),!0;case 2:return f.fn.call(f.context,e),!0;case 3:return f.fn.call(f.context,e,r),!0;case 4:return f.fn.call(f.context,e,r,n),!0;case 5:return f.fn.call(f.context,e,r,n,i),!0;case 6:return f.fn.call(f.context,e,r,n,i,a),!0}for(c=1,s=new Array(l-1);c<l;c++)s[c-1]=arguments[c];f.fn.apply(f.context,s)}else{var p,d=f.length;for(c=0;c<d;c++)switch(f[c].once&&this.removeListener(t,f[c].fn,void 0,!0),l){case 1:f[c].fn.call(f[c].context);break;case 2:f[c].fn.call(f[c].context,e);break;case 3:f[c].fn.call(f[c].context,e,r);break;case 4:f[c].fn.call(f[c].context,e,r,n);break;default:if(!s)for(p=1,s=new Array(l-1);p<l;p++)s[p-1]=arguments[p];f[c].fn.apply(f[c].context,s)}}return!0},s.prototype.on=function(t,e,r){return a(this,t,e,r,!1)},s.prototype.once=function(t,e,r){return a(this,t,e,r,!0)},s.prototype.removeListener=function(t,e,r,n){var i=o?o+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||n&&!a.once||r&&a.context!==r||u(this,i);else{for(var s=0,c=[],f=a.length;s<f;s++)(a[s].fn!==e||n&&!a[s].once||r&&a[s].context!==r)&&c.push(a[s]);c.length?this._events[i]=1===c.length?c[0]:c:u(this,i)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=o?o+t:t,this._events[e]&&u(this,e)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=o,s.EventEmitter=s,t.exports=s},function(t,e,r){var n=r(14),o=r(26),i=r(5),a=r(36),u=/^\[object .+?Constructor\]$/,s=Object.prototype,c=Function.prototype.toString,f=s.hasOwnProperty,l=RegExp("^"+c.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!!i(t)&&(n(t)||o(t)?l:u).test(a(t))}},function(t,e){t.exports=function(t){return t&&t.Object===Object?t:null}},function(t,e,r){var n=r(7)(r(4),"DataView");t.exports=n},function(t,e,r){var n=r(7)(r(4),"Promise");t.exports=n},function(t,e,r){var n=r(7)(r(4),"WeakMap");t.exports=n},function(t,e,r){var n=r(126),o=r(69),i="Expected a function",a=Math.max;t.exports=function(t,e){if("function"!=typeof t)throw new TypeError(i);return e=a(void 0===e?t.length-1:o(e),0),function(){for(var r=arguments,o=-1,i=a(r.length-e,0),u=Array(i);++o<i;)u[o]=r[e+o];switch(e){case 0:return t.call(this,u);case 1:return t.call(this,r[0],u);case 2:return t.call(this,r[0],r[1],u)}var s=Array(e+1);for(o=-1;++o<e;)s[o]=r[o];return s[e]=u,n(t,this,s)}}},function(t,e,r){var n=r(52),o=1/0,i=1.7976931348623157e308;t.exports=function(t){return t?(t=n(t))===o||t===-o?(t<0?-1:1)*i:t==t?t:0:0===t?t:0}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(83);e.DEFAULT_LOCALES=["af","ar","az","be","bg","bn","bs","ca","cs","cy","da","de","de-AT","de-CH","de-DE","el","el-CY","en","en-AU","en-CA","en-GB","en-IE","en-IN","en-NZ","en-US","en-ZA","en-CY,eo","es","es-419","es-AR","es-CL","es-CO","es-CR","es-EC","es-ES","es-MX","es-NI","es-PA","es-PE","es-US","es-VE","et","eu","fa","fi","fr","fr-CA","fr-CH","fr-FR","gl","he","hi","hi-IN","hr","hu","id","is","it","it-CH","ja","ka","km","kn","ko","lb","lo","lt","lv","mk","ml","mn","mr-IN","ms","nb","ne","nl","nn","oc","or","pa","pl","pt","pt-BR","rm","ro","ru","sk","sl","sq","sr","sw","ta","te","th","tl","tr","tt","ug","ur","uz","vi","wo","zh-CN","zh-HK","zh-TW","zh-YUE"],e.isValidLocaleResource=function(t){return!!t&&(!Array.isArray(t)&&("object"===(void 0===t?"undefined":n(t))&&Object.keys(t).every(function(e){var r=t[e];return null==r||"string"==typeof r||"object"===(void 0===r?"undefined":n(r))})))},e.rawTextToKey=function(t){switch(t.type){case"string":return t.text;case"interpolated":var e=t.textParts.length;return 1===e?t.textParts[0]:2===e?t.textParts[0]+"%s"+t.textParts[1]:t.textParts.map(function(e,r){return r===t.textParts.length-1?e:e+"%"+(r+1)}).join("");default:return o.assertNever(t)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertNever=function(t){throw new Error("unexpected type: "+JSON.stringify(t))}},,function(t,e){t.exports=function(t,e){for(var r=-1,n=t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}},function(t,e,r){var n=r(125);t.exports=function(t){return null==t?"":n(t)}},function(t,e,r){var n=r(143)();t.exports=n},,function(t,e){t.exports=function(){this.__data__=[]}},function(t,e,r){var n=r(16),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,r=n(e,t);return!(r<0||(r==e.length-1?e.pop():o.call(e,r,1),0))}},function(t,e,r){var n=r(16);t.exports=function(t){var e=this.__data__,r=n(e,t);return r<0?void 0:e[r][1]}},function(t,e,r){var n=r(16);t.exports=function(t){return n(this.__data__,t)>-1}},function(t,e,r){var n=r(16);t.exports=function(t,e){var r=this.__data__,o=n(r,t);return o<0?r.push([t,e]):r[o][1]=e,this}},function(t,e,r){var n=r(15);t.exports=function(){this.__data__=new n}},function(t,e){t.exports=function(t){return this.__data__.delete(t)}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,r){var n=r(15),o=r(30),i=200;t.exports=function(t,e){var r=this.__data__;return r instanceof n&&r.__data__.length==i&&(r=this.__data__=new o(r.__data__)),r.set(t,e),this}},function(t,e,r){var n=r(100),o=r(15),i=r(39);t.exports=function(){this.__data__={hash:new n,map:new(i||o),string:new n}}},function(t,e,r){var n=r(101),o=r(102),i=r(103),a=r(104),u=r(105);function s(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=u,t.exports=s},function(t,e,r){var n=r(17);t.exports=function(){this.__data__=n?n(null):{}}},function(t,e){t.exports=function(t){return this.has(t)&&delete this.__data__[t]}},function(t,e,r){var n=r(17),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(n){var r=e[t];return r===o?void 0:r}return i.call(e,t)?e[t]:void 0}},function(t,e,r){var n=r(17),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:o.call(e,t)}},function(t,e,r){var n=r(17),o="__lodash_hash_undefined__";t.exports=function(t,e){return this.__data__[t]=n&&void 0===e?o:e,this}},function(t,e,r){var n=r(18);t.exports=function(t){return n(this,t).delete(t)}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,r){var n=r(18);t.exports=function(t){return n(this,t).get(t)}},function(t,e,r){var n=r(18);t.exports=function(t){return n(this,t).has(t)}},function(t,e,r){var n=r(18);t.exports=function(t,e){return n(this,t).set(t,e),this}},function(t,e,r){var n=r(38),o=r(50),i=r(114),a=r(115),u=r(32),s=r(2),c=r(26),f=r(116),l=2,p="[object Arguments]",d="[object Array]",h="[object Object]",v=Object.prototype.hasOwnProperty;t.exports=function(t,e,r,m,y,b){var g=s(t),w=s(e),_=d,O=d;g||(_=(_=u(t))==p?h:_),w||(O=(O=u(e))==p?h:O);var x=_==h&&!c(t),j=O==h&&!c(e),k=_==O;if(k&&!x)return b||(b=new n),g||f(t)?o(t,e,r,m,y,b):i(t,e,_,r,m,y,b);if(!(y&l)){var C=x&&v.call(t,"__wrapped__"),E=j&&v.call(e,"__wrapped__");if(C||E){var A=C?t.value():t,I=E?e.value():e;return b||(b=new n),r(A,I,m,y,b)}}return!!k&&(b||(b=new n),a(t,e,r,m,y,b))}},function(t,e){var r="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,r),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,r){var n=r(40),o=r(71),i=r(50),a=r(41),u=r(58),s=1,c=2,f="[object Boolean]",l="[object Date]",p="[object Error]",d="[object Map]",h="[object Number]",v="[object RegExp]",m="[object Set]",y="[object String]",b="[object Symbol]",g="[object ArrayBuffer]",w="[object DataView]",_=n?n.prototype:void 0,O=_?_.valueOf:void 0;t.exports=function(t,e,r,n,_,x,j){switch(r){case w:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case g:return!(t.byteLength!=e.byteLength||!n(new o(t),new o(e)));case f:case l:return+t==+e;case p:return t.name==e.name&&t.message==e.message;case h:return t!=+t?e!=+e:t==+e;case v:case y:return t==e+"";case d:var k=a;case m:var C=x&c;if(k||(k=u),t.size!=e.size&&!C)return!1;var E=j.get(t);return E?E==e:(x|=s,j.set(t,e),i(k(t),k(e),n,_,x,j));case b:if(O)return O.call(t)==O.call(e)}return!1}},function(t,e,r){var n=r(34),o=r(10),i=2;t.exports=function(t,e,r,a,u,s){var c=u&i,f=o(t),l=f.length;if(l!=o(e).length&&!c)return!1;for(var p=l;p--;){var d=f[p];if(!(c?d in e:n(e,d)))return!1}var h=s.get(t);if(h)return h==e;var v=!0;s.set(t,e);for(var m=c;++p<l;){var y=t[d=f[p]],b=e[d];if(a)var g=c?a(b,y,d,e,t,s):a(y,b,d,t,e,s);if(!(void 0===g?y===b||r(y,b,a,u,s):g)){v=!1;break}m||(m="constructor"==d)}if(v&&!m){var w=t.constructor,_=e.constructor;w!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof w&&w instanceof w&&"function"==typeof _&&_ instanceof _)&&(v=!1)}return s.delete(t),v}},function(t,e,r){var n=r(13),o=r(6),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;var a=Object.prototype.toString;t.exports=function(t){return o(t)&&n(t.length)&&!!i[a.call(t)]}},function(t,e){t.exports=function(t){return t}},function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(11),a=r.n(i),u=r(119),s=r(23),c=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),f=function(t){function e(e){var r=t.call(this,e)||this;return r.toggleOpen=function(){r.setState({open:!r.state.open,style:null})},r.close=function(){r.setState({open:!1,style:null})},r.checkClick=function(t){var e=a.a.findDOMNode(r),n=t.target;!e.contains(n)&&r.state.open&&r.close()},r.adjustStyle=function(){var t=a.a.findDOMNode(r);if(!s.b&&!s.a||!t.querySelector(".menu--submenu")){var e=t.lastElementChild.getBoundingClientRect(),n=e.top,o=e.bottom,i={},u=window.innerHeight-50;o>u&&(i.maxHeight=u-n,i.overflowY="auto"),r.setState({style:i})}},r.state={open:!1,style:null},r}return c(e,t),e.prototype.componentDidMount=function(){this.bindClick()},e.prototype.componentDidUpdate=function(t,e){this.state.open&&!e.open?(this.props.onOpen&&this.props.onOpen(),this.adjustStyle()):!this.state.open&&e.open&&this.props.onClose&&this.props.onClose()},e.prototype.componentWillUnmount=function(){this.unbindClick()},e.prototype.render=function(){var t=this,e="menu "+(this.props.customClass?this.props.customClass:"")+" "+(this.state.open?"menu__open":"")+" "+(this.props.disabled?"disabled":"");return o.a.createElement(u.a.Provider,{value:{closeMenu:this.close}},o.a.createElement("div",{className:e},o.a.cloneElement(this.props.head,{onClick:function(e){var r=t.props.head.props.onClick;r&&r(e),t.toggleOpen()}}),this.state.open&&o.a.createElement("div",{className:"menu--body"},o.a.createElement("div",{className:"menu--content",style:this.state.style},this.renderChildren()))))},e.prototype.bindClick=function(){document.addEventListener("click",this.checkClick,!1)},e.prototype.unbindClick=function(){document.removeEventListener("click",this.checkClick,!1)},e.prototype.renderChildren=function(){var t=this.props.children;if("function"==typeof t){if(t.cache)return t.cache;var e=t();return t.cache=e,e}return t},e}(o.a.Component);e.a=f},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var n=r(0),o=r.n(n).a.createContext({closeMenu:function(){}})},function(t,e,r){"use strict";e.a=function(t){return{background:'url("'+t+'") center no-repeat'}}},,,,function(t,e,r){var n=r(55);t.exports=function(t,e,r){var o=null==t?void 0:n(t,e);return void 0===o?r:o}},function(t,e,r){var n=r(40),o=r(12),i=1/0,a=n?n.prototype:void 0,u=a?a.toString:void 0;t.exports=function(t){if("string"==typeof t)return t;if(o(t))return u?u.call(t):"";var e=t+"";return"0"==e&&1/t==-i?"-0":e}},function(t,e){t.exports=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}},,function(t,e,r){var n=r(129),o=r(130),i=r(63);t.exports=function(t){var e=o(t);return 1==e.length&&e[0][2]?i(e[0][0],e[0][1]):function(r){return r===t||n(r,t,e)}}},function(t,e,r){var n=r(38),o=r(49),i=1,a=2;t.exports=function(t,e,r,u){var s=r.length,c=s,f=!u;if(null==t)return!c;for(t=Object(t);s--;){var l=r[s];if(f&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++s<c;){var p=(l=r[s])[0],d=t[p],h=l[1];if(f&&l[2]){if(void 0===d&&!(p in t))return!1}else{var v=new n;if(u)var m=u(d,h,p,t,e,v);if(!(void 0===m?o(h,d,u,i|a,v):m))return!1}}return!0}},function(t,e,r){var n=r(62),o=r(131);t.exports=function(t){for(var e=o(t),r=e.length;r--;)e[r][2]=n(e[r][1]);return e}},function(t,e,r){var n=r(132)(r(10));t.exports=n},function(t,e,r){var n=r(133),o=r(32),i=r(41),a=r(134),u="[object Map]",s="[object Set]";t.exports=function(t){return function(e){var r=o(e);return r==u?i(e):r==s?a(e):n(e,t(e))}}},function(t,e,r){var n=r(51);t.exports=function(t,e){return n(e,function(e){return[e,t[e]]})}},function(t,e){t.exports=function(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=[t,t]}),r}},function(t,e,r){var n=r(49),o=r(124),i=r(138),a=r(22),u=r(62),s=r(63),c=r(19),f=1,l=2;t.exports=function(t,e){return a(t)&&u(e)?s(c(t),e):function(r){var a=o(r,t);return void 0===a&&a===e?i(r,t):n(e,a,void 0,f|l)}}},function(t,e,r){var n=r(137),o=r(86),i=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,a=/\\(\\)?/g,u=n(function(t){var e=[];return o(t).replace(i,function(t,r,n,o){e.push(n?o.replace(a,"$1"):r||t)}),e});t.exports=u},function(t,e,r){var n=r(30),o="Expected a function";function i(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(o);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(i.Cache||n),r}i.Cache=n,t.exports=i},function(t,e,r){var n=r(139),o=r(140);t.exports=function(t,e){return null!=t&&o(t,e,n)}},function(t,e){t.exports=function(t,e){return e in Object(t)}},function(t,e,r){var n=r(56),o=r(31),i=r(2),a=r(21),u=r(22),s=r(13),c=r(28),f=r(19);t.exports=function(t,e,r){for(var l,p=-1,d=(e=u(e,t)?[e]:n(e)).length;++p<d;){var h=f(e[p]);if(!(l=null!=t&&r(t,h)))break;t=t[h]}return l||!!(d=t?t.length:0)&&s(d)&&a(h,d)&&(i(t)||c(t)||o(t))}},function(t,e,r){var n=r(37),o=r(142),i=r(22),a=r(19);t.exports=function(t){return i(t)?n(a(t)):o(t)}},function(t,e,r){var n=r(55);t.exports=function(t){return function(e){return n(e,t)}}},function(t,e){t.exports=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var s=a[t?u:++o];if(!1===r(i[s],s,i))break}return e}}},function(t,e,r){var n=r(154),o=r(59),i=r(33),a=r(2);t.exports=function(t,e){return(a(t)?n:o)(t,i(e,3))}},function(t,e,r){var n=r(87),o=r(10);t.exports=function(t,e){return t&&n(t,e,o)}},function(t,e,r){var n=r(9);t.exports=function(t,e){return function(r,o){if(null==r)return r;if(!n(r))return t(r,o);for(var i=r.length,a=e?i:-1,u=Object(r);(e?a--:++a<i)&&!1!==o(u[a],a,u););return r}}},function(t,e,r){var n=r(25),o=r(9),i=r(21),a=r(5);t.exports=function(t,e,r){if(!a(r))return!1;var u=typeof e;return!!("number"==u?o(r)&&i(e,r.length):"string"==u&&e in r)&&n(r[e],t)}},function(t,e,r){"use strict";var n=r(149),o=r(150),i=r(151);t.exports=function(){function t(t,e,r,n,a,u){u!==i&&o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function e(){return t}t.isRequired=t;var r={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return r.checkPropTypes=n,r.PropTypes=r,r}},function(t,e,r){"use strict";function n(t){return function(){return t}}var o=function(){};o.thatReturns=n,o.thatReturnsFalse=n(!1),o.thatReturnsTrue=n(!0),o.thatReturnsNull=n(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(t){return t},t.exports=o},function(t,e,r){"use strict";var n=function(t){};t.exports=function(t,e,r,o,i,a,u,s){if(n(e),!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[r,o,i,a,u,s],l=0;(c=new Error(e.replace(/%s/g,function(){return f[l++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(t,e,r){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},,,function(t,e){t.exports=function(t,e){for(var r=-1,n=t.length;++r<n&&!1!==e(t[r],r,t););return t}},function(t,e,r){var n=r(147),o=r(80);t.exports=function(t){return o(function(e,r){var o=-1,i=r.length,a=i>1?r[i-1]:void 0,u=i>2?r[2]:void 0;for(a=t.length>3&&"function"==typeof a?(i--,a):void 0,u&&n(r[0],r[1],u)&&(a=i<3?void 0:a,i=1),e=Object(e);++o<i;){var s=r[o];s&&t(e,s,o,a)}return e})}},function(t,e,r){"use strict";var n=r(222),o=r(245);e.Attribute=r(157),e.Delta=r(158);var i={TableOperator:r(386),CellOperator:r(236),TextOperator:r(388),Operator:r(159)};n(e,i),e.pack=function(t){if("function"==typeof t.toJSON)return JSON.stringify(t);throw new Error("Only delta can be packed")},e.unpack=function(t){return e.Delta.unpack(JSON.parse(t))},e.print=function(t){t.print(!0)};var a=o(Object.keys(i),function(t,e){var r=i[e];return t[r.packId]=r,t},{});function u(t){var e=t[0].toString(),r=e[e.length-1];return a[e.slice(0,e.length-1)].unpack([r,t[1],t[2]])}e.Delta.operatorUnpacker=u,Object.keys(i).forEach(function(t){i[t].operatorUnpacker=u});var s=r(73);e.parsePosition=s.parsePosition,e.stringifyPosition=s.stringifyPosition},function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=[{name:"color"},{name:"background"},{name:"font-size"},{name:"width"},{name:"height"},{name:"rowspan"},{name:"colspan"},{name:"align",values:["left","center","right","justify"]},{name:"bold",values:[!1,!0]},{name:"italic",values:[!1,!0]},{name:"underline",values:[!1,!0]},{name:"vertical",values:["top","middle","bottom"]},{name:"strike",values:[!1,!0]},{name:"wrap",values:["text-wrap","text-no-wrap","text-linebreak-overflow"]},{name:"fixedRowsTop"},{name:"fixedColumnsLeft"},{name:"link"},{name:"format",values:["normal","0,0","0,0.00","0%","0.00%","0.00E+00","(0,0)","(0,0.00)","¥0,0","¥0,0.00","$0,0","$0,0.00","YYYY/MM/DD","YYYY-MM-DD","HH:mm:ss","YYYY/MM/DD HH:mm:ss","¥ (#,##0)","¥ (#,##0.00)","@","#,##0.0_);[Red](#,##0.0)","#,##0.0_);(#,##0.0)","#,##0.0;[Red]#,##0.0","#,##0.0_ ","#,##0.0_ ;[Red]-#,##0.0 ","#,##0_);[Red](#,##0)","#,##0_);(#,##0)","#,##0;[Red]#,##0","#,##0_ ","#,##0_ ;[Red]-#,##0 ","0.0_);[Red](0.0)","0.0_);(0.0)","0.0;[Red]0.0","0.0_ ","0.0_ ;[Red]-0.0 ","0_);[Red](0)","0_);(0)","0;[Red]0","0_ ","0_ ;[Red]-0 ","0.0%",'"$"#,##0.0_);[Red]("$"#,##0.0)','"¥"#,##0.0_);[Red]("¥"#,##0.0)','"$"#,##0.0_);("$"#,##0.0)','"¥"#,##0.0_);("¥"#,##0.0)','"$"#,##0.0;[Red]"$"#,##0.0','"¥"#,##0.0;[Red]"¥"#,##0.0','"$"#,##0.0','"¥"#,##0.0','"$"#,##0.0;[Red]-"$"#,##0.0','"¥"#,##0.0;[Red]-"¥"#,##0.0','"$"#,##0_);[Red]("$"#,##0)','"¥"#,##0_);[Red]("¥"#,##0)','"$"#,##0_);("$"#,##0)','"¥"#,##0_);("¥"#,##0)','"$"#,##0;[Red]"$"#,##0','"¥"#,##0;[Red]"¥"#,##0','"$"#,##0','"¥"#,##0','"$"#,##0;[Red]-"$"#,##0','"¥"#,##0;[Red]-"¥"#,##0','_("$"* #,##0.0_);_("$"* (#,##0.0);_("$"* "-"??_);_(@_)','_("¥"* #,##0.0_);_("¥"* (#,##0.0);_("¥"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)','_("¥"* #,##0_);_("¥"* (#,##0);_("¥"* "-"_);_(@_)',"yyyy/m/d","yyyy/mm/dd;@","yyyy-mm-dd;@","yy/mm/dd;@","yy-mm-dd;@","mm/dd;@","mm-dd;@","yyyy-m-d;@","yy/m/d;@","yy-m-d;@","m/d;@","m-d;@","m/d/yy;@","mm/dd/yy;@","d;@","dd;@",'yyyy"年"m"月"d"日" aaaa','yyyy"年"m"月"d"日";@','yyyy"年"m"月";@','m"月"d"日";@','[$-804]yyyy"年"mm"月"dd"日" aaaa;@','yyyy"年"mm"月"dd"日";@','yyyy"年"mm"月";@','mm"月"dd"日";@','m"月";@','mm"月";@','[DBNum1][$-804]m"月";@',"[$-804]aaaa;@","[$-804]aaa;@",'[DBNum1][$-804]yyyy"年"m"月"d"日";@','[DBNum1][$-804]yyyy"年"m"月";@','[DBNum1][$-804]m"月"d"日";@',"[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@","[$-409]yyyy/mm/dd h:mm AM/PM;@","yyyy/mm/dd hh:mm;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","[$-409]yyyy/mm/dd h:mm:ss AM/PM;@","yyyy/mm/dd hh:mm:ss;@","[$-409]yyyy/m/d h:mm:ss AM/PM;@","yyyy/m/d h:mm:ss;@","h:mm:ss;@","h:mm;@","AM/PM h:mm:ss",'上午/下午h"时"mm"分"ss"秒";@','上午/下午h"时"mm"分";@','[DBNum1][$-804]h"时"mm"分";@','[DBNum1][$-804]上午/下午h"时"mm"分";@',"[$-409]h:mm AM/PM;@","[$-409]h:mm:ss AM/PM;@",'h"时"mm"分";@','h"时"mm"分"ss"秒";@',"# ?/?","# ??/??","# ???/???","# ?/2","# ?/4","# ?/8","# ??/16","# ?/10","# ??/100","0.0E+00","0E+00","000000","[DBNum1][$-804]General","[DBNum2][$-804]General"]},{name:"formula"},{name:"filter"},{name:"border-top"},{name:"border-right"},{name:"border-bottom"},{name:"border-left"},{name:"line"},{name:"guid"},{name:"author"},{name:"size"},{name:"list"},{name:"layout",values:["embed","block"]},{name:"margin",values:["none","small","medium","large"]},{name:"font",values:["serif","monospace","microsoftyahei","simsun","kaiti","simhei","fangsong","droid","source","arial"]},{name:"header"},{name:"indent"},{name:"comment"},{name:"comment-block"},{name:"code-block",values:[!0]},{name:"cellValue"},{name:"precision"},{name:"autoFormatter",values:["#,##0_);[Red](#,##0)","#,##0.00_);[Red](#,##0.00)",'"¥"#,##0_);[Red]("¥"#,##0)','"¥"#,##0.00_);[Red]("¥"#,##0.00)','"$"#,##0_);[Red]("$"#,##0)','"$"#,##0.00_);[Red]("$"#,##0.00)',"0%","0.00%","# ??/??","0.00E+00","yyyy/m/d",'m"月"d"日";@','yyyy"年"m"月"d"日";@','yyyy"年"m"月";@',"[$-409]yyyy/mm/dd h:mm:ss AM/PM;@","[$-409]yyyy/mm/dd h:mm AM/PM;@","yyyy/mm/dd hh:mm:ss;@","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@",'h"时"mm"分";@','h"时"mm"分"ss"秒";@','[$-804]AM/PMh"时"mm"分";@','[$-804]AM/PMh"时"mm"分"ss"秒";@',"[$-409]mmm-yy;@","h:mm:ss.0;@","[$-409]h:mm:ss.0 AM/PM;@","yyyy/mm/dd hh:mm;@","yyyy/mm/dd hh:mm:ss.0;@"]}],i=o.reduce(function(t,e,r){return e.index=r,t[e.name]=e,t},{});t.exports={pack:function(t){if("object"==typeof t&&null!==t){var e=[];for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];if(void 0!==n){var o=i[r];if(o&&(r=o.index,o.values&&null!==n)){var a=o.values.indexOf(n);if(-1!==a)n=a;else if(17!==r)continue}e.push(null===n?r:r+":"+JSON.stringify("string"==typeof n?encodeURIComponent(n):n))}}return e.sort().join("|")}},unpack:function(t){if("string"!=typeof t)return{};for(var e={},r=t.split("|"),i=0;i<r.length;i++){var a=r[i].split(":"),u=n(a,2),s=u[0],c=u[1],f=o[s];if(c){var l=typeof(c=JSON.parse(c));"string"===l&&(c=decodeURIComponent(c)),f&&(s=f.name,f.values&&"number"===l&&void 0!==f.values[c]&&(c=f.values[c]))}else f&&(s=f.name),c=null;e[s]=c}return e},merge:function(t,e,r){if(r&&!t)return e;if(!e)return t;for(var n in t=this.unpack(t),e=this.unpack(e))e.hasOwnProperty(n)&&(t[n]=e[n],r||null!==t[n]||delete t[n]);return this.pack(t)},invert:function(t,e){if(e){if(!t)return e.split("|").map(function(t){var e=t.indexOf(":");return-1===e?t:t.slice(0,e)}).join("|");for(var r in t=this.unpack(t),e=this.unpack(e))e.hasOwnProperty(r)&&(void 0!==t[r]?e[r]=t[r]:e[r]=null);return this.pack(e)}},transform:function(t,e,r){if(r)return e;if(e){if(!t)return e;for(var n in t=this.unpack(t),e=this.unpack(e))e.hasOwnProperty(n)&&void 0!==t[n]&&delete e[n];return this.pack(e)}},diff:function(t,e){if(!t)return e;t=this.unpack(t),e&&(e=this.unpack(e));for(var r={},n=!0,o=e?Object.keys(t).concat(Object.keys(e)):Object.keys(t),i=0;i<o.length;i++){var a=o[i],u=e?e[a]:void 0;t[a]!==u&&(n=!1,r[a]=void 0===u?null:u)}return n?void 0:this.pack(r)}}},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o=r(73),i=r(247),a=r(248),u=String.fromCharCode(0),s=r(157),c=r(251),f=function(){function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ops=[],Array.isArray(e)){for(var n=0;n<e.length;n++)this.pushWithMutations(e[n]);r&&this.chopWithMutations()}else"function"==typeof e&&e(this);o.freeze(this)}return n(t,[{key:"freeze",value:function(){o.freeze(this.ops)}},{key:"createCleaner",value:function(){for(var e=[],r=0;r<this.ops.length;r++){var n=this.ops[r],o=n.createInstance({action:"remove",data:n.length});e.push(o)}return new t(e)}},{key:"clone",value:function(){return new t(this.ops.map(o.clone))}},{key:"toJSON",value:function(){return this.ops}},{key:"pack",value:function(){return this.ops.map(function(t){return t.pack()})}},{key:"isDocument",value:function(){for(var t=0;t<this.ops.length;t++)if("insert"!==this.ops[t].action)return!1;return!0}},{key:"isEmpty",value:function(){return 0===this.ops.length}},{key:"_genericPush",value:function(t,e){var r=t.length,n=t[r-1];if(n&&"remove"===n.action&&"insert"===e.action&&(n=t[(r-=1)-1]),!n)return t.unshift(e),t;var o=e.merge(n);return o?t[r-1]=o:r===t.length?t.push(e):t.splice(r,0,e),t}},{key:"push",value:function(e){if(!e.length)return this;var r=this.ops.slice(0);if(Array.isArray(e)){for(var n=!1,o=0;o<e.length;o++)e[o].length&&(n=!0,r=this._genericPush(r,e[o]));if(!n)return this}else r=this._genericPush(r,e);return new t(r)}},{key:"pushWithMutations",value:function(t){return t.length&&this._genericPush(this.ops,t),this}},{key:"concat",value:function(e){var r=this;return e.ops.length?this.ops.length?new t(function(t){t.ops=r.ops.slice(),t.pushWithMutations(e.ops[0]),e.ops.length>1&&(t.ops=t.ops.concat(e.ops.slice(1)))}):e:this}},{key:"_genericChop",value:function(t){for(;t.length&&t[t.length-1].isEmpty();)t.pop();return t}},{key:"chop",value:function(){return new t(this._genericChop(this.ops.slice(0)))}},{key:"chopWithMutations",value:function(){return this._genericChop(this.ops),this}},{key:"slice",value:function(e,r){e=e||0,"number"!=typeof r&&(r=1/0);for(var n=[],o=this.getIter(),i=0;i<r&&o.hasNext();){var a=void 0;i<e?a=o.next(e-i):(a=o.next(r-i),n.push(a)),i+=a.length}return new t(n)}},{key:"getIter",value:function(){return new o.OperatorIterator(this.ops)}},{key:"validate",value:function(){for(var t={},e=0;e<this.ops.length;e++){var r=this.ops[e];if(r&&"TableOperator"===r.name()){var n=r.getAttributes().name;if(!n)continue;var o="$$"+n+"$$";if(t.hasOwnProperty(o))throw new Error("Duplicated table name found: "+n);t[o]=!0}}return this}},{key:"isTableADocument",value:function(){for(var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=function(r){var n=t.ops[r];if(n&&"TableOperator"===n.name()&&n.data.cells.some(function(t){var e=n.data.cells.get(t);return!(!e.data||"number"==typeof e.data||"function"!=typeof e.data.isDocument)&&!1===e.data.isDocument()},e))return{v:!1}},n=0;n<this.ops.length;n++){var o=r(n);if("object"==typeof o)return o.v}return!0}},{key:"compose",value:function(e){for(var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getIter(),o=e.getIter(),i=[];n.hasNext()||o.hasNext();)if("insert"===o.peekAction())i.push(o.next());else if("remove"===n.peekAction())i.push(n.next());else{var a=Math.min(n.peekLength(),o.peekLength()),u=n.next(a),s=o.next(a);s&&"retain"!==s.action?u&&"retain"!==u.action||i.push(s):u?s?i.push(u.compose(s,r)):i.push(u):i.push(s)}var c=new t(i,!0);return r||c.validate(),c}},{key:"composePosition",value:function(t){for(var e=this.getIter(),r=0;e.hasNext()&&r<=t;){var n=e.peekLength(),o=e.peekAction();switch(e.next(),o){case"remove":if(n>t-r)return null;t-=n;continue;case"insert":t+=n}r+=n}return t}},{key:"invert",value:function(e){for(var r=this.getIter(),n=e.getIter(),o=[];n.hasNext();)if("insert"===n.peekAction()){var i=n.next(),a=i.createInstance({action:"remove",data:i.length});o.push(a)}else{if(!r.hasNext())throw new Error(this.constructor.name+" should be smaller than document");var u=Math.min(r.peekLength(),n.peekLength()),s=r.next(u),c=n.next(u);if("insert"!==s.action)throw new Error("Only document can invert deltas");"retain"===c.action?o.push(s.invert(c)):o.push(s)}return new t(o,!0)}},{key:"invertPosition",value:function(t){for(var e=this.getIter(),r=0;e.hasNext()&&r<=t;){var n=e.peekLength(),o=e.peekAction();switch(e.next(),o){case"insert":if(n>t-r)return null;t-=n;continue;case"remove":t+=n}r+=n}return t}},{key:"transform",value:function(e,r){for(var n=this.getIter(),o=e.getIter(),i=[];o.hasNext();)if("insert"!==n.peekAction()||!r&&"insert"===o.peekAction())if("insert"===o.peekAction())i.push(o.next());else{var a=Math.min(n.peekLength(),o.peekLength()),u=n.next(a),s=o.next(a);if(u&&"remove"===u.action)continue;s&&"remove"===s.action?i.push(s):u?i.push(u.transform(s,r)):i.push(s)}else{var c=n.next();i.push(c.createInstance({action:"retain",data:c.length}))}return new t(i,!0)}},{key:"transformPosition",value:function(t,e){for(var r=this.getIter(),n=0;r.hasNext()&&n<=t;){var o=r.peekLength(),i=r.peekAction();switch(r.next(),i){case"remove":t-=Math.min(o,t-n);continue;case"insert":(n<t||!e)&&(t+=o)}n+=o}return t}},{key:"toString",value:function(){for(var t="",e=0;e<this.ops.length;e++){var r=this.ops[e];if("insert"!==r.action)throw new Error("toString() called on non-document");t+="string"==typeof r.data?r.data:u}return t}},{key:"diff",value:function(e,r){if(this.ops===e.ops)return new t;if(!this.ops.length){if(!e.isDocument())throw new Error("diff() called on non-document");return e}for(var n=c(this.ops[0].createInstance,this.ops[0]),o=[],u=i(this.toString(),e.toString(),r),f=this.getIter(),l=e.getIter(),p=0,d=u.length;p<d;p++)for(var h=u[p],v=h[1].length;v>0;){var m=0;switch(h[0]){case i.INSERT:m=Math.min(l.peekLength(),v),o.push(l.next(m));break;case i.DELETE:m=Math.min(v,f.peekLength()),f.next(m),o.push(n({action:"remove",data:m}));break;case i.EQUAL:m=Math.min(f.peekLength(),l.peekLength(),v);var y=f.next(m),b=l.next(m);y.skipDiff()&&b.skipDiff()&&y.name()===b.name()||a(y.data,b.data)?o.push(n({action:"retain",data:m,attributes:s.diff(y.attributes,b.attributes)})):(o.push(b),o.push(n({action:"remove",data:m})))}v-=m}return new t(o,!0)}},{key:"print",value:function(t){console[t?"group":"groupCollapsed"]("Delta["+this.length+"] with "+this.ops.length+" operators"),this.ops.forEach(function(t){return t.print()}),console.groupEnd()}},{key:"length",get:function(){for(var t=0,e=0;e<this.ops.length;e++)t+=this.ops[e].length;return t}}],[{key:"unpack",value:function(t){var e=this;return new this(t.map(function(t){return e.operatorUnpacker(t)}))}}]),t}();f.packId=5,t.exports=f},function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=r(158),a=r(73).clone,u=r(157),s=r(73),c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setWithMutations(e);var r="Operator"!==this.name()&&this.isGeneric()?this.toGeneric():this;return s.freeze(r),r}return o(t,[{key:"name",value:function(){return"Operator"}},{key:"skipDiff",value:function(){return!1}},{key:"isGeneric",value:function(){var t=4===this.constructor.packId;return"number"==typeof this.data&&!t}},{key:"toGeneric",value:function(){return new t({action:this.action,data:this.data,attributes:this.attributes})}},{key:"clone",value:function(){var t=this.createInstance(this);return t.data=a(t.data),t}},{key:"_genericSet",value:function(t){var e={action:this.action,data:this.data,attributes:this.attributes},r=!1,n=t.action;if(n&&n!==e.action){if(r=!0,"insert"!==n&&"retain"!==n&&"remove"!==n)throw new Error('Action "'+n+'" is invalid');e.action=n}var o=t.data;if(null!=o&&o!==e.data){if(r=!0,"remove"===e.action&&("number"!=typeof o||o<0))throw new Error("Expect the data of remove action to be a positive number, got "+o);e.data=o}if(null==e.data)throw new Error("Expect data to have a non-empty value, got "+e.data);var i=t.attributes;if(i){var a=typeof i;if("object"===a)if(Object.keys(i).length){var s=u.pack(i);s&&e.attributes!==s&&(r=!0,e.attributes=s)}else e.attributes&&(r=!0,delete e.attributes);else"string"===a&&e.attributes!==i&&(r=!0,e.attributes=i)}return{changed:r,op:e}}},{key:"set",value:function(t){var e=this._genericSet(t),r=e.changed,n=e.op;return r?this.createInstance(n):this}},{key:"setWithMutations",value:function(t){var e=this._genericSet(t).op;return this.action=e.action,this.data=e.data,this.attributes=e.attributes,this}},{key:"createInstance",value:function(t){return new this.constructor(t)}},{key:"toJSON",value:function(){return this.pack()}},{key:"pack",value:function(){var t=void 0;switch(this.action){case"insert":t=0;break;case"remove":t=1;break;case"retain":t=2}var e="function"==typeof this.data.pack?this.data.pack():this.data,r=[Number(""+this.constructor.packId+t),e];return this.attributes&&r.push(this.attributes),r}},{key:"getEmbedObject",value:function(){throw new Error("#getEmbedObject() not implemented")}},{key:"isEmpty",value:function(){return"retain"===this.action&&!this.attributes&&"number"==typeof this.data}},{key:"getAttributes",value:function(){return u.unpack(this.attributes)}},{key:"merge",value:function(t){if(this.name()!==t.name())return!1;var e=typeof this.data;return!(this.action!==t.action||e!==typeof t.data||"number"!==e&&"string"!==e||this.attributes!==t.attributes)&&t.set({data:t.data+this.data})}},{key:"compose",value:function(t){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be composed");if(this.constructor.packId!==t.constructor.packId&&!this.isGeneric()&&!t.isGeneric())throw new Error('Failed to compose operators. Expect constructor "'+t.constructor.name+'" to equal "'+this.constructor.name+'"');var e=void 0;return e="function"==typeof this.data.compose&&t.data.constructor.packId===this.data.constructor.packId?this.data.compose(t.data):"number"==typeof this.data?t.data:this.data,(this.isGeneric()?t:this).createInstance({data:e,attributes:u.merge(this.attributes,t.attributes,"insert"!==this.action),action:this.action})}},{key:"invert",value:function(t){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.constructor.name+")");if("retain"!==t.action)throw new Error("Only retaining operator can be inverted");if(this.constructor.packId!==t.constructor.packId&&!t.isGeneric())throw new Error('Failed to invert operators. Expect constructor "'+t.constructor.name+'" to equal "'+this.constructor.name+'"');var e=void 0;return e="function"==typeof this.data.invert&&t.data.constructor.packId===this.data.constructor.packId?this.data.invert(t.data):"number"==typeof t.data?t.data:this.data,this.createInstance({data:e,attributes:u.invert(this.attributes,t.attributes),action:"retain"})}},{key:"transform",value:function(t,e){if("retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be transformd");if(this.constructor.packId!==t.constructor.packId&&!t.isGeneric()&&!this.isGeneric())throw new Error('Failed to transform operators. Expect constructor "'+t.constructor.name+'" to equal "'+this.constructor.name+'"');return(this.isGeneric()?t:this).createInstance({attributes:u.transform(this.attributes,t.attributes,e),action:"retain",data:"function"==typeof this.data.transform&&"function"==typeof t.data.transform?this.data.transform(t.data,e):t.data})}},{key:"print",value:function(){var t=[this.action+": %c"+this.name(),"color: #51c6ed"];this.attributes&&(t[0]=t[0]+"%c, %O",t.push("font-weight: normal; color: #000",this.attributes.toJS())),console.groupCollapsed.apply(console,t),function t(e){"function"==typeof e.pack?e.print():"object"==typeof e?Object.keys(e).forEach(function(r){var n=e[r];console.groupCollapsed(r),t(n),console.groupEnd()}):console.log(e)}(this.data),console.groupEnd()}},{key:"length",get:function(){switch(typeof this.data){case"number":return this.data;case"string":return this.data.length;default:return 1}}}],[{key:"unpack",value:function(t){var e=n(t,3),r=e[0],o=e[1],a=e[2];return new this({action:["insert","remove","retain"][r],data:Array.isArray(o)?i.unpack(o):o,attributes:a})}},{key:"insert",value:function(t,e){return new this({action:"insert",data:t,attributes:e})}},{key:"retain",value:function(t,e){return new this({action:"retain",data:t,attributes:e})}},{key:"remove",value:function(t){return new this({action:"remove",data:t})}}]),t}();c.packId=1,t.exports=c},function(t,e,r){var n=r(57),o=r(68),i=r(155),a=r(9),u=r(29),s=r(10),c=Object.prototype,f=c.hasOwnProperty,l=!c.propertyIsEnumerable.call({valueOf:1},"valueOf"),p=i(function(t,e){if(l||u(e)||a(e))o(e,s(e),t);else for(var r in e)f.call(e,r)&&n(t,r,e[r])});t.exports=p},function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isRetina=function(){return window.devicePixelRatio>=2},e.isDingTalk=function(){return/dingtalk/i.test(r)},e.isDingtalk=function(){return!!r.match(/mobile.*dingtalk/i)},e.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},e.isWechatPc=n,e.isWechat=function(){return!!/micromessenger/.test(r)&&!n()},e.isMobile=function(){return!n()&&!!r.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},e.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},e.isIOS=o,e.isAndroid=function(){return!!/(android)/g.test(r)},e.isAndroidApp=function(){return!!/shimo-android-app/g.test(r)},e.isIE=function(){return!!window.ActiveXObject},e.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},e.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},e.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},e.isWebIOS=function(){if(!window.cow.iOS&&o())return!0;return!1},e.isIphone6=function(){var t=!1;o()&&screen.height>568&&(t=!0);return t};var r=window.navigator.userAgent.toLowerCase();function n(){return!!/micromessenger.*?windowswechat/.test(r)}function o(){return!!/(ipad|iphone|ipod)/g.test(r)}},,,,,,,,,,,,function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var o=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(n),i=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[r].concat(i).concat([o]).join("\n")}return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r}).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(n[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),e.push(a))}},e}},function(t,e,r){var n={},o=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),i=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var r=function(t){return document.querySelector(t)}.call(this,t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),a=null,u=0,s=[],c=r(201);function f(t,e){for(var r=0;r<t.length;r++){var o=t[r],i=n[o.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](o.parts[a]);for(;a<o.parts.length;a++)i.parts.push(m(o.parts[a],e))}else{var u=[];for(a=0;a<o.parts.length;a++)u.push(m(o.parts[a],e));n[o.id]={id:o.id,refs:1,parts:u}}}}function l(t,e){for(var r=[],n={},o=0;o<t.length;o++){var i=t[o],a=e.base?i[0]+e.base:i[0],u={css:i[1],media:i[2],sourceMap:i[3]};n[a]?n[a].parts.push(u):r.push(n[a]={id:a,parts:[u]})}return r}function p(t,e){var r=i(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=s[s.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),s.push(e);else if("bottom"===t.insertAt)r.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=i(t.insertInto+" "+t.insertAt.before);r.insertBefore(e,o)}}function d(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=s.indexOf(t);e>=0&&s.splice(e,1)}function h(t){var e=document.createElement("style");return t.attrs.type="text/css",v(e,t.attrs),p(t,e),e}function v(t,e){Object.keys(e).forEach(function(r){t.setAttribute(r,e[r])})}function m(t,e){var r,n,o,i;if(e.transform&&t.css){if(!(i=e.transform(t.css)))return function(){};t.css=i}if(e.singleton){var s=u++;r=a||(a=h(e)),n=b.bind(null,r,s,!1),o=b.bind(null,r,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",v(e,t.attrs),p(t,e),e}(e),n=function(t,e,r){var n=r.css,o=r.sourceMap,i=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||i)&&(n=c(n));o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([n],{type:"text/css"}),u=t.href;t.href=URL.createObjectURL(a),u&&URL.revokeObjectURL(u)}.bind(null,r,e),o=function(){d(r),r.href&&URL.revokeObjectURL(r.href)}):(r=h(e),n=function(t,e){var r=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}.bind(null,r),o=function(){d(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var r=l(t,e);return f(r,e),function(t){for(var o=[],i=0;i<r.length;i++){var a=r[i];(u=n[a.id]).refs--,o.push(u)}t&&f(l(t,e),e);for(i=0;i<o.length;i++){var u;if(0===(u=o[i]).refs){for(var s=0;s<u.parts.length;s++)u.parts[s]();delete n[u.id]}}}};var y=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}();function b(t,e,r,n){var o=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=y(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(602);e.Delta=n.Delta;var o=r(603);e.Pool=o.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(539);e.assert=function(t,e){if(!t)throw new Error(e)},e.assertNever=function(t){throw new TypeError("Unexpected type: "+JSON.stringify(t))},e.softAssertNever=function(t){n.isDebugging&&console.warn("Unexpected type:",t)}},,,function(t,e,r){"use strict";(function(e){var n=r(24),o=r(316),i={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var u={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=r(218):void 0!==e&&(t=r(218)),t}(),transformRequest:[function(t,e){return o(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],function(t){u.headers[t]={}}),n.forEach(["post","put","patch"],function(t){u.headers[t]=n.merge(i)}),t.exports=u}).call(e,r(180))},function(t,e){var r,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s,c=[],f=!1,l=-1;function p(){f&&s&&(f=!1,s.length?c=s.concat(c):l=-1,c.length&&d())}function d(){if(!f){var t=u(p);f=!0;for(var e=c.length;e;){for(s=c,c=[];++l<e;)s&&s[l].run();l=-1,e=c.length}s=null,f=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new h(t,e)),1!==c.length||f||u(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},,function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(118),a=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.render=function(){return o.a.createElement(i.a,{head:o.a.createElement("span",{className:"tabMenuHead"},this.props.tabName()),customClass:"tabMenu",disabled:this.props.disabled,onOpen:this.props.onOpen},this.props.children)},e}(o.a.Component);e.a=u},function(t,e,r){"use strict";e.a=function(t){return o.a.createElement(i.a,{head:o.a.cloneElement(t.head,{className:"dropMenuHead indicator "+(t.head.props.className||"")}),disabled:t.disabled,customClass:t.customClass,onClose:t.onClose},t.children)};var n=r(0),o=r.n(n),i=r(118)},function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(23),a=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u=function(t){function e(e){var r=t.call(this,e)||this;return r.showSubMenu=function(){r.setState({showSubMenu:!0})},r.hideSubMenu=function(t){r.notReallyLeaveMe(t)||r.setState({showSubMenu:!1,style:null})},r.adjustStyle=function(){var t=window.innerHeight,e=window.innerWidth,n=r.refs.itemDom,o=r.refs.contentDom.getBoundingClientRect(),i=o.right,a=o.height,u=n.getBoundingClientRect(),s=u.bottom,c=u.left,f=u.right,l=u.top,p=r.getRefPosition(),d=p.left,h=p.top,v={position:"fixed",transform:"translateX(0)",left:f-1-d,top:l-h,overflowX:"hidden"},m=s-78,y=t-s-30;a>y&&(a<m||y/t<.25?(v.maxHeight=m,v.top=s-Math.min(a,m)-h,a>m&&(v.overflowY="auto")):(v.maxHeight=y,v.overflowY="auto")),e-i<50&&(v.left=c-d,v.transform="translateX(-100%)"),r.setState({style:v})},r.state={showSubMenu:!1,style:null},r}return a(e,t),e.prototype.componentDidUpdate=function(t,e){this.state.showSubMenu&&!e.showSubMenu&&this.adjustStyle()},e.prototype.render=function(){return o.a.createElement("div",{ref:"containerDom",className:"menu--submenu",onMouseLeave:this.hideSubMenu},o.a.createElement("div",{ref:"itemDom",className:"menuItem "+(this.props.disabled?"disabled":""),onMouseEnter:this.showSubMenu},void 0!==this.props.icon&&o.a.createElement("span",{className:"menuItem--icon "+(this.props.icon?"icon--"+this.props.icon:"")}),o.a.createElement("span",{className:"menuItem--text"},this.props.text),o.a.createElement("span",{className:"menuItem--placer"}),o.a.createElement("span",{className:"menuItem--arrow"})),this.state.showSubMenu&&o.a.createElement("div",{ref:"contentDom",className:"menu--content menu--content__submenu",style:this.state.style},this.props.children))},e.prototype.getRefPosition=function(){if(i.b)return{left:0,top:0};for(var t=this.refs.containerDom;t.parentElement;){var e=getComputedStyle(t);if("static"!==e.position&&"none"!==e.transform)break;t=t.parentElement}var r=t.getBoundingClientRect(),n=r.left;return{top:r.top,left:n}},e.prototype.notReallyLeaveMe=function(t){var e=t.pageX,r=t.pageY,n=this.refs.itemDom.getBoundingClientRect(),o=n.left,i=n.top,a=n.right,u=n.bottom;return e>o&&e<a&&r>i&&r<u},e}(o.a.Component);e.a=u},function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(119),a=r(120),u=r(23),s=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.render=function(){var t=this,e="fake"===this.props.disabled?"fakeDisabled":this.props.disabled?"disabled":"",r=this.props.customClass||"";return o.a.createElement(i.a.Consumer,null,function(n){return o.a.createElement("div",{className:"menuItem tooltip--docker "+e+" "+r,onClick:function(){return t.onClick(n)}},void 0!==t.props.checked&&o.a.createElement("span",{className:"menuItem--check "+(t.props.checked?"menuItem--check__checked":"")}),void 0!==t.props.icon&&t.getIcon(t.props.icon),t.props.text&&o.a.createElement("span",{className:"menuItem--text"},t.props.text),t.props.text&&o.a.createElement("span",{className:"menuItem--placer"}),t.props.children)})},e.prototype.onClick=function(t){!this.props.disabled&&this.props.onTap&&this.props.onTap(),setTimeout(function(){return t.closeMenu()})},e.prototype.getIcon=function(t){return Object(u.c)(t)?o.a.createElement("span",{className:"menuItem--icon",style:Object(a.a)(t)}):o.a.createElement("span",{className:"menuItem--icon "+(t?"icon--"+t:"")})},e}(o.a.Component);e.a=c},function(t,e,r){"use strict";e.a=function(){return o.a.createElement("div",{className:"menu--divider"})};var n=r(0),o=r.n(n)},function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(23),a=r(120),u=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onTap=function(){e.props.onTap&&e.props.onTap()},e}return u(e,t),e.prototype.render=function(){var t="toolBar--iconBtn "+(this.props.disabled?"disabled":"")+" "+(this.props.selected?"selected":"")+" indicator";return this.props.children?o.a.createElement("span",{className:t+" tooltip--docker",onClick:this.onTap},this.getIcon(this.props.icon)):this.props.tooltip?o.a.createElement("span",{className:t,"data-tooltip":this.props.tooltip,onClick:this.onTap},this.getIcon(this.props.icon)):o.a.createElement("span",{className:t,onClick:this.onTap},this.getIcon(this.props.icon))},e.prototype.getIcon=function(t){return Object(i.c)(t)?o.a.createElement("span",{style:Object(a.a)(t)},this.props.children):o.a.createElement("span",{className:"toolBar--icon icon--"+t},this.props.children)},e}(o.a.Component);e.a=s},function(t,e,r){"use strict";e.a=function(t){return t.option?o.a.createElement("span",{className:"tooltip tooltip__"+(t.direction||"down")},o.a.createElement("span",null,t.option),t.detail&&o.a.createElement("br",null),t.detail&&o.a.createElement("span",null,t.detail)):null};var n=r(0),o=r.n(n)},function(t,e,r){"use strict";e.d=function(t){return o.a.createElement("span",{className:c(t,"toolBar--tool")},t.children)},r.d(e,"c",function(){return f}),e.a=function(t){return o.a.createElement("span",{className:c(t,"toolBar--iconDropTool indicator "+(t.selected?"fakeIndicator":""))},t.children)},e.b=function(t){return o.a.createElement("span",{className:c(t,"toolBar--tool toolBar--tool__oneline")},t.children)},e.e=function(t){return o.a.createElement("span",{className:c(t,"toolBar--tool toolBar--tool__twolines")},t.children)};var n=r(0),o=r.n(n),i=r(23),a=r(47),u=r.n(a),s=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function c(t,e){var r,n=t.disabled,o=t.customClass;return u()(((r={})[e]=!0,r[o||""]=o,r.disabled=n,r))}var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delegateClick=function(t){var r=e.refs.textTool,n=r.lastElementChild;if(t.target===r||t.target===n){var o=r.querySelector(".toolBar--icon");setTimeout(function(){return Object(i.e)(o)})}},e}return s(e,t),e.prototype.render=function(){return o.a.createElement("span",{ref:"textTool",className:c(this.props,"toolBar--tool toolBar--textTool"),onClick:this.delegateClick},this.props.children)},e}(o.a.Component)},,,,function(t,e){var r=t.exports={version:"2.6.9"};"number"==typeof __e&&(__e=r)},function(t,e,r){var n=r(531)("wks"),o=r(530),i=r(282).Symbol,a="function"==typeof i;(t.exports=function(t){return n[t]||(n[t]=a&&i[t]||(a?i:o)("Symbol."+t))}).store=n},,,,,,function(t,e){t.exports=function(t){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)?'"'+t.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':t)}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,n=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var o,i=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?t:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?r+i:n+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},,,,,,,,,,,,,,,function(t,e,r){t.exports=r(313)},function(t,e,r){"use strict";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},function(t,e,r){"use strict";var n=r(24),o=r(317),i=r(319),a=r(320),u=r(321),s=r(219);t.exports=function(t){return new Promise(function(e,c){var f=t.data,l=t.headers;n.isFormData(f)&&delete l["Content-Type"];var p=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",h=t.auth.password||"";l.Authorization="Basic "+btoa(d+":"+h)}if(p.open(t.method.toUpperCase(),i(t.url,t.params,t.paramsSerializer),!0),p.timeout=t.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,n={data:t.responseType&&"text"!==t.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:r,config:t,request:p};o(e,c,n),p=null}},p.onerror=function(){c(s("Network Error",t,null,p)),p=null},p.ontimeout=function(){c(s("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",p)),p=null},n.isStandardBrowserEnv()){var v=r(322),m=(t.withCredentials||u(t.url))&&t.xsrfCookieName?v.read(t.xsrfCookieName):void 0;m&&(l[t.xsrfHeaderName]=m)}if("setRequestHeader"in p&&n.forEach(l,function(t,e){void 0===f&&"content-type"===e.toLowerCase()?delete l[e]:p.setRequestHeader(e,t)}),t.withCredentials&&(p.withCredentials=!0),t.responseType)try{p.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&p.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){p&&(p.abort(),c(t),p=null)}),void 0===f&&(f=null),p.send(f)})}},function(t,e,r){"use strict";var n=r(318);t.exports=function(t,e,r,o,i){var a=new Error(t);return n(a,e,r,o,i)}},function(t,e,r){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,r){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e){var r=9007199254740991,n="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",a=/^(?:0|[1-9]\d*)$/;var u=Object.prototype,s=u.hasOwnProperty,c=u.toString,f=u.propertyIsEnumerable,l=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),p=Math.max,d=!f.call({valueOf:1},"valueOf");function h(t,e){var r=g(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&w(t)}(t)&&s.call(t,"callee")&&(!f.call(t,"callee")||c.call(t)==n)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],o=r.length,i=!!o;for(var a in t)!e&&!s.call(t,a)||i&&("length"==a||m(a,o))||r.push(a);return r}function v(t,e,r){var n=t[e];s.call(t,e)&&b(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function m(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||a.test(t))&&t>-1&&t%1==0&&t<e}function y(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||u)}function b(t,e){return t===e||t!=t&&e!=e}var g=Array.isArray;function w(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!function(t){var e=_(t)?c.call(t):"";return e==o||e==i}(t)}function _(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var O=function(t){return function(t,e){return e=p(void 0===e?t.length-1:e,0),function(){for(var r=arguments,n=-1,o=p(r.length-e,0),i=Array(o);++n<o;)i[n]=r[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=r[n];return a[e]=i,function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,a)}}(function(e,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(t,e,r){if(!_(r))return!1;var n=typeof e;return!!("number"==n?w(r)&&m(e,r.length):"string"==n&&e in r)&&b(r[e],t)}(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),e=Object(e);++n<o;){var u=r[n];u&&t(e,u,n,i)}return e})}(function(t,e){if(d||y(e)||w(e))!function(t,e,r,n){r||(r={});for(var o=-1,i=e.length;++o<i;){var a=e[o],u=n?n(r[a],t[a],a,r,t):void 0;v(r,a,void 0===u?t[a]:u)}}(e,function(t){return w(t)?h(t):function(t){if(!y(t))return l(t);var e=[];for(var r in Object(t))s.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}(e),t);else for(var r in e)s.call(e,r)&&v(t,r,e[r])});t.exports=O},,,,,,,,,,,,,,function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var i=r(157),a=r(159),u=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),n(e,[{key:"setData",value:function(t){if(function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),"number"==typeof this.data&&1!==this.data)throw new Error('The value of data should be "1", got '+this.data);return this}},{key:"name",value:function(){return"CellOperator"}},{key:"compose",value:function(t){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be composed");var e=void 0;if("function"==typeof this.data.compose&&t.data.constructor.packId===this.data.constructor.packId)e=void 0!==i.unpack(t.attributes).cellValue?t.data:this.data.compose(t.data);else if("number"==typeof this.data)e=t.data;else{e=void 0!==i.unpack(t.attributes).cellValue?1:this.data}return(this.isGeneric()?t:this).createInstance({data:e,attributes:i.merge(this.attributes,t.attributes,"insert"!==this.action),action:this.action})}},{key:"invert",value:function(t){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.constructor.name+")");if("retain"!==t.action)throw new Error("Only retaining operator can be inverted");var e=void 0;if("function"==typeof this.data.invert&&t.data.constructor.packId===this.data.constructor.packId)e=void 0!==i.unpack(t.attributes).cellValue?this.data:this.data.invert(t.data);else if("number"==typeof t.data){e=void 0!==i.unpack(t.attributes).cellValue?this.data:t.data}else e=this.data;return this.createInstance({data:e,attributes:i.invert(this.attributes,t.attributes),action:"retain"})}}]),e}();u.packId=4,t.exports=u},,function(t,e,r){var n=r(282),o=r(193),i=r(391),a=r(616),u=r(532),s=function(t,e,r){var c,f,l,p,d=t&s.F,h=t&s.G,v=t&s.S,m=t&s.P,y=t&s.B,b=h?n:v?n[e]||(n[e]={}):(n[e]||{}).prototype,g=h?o:o[e]||(o[e]={}),w=g.prototype||(g.prototype={});for(c in h&&(r=e),r)l=((f=!d&&b&&void 0!==b[c])?b:r)[c],p=y&&f?u(l,n):m&&"function"==typeof l?u(Function.call,l):l,b&&a(b,c,l,t&s.U),g[c]!=l&&i(g,c,p),m&&w[c]!=l&&(w[c]=l)};n.core=o,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},,,,,,,function(t,e,r){(function(t,r){var n=200,o="Expected a function",i="__lodash_hash_undefined__",a=1,u=2,s=1/0,c=9007199254740991,f="[object Arguments]",l="[object Array]",p="[object Boolean]",d="[object Date]",h="[object Error]",v="[object Function]",m="[object GeneratorFunction]",y="[object Map]",b="[object Number]",g="[object Object]",w="[object RegExp]",_="[object Set]",O="[object String]",x="[object Symbol]",j="[object ArrayBuffer]",k="[object DataView]",C=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,E=/^\w*$/,A=/^\./,I=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,S=/\\(\\)?/g,T=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,M={};M["[object Float32Array]"]=M["[object Float64Array]"]=M["[object Int8Array]"]=M["[object Int16Array]"]=M["[object Int32Array]"]=M["[object Uint8Array]"]=M["[object Uint8ClampedArray]"]=M["[object Uint16Array]"]=M["[object Uint32Array]"]=!0,M[f]=M[l]=M[j]=M[p]=M[k]=M[d]=M[h]=M[v]=M[y]=M[b]=M[g]=M[w]=M[_]=M[O]=M["[object WeakMap]"]=!1;var F="object"==typeof t&&t&&t.Object===Object&&t,D="object"==typeof self&&self&&self.Object===Object&&self,N=F||D||Function("return this")(),R="object"==typeof e&&e&&!e.nodeType&&e,L=R&&"object"==typeof r&&r&&!r.nodeType&&r,G=L&&L.exports===R&&F.process,U=function(){try{return G&&G.binding("util")}catch(t){}}(),z=U&&U.isTypedArray;function V(t,e,r,n){var o=-1,i=t?t.length:0;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function B(t,e){for(var r=-1,n=t?t.length:0;++r<n;)if(e(t[r],r,t))return!0;return!1}function $(t,e,r,n,o){return o(t,function(t,o,i){r=n?(n=!1,t):e(r,t,o,i)}),r}function q(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function H(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function J(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var Y=Array.prototype,W=Function.prototype,Q=Object.prototype,K=N["__core-js_shared__"],Z=function(){var t=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),X=W.toString,tt=Q.hasOwnProperty,et=Q.toString,rt=RegExp("^"+X.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nt=N.Symbol,ot=N.Uint8Array,it=Q.propertyIsEnumerable,at=Y.splice,ut=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),st=Ut(N,"DataView"),ct=Ut(N,"Map"),ft=Ut(N,"Promise"),lt=Ut(N,"Set"),pt=Ut(N,"WeakMap"),dt=Ut(Object,"create"),ht=Yt(st),vt=Yt(ct),mt=Yt(ft),yt=Yt(lt),bt=Yt(pt),gt=nt?nt.prototype:void 0,wt=gt?gt.valueOf:void 0,_t=gt?gt.toString:void 0;function Ot(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function xt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function jt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function kt(t){var e=-1,r=t?t.length:0;for(this.__data__=new jt;++e<r;)this.add(t[e])}function Ct(t){this.__data__=new xt(t)}function Et(t,e){var r=Zt(t)||Kt(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!tt.call(t,i)||o&&("length"==i||Vt(i,n))||r.push(i);return r}function At(t,e){for(var r=t.length;r--;)if(Qt(t[r][0],e))return r;return-1}Ot.prototype.clear=function(){this.__data__=dt?dt(null):{}},Ot.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Ot.prototype.get=function(t){var e=this.__data__;if(dt){var r=e[t];return r===i?void 0:r}return tt.call(e,t)?e[t]:void 0},Ot.prototype.has=function(t){var e=this.__data__;return dt?void 0!==e[t]:tt.call(e,t)},Ot.prototype.set=function(t,e){return this.__data__[t]=dt&&void 0===e?i:e,this},xt.prototype.clear=function(){this.__data__=[]},xt.prototype.delete=function(t){var e=this.__data__,r=At(e,t);return!(r<0||(r==e.length-1?e.pop():at.call(e,r,1),0))},xt.prototype.get=function(t){var e=this.__data__,r=At(e,t);return r<0?void 0:e[r][1]},xt.prototype.has=function(t){return At(this.__data__,t)>-1},xt.prototype.set=function(t,e){var r=this.__data__,n=At(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},jt.prototype.clear=function(){this.__data__={hash:new Ot,map:new(ct||xt),string:new Ot}},jt.prototype.delete=function(t){return Gt(this,t).delete(t)},jt.prototype.get=function(t){return Gt(this,t).get(t)},jt.prototype.has=function(t){return Gt(this,t).has(t)},jt.prototype.set=function(t,e){return Gt(this,t).set(t,e),this},kt.prototype.add=kt.prototype.push=function(t){return this.__data__.set(t,i),this},kt.prototype.has=function(t){return this.__data__.has(t)},Ct.prototype.clear=function(){this.__data__=new xt},Ct.prototype.delete=function(t){return this.__data__.delete(t)},Ct.prototype.get=function(t){return this.__data__.get(t)},Ct.prototype.has=function(t){return this.__data__.has(t)},Ct.prototype.set=function(t,e){var r=this.__data__;if(r instanceof xt){var o=r.__data__;if(!ct||o.length<n-1)return o.push([t,e]),this;r=this.__data__=new jt(o)}return r.set(t,e),this};var It=function(t,e){return function(r,n){if(null==r)return r;if(!Xt(r))return t(r,n);for(var o=r.length,i=e?o:-1,a=Object(r);(e?i--:++i<o)&&!1!==n(a[i],i,a););return r}}(function(t,e){return t&&St(t,e,ae)}),St=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var s=a[t?u:++o];if(!1===r(i[s],s,i))break}return e}}();function Tt(t,e){for(var r=0,n=(e=Bt(e,t)?[e]:Rt(e)).length;null!=t&&r<n;)t=t[Jt(e[r++])];return r&&r==n?t:void 0}function Pt(t,e){return null!=t&&e in Object(t)}function Mt(t,e,r,n,o){return t===e||(null==t||null==e||!re(t)&&!ne(e)?t!=t&&e!=e:function(t,e,r,n,o,i){var s=Zt(t),c=Zt(e),v=l,m=l;s||(v=(v=zt(t))==f?g:v);c||(m=(m=zt(e))==f?g:m);var C=v==g&&!q(t),E=m==g&&!q(e),A=v==m;if(A&&!C)return i||(i=new Ct),s||ie(t)?Lt(t,e,r,n,o,i):function(t,e,r,n,o,i,s){switch(r){case k:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case j:return!(t.byteLength!=e.byteLength||!n(new ot(t),new ot(e)));case p:case d:case b:return Qt(+t,+e);case h:return t.name==e.name&&t.message==e.message;case w:case O:return t==e+"";case y:var c=H;case _:var f=i&u;if(c||(c=J),t.size!=e.size&&!f)return!1;var l=s.get(t);if(l)return l==e;i|=a,s.set(t,e);var v=Lt(c(t),c(e),n,o,i,s);return s.delete(t),v;case x:if(wt)return wt.call(t)==wt.call(e)}return!1}(t,e,v,r,n,o,i);if(!(o&u)){var I=C&&tt.call(t,"__wrapped__"),S=E&&tt.call(e,"__wrapped__");if(I||S){var T=I?t.value():t,P=S?e.value():e;return i||(i=new Ct),r(T,P,n,o,i)}}if(!A)return!1;return i||(i=new Ct),function(t,e,r,n,o,i){var a=o&u,s=ae(t),c=s.length,f=ae(e).length;if(c!=f&&!a)return!1;for(var l=c;l--;){var p=s[l];if(!(a?p in e:tt.call(e,p)))return!1}var d=i.get(t);if(d&&i.get(e))return d==e;var h=!0;i.set(t,e),i.set(e,t);for(var v=a;++l<c;){p=s[l];var m=t[p],y=e[p];if(n)var b=a?n(y,m,p,e,t,i):n(m,y,p,t,e,i);if(!(void 0===b?m===y||r(m,y,n,o,i):b)){h=!1;break}v||(v="constructor"==p)}if(h&&!v){var g=t.constructor,w=e.constructor;g!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof g&&g instanceof g&&"function"==typeof w&&w instanceof w)&&(h=!1)}return i.delete(t),i.delete(e),h}(t,e,r,n,o,i)}(t,e,Mt,r,n,o))}function Ft(t){return!(!re(t)||function(t){return!!Z&&Z in t}(t))&&(te(t)||q(t)?rt:T).test(Yt(t))}function Dt(t){return"function"==typeof t?t:null==t?ue:"object"==typeof t?Zt(t)?function(t,e){if(Bt(t)&&$t(e))return qt(Jt(t),e);return function(r){var n=function(t,e,r){var n=null==t?void 0:Tt(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?function(t,e){return null!=t&&function(t,e,r){var n,o=-1,i=(e=Bt(e,t)?[e]:Rt(e)).length;for(;++o<i;){var a=Jt(e[o]);if(!(n=null!=t&&r(t,a)))break;t=t[a]}if(n)return n;return!!(i=t?t.length:0)&&ee(i)&&Vt(a,i)&&(Zt(t)||Kt(t))}(t,e,Pt)}(r,t):Mt(e,n,void 0,a|u)}}(t[0],t[1]):function(t){var e=function(t){var e=ae(t),r=e.length;for(;r--;){var n=e[r],o=t[n];e[r]=[n,o,$t(o)]}return e}(t);if(1==e.length&&e[0][2])return qt(e[0][0],e[0][1]);return function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,s=!n;if(null==t)return!i;for(t=Object(t);o--;){var c=r[o];if(s&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<i;){var f=(c=r[o])[0],l=t[f],p=c[1];if(s&&c[2]){if(void 0===l&&!(f in t))return!1}else{var d=new Ct;if(n)var h=n(l,p,f,t,e,d);if(!(void 0===h?Mt(p,l,n,a|u,d):h))return!1}}return!0}(r,t,e)}}(t):function(t){return Bt(t)?function(t){return function(e){return null==e?void 0:e[t]}}(Jt(t)):function(t){return function(e){return Tt(e,t)}}(t)}(t)}function Nt(t){if(!function(t){var e=t&&t.constructor,r="function"==typeof e&&e.prototype||Q;return t===r}(t))return ut(t);var e=[];for(var r in Object(t))tt.call(t,r)&&"constructor"!=r&&e.push(r);return e}function Rt(t){return Zt(t)?t:Ht(t)}function Lt(t,e,r,n,o,i){var s=o&u,c=t.length,f=e.length;if(c!=f&&!(s&&f>c))return!1;var l=i.get(t);if(l&&i.get(e))return l==e;var p=-1,d=!0,h=o&a?new kt:void 0;for(i.set(t,e),i.set(e,t);++p<c;){var v=t[p],m=e[p];if(n)var y=s?n(m,v,p,e,t,i):n(v,m,p,t,e,i);if(void 0!==y){if(y)continue;d=!1;break}if(h){if(!B(e,function(t,e){if(!h.has(e)&&(v===t||r(v,t,n,o,i)))return h.add(e)})){d=!1;break}}else if(v!==m&&!r(v,m,n,o,i)){d=!1;break}}return i.delete(t),i.delete(e),d}function Gt(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map}function Ut(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Ft(r)?r:void 0}var zt=function(t){return et.call(t)};function Vt(t,e){return!!(e=null==e?c:e)&&("number"==typeof t||P.test(t))&&t>-1&&t%1==0&&t<e}function Bt(t,e){if(Zt(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!oe(t))||(E.test(t)||!C.test(t)||null!=e&&t in Object(e))}function $t(t){return t==t&&!re(t)}function qt(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}(st&&zt(new st(new ArrayBuffer(1)))!=k||ct&&zt(new ct)!=y||ft&&"[object Promise]"!=zt(ft.resolve())||lt&&zt(new lt)!=_||pt&&"[object WeakMap]"!=zt(new pt))&&(zt=function(t){var e=et.call(t),r=e==g?t.constructor:void 0,n=r?Yt(r):void 0;if(n)switch(n){case ht:return k;case vt:return y;case mt:return"[object Promise]";case yt:return _;case bt:return"[object WeakMap]"}return e});var Ht=Wt(function(t){t=function(t){return null==t?"":function(t){if("string"==typeof t)return t;if(oe(t))return _t?_t.call(t):"";var e=t+"";return"0"==e&&1/t==-s?"-0":e}(t)}(t);var e=[];return A.test(t)&&e.push(""),t.replace(I,function(t,r,n,o){e.push(n?o.replace(S,"$1"):r||t)}),e});function Jt(t){if("string"==typeof t||oe(t))return t;var e=t+"";return"0"==e&&1/t==-s?"-0":e}function Yt(t){if(null!=t){try{return X.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Wt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(o);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(Wt.Cache||jt),r}function Qt(t,e){return t===e||t!=t&&e!=e}function Kt(t){return function(t){return ne(t)&&Xt(t)}(t)&&tt.call(t,"callee")&&(!it.call(t,"callee")||et.call(t)==f)}Wt.Cache=jt;var Zt=Array.isArray;function Xt(t){return null!=t&&ee(t.length)&&!te(t)}function te(t){var e=re(t)?et.call(t):"";return e==v||e==m}function ee(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function re(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function ne(t){return!!t&&"object"==typeof t}function oe(t){return"symbol"==typeof t||ne(t)&&et.call(t)==x}var ie=z?function(t){return function(e){return t(e)}}(z):function(t){return ne(t)&&ee(t.length)&&!!M[et.call(t)]};function ae(t){return Xt(t)?Et(t):Nt(t)}function ue(t){return t}r.exports=function(t,e,r){var n=Zt(t)?V:$,o=arguments.length<3;return n(t,Dt(e),r,o,It)}}).call(e,r(20),r(27)(t))},function(t,e,r){(function(t,r){var n=200,o="__lodash_hash_undefined__",i=9007199254740991,a="[object Arguments]",u="[object Boolean]",s="[object Date]",c="[object Function]",f="[object GeneratorFunction]",l="[object Map]",p="[object Number]",d="[object Object]",h="[object RegExp]",v="[object Set]",m="[object String]",y="[object Symbol]",b="[object ArrayBuffer]",g="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",O="[object Int8Array]",x="[object Int16Array]",j="[object Int32Array]",k="[object Uint8Array]",C="[object Uint8ClampedArray]",E="[object Uint16Array]",A="[object Uint32Array]",I=/\w*$/,S=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,P={};P[a]=P["[object Array]"]=P[b]=P[g]=P[u]=P[s]=P[w]=P[_]=P[O]=P[x]=P[j]=P[l]=P[p]=P[d]=P[h]=P[v]=P[m]=P[y]=P[k]=P[C]=P[E]=P[A]=!0,P["[object Error]"]=P[c]=P["[object WeakMap]"]=!1;var M="object"==typeof t&&t&&t.Object===Object&&t,F="object"==typeof self&&self&&self.Object===Object&&self,D=M||F||Function("return this")(),N="object"==typeof e&&e&&!e.nodeType&&e,R=N&&"object"==typeof r&&r&&!r.nodeType&&r,L=R&&R.exports===N;function G(t,e){return t.set(e[0],e[1]),t}function U(t,e){return t.add(e),t}function z(t,e,r,n){var o=-1,i=t?t.length:0;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function V(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function B(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function $(t,e){return function(r){return t(e(r))}}function q(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var H=Array.prototype,J=Function.prototype,Y=Object.prototype,W=D["__core-js_shared__"],Q=function(){var t=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),K=J.toString,Z=Y.hasOwnProperty,X=Y.toString,tt=RegExp("^"+K.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=L?D.Buffer:void 0,rt=D.Symbol,nt=D.Uint8Array,ot=$(Object.getPrototypeOf,Object),it=Object.create,at=Y.propertyIsEnumerable,ut=H.splice,st=Object.getOwnPropertySymbols,ct=et?et.isBuffer:void 0,ft=$(Object.keys,Object),lt=Nt(D,"DataView"),pt=Nt(D,"Map"),dt=Nt(D,"Promise"),ht=Nt(D,"Set"),vt=Nt(D,"WeakMap"),mt=Nt(Object,"create"),yt=zt(lt),bt=zt(pt),gt=zt(dt),wt=zt(ht),_t=zt(vt),Ot=rt?rt.prototype:void 0,xt=Ot?Ot.valueOf:void 0;function jt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function kt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Ct(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Et(t){this.__data__=new kt(t)}function At(t,e){var r=Bt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&$t(t)}(t)&&Z.call(t,"callee")&&(!at.call(t,"callee")||X.call(t)==a)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!Z.call(t,i)||o&&("length"==i||Gt(i,n))||r.push(i);return r}function It(t,e,r){var n=t[e];Z.call(t,e)&&Vt(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function St(t,e){for(var r=t.length;r--;)if(Vt(t[r][0],e))return r;return-1}function Tt(t,e,r,n,o,i,S){var T;if(n&&(T=i?n(t,o,i,S):n(t)),void 0!==T)return T;if(!Jt(t))return t;var M=Bt(t);if(M){if(T=function(t){var e=t.length,r=t.constructor(e);e&&"string"==typeof t[0]&&Z.call(t,"index")&&(r.index=t.index,r.input=t.input);return r}(t),!e)return function(t,e){var r=-1,n=t.length;e||(e=Array(n));for(;++r<n;)e[r]=t[r];return e}(t,T)}else{var F=Lt(t),D=F==c||F==f;if(qt(t))return function(t,e){if(e)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}(t,e);if(F==d||F==a||D&&!i){if(V(t))return i?t:{};if(T=function(t){return"function"!=typeof t.constructor||Ut(t)?{}:function(t){return Jt(t)?it(t):{}}(ot(t))}(D?{}:t),!e)return function(t,e){return Ft(t,Rt(t),e)}(t,function(t,e){return t&&Ft(e,Yt(e),t)}(T,t))}else{if(!P[F])return i?t:{};T=function(t,e,r,n){var o=t.constructor;switch(e){case b:return Mt(t);case u:case s:return new o(+t);case g:return function(t,e){var r=e?Mt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,n);case w:case _:case O:case x:case j:case k:case C:case E:case A:return function(t,e){var r=e?Mt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,n);case l:return function(t,e,r){return z(e?r(B(t),!0):B(t),G,new t.constructor)}(t,n,r);case p:case m:return new o(t);case h:return function(t){var e=new t.constructor(t.source,I.exec(t));return e.lastIndex=t.lastIndex,e}(t);case v:return function(t,e,r){return z(e?r(q(t),!0):q(t),U,new t.constructor)}(t,n,r);case y:return function(t){return xt?Object(xt.call(t)):{}}(t)}}(t,F,Tt,e)}}S||(S=new Et);var N=S.get(t);if(N)return N;if(S.set(t,T),!M)var R=r?function(t){return function(t,e,r){var n=e(t);return Bt(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,Yt,Rt)}(t):Yt(t);return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(R||t,function(o,i){R&&(o=t[i=o]),It(T,i,Tt(o,e,r,n,i,t,S))}),T}function Pt(t){return!(!Jt(t)||function(t){return!!Q&&Q in t}(t))&&(Ht(t)||V(t)?tt:S).test(zt(t))}function Mt(t){var e=new t.constructor(t.byteLength);return new nt(e).set(new nt(t)),e}function Ft(t,e,r,n){r||(r={});for(var o=-1,i=e.length;++o<i;){var a=e[o],u=n?n(r[a],t[a],a,r,t):void 0;It(r,a,void 0===u?t[a]:u)}return r}function Dt(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map}function Nt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Pt(r)?r:void 0}jt.prototype.clear=function(){this.__data__=mt?mt(null):{}},jt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},jt.prototype.get=function(t){var e=this.__data__;if(mt){var r=e[t];return r===o?void 0:r}return Z.call(e,t)?e[t]:void 0},jt.prototype.has=function(t){var e=this.__data__;return mt?void 0!==e[t]:Z.call(e,t)},jt.prototype.set=function(t,e){return this.__data__[t]=mt&&void 0===e?o:e,this},kt.prototype.clear=function(){this.__data__=[]},kt.prototype.delete=function(t){var e=this.__data__,r=St(e,t);return!(r<0||(r==e.length-1?e.pop():ut.call(e,r,1),0))},kt.prototype.get=function(t){var e=this.__data__,r=St(e,t);return r<0?void 0:e[r][1]},kt.prototype.has=function(t){return St(this.__data__,t)>-1},kt.prototype.set=function(t,e){var r=this.__data__,n=St(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},Ct.prototype.clear=function(){this.__data__={hash:new jt,map:new(pt||kt),string:new jt}},Ct.prototype.delete=function(t){return Dt(this,t).delete(t)},Ct.prototype.get=function(t){return Dt(this,t).get(t)},Ct.prototype.has=function(t){return Dt(this,t).has(t)},Ct.prototype.set=function(t,e){return Dt(this,t).set(t,e),this},Et.prototype.clear=function(){this.__data__=new kt},Et.prototype.delete=function(t){return this.__data__.delete(t)},Et.prototype.get=function(t){return this.__data__.get(t)},Et.prototype.has=function(t){return this.__data__.has(t)},Et.prototype.set=function(t,e){var r=this.__data__;if(r instanceof kt){var o=r.__data__;if(!pt||o.length<n-1)return o.push([t,e]),this;r=this.__data__=new Ct(o)}return r.set(t,e),this};var Rt=st?$(st,Object):function(){return[]},Lt=function(t){return X.call(t)};function Gt(t,e){return!!(e=null==e?i:e)&&("number"==typeof t||T.test(t))&&t>-1&&t%1==0&&t<e}function Ut(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Y)}function zt(t){if(null!=t){try{return K.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Vt(t,e){return t===e||t!=t&&e!=e}(lt&&Lt(new lt(new ArrayBuffer(1)))!=g||pt&&Lt(new pt)!=l||dt&&"[object Promise]"!=Lt(dt.resolve())||ht&&Lt(new ht)!=v||vt&&"[object WeakMap]"!=Lt(new vt))&&(Lt=function(t){var e=X.call(t),r=e==d?t.constructor:void 0,n=r?zt(r):void 0;if(n)switch(n){case yt:return g;case bt:return l;case gt:return"[object Promise]";case wt:return v;case _t:return"[object WeakMap]"}return e});var Bt=Array.isArray;function $t(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}(t.length)&&!Ht(t)}var qt=ct||function(){return!1};function Ht(t){var e=Jt(t)?X.call(t):"";return e==c||e==f}function Jt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Yt(t){return $t(t)?At(t):function(t){if(!Ut(t))return ft(t);var e=[];for(var r in Object(t))Z.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}r.exports=function(t){return Tt(t,!0,!0)}}).call(e,r(20),r(27)(t))},function(t,e){var r=-1,n=1,o=0;function i(t,e,c,f){if(t===e)return t?[[o,t]]:[];if(null!=c){var h=function(t,e,r){var n="number"==typeof r?{index:r,length:0}:r.oldRange,o="number"==typeof r?null:r.newRange,i=t.length,a=e.length;if(0===n.length&&(null===o||0===o.length)){var u=n.index,s=t.slice(0,u),c=t.slice(u),f=o?o.index:null,l=u+a-i;if((null===f||f===l)&&!(l<0||l>a)){var p=e.slice(0,l),h=e.slice(l);if(h===c){var v=Math.min(u,l),m=s.slice(0,v),y=p.slice(0,v);if(m===y){var b=s.slice(v),g=p.slice(v);return d(m,b,g,c)}}}if(null===f||f===u){var w=u,p=e.slice(0,w),h=e.slice(w);if(p===s){var _=Math.min(i-w,a-w),O=c.slice(c.length-_),x=h.slice(h.length-_);if(O===x){var b=c.slice(0,c.length-_),g=h.slice(0,h.length-_);return d(s,b,g,O)}}}}if(n.length>0&&o&&0===o.length){var m=t.slice(0,n.index),O=t.slice(n.index+n.length),v=m.length,_=O.length;if(!(a<v+_)){var y=e.slice(0,v),x=e.slice(a-_);if(m===y&&O===x){var b=t.slice(v,i-_),g=e.slice(v,a-_);return d(m,b,g,O)}}}return null}(t,e,c);if(h)return h}var v=u(t,e),m=t.substring(0,v);v=s(t=t.substring(v),e=e.substring(v));var y=t.substring(t.length-v),b=function(t,e){var c;if(!t)return[[n,e]];if(!e)return[[r,t]];var f=t.length>e.length?t:e,l=t.length>e.length?e:t,p=f.indexOf(l);if(-1!==p)return c=[[n,f.substring(0,p)],[o,l],[n,f.substring(p+l.length)]],t.length>e.length&&(c[0][0]=c[2][0]=r),c;if(1===l.length)return[[r,t],[n,e]];var d=function(t,e){var r=t.length>e.length?t:e,n=t.length>e.length?e:t;if(r.length<4||2*n.length<r.length)return null;function o(t,e,r){for(var n,o,i,a,c=t.substring(r,r+Math.floor(t.length/4)),f=-1,l="";-1!==(f=e.indexOf(c,f+1));){var p=u(t.substring(r),e.substring(f)),d=s(t.substring(0,r),e.substring(0,f));l.length<d+p&&(l=e.substring(f-d,f)+e.substring(f,f+p),n=t.substring(0,r-d),o=t.substring(r+p),i=e.substring(0,f-d),a=e.substring(f+p))}return 2*l.length>=t.length?[n,o,i,a,l]:null}var i,a,c,f,l,p=o(r,n,Math.ceil(r.length/4)),d=o(r,n,Math.ceil(r.length/2));if(!p&&!d)return null;i=d?p&&p[4].length>d[4].length?p:d:p;t.length>e.length?(a=i[0],c=i[1],f=i[2],l=i[3]):(f=i[0],l=i[1],a=i[2],c=i[3]);var h=i[4];return[a,c,f,l,h]}(t,e);if(d){var h=d[0],v=d[1],m=d[2],y=d[3],b=d[4],g=i(h,m),w=i(v,y);return g.concat([[o,b]],w)}return function(t,e){for(var o=t.length,i=e.length,u=Math.ceil((o+i)/2),s=u,c=2*u,f=new Array(c),l=new Array(c),p=0;p<c;p++)f[p]=-1,l[p]=-1;f[s+1]=0,l[s+1]=0;for(var d=o-i,h=d%2!=0,v=0,m=0,y=0,b=0,g=0;g<u;g++){for(var w=-g+v;w<=g-m;w+=2){for(var _=s+w,O=(E=w===-g||w!==g&&f[_-1]<f[_+1]?f[_+1]:f[_-1]+1)-w;E<o&&O<i&&t.charAt(E)===e.charAt(O);)E++,O++;if(f[_]=E,E>o)m+=2;else if(O>i)v+=2;else if(h){var x=s+d-w;if(x>=0&&x<c&&-1!==l[x]){var j=o-l[x];if(E>=j)return a(t,e,E,O)}}}for(var k=-g+y;k<=g-b;k+=2){for(var x=s+k,C=(j=k===-g||k!==g&&l[x-1]<l[x+1]?l[x+1]:l[x-1]+1)-k;j<o&&C<i&&t.charAt(o-j-1)===e.charAt(i-C-1);)j++,C++;if(l[x]=j,j>o)b+=2;else if(C>i)y+=2;else if(!h){var _=s+d-k;if(_>=0&&_<c&&-1!==f[_]){var E=f[_],O=s+E-_;if(E>=(j=o-j))return a(t,e,E,O)}}}}return[[r,t],[n,e]]}(t,e)}(t=t.substring(0,t.length-v),e=e.substring(0,e.length-v));return m&&b.unshift([o,m]),y&&b.push([o,y]),function t(e,i){e.push([o,""]);var a=0;var c=0;var f=0;var d="";var h="";var v;for(;a<e.length;)if(a<e.length-1&&!e[a][1])e.splice(a,1);else switch(e[a][0]){case n:f++,h+=e[a][1],a++;break;case r:c++,d+=e[a][1],a++;break;case o:var m=a-f-c-1;if(i){if(m>=0&&p(e[m][1])){var y=e[m][1].slice(-1);if(e[m][1]=e[m][1].slice(0,-1),d=y+d,h=y+h,!e[m][1]){e.splice(m,1),a--;var b=m-1;e[b]&&e[b][0]===n&&(f++,h=e[b][1]+h,b--),e[b]&&e[b][0]===r&&(c++,d=e[b][1]+d,b--),m=b}}if(l(e[a][1])){var y=e[a][1].charAt(0);e[a][1]=e[a][1].slice(1),d+=y,h+=y}}if(a<e.length-1&&!e[a][1]){e.splice(a,1);break}if(d.length>0||h.length>0){d.length>0&&h.length>0&&(0!==(v=u(h,d))&&(m>=0?e[m][1]+=h.substring(0,v):(e.splice(0,0,[o,h.substring(0,v)]),a++),h=h.substring(v),d=d.substring(v)),0!==(v=s(h,d))&&(e[a][1]=h.substring(h.length-v)+e[a][1],h=h.substring(0,h.length-v),d=d.substring(0,d.length-v)));var g=f+c;0===d.length&&0===h.length?(e.splice(a-g,g),a-=g):0===d.length?(e.splice(a-g,g,[n,h]),a=a-g+1):0===h.length?(e.splice(a-g,g,[r,d]),a=a-g+1):(e.splice(a-g,g,[r,d],[n,h]),a=a-g+2)}0!==a&&e[a-1][0]===o?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,f=0,c=0,d="",h=""}""===e[e.length-1][1]&&e.pop();var w=!1;a=1;for(;a<e.length-1;)e[a-1][0]===o&&e[a+1][0]===o&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)===e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),w=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),w=!0)),a++;w&&t(e,i)}(b,f),b}function a(t,e,r,n){var o=t.substring(0,r),a=e.substring(0,n),u=t.substring(r),s=e.substring(n),c=i(o,a),f=i(u,s);return c.concat(f)}function u(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var r=0,n=Math.min(t.length,e.length),o=n,i=0;r<o;)t.substring(i,o)==e.substring(i,o)?i=r=o:n=o,o=Math.floor((n-r)/2+r);return c(t.charCodeAt(o-1))&&o--,o}function s(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var r=0,n=Math.min(t.length,e.length),o=n,i=0;r<o;)t.substring(t.length-o,t.length-i)==e.substring(e.length-o,e.length-i)?i=r=o:n=o,o=Math.floor((n-r)/2+r);return f(t.charCodeAt(t.length-o))&&o--,o}function c(t){return t>=55296&&t<=56319}function f(t){return t>=56320&&t<=57343}function l(t){return f(t.charCodeAt(0))}function p(t){return c(t.charCodeAt(t.length-1))}function d(t,e,i,a){return p(t)||l(a)?null:function(t){for(var e=[],r=0;r<t.length;r++)t[r][1].length>0&&e.push(t[r]);return e}([[o,t],[r,e],[n,i],[o,a]])}function h(t,e,r){return i(t,e,r,!0)}h.INSERT=n,h.DELETE=r,h.EQUAL=o,t.exports=h},function(t,e,r){var n=Array.prototype.slice,o=r(249),i=r(250),a=t.exports=function(t,e,r){return r||(r={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?r.strict?t===e:t==e:function(t,e,r){var c,f;if(u(t)||u(e))return!1;if(t.prototype!==e.prototype)return!1;if(i(t))return!!i(e)&&(t=n.call(t),e=n.call(e),a(t,e,r));if(s(t)){if(!s(e))return!1;if(t.length!==e.length)return!1;for(c=0;c<t.length;c++)if(t[c]!==e[c])return!1;return!0}try{var l=o(t),p=o(e)}catch(t){return!1}if(l.length!=p.length)return!1;for(l.sort(),p.sort(),c=l.length-1;c>=0;c--)if(l[c]!=p[c])return!1;for(c=l.length-1;c>=0;c--)if(f=l[c],!a(t[f],e[f],r))return!1;return typeof t==typeof e}(t,e,r))};function u(t){return null===t||void 0===t}function s(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}},function(t,e){function r(t){var e=[];for(var r in t)e.push(r);return e}(t.exports="function"==typeof Object.keys?Object.keys:r).shim=r},function(t,e){var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function n(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function o(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=r?n:o).supported=n,e.unsupported=o},function(t,e,r){(function(e){var r="Expected a function",n="__lodash_placeholder__",o=1,i=2,a=4,u=8,s=16,c=32,f=64,l=128,p=512,d=1/0,h=9007199254740991,v=1.7976931348623157e308,m=NaN,y=[["ary",l],["bind",o],["bindKey",i],["curry",u],["curryRight",s],["flip",p],["partial",c],["partialRight",f],["rearg",256]],b="[object Function]",g="[object GeneratorFunction]",w="[object Symbol]",_=/^\s+|\s+$/g,O=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,x=/\{\n\/\* \[wrapped with (.+)\] \*/,j=/,? & /,k=/^[-+]0x[0-9a-f]+$/i,C=/^0b[01]+$/i,E=/^\[object .+?Constructor\]$/,A=/^0o[0-7]+$/i,I=/^(?:0|[1-9]\d*)$/,S=parseInt,T="object"==typeof e&&e&&e.Object===Object&&e,P="object"==typeof self&&self&&self.Object===Object&&self,M=T||P||Function("return this")();function F(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function D(t,e){return!!(t?t.length:0)&&function(t,e,r){if(e!=e)return function(t,e,r,n){var o=t.length,i=r+(n?1:-1);for(;n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,N,r);var n=r-1,o=t.length;for(;++n<o;)if(t[n]===e)return n;return-1}(t,e,0)>-1}function N(t){return t!=t}function R(t,e){for(var r=-1,o=t.length,i=0,a=[];++r<o;){var u=t[r];u!==e&&u!==n||(t[r]=n,a[i++]=r)}return a}var L=Function.prototype,G=Object.prototype,U=M["__core-js_shared__"],z=function(){var t=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),V=L.toString,B=G.hasOwnProperty,$=G.toString,q=RegExp("^"+V.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),H=Object.create,J=Math.max,Y=Math.min,W=function(){var t=rt(Object,"defineProperty"),e=rt.name;return e&&e.length>2?t:void 0}();function Q(t){return!(!at(t)||function(t){return!!z&&z in t}(t))&&(function(t){var e=at(t)?$.call(t):"";return e==b||e==g}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?q:E).test(function(t){if(null!=t){try{return V.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function K(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=function(t){return at(t)?H(t):{}}(t.prototype),n=t.apply(r,e);return at(n)?n:r}}function Z(t,e,r,n,a,c,f,d,h,v){var m=e&l,y=e&o,b=e&i,g=e&(u|s),w=e&p,_=b?void 0:K(t);return function o(){for(var i=arguments.length,u=Array(i),s=i;s--;)u[s]=arguments[s];if(g)var l=et(o),p=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&n++;return n}(u,l);if(n&&(u=function(t,e,r,n){for(var o=-1,i=t.length,a=r.length,u=-1,s=e.length,c=J(i-a,0),f=Array(s+c),l=!n;++u<s;)f[u]=e[u];for(;++o<a;)(l||o<i)&&(f[r[o]]=t[o]);for(;c--;)f[u++]=t[o++];return f}(u,n,a,g)),c&&(u=function(t,e,r,n){for(var o=-1,i=t.length,a=-1,u=r.length,s=-1,c=e.length,f=J(i-u,0),l=Array(f+c),p=!n;++o<f;)l[o]=t[o];for(var d=o;++s<c;)l[d+s]=e[s];for(;++a<u;)(p||o<i)&&(l[d+r[a]]=t[o++]);return l}(u,c,f,g)),i-=p,g&&i<v){var O=R(u,l);return X(t,e,Z,o.placeholder,r,u,O,d,h,v-i)}var x=y?r:this,j=b?x[t]:t;return i=u.length,d?u=function(t,e){for(var r=t.length,n=Y(e.length,r),o=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(t);n--;){var i=e[n];t[n]=nt(i,r)?o[i]:void 0}return t}(u,d):w&&i>1&&u.reverse(),m&&h<i&&(u.length=h),this&&this!==M&&this instanceof o&&(j=_||K(j)),j.apply(x,u)}}function X(t,e,r,n,s,l,p,d,h,v){var m=e&u;e|=m?c:f,(e&=~(m?f:c))&a||(e&=~(o|i));var y=r(t,e,s,m?l:void 0,m?p:void 0,m?void 0:l,m?void 0:p,d,h,v);return y.placeholder=n,ot(y,t,e)}function tt(t,e,n,a,l,p,d,h){var v=e&i;if(!v&&"function"!=typeof t)throw new TypeError(r);var m=a?a.length:0;if(m||(e&=~(c|f),a=l=void 0),d=void 0===d?d:J(st(d),0),h=void 0===h?h:st(h),m-=l?l.length:0,e&f){var y=a,b=l;a=l=void 0}var g=[t,e,n,a,l,y,b,p,d,h];if(t=g[0],e=g[1],n=g[2],a=g[3],l=g[4],!(h=g[9]=null==g[9]?v?0:t.length:J(g[9]-m,0))&&e&(u|s)&&(e&=~(u|s)),e&&e!=o)w=e==u||e==s?function(t,e,r){var n=K(t);return function o(){for(var i=arguments.length,a=Array(i),u=i,s=et(o);u--;)a[u]=arguments[u];var c=i<3&&a[0]!==s&&a[i-1]!==s?[]:R(a,s);return(i-=c.length)<r?X(t,e,Z,o.placeholder,void 0,a,c,void 0,void 0,r-i):F(this&&this!==M&&this instanceof o?n:t,this,a)}}(t,e,h):e!=c&&e!=(o|c)||l.length?Z.apply(void 0,g):function(t,e,r,n){var i=e&o,a=K(t);return function e(){for(var o=-1,u=arguments.length,s=-1,c=n.length,f=Array(c+u),l=this&&this!==M&&this instanceof e?a:t;++s<c;)f[s]=n[s];for(;u--;)f[s++]=arguments[++o];return F(l,i?r:this,f)}}(t,e,n,a);else var w=function(t,e,r){var n=e&o,i=K(t);return function e(){return(this&&this!==M&&this instanceof e?i:t).apply(n?r:this,arguments)}}(t,e,n);return ot(w,t,e)}function et(t){return t.placeholder}function rt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Q(r)?r:void 0}function nt(t,e){return!!(e=null==e?h:e)&&("number"==typeof t||I.test(t))&&t>-1&&t%1==0&&t<e}var ot=W?function(t,e,r){var n=e+"";return W(t,"toString",{configurable:!0,enumerable:!1,value:function(t){return function(){return t}}(function(t,e){var r=e.length,n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(O,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(y,function(r){var n="_."+r[0];e&r[1]&&!D(t,n)&&t.push(n)}),t.sort()}(function(t){var e=t.match(x);return e?e[1].split(j):[]}(n),r)))})}:function(t){return t};var it=function(t,e){return e=J(void 0===e?t.length-1:e,0),function(){for(var r=arguments,n=-1,o=J(r.length-e,0),i=Array(o);++n<o;)i[n]=r[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=r[n];return a[e]=i,F(t,this,a)}}(function(t,e,r){var n=o;if(r.length){var i=R(r,et(it));n|=c}return tt(t,n,e,r,i)});function at(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function ut(t){return t?(t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&$.call(t)==w}(t))return m;if(at(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=at(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(_,"");var r=C.test(t);return r||A.test(t)?S(t.slice(2),r?2:8):k.test(t)?m:+t}(t))===d||t===-d?(t<0?-1:1)*v:t==t?t:0:0===t?t:0}function st(t){var e=ut(t),r=e%1;return e==e?r?e-r:e:0}it.placeholder={},t.exports=it}).call(e,r(20))},function(t,e,r){(function(t,r){var n=9007199254740991,o="[object Arguments]",i="[object Function]",a="[object GeneratorFunction]",u="[object Map]",s="[object Set]",c=/^\[object .+?Constructor\]$/,f="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,p=f||l||Function("return this")(),d="object"==typeof e&&e&&!e.nodeType&&e,h=d&&"object"==typeof r&&r&&!r.nodeType&&r,v=h&&h.exports===d;var m=Function.prototype,y=Object.prototype,b=p["__core-js_shared__"],g=function(){var t=/[^.]+$/.exec(b&&b.keys&&b.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),w=m.toString,_=y.hasOwnProperty,O=y.toString,x=RegExp("^"+w.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),j=v?p.Buffer:void 0,k=y.propertyIsEnumerable,C=j?j.isBuffer:void 0,E=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),A=U(p,"DataView"),I=U(p,"Map"),S=U(p,"Promise"),T=U(p,"Set"),P=U(p,"WeakMap"),M=!k.call({valueOf:1},"valueOf"),F=V(A),D=V(I),N=V(S),R=V(T),L=V(P);function G(t){return!(!Y(t)||function(t){return!!g&&g in t}(t))&&(J(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?x:c).test(V(t))}function U(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return G(r)?r:void 0}var z=function(t){return O.call(t)};function V(t){if(null!=t){try{return w.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function B(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&q(t)}(t)&&_.call(t,"callee")&&(!k.call(t,"callee")||O.call(t)==o)}(A&&"[object DataView]"!=z(new A(new ArrayBuffer(1)))||I&&z(new I)!=u||S&&"[object Promise]"!=z(S.resolve())||T&&z(new T)!=s||P&&"[object WeakMap]"!=z(new P))&&(z=function(t){var e=O.call(t),r="[object Object]"==e?t.constructor:void 0,n=r?V(r):void 0;if(n)switch(n){case F:return"[object DataView]";case D:return u;case N:return"[object Promise]";case R:return s;case L:return"[object WeakMap]"}return e});var $=Array.isArray;function q(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}(t.length)&&!J(t)}var H=C||function(){return!1};function J(t){var e=Y(t)?O.call(t):"";return e==i||e==a}function Y(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}r.exports=function(t){if(q(t)&&($(t)||"string"==typeof t||"function"==typeof t.splice||H(t)||B(t)))return!t.length;var e=z(t);if(e==u||e==s)return!t.size;if(M||function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||y)}(t))return!E(t).length;for(var r in t)if(_.call(t,r))return!1;return!0}}).call(e,r(20),r(27)(t))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n=r(24),o=r(217),i=r(315),a=r(179);function u(t){var e=new i(t),r=o(i.prototype.request,e);return n.extend(r,i.prototype,e),n.extend(r,e),r}var s=u(a);s.Axios=i,s.create=function(t){return u(n.merge(a,t))},s.Cancel=r(221),s.CancelToken=r(328),s.isCancel=r(220),s.all=function(t){return Promise.all(t)},s.spread=r(329),t.exports=s,t.exports.default=s},function(t,e){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},function(t,e,r){"use strict";var n=r(179),o=r(24),i=r(323),a=r(324);function u(t){this.defaults=t,this.interceptors={request:new i,response:new i}}u.prototype.request=function(t){"string"==typeof t&&(t=o.merge({url:arguments[0]},arguments[1])),(t=o.merge(n,{method:"get"},this.defaults,t)).method=t.method.toLowerCase();var e=[a,void 0],r=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)r=r.then(e.shift(),e.shift());return r},o.forEach(["delete","get","head","options"],function(t){u.prototype[t]=function(e,r){return this.request(o.merge(r||{},{method:t,url:e}))}}),o.forEach(["post","put","patch"],function(t){u.prototype[t]=function(e,r,n){return this.request(o.merge(n||{},{method:t,url:e,data:r}))}}),t.exports=u},function(t,e,r){"use strict";var n=r(24);t.exports=function(t,e){n.forEach(t,function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])})}},function(t,e,r){"use strict";var n=r(219);t.exports=function(t,e,r){var o=r.config.validateStatus;r.status&&o&&!o(r.status)?e(n("Request failed with status code "+r.status,r.config,null,r.request,r)):t(r)}},function(t,e,r){"use strict";t.exports=function(t,e,r,n,o){return t.config=e,r&&(t.code=r),t.request=n,t.response=o,t}},function(t,e,r){"use strict";var n=r(24);function o(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,r){if(!e)return t;var i;if(r)i=r(e);else if(n.isURLSearchParams(e))i=e.toString();else{var a=[];n.forEach(e,function(t,e){null!==t&&void 0!==t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),a.push(o(e)+"="+o(t))}))}),i=a.join("&")}return i&&(t+=(-1===t.indexOf("?")?"?":"&")+i),t}},function(t,e,r){"use strict";var n=r(24),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,r,i,a={};return t?(n.forEach(t.split("\n"),function(t){if(i=t.indexOf(":"),e=n.trim(t.substr(0,i)).toLowerCase(),r=n.trim(t.substr(i+1)),e){if(a[e]&&o.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([r]):a[e]?a[e]+", "+r:r}}),a):a}},function(t,e,r){"use strict";var n=r(24);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=o(window.location.href),function(e){var r=n.isString(e)?o(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},function(t,e,r){"use strict";var n=r(24);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,o,i,a){var u=[];u.push(t+"="+encodeURIComponent(e)),n.isNumber(r)&&u.push("expires="+new Date(r).toGMTString()),n.isString(o)&&u.push("path="+o),n.isString(i)&&u.push("domain="+i),!0===a&&u.push("secure"),document.cookie=u.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,r){"use strict";var n=r(24);function o(){this.handlers=[]}o.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},o.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},o.prototype.forEach=function(t){n.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=o},function(t,e,r){"use strict";var n=r(24),o=r(325),i=r(220),a=r(179),u=r(326),s=r(327);function c(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return c(t),t.baseURL&&!u(t.url)&&(t.url=s(t.baseURL,t.url)),t.headers=t.headers||{},t.data=o(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return c(t),e.data=o(e.data,e.headers,t.transformResponse),e},function(e){return i(e)||(c(t),e&&e.response&&(e.response.data=o(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,r){"use strict";var n=r(24);t.exports=function(t,e,r){return n.forEach(r,function(r){t=r(t,e)}),t}},function(t,e,r){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,r){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,r){"use strict";var n=r(221);function o(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var r=this;t(function(t){r.reason||(r.reason=new n(t),e(r.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var t;return{token:new o(function(e){t=e}),cancel:t}},t.exports=o},function(t,e,r){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0};function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var u=r(159),s=r(158),c=r(73),f=r(387),l=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),a(r=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u),o(e,[{key:"freeze",value:function(){c.freeze(this.data),c.freeze(this.data.rows),c.freeze(this.data.cols)}},{key:"name",value:function(){return"TableOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return{table:this.data}}},{key:"skipDiff",value:function(){return!0}},{key:"_genericSet",value:function(t){var r=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_genericSet",this).call(this,t),n=r.changed,o=r.op;if("object"==typeof o.data){if(o.data.rows||(o.data.rows=new s),o.data.cols||(o.data.cols=new s),o.data.cells||(o.data.cells={}),"function"!=typeof o.data.cells.name&&(o.data.cells=new f({action:o.action,cells:o.data.cells})),"function"!=typeof o.data.rows.pack)throw new Error("rows should be a Delta");if("function"!=typeof o.data.cols.pack)throw new Error("cols should be a Delta");"retain"===o.action&&o.data.rows.isEmpty()&&o.data.cols.isEmpty()&&!Object.keys(o.data.cells).length&&(o.data=1)}if("insert"===o.action){if(!o.data.rows.isDocument())throw new Error("rows should be a document");if(!o.data.cols.isDocument())throw new Error("cols should be a document")}return{changed:n,op:o}}},{key:"pack",value:function(){var t=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"pack",this).call(this);if("object"==typeof t[1]){var r=t[1],n=r.cells,o=r.rows,a=r.cols;if(t[1]=[n.pack()],o.isEmpty()&&a.isEmpty())return t;a.isEmpty()?t[1].push(o.pack()):(t[1].push(o.isEmpty()?0:o.pack()),t[1].push(a.pack()))}return t}},{key:"compose",value:function(t){var r=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"compose",this).call(this,t);if("number"==typeof this.data||"number"==typeof t.data)return r;var n={rows:r.data.rows.compose(t.data.rows),cols:r.data.cols.compose(t.data.cols)},o=new f({cells:r.data.cells,action:r.action});return o.composeWithMutations(t.data),t.data.cells.forEach(function(e){var r=o.get(e),n=t.data.cells.get(e);o.set(e,r.compose(n))}),n.cells=o,r.set({data:n})}},{key:"invert",value:function(t){var r=this,n=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"invert",this).call(this,t);if("number"==typeof this.data||"number"==typeof t.data)return n;var o={rows:this.data.rows.invert(t.data.rows),cols:this.data.cols.invert(t.data.cols)},a=new f({cells:t.data.cells,action:n.action});a.composeWithMutations(o,function(e,n){try{return r.data.cells.get(n).invert(e)}catch(e){throw new Error(e.message+": "+t.getAttributes().id+", "+n)}});var u=t.data.rows.isEmpty(),s=t.data.cols.isEmpty();return u&&s||this.data.cells.forEach(function(e){var n=c.parsePosition(e),o=n.row,i=n.col;null!==t.data.rows.composePosition(o)&&null!==t.data.cols.composePosition(i)||a.set(e,r.data.cells.get(e))}),o.cells=a,n.set({data:o})}},{key:"transform",value:function(t,r){var n=this,o=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"transform",this).call(this,t,r);if("number"==typeof this.data||"number"==typeof t.data)return o;var a={rows:o.data.rows.transform(this.data.rows,!r),cols:o.data.cols.transform(this.data.cols,!r)},u={rows:this.data.rows.transform(t.data.rows,r),cols:this.data.cols.transform(t.data.cols,r)},s=new f({cells:t.data.cells,action:o.action});s.composeWithMutations(a);var l=t.data.rows.isEmpty(),p=t.data.cols.isEmpty();return this.data.cells.forEach(function(t){var e=c.parsePosition(t),o=e.row,i=e.col;if(l||(o=u.rows.composePosition(o)),p||(i=u.cols.composePosition(i)),null!==o&&null!==i){var a=c.stringifyPosition(o,i);s.set(a,n.data.cells.get(t).transform(s.get(a),r))}}),u.cells=s,o.set({data:u})}}],[{key:"unpack",value:function(t){if(Array.isArray(t[1])){var r=n(t[1],3),o=r[0],a=r[1],u=r[2];t[1]={rows:a?s.unpack(a):null,cols:u?s.unpack(u):null,cells:o}}return i(e.__proto__||Object.getPrototypeOf(e),"unpack",this).call(this,t)}}]),e}();l.packId=3,t.exports=l},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o=r(236),i=r(158),a=r(73),u=r(252),s=function(){function t(e){var r=e.cells,n=e.action;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cells={},"function"==typeof r.name)for(var o in this.proto=r.proto,r.cells)r.cells.hasOwnProperty(o)&&(this.cells[o]=r.cells[o]);else this.proto=r;this.action=n}return n(t,[{key:"name",value:function(){return"CellManager"}},{key:"keys",value:function(){var t=[];return this.forEach(function(e){t.push(e)}),t}},{key:"get",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=void 0;return(n=void 0===this.cells[t]?this.proto[t]:this.cells[t])?(e&&Array.isArray(n)&&(n=this.cells[t]=o.operatorUnpacker(n)),n.action&&n.action!==this.action&&(n=this.cells[t]=n.set({action:this.action}))):n=r?null:new o({action:this.action,data:"insert"===this.action?new i:1}),n&&1===n.constructor.packId&&(n=new o({action:n.action,attributes:n.attributes,data:n.data})),n}},{key:"forEach",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var r in this.cells)!this.cells.hasOwnProperty(r)||e&&null===this.cells[r]||t(r);for(var n in this.proto)this.proto.hasOwnProperty(n)&&!this.cells.hasOwnProperty(n)&&null!==this.proto[n]&&t(n)}},{key:"some",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var r in this.cells)if(this.cells.hasOwnProperty(r)&&t(r))return!0;if(!e)for(var n in this.proto)if(this.proto.hasOwnProperty(n)&&!this.cells.hasOwnProperty(n)&&t(n))return!0;return!1}},{key:"set",value:function(t,e){this.cells[t]=e||null}},{key:"composeWithMutations",value:function(t,e){var r=this,n=t.rows,o=t.cols,i=n.isEmpty(),u=o.isEmpty();if(!i||!u||e){var s={},c={row:{},col:{}};this.forEach(function(t){var f=a.parsePosition(t),l=f.row,p=f.col;if(i||(void 0===c.row[l]&&(c.row[l]=n.composePosition(l)),l=c.row[l]),u||(void 0===c.col[p]&&(c.col[p]=o.composePosition(p)),p=c.col[p]),s[t]||(s[t]=null),null!==l&&null!==p){var d=a.stringifyPosition(l,p),h=r.get(t,!0,!e);s[d]=e?e(h,d):h}},!1),this.cells=s}}},{key:"pack",value:function(){var t=this,e={};return this.forEach(function(r){var n=t.get(r,!1);Array.isArray(n)?e[r]=n:(n.attributes||n.data.isEmpty&&!n.data.isEmpty())&&(e[r]=n.pack())}),u(e)?0:e}}]),t}();t.exports=s},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var i=r(159),a=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),n(e,[{key:"name",value:function(){return"TextOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return this.data}},{key:"setData",value:function(t){switch(function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.action){case"insert":if("string"!=typeof this.data&&"object"!=typeof this.data)throw new Error('data should be a string or an object for "insert" action, got '+this.data);break;case"retain":if("number"!=typeof this.data)throw new Error('data should be a number for "'+this.action+'" action, got '+this.data)}return this}}]),e}();a.packId=2,t.exports=a},,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.deltaConstructor=t,this.operatorConstructor=e}return t.prototype.compose=function(t,e,r){throw new Error("#compose() is not implemented")},t.prototype.transform=function(t,e,r){throw new Error("#transform() is not implemented")},t.prototype.invert=function(t,e){throw new Error("#invert() is not implemented")},t.prototype.parse=function(t){throw new Error("#parse() is not implemented")},t.prototype.pack=function(t,e){throw new Error("#pack() is not implemented")},t.prototype.toJSON=function(t){throw new Error("#toJSON() is not implemented")},t.prototype.explain=function(t,e){return""+t+e},t}();e.default=n},function(t,e,r){var n=r(419),o=r(529);t.exports=r(393)?function(t,e,r){return n.f(t,e,o(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,r){t.exports=!r(528)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(534),o=Math.min;t.exports=function(t){return t>0?o(n(t),9007199254740991):0}},,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(939),o=r(952);!function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(527)),e.Changeset={Richdoc:o.changeset,Modoc:n.changeset}},function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.PUSHED=0]="PUSHED",t[t.MERGED=1]="MERGED",t[t.REORDERED=2]="REORDERED"}(n=e.PushResult||(e.PushResult={}));var o=function(){function t(t){void 0===t&&(t=[]),this.stringified=!1,this.ops=t}return t.prototype.push=function(t){if(this.stringified)throw new Error("Cannot push new operators to a stringified operatorList");var e=this.ops.length;if(0===e)return this.ops.push(t),n.PUSHED;var r=n.PUSHED,o=this.ops[e-1];if("remove"===o.action&&"insert"===t.action&&(e-=1,o=this.ops[e-1],r=n.REORDERED,void 0===o))return this.ops.unshift(t),r;var i=o.merge(t);return i?(this.ops[e-1]=i,r=n.MERGED):e===this.ops.length?this.ops.push(t):this.ops.splice(e,0,t),r},t.prototype.stringify=function(t){void 0===t&&(t=!1),this.stringified=!0;for(var e=this.ops.length,r="",n=0;n<e;n++){var o=this.ops[n];(!t||n<e-1||!o.isEmpty())&&(r+=o.stringify())}return r},t}();e.default=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toColumnName=function(t){if(!(t>=0))throw new Error("Invalid column: "+t);for(var e=t+1,r="";e>0;){var n=(e-1)%26;r=String.fromCharCode(65+n)+r,e=Math.floor((e-n)/26)}return r},e.fromColumnName=function(t){for(var e=0,r=0;r<t.length;r++){var n=t[r].charCodeAt(0);if(!(n>=65&&n<=90))throw new Error("Invalid cell position "+t);e=26*e+n-64}return e},e.toCellName=function(t,e){if(!(t>=0&&e>=0))throw new Error("Invalid cell position "+t+":"+e);for(var r=e+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(t+1)},e.fromCellName=function(t){for(var e=0,r=0,n=0;n<t.length;n++){var o=t[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+t);e=10*e+o-48}}return{row:e-1,column:r-1}}},function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(955)),n(r(609));var o=r(612);e.ServerTypes=o;var i=r(611);e.ServerAdapters=i},function(t,e,r){var n=r(420),o=r(965),i=r(966),a=Object.defineProperty;e.f=r(393)?Object.defineProperty:function(t,e,r){if(n(t),e=i(e,!0),n(r),o)try{return a(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},function(t,e,r){var n=r(392);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){var n=r(423);t.exports=function(t){return Object(n(t))}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u=r(176),s=a(r(175)),c=a(r(156)),f=r(426),l=r(427);e.FORM_VERSION=2,e.CREATE_AT="CREATE_AT",e.DEFAULT_FORM_SHEET_ID="MODOC",e.DEFAULT_COLUMN_COUNT=18,e.DEFAULT_ROW_COUNT=200,e.getModocOperators=function(t){for(var e=[],r=t.getIter();r.hasNext();)e.push(r.next());return e},e.getOperatorSize=function(t){return t.reduce(function(t,e){return t+("number"==typeof e.data?e.data:1)},0)},e.getCellContent=function(t){if(t){var e=t.data,r=t.attributes;if(r&&null!=r.cellValue)return r.cellValue;if(Array.isArray(e&&e.delta)){var n=o(e&&e.delta,1)[0];return n?n.value:void 0}}},e.skipCellOp={action:"retain",attributes:{},data:1},e.createTextCellOp=function(t,r,o){return void 0===o&&(o={}),null==t||""===t?e.skipCellOp:{action:"retain",attributes:n({"font-size":9,wrap:"text-no-wrap",format:"@",vertical:"middle",userId:r,authorId:r,cellValue:t},o),data:1}};e.questionResponseToCellOp=function(t){var r=t.question,n=t.response,o=t.userId;switch(r.type){case l.FormQuestions.TextType:case l.FormQuestions.MultipleTextType:var i=n.text;return e.createTextCellOp(i&&i.content,o);case l.FormQuestions.SingleChoiceType:case l.FormQuestions.DropdownListType:case l.FormQuestions.MultipleChoiceType:var a=[].concat(n.choices||[],n.choice||[]).filter(Boolean);if(0===a.length)return e.createTextCellOp("",o);var s=r.question.options.map(function(t){return a.find(function(e){return"other"===t.type&&"other"===e.type||"normal"===t.type&&"normal"===e.type&&t.value===e.value})}).filter(Boolean).map(function(t){return function(t,e){if(t){if("other"===t.type)return""===t.value?"其他":t.value;if("normal"!==t.type)u.softAssertNever(t);else{var r=e.question.options.find(function(e){return"normal"===e.type&&e.value===t.value});if(r){if("normal"===r.type)return r.label;throw new Error("unexpected type:"+r.type)}}}}(t,r)}).filter(function(t){return null!=t&&""!==t});return e.createTextCellOp(s.join(","),o);default:return u.softAssertNever(r),e.createTextCellOp("",o)}};var p=function(t){var e=t.data,r=(t.action,t.getAttributes()||{}),n=e.rows.ops.map(function(t){var e=t.data;return{attributes:t.getAttributes()||{},data:e}}),o=e.cols.ops.map(function(t){var e=t.data;return{attributes:t.getAttributes()||{},data:e}}),i=e.cells,a={};return i.forEach(function(t){var e=i.get(t),r=e.data,n=e.getAttributes()||{};a[t]={data:r,attributes:n}}),{attributes:r,cells:a,rows:n,columns:o}},d=function(t){var e=t.attributes,r=void 0===e?{}:e,n=t.data.table,o={},i=0;return{attributes:r,rows:n.rows.map(function(t){var e=t,r=e.attributes;return{attributes:void 0===r?{}:r,data:e.data}}),columns:n.cols.map(function(t){var e=t,r=e.attributes,n=void 0===r?{}:r,a=e.data;if("number"==typeof a)i+=a;else{var u=0;a.delta.forEach(function(t){var e=t,r=e.data,n=e.attributes,a=void 0===n?{}:n;if(a&&null!=a.cellValue||"number"!=typeof r){for(var s="number"==typeof r?r:1,c=0;c<s;c++)o[f.toCellName(u+c,i)]={attributes:a,data:r};u+=s}else u+=r}),i+=1}return{attributes:n,data:"number"==typeof a?a:1}}),cells:o}};e.toSpread=function(t,e){switch(e){case"modoc":return function(t){return t.toJSON().map(d)}("string"==typeof t?new s.Delta(t):t);case"richdoc":return function(t){return t.ops.map(p)}("string"==typeof t?c.unpack(t):t);default:return u.assertNever(e)}},e.toTextTable=function(t){t.attributes,t.rows,t.columns;for(var r=t.cells,n=Object.keys(r).filter(function(t){return e.getCellContent(r[t])}).map(f.fromCellName),o=Math.max.apply(Math,i([-1],n.map(function(t){return t.row})))+1,a=Math.max.apply(Math,i([-1],n.map(function(t){return t.column})))+1,u=[],s=0;s<o;s++){for(var c=[],l=0;l<a;l++){var p=f.toCellName(s,l);r[p]&&e.getCellContent(r[p])?c.push(e.getCellContent(r[p])):c.push(void 0)}u.push(c)}return u}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toColumnName=function(t){if(!(t>=0))throw new Error("Invalid column: "+t);for(var e=t+1,r="";e>0;){var n=(e-1)%26;r=String.fromCharCode(65+n)+r,e=Math.floor((e-n)/26)}return r},e.fromColumnName=function(t){for(var e=0,r=0;r<t.length;r++){var n=t[r].charCodeAt(0);if(!(n>=65&&n<=90))throw new Error("Invalid cell position "+t);e=26*e+n-64}return e},e.toCellName=function(t,e){if(!(t>=0&&e>=0))throw new Error("Invalid cell position "+t+":"+e);for(var r=e+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(t+1)},e.fromCellName=function(t){for(var e=0,r=0,n=0;n<t.length;n++){var o=t[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+t);e=10*e+o-48}}return{row:e-1,column:r-1}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.TextType="text",t.MultipleTextType="multiple_text",t.SingleChoiceType="single_choice",t.MultipleChoiceType="multiple_choice",t.DropdownListType="dropdown_list"}(e.FormQuestions||(e.FormQuestions={}))},function(t,e,r){(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.showAlert=function(e){var r=e.title,i=void 0===r?"":r,a=e.type,u=void 0===a?"success":a,s=e.duration,c=void 0===s?3e3:s,f=e.autoHide,l=void 0===f||f,p=e.customCls,d=void 0===p?"":p,h=e.priority,v=void 0===h?0:h,m=e.specifiedType,y=void 0===m?"":m,b=e.dangerousHtmlTitle,g=void 0===b?"":b,w=(0,n.isMobile)()?"pt-mobile":"",_=o+" "+d+" "+w,O=t("."+o);if(O&&O.length){if(v<O.data("priority")&&"block"===O.css("display"))return;O.removeClass().addClass(_)}else{var x='<div class="'+_+'"><p class="sm-alert-content"><span class="s-error"></span><span class="sm-alert-title"></span></p></div>';(O=t(x)).appendTo(t("body"))}O.find(t(".s-error")).css("display","error"===u?"inline-block":"none"),g?O.find(t(".sm-alert-title")).html(g):O.find(t(".sm-alert-title")).text(i);O.css("display","block").data("priority",v).data("type",y);var j=O.data("timerid");j&&clearTimeout(j);l&&(j=setTimeout(function(){return O.hide()},c),O.data("timerid",j))},e.hideAlert=function(e){var r=e&&e.specifiedType,n=t("."+o);n&&n.length>0&&(r&&r!==n.data("type")||n.hide())};var n=r(161);r(541);var o="sm-sheet-alert-container"}).call(e,r(46))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TYPE_PROPERTY="__MODOC_NAME__"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(604),o=r(605),i="0:",a=function(){function t(e,r){this.action=e.action;var n,o=e.data;if(null===o||void 0===o)throw new Error('"data" is required for an Operator');if("object"==typeof o){var a=Object.keys(o)[0],u=o[a];if("string"==typeof u)this.data=o,this.dataType=a;else{var s=t.dataHandlers[a];if(!s)throw new Error('Unsupported nested data type "'+a+'"');var c=s.pack(u,"insert"===this.action);"delta"===a&&c===i?(this.data=1,this.dataType="number"):(this.data=((n={})[a]=c,n),this.dataType=a)}}else this.data=o,this.dataType=typeof o;this.packedAttributes=e.packedAttributes,this.pool=e.pool,this.packedData=r}return t.isOperator=function(t){return"function"==typeof t.getAttributes},t.registerDataHandler=function(e,r){t.dataHandlers[e]=r},t.getUnresolvedAttributes=function(t){return"function"==typeof t.getUnresolvedAttributes?t.getUnresolvedAttributes():t.getAttributes()},Object.defineProperty(t.prototype,"length",{get:function(){return"string"==typeof this.data?this.data.length:"number"==typeof this.data?this.data:1},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return"retain"===this.action&&(""===this.packedAttributes||void 0===this.packedAttributes)&&"number"==typeof this.data},t.prototype.getParsedData=function(){var e=t.dataHandlers[this.dataType];if(void 0===e)throw new Error("Unknown handler for "+this.dataType);return e.parse(this.getCustomData())},t.prototype.hasAttributes=function(){return void 0!==this.packedAttributes&&""!==this.packedAttributes},t.prototype.getAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes):{}},t.prototype.stringify=function(){if(void 0===this.packedData){var t=this.data,e=void 0;switch(this.action){case"insert":e="!";break;case"retain":e="@";break;default:e="#"}if("number"==typeof t)e+=t.toString(36)+"#";else if("string"==typeof t)e+=t.length.toString(36)+"!"+t;else{var r=this.dataType;if(void 0===r)throw new Error("ASSERT: dataType === undefined");var o=n.objectKeyToInitial[r];if(!o)throw new Error('Unsupport object data type: "'+r+'"');var i=""+o+t[r];e+=i.length.toString(36)+"@"+i}this.packedData=e}var a=void 0===this.packedAttributes?this.packedData:this.packedData+this.packedAttributes;return a.length.toString(36)+a},t.prototype.merge=function(e){if(this.action!==e.action)return null;var r=typeof this.data;if("object"===r||r!==typeof e.data)return null;var n=this.hasAttributes();if(n!==e.hasAttributes())return null;if(n)if(this.pool===e.pool){if(this.packedAttributes!==e.packedAttributes)return null}else if(!function(t,e){if(t===e)return!0;var r=Object.keys(t),n=r.length;if(n!==Object.keys(e).length)return!1;for(var o=0;o<n;o++)if(t[r[o]]!==e[r[o]])return!1;return!0}(this.getUnresolvedAttributes(),t.getUnresolvedAttributes(e)))return null;return new t({action:this.action,data:this.data+e.data,pool:this.pool,packedAttributes:this.packedAttributes})},t.prototype.getCustomData=function(){switch(typeof this.data){case"string":case"number":throw new Error("Cannot get custom data from a simple operator");default:return this.data[this.dataType]}},t.prototype.compose=function(e,r){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==e.action)throw new Error("Only retaining operator can be composed");var n,a,u,s=!1;if(e.hasAttributes()){if(void 0===this.pool)throw new Error("this.pool is undefined when composing");var c=t.getUnresolvedAttributes(e);s=c.hasOwnProperty("cellValue");var f=o.merge(this.getUnresolvedAttributes(),c,!r);a=this.pool.packAttributes(f)}else a=this.packedAttributes;if(s)n="number"===e.dataType?e.data:1;else if("number"===this.dataType)n=e.data;else if("number"===e.dataType)n=this.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when composing '+this.data+" with "+e.data);if(this.dataType!==e.dataType)throw new Error("Expect "+e.dataType+" to equal "+this.dataType+" when composing "+this.data+" with "+e.data);var l=t.dataHandlers[this.dataType];if(void 0===l)throw new Error("Unknown handler for "+this.dataType);var p=l.compose(this.getCustomData(),e.getCustomData(),r);n="delta"===this.dataType&&p===i?1:((u={})[this.dataType]=p,u)}return new t({action:this.action,data:n,pool:this.pool,packedAttributes:a})},t.prototype.transform=function(e,r){if(void 0===r&&(r=!1),"retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==e.action)throw new Error("Only retaining operator can be transformed");var n,a,u;if("number"===this.dataType||"number"===e.dataType)n=e.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when transforming '+this.data+" with "+e.data);if(this.dataType!==e.dataType)throw new Error("Expect "+e.dataType+" to equal "+this.dataType+" when transforming "+this.data+" with "+e.data);var s=t.dataHandlers[this.dataType];if(void 0===s)throw new Error("Unknown handler for "+this.dataType);var c=s.transform(this.getCustomData(),e.getCustomData(),r);n="delta"===this.dataType&&c===i?1:((u={})[this.dataType]=c,u)}if(e.hasAttributes()){var f=o.transform(this.getUnresolvedAttributes(),t.getUnresolvedAttributes(e),r);if(void 0===e.pool)throw new Error("ASSERT: other.pool === undefined when transforming");a=e.pool.packAttributes(f)}else a="";return new t({action:this.action,data:n,pool:e.pool,packedAttributes:a})},t.prototype.invert=function(e,r){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.dataType+")");if("retain"!==e.action)throw new Error("Only retaining operator can be inverted");var n,a,u,s=!1;if(e.hasAttributes()){var c=t.getUnresolvedAttributes(e);s=c.hasOwnProperty("cellValue");var f=o.invert(this.getUnresolvedAttributes(),c);if(void 0===e.pool)throw new Error("ASSERT: other.pool === undefined when inverting");a=e.pool.packAttributes(f)}else a="";if(s)n=this.data;else if(void 0!==r)n=r;else if("number"==typeof e.data)n=e.data;else if("number"==typeof this.data&&"delta"!==e.dataType)n=this.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when inverting '+this.data+" with "+e.data);if("number"===this.dataType&&"delta"===e.dataType){n={delta:(l=t.dataHandlers.delta).invert(i,e.getCustomData())}}else{if(this.dataType!==e.dataType)throw new Error("Expect "+e.dataType+" to equal "+this.dataType+" when inverting "+this.data+" with "+e.data);var l;if(void 0===(l=t.dataHandlers[this.dataType]))throw new Error("Unknown handler for "+this.dataType);var p=l.invert(this.getCustomData(),e.getCustomData());n="delta"===this.dataType&&p===i?1:((u={})[this.dataType]=p,u)}}return new t({data:n,action:"retain",pool:e.pool,packedAttributes:a})},t.prototype.toJSON=function(){var e,r={action:this.action};if(this.hasAttributes()&&(r.attributes=this.getAttributes()),"number"===this.dataType||"string"===this.dataType)r.data=this.data;else{var n=t.dataHandlers[this.dataType],o=this.getCustomData();r.data=((e={})[this.dataType]=n?n.toJSON(o):o,e)}return r},t.prototype.explain=function(e){void 0===e&&(e="");var r=this.stringify().length,n=e+"["+this.dataType+"("+this.action+")] #"+(r-String(r).length)+":\n";if("number"===this.dataType||"string"===this.dataType)n+=e+this.data;else{var o=t.dataHandlers[this.dataType],i=this.getCustomData();n+=o?o.explain(e+"  ",i):i}return n+"\n"+e+"PackedAttributes:"+this.packedAttributes+"\n"},t.prototype.getUnresolvedAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes,!1):{}},t.dataHandlers={},t}();e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Table="table",t.Column="column",t.Row="row",t.Cell="cell"}(e.Element||(e.Element={})),function(t){t.Insert="insert",t.Remove="remove",t.Retain="retain"}(e.Action||(e.Action={})),e.isOperator=function(t){return t&&-1!==["insert","remove","retain"].indexOf(t.action)},function(t){t.Richdoc="richdoc",t.Modoc="modoc"}(e.ChangesetType||(e.ChangesetType={}))},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},function(t,e,r){var n=r(193),o=r(282),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(t.exports=function(t,e){return i[t]||(i[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:r(617)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(t,e,r){var n=r(968);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,o){return t.call(e,r,n,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,r){var n=r(422);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e,r){var n=r(531)("keys"),o=r(530);t.exports=function(t){return n[t]||(n[t]=o(t))}},function(t,e,r){var n=r(977),o=r(423);t.exports=function(t,e,r){if(n(e))throw TypeError("String#"+r+" doesn't accept regex!");return String(o(t))}},function(t,e,r){var n=r(194)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[n]=!1,!"/./"[t](e)}catch(t){}}return!0}},function(t,e){t.exports={}},function(t,e,r){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.isDebugging=/dev/.test(void 0!==t?"production":"")||"undefined"!=typeof window&&/debug=1/.test(window.location.search)}).call(e,r(180))},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},u=this;Object.defineProperty(e,"__esModule",{value:!0});var s=r(427),c=r(1006),f=r(1007),l=r(176),p=r(1009),d=r(1010),h=r(1011),v=r(539),m=r(629);e.generateFormGuid=function(){return c.generateId(8)},e.generateQuestionGuid=function(){return c.generateId(8)},e.createForm=function(){return{questions:[],rules:[],title:"",desc:"",descAlign:"center"}},e.createQuestion=function(t){return{guid:e.generateQuestionGuid(),type:t.type,required:!0,subject:"",question:t.getQuestion(),response:t.getResponse()}},e.createPublishStatus=function(t){return{formId:t,status:"unpublished"}};var y=Object.keys(e.createForm()),b=["guid","question","required","subject","type"];e.isQuestionEqual=function(t,e){return b.every(function(r){return f.isDeepEqual(t[r],e[r],{ignoreEmptyKey:!0})})};var g=[[s.FormQuestions.TextType,s.FormQuestions.MultipleTextType],[s.FormQuestions.SingleChoiceType,s.FormQuestions.MultipleChoiceType,s.FormQuestions.DropdownListType]];e.isQuestionTypeCompatible=function(t,e){return g.some(function(r){return r.includes(t)&&r.includes(e)})},e.isRuleEqual=function(t,e){throw new Error("not implemented")},e.isFormEqual=function(t,r){return!(!t||!r)&&y.every(function(n){switch(n){case"title":case"desc":case"descAlign":return t[n]===r[n];case"questions":var o=t[n],i=r[n];return o&&i&&o.length===i.length&&o.every(function(t,r){return e.isQuestionEqual(t,i[r])});case"rules":var a=t[n],u=r[n];return a&&u&&a.length===u.length&&a.every(function(t,r){return e.isRuleEqual(t,u[r])});default:return l.assertNever(n)}})};var w="/api/newforms";e.setApiBase=function(t){w=t};var _=function(t){if(t&&"string"==typeof t.errmsg)throw t;return t};e.fetchUserCanSubmit=function(t,e){return o(u,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,d.ajax.request(w+"/forms/"+t+"/valid",{method:"GET",data:e?{userFinger:e}:void 0})];case 1:return r=n.sent(),[2,p.queryCanSubmit(r)];case 2:throw n.sent();case 3:return[2]}})})},e.fetchPublishedInfo=function(t){return o(u,void 0,void 0,function(){var e,r,n,o,a,u;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),r=_,[4,d.ajax.request(w+"/forms/"+t+"/publications",{method:"GET"})];case 1:return e=r.apply(void 0,[i.sent()]),n=e&&JSON.parse(e.publishedContent),o=e&&p.fromServerPublishedStatus(e),a=e&&e.publishedRev,[2,{form:n,publishStatus:o,rev:a}];case 2:if((u=i.sent())&&(20221===u.code||/尚未发布/.test(u.errmsg)))return[2,void 0];throw u;case 3:return[2]}})})},e.fetchPublishedForm=function(t){return o(u,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return[4,e.fetchPublishedInfo(t)];case 1:return[2,(r=n.sent())&&r.form]}})})},e.fetchDraftForm=function(t){return o(u,void 0,void 0,function(){var e,r,n,o;return i(this,function(i){switch(i.label){case 0:return[4,d.ajax.request(w+"/forms/"+t+"/content",{method:"GET"})];case 1:return(e=i.sent()).contentUrl?(r=function(t){var e="undefined"==typeof window?"https:":window.location.protocol;return t.replace(/^\w+:/,e)},[4,d.ajax.request(r(e.contentUrl),{method:"GET",extract:function(t){var e=t.data,r=t.headers,n=Number(r["x-oss-meta-head"]),o=Number(r["x-oss-meta-length"]);return{head:n,content:e.substr(0,o)}}})]):[2,void 0];case 2:return n=i.sent(),n.head,o=n.content,[2,m.toForm(o)]}})})};var O=function(t){return t.split("").reverse().join("")};e.encodeDate=function(t,e){return e.substr(3,2)+O(t.getTime().toString(36))},e.decodeDate=function(t,e){try{var r=t.substr(0,2),n=t.substr(2);if(r!==e.substr(3,2))return;var o=parseInt(O(n),36);if(!o||isNaN(o))return;return new Date(o)}catch(t){return}},e.getPreviewLink=function(t,r,n){void 0===n&&(n=60);var o=new Date;return o.setSeconds(0),o.setMilliseconds(0),t+"/forms/"+r+"/preview?t="+e.encodeDate(new Date(o.getTime()+60*n*1e3),r)},e.parsePreviewLink=function(t){var r=a(/\/forms\/(\w+)\/preview\?t=(\w+)\b/.exec(t)||[],3),n=(r[0],r[1]),o=r[2];if(n&&o){var i=e.decodeDate(o,n);return i&&{formGuid:n,expireAt:i}}},e.fetchPublishStatus=function(t){return o(u,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return[4,e.fetchPublishedInfo(t)];case 1:return[2,(r=n.sent())&&r.publishStatus]}})})},e.publishForm=function(t){return o(u,void 0,void 0,function(){var e,r;return i(this,function(o){switch(o.label){case 0:return e=n({},p.toServerPublishedStatus(t.publishStatus),{publishedContent:JSON.stringify(t.form),publishedRev:t.rev,userId:t.userId}),[4,d.ajax.request(w+"/forms/"+t.guid+"/publications",{method:"POST",data:e})];case 1:return r=o.sent(),[2,_(r)]}})})},e.patchPublishStatus=function(t){return o(u,void 0,void 0,function(){var e,r;return i(this,function(o){switch(o.label){case 0:return e=n({},p.toServerPublishedStatus(t.publishStatus),{userId:t.userId}),r=_,[4,d.ajax.request(w+"/forms/"+t.guid+"/publications",{method:"PATCH",data:e})];case 1:return[2,r.apply(void 0,[o.sent()])]}})})},e.unlinkFormAndSheet=function(t){return o(u,void 0,void 0,function(){var e;return i(this,function(r){switch(r.label){case 0:return[4,d.ajax.request(w+"/forms/"+t.guid+"/unlink",{method:"POST"})];case 1:return e=r.sent(),[2,_(e)]}})})},e.postSubmission=function(t){return o(u,void 0,void 0,function(){var e,r;return i(this,function(o){switch(o.label){case 0:return e={formRev:t.rev,userFinger:String(t.userId),responseContent:t.form.questions.map(function(t){switch(t.type){case"text":case"multiple_text":return{type:t.type,guid:t.guid,text:{content:t.response.content}};case"dropdown_list":case"single_choice":return{type:t.type,guid:t.guid,choice:t.response.choice};case"multiple_choice":return{type:t.type,guid:t.guid,choices:t.response.choices};default:return l.assertNever(t)}}).map(function(t){return n({},t,{type:p.getFormQuestionCode(t.type)})})},[4,d.ajax.request(w+"/forms/"+t.guid+"/submit",{method:"POST",data:e})];case 1:return r=o.sent(),[2,_(r)]}})})},e.fetchSubmissions=function(t){return o(u,void 0,void 0,function(){var e,r,o,a,u;return i(this,function(i){switch(i.label){case 0:return e={formGuid:t.guid,offset:t.offset,limit:t.limit},[4,d.ajax.request(w+"/forms/"+t.guid+"/responses",{method:"GET",data:e})];case 1:return r=i.sent(),o=_(r),a=o.total,u=o.responses,[2,{total:a,responses:u.map(function(t){return{userId:Number(t.userFinger),content:JSON.parse(t.content).map(function(t){return n({},t,{type:p.getFormQuestionType(t.type)})}),createdAt:"string"==typeof t.createdAt?new Date(t.createdAt):t.createdAt,submitId:t.submitId}})}]}})})},e.fetchAllSubmissions=function(t){return o(u,void 0,void 0,function(){var r;return i(this,function(n){switch(n.label){case 0:return r=1e6,[4,e.fetchSubmissions({guid:t.guid,offset:0,limit:r})];case 1:return[2,n.sent().responses]}})})},e.fetchStatistics=function(t){return o(u,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,d.ajax.request(w+"/questions/"+t+"/assessments",{method:"GET"})];case 1:return[2,e.sent()]}})})},e.fetchFormViewCount=function(t){return o(u,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,d.ajax.request(w+"/forms/"+t+"/views",{method:"GET"})];case 1:return[2,e.sent()]}})})},e.increaseFormViewCount=function(t){return o(u,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,d.ajax.request(w+"/forms/"+t+"/views",{method:"POST"})];case 1:return e.sent(),[2]}})})},v.isDebugging&&h.logObject({fetchAllSubmissions:e.fetchAllSubmissions,fetchDraftForm:e.fetchDraftForm},"form")},function(t,e,r){var n=r(542);"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r(174)(n,o);n.locals&&(t.exports=n.locals)},function(t,e,r){var n=r(200);(t.exports=r(173)(!1)).push([t.i,".sm-sheet-alert-container {\n  position: fixed;\n  top: 57px;\n  left: 0;\n  right: 0;\n  z-index: 2000;\n  text-align: center;\n  pointer-events: none;\n  font-size: 14px; }\n  .sm-sheet-alert-container.pt-mobile {\n    top: 9px;\n    font-size: 10px; }\n    .sm-sheet-alert-container.pt-mobile .sm-alert-content {\n      padding: 4px 22px;\n      max-width: auto; }\n\n.sm-alert-content {\n  display: inline-block;\n  max-width: 430px;\n  padding: 8px 25px;\n  font-size: 13px;\n  color: #41464B;\n  line-height: 22px;\n  word-break: break-all;\n  -webkit-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  -moz-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  -ms-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  -o-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  border-radius: 1px;\n  background-color: #DDE7F3;\n  pointer-events: auto;\n  word-break: break-word;\n  background: #FFFFFF;\n  border: 1px solid #E5E5E5;\n  border-radius: 2px; }\n  .sm-alert-content .s-error {\n    width: 12px;\n    height: 12px;\n    background-image: url("+n(r(543))+");\n    background-size: 12px 12px;\n    background-repeat: no-repeat;\n    position: relative;\n    top: 1px;\n    right: 9px;\n    display: none; }\n",""])},function(t,e){t.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjQgKDY3Mzc4KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5Db21iaW5lZCBTaGFwZTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJUb2FzdC13aXRoLU9wZXJhdGlvbi1AMXgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01MzQuMDAwMDAwLCAtNTQzLjAwMDAwMCkiIGZpbGw9IiNDRDQ3NDciPgogICAgICAgICAgICA8ZyBpZD0iR3JvdXAtNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDY5LjAwMDAwMCwgNDMyLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTE3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MC4wMDAwMDAsIDk2LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zMSwyNyBDMjcuNjg2MjkxNSwyNyAyNSwyNC4zMTM3MDg1IDI1LDIxIEMyNSwxNy42ODYyOTE1IDI3LjY4NjI5MTUsMTUgMzEsMTUgQzM0LjMxMzcwODUsMTUgMzcsMTcuNjg2MjkxNSAzNywyMSBDMzcsMjQuMzEzNzA4NSAzNC4zMTM3MDg1LDI3IDMxLDI3IFogTTMxLDI2IEMzMy43NjE0MjM3LDI2IDM2LDIzLjc2MTQyMzcgMzYsMjEgQzM2LDE4LjIzODU3NjMgMzMuNzYxNDIzNywxNiAzMSwxNiBDMjguMjM4NTc2MywxNiAyNiwxOC4yMzg1NzYzIDI2LDIxIEMyNiwyMy43NjE0MjM3IDI4LjIzODU3NjMsMjYgMzEsMjYgWiBNMzAuNTIwNTQ4MiwxOS4yNDIyNiBDMzAuNDU0MjE0NSwxOC44MzIzMjExIDMwLjcyODAzMywxOC41IDMxLjE1MDYxMSwxOC41IEwzMS4zNDkzMTI1LDE4LjUgQzMxLjc2MzYyMDIsMTguNSAzMi4wNDcyMTc1LDE4LjgyMjk5OCAzMS45NzkzNzUyLDE5LjI0MjI2IEwzMS41MzMxMzU1LDIyIEwzMC45NjY3ODgsMjIgTDMwLjUyMDU0ODIsMTkuMjQyMjYgWiBNMzAuNSwyMy4yNSBDMzAuNSwyMi44MzU3ODY0IDMwLjgzMjg5ODYsMjIuNSAzMS4yNSwyMi41IEMzMS42NjQyMTM2LDIyLjUgMzIsMjIuODMyODk4NiAzMiwyMy4yNSBDMzIsMjMuNjY0MjEzNiAzMS42NjcxMDE0LDI0IDMxLjI1LDI0IEMzMC44MzU3ODY0LDI0IDMwLjUsMjMuNjY3MTAxNCAzMC41LDIzLjI1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},function(t,e,r){"use strict";(function(t){r.d(e,"a",function(){return n}),r.d(e,"b",function(){return o});var n=/debug=1/.test(window.location.search)||void 0!==t&&/dev/.test("production"),o=function(){return!1===navigator.onLine}}).call(e,r(180))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return C});var n,o=r(936),i=(r.n(o),r(418)),a=(r.n(i),r(961)),u=(r.n(a),r(175)),s=(r.n(u),r(156)),c=(r.n(s),r(3)),f=r.n(c),l=r(74),p=r.n(l),d=r(1020),h=r(630),v=r(1023),m=r(1025),y=r(544),b=r(1026),g=r(1027),w=r(1029),_=r(1031),O=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},x=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},j=this,k=function(t,e){if(-1===e.indexOf(t))return t;for(var r=1;-1!==e.indexOf(t+" "+r);)r++;return t+" "+r};!function(t){t.FormChanged="FormChanged"}(n||(n={}));var C=function(t){var e,r=t.editor,c=t.pageBaseUrl,l=t.apiBaseUrl,C=t.user,E=c?c+"s":"/forms",A=i.createFormService({formApiUrl:l}),I=function(t,e){return O(j,void 0,Promise,function(){var r,n,o,i,u;return x(this,function(s){switch(s.label){case 0:return e!==h.a.V1?[3,2]:[4,A.fetchForm(t)];case 1:return r=s.sent(),[2,{formGuid:t,formVersion:e,data:u=r&&{form:r}}];case 2:return e!==h.a.V2?[3,4]:[4,Promise.all([a.formService.fetchPublishedInfo(t),v.a.fetchFile(t).catch(function(t){return console.error("[form] fetch file failed:",t),"denied"})])];case 3:return n=s.sent(),o=n[0],i=n[1],u=o&&i&&{form:o.form,publishStatus:o.publishStatus,file:i},[2,{formGuid:t,formVersion:e,data:u}];case 4:throw new Error("unexpected formVersion: "+e)}})})},S=Object(m.b)(I);y.a&&Object(w.a)(S,"form:cache"),S.on(m.a.Cached,function(){N.emit(n.FormChanged)});var T=function(t,e){return S.get(t,e)},P=function(t,e){if(!t)return!1;var r=T(t,e);if(!r||!r.data)return!1;if(r.formVersion===h.a.V1)return Boolean(r.data.form.spreadGuid);if(r.formVersion===h.a.V2){var n=r.data.publishStatus;return Boolean(n.spreadGuid&&"normal"===n.status)}throw new Error("unexpected formVersion: "+e)},M=function(t,e,i){return O(j,void 0,Promise,function(){var c,f,l,p,d;return x(this,function(v){switch(v.label){case 0:return i!==h.a.V1?[3,3]:[4,r.getContent()];case 1:return c=v.sent(),f=o.createChangeForUnlinkForm({spread:c,sheetGuid:t.id,type:-4===r.fileType?"modoc":"richdoc",userId:C.id}),[4,r.applyAndSendChange(f,{disableRecords:!0})];case 2:v.sent(),v.label=3;case 3:return i!==h.a.V2?[3,6]:[4,r.getContent()];case 4:return l=v.sent(),p=Array.isArray(l.ops)?"richdoc":"modoc",d=a.sheetChangeset.createChangeForUnlinkForm({spread:l,fileType:p,formGuid:e,userId:C.id}),[4,r.applyAndSendChange("richdoc"===p?s.unpack(d):new u.Delta(d),{disableRecords:!0})];case 5:v.sent(),v.label=6;case 6:return N.emit(n.FormChanged),[2]}})})},F=function(t,r,n){return O(j,void 0,Promise,function(){var t,o,i;return x(this,function(u){switch(u.label){case 0:return n!==h.a.V1?[3,2]:[4,A.fetchForm(r)];case 1:if(!(t=u.sent())||!t.guid)throw new Error(f()("表单不存在，请检查后再试"));(t.spreadGuid||t.sheetGuid)&&A.unlinkForm(r),u.label=2;case 2:return n!==h.a.V2?[3,5]:[4,a.formService.fetchPublishedInfo(r)];case 3:if(!(o=u.sent()))throw new Error(f()("表单不存在，请检查后再试"));return i=o.publishStatus,e&&i.spreadGuid===e?[4,a.formService.patchPublishStatus({guid:r,publishStatus:{spreadGuid:null,sheetGuid:null},userId:C.id})]:[3,5];case 4:u.sent(),u.label=5;case 5:return[2]}})})},D=function(t,e,r){return O(j,void 0,Promise,function(){return x(this,function(n){switch(n.label){case 0:return[4,M(t,e,r)];case 1:return n.sent(),[4,F(t,e,r)];case 2:return n.sent(),[2]}})})},N=Object.assign(new p.a,{setSpreadGuid:function(t){e=t},canEditForm:function(t,e){if(!t)return!1;var r=T(t,e);if(!r||!r.data)return!1;if(r.formVersion===h.a.V1)return C.id===r.data.form.creatorId;if(r.formVersion===h.a.V2){var n=r.data.file;return Boolean(n&&"object"==typeof n&&n.permissions.editable)}throw new Error("unexpected formVersion: "+e)},canReadForm:function(t,e){if(!t)return!1;var r=T(t,e);if(!r||!r.data)return!1;if(r.formVersion===h.a.V1)return C.id===r.data.form.creatorId;if(r.formVersion===h.a.V2){var n=r.data.file;return Boolean(n&&"object"==typeof n&&n.permissions.readable)}throw new Error("unexpected formVersion: "+e)},isFormPublished:P,getFillPageUrl:function(t,e){if(P(t,e))return(e===h.a.V1?c:E)+"/"+t+"/fill"},createForm:function(){return O(j,void 0,Promise,function(){var t,n,i,l,p,d,h,m;return x(this,function(w){switch(w.label){case 0:t=window.open(),w.label=1;case 1:return w.trys.push([1,6,,7]),(n=Boolean(window.cow.alphaFeatures.form))?[4,O(j,void 0,Promise,function(){var t,n,o,i,c,f,l,p,d,h,m,y,w;return x(this,function(_){switch(_.label){case 0:if(!e)throw new Error("spreadGuid is required");return[4,v.a.fetchFile(e)];case 1:return t=_.sent(),[4,v.a.fetchFileAncestors(e)];case 2:if(n=_.sent(),!t)throw new Error("sheetFile is not accessible");return f=k("未命名表单",r.spread.sheets.map(function(t){return t.name})),o=Object(g.a)(a.formService.createForm(),function(t){t.title=f}),l=a.formChangeset.toFormDelta(o).stringify(),[4,v.a.createFile({folder:n.length?n[n.length-1].guid:void 0,name:f,type:"form",content:l})];case 3:return i=_.sent(),c=i.guid,p=Object(b.a)(5),[4,r.getContent()];case 4:return d=_.sent(),h=Array.isArray(d.ops)?"richdoc":"modoc",m=a.sheetChangeset.createChangeForCreateForm({spread:d,fileType:h,formGuid:c,sheetGuid:p,sheetTitle:"未命名表单",userId:C.id}),[4,r.applyAndSendChange("richdoc"===h?s.unpack(m):new u.Delta(m),{disableRecords:!0})];case 5:return _.sent(),y=Object(g.a)(a.formService.createPublishStatus(i.id),function(e){e.spreadGuid=t.guid,e.sheetGuid=p,e.status="unpublished"}),w=1,[4,a.formService.publishForm({guid:i.guid,publishStatus:y,userId:C.id,rev:w,form:o})];case 6:return _.sent(),r.spread.setActiveSheet(p),[2,{guid:c,name:f}]}})})]:[3,3];case 2:return d=w.sent(),[3,5];case 3:return[4,O(j,void 0,Promise,function(){var t,n,i,a,u=this;return x(this,function(s){switch(s.label){case 0:return(t=A.createForm()).spreadGuid=e,t.sheetGuid=Object(b.a)(),t.title=k("表单",r.spread.sheets.map(function(t){return t.name})),n=function(){return O(u,void 0,void 0,function(){var e,n;return x(this,function(i){switch(i.label){case 0:return[4,r.getContent()];case 1:return e=i.sent(),n=o.createChangeForCreateForm({spread:e,form:t,type:-4===r.fileType?"modoc":"richdoc",userId:C.id}),[4,r.applyAndSendChange(n,{disableRecords:!0})];case 2:return i.sent(),[2]}})})},i=function(){return O(u,void 0,void 0,function(){return x(this,function(e){switch(e.label){case 0:return[4,A.publishForm(t)];case 1:return e.sent(),A.saveFormDraft(t),[2]}})})},a=function(){r.spread.setActiveSheet(t.sheetGuid)},[4,function(){if(Object(y.b)())throw new Error(f()("网络连接断开，请在网络恢复后重试"))}()];case 1:return s.sent(),[4,n()];case 2:return s.sent(),[4,i()];case 3:return s.sent(),[4,a()];case 4:return s.sent(),[2,{guid:t.guid,name:t.title}]}})})];case 4:d=w.sent(),w.label=5;case 5:return l=(i=d).guid,p=i.name,(h=r.pluginManager.get("HistoryList"))&&h.instance&&h.instance.addHistory({action:"create_form",options:{name:p}}),t&&(t.location.href=(n?E:c)+"/"+l+"/edit"),[3,7];case 6:throw m=w.sent(),t&&t.close(),m;case 7:return[2]}})})},unlinkStaleForms:function(){return O(j,void 0,Promise,function(){var t,n,o,i,a,u,s,c,f,l,p,d=this;return x(this,function(v){switch(v.label){case 0:return e?(t=r.spread.getSheets().filter(function(t){return(t.gcSheet.attrs||{}).formGuid}),[4,Promise.all(t.map(function(t){return O(d,void 0,void 0,function(){var e,r,n,o;return x(this,function(i){switch(i.label){case 0:return e=t.gcSheet.attrs,r=e.formGuid,n=e.formVersion,[4,I(r,n).catch(function(){})];case 1:return o=i.sent(),[2,{sheet:t,record:o}]}})})}))]):[2];case 1:if(n=v.sent().filter(function(t){return t.record}),o=n.filter(function(t){var r=t.record,n=t.sheet;if(!r.data)return!1;if(e&&n.id){if(r.formVersion===h.a.V1){var o=r.data.form;return!(o.spreadGuid===e&&o.sheetGuid===n.id)}if(r.formVersion===h.a.V2){var i=r.data.publishStatus;return!(i.spreadGuid===e&&i.sheetGuid===n.id)}throw new Error("unexpected formVersion: "+r.formVersion)}return!1}),i=n.filter(function(t){var r=t.record,n=t.sheet;if(e&&n.id){if(r.formVersion===h.a.V1)return!1;if(r.formVersion===h.a.V2)return void 0===r.data;throw new Error("unexpected formVersion: "+r.formVersion)}return!1}),!o.length)return[3,5];console.warn("[form] found mismatching sheet:",o.length),u=0,v.label=2;case 2:return u<o.length?(a=o[u],c=a.sheet,f=a.record,console.warn("[form] unlinking:",c.id),[4,M(c,f.formGuid,f.formVersion)]):[3,5];case 3:v.sent(),v.label=4;case 4:return u++,[3,2];case 5:if(!i.length)return[3,10];console.warn("[form] found deleted sheet:",i.length),u=0,v.label=6;case 6:return u<i.length?(s=i[u],c=s.sheet,f=s.record,l=f.formGuid,p=f.formVersion,console.warn("[form] unlinking:",c.id),[4,M(c,l,p)]):[3,10];case 7:return v.sent(),[4,F(c,l,p).catch(function(){})];case 8:v.sent(),v.label=9;case 9:return u++,[3,6];case 10:return[2]}})})},unlinkSheet:M,unlinkForm:F,unlink:D,openOrFocusPage:function(t,e,r){var n="form_"+t+"_"+e,o=(r===h.a.V1?c:E)+"/"+e+"/"+t;window.open(o,n)},confirmUnlinkForm:function(){if(Object(y.b)())Object(d.b)({title:f()("网络连接断开，请在网络恢复后重试"),type:"error"});else{var t=r.spread.getActiveSheet(),e=t.gcSheet.attrs,n=e.formGuid,o=e.formVersion;o===h.a.V1?Object(d.a)({title:f()("确定停用表单吗？"),description:f()("停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。"),confirmLabel:f()("停用"),confirmFun:function(){return O(j,void 0,void 0,function(){var e,r;return x(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,D(t,n,o)];case 1:return i.sent(),Object(d.b)({title:f()("表单已停用")}),[3,3];case 2:return e=i.sent(),r=e&&e.errmsg||f()("停用表单失败，请稍后再试"),Object(d.b)({title:r,type:"error"}),[3,3];case 3:return[2]}})})},abortLabel:f()("取消")}):o===h.a.V2&&Object(d.a)({title:f()("确定取消关联表单吗"),description:f()("取消关联后该表单的新回复将不再发送到该电子表格，但已有数据不会被删除。"),confirmLabel:f()("取消关联"),confirmFun:function(){return O(j,void 0,void 0,function(){var e,r;return x(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,D(t,n,o)];case 1:return i.sent(),Object(d.b)({title:f()("表单已取消关联")}),[3,3];case 2:return e=i.sent(),r=e&&e.errmsg||f()("取消关联失败，请稍后再试"),Object(d.b)({title:r,type:"error"}),[3,3];case 3:return[2]}})})},abortLabel:f()("取消")})}},events:_.a,track:_.b});return y.a&&Object(w.a)(N,"form"),N}},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var a=r(415),u=r(954),s=r(417),c=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]};e.createChangeForSubmitForm=function(t){var e=t.spread,r=t.type,o=t.response,f="richdoc"===r?a.Changeset.Richdoc:a.Changeset.Modoc,l="richdoc"===r?a.Changeset.Richdoc.from(e):a.Changeset.Modoc.from(e),p=i(l),d=p.findIndex(function(t){return t.attrs.formGuid===o.guid});if(-1===d)throw new Error("找不到关联的表");var h=p[d];if("number"==typeof h.data)throw new Error("工作表无数据");var v=h.data,m=v.rows,y=v.columns,b=v.cells,g=function(t){if(t)switch(t.type){case u.FormItemType.Text:return t.response;case u.FormItemType.SingleChoice:return t.choice&&t.choice.label;case u.FormItemType.MultipleChoice:return t.choices&&t.choices.map(function(t){return t.label}).join(",");case u.FormItemType.DropdownList:return t.choice&&t.choice.label;default:return function(t){throw new Error("Unexpected object: "+t)}(t)}},w=0,_=y.map(function(t){var e=t.attrs.formItemGuid,r=e&&o.items.find(function(t){return t.guid===e}),n=e?e===u.ColumnType.CREATE_AT?{value:function(t){var e=(new Date).getTimezoneOffset()/-60,r=new Date(t.valueOf()+60*(8-e)*60*1e3),n=r.getFullYear(),o=r.getMonth(),i=r.getDate(),a=r.getHours(),u=r.getMinutes(),s=r.getSeconds(),c=function(t){return t<10?"0"+t:""+t};return n+"/"+c(o+1)+"/"+c(i)+" "+c(a)+":"+c(u)+":"+c(s)}(o.createAt),guid:u.ColumnType.CREATE_AT,required:!0}:r&&{value:g(r),guid:r.guid,required:r.required}:void 0,i={colIndex:w,colItem:n};return w+=t.data,i}).filter(function(t){return t.colItem});if(c("columnData ",_),!_.some(function(t){return Boolean(t.colItem)}))throw new Error("找不到关联的表单列");for(var O=Object.keys(b).map(function(t){var e=s.fromCellName(t);return{row:e.row,column:e.column,cell:b[t]}}),x=O.filter(function(t){return function(t){return null!=t.attrs.cellValue}(t.cell)}),j=O.filter(function(t){return t.cell.attrs.rowspan}),k=function(t){return j.some(function(e){return t>e.row&&t<=e.row+e.cell.attrs.rowspan-1})},C=_.filter(function(t){return t.colItem&&t.colItem.required}),E=C.find(function(t){return t.colItem.guid===u.ColumnType.CREATE_AT}),A=function(t){var e=x.filter(function(e){return e.row===t});if(E){var r=e.find(function(t){return t.column===E.colIndex});return Boolean(r)}return C.length?C.every(function(t){return e.some(function(e){return e.column===t.colIndex})}):_.some(function(t){return e.some(function(e){return e.column===t.colIndex})})},I=1,S=m.reduce(function(t,e){return t+e.data},0);I<S&&(A(I)||k(I));)I++;c("insertAt ",I);var T=function(){var t={};_.filter(function(t){return t.colItem}).forEach(function(e){var r=s.toCellName(I,e.colIndex),i=e.colItem;t[r]=f.retain(a.Element.Cell,n({vertical:"middle",wrap:"text-no-wrap",format:"@","font-size":9,userID:o.userId,authorId:o.userId,cellValue:i&&i.value},e.colItem.guid===u.ColumnType.CREATE_AT?{format:"YYYY/MM/DD HH:mm:ss"}:{}),1)});var e=[f.retain(a.Element.Row,{},I),f.insert(a.Element.Row,{height:22},1)],r=i(0===d?[]:[f.retain(a.Element.Table,{},d)],[f.retain(a.Element.Table,{id:h.attrs.id},{cells:t,rows:e})]);return f.create(r)}();return c("change ",T),T.content}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(940);e.Delta=n.default;var o=r(526);r(944).registerDataHandlers(o.default,n.default,o.default)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(525),o=r(941),i=r(942),a=function(){function t(t){void 0===t&&(t={array:[],packedData:""}),this[n.TYPE_PROPERTY]="Pool","string"==typeof t?(this.array=JSON.parse(t),this.packedData=t):(this.array=t.array,this.packedData=t.packedData)}return t.isPool=function(t){return"object"==typeof t&&null!==t&&"Pool"===t[n.TYPE_PROPERTY]},t.prototype.isSubsetOf=function(t){if(this===t)return!0;var e=this.array.length;if(0===e)return!0;if(e>t.array.length)return!1;for(var r=0;r<e;r++)if(this.array[r]!==t.array[r])return!1;return!0},t.prototype.getMap=function(){if(!this.map){this.map={};for(var t=0;t<this.array.length;t++)this.map[this.array[t]]=String(t)}return this.map},t.prototype.packAttributes=function(t){if(!t)return"";var e=Object.keys(t),r=e.length;if(0===r)return"";for(var n=[],o=[],a=0;a<r;a++){var u=e[a],s=t[u];if("object"==typeof s&&null!==s)for(var c=0,f=i.objectToKeyPaths(s,"."+u);c<f.length;c++){var l,p=f[c];" "===(l=this.getAddress(p[0],p[1]))[0]?n.push(l):o.push(l)}else" "===(l=this.getAddress(u,s))[0]?n.push(l):o.push(l)}return o.sort().join("")+n.sort().join("")},t.prototype.getAddress=function(t,e){var r=o.combinedAttributeWithValue(t,e),n=o.getGulByCombinedKeyValue(r);if("string"==typeof n)return n;var i=this.getMap();if(!i.hasOwnProperty(r)){this.packedData=void 0;var a=this.array.length;i[r]=String(a),this.array.push(r)}return" "+i[r]},t.prototype.unpackAttributes=function(t,e){void 0===e&&(e=!0);for(var r={},n=0;n<t.length&&" "!==t[n];){var a=o.getKeyValueByGul(t[n]),u=a[0],s=a[1];e&&"."===u[0]?i.keyPathToObject(r,u,s):r[u]=s,n+=1}if(n<t.length-1)for(var c=0,f=t.substring(n+1).split(" ");c<f.length;c++){var l=f[c],p=o.parseCombinedAttributeValue(this.array[l]);u=p[0],s=p[1];e&&"."===u[0]?i.keyPathToObject(r,u,s):r[u]=s}return r},t.prototype.stringify=function(){return"string"!=typeof this.packedData&&(this.packedData=this.array.length?JSON.stringify(this.array):""),this.packedData},t.prototype.clone=function(){return new t({array:this.array.slice(),packedData:this.packedData})},t}();e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initialToObjectKey={A:"attachment",C:"cell",I:"image",D:"delta",T:"table",P:"presentation",S:"slide",M:"mention",N:"inline-break",V:"divide",U:"upload-placeholder-attachment",G:"gallery",B:"gallery-block",Z:"mindmap",O:"object",F:"form"},e.objectKeyToInitial=Object.keys(e.initialToObjectKey).reduce(function(t,r){return t[e.initialToObjectKey[r]]=r,t},{})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.merge=function(t,e,r){var n=Object.keys(t);if(r&&0===n.length)return e;for(var o=0,i=Object.keys(e);o<i.length;o++){var a=i[o];t[a]=e[a],r||null!==t[a]||delete t[a]}return t},e.transform=function(t,e,r){if(r)return e;var n=Object.keys(e);if(0===n.length)return e;var o=Object.keys(t);if(0===o.length)return e;if(o.length>n.length)for(var i=0,a=n;i<a.length;i++){var u=a[i];t.hasOwnProperty(u)&&delete e[u]}else for(var s=0,c=o;s<c.length;s++)delete e[c[s]];return e},e.invert=function(t,e){var r=Object.keys(e);if(0===r.length)return e;if(0===Object.keys(t).length)for(var n=0,o=r;n<o.length;n++)e[u=o[n]]=null;else for(var i=0,a=r;i<a.length;i++){var u,s=t[u=a[i]];e[u]=void 0===s?null:s}return e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(525);e.isDelta=function(t){return"object"==typeof t&&null!==t&&"Delta"===t[n.TYPE_PROPERTY]}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.possibleDeltaInputToString=function(t,e){if(void 0===e||null===e)return"";if(Array.isArray(e)){if(0===e.length)return"";var r=new t(e);return r.isEmpty()?"":r.stringify()}return e.isEmpty()?"":e.stringify()}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(607),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){for(var n=this.parse(t).slice(0),o=this.parse(e).slice(0),i=Math.max(n.length,o.length),a=new Array(i),u=0;u<i;u++){var s=n[u],c=o[u];a[u]=s?c?s.compose(c,r):s:c}return this.pack(a)},e.prototype.transform=function(t,e,r){for(var n=this.parse(t).slice(0),o=this.parse(e).slice(0),i=Math.max(n.length,o.length),a=new Array(i),u=0;u<i;u++){var s=n[u],c=o[u];a[u]=s?c?s.transform(c,r):void 0:c}return this.pack(a)},e.prototype.invert=function(t,e){for(var r=this.parse(t).slice(0),n=this.parse(e).slice(0),o=Math.max(r.length,n.length),i=new Array(o),a=0;a<o;a++){var u=r[a],s=n[a];i[a]=u?s?u.invert(s):void 0:s}return this.pack(i)},e.prototype.parse=function(t){for(var e=0,r=[];e<t.length;){var n=t.indexOf("$",e);if(-1===n)break;var o=parseInt(t.substring(e,n),36),i=n+1+o,a=0===o?void 0:new this.deltaConstructor(t.substring(n+1,i));e=i,r.push(a)}return r},e.prototype.pack=function(t){for(var e="",r=0,n=t;r<n.length;r++){var i=n[r],a=o.possibleDeltaInputToString(this.deltaConstructor,i);e+=a.length.toString(36)+"$"+a}return e},e.prototype.toJSON=function(t){return this.parse(t).map(function(t){return t?t.toJSON():void 0})},e.prototype.explain=function(t,e){for(var r=t+"List:\n",n=this.parse(e),o=0;o<n.length;o++){var i=n[o];r+=t+"Item #"+o+":\n",r+=i?i.explain(t):"[EMPTY]"}return r},e}(r(390).default);e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Text="text",t.SingleChoice="single_choice",t.MultipleChoice="multiple_choice",t.DropdownList="dropdown_list"}(e.FormItemType||(e.FormItemType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createLogger=function(t){var e=t.channel,r=t.logger;return function(t,n){return n=n||t.name,function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r.info.apply(r,["["+e+"]["+n+"] args:"].concat(o));try{var a=t.apply(void 0,o);if(a&&a.then)return a.then(function(t){return r.info("["+e+"]["+n+"] result:",t),t},function(t){throw r.error("["+e+"]["+n+"] error:",t),t})}catch(t){throw r.error("["+e+"]["+n+"] error:",t),t}}}}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=r(418),i=r(612),a=r(613);e.toServerFormItem=function(t){return{guid:t.guid,name:t.subject,type:function(t){var e;return((e={})[o.FormItemType.Text]=i.ServerFormItemType.Text,e[o.FormItemType.SingleChoice]=i.ServerFormItemType.SingleChoice,e[o.FormItemType.MultipleChoice]=i.ServerFormItemType.MultipleChoice,e[o.FormItemType.DropdownList]=i.ServerFormItemType.DropdownList,e)[t]}(t.type),isRequired:t.required?1:0,choices:t.type===o.FormItemType.Text?void 0:a.stringify(t.options),allowOther:t.type===o.FormItemType.Text||t.type===o.FormItemType.DropdownList?void 0:t.options.some(function(t){return"other"===t.type})}};var u=function(t){var e={guid:t.guid,required:1===t.isRequired,subject:t.name};if(t.type===i.ServerFormItemType.Text)return n({type:o.FormItemType.Text},e);if(t.type===i.ServerFormItemType.SingleChoice)return n({type:o.FormItemType.SingleChoice},e,{options:a.parse(t.choices)});if(t.type===i.ServerFormItemType.MultipleChoice)return n({type:o.FormItemType.MultipleChoice},e,{options:a.parse(t.choices)});if(t.type===i.ServerFormItemType.DropdownList)return n({type:o.FormItemType.DropdownList},e,{options:a.parse(t.choices)});throw new Error("unknown item type: "+t.type)};e.toServerForm=function(t){var e=t;return{guid:e.guid,name:e.title,description:"string"==typeof e.desc?e.desc:"",fileGuid:e.spreadGuid,sheetGuid:e.sheetGuid,expiredAt:"boolean"==typeof e.deadline?e.deadline?new Date(e.deadlineDate).getTime():null:void 0}},e.fromServerForm=function(t,e){var r=new Date(new Date((new Date).getTime()+6048e5).setHours(12,0,0,0));return{creatorId:t.creatorId,guid:t.guid,title:t.name||"",desc:"string"==typeof t.description?t.description:"",spreadGuid:t.fileGuid,sheetGuid:t.sheetGuid,deadline:Boolean(t.expiredAt),deadlineDate:t.expiredAt?new Date(t.expiredAt):r,items:e.map(u)}},e.fromServerItemReponse=function(t,e){var r=u(e);if(!r)throw new Error("formItem not found, item guid: "+t.guid);if(r.type===o.FormItemType.Text)return r.response=t.value,r;if(r.type===o.FormItemType.SingleChoice||r.type===o.FormItemType.DropdownList){if("single_choice"!==(n=a.parse(t.value)).type&&"dropdown_list"!==n.type)throw new Error("unexpected response type: "+n.type);return r.choice=n.value.choice,r}if(r.type===o.FormItemType.MultipleChoice){var n;if("multiple_choice"!==(n=a.parse(t.value)).type)throw new Error("unexpected response type: "+n.type);return r.choices=n.value.choices,r}throw new Error("unknown formItem type: "+JSON.stringify(r))},e.toServerItemReponse=function(t,e){var r={guid:t.guid,isRequired:t.required?1:0,importerId:""+e};if(t.type===o.FormItemType.Text)return n({},r,{value:t.response});if(t.type===o.FormItemType.SingleChoice)return n({},r,{value:a.stringify({type:"single_choice",value:{choice:t.choice}})});if(t.type===o.FormItemType.MultipleChoice)return n({},r,{value:a.stringify({type:"multiple_choice",value:{choices:t.choices}})});if(t.type===o.FormItemType.DropdownList)return n({},r,{value:a.stringify({type:"dropdown_list",value:{choice:t.choice}})});throw new Error("unknown item: "+JSON.stringify(t))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Text=0]="Text",t[t.SingleChoice=1]="SingleChoice",t[t.MultipleChoice=2]="MultipleChoice",t[t.DropdownList=3]="DropdownList"}(e.ServerFormItemType||(e.ServerFormItemType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parse=JSON.parse,e.stringify=JSON.stringify},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(415),a=r(417),u="CREATE_AT";e.createChangeForUpdateForm=function(t){var e=t.spread,r=t.form,n=t.type,s=t.userId,c="richdoc"===n?i.Changeset.Richdoc:i.Changeset.Modoc,f="richdoc"===n?i.Changeset.Richdoc.from(e):i.Changeset.Modoc.from(e),l=o(f),p=l.findIndex(function(t){return t.attrs.formGuid===r.guid});if(-1===p)throw new Error("找不到关联的表");var d=l[p];if("number"==typeof d.data)throw new Error("工作表无数据");for(var h=d.data,v=(h.rows,h.columns),m=h.cells,y=v.reduce(function(t,e){var r=t[t.length-1];return t.concat({colIndex:r?r.colIndex+r.colOperator.data:0,colOperator:e})},[]),b=y.length-1;b>=0;){if(null!=y[b].colOperator.attrs.formItemGuid)break;b--}var g=-1!==b?y[b].colIndex:-1,w={},_=y.slice(0,b+1).map(function(t){var e=t.colIndex,n=t.colOperator;if(null==n.attrs.formItemGuid)return c.retain(i.Element.Column,{},n.data);if(n.attrs.formItemGuid==u)return c.retain(i.Element.Column,{},n.data);var o=r.items.find(function(t){return t.guid===n.attrs.formItemGuid});if(o){var f=a.toCellName(0,e),l=m[f];return(l&&function(t){var e=t.data,r=t.attrs;if("number"!=typeof e)return r.cellValue}(l))!==o.subject&&(w[f]=c.retain(i.Element.Cell,{userId:s,authorId:s,cellValue:o.subject},1)),c.retain(i.Element.Column,{},n.data)}return c.retain(i.Element.Column,{formItemGuid:null,userId:s,authorId:s},n.data)}),O=r.items.filter(function(t){return!y.find(function(e){return e.colOperator.attrs.formItemGuid===t.guid})}).map(function(t,e){var r=a.toCellName(0,g+1+e);return w[r]=c.retain(i.Element.Cell,{userId:s,color:"#ffffff",background:"#41464b",format:"@",cellValue:null!=t.subject?t.subject:""},1),c.insert(i.Element.Column,{formItemGuid:t.guid},1)}),x=void 0;r.title!==d.attrs.name&&(l.map(function(t){return t.attrs.name}).every(function(t){return t!==r.title})&&(x=r.title));var j=o(0===p?[]:[c.retain(i.Element.Table,{},p)],[c.retain(i.Element.Table,{id:r.sheetGuid,name:x},{cells:w,columns:o(_,O)})]);return c.create(j).content}},function(t,e,r){var n=r(392),o=r(282).document,i=n(o)&&n(o.createElement);t.exports=function(t){return i?o.createElement(t):{}}},function(t,e,r){var n=r(282),o=r(391),i=r(421),a=r(530)("src"),u=r(967),s=(""+u).split("toString");r(193).inspectSource=function(t){return u.call(t)},(t.exports=function(t,e,r,u){var c="function"==typeof r;c&&(i(r,"name")||o(r,"name",e)),t[e]!==r&&(c&&(i(r,a)||o(r,a,t[e]?""+t[e]:s.join(String(e)))),t===n?t[e]=r:u?t[e]?t[e]=r:o(t,e,r):(delete t[e],o(t,e,r)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[a]||u.call(this)})},function(t,e){t.exports=!1},function(t,e,r){var n=r(970),o=r(620);t.exports=Object.keys||function(t){return n(t,o)}},function(t,e,r){var n=r(533),o=r(423);t.exports=function(t){return n(o(t))}},function(t,e){t.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(t,e,r){var n=r(419).f,o=r(421),i=r(194)("toStringTag");t.exports=function(t,e,r){t&&!o(t=r?t:t.prototype,i)&&n(t,i,{configurable:!0,value:e})}},function(t,e,r){var n=r(532),o=r(533),i=r(424),a=r(394),u=r(1e3);t.exports=function(t,e){var r=1==t,s=2==t,c=3==t,f=4==t,l=6==t,p=5==t||l,d=e||u;return function(e,u,h){for(var v,m,y=i(e),b=o(y),g=n(u,h,3),w=a(b.length),_=0,O=r?d(e,w):s?d(e,0):void 0;w>_;_++)if((p||_ in b)&&(m=g(v=b[_],_,y),t))if(r)O[_]=m;else if(m)switch(t){case 3:return!0;case 5:return v;case 6:return _;case 2:O.push(v)}else if(f)return!1;return l?-1:c||f?f:O}}},function(t,e,r){var n=r(194)("unscopables"),o=Array.prototype;void 0==o[n]&&r(391)(o,n,{}),t.exports=function(t){o[n][t]=!0}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=r(425),a=o(r(175)),u=o(r(156)),s=r(176),c=r(176),f=r(426),l=r(625);e.createChangeForSubmitForm=function(t){var e=t.fileType,r=t.spread,o=t.form,p=t.formGuid,d=t.submission,h=t.time;switch(e){case"modoc":return function(t){var e=t.spread,r=t.formGuid;t.submission;c.assert(a.Delta.isDelta(e),"spread should be modoc.Delta"),c.assert("string"==typeof r,"formGuid should be string");var o=i.getModocOperators(e),u=o.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===r});if(-1===u)throw new Error("找不到指定的表单工作表");var s,f=o[u],p=0===u?void 0:{action:"retain",attributes:{},data:u},d={action:"retain",attributes:{userId:t.submission.userId,authorId:t.submission.userId},data:{table:{rows:[{action:"retain",attributes:{},data:1},{action:"insert",attributes:{height:22},data:1}]}}},h=p?[p,d]:[d];s=new a.Delta(h);var v,m,y,b=n(f.getParsedData(),2);b[0];m=b[1].toJSON().map(function(e){var r=e.attributes||{};if(!r.formItemGuid)return{action:"retain",attributes:{},data:1};var n=r.formItemGuid,o=t.form.questions.find(function(t){return t.guid===n}),a=t.submission.content.find(function(t){return t.guid===n});return n===i.CREATE_AT||a&&o?{action:"retain",attributes:{},data:{delta:[{action:"retain",attributes:{},data:1},n===i.CREATE_AT?i.createTextCellOp(l.stringifyDate(t.time),t.submission.userId):i.questionResponseToCellOp({question:o,response:a,userId:t.submission.userId})]}}:{action:"retain",attributes:{},data:1}});d={action:"retain",attributes:{userId:t.submission.userId,authorId:t.submission.userId},data:{table:{cols:m}}};return y=p?[p,d]:[d],v=new a.Delta(y),s.compose(v).stringify()}({spread:"string"==typeof r?new a.Delta(r):r,form:o,formGuid:p,submission:d,time:h});case"richdoc":return function(t){var e=t.spread,r=t.formGuid;t.submission;c.assert(Array.isArray(e&&e.ops),"spread should be richdoc.Delta"),c.assert("string"==typeof r,"formGuid should be string");var n=e.ops,o=n.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===r});if(-1===o)throw new Error("找不到指定的表单工作表");var a,s,p=n[o],d=0===o?void 0:new u.TableOperator({action:"retain",attributes:{},data:o}),h=new u.Delta([new u.Operator({action:"retain",attributes:{},data:1}),new u.Operator({action:"insert",attributes:{height:22},data:1})]),v=new u.TableOperator({action:"retain",attributes:{userId:t.submission.userId,authorId:t.submission.userId},data:{rows:h}}),m=d?[d,v]:[v];a=new u.Delta(m);var y=p.data,b=y.cols,g={},w=y.rows.ops[0].data,_=0;b.ops.forEach(function(e){var r=e.getAttributes()||{},n=e.data;if(r.formItemGuid){var o=r.formItemGuid,a=t.form.questions.find(function(t){return t.guid===o}),s=t.submission.content.find(function(t){return t.guid===o});(o===i.CREATE_AT||s&&a)&&(g[f.toCellName(w,_)]=o===i.CREATE_AT?new u.CellOperator(i.createTextCellOp(l.stringifyDate(t.time),t.submission.userId)):new u.CellOperator(i.questionResponseToCellOp({question:a,response:s,userId:t.submission.userId})),_+="number"==typeof n?n:1)}});m=void 0,v=new u.TableOperator({action:"retain",attributes:{userId:t.submission.userId,authorId:t.submission.userId},data:{cells:g}});m=d?[d,v]:[v],s=new u.Delta(m);var O=a.compose(s);return u.pack(O)}({spread:"string"==typeof r?u.unpack(r):r,form:o,formGuid:p,submission:d,time:h});default:return s.assertNever(e)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(new Date).getTimezoneOffset()/-60;e.parseDate=function(t,e){void 0===e&&(e=8);var r=new Date(t);return new Date(r.getTime()-60*(e-n)*60*1e3)},e.stringifyDate=function(t,e){void 0===e&&(e=8);var r=new Date(t.getTime()+60*(e-n)*60*1e3),o=r.getFullYear(),i=r.getMonth(),a=r.getDate(),u=r.getHours(),s=r.getMinutes(),c=r.getSeconds(),f=function(t){return t<10?"0"+t:""+t};return o+"/"+f(i+1)+"/"+f(a)+" "+f(u)+":"+f(s)+":"+f(c)}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u=r(425),s=a(r(175)),c=a(r(156)),f=r(176),l=r(176),p=r(426);e.createChangeForUpdateForm=function(t){var e=t.fileType,r=t.spread,a=t.form,d=t.formGuid,h=t.userId;switch(e){case"modoc":return function(t){var e=t.spread,r=t.formGuid,a=t.form,c=t.userId;l.assert(s.Delta.isDelta(e),"spread should be modoc.Delta"),l.assert("string"==typeof r,"formGuid should be string"),l.assert(a,"form is required"),l.assert(c,"userId should be string");var f=u.getModocOperators(e),p=f.map(function(t){return t.getAttributes()||{}}),d=p.map(function(t){return t.name}),h=p.findIndex(function(t){return t.formGuid===r});if(-1===h)throw new Error("找不到指定的表单工作表");var v,m=f[h],y=0===h?void 0:{action:"retain",attributes:{},data:h},b=o(m.getParsedData(),2),g=(b[0],b[1].toJSON()),w=g.map(function(t){return(t.attributes||{}).formItemGuid}).filter(Boolean),_=-1,O=g.map(function(e,r){var n=e.attributes||{},o=e.data,i="number"==typeof o?o:1,a={action:"retain",attributes:{},data:i};if(!n.formItemGuid)return a;if(n.formItemGuid===u.CREATE_AT)return _=Math.max(r,_),a;var s=n.formItemGuid,c=s&&t.form.questions.find(function(t){return t.guid===s});return c?(_=Math.max(r,_),{action:"retain",attributes:{},data:{delta:[{action:"retain",attributes:{cellValue:c.subject},data:1}]}}):{action:"retain",attributes:{formItemGuid:null},data:i}});O=O.slice(0,_+1);var x,j=a.questions.filter(function(t){return-1===w.indexOf(t.guid)}).map(function(t){return{action:"insert",attributes:{formItemGuid:t.guid},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:c,authorId:c,background:"#41464b",format:"@",cellValue:t.subject||"添加问题项"},data:1}]}}});v=i(O,j);var k={action:"retain",attributes:n({},-1===d.indexOf(a.title)?{name:a.title}:{},{userId:c,authorId:c}),data:{table:{cols:v}}};return x=y?[y,k]:[k],new s.Delta(x).stringify()}({spread:"string"==typeof r?new s.Delta(r):r,form:a,formGuid:d,userId:h});case"richdoc":return function(t){var e=t.spread,r=t.formGuid,o=t.form,a=t.userId;l.assert(Array.isArray(e.ops),"spread should be modoc.Delta"),l.assert("string"==typeof r,"formGuid should be string"),l.assert(o,"form is required"),l.assert(a,"userId should be string");var s=e.ops,f=s.map(function(t){return t.getAttributes()||{}}),d=f.map(function(t){return t.name}),h=f.findIndex(function(t){return t.formGuid===r});if(-1===h)throw new Error("找不到指定的表单工作表");var v,m=s[h],y=0===h?void 0:new c.TableOperator({action:"retain",attributes:{},data:h}),b={},g=m.data,w=g.cells,_=g.cols.ops,O=_.map(function(t){return(t.getAttributes()||{}).formItemGuid}).filter(Boolean),x=-1,j=0,k=_.map(function(e,r){var n=e.getAttributes()||{},o=e.data,i="number"==typeof o?o:1,s=new c.Operator({action:"retain",attributes:{},data:i});if(!n.formItemGuid)return j+=i,s;if(n.formItemGuid===u.CREATE_AT)return x=Math.max(r,x),j+=i,s;var f=n.formItemGuid,l=f&&t.form.questions.find(function(t){return t.guid===f});if(l){x=Math.max(r,x);var d=p.toCellName(0,j),h=w.get(d);return(h&&u.getCellContent(h))!==l.subject&&(b[d]=new c.CellOperator(u.createTextCellOp(l.subject,a))),j+=i,s}return j+=i,new c.Operator({action:"retain",attributes:{formItemGuid:null},data:i})});k=k.slice(0,x+1);var C,E=o.questions.filter(function(t){return-1===O.indexOf(t.guid)}),A=u.getOperatorSize(k),I=E.map(function(t,e){var r=p.toCellName(0,A+e);return b[r]=new c.CellOperator(u.createTextCellOp(t.subject||"添加问题项",a,{color:"#ffffff",background:"#41464b",format:"@"})),new c.Operator({action:"insert",attributes:{formItemGuid:t.guid},data:1})});v=i(k,I);var S=new c.TableOperator({action:"retain",attributes:n({},-1===d.indexOf(o.title)?{name:o.title}:{},{userId:a,authorId:a}),data:{cols:new c.Delta(v),cells:b}});return C=y?[y,S]:[S],c.pack(new c.Delta(C))}({spread:"string"==typeof r?c.unpack(r):r,form:a,formGuid:d,userId:h});default:return f.assertNever(e)}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=o(r(175)),a=o(r(156)),u=r(176),s=r(176);e.createChangeForUnlinkForm=function(t){var e=t.fileType,r=t.spread,o=t.formGuid,c=t.userId;switch(e){case"modoc":return function(t){var e=t.spread,r=t.formGuid,o=t.userId;s.assert(i.Delta.isDelta(e),"spread should be modoc.Delta"),s.assert("string"==typeof r,"formGuid should be string"),s.assert(o,"userId is not provided");for(var a=[],u=e.getIter();u.hasNext();)a.push(u.next());var c=a.map(function(t){return t.getAttributes()||{}}),f=c.findIndex(function(t){return t.formGuid===r});if(-1===f)throw new Error("找不到指定的表单工作表");for(var l=a[f],p=c[f],d=n(l.getParsedData(),2)[1].getIter(),h=[];d.hasNext();)h.push(d.next());var v=h.map(function(t){var e=t.getAttributes(),r=t.data,n="number"==typeof r?r:1;return e.formItemGuid?{action:"retain",attributes:{formItemGuid:null},data:n}:{action:"retain",attributes:{},data:n}}),m=0===f?void 0:{action:"retain",attributes:{},data:f},y={action:"retain",attributes:p.formVersion?{formGuid:null,formVersion:null,userId:o,authorId:o}:{formGuid:null,userId:o,authorId:o},data:{table:{cols:v}}},b=m?[m,y]:[y];return new i.Delta(b).stringify()}({spread:"string"==typeof r?new i.Delta(r):r,formGuid:o,userId:c});case"richdoc":return function(t){var e=t.spread,r=t.formGuid,n=t.userId;s.assert(Array.isArray(e&&e.ops),"spread should be richdoc.Delta"),s.assert("string"==typeof r,"formGuid should be string"),s.assert(n,"userId is not provided");for(var o=[],i=e.getIter();i.hasNext();)o.push(i.next());var u=o.map(function(t){return t.getAttributes()||{}}),c=u.findIndex(function(t){return t.formGuid===r});if(-1===c)throw new Error("找不到指定的表单工作表");for(var f=o[c],l=u[c],p=f.data.cols.getIter(),d=[];p.hasNext();)d.push(p.next());var h=new a.Delta(d.map(function(t){var e=t.getAttributes(),r=t.data,n="number"==typeof r?r:1;return e.formItemGuid?new a.Operator({action:"retain",attributes:{formItemGuid:null},data:n}):new a.Operator({action:"retain",attributes:{},data:n})})),v=0===c?void 0:new a.TableOperator({action:"retain",attributes:{},data:c}),m=new a.TableOperator({action:"retain",attributes:l.formVersion?{formGuid:null,formVersion:null,userId:n,authorId:n}:{formGuid:null,userId:n,authorId:n},data:{cols:h}}),y=new a.Delta(v?[v,m]:[m]);return a.pack(y)}({spread:"string"==typeof r?a.unpack(r):r,formGuid:o,userId:c});default:return u.assertNever(e)}}},function(t,e,r){(function(n){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var n=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++n)}),e.splice(o,0,r)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==n&&"env"in n&&(t=Object({NODE_ENV:"production",HOST:"shimodev_com",VERSION:"HEAD[aaf27131e]",BRANCH:"HEAD",COMMIT:"aaf27131e",GC_VERSION:"aaf27131e",SDK:!0}).DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||function(){},t.exports=r(1012)(e),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(e,r(180))},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&(r[n[o]]=t[n[o]])}return r},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u=r(540),s=r(176),c=r(1015),f=r(175),l=a(r(175)),p=r(1017);r(539).isDebugging&&"undefined"!=typeof window&&(window.modoc=window.modoc||l),e.createQuestionOperator=p.createOperator,e.createRuleOperator=p.createOperator,e.createFormOperator=p.createOperator,e.createFormDelta=function(t){return new f.Delta(t)},e.toQuestionOperator=function(t,r){if("remove"===t)return e.createQuestionOperator(t,{},1);var o=r.guid,i=r.required,a=r.subject,u=r.question,s=r.type;return e.createQuestionOperator(t,{},{object:{guid:o,required:i,subject:a,question:n({type:s},u)}})},e.toFormOperatorAttributes=function(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=r;switch(n){case"title":case"desc":case"descAlign":e[n]=t[n];break;case"questions":case"rules":break;default:return s.assertNever(n)}}return e},e.toFormOperator=function(t){var r=t.questions,n=(t.rules,o(t,["questions","rules"])),i=r?r.map(function(t){return e.toQuestionOperator("insert",t)}):[],a=[];return e.createFormOperator("insert",e.toFormOperatorAttributes(n),{form:[i,a]})},e.toFormDelta=function(t){var r=e.toFormOperator(t);return e.createFormDelta([r])},e.createEmptyForm=function(t){var r=c.produce(u.createForm(),function(t){});return e.toFormDelta(r).stringify()},e.toFormQuestion=function(t){var e=t.action,r=t.data;if("insert"!==e)throw new Error("should be insert");if("number"==typeof r)throw new Error("should be object");var n=r.object,i=n.guid,a=n.required,u=n.subject,s=n.question;return{guid:i,type:s.type,required:a,subject:u,question:o(s,["type"])}},e.toFormRule=function(t){var e=t.action,r=t.data;if("insert"!==e)throw new Error("should be insert");if("number"==typeof r)throw new Error("should be object");var n=r.object,i=n.guid,a=n.rule;return{guid:i,type:a.type,rule:o(a,["type"])}};e.toForm=function(t){var r=i("string"==typeof t?new f.Delta(t).toJSON():t.toJSON(),1)[0],n=r.action,o=r.attributes,a=r.data;if("insert"!==n)throw new Error("should be insert");if("number"==typeof a)throw new Error("should be object");var l=i(a.form,2),p=l[0],d=void 0===p?[]:p,h=l[1],v=void 0===h?[]:h,m=d.map(e.toFormQuestion),y=v.map(e.toFormRule);return c.produce(u.createForm(),function(t){Object.assign(t,function(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=r;switch(n){case"title":case"desc":case"descAlign":e[n]=null==t[n]?void 0:t[n];break;default:s.softAssertNever(n)}}return e}(o),{questions:m,rules:y})})},e.compose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=i(t),n=r[0],o=r.slice(1);if(!n)throw new Error("no deltas to compose");return o.reduce(function(t,e){return t.compose(e)},n)}},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n={V1:void 0,V2:2}},function(t,e,r){"use strict";r.d(e,"a",function(){return n});r(544);var n=function(t){throw new TypeError("Unexpected type: "+JSON.stringify(t))}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){r(933),t.exports=r(935)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=(r.n(n),r(934)),i=r.n(o),a=n.sheets,u=a.root;(0,a.path.setByPath)(u,"shimo.sdk.sheet.plugins.FormLocaleResources",{"en-US":i.a})},function(t,e){t.exports={'表单已创建成功。<a class="edit_link" href="%s" target="_blank">点击此处可编辑表单</a><div class="close_prompt" onclick="hideEditPageAlert()"></div>':'The form has been created.<a class="edit_link" href="%s" target="_blank">Click here to edit the form</a><div class="close_prompt" onclick="hideEditPageAlert()"></div>',"表单 1":"Form 1","表单 ":"Form","表单 %s":"Form %s","网络连接断开，请在网络恢复后重试":"Network disconnected. Try gain after network restored","表单不存在，请检查后再试":"Form doesn't exist. Check and try again.","表单":"Form","表格协作者才能创建表单":"Only the collaborator can create form","只有表单创建者才能操作":"Only the form creator can operate","表单创建失败，请稍后重试":"Form create failed, Try it again later","确认停用表单吗？":"Disable the form anyway?","停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。":"Once disabled the worksheet would become a normal sheet.The created form would be void.No more feedbacks to the form would be reveived.","停用":"Disable","表单已停用":"Form has been disabled","停用表单失败，请稍后再试":"Form disable failed, Try again later","取消":"Cancel"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(3),o=r.n(n),i=r(1),a=(r.n(i),r(600)),u=r(1032),s=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},c=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},f=i.sheets,l=f.root,p=f.path.setByPath,d=i.Editor,h="Form",v=function(){function t(t){var e=t.editor,r=t.guid,n=t.apiBaseUrl,o=void 0===n?window.location.origin+"/form":n,i=t.pageBaseUrl,s=void 0===i?window.location.origin+"/form":i,c=t.currentUser,f=t.fetchLocaleSync,l=this;this.getMenuConfig=function(){return Object(u.a)({formController:l.formController,editor:l.editor})},this.editor=e,this.formController=Object(a.b)({editor:e,apiBaseUrl:o,pageBaseUrl:s,user:c}),this.formController.setSpreadGuid(r),e.pluginManager.install({name:h,instance:this}),this.setLocale(e.getLocale(),f)}return t.prototype.setLocale=function(t,e){t!==d.defaultLocale&&(o.a.configure({fetchLocaleSync:e||this.editor.genDefaultFetchLocaleFunc(h)}),o.a.setLocaleSync(t))},t.prototype.init=function(){},t.prototype.updateConfig=function(t){t.hasOwnProperty("guid")&&this.formController.setSpreadGuid(t.guid)},t.prototype.confirmUnlinkForm=function(){this.formController.confirmUnlinkForm()},t.prototype.unlinkStaleForm=function(){return s(this,void 0,Promise,function(){return c(this,function(t){switch(t.label){case 0:return[4,this.formController.unlinkStaleForms()];case 1:return t.sent(),[2]}})})},t}();e.default=v,p(l,"shimo.sdk.sheet.plugins.Form",v)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(937);e.formEntryToChangeset=n.formEntryToChangeset;var o=r(601);e.createChangeForSubmitForm=o.createChangeForSubmitForm;var i=r(959);e.createChangeForCreateForm=i.createChangeForCreateForm;var a=r(614);e.createChangeForUpdateForm=a.createChangeForUpdateForm;var u=r(960);e.createChangeForUnlinkForm=u.createChangeForUnlinkForm},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=o(r(938)),a=r(601),u=r(418),s=r(614),c=o(r(156)),f=o(r(175));e.formEntryToChangeset=function(t){var e=t.content,r=t.formEntry,o=t.userId,l=t.fileType,p=void 0===l?"richdoc":l;if(null==r.action)return i.genSheetFormChangeset({content:e,userId:o,formEntry:r});var d="richdoc"===p?c.unpack.bind(c):function(t){return new f.Delta(t)},h="richdoc"===p?c.pack.bind(c):function(t){return t.stringify()};if("submit_entry"===r.action){var v=r.payload,m=v.form,y=v.items,b=v.responses,g=v.userId;return h(a.createChangeForSubmitForm({spread:d(e),type:p,response:{guid:m.guid,items:y.map(function(t,e){var r=b[e];if(!r||r.guid!==t.guid)throw new Error("cannot find matching response for item["+e+"]: "+JSON.stringify(t));return u.ServerAdapters.fromServerItemReponse(n({},r,{importerId:""+g}),t)}),userId:g,createAt:new Date}}))}if("update_form"===r.action){var w=r.payload,_=(m=w.form,y=w.items,w.userId);return h(s.createChangeForUpdateForm({spread:d(e),type:p,form:u.ServerAdapters.fromServerForm(m,y),userId:_}))}throw new Error("unexpected formEntry: "+JSON.stringify(r))}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r(156)),u={ALPHABET:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",getColumnLabel:function(t){if(t>676)throw new Error("column index exceeds 26^2, not supported");var e=Math.floor(t/26),r=t%26;return""+(e?u.ALPHABET[e-1]:"")+u.ALPHABET[r]},parseColumnLabel:function(t){var e=n(t.split("").map(function(t){return u.ALPHABET.indexOf(t)}),2),r=e[0],o=e[1];return null==o?r:26*(r+1)+o},getCellName:function(t,e){return""+u.getColumnLabel(e)+(t+1)},parseCellName:function(t){return{column:u.parseColumnLabel(t.match(/^[a-zA-Z]+/)[0]),row:Number(t.match(/\d+$/)[0])-1}}},s=function(){var t=function(t,e,r,n){return void 0===n?new a[e+"Operator"]({action:t,data:r}):new a[e+"Operator"]({action:t,attributes:r,data:n})},e=function(t){return new a.Delta(t)};return Object.assign(e,{retain:t.bind(null,"retain"),insert:t.bind(null,"insert"),delete:t.bind(null,"delete")}),e}();e.genSheetFormChangeset=function(t){var e=t.content,r=t.formEntry,n=t.userId;e=a.unpack(e);var i=r.formGuid,c=r.formItems,f=e.ops.find(function(t){return(t.getAttributes()||{}).formGuid===i}),l=e.ops.findIndex(function(t){return(t.getAttributes()||{}).formGuid===i});if(!f)throw new Error("找不到关联的表");var p=function(){var t={};c.forEach(function(e){return t[e.guid]=e});for(var e=f.data.cols.length,r=o(new Array(e)),n=0,i=0;i<f.data.cols.ops.length;i++){var a=f.data.cols.ops[i],u=(a.getAttributes()||{}).formItemGuid;u&&t[u]&&(r[n]=t[u]),n+=a.data}return r}();if(!p.some(Boolean))throw new Error("找不到关联的表单列");var d=function(){var t=p.map(function(t,e){return t&&t.isRequired?e:null}).filter(function(t){return null!=t});0===t.length&&(t=[0]);for(var e=f.data.rows.length,r=function(e){return t.every(function(t){var r=u.getCellName(e,t);if(f.data.cells.get(r)){var n=f.data.cells.get(r).data.ops[0];return n&&"insert"===n.action}return!1})},n=f.data.cells.keys().map(function(t){return{row:u.parseCellName(t).row,column:u.parseCellName(t).column,cell:f.data.cells.get(t)}}).filter(function(t){var e=t.cell.getAttributes()||{},r=e.rowspan,n=e.colspan;return r||n}),o=function(t){return n.some(function(e){var r=e.row,n=(e.cell.getAttributes()||{}).rowspan;return r<t&&t<=r+n-1})},i=function(t){return 0===t},a=0;a<e&&(i(a)||r(a)||o(a));)a++;return a}(),h=function(){var t=s,e=p.map(function(t,e){return{row:d,col:e,item:t}}).reduce(function(e,r){var o=r.row,i=r.col,a=r.item;return e[u.getCellName(o,i)]=t.retain("Cell",{vertical:"middle",wrap:"text-no-wrap",format:"@","font-size":9,userID:n},a?t([t.insert("Text",{userID:n},a.value)]):1),e},{});return t([0!==l&&t.retain("Table",l),t.retain("Table",{id:(f.getAttributes()||{}).id},{cells:e,rows:t([0!==d&&t.retain("",d),t.insert("",{height:22},1)].filter(Boolean))})].filter(Boolean))}();return a.pack(h)}},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var s=u(r(175)),c=r(417),f=r(527),l=r(951),p=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data;return"number"==typeof n?{action:e,data:n,attributes:r}:{action:e,data:1,attributes:r}},d=function(t){var e=t.action,r=(t.element,t.attrs);return{action:e,data:t.data,attributes:r}},h=function(t){var r=t.action,n=(t.element,t.attrs),o=t.data;return"number"==typeof o?{action:r,attributes:n,data:o}:{action:r,attributes:n,data:{table:{rows:o.rows&&o.rows.map(d),cols:function(t,r,n){t||(t=[]),r||(r=[]),n||(n={});var o={};Object.keys(n).forEach(function(t){var e=c.fromCellName(t),r=e.row,i=e.column;o[i]||(o[i]={}),o[i][r]=n[t]});var i=[];Object.keys(o).map(function(t){return+t}).sort(function(t,e){return t-e}).forEach(function(t){var r=-1,n=[];Object.keys(o[t]).map(function(t){return+t}).sort(function(t,e){return t-e}).forEach(function(i){var a=o[t][i],u=i-r-1;r=i,u?n.push(e.changeset.retain(f.Element.Cell,{},u),a):n.push(a)}),i.push({column:t,operator:y(n).map(p)})});for(var u=0,s=function(t,e){return i.filter(function(r){return r.column>=t&&r.column<=e})},l=function(t){return"number"==typeof t.data?t.data:1},d=function(t,e,r){var n=[],o=e,i=t?t.action:f.Action.Retain,a=t&&t.attrs||{},u=t?t.data:1/0;if(r.forEach(function(t){var e=t.column,r=t.operator,u=e-o;u>0&&n.push({action:i,data:u,attributes:a}),n.push({action:i,data:{delta:r},attributes:a}),o=e+1}),Number.isFinite(u)){var s=u-(o-e);s>0&&n.push({action:i,data:s,attributes:a})}return n},h=-1,v=-1,m=[];;){var b=t[u++],g=s(h=v+1,v=h+(b?l(b):1/0)-1);if(!b&&0===g.length)break;var w=d(b,h,g);m.push.apply(m,a(w))}return m}(o.columns,o.rows,o.cells)}}}},v=function(t){var r=t.data,n=t.action,o=t.attributes||{};return e.changeset[n](f.Element.Row,o,r)},m=function(t){var r=t.data,n=t.action,o=t.attributes||{};return e.changeset[n](f.Element.Column,o,"number"==typeof r?r:1)},y=function(t){for(var e=function(t,e){var r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&[].concat(r,n).every(function(r){return t[r]===e[r]})},r=[],n=0,o=void 0;n<t.length;){var i=t[n],a=t[n],u=a.action,s=a.data,c=a.attrs,f=(a.element,o&&u===o.action&&"number"==typeof s&&e(o.attrs,c)),l="number"==typeof s;o&&f?o.data+=s:(o&&(r.push(o),o=void 0),l?o=Object.assign({},i):r.push(i)),n++}return o&&(r.push(o),o=void 0),r},b=function(t){var r,o,a=t.toJSON(),u=a.action,s=a.attributes,l=void 0===s?{}:s,p=a.data;if("number"==typeof p)return(r={},r[f.Action.Insert]=e.changeset.insert,r[f.Action.Retain]=e.changeset.retain,r[f.Action.Remove]=e.changeset.remove,r)[u](f.Element.Table,l,p);var d=p.table.rows&&p.table.rows.map(v),h=p.table.cols&&p.table.cols.map(m),b={},g=0;(p.table.cols||[]).forEach(function(t){var r=t.action,o=t.data;if("insert"===r||"retain"===r)if("number"==typeof o)g+=o;else{var a=0;o.delta.forEach(function(r){var o=r.action,u=r.data,s=r.attributes;if("insert"===o||"retain"===o){s&&null!=s.cellValue||"number"!=typeof u?(r.action=t.action,b[c.toCellName(a,g)]=function(t){var r,o=t.data,a=t.action,u=t.attributes||{};if("number"!=typeof o&&Array.isArray(o&&o.delta)){var s=i(o.delta,2),c=s[0],l=s[1];l?r=l.data:c.action===f.Action.Remove?r=null:"string"==typeof c.data&&(r=c.data)}else"cellValue"in u&&(r=u.cellValue);return"number"==typeof o?e.changeset[a](f.Element.Cell,u,o):e.changeset[a](f.Element.Cell,n({},u,{cellValue:r}),1)}(r),a+=1):a+=u}else{if("remove"!==o)throw new Error("unknown action: "+o);a+=u}}),g+=1}else{if("remove"!==r)throw new Error("unknown action: "+r);g+=o}});var w=h&&y(h);return(o={},o[f.Action.Insert]=e.changeset.insert,o[f.Action.Retain]=e.changeset.retain,o[f.Action.Remove]=e.changeset.remove,o)[u](f.Element.Table,l,{rows:d,columns:w,cells:b})};function g(){var t,e;return o(this,function(r){switch(r.label){case 0:t=this.content.getIter(),r.label=1;case 1:return t.hasNext()?(e=t.next(),[4,b(e)]):[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}e.changeset={from:function(t){var e;return(e={type:f.ChangesetType.Modoc,content:t})[Symbol.iterator]=g,e},create:function(t){return e.changeset.from(new s.Delta(t.map(h)))},insert:function(t,e,r){return{action:f.Action.Insert,element:t,attrs:l.prune(e),data:r}},retain:function(t,e,r){return{action:f.Action.Retain,element:t,attrs:l.prune(e),data:r}},remove:function(t,e,r){return{action:f.Action.Remove,element:t,attrs:l.prune(e),data:r}},compose:function(t){return e.changeset.from(t.map(function(t){return t.content}).reduce(function(t,e){return t.compose(e)},new s.Delta([])))},transform:function(t,r){return e.changeset.from(t.content.transform(r.content))},invert:function(t,r){return e.changeset.from(t.content.invert(r.content))},serialize:function(t){return t.content.stringify()},deserialize:function(t){var r=new s.Delta(t);return e.changeset.from(r)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(416),o=r(603),i=r(525),a=r(526),u=r(943),s=r(606),c=function(){function t(t,e){if(this[i.TYPE_PROPERTY]="Delta",Array.isArray(t)){var r=new n.default;o.default.isPool(e)&&0!==t.length||(e=new o.default);for(var u=0,s=t;u<s.length;u++){var c=s[u],f="remove"===c.action?"":e.packAttributes(c.attributes);r.push(new a.default({action:c.action,data:c.data,pool:e,packedAttributes:f}))}this.ops=r.stringify(!0),this.pool=e}else if(void 0===e){var l=t.indexOf(":");if(l<=0)throw new Error("Invalid delta: "+t);var p=parseInt(t.substring(0,l),36),d=l+1+p;this.ops=t.substring(l+1,d),this.pool=0===p||t.length===d?new o.default:new o.default(t.substring(l+p+1))}else this.ops=t,this.pool=""===t?new o.default:e}return t.prototype.isEmpty=function(){return 0===this.ops.length},t.prototype.getIter=function(t){var e=void 0===t?{}:t,r=e.targetPool,n=e.sourcePool;return new u.default(this.ops,n||this.pool,r||this.pool,a.default)},Object.defineProperty(t.prototype,"length",{get:function(){for(var t=this.getIter(),e=0;t.hasNext();)e+=t.peekLength(),t.skip();return e},enumerable:!0,configurable:!0}),t.prototype.getPoolCopy=function(){return this.pool.clone()},t.prototype.map=function(e){for(var r=[],n=this.getIter();n.hasNext();)r.push(e(n.next()));return new t(r)},t.prototype.compose=function(e,r){var o=this.getPoolCopy(),i=new n.default([]),a=this.getIter({sourcePool:o,targetPool:o});Array.isArray(e)&&(e=new t(e,o));for(var u=e.getIter({targetPool:o});;){var s=a.hasNext(),c=u.hasNext();if(!s&&!c)break;if(!c)return new t(a.remainingStrs(i),o);if(!s&&u.isPoolCompatible())return new t(u.remainingStrs(i),o);if("insert"===u.peekAction())i.push(u.next());else if("remove"===a.peekAction())i.push(a.next());else{var f=Math.min(a.peekLength(),u.peekLength()),l=s?a.next(f):null,p=u.next(f);"retain"===p.action?i.push(l?l.compose(p,void 0===r?"insert"===l.action:r):p):l&&"retain"!==l.action||i.push(p)}}return new t(i.stringify(!0),o)},t.prototype.transform=function(e,r){void 0===r&&(r=!1),Array.isArray(e)&&(e=new t(e));for(var o=e.getPoolCopy(),i=new n.default,u=this.getIter(),s=e.getIter({sourcePool:o,targetPool:o});s.hasNext();){if(!u.hasNext())return new t(s.remainingStrs(i),o);if("insert"!==u.peekAction()||!r&&"insert"===s.peekAction())if("insert"===s.peekAction())i.push(s.next());else{var c=Math.min(u.peekLength(),s.peekLength()),f=u.next(c),l=s.next(c);if("remove"===f.action)continue;"remove"===l.action?i.push(l):i.push(f.transform(l,r))}else i.push(new a.default({action:"retain",data:u.peekLength()})),u.skip()}return new t(i.stringify(!0),o)},t.prototype.invert=function(e,r){for(var i=new o.default,u=new n.default,s=this.getIter({targetPool:i}),c=(Array.isArray(e)?new t(e,new o.default):e).getIter({targetPool:i});c.hasNext();)if("insert"===c.peekAction())u.push(new a.default({action:"remove",data:c.peekLength()})),c.skip();else{if(!s.hasNext())throw new Error("Delta should be smaller than document");if("insert"!==s.peekAction())throw new Error("Only document can invert deltas");var f=Math.min(s.peekLength(),c.peekLength()),l=c.next(f),p=s.next(f);"remove"===l.action?u.push(p):u.push(r?r(p,l):p.invert(l))}return new t(u.stringify(!0),i)},t.prototype.stringify=function(){return this.isEmpty()?"0:":this.ops.length.toString(36)+":"+this.ops+this.pool.stringify()},t.prototype.toJSON=function(){for(var t=[],e=this.getIter();e.hasNext();)t.push(e.next().toJSON());return t},t.prototype.explain=function(t){void 0===t&&(t="");for(var e=t+"Delta #"+this.ops.length+":\n",r=this.getIter();r.hasNext();)e+=r.next().explain(t+"  ");return""+e+t+"Pool: "+this.pool.stringify()+"\n"},t.prototype.validateTable=function(){for(var t={},e=this.getIter();e.hasNext();){var r=e.next();if("table"===r.dataType){var n=r.getAttributes().name;if("string"!=typeof n)continue;var o="$$"+n+"$$";if(t.hasOwnProperty(o))throw new Error("Duplicated table name found: "+n);t[o]=!0}}return this},t.isDelta=s.isDelta,t}();e.default=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.keyToGul={color:"0",background:"1","font-size":"2",width:"3",height:"4",rowspan:"5",colspan:"6",align:"7",bold:"8",italic:"9",underline:"a",vertical:"b",strike:"c",wrap:"d",fixedRowsTop:"e",fixedColumnsLeft:"f",link:"g",format:"h",formula:"i",filter:"j","border-top":"k","border-right":"l","border-bottom":"m","border-left":"n",line:"o",guid:"p",author:"q",size:"r",list:"s",layout:"t",margin:"u",font:"v",header:"w",indent:"x",comment:"y","comment-block":"z","code-block":"A",name:"B",order:"C",autoFit:"D",userID:"E",nextIndex:"F",id:"G",colVisible:"H",rowVisible:"I",autoFormatter:"J",copyIndex:"K",manualAlign:"L",lock:"M",left:"N",top:"O"};var n=["color","background","font-size","width","height","rowspan","colspan","align","bold","italic","underline","vertical","strike","wrap","fixedRowsTop","fixedColumnsLeft","link","format","formula","filter","border-top","border-right","border-bottom","border-left","line","guid","author","size","list","layout","margin","font","header","indent","comment","comment-block","code-block","name","order","autoFit","userID","nextIndex","id","colVisible","rowVisible","autoFormatter","copyIndex","manualAlign","lock","left","top"];function o(t){var e,r=t.charCodeAt(0);if(r>=48&&r<=57)e=n[r-48];else if(r>=65&&r<=90)e=n[r-29];else{if(!(r>=97&&r<=122))throw new Error('Unknown gul "'+t+'"');e=n[r-87]}return e}function i(t){var r=e.keyToGul[t];if(r)return r;var n=t.length.toString(36),o=n.length;if(o>2)throw new Error("Key length of attribute should <= 2: "+n);return""+(1===o?"$":"%")+n+t}e.getAttributeKeyByGul=o,e.getGulByAttributeKey=i,e.combinedAttributeWithValue=function(t,e){var r=i(t);return"string"==typeof e?r+":"+e:"number"==typeof e?r+"*"+e.toString():"boolean"==typeof e?r+(e?"1":"0"):r},e.keyValueToGul={81:"!","2*12":'"',"2*11":"#","2*10":"$","2*9":"%","2*8":"&","6*2":"'","6*3":"(","6*4":")","5*2":"*","5*3":"+","5*4":",","0:#ff0000":"-","0:#ffffff":".","b:bottom":"/","h:normal":"0",1:"1","1:#ffffff":"2","1:#ff0000":"3","1:#ffff00":"4","1:#00ffff":"5","7:left":"6","7:center":"7","7:right":"8","1*4":"9","d:text-wrap":":","d:text-no-wrap":";","h:YYYY/MM/DD":"<",'l:["",1]':"=",'n:["",1]':">",'k:["",1]':"?",'m:["",1]':"@",'l:["#2b2b2b",1]':"A",'n:["#2b2b2b",1]':"B",'k:["#2b2b2b",1]':"C",'m:["#2b2b2b",1]':"D"};var a=[["bold",!0],["font-size",12],["font-size",11],["font-size",10],["font-size",9],["font-size",8],["colspan",2],["colspan",3],["colspan",4],["rowspan",2],["rowspan",3],["rowspan",4],["color","#ff0000"],["color","#ffffff"],["vertical","bottom"],["format","normal"],["background",null],["background","#ffffff"],["background","#ff0000"],["background","#ffff00"],["background","#00ffff"],["align","left"],["align","center"],["align","right"],["background",4],["wrap","text-wrap"],["wrap","text-no-wrap"],["format","YYYY/MM/DD"],["border-right",'["",1]'],["border-left",'["",1]'],["border-top",'["",1]'],["border-bottom",'["",1]'],["border-right",'["#2b2b2b",1]'],["border-left",'["#2b2b2b",1]'],["border-top",'["#2b2b2b",1]'],["border-bottom",'["#2b2b2b",1]']];e.getGulByCombinedKeyValue=function(t){return e.keyValueToGul.hasOwnProperty(t)?e.keyValueToGul[t]:null},e.getKeyValueByGul=function(t){var e=t.charCodeAt(0)-33;return a[e]},e.parseCombinedAttributeValue=function(t){var e;if("$"===t[0]){var r=parseInt(t[1],36);e=t.substring(2,2+r),t=t.substring(1+r)}else"%"===t[0]?(r=parseInt(t[1]+t[2],36),e=t.substring(3,3+r),t=t.substring(2+r)):e=o(t[0]);if(1===t.length)return[e,null];var n=t[1];if("1"===n)return[e,!0];if("0"===n)return[e,!1];var i=t.substring(2);return[e,":"===n?i:Number(i)]}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.objectToKeyPaths=function t(e,r,n){void 0===n&&(n=[]);for(var o=0,i=Object.keys(e);o<i.length;o++){var a=i[o],u=e[a],s=r+"."+a;"object"==typeof u&&null!==u?t(u,s,n):n.push([s,u])}return n},e.keyPathToObject=function(t,e,r){for(var n=e.split("."),o=n.length,i=1;i<o-1;i++){var a=n[i],u=t[a];t="object"==typeof u&&null!==u?u:t[a]={}}t[n[o-1]]=r}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(604),o=r(416),i=function(){function t(t,e,r,n){this.ops=t,this.pool=e,this.targetPool=r,this.operatorConstructor=n,this.cursor=0,this.offset=0}return t.prototype.isPoolCompatible=function(){return void 0===this.isCompatible&&(this.isCompatible=this.pool.isSubsetOf(this.targetPool)),this.isCompatible},t.prototype.hasNext=function(){return this.cursor<this.ops.length},t.prototype.remainingStrs=function(t){for(;this.hasNext();){var e=this.next();if(t.push(e)!==o.PushResult.REORDERED){var r=this.cursor;return this.cursor=this.ops.length,this.nextData=void 0,t.stringify()+this.ops.substring(r)}}return t.stringify(!0)},t.prototype.skip=function(t){void 0===t&&(t=1/0);var e=this.peekNext();if(null===e)throw new Error("No more operators");var r,n=this.offset;return t+n>=e.dataLength?(r=e.dataLength-n,this.nextData=void 0,this.cursor=e.opIndex+e.opLength,this.offset=0):(r=t,this.offset+=r),[r,n,e]},t.prototype.next=function(t,e){void 0===t&&(t=1/0);var r,o=this.skip(t),i=o[0],a=o[1],u=o[2];switch(u.dataType){case"number":r=i;break;case"string":r=this.ops.substring(u.dataIndex+1+a,u.dataIndex+1+a+i);break;default:var s=this.ops[u.dataIndex+1+a],c=this.ops.substring(u.dataIndex+1+1,u.dataIndex+1+u.actualLength);(l={})[n.initialToObjectKey[s]]=c,r=l}var f,l,p=this.ops.substring(u.dataIndex+1+u.actualLength,u.opIndex+u.opLength),d=this.targetPool,h=""!==p&&!this.isPoolCompatible();return 0!==a||i!==u.dataLength||h||(f=this.ops.substring(u.opIndex,u.dataIndex+1+u.actualLength)),h&&(p=d.packAttributes(this.pool.unpackAttributes(p))),new this.operatorConstructor({action:e||u.action,data:r,packedAttributes:p,pool:d},f)},t.prototype.peekAction=function(){var t=this.peekNext();return null===t?"retain":t.action},t.prototype.peekLength=function(){var t=this.peekNext();return null===t?1/0:t.dataLength-this.offset},t.prototype.peekNext=function(){if(!this.hasNext())return null;if(void 0===this.nextData){var t=void 0,e=void 0;e=this.cursor+1;for(var r=this.ops.length;e<r;){switch(this.ops[e]){case"!":t="insert";break;case"@":t="retain";break;case"#":t="remove"}if(void 0!==t)break;e+=1}var n=e,o=parseInt(this.ops.substring(this.cursor,n),36);e=n+1;for(var i=void 0;e<r;){switch(this.ops[e]){case"!":i="string";break;case"#":i="number";break;case"@":i="object"}if(void 0!==i)break;e+=1}var a=e,u=parseInt(this.ops.substring(n+1,a),36),s="number"===i?0:u,c="object"===i?1:u;this.nextData={action:t,dataIndex:a,dataLength:c,opIndex:n,opLength:o,dataType:i,actualLength:s}}return this.nextData},t}();e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(945),o=r(947),i=r(948),a=r(949),u=r(950),s=r(608);e.registerDataHandlers=function(t,e,r){var c=function(t,e){return function(r){return new r(t,e)}}(e,r);t.registerDataHandler("delta",c(o.default)),t.registerDataHandler("table",c(n.default)),t.registerDataHandler("presentation",c(a.default)),t.registerDataHandler("slide",c(i.default)),t.registerDataHandler("mindmap",c(i.default)),t.registerDataHandler("object",c(u.default)),t.registerDataHandler("form",c(s.default))}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(607),i=r(946),a=r(390),u=r(175),s=r(416),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.pack=function(t){var e=t.rows,r=t.cols,n=o.possibleDeltaInputToString(this.deltaConstructor,e),i=o.possibleDeltaInputToString(this.deltaConstructor,r);return n.length.toString(36)+"$"+n+i},e.prototype.toJSON=function(t){var e=this.parse(t),r=e[0],n=e[1];return{rows:null===r?null:r.toJSON(),cols:null===n?null:n.toJSON()}},e.prototype.explain=function(t,e){var r=t+"Rows:\n",n=this.parse(e),o=n[0],i=n[1];return r+=null===o?"[EMPTY]":o.explain(t),r+=t+"Cols:\n",r+=null===i?"[EMPTY]":i.explain(t)},e.prototype.parse=function(t){var e=t.indexOf("$"),r=parseInt(t.substring(0,e),36),n=e+1+r;return[0===r?null:new this.deltaConstructor(t.substring(e+1,n)),t.length===n?null:new this.deltaConstructor(t.substring(n))]},e.prototype.compose=function(t,e,r){var n=this.parse(t),o=n[0],a=n[1],u=this.parse(e),s=u[0],c=u[1],f=null===s?o:null===o?s:o.compose(s,r),l=i.reindexInnerDeltas(a,s),p=null===c?l:null===l?c:l.compose(c,r);return this.pack({rows:f,cols:p})},e.prototype.transform=function(t,e,r){var n=this.parse(t),o=n[0],a=n[1],u=this.parse(e),s=u[0],c=u[1],f=null===o||null===s?s:o.transform(s,r),l=null===o||null===s?o:s.transform(o,!r),p=i.reindexInnerDeltas(a,f),d=i.reindexInnerDeltas(c,l),h=null===p||null===d?d:p.transform(d,r);return this.pack({rows:f,cols:h})},e.prototype.invert=function(t,e){var r=this,n=this.parse(t),o=n[0],a=n[1],c=this.parse(e),f=c[0],l=c[1],p=f&&(null===o?new this.deltaConstructor([]):o).invert(f),d=i.invertInnerDeltas(a,f);if(null!==l){if(null===a)throw new Error("Invert a table without cols");if(d){var h=i.DeltaToIndexModifiers(l);d=i.reindexDelta(d,h)}var v=i.reindexInnerDeltas(l,p);if(null===v)throw new Error("ASSERT: targetCols === null");var m=a.invert(v,function(t,e){if("delta"!==e.dataType)return t.invert(e);for(var n=new u.Pool,o=new s.default([]),i="number"===t.dataType?null:new r.deltaConstructor(t.getCustomData()).getIter({targetPool:n}),a=new r.deltaConstructor(e.getCustomData()).getIter({targetPool:n});a.hasNext();){var c=void 0,f=void 0;if(null!==i&&i.hasNext()){var l=Math.min(i.peekLength(),a.peekLength());c=i.next(l,"insert"),f=a.next(l)}else{var p=a.peekLength();c=new r.operatorConstructor({action:"insert",data:p}),f=a.next()}o.push(c.invert(f))}return t.invert(e,{delta:new r.deltaConstructor(o.stringify(!0),n).stringify()})});d=d?d.compose(m):m}return this.pack({rows:p,cols:d})},e}(a.default);e.default=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(416),o=r(602),i=r(526);function a(t){for(var e=[],r=-1,n=t.getIter();n.hasNext();){var o=n.next(),i=o.action,a=o.length;-1!==r&&e[r][0]===i?e[r][1]+=a:e[++r]=[i,a]}return e}function u(t,e){for(var r=t.getPoolCopy(),a=new n.default([]),u=t.getIter({sourcePool:r,targetPool:r}),s=new Array(e.length),c=0;c<e.length&&u.hasNext();c++){var f=s[c]||e[c],l=f[0],p=f[1];switch(l){case"insert":a.push(new i.default({action:"retain",data:p,packedAttributes:"",pool:r}));break;case"retain":(d=u.peekLength())>=p?a.push(u.next(p)):(a.push(u.next()),s[c]=["retain",p-d],c-=1);break;case"remove":var d;(d=u.peekLength())>=p?u.skip(p):(u.skip(),s[c]=["remove",p-d],c-=1)}}for(;u.hasNext();)a.push(u.next());return new o.Delta(a.stringify(!0),r)}e.DeltaToIndexModifiers=a,e.reindexDelta=u,e.reindexInnerDeltas=function(t,e){if(null===t||null===e)return t;var r=a(e);return 0===r.length?t:t.map(function(t){var e={action:t.action,data:t.data};if("remove"!==e.action&&t.hasAttributes()&&(e.attributes=t.getAttributes()),"delta"===t.dataType){var n=u(new o.Delta(t.getCustomData()),r);e.data=n.isEmpty()?1:{delta:n.stringify()}}else e.data=t.data;return e})},e.invertInnerDeltas=function(t,e){if(null===t||null===e)return null;for(var r=a(e),u=!1,s=0,c=r;s<c.length;s++)if("remove"===c[s][0]){u=!0;break}return u?t.map(function(t){var e={action:"retain",data:t.data};if(t.hasAttributes()&&(e.attributes=t.getAttributes()),"delta"===t.dataType){var a=function(t,e){for(var r=t.getPoolCopy(),a=new n.default([]),u=t.getIter({sourcePool:r,targetPool:r}),s=new Array(e.length),c=0;c<e.length&&u.hasNext();c++){var f=s[c]||e[c],l=f[0],p=f[1];switch(l){case"retain":var d=u.peekLength(),h=Math.min(p,d);a.push(new i.default({action:"retain",data:h,packedAttributes:"",pool:r})),u.skip(h),d<p&&(s[c]=["retain",p-d],c-=1);break;case"remove":(d=u.peekLength())>=p?a.push(u.next(p)):(a.push(u.next()),s[c]=["remove",p-d],c-=1)}}for(var v=0;u.hasNext();)v+=u.peekLength(),u.skip();return v>0&&a.push(new i.default({action:"retain",data:v,packedAttributes:"",pool:r})),new o.Delta(a.stringify(!0),r)}(new o.Delta(t.getCustomData()),r);e.data=a.isEmpty()?1:{delta:a.stringify()}}else e.data=t.data;return e}):null}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(390),i=r(606),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){return this.parse(t).compose(this.parse(e),r).stringify()},e.prototype.transform=function(t,e,r){return this.parse(t).transform(this.parse(e),r).stringify()},e.prototype.invert=function(t,e){return this.parse(t).invert(this.parse(e)).stringify()},e.prototype.parse=function(t){return new this.deltaConstructor(t)},e.prototype.pack=function(t){if(Array.isArray(t))return new this.deltaConstructor(t).stringify();if(i.isDelta(t))return t.stringify();throw new Error("Unsupported delta value for packing "+t)},e.prototype.toJSON=function(t){return this.parse(t).toJSON()},e.prototype.explain=function(t,e){return this.parse(e).explain(t)},e}(o.default);e.default=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){for(var n=this.parse(t),o=this.parse(e),i=0,a=Object.keys(o);i<a.length;i++){var u=a[i],s=n[u],c=o[u];n[u]=void 0===s?c:s.compose(c,r)}return this.pack(n)},e.prototype.transform=function(t,e,r){for(var n=this.parse(t),o=this.parse(e),i=0,a=Object.keys(o);i<a.length;i++){var u=a[i],s=n[u];if(void 0!==s){var c=o[u];o[u]=s.transform(c,r)}}return this.pack(o)},e.prototype.invert=function(t,e){for(var r=this.parse(t),n=this.parse(e),o=0,i=Object.keys(n);o<i.length;o++){var a=i[o],u=r[a]||new this.deltaConstructor([]);n[a]=u.invert(n[a])}return this.pack(n)},e.prototype.parse=function(t){for(var e={},r=0;r<t.length;){var n=t.substring(r,r+8),o=t.indexOf("#",r+8),i=parseInt(t.substring(r+8,o),36),a=new this.deltaConstructor(t.substring(o+1,o+1+i));e[n]=a,r=o+1+i}return e},e.prototype.pack=function(t){for(var e="",r=0,n=Object.keys(t).sort();r<n.length;r++){var o=n[r];if(8!==o.length)throw new Error("element id length must equal to 8, got "+o);var i=t[o],a=Array.isArray(i)?new this.deltaConstructor(i):i;if(a.getIter().hasNext()){var u=a.stringify();e+=""+o+u.length.toString(36)+"#"+u}}return e},e.prototype.toJSON=function(t){for(var e={},r=this.parse(t),n=0,o=Object.keys(r);n<o.length;n++){var i=o[n],a=r[i];e[i]=a.toJSON()}return e},e.prototype.explain=function(t,e){for(var r=t+"Elements:\n",n=this.parse(e),o=0,i=Object.keys(n);o<i.length;o++){r+=n[i[o]].explain(t)}return r},e}(r(390).default);e.default=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.pack=function(e){return t.prototype.pack.call(this,Array.isArray(e)?e:[e.slides,e.layouts,e.notes])},e.prototype.toJSON=function(e){var r=t.prototype.toJSON.call(this,e);return{slides:r[0],layouts:r[1],notes:r[2]}},e.prototype.explain=function(t,e){var r=t+"Slides:\n",n=this.parse(e),o=n[0],i=n[1],a=n[2];return r+=o?o.explain(t):"[EMPTY]",r+=t+"Layouts:\n",r+=i?i.explain(t):"[EMPTY]",r+=t+"Notes:\n",r+=a?a.explain(t):"[EMPTY]"},e}(r(608).default);e.default=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(390),i=r(605),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){return this.pack(i.merge(this.parse(t),this.parse(e),!r),r)},e.prototype.transform=function(t,e,r){return this.pack(i.transform(this.parse(t),this.parse(e),r),!1)},e.prototype.invert=function(t,e){return this.pack(i.invert(this.parse(t),this.parse(e)),!1)},e.prototype.parse=function(t){return JSON.parse(t)},e.prototype.pack=function(t,e){return e?JSON.stringify(t,function(t,e){return null===e?void 0:e}):JSON.stringify(t)},e.prototype.toJSON=function(t){return this.parse(t)},e.prototype.explain=function(t,e){return JSON.stringify(this.parse(e),null,t)},e}(o.default);e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.prune=function(t){if(!t)return t;var e={};for(var r in t)t.hasOwnProperty(r)&&void 0!==t[r]&&(e[r]=t[r]);return e}},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u=a(r(156)),s=r(953),c=r(527),f=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data;return"number"==typeof n?new u.CellOperator({action:e,data:n,attributes:r}):new u.CellOperator({action:e,data:1,attributes:r})},l=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data;return new u.Operator({action:e,data:n,attributes:r})},p=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data;return new u.Operator({action:e,data:n,attributes:r})};e.toRichdocTable=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data,o="object"!=typeof n?n:{cells:"object"!=typeof n.cells?n.cells:s.mapObject(n.cells,f),rows:Array.isArray(n.rows)?new u.Delta(n.rows.map(p)):n.rows,cols:Array.isArray(n.columns)?new u.Delta(n.columns.map(l)):n.columns};return new u.TableOperator({action:e,data:o,attributes:r})};var d=function(t){var r=t.data,n=t.action,o=t.getAttributes()||{};return e.changeset[n](c.Element.Row,o,r)},h=function(t){var r=t.data,n=t.action,o=t.getAttributes()||{};return e.changeset[n](c.Element.Column,o,r)},v=function(t){var r,o=t.data,a=t.action,u=t.getAttributes()||{},s="object"!=typeof o?o:{rows:o.rows&&o.rows.ops.map(d),columns:o.cols&&o.cols.ops.map(h),cells:o.cells&&function(t){var r={};return t.forEach(function(o){r[o]=function(t){var r,o=t.data,a=t.action,u=t.getAttributes()||{};if("number"!=typeof o&&Array.isArray(o&&o.ops)&&o.ops.length){var s=i(o.ops,2),f=s[0],l=s[1];l?r=l.data:f.action===c.Action.Remove?r=null:"string"==typeof f.data&&(r=f.data)}else"cellValue"in u&&(r=u.cellValue);return"number"==typeof o?e.changeset[a](c.Element.Cell,u,o):e.changeset[a](c.Element.Cell,n({},u,{cellValue:r}),1)}(t.get(o))}),r}(o.cells)};return(r={},r[c.Action.Insert]=e.changeset.insert,r[c.Action.Retain]=e.changeset.retain,r[c.Action.Remove]=e.changeset.remove,r)[a](c.Element.Table,u,s)};function m(){var t,e;return o(this,function(r){switch(r.label){case 0:t=this.content.getIter(),r.label=1;case 1:return t.hasNext()?(e=t.next(),[4,v(e)]):[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}e.changeset={from:function(t){var e;return(e={type:c.ChangesetType.Richdoc,content:t})[Symbol.iterator]=m,e},create:function(t){return e.changeset.from(new u.Delta(t.map(e.toRichdocTable)))},insert:function(t,e,r){return{action:c.Action.Insert,element:t,attrs:e,data:r}},retain:function(t,e,r){return{action:c.Action.Retain,element:t,attrs:e,data:r}},remove:function(t,e,r){return{action:c.Action.Remove,element:t,attrs:e,data:r}},compose:function(t){return e.changeset.from(t.map(function(t){return t.content}).reduce(function(t,e){return t.compose(e)},new u.Delta([])))},transform:function(t,r){return e.changeset.from(t.content.transform(r.content))},invert:function(t,r){return e.changeset.from(t.content.invert(r.content))},serialize:function(t){return u.pack(t.content)},deserialize:function(t){return e.changeset.from(u.unpack(t))}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapObject=function(t,e){var r={};for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];r[n]=e(o)}return r}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(418)),e.ColumnType={CREATE_AT:"CREATE_AT"}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this;Object.defineProperty(e,"__esModule",{value:!0});var u=r(609),s=r(956),c=r(610),f=r(611),l=r(613),p=r(957),d=function(){},h={info:d,error:d};e.createFormService=function(t){var e=t.formApiUrl,r=t.isMocking,d=void 0!==r&&r,v=t.logger,m=void 0===v?h:v,y=t.isTesting,b=void 0!==y&&y;null==e&&(e=window.location.origin+"/form");var g=void 0,w=void 0,_=c.createLogger({channel:"form",logger:m}),O=p.createFormApi({formApiUrl:e,logger:m,isTesting:b}),x=function(t){return o(a,void 0,void 0,function(){var e,r;return i(this,function(n){switch(n.label){case 0:return d?[2,w&&w.guid===t?w:void 0]:[3,1];case 1:return n.trys.push([1,3,,4]),[4,O.fetchForm(t)];case 2:return e=n.sent(),[2,f.fromServerForm(e.form,e.formItems)];case 3:if((r=n.sent())&&404==r.code&&/不存在/.test(r.errmsg))return[2,void 0];throw r;case 4:return[2]}})})},j=function(t){return o(a,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:if(!d)return[3,1];if(!w)throw new Error("mock form does not exist, cannot update");return Object.assign(w,t),[3,3];case 1:return[4,O.updateForm(n({},f.toServerForm(t),{formGuid:t.guid,formItems:t.items&&l.stringify(t.items.map(f.toServerFormItem))}))];case 2:e.sent(),e.label=3;case 3:return[2]}})})},k=function(t){return o(a,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return d?(w=t,[3,3]):[3,1];case 1:return[4,O.createForm(n({},f.toServerForm(t),{formItems:l.stringify(t.items.map(f.toServerFormItem))}))];case 2:e.sent(),e.label=3;case 3:return[2]}})})},C=function(t){return o(a,void 0,void 0,function(){var e;return i(this,function(r){switch(r.label){case 0:return d?(w=void 0,[3,4]):[3,1];case 1:return[4,O.fetchFormDrafts(t)];case 2:return(e=r.sent())&&e.forms&&e.forms.length?[4,Promise.all(e.forms.map(function(t){return O.deleteForm(t.guid)}))]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}})})};return{MAX_ITEM_COUNT:100,MAX_DESC_LENGTH:200,createForm:function(){var t=new Date(new Date((new Date).getTime()+6048e5).setHours(12,0,0,0));return{guid:s.genId(16),spreadGuid:"",sheetGuid:"",title:"",desc:"",items:[],deadline:!1,deadlineDate:t}},createFormOption:function(t,e){return void 0===t&&(t=""),void 0===e&&(e="normal"),{type:e,value:s.genId(5),label:t}},createFormItemText:function(){return{guid:s.genId(5),type:u.FormItemType.Text,subject:"",required:!0}},createFormItemSingleChoice:function(){return{guid:s.genId(5),type:u.FormItemType.SingleChoice,subject:"",required:!0,options:[]}},createFormItemMultipleChoice:function(){return{guid:s.genId(5),type:u.FormItemType.MultipleChoice,subject:"",required:!0,options:[]}},createFormItemDropdownList:function(){return{guid:s.genId(5),type:u.FormItemType.DropdownList,subject:"",required:!0,options:[]}},copyFormItem:function(t){return n({},function(t){return JSON.parse(JSON.stringify(t))}(t),{guid:s.genId(5)})},isFormUnlinked:function(t){return null==t.sheetGuid||null==t.spreadGuid},isFormOverdue:function(t){return t.deadline&&t.deadlineDate&&t.deadlineDate.getTime()<(new Date).getTime()},fetchForm:_(x),fetchFormDraft:_(function(t){return o(a,void 0,void 0,function(){var e,r,n;return i(this,function(o){switch(o.label){case 0:return d?[2,g&&g.guid===t?g:void 0]:[3,1];case 1:return o.trys.push([1,6,,7]),[4,O.fetchFormDrafts(t)];case 2:return(e=o.sent())&&e.forms&&e.forms.length?[4,x(e.forms[0].guid)]:[3,4];case 3:return(r=o.sent())&&(r.guid=t),[2,r];case 4:return[2,void 0];case 5:return[3,7];case 6:if((n=o.sent())&&404==n.code&&/不存在/.test(n.errmsg))return[2,void 0];throw n;case 7:return[2]}})})}),submitFilledForm:_(function(t){var e=t.guid,r=t.items,n=t.userId;return o(a,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return d?[2]:[4,O.submitForm({formGuid:e,formItems:l.stringify(r.map(function(t){return f.toServerItemReponse(t,n)}))})];case 1:return t.sent(),[2]}})})}),publishForm:_(function(t){return o(a,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return d?(g&&g.guid===t.guid&&(g=void 0),w=t,[3,8]):[3,1];case 1:return[4,x(t.guid)];case 2:return e.sent()?[3,4]:[4,_(k)(t)];case 3:return e.sent(),[3,6];case 4:return[4,_(j)(t)];case 5:e.sent(),e.label=6;case 6:return[4,C(t.guid)];case 7:e.sent(),e.label=8;case 8:return[2]}})})}),updateForm:_(j),unlinkForm:_(function(t){return o(a,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:if(!d)return[3,1];if(!w)throw new Error("mock form does not exist, cannot update");return w.spreadGuid=null,w.sheetGuid=null,[3,4];case 1:return[4,O.unlinkForm(t)];case 2:return e.sent(),[4,C(t)];case 3:e.sent(),e.label=4;case 4:return[2]}})})}),saveFormDraft:_(function(t){return o(a,void 0,void 0,function(){var e,r;return i(this,function(o){switch(o.label){case 0:return d?(g=t,[2]):[3,1];case 1:return[4,O.fetchFormDrafts(t.guid)];case 2:return(e=o.sent().forms).length?(r=e[0],[4,O.updateForm(n({},f.toServerForm(t),{guid:r.guid,formItems:l.stringify(t.items.map(f.toServerFormItem)),formGuid:r.guid}))]):[3,4];case 3:return o.sent(),[3,6];case 4:return[4,O.createFormDraft(n({},f.toServerForm(t),{formItems:l.stringify(t.items.map(f.toServerFormItem)),formGuid:t.guid}))];case 5:o.sent(),o.label=6;case 6:return[2]}})})}),updateFormDeadline:_(function(t){return o(a,void 0,void 0,function(){var e;return i(this,function(r){switch(r.label){case 0:return d?(w&&w.guid===t.guid&&Object.assign(w,{deadline:t.deadline,deadlineDate:t.deadlineDate}),[3,3]):[3,1];case 1:return e={guid:t.guid,deadline:t.deadline,deadlineDate:t.deadlineDate},[4,j(e)];case 2:r.sent(),r.label=3;case 3:return[2]}})})})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";e.genId=function(t){void 0===t&&(t=5);for(var e="",r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this;Object.defineProperty(e,"__esModule",{value:!0});var a=r(610),u=r(958),s=function(){},c={info:s,error:s};e.createFormApi=function(t){var e=t.formApiUrl,r=t.logger,s=void 0===r?c:r,f=t.isTesting,l=void 0!==f&&f,p=a.createLogger({channel:"request",logger:s})(function(t){var r=t.path,a=t.method,s=t.data;return n(i,void 0,void 0,function(){var t,n,i,c,f,p,d;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t={},l&&(t["x-shimo-user"]=JSON.stringify({id:12345}),(s=s||{}).test=1),[4,u.ajax.request(e+r,{method:a.toLowerCase(),data:s,headers:t})];case 1:return[2,o.sent()];case 2:throw n=o.sent(),i=n.response,c=i.status,f=i.data,p=(f||{}).message,(d=void 0===p?"":p)?{errmsg:d,code:c}:n;case 3:return[2]}})})});return{createForm:function(t){return p({path:"/forms",method:"POST",data:t})},createFormDraft:function(t){return p({path:"/forms/"+t.formGuid+"/drafts",method:"POST",data:t})},deleteForm:function(t){return p({path:"/forms/"+t,method:"DELETE"})},updateForm:function(t){return p({path:"/forms/"+t.formGuid,method:"PUT",data:t})},fetchForm:function(t){return p({path:"/forms/"+t,method:"GET"})},fetchFormDrafts:function(t){return p({path:"/forms/"+t+"/drafts",method:"GET"})},submitForm:function(t){return p({path:"/forms/"+t.formGuid+"/submitHistories",method:"POST",data:t})},unlinkForm:function(t){return p({path:"/forms/"+t+"/unLink",method:"POST",data:{formGuid:t}})}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(216);e.ajax={request:function(t,e){var r=e.method,o=e.data,i=e.headers;return"get"===r.toLowerCase()?n.default.request({url:t,method:r,params:o,headers:i}).then(function(t){return t.data}):n.default.request({url:t,method:r,data:o,headers:i}).then(function(t){return t.data})}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(415),a=r(417),u="CREATE_AT";e.createChangeForCreateForm=function(t){for(var e=t.spread,r=t.form,n=t.type,s=t.userId,c="richdoc"===n?i.Changeset.Richdoc:i.Changeset.Modoc,f="richdoc"===n?i.Changeset.Richdoc.from(e):i.Changeset.Modoc.from(e),l=o(f),p=l[0].attrs.nextIndex||1,d=o(["填写时间"],r.items.map(function(t){return t.subject})),h=Math.max(18,d.length),v={},m=0;m<h;m++){var y=d[m];v[a.toCellName(0,m)]=c.retain(i.Element.Cell,{userId:s,authorId:s,color:"#ffffff",background:"#41464b",format:"@",cellValue:y},1)}var b=[c.insert(i.Element.Row,{height:30},1),c.insert(i.Element.Row,{},199)],g=o([c.insert(i.Element.Column,{formItemGuid:u,width:135},1)],r.items.map(function(t){return c.insert(i.Element.Column,{formItemGuid:t.guid},1)}),[1+r.items.length<18?c.insert(i.Element.Column,{},18-(r.items.length+1)):null]).filter(Boolean),w=[c.retain(i.Element.Table,{nextIndex:p+1},1),l.length>1?c.retain(i.Element.Table,{},l.length-1):null,c.insert(i.Element.Table,{id:r.sheetGuid,name:r.title,order:p,formGuid:r.guid,fixedRowsTop:1},{cells:v,rows:b,columns:g})].filter(Boolean);return c.create(w).content}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(415);e.createChangeForUnlinkForm=function(t){var e=t.spread,r=t.sheetGuid,n=t.type,a=t.userId,u="richdoc"===n?i.Changeset.Richdoc:i.Changeset.Modoc,s="richdoc"===n?i.Changeset.Richdoc.from(e):i.Changeset.Modoc.from(e),c=o(s),f=c.findIndex(function(t){return(t.attrs||{}).id===r}),l=c[f],p=(l.data&&"number"!=typeof l.data&&l.data.columns||[]).map(function(t){return u.retain(i.Element.Column,{formItemGuid:null},t.data)}).filter(Boolean),d=[f>0?u.retain(i.Element.Table,{},f):null,u.retain(i.Element.Table,{formGuid:null,userId:a,authorId:a},{columns:p})].filter(Boolean);return u.create(d).content}},function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0}),r(962);var o=n(r(1005));e.formEntry=o;var i=n(r(540));e.formService=i;var a=n(r(427));e.types=a;var u=n(r(629));e.formChangeset=u;var s=r(1018),c=r(627),f=r(626),l=r(1019),p=r(624),d={createChangeForCreateForm:s.createChangeForCreateForm,createChangeForUnlinkForm:c.createChangeForUnlinkForm,createChangeForUpdateForm:f.createChangeForUpdateForm,createChangeForCreateSpread:l.createChangeForCreateSpread,createChangeForSubmitForm:p.createChangeForSubmitForm};e.sheetChangeset=d},function(t,e,r){"use strict";try{r(963),r(975),r(978),r(980),r(982),r(998),r(1003)}catch(t){throw console.error("[polyfill]",t),t}},function(t,e,r){r(964),t.exports=r(193).Object.assign},function(t,e,r){var n=r(238);n(n.S+n.F,"Object",{assign:r(969)})},function(t,e,r){t.exports=!r(393)&&!r(528)(function(){return 7!=Object.defineProperty(r(615)("div"),"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(392);t.exports=function(t,e){if(!n(t))return t;var r,o;if(e&&"function"==typeof(r=t.toString)&&!n(o=r.call(t)))return o;if("function"==typeof(r=t.valueOf)&&!n(o=r.call(t)))return o;if(!e&&"function"==typeof(r=t.toString)&&!n(o=r.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){t.exports=r(531)("native-function-to-string",Function.toString)},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,r){"use strict";var n=r(393),o=r(618),i=r(973),a=r(974),u=r(424),s=r(533),c=Object.assign;t.exports=!c||r(528)(function(){var t={},e={},r=Symbol(),n="abcdefghijklmnopqrst";return t[r]=7,n.split("").forEach(function(t){e[t]=t}),7!=c({},t)[r]||Object.keys(c({},e)).join("")!=n})?function(t,e){for(var r=u(t),c=arguments.length,f=1,l=i.f,p=a.f;c>f;)for(var d,h=s(arguments[f++]),v=l?o(h).concat(l(h)):o(h),m=v.length,y=0;m>y;)d=v[y++],n&&!p.call(h,d)||(r[d]=h[d]);return r}:c},function(t,e,r){var n=r(421),o=r(619),i=r(971)(!1),a=r(535)("IE_PROTO");t.exports=function(t,e){var r,u=o(t),s=0,c=[];for(r in u)r!=a&&n(u,r)&&c.push(r);for(;e.length>s;)n(u,r=e[s++])&&(~i(c,r)||c.push(r));return c}},function(t,e,r){var n=r(619),o=r(394),i=r(972);t.exports=function(t){return function(e,r,a){var u,s=n(e),c=o(s.length),f=i(a,c);if(t&&r!=r){for(;c>f;)if((u=s[f++])!=u)return!0}else for(;c>f;f++)if((t||f in s)&&s[f]===r)return t||f||0;return!t&&-1}}},function(t,e,r){var n=r(534),o=Math.max,i=Math.min;t.exports=function(t,e){return(t=n(t))<0?o(t+e,0):i(t,e)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e){e.f={}.propertyIsEnumerable},function(t,e,r){r(976),t.exports=r(193).String.startsWith},function(t,e,r){"use strict";var n=r(238),o=r(394),i=r(536),a="".startsWith;n(n.P+n.F*r(537)("startsWith"),"String",{startsWith:function(t){var e=i(this,t,"startsWith"),r=o(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),n=String(t);return a?a.call(e,n,r):e.slice(r,r+n.length)===n}})},function(t,e,r){var n=r(392),o=r(422),i=r(194)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==o(t))}},function(t,e,r){r(979),t.exports=r(193).String.endsWith},function(t,e,r){"use strict";var n=r(238),o=r(394),i=r(536),a="".endsWith;n(n.P+n.F*r(537)("endsWith"),"String",{endsWith:function(t){var e=i(this,t,"endsWith"),r=arguments.length>1?arguments[1]:void 0,n=o(e.length),u=void 0===r?n:Math.min(o(r),n),s=String(t);return a?a.call(e,s,u):e.slice(u-s.length,u)===s}})},function(t,e,r){r(981),t.exports=r(193).String.includes},function(t,e,r){"use strict";var n=r(238),o=r(536);n(n.P+n.F*r(537)("includes"),"String",{includes:function(t){return!!~o(this,t,"includes").indexOf(t,arguments.length>1?arguments[1]:void 0)}})},function(t,e,r){r(983),r(991),t.exports=r(193).Array.from},function(t,e,r){"use strict";var n=r(984)(!0);r(985)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})},function(t,e,r){var n=r(534),o=r(423);t.exports=function(t){return function(e,r){var i,a,u=String(o(e)),s=n(r),c=u.length;return s<0||s>=c?t?"":void 0:(i=u.charCodeAt(s))<55296||i>56319||s+1===c||(a=u.charCodeAt(s+1))<56320||a>57343?t?u.charAt(s):i:t?u.slice(s,s+2):a-56320+(i-55296<<10)+65536}}},function(t,e,r){"use strict";var n=r(617),o=r(238),i=r(616),a=r(391),u=r(538),s=r(986),c=r(621),f=r(990),l=r(194)("iterator"),p=!([].keys&&"next"in[].keys()),d=function(){return this};t.exports=function(t,e,r,h,v,m,y){s(r,e,h);var b,g,w,_=function(t){if(!p&&t in k)return k[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},O=e+" Iterator",x="values"==v,j=!1,k=t.prototype,C=k[l]||k["@@iterator"]||v&&k[v],E=C||_(v),A=v?x?_("entries"):E:void 0,I="Array"==e&&k.entries||C;if(I&&(w=f(I.call(new t)))!==Object.prototype&&w.next&&(c(w,O,!0),n||"function"==typeof w[l]||a(w,l,d)),x&&C&&"values"!==C.name&&(j=!0,E=function(){return C.call(this)}),n&&!y||!p&&!j&&k[l]||a(k,l,E),u[e]=E,u[O]=d,v)if(b={values:x?E:_("values"),keys:m?E:_("keys"),entries:A},y)for(g in b)g in k||i(k,g,b[g]);else o(o.P+o.F*(p||j),e,b);return b}},function(t,e,r){"use strict";var n=r(987),o=r(529),i=r(621),a={};r(391)(a,r(194)("iterator"),function(){return this}),t.exports=function(t,e,r){t.prototype=n(a,{next:o(1,r)}),i(t,e+" Iterator")}},function(t,e,r){var n=r(420),o=r(988),i=r(620),a=r(535)("IE_PROTO"),u=function(){},s=function(){var t,e=r(615)("iframe"),n=i.length;for(e.style.display="none",r(989).appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),s=t.F;n--;)delete s.prototype[i[n]];return s()};t.exports=Object.create||function(t,e){var r;return null!==t?(u.prototype=n(t),r=new u,u.prototype=null,r[a]=t):r=s(),void 0===e?r:o(r,e)}},function(t,e,r){var n=r(419),o=r(420),i=r(618);t.exports=r(393)?Object.defineProperties:function(t,e){o(t);for(var r,a=i(e),u=a.length,s=0;u>s;)n.f(t,r=a[s++],e[r]);return t}},function(t,e,r){var n=r(282).document;t.exports=n&&n.documentElement},function(t,e,r){var n=r(421),o=r(424),i=r(535)("IE_PROTO"),a=Object.prototype;t.exports=Object.getPrototypeOf||function(t){return t=o(t),n(t,i)?t[i]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,r){"use strict";var n=r(532),o=r(238),i=r(424),a=r(992),u=r(993),s=r(394),c=r(994),f=r(995);o(o.S+o.F*!r(997)(function(t){Array.from(t)}),"Array",{from:function(t){var e,r,o,l,p=i(t),d="function"==typeof this?this:Array,h=arguments.length,v=h>1?arguments[1]:void 0,m=void 0!==v,y=0,b=f(p);if(m&&(v=n(v,h>2?arguments[2]:void 0,2)),void 0==b||d==Array&&u(b))for(r=new d(e=s(p.length));e>y;y++)c(r,y,m?v(p[y],y):p[y]);else for(l=b.call(p),r=new d;!(o=l.next()).done;y++)c(r,y,m?a(l,v,[o.value,y],!0):o.value);return r.length=y,r}})},function(t,e,r){var n=r(420);t.exports=function(t,e,r,o){try{return o?e(n(r)[0],r[1]):e(r)}catch(e){var i=t.return;throw void 0!==i&&n(i.call(t)),e}}},function(t,e,r){var n=r(538),o=r(194)("iterator"),i=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||i[o]===t)}},function(t,e,r){"use strict";var n=r(419),o=r(529);t.exports=function(t,e,r){e in t?n.f(t,e,o(0,r)):t[e]=r}},function(t,e,r){var n=r(996),o=r(194)("iterator"),i=r(538);t.exports=r(193).getIteratorMethod=function(t){if(void 0!=t)return t[o]||t["@@iterator"]||i[n(t)]}},function(t,e,r){var n=r(422),o=r(194)("toStringTag"),i="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,r,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),o))?r:i?n(e):"Object"==(a=n(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,r){var n=r(194)("iterator"),o=!1;try{var i=[7][n]();i.return=function(){o=!0},Array.from(i,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var r=!1;try{var i=[7],a=i[n]();a.next=function(){return{done:r=!0}},i[n]=function(){return a},t(i)}catch(t){}return r}},function(t,e,r){r(999),t.exports=r(193).Array.find},function(t,e,r){"use strict";var n=r(238),o=r(622)(5),i=!0;"find"in[]&&Array(1).find(function(){i=!1}),n(n.P+n.F*i,"Array",{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),r(623)("find")},function(t,e,r){var n=r(1001);t.exports=function(t,e){return new(n(t))(e)}},function(t,e,r){var n=r(392),o=r(1002),i=r(194)("species");t.exports=function(t){var e;return o(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!o(e.prototype)||(e=void 0),n(e)&&null===(e=e[i])&&(e=void 0)),void 0===e?Array:e}},function(t,e,r){var n=r(422);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){r(1004),t.exports=r(193).Array.findIndex},function(t,e,r){"use strict";var n=r(238),o=r(622)(6),i="findIndex",a=!0;i in[]&&Array(1)[i](function(){a=!1}),n(n.P+n.F*a,"Array",{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),r(623)(i)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(624),o=r(626),i=r(627);e.formEntryToChangeset=function(t){var e=t.content,r=t.formEntry,a=(t.userId,t.fileType);if(a=a||"richdoc","submit_entry_v2"===r.action){var u=r.payload,s=u.form,c=u.formGuid,f=u.submission;u.userId;return n.createChangeForSubmitForm({spread:e,fileType:a,form:s,formGuid:c,submission:f,time:new Date})}if("update_form_v2"===r.action){var l=r.payload,p=(s=l.form,c=l.formGuid,l.userId);return o.createChangeForUpdateForm({spread:e,fileType:a,form:s,formGuid:c,userId:p})}if("unlink_form_v2"===r.action){var d=r.payload,h=(c=d.formGuid,d.userId);return i.createChangeForUnlinkForm({spread:e,fileType:a,formGuid:c,userId:h})}throw new Error("unexpected formEntry: "+JSON.stringify(r))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";e.generateId=function(t){for(var e="",r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1008);e.isDeepEqual=function(t,r,o){var i=(void 0===o?{ignoreEmptyKey:!1}:o).ignoreEmptyKey;if(t===r)return!0;var a=n.type(t);if(a!==n.type(r))return!1;if("array"===a)return t.length===r.length&&t.every(function(t,n){return e.isDeepEqual(t,r[n],{ignoreEmptyKey:i})});if(t instanceof Date&&r instanceof Date)return t.getTime()===r.getTime();if("object"===a){var u=Object.keys(t).sort().filter(function(e){return!(void 0===t[e]&&i)}),s=Object.keys(r).sort().filter(function(t){return!(void 0===r[t]&&i)});return u.length===s.length&&u.every(function(n,o){var a=s[o];return n===a&&e.isDeepEqual(t[n],r[a],{ignoreEmptyKey:i})})}return!("number"!=typeof t||!isNaN(t))||t===r}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.type=function(t){return null===t?"null":void 0===t?"undefined":Array.isArray(t)?"array":typeof t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=r(427),i=r(176),a=function(t){return null==t||""===t},u=function(t){return new Date(t).getTime()===new Date("0001-01-01T00:00:00Z").getTime()},s=[o.FormQuestions.TextType,o.FormQuestions.SingleChoiceType,o.FormQuestions.MultipleChoiceType,o.FormQuestions.DropdownListType,o.FormQuestions.MultipleTextType];e.getFormQuestionCode=function(t){return s.indexOf(t)},e.getFormQuestionType=function(t){return s[t]},e.toServerPublishedStatus=function(t){if(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=r;switch(n){case"deadline":e[n]=t.deadline?t.deadline.toISOString():"0001-01-01T00:00:00Z";break;case"fillLimit":case"sheetGuid":case"spreadGuid":case"status":case"formId":e[n]=t[n]||"";break;default:i.softAssertNever(n)}}return e}},e.fromServerPublishedStatus=function(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=r;switch(n){case"deadline":e[n]=t.deadline&&!u(t.deadline)?new Date(t.deadline):void 0;break;case"fillLimit":case"sheetGuid":case"spreadGuid":case"status":case"formId":e[n]=a(t[n])?void 0:t[n]}}return e},function(t){t[t.ErrResponseNotFound=0]="ErrResponseNotFound",t[t.ErrResponseNoPublished=1]="ErrResponseNoPublished",t[t.ErrResponseOvertime=2]="ErrResponseOvertime",t[t.ErrResponseStopped=3]="ErrResponseStopped",t[t.ErrResponseOveronce=4]="ErrResponseOveronce",t[t.ErrResponseOveroncePerday=5]="ErrResponseOveroncePerday",t[t.ErrValidation=6]="ErrValidation"}(n=e.ErrorResponse||(e.ErrorResponse={})),e.queryCanSubmit=function(t){var e=n.ErrValidation;switch(t.code){case 20211:e=n.ErrResponseNotFound;break;case 20212:e=n.ErrResponseNoPublished;break;case 20213:e=n.ErrResponseOvertime;break;case 20214:e=n.ErrResponseStopped;break;case 20215:e=n.ErrResponseOveronce;break;case 20216:e=n.ErrResponseOveroncePerday;break;default:e=n.ErrValidation}return{isValid:t.isValid,errorResponse:e}}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r(216));e.ajax={request:function(t,e){var r=e.method,i=e.data,u=e.extract,s=void 0===u?function(t){return t.data}:u;return n(this,void 0,void 0,function(){var e;return o(this,function(n){switch(n.label){case 0:return"get"!==r.toLowerCase()?[3,2]:[4,a.default.request({url:t,method:r,params:i})];case 1:return e=n.sent(),[2,s(e)];case 2:return[4,a.default.request({url:t,method:r,data:i})];case 3:return e=n.sent(),[2,s(e)]}})})}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r(628)),u=r(1014);e.log=function(t){return a.default(t)},e.createLoggingDecorator=function(t,r){void 0===r&&(r=null);var n=e.log(t);return u.createDecorator({onCalled:function(t){n.apply(void 0,o(t))},onReturned:function(t){n(t)},onError:function(t){n(" <ERROR> "),console.error(t)}})},e.logObject=function(t,e){var r={},n=function(t){return r[t]||(r[t]=a.default(e+":"+t)),r[t]},i=u.decorateObject(t,{onCalled:function(t,e){n(e).apply(void 0,o(t))},onReturned:function(t,e,r){n(r)(t)},onError:function(t,e,r){n(r)(" <ERROR> "),console.error(t)}});if("undefined"!=typeof window){var s=window;s.logged||(s.logged={}),s.logged[e]=t}return i}},function(t,e,r){t.exports=function(t){function e(t){for(var e=0,r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return n.colors[Math.abs(e)%n.colors.length]}function n(t){var r;function a(){var t=Array.prototype.slice.call(arguments);if(a.enabled){var e=a,o=Number(new Date),i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(r,o){if("%%"===r)return r;u++;var i=n.formatters[o];if("function"==typeof i){var a=t[u];r=i.call(e,a),t.splice(u,1),u--}return r}),n.formatArgs.call(e,t),(e.log||n.log).apply(e,t)}}return a.namespace=t,a.enabled=n.enabled(t),a.useColors=n.useColors(),a.color=e(t),a.destroy=o,a.extend=i,"function"==typeof n.init&&n.init(a),n.instances.push(a),a}function o(){var t=n.instances.indexOf(this);return-1!==t&&(n.instances.splice(t,1),!0)}function i(t,e){var r=n(this.namespace+(void 0===e?":":e)+t);return r.log=this.log,r}function a(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(t){return t instanceof Error?t.stack||t.message:t},n.disable=function(){var t=n.names.map(a).concat(n.skips.map(a).map(function(t){return"-"+t})).join(",");return n.enable(""),t},n.enable=function(t){var e;n.save(t),n.names=[],n.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(e=0;e<o;e++)r[e]&&("-"===(t=r[e].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")));for(e=0;e<n.instances.length;e++){var i=n.instances[e];i.enabled=n.enabled(i.namespace)}},n.enabled=function(t){if("*"===t[t.length-1])return!0;var e,r;for(e=0,r=n.skips.length;e<r;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;e<r;e++)if(n.names[e].test(t))return!0;return!1},n.humanize=r(1013),Object.keys(t).forEach(function(e){n[e]=t[e]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=e,n.enable(n.load()),n}},function(t,e){var r=1e3,n=60*r,o=60*n,i=24*o,a=7*i,u=365.25*i;function s(t,e,r,n){var o=e>=1.5*r;return Math.round(t/r)+" "+n+(o?"s":"")}t.exports=function(t,e){e=e||{};var c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var s=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*u;case"weeks":case"week":case"w":return s*a;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(t);if("number"===c&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=i)return s(t,e,i,"day");if(e>=o)return s(t,e,o,"hour");if(e>=n)return s(t,e,n,"minute");if(e>=r)return s(t,e,r,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=i)return Math.round(t/i)+"d";if(e>=o)return Math.round(t/o)+"h";if(e>=n)return Math.round(t/n)+"m";if(e>=r)return Math.round(t/r)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return"function"==typeof(t&&t.then)};function i(t){var e=t.onCalled,r=t.onReturned,n=t.onError,i=t.fnName,a=t.self,u=void 0===a?null:a;return function(t){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];e&&e(a,i||t.name);try{var c=t.apply(u,a);return o(c)?c.then(function(e){return r&&r(e,a,i||t.name),e},function(e){throw n&&n(e,a,i||t.name),e}):(r&&r(c,a,i||t.name),c)}catch(e){throw n&&n(e,a,i||t.name),e}}}}e.createDecorator=i,e.decorateObject=function(t,e){for(var r in t){var o=t[r];if("constructor"!==r&&"function"==typeof o){var a=i(n({},e,{self:t,fnName:r}));t[r]=a(o)}}return t}},function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(1016));e.produce=o.produce},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){r.d(e,"produce",function(){return q}),r.d(e,"setAutoFreeze",function(){return H}),r.d(e,"setUseProxies",function(){return J}),r.d(e,"applyPatches",function(){return Y}),r.d(e,"Immer",function(){return B}),r.d(e,"original",function(){return l}),r.d(e,"isDraft",function(){return c}),r.d(e,"isDraftable",function(){return f}),r.d(e,"nothing",function(){return a}),r.d(e,"immerable",function(){return u});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},i=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),a="undefined"!=typeof Symbol?Symbol("immer-nothing"):function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}({},"immer-nothing",!0),u="undefined"!=typeof Symbol?Symbol("immer-draftable"):"__$immer_draftable",s="undefined"!=typeof Symbol?Symbol("immer-state"):"__$immer_state";function c(t){return!!t&&!!t[s]}function f(t){if(!t||"object"!==(void 0===t?"undefined":n(t)))return!1;if(Array.isArray(t))return!0;var e=Object.getPrototypeOf(t);return!e||e===Object.prototype||(!!t[u]||!!t.constructor[u])}function l(t){if(t&&t[s])return t[s].base}var p=Object.assign||function(t,e){for(var r in e)y(e,r)&&(t[r]=e[r]);return t},d="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames;function h(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(t))return t.slice();var r=Object.create(Object.getPrototypeOf(t));return d(t).forEach(function(n){if(n!==s){var o=Object.getOwnPropertyDescriptor(t,n);if(o.get){if(!e)throw new Error("Immer drafts cannot have computed properties");o.value=o.get.call(t)}o.enumerable?r[n]=o.value:Object.defineProperty(r,n,{value:o.value,writable:!0,configurable:!0})}}),r}function v(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)e(r,t[r],t);else d(t).forEach(function(r){return e(r,t[r],t)})}function m(t,e){return Object.getOwnPropertyDescriptor(t,e).enumerable}function y(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function b(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var g={},w=[],_=function(){return w[w.length-1]};function O(t,e){var r=Array.isArray(t),n=E(t);v(n,function(e){!function(t,e,r){var n=g[e];n?n.enumerable=r:g[e]=n={configurable:!0,enumerable:r,get:function(){return function(t,e){A(t);var r=j(t)[e];if(!t.finalizing&&r===t.base[e]&&f(r))return C(t),t.copy[e]=O(r,t);return r}(this[s],e)},set:function(t){!function(t,e,r){if(A(t),t.assigned[e]=!0,!t.modified){if(b(j(t)[e],r))return;k(t),C(t)}t.copy[e]=r}(this[s],e,t)}};Object.defineProperty(t,e,n)}(n,e,r||m(t,e))});var o={scope:e?e.scope:_(),modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:e,base:t,draft:n,copy:null,revoke:x,revoked:!1};return function(t,e,r){Object.defineProperty(t,e,{value:r,enumerable:!1,writable:!0})}(n,s,o),o.scope.push(o),n}function x(){this.revoked=!0}function j(t){return t.copy||t.base}function k(t){t.modified||(t.modified=!0,t.parent&&k(t.parent))}function C(t){t.copy||(t.copy=E(t.base))}function E(t){var e=t&&t[s];if(e){e.finalizing=!0;var r=h(e.draft,!0);return e.finalizing=!1,r}return h(t)}function A(t){if(!0===t.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(j(t)))}function I(t){for(var e=t.base,r=t.draft,n=Object.keys(r),o=n.length-1;o>=0;o--)if(void 0===e[n[o]]&&!y(e,n[o]))return!0;return n.length!==Object.keys(e).length}function S(t){var e=t.draft;if(e.length!==t.base.length)return!0;var r=Object.getOwnPropertyDescriptor(e,e.length-1);return!(!r||r.get)}var T=Object.freeze({scopes:w,currentScope:_,willFinalize:function(t,e,r){var o=_();o.forEach(function(t){return t.finalizing=!0}),void 0!==t&&t!==e||(r&&function t(e){if(e&&"object"===(void 0===e?"undefined":n(e))){var r=e[s];if(r){var o=r.base,i=r.draft,a=r.assigned;if(Array.isArray(e)){if(S(r)){if(k(r),a.length=!0,i.length<o.length)for(var u=i.length;u<o.length;u++)a[u]=!1;else for(var c=o.length;c<i.length;c++)a[c]=!0;for(var f=0;f<i.length;f++)void 0===a[f]&&t(i[f])}}else Object.keys(i).forEach(function(e){void 0!==o[e]||y(o,e)?a[e]||t(i[e]):(a[e]=!0,k(r))}),Object.keys(o).forEach(function(t){void 0!==i[t]||y(i,t)||(a[t]=!1,k(r))})}}}(e),function(t){for(var e=t.length-1;e>=0;e--){var r=t[e];!1===r.modified&&(Array.isArray(r.base)?S(r)&&k(r):I(r)&&k(r))}}(o))},createDraft:O}),P=[],M=function(){return P[P.length-1]};function F(t,e){var r={scope:e?e.scope:M(),modified:!1,finalized:!1,assigned:{},parent:e,base:t,draft:null,drafts:{},copy:null,revoke:null},n=Array.isArray(t)?Proxy.revocable([r],N):Proxy.revocable(r,D),o=n.revoke,i=n.proxy;return r.draft=i,r.revoke=o,r.scope.push(r),i}var D={get:function(t,e){if(e===s)return t;var r=t.drafts;if(!t.modified&&y(r,e))return r[e];var n=R(t)[e];if(t.finalized||!f(n))return n;if(t.modified){if(n!==t.base[e])return n;r=t.copy}return r[e]=F(n,t)},has:function(t,e){return e in R(t)},ownKeys:function(t){return Reflect.ownKeys(R(t))},set:function(t,e,r){if(!t.modified){var n=r?b(t.base[e],r)||r===t.drafts[e]:b(t.base[e],r)&&e in t.base;if(n)return!0;L(t)}return t.assigned[e]=!0,t.copy[e]=r,!0},deleteProperty:function(t,e){(void 0!==t.base[e]||e in t.base)&&(t.assigned[e]=!1,L(t));t.copy&&delete t.copy[e];return!0},getOwnPropertyDescriptor:function(t,e){var r=R(t),n=Reflect.getOwnPropertyDescriptor(r,e);n&&(n.writable=!0,n.configurable=!Array.isArray(r)||"length"!==e);return n},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(t){return Object.getPrototypeOf(t.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},N={};function R(t){return t.copy||t.base}function L(t){t.modified||(t.modified=!0,t.copy=p(h(t.base),t.drafts),t.drafts=null,t.parent&&L(t.parent))}v(D,function(t,e){N[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),N.deleteProperty=function(t,e){if(isNaN(parseInt(e)))throw new Error("Immer only supports deleting array indices");return D.deleteProperty.call(this,t[0],e)},N.set=function(t,e,r){if("length"!==e&&isNaN(parseInt(e)))throw new Error("Immer only supports setting array indices and the 'length' property");return D.set.call(this,t[0],e,r)};var G=Object.freeze({scopes:P,currentScope:M,willFinalize:function(){},createDraft:F});function U(t,e,r,n){Array.isArray(t.base)?function(t,e,r,n){for(var o=t.base,i=t.copy,a=t.assigned,u=Math.min(o.length,i.length),s=0;s<u;s++)if(a[s]&&o[s]!==i[s]){var c=e.concat(s);r.push({op:"replace",path:c,value:i[s]}),n.push({op:"replace",path:c,value:o[s]})}if(u<i.length){for(var f=u;f<i.length;f++)r.push({op:"add",path:e.concat(f),value:i[f]});n.push({op:"replace",path:e.concat("length"),value:o.length})}else if(u<o.length){r.push({op:"replace",path:e.concat("length"),value:i.length});for(var l=u;l<o.length;l++)n.push({op:"add",path:e.concat(l),value:o[l]})}}(t,e,r,n):function(t,e,r,n){var o=t.base,i=t.copy;v(t.assigned,function(t,a){var u=o[t],s=i[t],c=a?t in o?"replace":"add":"remove";if(u!==s||"replace"!==c){var f=e.concat(t);r.push("remove"===c?{op:c,path:f}:{op:c,path:f,value:s}),n.push("add"===c?{op:"remove",path:f}:"remove"===c?{op:"add",path:f,value:u}:{op:"replace",path:f,value:u})}})}(t,e,r,n)}function z(t,e){for(var r=0;r<e.length;r++){var o=e[r],i=o.path;if(0===i.length&&"replace"===o.op)t=o.value;else{for(var a=t,u=0;u<i.length-1;u++)if(!(a=a[i[u]])||"object"!==(void 0===a?"undefined":n(a)))throw new Error("Cannot apply patch, path doesn't resolve: "+i.join("/"));var s=i[i.length-1];switch(o.op){case"replace":case"add":a[s]=o.value;break;case"remove":if(Array.isArray(a)){if(s!==a.length-1)throw new Error("Only the last index of an array can be removed, index: "+s+", length: "+a.length);a.length-=1}else delete a[s];break;default:throw new Error("Unsupported patch operation: "+o.op)}}}return t}var V={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:void 0===t&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},B=function(){function t(e){o(this,t),p(this,V,e),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)}return i(t,[{key:"produce",value:function(t,e,r){var n=this;if("function"==typeof t&&"function"!=typeof e){var o=e;return e=t,function(){for(var t=arguments.length,r=Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return n.produce(a,function(t){var n;return(n=e).call.apply(n,[t,t].concat(r))})}}if("function"!=typeof e)throw new Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==r&&"function"!=typeof r)throw new Error("the third argument of a producer should not be set or a function");var i=void 0;if(f(t)){this.scopes.push([]);var u=this.createDraft(t);try{i=e.call(u,u),this.willFinalize(i,u,!!r);var c=r&&[],l=r&&[];if(void 0===i||i===u)i=this.finalize(u,[],c,l);else{if(u[s].modified)throw new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");f(i)&&(i=this.finalize(i)),r&&(c.push({op:"replace",path:[],value:i}),l.push({op:"replace",path:[],value:t}))}}finally{this.currentScope().forEach(function(t){return t.revoke()}),this.scopes.pop()}r&&r(c,l)}else if(void 0===(i=e(t)))return t;return i===a?void 0:i}},{key:"setAutoFreeze",value:function(t){this.autoFreeze=t}},{key:"setUseProxies",value:function(t){this.useProxies=t,p(this,t?G:T)}},{key:"applyPatches",value:function(t,e){return c(t)?z(t,e):this.produce(t,function(t){return z(t,e)})}},{key:"finalize",value:function(t,e,r,n){var o=this,i=t[s];if(!i)return Object.isFrozen(t)?t:this.finalizeTree(t);if(i.scope!==this.currentScope())return t;if(!i.modified)return i.base;if(!i.finalized){if(i.finalized=!0,this.finalizeTree(i.draft,e,r,n),this.onDelete)if(this.useProxies){var a=i.assigned;for(var u in a)a[u]||this.onDelete(i,u)}else{var c=i.base,f=i.copy;v(c,function(t){y(f,t)||o.onDelete(i,t)})}this.onCopy&&this.onCopy(i),this.autoFreeze&&1===this.scopes.length&&Object.freeze(i.copy),r&&U(i,e,r,n)}return i.copy}},{key:"finalizeTree",value:function(t,e,r,n){var o=this,i=t[s];i&&(this.useProxies||(i.finalizing=!0,i.copy=h(i.draft,!0),i.finalizing=!1),t=i.copy);var a=this.onAssign;return v(t,function u(s,l,p){if(l===p)throw Error("Immer forbids circular references");var d=!!i&&p===t;if(c(l)){if(l=r&&d&&!i.assigned[s]?o.finalize(l,e.concat(s),r,n):o.finalize(l),Array.isArray(p)||m(p,s)?p[s]=l:Object.defineProperty(p,s,{value:l}),d&&l===i.base[s])return}else{if(d&&b(l,i.base[s]))return;f(l)&&!Object.isFrozen(l)&&v(l,u)}d&&a&&a(i,s,l)}),t}}]),t}(),$=new B,q=$.produce,H=$.setAutoFreeze.bind($),J=$.setUseProxies.bind($),Y=$.applyPatches.bind($);e.default=q}.call(e,r(180))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.createOperator=function(t,e,r){return{action:t,attributes:e&&function(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];void 0!==n&&(e[r]=n)}return e}(e),data:r}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var a=r(425),u=i(r(175)),s=i(r(156)),c=r(176),f=r(176),l=r(426);e.avoidConfict=function(t,e){if(-1===e.indexOf(t))return t;for(var r=1;-1!==e.indexOf(t+" "+r);)r++;return t+" "+r};var p=function(t){return{action:"retain",attributes:{color:"#ffffff",userId:t,authorId:t,background:"#41464b",format:"@",cellValue:"填写时间"},data:1}},d=function(t){return{action:"retain",attributes:{color:"#ffffff",userId:t,authorId:t,background:"#41464b",format:"@"},data:1}};e.createChangeForCreateForm=function(t){var r=t.fileType,n=t.spread,i=t.formGuid,h=t.sheetGuid,v=t.sheetTitle,m=void 0===v?"未命名表单":v,y=t.userId;switch(r){case"modoc":return function(t){var r=t.spread,n=t.formGuid,i=t.sheetGuid,s=t.sheetTitle,c=t.userId;f.assert(u.Delta.isDelta(r),"spread should be modoc.Delta"),f.assert("string"==typeof n,"formGuid should be string"),f.assert(c,"userId is not provided");for(var l=[],h=r.getIter();h.hasNext();)l.push(h.next());var v=l.map(function(t){return t.getAttributes()||{}}),m=v.map(function(t){return t.name||""}),y=v.map(function(t){return t.order||0}),b={action:"insert",attributes:{formItemGuid:a.CREATE_AT,width:135},data:{delta:[p(c)]}},g={action:"insert",data:{delta:[d(c)]}},w=o(new Array(a.DEFAULT_COLUMN_COUNT)).map(function(t,e){return 0===e?b:g}),_={action:"insert",attributes:{id:i,name:e.avoidConfict(s,m),order:Math.max(0,Math.min.apply(Math,o(y))),formGuid:n,formVersion:a.FORM_VERSION,fixedRowsTop:1,userId:c,authorId:c},data:{table:{rows:[{action:"insert",attributes:{height:30},data:1},{action:"insert",data:199}],cols:w}}};return new u.Delta([_]).stringify()}({spread:"string"==typeof n?new u.Delta(n):n,formGuid:i,sheetGuid:h,sheetTitle:m,userId:y});case"richdoc":return function(t){var r=t.spread,n=t.formGuid,i=t.sheetGuid,u=t.sheetTitle,c=t.userId;f.assert(Array.isArray(r&&r.ops),"spread should be richdoc.Delta"),f.assert("string"==typeof n,"formGuid should be string"),f.assert(c,"userId is not provided");for(var h=[],v=r.getIter();v.hasNext();)h.push(v.next());var m=h.map(function(t){return t.getAttributes()||{}}),y=m.map(function(t){return t.name||""}),b=m.map(function(t){return t.order||0}),g=new s.Operator({action:"insert",attributes:{formItemGuid:a.CREATE_AT,width:135},data:1}),w=new s.Operator({action:"insert",attributes:{},data:1}),_=o(new Array(a.DEFAULT_COLUMN_COUNT)),O=new s.Delta(_.map(function(t,e){return 0===e?g:w})),x=new s.Delta([new s.Operator({action:"insert",attributes:{height:30},data:1}),new s.Operator({action:"insert",attributes:{},data:199})]),j={};_.forEach(function(t,e){var r=l.toCellName(0,e);j[r]=0===e?new s.CellOperator(p(c)):new s.CellOperator(d(c))});var k=new s.TableOperator({action:"insert",attributes:{id:i,name:e.avoidConfict(u,y),order:Math.max(0,Math.min.apply(Math,o(b))),formGuid:n,formVersion:a.FORM_VERSION,fixedRowsTop:1,userId:c,authorId:c},data:{rows:x,cols:O,cells:j}}),C=new s.Delta([k]);return s.pack(C)}({spread:"string"==typeof n?s.unpack(n):n,formGuid:i,sheetGuid:h,sheetTitle:m,userId:y});default:return c.assertNever(r)}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(175),a=r(425),u=r(540),s=r(625);e.createChangeForCreateSpread=function(t){var e=t.form,r=t.formGuid,n=t.submissions,c=t.userId,f={};e.questions.forEach(function(t){f[t.guid]=t});var l=[{action:"insert",attributes:{height:30},data:1},{action:"insert",data:Math.max(199,n.length)}],p=o([a.CREATE_AT],e.questions.map(function(t){return t.guid}),function(t){return o(new Array(t))}(Math.max(0,18-(1+e.questions.length)))).map(function(t,r){if(!t)return{action:"insert",attributes:{},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:c,authorId:c,background:"#41464b"},data:1}]}};var i={action:"retain",attributes:{color:"#ffffff",userId:c,authorId:c,background:"#41464b",format:"@",cellValue:t===a.CREATE_AT?"填写时间":f[t].subject||"添加问题项"},data:1},l=n.map(function(n){if(!n)return a.skipCellOp;if(t===a.CREATE_AT)return a.createTextCellOp(s.stringifyDate(n.createdAt),n.userId);var o=r-1,i=e.questions[o],c=(n.content||[]).find(function(t){return t.guid===i.guid&&u.isQuestionTypeCompatible(t.type,i.type)});return c?a.questionResponseToCellOp({question:i,response:c,userId:n.userId}):a.skipCellOp}),p=o([i],l);return{action:"insert",attributes:t===a.CREATE_AT?{formItemGuid:a.CREATE_AT,width:135}:{formItemGuid:t},data:{delta:p}}}),d=[{action:"insert",attributes:{id:a.DEFAULT_FORM_SHEET_ID,order:0,name:e.title||"未命名表单",fixedRowsTop:1,formGuid:r,formVersion:a.FORM_VERSION,userId:c,authorId:c},data:{table:{rows:l,cols:p}}}];return new i.Delta(d).stringify()}},function(t,e,r){"use strict";r.d(e,"b",function(){return s}),r.d(e,"a",function(){return c});var n=r(160),o=(r.n(n),r(428)),i=(r.n(o),r(1021)),a=r.n(i),u={},s=function(t){if(t&&t.title)return u&&u.showAlert?u.showAlert(t):Object(o.showAlert)(t)},c=function(t){return u&&u.confirm?u.confirm(t):a()(t)}},function(t,e,r){var n=a(r(0)),o=r(11),i=a(r(1022));function a(t){return t&&t.__esModule?t:{default:t}}var u=document.body.appendChild(document.createElement("div"));t.exports=function(t){var e=t||{};e.cleanup=function(){return u.parentNode.removeChild(u)},document.body.contains(u)||document.body.appendChild(u),(0,o.render)(n.default.createElement(i.default,e),u)}},function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),o=c(r(3)),i=c(r(144)),a=r(0),u=c(a),s=c(r(8));function c(t){return t&&t.__esModule?t:{default:t}}var f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return r._confirm=function(){r.props.confirmFun(),r._cleanup()},r._abort=function(){r.props.abortFun(),r._cleanup()},r._cleanup=function(){r.props.cleanup&&r.props.cleanup()},r._handleWrapClick=function(t){t.target.className.indexOf("confirm-wrap")>-1&&r._abort()},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a.Component),n(e,null,[{key:"defaultProps",get:function(){return{customClass:"",title:(0,o.default)("确认弹窗"),description:(0,o.default)("确定执行该操作吗？"),confirmLabel:(0,o.default)("确认"),abortLabel:(0,o.default)("取消"),confirmFun:function(){},abortFun:function(){},confirmClass:"",abortClass:"",buttons:[]}}},{key:"propTypes",get:function(){return{customClass:s.default.string,title:s.default.string,description:s.default.string,content:s.default.node,confirmLabel:s.default.string,abortLabel:s.default.string,confirmClass:s.default.string,abortClass:s.default.string,confirmFun:s.default.func,abortFun:s.default.func,buttons:s.default.array}}}]),n(e,[{key:"render",value:function(){return u.default.createElement("div",{className:"confirm-wrap",onClick:this._handleWrapClick},u.default.createElement("div",{className:"confirm-dialog dialog "+this.props.customClass},u.default.createElement("div",{className:"confirm-dialog-header dialog-head"},u.default.createElement("span",null,this.props.title),u.default.createElement("span",{className:"hicon icon-close confirm-close",onClick:this._abort})),this._renderDialogBody(),this._renderFooter()))}},{key:"_customButtonClickFun",value:function(t,e){var r=this;return function(){"function"==typeof t&&t(),"boolean"==typeof e&&e&&r._cleanup()}}},{key:"_renderDialogBody",value:function(){var t=this.props.content;return t?u.default.createElement("div",{className:"confirm-dialog-content dialog-body"},t):u.default.createElement("div",{className:"confirm-dialog-content dialog-body",dangerouslySetInnerHTML:{__html:this.props.description}})}},{key:"_renderFooter",value:function(){var t=this;if(this.props.buttons.length>0){var e=[];return(0,i.default)(this.props.buttons,function(r,n){var o=r.type||"button",i=r.onClick||function(){},a=r.customClass||"",s=r.href||"",c=r.target||"_blank",f=r.buttonLabel||"",l=!!r.closeAfterClick;"link-button"===o?e.push(u.default.createElement("a",{key:n,className:"btn confirm-btn "+a,href:s,onClick:t._customButtonClickFun(i,l),target:c},f)):"button"===o&&e.push(u.default.createElement("button",{key:n,className:"btn confirm-btn "+a,onClick:t._customButtonClickFun(i,l)},f))}),u.default.createElement("div",{className:"confirm-dialog-footer dialog-foot"},e)}return u.default.createElement("div",{className:"confirm-dialog-footer dialog-foot"},u.default.createElement("button",{role:"confirm",type:"button",className:"btn btn-ok confirm-btn "+this.props.confirmClass,ref:"confirm",onClick:this._confirm},this.props.confirmLabel),u.default.createElement("button",{role:"abort",type:"button",className:"btn confirm-btn "+this.props.abortClass,onClick:this._abort},this.props.abortLabel))}}]),e}();e.default=f,t.exports=e.default},function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(1024),o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a={fetchFile:function(t,e){var r=(void 0===e?{}:e).contentUrl,a=void 0!==r&&r;return o(this,void 0,Promise,function(){var e,r,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,n.a.request("/lizard-api/files/"+t,{method:"GET",data:{collaboratorCount:!0,contentUrl:a,creator:1,updateViews:!0},headers:{"Cache-Control":"no-cache"}})];case 1:return[2,i.sent()];case 2:if(e=i.sent(),(o=(r=e)&&r.response&&r.response.data)&&(60001===o.errorCode||60002===o.errorCode||/(不存在|被删除)/.test(o.error)))return[2,void 0];throw e;case 3:return[2]}})})},fetchFileAncestors:function(t){return o(this,void 0,Promise,function(){return i(this,function(e){switch(e.label){case 0:return[4,n.a.request("/lizard-api/files/"+t+"/ancestors",{method:"GET"})];case 1:return[2,e.sent().ancestors||[]]}})})},fetchFileContent:function(t){return o(this,void 0,Promise,function(){return i(this,function(e){switch(e.label){case 0:return[4,n.a.request(t.contentUrl,{method:"GET"})];case 1:return[2,e.sent()]}})})},createFile:function(t){return o(this,void 0,Promise,function(){return i(this,function(e){switch(e.label){case 0:return[4,n.a.request("/lizard-api/files",{method:"POST",data:t})];case 1:return[2,e.sent()]}})})}}},function(t,e,r){"use strict";r.d(e,"a",function(){return u});var n=r(216),o=r.n(n),i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u={request:function(t,e){var r=e.method,n=e.data,u=e.headers,s=void 0===u?{}:u;return i(this,void 0,Promise,function(){return a(this,function(e){return"get"===r.toLowerCase()?[2,o.a.request({url:t,method:r,params:n,headers:s}).then(function(t){return t.data})]:[2,o.a.request({url:t,method:r,headers:s,data:n}).then(function(t){return t.data})]})})}}},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return u});var n,o=r(74),i=(r.n(o),r(631)),a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return JSON.stringify(t)};!function(t){t.Fulfilled="Fulfilled",t.Rejected="Rejected",t.Cached="Cached"}(n||(n={}));var u=function(t,e){void 0===e&&(e=a);var r={},u=Object.assign(new o.EventEmitter,{get:function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var s=e.apply(void 0,o);if(s in r){var c=r[s];switch(c.status){case"fetching":return;case"success":return c.data;case"error":throw c.error;default:return Object(i.a)(c)}}r[s]={status:"fetching"},t.apply(void 0,o).then(function(t){r[s]={status:"success",data:t},u.emit(n.Fulfilled,t),u.emit(n.Cached)},function(t){r[s]={status:"error",error:t},u.emit(n.Rejected,t),u.emit(n.Cached)})}});return u}},function(t,e,r){"use strict";e.a=function(t){void 0===t&&(t=5);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var n=r(1028),o=function(t,e){var r=Object(n.a)(t);return e(r),r}},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=JSON.parse,o=JSON.stringify,i=function(t){return n(o(t))}},function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(628),o=r.n(n),i=r(1030),a=function(t,e){var r={},n=function(t){return r[t]||(r[t]=o()(e+":"+t)),r[t]},a=Object(i.b)(t,{onCalled:function(t,e){n(e).apply(void 0,t)},onReturned:function(t,e,r){n(r)(t)},onError:function(t,e,r){n(r)(" <ERROR> "),console.error(t)}});if("undefined"!=typeof window){var u=window;u.logged||(u.logged={}),u.logged[e]=t}return a}},function(t,e,r){"use strict";e.a=i,e.b=function(t,e){for(var r in t){var o=t[r];if("constructor"!==r&&"function"==typeof o){var a=i(n({},e,{self:t,fnName:r}));t[r]=a(o)}}return t};var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t){return"function"==typeof(t&&t.then)};function i(t){var e=t.onCalled,r=t.onReturned,n=t.onError,i=t.fnName,a=t.self,u=void 0===a?null:a;return function(t){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];e&&e(a,i||t.name);try{var c=t.apply(u,a);return o(c)?c.then(function(e){return r&&r(e,a,i||t.name),e},function(e){throw n&&n(e,a,i||t.name),e}):(r&&r(c,a,i||t.name),c)}catch(e){throw n&&n(e,a,i||t.name),e}}}}},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return a});var n=r(1),o=(r.n(n),n.sheets.track),i={menu:{create_form:"0100",share_form:"0101",unlink_form:"0102",create_form_dropdown:"0103",edit_form:"0114",publish_form:"0115"},create_dialog:{create_new:"0104",edit_draft:"0105"},form_editor:{create_form_click:"0106",create_form_success:"0107"},form_preview:{copy_link_click:"0108"},fill_page:{submit:"0109",enter:"0113"},guide:{view:"0110",dismiss:"0111",try_click:"0112"}},a=function(t){try{o(2,t)}catch(t){console.error("[form] failed to track:",t)}}},function(t,e,r){"use strict";e.a=function(t){var e=t.formController,r=function(){try{return/^(editor|owner)$/.test(window.cow.currentFile.role)}catch(t){return!1}},n=function(t,r){return e.canReadForm(t,r)};return{tabList:{form:function(t){function a(n){var a=t.call(this,n)||this;return a.onCreateForm=function(){return b(a,void 0,Promise,function(){var t,n;return g(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),e.track(e.events.menu.create_form),Object(h.b)()?(Object(i.showAlert)({title:o()("网络连接断开，请在网络恢复后重试"),type:"error"}),[2]):r()?[4,e.createForm()]:(Object(i.showAlert)({title:o()("表格协作者才能创建表单"),type:"error"}),[2]);case 1:return a.sent(),[3,3];case 2:return t=a.sent(),console.error(t),n=t&&t.errmsg||o()("表单创建失败，请稍后重试"),Object(i.showAlert)({title:n,type:"error"}),[3,3];case 3:return[2]}})})},a.onSelectMenuItem=function(t){var r=a.state,n=r.formGuid,o=r.formVersion,i=t.value;switch(i){case"edit":e.track(e.events.menu.edit_form),o===p.a.V2&&Object(v.b)(v.a.sheet_edit_forms),n&&e.openOrFocusPage("edit",n,o);break;case"unlink":o===p.a.V2&&Object(v.b)(v.a.sheet_unlink_form),e.track(e.events.menu.unlink_form),e.confirmUnlinkForm();break;case"create":o===p.a.V2&&Object(v.b)(v.a.create_from_sheets),e.track(e.events.menu.create_form_dropdown),a.onCreateForm();break;case"responses":o===p.a.V2&&Object(v.b)(v.a.sheet_view_response),n&&o===p.a.V2&&e.openOrFocusPage("responses",n,o);break;case"copy_link":o===p.a.V2&&Object(v.b)(v.a.sheet_copy_url),a.onCopyLink();break;case"statistics":o===p.a.V2&&Object(v.b)(v.a.sheet_view_statistics),n&&o===p.a.V2&&e.openOrFocusPage("statistics",n,o);break;default:Object(d.a)(i)}t.trackId&&Object(c.a)(2,t.trackId)},a.onMenuOpen=function(){Object(c.a)(2,8016)},a.onSheetChanged=function(){var t=a.props.editor.spread.getActiveSheet();if(t){var e=t.gcSheet,r=e.attrs,n=r.formGuid,o=r.formVersion;n===a.state.formGuid&&o===a.state.formVersion||a.setState({formGuid:n,formVersion:o})}else a.setState({formGuid:void 0,formVersion:void 0})},a.onCopyLink=function(){try{var t=a.state,r=t.formGuid,n=t.formVersion;if(!r)throw new Error("指定的表单不存在");var u=e.getFillPageUrl(r,n);if(!u)throw new Error("表单未发布");!function(t){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}(u),Object(i.showAlert)({title:o()("表单链接复制成功")})}catch(t){Object(i.showAlert)({title:o()("表单链接复制失败"),type:"error"})}},a.rerender=function(){a.forceUpdate?a.forceUpdate():a.setState({})},a.state={formGuid:void 0,formVersion:void 0},a}return m(a,t),a.prototype.componentDidMount=function(){this.props.editor.on(w.SheetSwitched,this.onSheetChanged),this.props.editor.on(w.AfterChangeApplied,this.onSheetChanged),this.props.editor.isRendered?this.onSheetChanged():this.props.editor.once(w.Rendered,this.onSheetChanged),e.on(l.a.FormChanged,this.rerender)},a.prototype.componentWillUnmount=function(){this.props.editor.off(w.SheetSwitched,this.onSheetChanged),this.props.editor.off(w.AfterChangeApplied,this.onSheetChanged),this.props.editor.off(w.Rendered,this.onSheetChanged),e.off(l.a.FormChanged,this.rerender)},a.prototype.shouldComponentUpdate=function(t,e){return this.props.permission.canEditFile!==t.permission.canEditFile||this.state.formGuid!==e.formGuid||this.state.formVersion!==e.formVersion},a.prototype.render=function(){var t,i=this,a=this.state,u=a.formGuid,c=a.formVersion,l=_().menuItems.form.map(function(t){return function(t,i,a){var u=t.value;switch(u){case"create":var s="form_create";return r()?y({},t,{icon:s}):y({},t,{icon:s,disabled:!0,disabledTip:""});case"edit":var s="form_edit";return i?n(i,a)?y({},t,{icon:s}):y({},t,{icon:s,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):y({},t,{icon:s,disabled:!0,disabledTip:""});case"unlink":var s="form_unlink",c=a===p.a.V2?"取消关联表单":"停用表单";return i?r()?y({},t,{display:c,icon:s}):y({},t,{display:c,icon:s,disabled:!0,disabledTip:"暂无权限取消关联表单"}):y({},t,{display:c,icon:s,disabled:!0,disabledTip:""});case"responses":var s="form_responses";return a!==p.a.V2?y({},t,{icon:s,hidden:!0}):i?n(i,a)?y({},t,{icon:s}):y({},t,{icon:s,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):y({},t,{icon:s,disabled:!0,disabledTip:""});case"copy_link":var s="form_copy_link";return i&&e.isFormPublished(i,a)?y({},t,{icon:s}):y({},t,{icon:s,disabled:!0,disabledTip:""});case"statistics":var s="form_statistics";return a!==p.a.V2?y({},t,{icon:s,hidden:!0}):i?n(i,a)?y({},t,{icon:s}):y({},t,{icon:s,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):y({},t,{icon:s,disabled:!0,disabledTip:""});default:return Object(d.a)(u)}}(t,u,c)}).map(function(t,e){return t.hidden?[]:[s.a.createElement("div",{className:"tooltip--docker",key:e},s.a.createElement(f.e,{icon:t.icon,text:t.display,disabled:t.disabled&&"fake",onTap:function(){return i.onSelectMenuItem(t)}}),t.disabled&&t.disabledTip&&s.a.createElement(f.k,{option:t.disabledTip,direction:"left"})),"divider"===t.type&&s.a.createElement(f.d,{key:"d"+e})].filter(Boolean)}),h=(t=[]).concat.apply(t,l);return s.a.createElement(f.h,{tabName:function(){return o()("表单")},onOpen:this.onMenuOpen},function(){return h})},a}(s.a.Component)}}};var n=r(3),o=r.n(n),i=r(428),a=(r.n(i),r(1)),u=(r.n(a),r(0)),s=r.n(u),c=r(1033),f=r(35),l=r(600),p=r(630),d=r(631),h=r(544),v=r(1035),m=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},b=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},g=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},w=a.sheets.Events,_=a.sheets.menu.getModel},function(t,e,r){"use strict";var n,o=r(124),i=(r.n(o),r(1034),function(){});(n=i).track=i,n.loadingStatusTrack=i,n.exportTrack=i,n.editTrack=i,n.editErrorTrack=i,n.trackSetFormula=i,e.a=n},function(t,e,r){"use strict"},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return i});var n,o=r(1);r.n(o);!function(t){t.create_from_desktop="create_from_desktop",t.create_from_header="create_from_header",t.create_from_sheets="create_from_sheets",t.add_text="add_text",t.add_multiple_text="add_multiple_text",t.add_single_choice="add_single_choice",t.add_multiple_choice="add_multiple_choice",t.add_dropdown_list="add_dropdown_list",t.response_expand_list="response_expand_list",t.response_create_sheet="response_create_sheet",t.response_view_in_sheets="response_view_in_sheets",t.response_unlink_forms="response_unlink_forms",t.stop_collect="stop_collect",t.preview="preview",t.publish="publish",t.publish_copy_url="publish_copy_url",t.publish_open_url="publish_open_url",t.publish_enable_deadline="publish_enable_deadline",t.publish_response_unlimited="publish_response_unlimited",t.publish_response_once="publish_response_once",t.publish_response_once_per_day="publish_response_once_per_day",t.sheet_edit_forms="sheet_edit_forms",t.sheet_view_response="sheet_view_response",t.sheet_view_statistics="sheet_view_statistics",t.sheet_copy_url="sheet_copy_url",t.sheet_unlink_form="sheet_unlink_form",t.sheet_unlink_forms_bottom="sheet_unlink_forms_bottom",t.sheet_delete_forms="sheet_delete_forms"}(n||(n={}));var i=function(t){try{if(!t)throw new TypeError("event is required");o.sheets.track.track("forms_click",{action:"click",object:t})}catch(t){console.error("[track]",t)}}}])});