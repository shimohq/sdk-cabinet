!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://assets.smcdn.cn/sheet/",r(r.s=1475)}([function(t,e){t.exports=React},function(t,e,r){"use strict";var n=function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,u)}s((n=n.apply(t,e||[])).next())})},i=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)n[o]=i[a];return n};Object.defineProperty(e,"__esModule",{value:!0});var u=r(18),s=r(38),c={},l=function(t){return c[t]||(c[t]=d()),c[t]};e.getS18n=l;var f=function(){c={}};e.DEBUG_reset=f;var p=function(){return c};e.DEBUG_getInstances=p;var d=function(){var t,e,r="zh-CN",c="zh-CN",d={},h=function(t,e){if(!u.isValidLocaleResource(e))throw new Error("fetched locale resource is invalid");d[t]=n(n({},d[t]||{}),e)},v=function(t,r){return o(void 0,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return!r&&d[t]?[3,2]:e?[4,e(t)]:[3,2];case 1:n=o.sent(),h(t,n),o.label=2;case 2:return[2]}})})},y=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("string"==typeof t[0]){var n=t[0],o=t[1],i=o&&"string"==typeof o._?o._:void 0,u=i?n+"#"+i:n;if(!u)return"";var l=s.getTextResult(u,d[r]);if("string"==typeof l)return l;var f=s.getTextResult(u,d[c]);return"string"==typeof f?f:n}if(t[0]&&"number"==typeof t[0].length){var p=t[0],h=t.slice(1);return s.getInterpolateResult(p,h,d[r])||s.getInterpolateResult(p,h,d[c])||s.interweave(p,h)}return console.warn.apply(console,a(["[s18n] invalid input:"],t)),""};return y.configure=function(r){if(r.fetchLocale){if("function"!=typeof r.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");e=r.fetchLocale}if(r.fetchLocaleSync){if("function"!=typeof r.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");t=r.fetchLocaleSync}},y.addLocaleResource=h,y.setLocaleAsync=function(t,e){return o(void 0,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:if("string"!=typeof t)throw new Error("'locale' is required");return[4,v(t)];case 1:return n.sent(),r=t,"string"==typeof e&&(v(e),c=e),[2]}})})},y.setLocaleSync=function(e){if("string"!=typeof e)throw new Error("'locale' is required");if(t){var n=t(e);h(e,n)}r=e},y.getLocale=function(){return r},y.DEBUG_getLocaleResources=function(){return d},y.getS18n=l,y.DEBUG_reset=f,y.DEBUG_getInstances=p,y},h=l("__default_namespace__");t.exports=h,e.default=h},function(t,e){t.exports=shimo.sdk.sheet},function(t,e){t.exports=ReactDOM},,,,,,,,function(t,e,r){"use strict";e.h=function(t){var e=document.createEvent("Event");e.initEvent("click",!0,!0),t.dispatchEvent(e)},e.e=function(t){return/^http:\/\//.test(t)},e.g=function(t,e){return new Array(e+1).join(t)},r.d(e,"d",function(){return i}),r.d(e,"c",function(){return a}),r.d(e,"f",function(){return u}),e.b=function(t,e){var r="";if(t&&e){var n=e.permissions.query.shimo.getFilePermission(),i=!n||n.permissions.editable,a=!n||n.permissions.commentable;i||(r=a?o()("只评模式下不可使用"):o()("只读模式下不可使用"))}return r},e.a=function(t){var e=s.get(t);if(null!=e)return e;var r=document.createElement("canvas").getContext("2d");r.font="bold 12px Arial";var n=r.measureText(t).width+28,o=Math.ceil(n);return s.set(t,o),o};var n=r(1),o=r.n(n);var i="ActiveXObject"in window,a=window.navigator.userAgent.indexOf("Edge")>-1,u=window.navigator.userAgent.indexOf("Windows")>-1;var s=new Map},,,,,,,function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(37);e.isValidLocaleResource=function(t){return!!t&&(!Array.isArray(t)&&("object"===(void 0===t?"undefined":n(t))&&Object.keys(t).every(function(e){var r=t[e];return null==r||"string"==typeof r||"object"===(void 0===r?"undefined":n(r))})))},e.sourceTextToKey=function(t){switch(t.type){case"string":var e=t.id,r=t.text;return e?r+"#"+e:r;case"interpolated":var n=t.textParts.length;return 1===n?t.textParts[0]:2===n?t.textParts[0]+"%s"+t.textParts[1]:t.textParts.map(function(e,r){return r===t.textParts.length-1?e:e+"%"+(r+1)}).join("");default:return o.assertNever(t)}}},,,function(t,e,r){var n;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var r={}.hasOwnProperty;function o(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var i=typeof n;if("string"===i||"number"===i)t.push(n);else if(Array.isArray(n)&&n.length){var a=o.apply(null,n);a&&t.push(a)}else if("object"===i)for(var u in n)r.call(n,u)&&n[u]&&t.push(u)}}return t.join(" ")}void 0!==t&&t.exports?(o.default=o,t.exports=o):void 0===(n=function(){return o}.apply(e,[]))||(t.exports=n)}()},,function(t,e,r){"use strict";var n=r(255),o=r(325),i=Object.prototype.toString;function a(t){return"[object Array]"===i.call(t)}function u(t){return null!==t&&"object"==typeof t}function s(t){return"[object Function]"===i.call(t)}function c(t,e){if(null!==t&&void 0!==t)if("object"!=typeof t&&(t=[t]),a(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.call(null,t[o],o,t)}t.exports={isArray:a,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:o,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:u,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:s,isStream:function(t){return u(t)&&s(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function t(){var e={};function r(r,n){"object"==typeof e[n]&&"object"==typeof r?e[n]=t(e[n],r):e[n]=r}for(var n=0,o=arguments.length;n<o;n++)c(arguments[n],r);return e},extend:function(t,e,r){return c(e,function(e,o){t[o]=r&&"function"==typeof e?n(e,r):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var o=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(n),i=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[r].concat(i).concat([o]).join("\n")}return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r}).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(n[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),e.push(a))}},e}},function(t,e,r){var n={},o=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),i=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var r=function(t){return document.querySelector(t)}.call(this,t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),a=null,u=0,s=[],c=r(91);function l(t,e){for(var r=0;r<t.length;r++){var o=t[r],i=n[o.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](o.parts[a]);for(;a<o.parts.length;a++)i.parts.push(y(o.parts[a],e))}else{var u=[];for(a=0;a<o.parts.length;a++)u.push(y(o.parts[a],e));n[o.id]={id:o.id,refs:1,parts:u}}}}function f(t,e){for(var r=[],n={},o=0;o<t.length;o++){var i=t[o],a=e.base?i[0]+e.base:i[0],u={css:i[1],media:i[2],sourceMap:i[3]};n[a]?n[a].parts.push(u):r.push(n[a]={id:a,parts:[u]})}return r}function p(t,e){var r=i(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=s[s.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),s.push(e);else if("bottom"===t.insertAt)r.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=i(t.insertInto+" "+t.insertAt.before);r.insertBefore(e,o)}}function d(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=s.indexOf(t);e>=0&&s.splice(e,1)}function h(t){var e=document.createElement("style");return t.attrs.type="text/css",v(e,t.attrs),p(t,e),e}function v(t,e){Object.keys(e).forEach(function(r){t.setAttribute(r,e[r])})}function y(t,e){var r,n,o,i;if(e.transform&&t.css){if(!(i=e.transform(t.css)))return function(){};t.css=i}if(e.singleton){var s=u++;r=a||(a=h(e)),n=g.bind(null,r,s,!1),o=g.bind(null,r,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",v(e,t.attrs),p(t,e),e}(e),n=function(t,e,r){var n=r.css,o=r.sourceMap,i=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||i)&&(n=c(n));o&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([n],{type:"text/css"}),u=t.href;t.href=URL.createObjectURL(a),u&&URL.revokeObjectURL(u)}.bind(null,r,e),o=function(){d(r),r.href&&URL.revokeObjectURL(r.href)}):(r=h(e),n=function(t,e){var r=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}.bind(null,r),o=function(){d(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var r=f(t,e);return l(r,e),function(t){for(var o=[],i=0;i<r.length;i++){var a=r[i];(u=n[a.id]).refs--,o.push(u)}t&&l(f(t,e),e);for(i=0;i<o.length;i++){var u;if(0===(u=o[i]).refs){for(var s=0;s<u.parts.length;s++)u.parts[s]();delete n[u.id]}}}};var m=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}();function g(t,e,r,n){var o=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=m(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(3),a=r.n(i),u=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(t){function e(e){var r=t.call(this,e)||this;return r.direction="right",r.align="bottom",r.adjustStyle=function(){var t=r.props.className,e=window.innerHeight,n=window.innerWidth,o=r.refs.contentDom,i=o.getBoundingClientRect().width,a=r.props.itemDom.getBoundingClientRect(),u=a.bottom,s=a.left,c=a.right,l=a.top,f=document.querySelector(".tab-help").getBoundingClientRect().left,p=!!document.querySelector(".tab-help.menu__open"),d=t&&t.indexOf("tooltip")>-1,h={position:"fixed",left:p&&!d&&s<f?c-(c-s)/2:c,top:l,zIndex:1e3,overflowY:"auto"};d&&delete h.overflowY;var v=u-78,y=e-u-30,m=o.scrollHeight;m>y&&(m<v||y/e<.25?(h.maxHeight=v,h.top=u-Math.min(m,v),r.align="top"):h.maxHeight=y),n-c-i<50&&(h.left=s-i,r.direction="left"),r.setState({style:h})},r.state={style:null},r}return u(e,t),e.prototype.componentDidUpdate=function(t,e){this.props.showPopup&&!t.showPopup&&this.adjustStyle()},e.prototype.render=function(){var t=this.props,e=t.showPopup,r=t.className,n="menu--content menu--content__submenu";return r&&(n+=" "+r),n+="right"===this.direction?" submenu--right":" submenu--left",n+="bottom"===this.align?" submenu--bottom":" submenu--top",e?a.a.createPortal(o.a.createElement("div",{ref:"contentDom",className:n,style:this.state.style},this.props.children),document.getElementsByClassName("tabStrip")[0]):null},e}(o.a.Component);e.a=s},,,,,function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},,,function(t,e,r){"use strict";var n=r(132),o=r(133),i=r(134),a=r(135),u=r(136),s=r(137),c=r(60);r(27);r.d(e,"h",function(){return n.a}),r.d(e,"a",function(){return o.a}),r.d(e,"g",function(){return i.a}),r.d(e,"e",function(){return a.a}),r.d(e,"d",function(){return u.a}),r.d(e,"b",function(){return s.a}),r.d(e,"k",function(){return c.a});var l=r(138);r.d(e,"j",function(){return l.d}),r.d(e,"i",function(){return l.c}),r.d(e,"f",function(){return l.b}),r.d(e,"l",function(){return l.e}),r.d(e,"c",function(){return l.a})},,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertNever=function(t){throw new Error("unexpected type: "+JSON.stringify(t))}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(18);e.interweave=function(t,e){return t.map(function(r,n){return n===t.length-1?r:""+r+e[n]}).join("")},e.getTextResult=function(t,e){return e&&e[t]};var i=/%(s|\d)/g;e.getInterpolateResult=function(t,e,r){try{if(!r)return;var a=o.sourceTextToKey({type:"interpolated",textParts:t}),u=r[a];if(!u)return;var s={},c=0;a.replace(i,function(t){return s[t]=e[c],c+=1,t});return"string"==typeof u?function(t,e){return t.replace(i,function(r){return null!==e[r]?String(e[r]):(console.warn("[s18n] interpolation failed:",{str:t,valueMap:e}),r)})}(u,s):"object"===(void 0===u?"undefined":n(u))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(u))}catch(n){var l={parts:t,values:e,resource:r};return console.error("[s18n] error when translating: ",l),void console.error(n)}}},,,,,function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return a}),r.d(e,"c",function(){return u});var n,o=r(1),i=r.n(o);!function(t){t.edit="edit",t.insert="insert",t.format="format",t.data="data",t.view="view",t.form="form",t.plugins="plugins",t.help="help",t.formula="formula"}(n||(n={}));var a={edit:i()("编辑"),insert:i()("插入"),format:i()("格式"),data:i()("数据"),view:i()("视图"),form:i()("表单"),plugins:i()("插件"),help:i()("帮助")},u={form:2,plugins:1,help:-1}},,,,,,,,,,,,,,,function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(3),a=r.n(i),u=r(2),s=(r.n(u),r(84)),c=r(43),l=r(123),f=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),p=u.sheets.menu.MenuContext,d=function(t){function e(e){var r=t.call(this,e)||this;return r.direction="right",r.__onMouseHoverSearchResult=function(t,e){var n=!1,o=r.props.tab;n=o===c.b.help?r.state.open:t===o,r.setState({open:n,searchResultPath:e})},r.__onMouseLeaveSearchResult=function(){r.setState({open:r.state.open,searchResultPath:""})},r.toggleOpen=function(){r.setState({open:!r.state.open,style:null})},r.close=function(){r.setState({open:!1,style:null})},r.checkClick=function(t){var e=a.a.findDOMNode(r),n=t.target;!e.contains(n)&&r.state.open&&r.close()},r.adjustStyle=function(){var t=a.a.findDOMNode(r).lastElementChild.getBoundingClientRect(),e=t.top,n=t.bottom,o=t.right,i=t.width,u=t.left,s={},l=window.innerHeight-50;n>l&&(s.maxHeight=l-e,s.overflowY="auto");var f=document.querySelector(".tab-help.menu__open"),p=a.a.findDOMNode(r).querySelector(".dropMenuHead");f&&r.props.tab!==c.b.help&&!p?o>f.getBoundingClientRect().left&&u>i&&(r.direction="left"):r.direction="right";r.setState({style:s})},r.state={open:!1,style:null,searchResultPath:""},r}return f(e,t),e.prototype.componentDidMount=function(){this.bindClick(),l.b&&(l.b.on(s.a.ToggleMenuOpen,this.__onMouseHoverSearchResult),l.b.on(s.a.MouseLeaveSearchResult,this.__onMouseLeaveSearchResult))},e.prototype.componentDidUpdate=function(t,e){var r;(!this.state.open||e.open||this.state.style?!this.state.open&&e.open&&this.props.onClose&&this.props.onClose():(this.props.onOpen&&this.props.onOpen(),this.adjustStyle()),this.state.style)&&(null===(r=a.a.findDOMNode(this).querySelector(".menuItem--highlight"))||void 0===r||r.scrollIntoView(!1))},e.prototype.componentWillUnmount=function(){this.unbindClick(),l.b&&(l.b.off(s.a.ToggleMenuOpen,this.__onMouseHoverSearchResult),l.b.off(s.a.MouseLeaveSearchResult,this.__onMouseLeaveSearchResult))},e.prototype.render=function(){var t=this,e="menu "+(this.props.customClass?this.props.customClass:"")+" "+(this.state.open?"menu__open":"")+" "+(this.props.disabled?"disabled":""),r="right"===this.direction?"open--right":"open--left";return o.a.createElement(p.Provider,{value:{closeMenu:this.close,searchResultPath:this.state.searchResultPath}},o.a.createElement("div",{className:e,"data-smattr":this.props.smattr},o.a.cloneElement(this.props.head,{onClick:function(e){var r=t.props.head.props.onClick;r&&r(e),t.toggleOpen()}}),this.state.open&&o.a.createElement("div",{className:"menu--body "+r},o.a.createElement("div",{className:"menu--content",style:this.state.style},this.renderChildren()))))},e.prototype.bindClick=function(){document.addEventListener("click",this.checkClick,!1)},e.prototype.unbindClick=function(){document.removeEventListener("click",this.checkClick,!1)},e.prototype.renderChildren=function(){var t=this.props.children;if("function"==typeof t){if(t.cache)return t.cache;var e=t();return t.cache=e,e}return t},e}(o.a.Component);e.a=d},function(t,e,r){"use strict";e.a=function(t){return{background:'url("'+t+'") center no-repeat'}}},function(t,e,r){"use strict";e.a=function(t){return t.option?o.a.createElement("span",{className:"tooltip tooltip__"+(t.direction||"down"),style:t.style},o.a.createElement("span",null,t.option),t.detail&&o.a.createElement("br",null),t.detail&&o.a.createElement("span",null,t.detail)):null};var n=r(0),o=r.n(n)},,,,,,,,,,,function(t,e){t.exports=function(t){return"string"!=typeof t?t:(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)?'"'+t.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':t)}},,,,,,,,,,,,,function(t,e,r){"use strict";var n;!function(t){t.ToolBarLayoutChanged="Toolbar:ToolBarLayoutChanged",t.ToolBarMenuLayoutChanged="Toolbar:ToolBarMenuLayoutChanged",t.SelectionChanged="Toolbar:SelectionChanged",t.PermissionChanged="Toolbar:PermissionChanged",t.StartInsertLink="Toolbar:StartInsertLink",t.PaintBrushSelected="Toolbar:PaintBrushSelected",t.FrozenChanged="Toolbar:FrozenChanged",t.FilterChanged="Toolbar:FilterChanged",t.ToggleMenuOpen="Toolbar:ToggleMenuOpen",t.MouseLeaveSearchResult="Toolbar:MouseLeaveSearchResult"}(n||(n={})),e.a=n},,,,,,,function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,n=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var o,i=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?t:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?r+i:n+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n;r.d(e,"b",function(){return n}),e.a=function(t){n=t}},,,,,,,,,function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(58),a=r(11),u=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(t){function e(e){var r=t.call(this,e)||this;return r.onOpen=function(t){r.props.onOpen&&r.props.onOpen(),t&&(t.markAsOld(),r.forceUpdate())},r}return u(e,t),e.prototype.render=function(){var t=function(t){return t?(t instanceof Array?t:[t]).find(function(t){return t.visible}):void 0}(this.props.feature),e=t&&t.tooltip,r=this.props.tabName(),n=Object(a.a)(r);return o.a.createElement(i.a,{head:o.a.createElement("span",{className:"tabMenuHead",style:{width:n}},r,e),customClass:"tabMenu tab-"+this.props.tab,smattr:this.props.smattr,disabled:this.props.disabled,onOpen:this.onOpen.bind(this,t),editor:this.props.editor,tab:this.props.tab},this.props.children)},e.compName="TabMenu",e}(o.a.Component);e.a=s},function(t,e,r){"use strict";e.a=function(t){return o.a.createElement(i.a,{head:o.a.cloneElement(t.head,{className:"dropMenuHead indicator "+(t.head.props.className||"")}),disabled:t.disabled,customClass:t.customClass,onClose:t.onClose,onOpen:t.onOpen,smattr:t.smattr},t.children)};var n=r(0),o=r.n(n),i=r(58)},function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(11),a=r(2),u=(r.n(a),r(27)),s=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c=a.sheets.menu.MenuContext,l=function(t){function e(e){var r=t.call(this,e)||this;return r.showSubMenu=function(){!r.props.disabled&&r.setState({showSubMenu:!0})},r.hideSubMenu=function(){r.setState({showSubMenu:!1})},r.state={showSubMenu:!1},r}return s(e,t),e.prototype.render=function(){this.checkShowSubStatus();var t=this.props,e=t.editor,r=t.disabled,n=Object(i.b)(!!r,e),a=this.context.searchResultPath.split("->").indexOf(this.props.text)>-1?"menuItem--highlight":"",s=this.state.showSubMenu;return o.a.createElement("div",{ref:"containerDom",className:"menu--submenu",onMouseLeave:this.hideSubMenu},o.a.createElement("div",{ref:"itemDom",className:"menuItem "+(this.props.disabled?"disabled":"")+" "+a,onMouseEnter:this.showSubMenu},void 0!==this.props.icon&&o.a.createElement("span",{className:"menuItem--icon "+(this.props.icon?"icon--"+this.props.icon:"")}),o.a.createElement("span",{className:"menuItem--text"},this.props.text),o.a.createElement("span",{className:"menuItem--placer"}),o.a.createElement("span",{className:"menuItem--arrow"})),o.a.createElement(u.a,{showPopup:s,itemDom:this.refs.itemDom},this.props.children),n)},e.prototype.checkShowSubStatus=function(){if(!!this.context.searchResultPath&&!!this.context.searchResultPath.length){var t=this.context.searchResultPath.split("->"),e=t.indexOf(this.props.text),r=e>-1&&e<t.length-1;this.state.showSubMenu!==r&&this.setState({showSubMenu:r})}},e.compName="SubMenu",e}(o.a.Component);e.a=l,l.contextType=c},function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(3),a=r.n(i),u=r(59),s=r(11),c=r(2),l=(r.n(c),r(27)),f=r(60),p=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d=c.sheets.menu.MenuContext,h=function(t){function e(e){var r=t.call(this,e)||this;return r.hideTooltip=function(){r.setState({showTooltip:!1})},r.showTooltip=function(){r.setState({showTooltip:!0})},r.state={showTooltip:!1,showHighlight:!1},r}return p(e,t),e.prototype.render=function(){var t=this,e=this.props,r=e.disabled,n=e.customClass,i=e.active,a="fake"===r?"fakeDisabled":r?"disabled":"",u=n||"",s=this.props.className||"",c=this.props.isSearchItem?"item--search-result":"",l=i?"active":"";return o.a.createElement(d.Consumer,null,function(e){return o.a.createElement("div",{className:"menuItem tooltip--docker "+a+" "+u+" "+s+" "+function(e){var r,n=e.searchResultPath.split("->"),o=t.props.searchDisplay||t.props.text;return(null===(r=o)||void 0===r?void 0:r.length)&&n[n.length-1]===o&&!t.props.isSearchItem?"menuItem--highlight":""}(e)+" "+l+" "+c,onClick:function(r){return t.onClick(r,e)},"data-smattr":t.props.smattr,onMouseLeave:t.hideTooltip,onMouseEnter:t.showTooltip},void 0!==t.props.checked&&o.a.createElement("span",{className:"menuItem--check "+(t.props.checked?"menuItem--check__checked":"")}),void 0!==t.props.icon&&t.getIcon(t.props.icon),t.props.text&&o.a.createElement("span",{className:"menuItem--text"},t.props.text),t.props.showEnterpriseLabel&&!1,t.props.text&&!s.includes("fontDisplayImg")&&o.a.createElement("span",{className:"menuItem--placer"}),t.props.children,t.MenuTip)})},e.prototype.componentDidMount=function(){this.scrollHighlightItem()},e.prototype.componentDidUpdate=function(){this.scrollHighlightItem()},e.prototype.scrollHighlightItem=function(){var t=a.a.findDOMNode(this);t&&t.classList.contains("menuItem--highlight")&&setTimeout(function(){t.scrollIntoView(!1)})},Object.defineProperty(e.prototype,"MenuTip",{get:function(){var t=this.props,e=t.disabled,r=t.editor,n=t.tip,i=this.state.showTooltip,u=Object(s.b)(!!e,r)||n,c="string"==typeof u;return u?o.a.createElement(l.a,{showPopup:i,itemDom:a.a.findDOMNode(this),className:"menu--tooltip-popup"+(c?" normal--tip":"")},c?o.a.createElement("div",{className:"menu-normal-tip-wrapper",style:{position:"relative",display:"flex",alignItems:"center"}},o.a.createElement(f.a,{option:u,direction:"right"})):u):null},enumerable:!0,configurable:!0}),e.prototype.onClick=function(t,e){!this.props.disabled&&this.props.onTap&&this.props.onTap(t),this.props.stopPropagation||setTimeout(function(){return e.closeMenu()})},e.prototype.getIcon=function(t){return Object(s.e)(t)?o.a.createElement("span",{className:"menuItem--icon",style:Object(u.a)(t)}):o.a.createElement("span",{className:"menuItem--icon "+(t?"icon--"+t:"")})},e.compName="MenuItem",e}(o.a.Component);e.a=h,h.contextType=d},function(t,e,r){"use strict";e.a=function(){return o.a.createElement("div",{className:"menu--divider"})};var n=r(0),o=r.n(n)},function(t,e,r){"use strict";var n=r(0),o=r.n(n),i=r(11),a=r(59),u=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onTap=function(){e.props.onTap&&e.props.onTap()},e}return u(e,t),e.prototype.render=function(){var t="toolBar--iconBtn "+(this.props.disabled?"disabled":"")+" "+(this.props.selected?"selected":"")+" indicator";return this.props.children?o.a.createElement("span",{className:t+" tooltip--docker",onClick:this.onTap,"data-smattr":this.props.smattr},this.getIcon(this.props.icon)):this.props.tooltip?o.a.createElement("span",{className:t,"data-tooltip":this.props.tooltip,onClick:this.onTap,"data-smattr":this.props.smattr},this.getIcon(this.props.icon)):o.a.createElement("span",{className:t,onClick:this.onTap,"data-smattr":this.props.smattr},this.getIcon(this.props.icon))},e.prototype.getIcon=function(t){return Object(i.e)(t)?o.a.createElement("span",{style:Object(a.a)(t)},this.props.children):o.a.createElement("span",{className:"toolBar--icon icon--"+t},this.props.children)},e}(o.a.Component);e.a=s},function(t,e,r){"use strict";e.d=function(t){return o.a.createElement("span",{className:c(t,"toolBar--tool")},t.children)},r.d(e,"c",function(){return l}),e.a=function(t){return o.a.createElement("span",{className:c(t,"toolBar--iconDropTool indicator "+(t.selected?"fakeIndicator":""))},t.children)},e.b=function(t){return o.a.createElement("span",{className:c(t,"toolBar--tool toolBar--tool__oneline")},t.children)},e.e=function(t){return o.a.createElement("span",{className:c(t,"toolBar--tool toolBar--tool__twolines")},t.children)};var n=r(0),o=r.n(n),i=r(11),a=r(21),u=r.n(a),s=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();function c(t,e){var r,n=t.disabled,o=t.customClass;return u()(((r={})[e]=!0,r[o||""]=o,r.disabled=n,r))}var l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delegateClick=function(t){var r=e.refs.textTool,n=r.lastElementChild;if(t.target===r||t.target===n){var o=r.querySelector(".toolBar--icon");setTimeout(function(){return Object(i.h)(o)})}},e}return s(e,t),e.prototype.render=function(){return o.a.createElement("span",{ref:"textTool",className:c(this.props,"toolBar--tool toolBar--textTool"),onClick:this.delegateClick},this.props.children)},e}(o.a.Component)},,,,,,function(t,e){t.exports=Zepto},,,,function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isRetina=function(){return window.devicePixelRatio>=2},e.isDingTalk=function(){return/dingtalk/i.test(r)},e.isDingtalk=function(){return!!r.match(/mobile.*dingtalk/i)},e.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},e.isWechatPc=n,e.isWxworkPc=o,e.isWechat=function(){return!!/micromessenger/.test(r)&&!n()},e.isMobile=function(){return!n()&&!o()&&!!r.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},e.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},e.isIOS=i,e.isAndroid=function(){return!!/(android)/g.test(r)},e.isAndroidApp=function(){return!!/shimo-android-app/g.test(r)},e.isIE=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},e.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},e.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},e.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},e.isWebIOS=function(){if(!window.cow.iOS&&i())return!0;return!1},e.isIphone6=function(){var t=!1;i()&&screen.height>568&&(t=!0);return t},e.isInWxMp=function(){return!(!navigator.userAgent.match(/micromessenger/i)||!navigator.userAgent.match(/miniprogram/i))||"miniprogram"===window.__wxjs_environment};var r=window.navigator.userAgent.toLowerCase();function n(){return!!/micromessenger.*?windowswechat/.test(r)}function o(){return!!/wxwork.*?micromessenger.*?wechat/i.test(r)}function i(){return!!/(ipad|iphone|ipod)/g.test(r)}},,,,,,,,,,,,function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o=r(475);e.clone=function(t){return"object"!=typeof t||null===t?t:o(t,function(t){if("object"==typeof t&&t&&"function"==typeof t.clone)return t.clone()})},e.freeze=function(t){return t},e.isFrozen=function(t){return!1};var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ops=e,this.index=0,this.offset=0}return n(t,[{key:"hasNext",value:function(){return this.peekLength()<1/0}},{key:"next",value:function(t){t||(t=1/0);var e=this.ops[this.index];if(!e)return null;var r=this.offset,n=e.length;if(0===r&&n===t)return this.index+=1,e;t>=n-r?(t=n-r,this.index+=1,this.offset=0):this.offset+=t;var o={action:e.action,attributes:e.attributes};switch(e.action){case"remove":o.data=t;break;case"retain":if("number"==typeof e.data)o.data=t;else{if("string"==typeof e.data)throw new Error("retain with a string is not allowed");o.data=e.data}break;case"insert":"string"==typeof e.data?o.data=e.data.substr(r,t):"number"==typeof e.data?o.data=t:o.data=e.data}return e.createInstance(o)}},{key:"peekLength",value:function(){var t=this.ops[this.index];return t?t.length-this.offset:1/0}},{key:"peekAction",value:function(){var t=this.ops[this.index];return t?t.action:"retain"}}]),t}();e.OperatorIterator=i,e.parsePosition=function(t){for(var e=0,r=0,n=0;n<t.length;n++){var o=t[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+t);e=10*e+o-48}}return{row:e-1,col:r-1}},e.stringifyPosition=function(t,e){if(!(t>=0&&e>=0))throw new Error("Invalid cell position "+t+":"+e);for(var r=e+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(t+1)}},,,,,,,,,,function(t,e){var r,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function u(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var s,c=[],l=!1,f=-1;function p(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&d())}function d(){if(!l){var t=u(p);l=!0;for(var e=c.length;e;){for(s=c,c=[];++f<e;)s&&s[f].run();f=-1,e=c.length}s=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new h(t,e)),1!==c.length||l||u(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},,,,,,,,function(t,e,r){"use strict";var n=function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},i=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(1027),u=r(1604),s={},c=function(t){return s[t]||(s[t]=p()),s[t]};e.getS18n=c;var l=function(){s={}};e.DEBUG_reset=l;var f=function(){return s};e.DEBUG_getInstances=f;var p=function(){var t,e,r="zh-CN",s="zh-CN",p={},d=function(t,e){if(!a.isValidLocaleResource(e))throw new Error("fetched locale resource is invalid");p[t]=n({},p[t]||{},e)},h=function(t,r){return o(void 0,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return!r&&p[t]?[3,2]:e?[4,e(t)]:[3,2];case 1:n=o.sent(),d(t,n),o.label=2;case 2:return[2]}})})},v=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("string"==typeof t[0]){var n=t[0],o=t[1],i=o&&"string"==typeof o._?o._:void 0,a=i?n+"#"+i:n;if(!a)return"";var c=u.getTextResult(a,p[r]);if("string"==typeof c)return c;var l=u.getTextResult(a,p[s]);return"string"==typeof l?l:n}if(t[0]&&"number"==typeof t[0].length){var f=t[0],d=t.slice(1);return u.getInterpolateResult(f,d,p[r])||u.getInterpolateResult(f,d,p[s])||u.interweave(f,d)}return console.warn.apply(console,["[s18n] invalid input:"].concat(t)),""};return v.configure=function(r){if(r.fetchLocale){if("function"!=typeof r.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");e=r.fetchLocale}if(r.fetchLocaleSync){if("function"!=typeof r.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");t=r.fetchLocaleSync}},v.addLocaleResource=d,v.setLocaleAsync=function(t,e){return o(void 0,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:if("string"!=typeof t)throw new Error("'locale' is required");return[4,h(t)];case 1:return n.sent(),r=t,"string"==typeof e&&(h(e),s=e),[2]}})})},v.setLocaleSync=function(e){if("string"!=typeof e)throw new Error("'locale' is required");if(t){var n=t(e);d(e,n)}r=e},v.getLocale=function(){return r},v.DEBUG_getLocaleResources=function(){return p},v.getS18n=c,v.DEBUG_reset=l,v.DEBUG_getInstances=f,v},d=c("__default_namespace__");t.exports=d,e.default=d},,,function(t,e,r){"use strict";(function(e){var n=r(23),o=r(327),i={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var u={adapter:function(){var t;return"undefined"!=typeof XMLHttpRequest?t=r(256):void 0!==e&&(t=r(256)),t}(),transformRequest:[function(t,e){return o(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],function(t){u.headers[t]={}}),n.forEach(["post","put","patch"],function(t){u.headers[t]=n.merge(i)}),t.exports=u}).call(e,r(170))},function(t,e,r){"use strict";var n=r(343),o="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),i=Object.prototype.toString,a=Array.prototype.concat,u=Object.defineProperty,s=u&&function(){var t={};try{for(var e in u(t,"x",{enumerable:!1,value:t}),t)return!1;return t.x===t}catch(t){return!1}}(),c=function(t,e,r,n){(!(e in t)||function(t){return"function"==typeof t&&"[object Function]"===i.call(t)}(n)&&n())&&(s?u(t,e,{configurable:!0,enumerable:!1,value:r,writable:!0}):t[e]=r)},l=function(t,e){var r=arguments.length>2?arguments[2]:{},i=n(e);o&&(i=a.call(i,Object.getOwnPropertySymbols(e)));for(var u=0;u<i.length;u+=1)c(t,i[u],e[i[u]],r[i[u]])};l.supportsDescriptors=!!s,t.exports=l},,,,,,,,,function(t,e,r){var n=r(535),o=r(317),i=r(763),a=r(441).f;t.exports=function(t){var e=n.Symbol||(n.Symbol={});o(e,t)||a(e,t,{value:i.f(t)})}},,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=[{name:"color"},{name:"background"},{name:"font-size"},{name:"width"},{name:"height"},{name:"rowspan"},{name:"colspan"},{name:"align",values:["left","center","right","justify"]},{name:"bold",values:[!1,!0]},{name:"italic",values:[!1,!0]},{name:"underline",values:[!1,!0]},{name:"vertical",values:["top","middle","bottom"]},{name:"strike",values:[!1,!0]},{name:"wrap",values:["text-wrap","text-no-wrap","text-linebreak-overflow"]},{name:"fixedRowsTop"},{name:"fixedColumnsLeft"},{name:"link"},{name:"format",values:["normal","0,0","0,0.00","0%","0.00%","0.00E+00","(0,0)","(0,0.00)","¥0,0","¥0,0.00","$0,0","$0,0.00","YYYY/MM/DD","YYYY-MM-DD","HH:mm:ss","YYYY/MM/DD HH:mm:ss","¥ (#,##0)","¥ (#,##0.00)","@","#,##0.0_);[Red](#,##0.0)","#,##0.0_);(#,##0.0)","#,##0.0;[Red]#,##0.0","#,##0.0_ ","#,##0.0_ ;[Red]-#,##0.0 ","#,##0_);[Red](#,##0)","#,##0_);(#,##0)","#,##0;[Red]#,##0","#,##0_ ","#,##0_ ;[Red]-#,##0 ","0.0_);[Red](0.0)","0.0_);(0.0)","0.0;[Red]0.0","0.0_ ","0.0_ ;[Red]-0.0 ","0_);[Red](0)","0_);(0)","0;[Red]0","0_ ","0_ ;[Red]-0 ","0.0%",'"$"#,##0.0_);[Red]("$"#,##0.0)','"¥"#,##0.0_);[Red]("¥"#,##0.0)','"$"#,##0.0_);("$"#,##0.0)','"¥"#,##0.0_);("¥"#,##0.0)','"$"#,##0.0;[Red]"$"#,##0.0','"¥"#,##0.0;[Red]"¥"#,##0.0','"$"#,##0.0','"¥"#,##0.0','"$"#,##0.0;[Red]-"$"#,##0.0','"¥"#,##0.0;[Red]-"¥"#,##0.0','"$"#,##0_);[Red]("$"#,##0)','"¥"#,##0_);[Red]("¥"#,##0)','"$"#,##0_);("$"#,##0)','"¥"#,##0_);("¥"#,##0)','"$"#,##0;[Red]"$"#,##0','"¥"#,##0;[Red]"¥"#,##0','"$"#,##0','"¥"#,##0','"$"#,##0;[Red]-"$"#,##0','"¥"#,##0;[Red]-"¥"#,##0','_("$"* #,##0.0_);_("$"* (#,##0.0);_("$"* "-"??_);_(@_)','_("¥"* #,##0.0_);_("¥"* (#,##0.0);_("¥"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)','_("¥"* #,##0_);_("¥"* (#,##0);_("¥"* "-"_);_(@_)',"yyyy/m/d","yyyy/mm/dd;@","yyyy-mm-dd;@","yy/mm/dd;@","yy-mm-dd;@","mm/dd;@","mm-dd;@","yyyy-m-d;@","yy/m/d;@","yy-m-d;@","m/d;@","m-d;@","m/d/yy;@","mm/dd/yy;@","d;@","dd;@",'yyyy"年"m"月"d"日" aaaa','yyyy"年"m"月"d"日";@','yyyy"年"m"月";@','m"月"d"日";@','[$-804]yyyy"年"mm"月"dd"日" aaaa;@','yyyy"年"mm"月"dd"日";@','yyyy"年"mm"月";@','mm"月"dd"日";@','m"月";@','mm"月";@','[DBNum1][$-804]m"月";@',"[$-804]aaaa;@","[$-804]aaa;@",'[DBNum1][$-804]yyyy"年"m"月"d"日";@','[DBNum1][$-804]yyyy"年"m"月";@','[DBNum1][$-804]m"月"d"日";@',"[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@","[$-409]yyyy/mm/dd h:mm AM/PM;@","yyyy/mm/dd hh:mm;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","[$-409]yyyy/mm/dd h:mm:ss AM/PM;@","yyyy/mm/dd hh:mm:ss;@","[$-409]yyyy/m/d h:mm:ss AM/PM;@","yyyy/m/d h:mm:ss;@","h:mm:ss;@","h:mm;@","AM/PM h:mm:ss",'上午/下午h"时"mm"分"ss"秒";@','上午/下午h"时"mm"分";@','[DBNum1][$-804]h"时"mm"分";@','[DBNum1][$-804]上午/下午h"时"mm"分";@',"[$-409]h:mm AM/PM;@","[$-409]h:mm:ss AM/PM;@",'h"时"mm"分";@','h"时"mm"分"ss"秒";@',"# ?/?","# ??/??","# ???/???","# ?/2","# ?/4","# ?/8","# ??/16","# ?/10","# ??/100","0.0E+00","0E+00","000000","[DBNum1][$-804]General","[DBNum2][$-804]General"]},{name:"formula"},{name:"filter"},{name:"border-top"},{name:"border-right"},{name:"border-bottom"},{name:"border-left"},{name:"line"},{name:"guid"},{name:"author"},{name:"size"},{name:"list"},{name:"layout",values:["embed","block"]},{name:"margin",values:["none","small","medium","large"]},{name:"font",values:["serif","monospace","microsoftyahei","simsun","kaiti","simhei","fangsong","droid","source","arial"]},{name:"header"},{name:"indent"},{name:"comment"},{name:"comment-block"},{name:"code-block",values:[!0]},{name:"cellValue"},{name:"precision"},{name:"autoFormatter",values:["#,##0_);[Red](#,##0)","#,##0.00_);[Red](#,##0.00)",'"¥"#,##0_);[Red]("¥"#,##0)','"¥"#,##0.00_);[Red]("¥"#,##0.00)','"$"#,##0_);[Red]("$"#,##0)','"$"#,##0.00_);[Red]("$"#,##0.00)',"0%","0.00%","# ??/??","0.00E+00","yyyy/m/d",'m"月"d"日";@','yyyy"年"m"月"d"日";@','yyyy"年"m"月";@',"[$-409]yyyy/mm/dd h:mm:ss AM/PM;@","[$-409]yyyy/mm/dd h:mm AM/PM;@","yyyy/mm/dd hh:mm:ss;@","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@",'h"时"mm"分";@','h"时"mm"分"ss"秒";@','[$-804]AM/PMh"时"mm"分";@','[$-804]AM/PMh"时"mm"分"ss"秒";@',"[$-409]mmm-yy;@","h:mm:ss.0;@","[$-409]h:mm:ss.0 AM/PM;@","yyyy/mm/dd hh:mm;@","yyyy/mm/dd hh:mm:ss.0;@","yyyy/m;@"]}],i=o.reduce(function(t,e,r){return e.index=r,t[e.name]=e,t},{});t.exports={pack:function(t){if("object"==typeof t&&null!==t){var e=[];for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];if(void 0!==n){var o=i[r];if(o&&(r=o.index,o.values&&null!==n)){var a=o.values.indexOf(n);if(-1!==a)n=a;else if(17!==r)continue}e.push(null===n?r:r+":"+JSON.stringify("string"==typeof n?encodeURIComponent(n):n))}}return e.sort().join("|")}},unpack:function(t){if("string"!=typeof t)return{};for(var e={},r=t.split("|"),i=0;i<r.length;i++){var a=r[i].split(":"),u=n(a,2),s=u[0],c=u[1],l=o[s];if(c){var f=typeof(c=JSON.parse(c));"string"===f&&(c=decodeURIComponent(c)),l&&(s=l.name,l.values&&"number"===f&&void 0!==l.values[c]&&(c=l.values[c]))}else l&&(s=l.name),c=null;e[s]=c}return e},merge:function(t,e,r){if(r&&!t)return e;if(!e)return t;for(var n in t=this.unpack(t),e=this.unpack(e))e.hasOwnProperty(n)&&(t[n]=e[n],r||null!==t[n]||delete t[n]);return this.pack(t)},invert:function(t,e){if(e){if(!t)return e.split("|").map(function(t){var e=t.indexOf(":");return-1===e?t:t.slice(0,e)}).join("|");for(var r in t=this.unpack(t),e=this.unpack(e))e.hasOwnProperty(r)&&(void 0!==t[r]?e[r]=t[r]:e[r]=null);return this.pack(e)}},transform:function(t,e,r){if(r)return e;if(e){if(!t)return e;for(var n in t=this.unpack(t),e=this.unpack(e))e.hasOwnProperty(n)&&void 0!==t[n]&&delete e[n];return this.pack(e)}},diff:function(t,e){if(!t)return e;t=this.unpack(t),e&&(e=this.unpack(e));for(var r={},n=!0,o=e?Object.keys(t).concat(Object.keys(e)):Object.keys(t),i=0;i<o.length;i++){var a=o[i],u=e?e[a]:void 0;t[a]!==u&&(n=!1,r[a]=void 0===u?null:u)}return n?void 0:this.pack(r)}}},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o=r(160),i=r(476),a=r(477),u=String.fromCharCode(0),s=r(216),c=r(490),l=function(){function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ops=[],Array.isArray(e)){for(var n=0;n<e.length;n++)this.pushWithMutations(e[n]);r&&this.chopWithMutations()}else"function"==typeof e&&e(this);o.freeze(this)}return n(t,[{key:"freeze",value:function(){o.freeze(this.ops)}},{key:"createCleaner",value:function(){for(var e=[],r=0;r<this.ops.length;r++){var n=this.ops[r],o=n.createInstance({action:"remove",data:n.length});e.push(o)}return new t(e)}},{key:"clone",value:function(){return new t(this.ops.map(o.clone))}},{key:"toJSON",value:function(){return this.ops}},{key:"pack",value:function(){return this.ops.map(function(t){return t.pack()})}},{key:"isDocument",value:function(){for(var t=0;t<this.ops.length;t++)if("insert"!==this.ops[t].action)return!1;return!0}},{key:"isEmpty",value:function(){return 0===this.ops.length}},{key:"_genericPush",value:function(t,e){var r=t.length,n=t[r-1];if(n&&"remove"===n.action&&"insert"===e.action&&(n=t[(r-=1)-1]),!n)return t.unshift(e),t;var o=e.merge(n);return o?t[r-1]=o:r===t.length?t.push(e):t.splice(r,0,e),t}},{key:"push",value:function(e){if(!e.length)return this;var r=this.ops.slice(0);if(Array.isArray(e)){for(var n=!1,o=0;o<e.length;o++)e[o].length&&(n=!0,r=this._genericPush(r,e[o]));if(!n)return this}else r=this._genericPush(r,e);return new t(r)}},{key:"pushWithMutations",value:function(t){return t.length&&this._genericPush(this.ops,t),this}},{key:"concat",value:function(e){var r=this;return e.ops.length?this.ops.length?new t(function(t){t.ops=r.ops.slice(),t.pushWithMutations(e.ops[0]),e.ops.length>1&&(t.ops=t.ops.concat(e.ops.slice(1)))}):e:this}},{key:"_genericChop",value:function(t){for(;t.length&&t[t.length-1].isEmpty();)t.pop();return t}},{key:"chop",value:function(){return new t(this._genericChop(this.ops.slice(0)))}},{key:"chopWithMutations",value:function(){return this._genericChop(this.ops),this}},{key:"slice",value:function(e,r){e=e||0,"number"!=typeof r&&(r=1/0);for(var n=[],o=this.getIter(),i=0;i<r&&o.hasNext();){var a=void 0;i<e?a=o.next(e-i):(a=o.next(r-i),n.push(a)),i+=a.length}return new t(n)}},{key:"getIter",value:function(){return new o.OperatorIterator(this.ops)}},{key:"validate",value:function(){for(var t={},e=0;e<this.ops.length;e++){var r=this.ops[e];if(r&&"TableOperator"===r.name()){var n=r.getAttributes().name;if(!n)continue;var o="$$"+n+"$$";if(t.hasOwnProperty(o))throw new Error("Duplicated table name found: "+n);t[o]=!0}}return this}},{key:"isTableADocument",value:function(){for(var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=function(r){var n=t.ops[r];if(n&&"TableOperator"===n.name()&&n.data.cells.some(function(t){var e=n.data.cells.get(t);return!(!e.data||"number"==typeof e.data||"function"!=typeof e.data.isDocument)&&!1===e.data.isDocument()},e))return{v:!1}},n=0;n<this.ops.length;n++){var o=r(n);if("object"==typeof o)return o.v}return!0}},{key:"compose",value:function(e){for(var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getIter(),o=e.getIter(),i=[];n.hasNext()||o.hasNext();)if("insert"===o.peekAction())i.push(o.next());else if("remove"===n.peekAction())i.push(n.next());else{var a=Math.min(n.peekLength(),o.peekLength()),u=n.next(a),s=o.next(a);s&&"retain"!==s.action?u&&"retain"!==u.action||i.push(s):u?s?i.push(u.compose(s,r)):i.push(u):i.push(s)}var c=new t(i,!0);return r||c.validate(),c}},{key:"composePosition",value:function(t){for(var e=this.getIter(),r=0;e.hasNext()&&r<=t;){var n=e.peekLength(),o=e.peekAction();switch(e.next(),o){case"remove":if(n>t-r)return null;t-=n;continue;case"insert":t+=n}r+=n}return t}},{key:"invert",value:function(e){for(var r=this.getIter(),n=e.getIter(),o=[];n.hasNext();)if("insert"===n.peekAction()){var i=n.next(),a=i.createInstance({action:"remove",data:i.length});o.push(a)}else{if(!r.hasNext())throw new Error(this.constructor.name+" should be smaller than document");var u=Math.min(r.peekLength(),n.peekLength()),s=r.next(u),c=n.next(u);if("insert"!==s.action)throw new Error("Only document can invert deltas");"retain"===c.action?o.push(s.invert(c)):o.push(s)}return new t(o,!0)}},{key:"invertPosition",value:function(t){for(var e=this.getIter(),r=0;e.hasNext()&&r<=t;){var n=e.peekLength(),o=e.peekAction();switch(e.next(),o){case"insert":if(n>t-r)return null;t-=n;continue;case"remove":t+=n}r+=n}return t}},{key:"transform",value:function(e,r){for(var n=this.getIter(),o=e.getIter(),i=[];o.hasNext();)if("insert"!==n.peekAction()||!r&&"insert"===o.peekAction())if("insert"===o.peekAction())i.push(o.next());else{var a=Math.min(n.peekLength(),o.peekLength()),u=n.next(a),s=o.next(a);if(u&&"remove"===u.action)continue;s&&"remove"===s.action?i.push(s):u?i.push(u.transform(s,r)):i.push(s)}else{var c=n.next();i.push(c.createInstance({action:"retain",data:c.length}))}return new t(i,!0)}},{key:"transformPosition",value:function(t,e){for(var r=this.getIter(),n=0;r.hasNext()&&n<=t;){var o=r.peekLength(),i=r.peekAction();switch(r.next(),i){case"remove":t-=Math.min(o,t-n);continue;case"insert":(n<t||!e)&&(t+=o)}n+=o}return t}},{key:"toString",value:function(){for(var t="",e=0;e<this.ops.length;e++){var r=this.ops[e];if("insert"!==r.action)throw new Error("toString() called on non-document");t+="string"==typeof r.data?r.data:u}return t}},{key:"diff",value:function(e,r){if(this.ops===e.ops)return new t;if(!this.ops.length){if(!e.isDocument())throw new Error("diff() called on non-document");return e}for(var n=c(this.ops[0].createInstance,this.ops[0]),o=[],u=i(this.toString(),e.toString(),r),l=this.getIter(),f=e.getIter(),p=0,d=u.length;p<d;p++)for(var h=u[p],v=h[1].length;v>0;){var y=0;switch(h[0]){case i.INSERT:y=Math.min(f.peekLength(),v),o.push(f.next(y));break;case i.DELETE:y=Math.min(v,l.peekLength()),l.next(y),o.push(n({action:"remove",data:y}));break;case i.EQUAL:y=Math.min(l.peekLength(),f.peekLength(),v);var m=l.next(y),g=f.next(y);m.skipDiff()&&g.skipDiff()&&m.name()===g.name()||a(m.data,g.data)?o.push(n({action:"retain",data:y,attributes:s.diff(m.attributes,g.attributes)})):(o.push(g),o.push(n({action:"remove",data:y})))}v-=y}return new t(o,!0)}},{key:"print",value:function(t){console[t?"group":"groupCollapsed"]("Delta["+this.length+"] with "+this.ops.length+" operators"),this.ops.forEach(function(t){return t.print()}),console.groupEnd()}},{key:"length",get:function(){for(var t=0,e=0;e<this.ops.length;e++)t+=this.ops[e].length;return t}}],[{key:"unpack",value:function(t){var e=this;return new this(t.map(function(t){return e.operatorUnpacker(t)}))}}]),t}();l.packId=5,t.exports=l},function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=r(217),a=r(160).clone,u=r(216),s=r(160),c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setWithMutations(e);var r="Operator"!==this.name()&&this.isGeneric()?this.toGeneric():this;return s.freeze(r),r}return o(t,[{key:"name",value:function(){return"Operator"}},{key:"skipDiff",value:function(){return!1}},{key:"isGeneric",value:function(){var t=4===this.constructor.packId;return"number"==typeof this.data&&!t}},{key:"toGeneric",value:function(){return new t({action:this.action,data:this.data,attributes:this.attributes})}},{key:"clone",value:function(){var t=this.createInstance(this);return t.data=a(t.data),t}},{key:"_genericSet",value:function(t){var e={action:this.action,data:this.data,attributes:this.attributes},r=!1,n=t.action;if(n&&n!==e.action){if(r=!0,"insert"!==n&&"retain"!==n&&"remove"!==n)throw new Error('Action "'+n+'" is invalid');e.action=n}var o=t.data;if(null!=o&&o!==e.data){if(r=!0,"remove"===e.action&&("number"!=typeof o||o<0))throw new Error("Expect the data of remove action to be a positive number, got "+o);e.data=o}if(null==e.data)throw new Error("Expect data to have a non-empty value, got "+e.data);var i=t.attributes;if(i){var a=typeof i;if("object"===a)if(Object.keys(i).length){var s=u.pack(i);s&&e.attributes!==s&&(r=!0,e.attributes=s)}else e.attributes&&(r=!0,delete e.attributes);else"string"===a&&e.attributes!==i&&(r=!0,e.attributes=i)}return{changed:r,op:e}}},{key:"set",value:function(t){var e=this._genericSet(t),r=e.changed,n=e.op;return r?this.createInstance(n):this}},{key:"setWithMutations",value:function(t){var e=this._genericSet(t).op;return this.action=e.action,this.data=e.data,this.attributes=e.attributes,this}},{key:"createInstance",value:function(t){return new this.constructor(t)}},{key:"toJSON",value:function(){return this.pack()}},{key:"pack",value:function(){var t=void 0;switch(this.action){case"insert":t=0;break;case"remove":t=1;break;case"retain":t=2}var e="function"==typeof this.data.pack?this.data.pack():this.data,r=[Number(""+this.constructor.packId+t),e];return this.attributes&&r.push(this.attributes),r}},{key:"getEmbedObject",value:function(){throw new Error("#getEmbedObject() not implemented")}},{key:"isEmpty",value:function(){return"retain"===this.action&&!this.attributes&&"number"==typeof this.data}},{key:"getAttributes",value:function(){return u.unpack(this.attributes)}},{key:"merge",value:function(t){if(this.name()!==t.name())return!1;var e=typeof this.data;return!(this.action!==t.action||e!==typeof t.data||"number"!==e&&"string"!==e||this.attributes!==t.attributes)&&t.set({data:t.data+this.data})}},{key:"compose",value:function(t){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be composed");if(this.constructor.packId!==t.constructor.packId&&!this.isGeneric()&&!t.isGeneric())throw new Error('Failed to compose operators. Expect constructor "'+t.constructor.name+'" to equal "'+this.constructor.name+'"');var e=void 0;return e="function"==typeof this.data.compose&&t.data.constructor.packId===this.data.constructor.packId?this.data.compose(t.data):"number"==typeof this.data?t.data:this.data,(this.isGeneric()?t:this).createInstance({data:e,attributes:u.merge(this.attributes,t.attributes,"insert"!==this.action),action:this.action})}},{key:"invert",value:function(t){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.constructor.name+")");if("retain"!==t.action)throw new Error("Only retaining operator can be inverted");if(this.constructor.packId!==t.constructor.packId&&!t.isGeneric())throw new Error('Failed to invert operators. Expect constructor "'+t.constructor.name+'" to equal "'+this.constructor.name+'"');var e=void 0;return e="function"==typeof this.data.invert&&t.data.constructor.packId===this.data.constructor.packId?this.data.invert(t.data):"number"==typeof t.data?t.data:this.data,this.createInstance({data:e,attributes:u.invert(this.attributes,t.attributes),action:"retain"})}},{key:"transform",value:function(t,e){if("retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be transformd");if(this.constructor.packId!==t.constructor.packId&&!t.isGeneric()&&!this.isGeneric())throw new Error('Failed to transform operators. Expect constructor "'+t.constructor.name+'" to equal "'+this.constructor.name+'"');return(this.isGeneric()?t:this).createInstance({attributes:u.transform(this.attributes,t.attributes,e),action:"retain",data:"function"==typeof this.data.transform&&"function"==typeof t.data.transform?this.data.transform(t.data,e):t.data})}},{key:"print",value:function(){var t=[this.action+": %c"+this.name(),"color: #51c6ed"];this.attributes&&(t[0]=t[0]+"%c, %O",t.push("font-weight: normal; color: #000",this.attributes.toJS())),console.groupCollapsed.apply(console,t),function t(e){"function"==typeof e.pack?e.print():"object"==typeof e?Object.keys(e).forEach(function(r){var n=e[r];console.groupCollapsed(r),t(n),console.groupEnd()}):console.log(e)}(this.data),console.groupEnd()}},{key:"length",get:function(){switch(typeof this.data){case"number":return this.data;case"string":return this.data.length;default:return 1}}}],[{key:"unpack",value:function(t){var e=n(t,3),r=e[0],o=e[1],a=e[2];return new this({action:["insert","remove","retain"][r],data:Array.isArray(o)?i.unpack(o):o,attributes:a})}},{key:"insert",value:function(t,e){return new this({action:"insert",data:t,attributes:e})}},{key:"retain",value:function(t,e){return new this({action:"retain",data:t,attributes:e})}},{key:"remove",value:function(t){return new this({action:"remove",data:t})}}]),t}();c.packId=1,t.exports=c},,,,,,,,,,,,,,,,,,,,function(t,e,r){var n=r(265),o=r(752),i=r(317),a=r(755),u=r(750),s=r(1009),c=o("wks"),l=n.Symbol,f=s?l:l&&l.withoutSetter||a;t.exports=function(t){return i(c,t)&&(u||"string"==typeof c[t])||(u&&i(l,t)?c[t]=l[t]:c[t]=f("Symbol."+t)),c[t]}},,,,,,,,,,,,,,,,,function(t,e,r){"use strict";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},function(t,e,r){"use strict";var n=r(23),o=r(328),i=r(330),a=r(331),u=r(332),s=r(257);t.exports=function(t){return new Promise(function(e,c){var l=t.data,f=t.headers;n.isFormData(l)&&delete f["Content-Type"];var p=new XMLHttpRequest;if(t.auth){var d=t.auth.username||"",h=t.auth.password||"";f.Authorization="Basic "+btoa(d+":"+h)}if(p.open(t.method.toUpperCase(),i(t.url,t.params,t.paramsSerializer),!0),p.timeout=t.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in p?a(p.getAllResponseHeaders()):null,n={data:t.responseType&&"text"!==t.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:r,config:t,request:p};o(e,c,n),p=null}},p.onerror=function(){c(s("Network Error",t,null,p)),p=null},p.ontimeout=function(){c(s("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",p)),p=null},n.isStandardBrowserEnv()){var v=r(333),y=(t.withCredentials||u(t.url))&&t.xsrfCookieName?v.read(t.xsrfCookieName):void 0;y&&(f[t.xsrfHeaderName]=y)}if("setRequestHeader"in p&&n.forEach(f,function(t,e){void 0===l&&"content-type"===e.toLowerCase()?delete f[e]:p.setRequestHeader(e,t)}),t.withCredentials&&(p.withCredentials=!0),t.responseType)try{p.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&p.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){p&&(p.abort(),c(t),p=null)}),void 0===l&&(l=null),p.send(l)})}},function(t,e,r){"use strict";var n=r(329);t.exports=function(t,e,r,o,i){var a=new Error(t);return n(a,e,r,o,i)}},function(t,e,r){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,r){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},,,function(t,e,r){"use strict";var n=r(457),o=r(474);e.Attribute=r(216),e.Delta=r(217);var i={TableOperator:r(491),CellOperator:r(351),TextOperator:r(494),Operator:r(218)};n(e,i),e.pack=function(t){if("function"==typeof t.toJSON)return JSON.stringify(t);throw new Error("Only delta can be packed")},e.unpack=function(t){return e.Delta.unpack(JSON.parse(t))},e.print=function(t){t.print(!0)};var a=o(Object.keys(i),function(t,e){var r=i[e];return t[r.packId]=r,t},{});function u(t){var e=t[0].toString(),r=e[e.length-1];return a[e.slice(0,e.length-1)].unpack([r,t[1],t[2]])}e.Delta.operatorUnpacker=u,Object.keys(i).forEach(function(t){i[t].operatorUnpacker=u});var s=r(160);e.parsePosition=s.parsePosition,e.stringifyPosition=s.stringifyPosition},,,function(t,e,r){(function(e){var r=function(t){return t&&t.Math==Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e&&e)||function(){return this}()||Function("return this")()}).call(e,r(26))},,,,function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,o="~";function i(){}function a(t,e,r,n,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new function(t,e,r){this.fn=t,this.context=e,this.once=r||!1}(r,n||t,i),u=o?o+e:e;return t._events[u]?t._events[u].fn?t._events[u]=[t._events[u],a]:t._events[u].push(a):(t._events[u]=a,t._eventsCount++),t}function u(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function s(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),s.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(o?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},s.prototype.listeners=function(t){var e=o?o+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,a=new Array(i);n<i;n++)a[n]=r[n].fn;return a},s.prototype.listenerCount=function(t){var e=o?o+t:t,r=this._events[e];return r?r.fn?1:r.length:0},s.prototype.emit=function(t,e,r,n,i,a){var u=o?o+t:t;if(!this._events[u])return!1;var s,c,l=this._events[u],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,n),!0;case 5:return l.fn.call(l.context,e,r,n,i),!0;case 6:return l.fn.call(l.context,e,r,n,i,a),!0}for(c=1,s=new Array(f-1);c<f;c++)s[c-1]=arguments[c];l.fn.apply(l.context,s)}else{var p,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,r);break;case 4:l[c].fn.call(l[c].context,e,r,n);break;default:if(!s)for(p=1,s=new Array(f-1);p<f;p++)s[p-1]=arguments[p];l[c].fn.apply(l[c].context,s)}}return!0},s.prototype.on=function(t,e,r){return a(this,t,e,r,!1)},s.prototype.once=function(t,e,r){return a(this,t,e,r,!0)},s.prototype.removeListener=function(t,e,r,n){var i=o?o+t:t;if(!this._events[i])return this;if(!e)return u(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||n&&!a.once||r&&a.context!==r||u(this,i);else{for(var s=0,c=[],l=a.length;s<l;s++)(a[s].fn!==e||n&&!a[s].once||r&&a[s].context!==r)&&c.push(a[s]);c.length?this._events[i]=1===c.length?c[0]:c:u(this,i)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=o?o+t:t,this._events[e]&&u(this,e)):(this._events=new i,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=o,s.EventEmitter=s,t.exports=s},,,,,,,function(t,e,r){"use strict";var n=r(482);t.exports=Function.prototype.bind||n},function(t,e,r){"use strict";var n=r(276),o=r(345),i=o("%Function.prototype.apply%"),a=o("%Function.prototype.call%"),u=o("%Reflect.apply%",!0)||n.call(a,i),s=o("%Object.getOwnPropertyDescriptor%",!0),c=o("%Object.defineProperty%",!0),l=o("%Math.max%");if(c)try{c({},"a",{value:1})}catch(t){c=null}t.exports=function(t){var e=u(n,a,arguments);s&&c&&(s(e,"length").configurable&&c(e,"length",{value:1+l(0,t.length-(arguments.length-1))}));return e};var f=function(){return u(n,i,arguments)};c?c(t.exports,"apply",{value:f}):t.exports.apply=f},,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(673);e.assert=function(t,e){if(!t)throw new Error(e)},e.assertNever=function(t){throw new TypeError("Unexpected type: "+JSON.stringify(t))},e.softAssertNever=function(t){n.isDebugging&&console.warn("Unexpected type:",t)}},,,,,,,,,,,,,,,,,,,,function(t,e,r){var n=r(265),o=r(598).f,i=r(501),a=r(668),u=r(754),s=r(1013),c=r(1516);t.exports=function(t,e){var r,l,f,p,d,h=t.target,v=t.global,y=t.stat;if(r=v?n:y?n[h]||u(h,{}):(n[h]||{}).prototype)for(l in e){if(p=e[l],f=t.noTargetGet?(d=o(r,l))&&d.value:r[l],!c(v?l:h+(y?".":"#")+l,t.forced)&&void 0!==f){if(typeof p==typeof f)continue;s(p,f)}(t.sham||f&&f.sham)&&i(p,"sham",!0),a(r,l,p,t)}}},,,,function(t,e,r){t.exports=r(324)},,,,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(995);e.Delta=n.Delta;var o=r(997);e.Pool=o.default},,,,,,,,function(t,e,r){var n=r(500),o={}.hasOwnProperty;t.exports=Object.hasOwn||function(t,e){return o.call(n(t),e)}},,,,,,,function(t,e,r){"use strict";var n=r(23),o=r(255),i=r(326),a=r(181);function u(t){var e=new i(t),r=o(i.prototype.request,e);return n.extend(r,i.prototype,e),n.extend(r,e),r}var s=u(a);s.Axios=i,s.create=function(t){return u(n.merge(a,t))},s.Cancel=r(259),s.CancelToken=r(339),s.isCancel=r(258),s.all=function(t){return Promise.all(t)},s.spread=r(340),t.exports=s,t.exports.default=s},function(t,e){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},function(t,e,r){"use strict";var n=r(181),o=r(23),i=r(334),a=r(335);function u(t){this.defaults=t,this.interceptors={request:new i,response:new i}}u.prototype.request=function(t){"string"==typeof t&&(t=o.merge({url:arguments[0]},arguments[1])),(t=o.merge(n,{method:"get"},this.defaults,t)).method=t.method.toLowerCase();var e=[a,void 0],r=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)r=r.then(e.shift(),e.shift());return r},o.forEach(["delete","get","head","options"],function(t){u.prototype[t]=function(e,r){return this.request(o.merge(r||{},{method:t,url:e}))}}),o.forEach(["post","put","patch"],function(t){u.prototype[t]=function(e,r,n){return this.request(o.merge(n||{},{method:t,url:e,data:r}))}}),t.exports=u},function(t,e,r){"use strict";var n=r(23);t.exports=function(t,e){n.forEach(t,function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])})}},function(t,e,r){"use strict";var n=r(257);t.exports=function(t,e,r){var o=r.config.validateStatus;r.status&&o&&!o(r.status)?e(n("Request failed with status code "+r.status,r.config,null,r.request,r)):t(r)}},function(t,e,r){"use strict";t.exports=function(t,e,r,n,o){return t.config=e,r&&(t.code=r),t.request=n,t.response=o,t}},function(t,e,r){"use strict";var n=r(23);function o(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,r){if(!e)return t;var i;if(r)i=r(e);else if(n.isURLSearchParams(e))i=e.toString();else{var a=[];n.forEach(e,function(t,e){null!==t&&void 0!==t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),a.push(o(e)+"="+o(t))}))}),i=a.join("&")}return i&&(t+=(-1===t.indexOf("?")?"?":"&")+i),t}},function(t,e,r){"use strict";var n=r(23),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,r,i,a={};return t?(n.forEach(t.split("\n"),function(t){if(i=t.indexOf(":"),e=n.trim(t.substr(0,i)).toLowerCase(),r=n.trim(t.substr(i+1)),e){if(a[e]&&o.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([r]):a[e]?a[e]+", "+r:r}}),a):a}},function(t,e,r){"use strict";var n=r(23);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=o(window.location.href),function(e){var r=n.isString(e)?o(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},function(t,e,r){"use strict";var n=r(23);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,o,i,a){var u=[];u.push(t+"="+encodeURIComponent(e)),n.isNumber(r)&&u.push("expires="+new Date(r).toGMTString()),n.isString(o)&&u.push("path="+o),n.isString(i)&&u.push("domain="+i),!0===a&&u.push("secure"),document.cookie=u.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,r){"use strict";var n=r(23);function o(){this.handlers=[]}o.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},o.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},o.prototype.forEach=function(t){n.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=o},function(t,e,r){"use strict";var n=r(23),o=r(336),i=r(258),a=r(181),u=r(337),s=r(338);function c(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return c(t),t.baseURL&&!u(t.url)&&(t.url=s(t.baseURL,t.url)),t.headers=t.headers||{},t.data=o(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return c(t),e.data=o(e.data,e.headers,t.transformResponse),e},function(e){return i(e)||(c(t),e&&e.response&&(e.response.data=o(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,r){"use strict";var n=r(23);t.exports=function(t,e,r){return n.forEach(r,function(r){t=r(t,e)}),t}},function(t,e,r){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,r){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,r){"use strict";var n=r(259);function o(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var r=this;t(function(t){r.reason||(r.reason=new n(t),e(r.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var t;return{token:new o(function(e){t=e}),cancel:t}},t.exports=o},function(t,e,r){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},,,function(t,e,r){"use strict";var n=Array.prototype.slice,o=r(344),i=Object.keys,a=i?function(t){return i(t)}:r(478),u=Object.keys;a.shim=function(){Object.keys?function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2)||(Object.keys=function(t){return o(t)?u(n.call(t)):u(t)}):Object.keys=a;return Object.keys||a},t.exports=a},function(t,e,r){"use strict";var n=Object.prototype.toString;t.exports=function(t){var e=n.call(t),r="[object Arguments]"===e;return r||(r="[object Array]"!==e&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===n.call(t.callee)),r}},function(t,e,r){"use strict";var n=SyntaxError,o=Function,i=TypeError,a=function(t){try{return Function('"use strict"; return ('+t+").constructor;")()}catch(t){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(t){u=null}var s=function(){throw new i},c=u?function(){try{return arguments.callee,s}catch(t){try{return u(arguments,"callee").get}catch(t){return s}}}():s,l=r(346)(),f=Object.getPrototypeOf||function(t){return t.__proto__},p=a("async function* () {}"),d=p?p.prototype:void 0,h=d?d.prototype:void 0,v="undefined"==typeof Uint8Array?void 0:f(Uint8Array),y={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":l?f([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":a("async function () {}"),"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":p,"%AsyncIteratorPrototype%":h?f(h):void 0,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":a("function* () {}"),"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":l?f(f([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&l?f((new Map)[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&l?f((new Set)[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":l?f(""[Symbol.iterator]()):void 0,"%Symbol%":l?Symbol:void 0,"%SyntaxError%":n,"%ThrowTypeError%":c,"%TypedArray%":v,"%TypeError%":i,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet},m={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},g=r(276),b=r(483),w=g.call(Function.call,Array.prototype.concat),_=g.call(Function.apply,Array.prototype.splice),O=g.call(Function.call,String.prototype.replace),x=g.call(Function.call,String.prototype.slice),C=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,S=/\\(\\)?/g;t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new i("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new i('"allowMissing" argument must be a boolean');var r=function(t){var e=x(t,0,1),r=x(t,-1);if("%"===e&&"%"!==r)throw new n("invalid intrinsic syntax, expected closing `%`");if("%"===r&&"%"!==e)throw new n("invalid intrinsic syntax, expected opening `%`");var o=[];return O(t,C,function(t,e,r,n){o[o.length]=r?O(n,S,"$1"):e||t}),o}(t),o=r.length>0?r[0]:"",a=function(t,e){var r,o=t;if(b(m,o)&&(o="%"+(r=m[o])[0]+"%"),b(y,o)){var a=y[o];if(void 0===a&&!e)throw new i("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:r,name:o,value:a}}throw new n("intrinsic "+t+" does not exist!")}("%"+o+"%",e),s=a.name,c=a.value,l=!1,f=a.alias;f&&(o=f[0],_(r,w([0,1],f)));for(var p=1,d=!0;p<r.length;p+=1){var h=r[p],v=x(h,0,1),g=x(h,-1);if(('"'===v||"'"===v||"`"===v||'"'===g||"'"===g||"`"===g)&&v!==g)throw new n("property names with quotes must have matching quotes");if("constructor"!==h&&d||(l=!0),b(y,s="%"+(o+="."+h)+"%"))c=y[s];else if(null!=c){if(!(h in c)){if(!e)throw new i("base intrinsic for "+t+" exists, but the property is not available.");return}if(u&&p+1>=r.length){var j=u(c,h);c=(d=!!j)&&"get"in j&&!("originalValue"in j.get)?j.get:c[h]}else d=b(c,h),c=c[h];d&&!l&&(y[s]=c)}}return c}},function(t,e,r){"use strict";(function(e){var n=e.Symbol,o=r(481);t.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&o())))}}).call(e,r(26))},function(t,e,r){"use strict";var n=function(t){return t!=t};t.exports=function(t,e){return 0===t&&0===e?1/t==1/e:t===e||!(!n(t)||!n(e))}},function(t,e,r){"use strict";var n=r(347);t.exports=function(){return"function"==typeof Object.is?Object.is:n}},function(t,e,r){"use strict";var n=Object,o=TypeError;t.exports=function(){if(null!=this&&this!==n(this))throw new o("RegExp.prototype.flags getter called on non-object");var t="";return this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t}},function(t,e,r){"use strict";var n=r(349),o=r(182).supportsDescriptors,i=Object.getOwnPropertyDescriptor,a=TypeError;t.exports=function(){if(!o)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");if("gim"===/a/gim.flags){var t=i(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof/a/.dotAll)return t.get}return n}},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var i=r(216),a=r(218),u=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),n(e,[{key:"setData",value:function(t){if(function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),"number"==typeof this.data&&1!==this.data)throw new Error('The value of data should be "1", got '+this.data);return this}},{key:"name",value:function(){return"CellOperator"}},{key:"compose",value:function(t){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be composed");var e=void 0;if("function"==typeof this.data.compose&&t.data.constructor.packId===this.data.constructor.packId)e=void 0!==i.unpack(t.attributes).cellValue?t.data:this.data.compose(t.data);else if("number"==typeof this.data)e=t.data;else{e=void 0!==i.unpack(t.attributes).cellValue?1:this.data}return(this.isGeneric()?t:this).createInstance({data:e,attributes:i.merge(this.attributes,t.attributes,"insert"!==this.action),action:this.action})}},{key:"invert",value:function(t){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.constructor.name+")");if("retain"!==t.action)throw new Error("Only retaining operator can be inverted");var e=void 0;if("function"==typeof this.data.invert&&t.data.constructor.packId===this.data.constructor.packId)e=void 0!==i.unpack(t.attributes).cellValue?this.data:this.data.invert(t.data);else if("number"==typeof t.data){e=void 0!==i.unpack(t.attributes).cellValue?this.data:t.data}else e=this.data;return this.createInstance({data:e,attributes:i.invert(this.attributes,t.attributes),action:"retain"})}}]),e}();u.packId=4,t.exports=u},,,,,,,,,,,,,function(t,e){t.exports=function(t){try{return!!t()}catch(t){return!0}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){var n=r(364);t.exports=!n(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})},function(t,e,r){var n=r(440),o=r(1010),i=r(467),a=r(666),u=Object.defineProperty;e.f=n?u:function(t,e,r){if(i(t),e=a(e),i(r),o)try{return u(t,e,r)}catch(t){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},,,,,,,,,,,,,,,,function(t,e){var r=9007199254740991,n="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",a=/^(?:0|[1-9]\d*)$/;var u=Object.prototype,s=u.hasOwnProperty,c=u.toString,l=u.propertyIsEnumerable,f=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),p=Math.max,d=!l.call({valueOf:1},"valueOf");function h(t,e){var r=b(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&w(t)}(t)&&s.call(t,"callee")&&(!l.call(t,"callee")||c.call(t)==n)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],o=r.length,i=!!o;for(var a in t)!e&&!s.call(t,a)||i&&("length"==a||y(a,o))||r.push(a);return r}function v(t,e,r){var n=t[e];s.call(t,e)&&g(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function y(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||a.test(t))&&t>-1&&t%1==0&&t<e}function m(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||u)}function g(t,e){return t===e||t!=t&&e!=e}var b=Array.isArray;function w(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!function(t){var e=_(t)?c.call(t):"";return e==o||e==i}(t)}function _(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var O=function(t){return function(t,e){return e=p(void 0===e?t.length-1:e,0),function(){for(var r=arguments,n=-1,o=p(r.length-e,0),i=Array(o);++n<o;)i[n]=r[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=r[n];return a[e]=i,function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,a)}}(function(e,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(t,e,r){if(!_(r))return!1;var n=typeof e;return!!("number"==n?w(r)&&y(e,r.length):"string"==n&&e in r)&&g(r[e],t)}(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),e=Object(e);++n<o;){var u=r[n];u&&t(e,u,n,i)}return e})}(function(t,e){if(d||m(e)||w(e))!function(t,e,r,n){r||(r={});for(var o=-1,i=e.length;++o<i;){var a=e[o],u=n?n(r[a],t[a],a,r,t):void 0;v(r,a,void 0===u?t[a]:u)}}(e,function(t){return w(t)?h(t):function(t){if(!m(t))return f(t);var e=[];for(var r in Object(t))s.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}(e),t);else for(var r in e)s.call(e,r)&&v(t,r,e[r])});t.exports=O},,,,,,,,,,function(t,e,r){var n=r(365);t.exports=function(t){if(!n(t))throw TypeError(String(t)+" is not an object");return t}},,,,,,,function(t,e,r){(function(t,r){var n=200,o="Expected a function",i="__lodash_hash_undefined__",a=1,u=2,s=1/0,c=9007199254740991,l="[object Arguments]",f="[object Array]",p="[object Boolean]",d="[object Date]",h="[object Error]",v="[object Function]",y="[object GeneratorFunction]",m="[object Map]",g="[object Number]",b="[object Object]",w="[object RegExp]",_="[object Set]",O="[object String]",x="[object Symbol]",C="[object ArrayBuffer]",S="[object DataView]",j=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,E=/^\w*$/,A=/^\./,k=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,T=/\\(\\)?/g,I=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,M={};M["[object Float32Array]"]=M["[object Float64Array]"]=M["[object Int8Array]"]=M["[object Int16Array]"]=M["[object Int32Array]"]=M["[object Uint8Array]"]=M["[object Uint8ClampedArray]"]=M["[object Uint16Array]"]=M["[object Uint32Array]"]=!0,M[l]=M[f]=M[C]=M[p]=M[S]=M[d]=M[h]=M[v]=M[m]=M[g]=M[b]=M[w]=M[_]=M[O]=M["[object WeakMap]"]=!1;var F="object"==typeof t&&t&&t.Object===Object&&t,D="object"==typeof self&&self&&self.Object===Object&&self,R=F||D||Function("return this")(),N="object"==typeof e&&e&&!e.nodeType&&e,L=N&&"object"==typeof r&&r&&!r.nodeType&&r,G=L&&L.exports===N&&F.process,U=function(){try{return G&&G.binding("util")}catch(t){}}(),z=U&&U.isTypedArray;function B(t,e,r,n){var o=-1,i=t?t.length:0;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function V(t,e){for(var r=-1,n=t?t.length:0;++r<n;)if(e(t[r],r,t))return!0;return!1}function q(t,e,r,n,o){return o(t,function(t,o,i){r=n?(n=!1,t):e(r,t,o,i)}),r}function $(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function H(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function Y(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var J=Array.prototype,W=Function.prototype,Q=Object.prototype,K=R["__core-js_shared__"],Z=function(){var t=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),X=W.toString,tt=Q.hasOwnProperty,et=Q.toString,rt=RegExp("^"+X.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nt=R.Symbol,ot=R.Uint8Array,it=Q.propertyIsEnumerable,at=J.splice,ut=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),st=Ut(R,"DataView"),ct=Ut(R,"Map"),lt=Ut(R,"Promise"),ft=Ut(R,"Set"),pt=Ut(R,"WeakMap"),dt=Ut(Object,"create"),ht=Jt(st),vt=Jt(ct),yt=Jt(lt),mt=Jt(ft),gt=Jt(pt),bt=nt?nt.prototype:void 0,wt=bt?bt.valueOf:void 0,_t=bt?bt.toString:void 0;function Ot(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function xt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Ct(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function St(t){var e=-1,r=t?t.length:0;for(this.__data__=new Ct;++e<r;)this.add(t[e])}function jt(t){this.__data__=new xt(t)}function Et(t,e){var r=Zt(t)||Kt(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!tt.call(t,i)||o&&("length"==i||Bt(i,n))||r.push(i);return r}function At(t,e){for(var r=t.length;r--;)if(Qt(t[r][0],e))return r;return-1}Ot.prototype.clear=function(){this.__data__=dt?dt(null):{}},Ot.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Ot.prototype.get=function(t){var e=this.__data__;if(dt){var r=e[t];return r===i?void 0:r}return tt.call(e,t)?e[t]:void 0},Ot.prototype.has=function(t){var e=this.__data__;return dt?void 0!==e[t]:tt.call(e,t)},Ot.prototype.set=function(t,e){return this.__data__[t]=dt&&void 0===e?i:e,this},xt.prototype.clear=function(){this.__data__=[]},xt.prototype.delete=function(t){var e=this.__data__,r=At(e,t);return!(r<0||(r==e.length-1?e.pop():at.call(e,r,1),0))},xt.prototype.get=function(t){var e=this.__data__,r=At(e,t);return r<0?void 0:e[r][1]},xt.prototype.has=function(t){return At(this.__data__,t)>-1},xt.prototype.set=function(t,e){var r=this.__data__,n=At(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},Ct.prototype.clear=function(){this.__data__={hash:new Ot,map:new(ct||xt),string:new Ot}},Ct.prototype.delete=function(t){return Gt(this,t).delete(t)},Ct.prototype.get=function(t){return Gt(this,t).get(t)},Ct.prototype.has=function(t){return Gt(this,t).has(t)},Ct.prototype.set=function(t,e){return Gt(this,t).set(t,e),this},St.prototype.add=St.prototype.push=function(t){return this.__data__.set(t,i),this},St.prototype.has=function(t){return this.__data__.has(t)},jt.prototype.clear=function(){this.__data__=new xt},jt.prototype.delete=function(t){return this.__data__.delete(t)},jt.prototype.get=function(t){return this.__data__.get(t)},jt.prototype.has=function(t){return this.__data__.has(t)},jt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof xt){var o=r.__data__;if(!ct||o.length<n-1)return o.push([t,e]),this;r=this.__data__=new Ct(o)}return r.set(t,e),this};var kt=function(t,e){return function(r,n){if(null==r)return r;if(!Xt(r))return t(r,n);for(var o=r.length,i=e?o:-1,a=Object(r);(e?i--:++i<o)&&!1!==n(a[i],i,a););return r}}(function(t,e){return t&&Tt(t,e,ae)}),Tt=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),u=a.length;u--;){var s=a[t?u:++o];if(!1===r(i[s],s,i))break}return e}}();function It(t,e){for(var r=0,n=(e=Vt(e,t)?[e]:Nt(e)).length;null!=t&&r<n;)t=t[Yt(e[r++])];return r&&r==n?t:void 0}function Pt(t,e){return null!=t&&e in Object(t)}function Mt(t,e,r,n,o){return t===e||(null==t||null==e||!re(t)&&!ne(e)?t!=t&&e!=e:function(t,e,r,n,o,i){var s=Zt(t),c=Zt(e),v=f,y=f;s||(v=(v=zt(t))==l?b:v);c||(y=(y=zt(e))==l?b:y);var j=v==b&&!$(t),E=y==b&&!$(e),A=v==y;if(A&&!j)return i||(i=new jt),s||ie(t)?Lt(t,e,r,n,o,i):function(t,e,r,n,o,i,s){switch(r){case S:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case C:return!(t.byteLength!=e.byteLength||!n(new ot(t),new ot(e)));case p:case d:case g:return Qt(+t,+e);case h:return t.name==e.name&&t.message==e.message;case w:case O:return t==e+"";case m:var c=H;case _:var l=i&u;if(c||(c=Y),t.size!=e.size&&!l)return!1;var f=s.get(t);if(f)return f==e;i|=a,s.set(t,e);var v=Lt(c(t),c(e),n,o,i,s);return s.delete(t),v;case x:if(wt)return wt.call(t)==wt.call(e)}return!1}(t,e,v,r,n,o,i);if(!(o&u)){var k=j&&tt.call(t,"__wrapped__"),T=E&&tt.call(e,"__wrapped__");if(k||T){var I=k?t.value():t,P=T?e.value():e;return i||(i=new jt),r(I,P,n,o,i)}}if(!A)return!1;return i||(i=new jt),function(t,e,r,n,o,i){var a=o&u,s=ae(t),c=s.length,l=ae(e).length;if(c!=l&&!a)return!1;for(var f=c;f--;){var p=s[f];if(!(a?p in e:tt.call(e,p)))return!1}var d=i.get(t);if(d&&i.get(e))return d==e;var h=!0;i.set(t,e),i.set(e,t);for(var v=a;++f<c;){p=s[f];var y=t[p],m=e[p];if(n)var g=a?n(m,y,p,e,t,i):n(y,m,p,t,e,i);if(!(void 0===g?y===m||r(y,m,n,o,i):g)){h=!1;break}v||(v="constructor"==p)}if(h&&!v){var b=t.constructor,w=e.constructor;b!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(h=!1)}return i.delete(t),i.delete(e),h}(t,e,r,n,o,i)}(t,e,Mt,r,n,o))}function Ft(t){return!(!re(t)||function(t){return!!Z&&Z in t}(t))&&(te(t)||$(t)?rt:I).test(Jt(t))}function Dt(t){return"function"==typeof t?t:null==t?ue:"object"==typeof t?Zt(t)?function(t,e){if(Vt(t)&&qt(e))return $t(Yt(t),e);return function(r){var n=function(t,e,r){var n=null==t?void 0:It(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?function(t,e){return null!=t&&function(t,e,r){var n,o=-1,i=(e=Vt(e,t)?[e]:Nt(e)).length;for(;++o<i;){var a=Yt(e[o]);if(!(n=null!=t&&r(t,a)))break;t=t[a]}if(n)return n;return!!(i=t?t.length:0)&&ee(i)&&Bt(a,i)&&(Zt(t)||Kt(t))}(t,e,Pt)}(r,t):Mt(e,n,void 0,a|u)}}(t[0],t[1]):function(t){var e=function(t){var e=ae(t),r=e.length;for(;r--;){var n=e[r],o=t[n];e[r]=[n,o,qt(o)]}return e}(t);if(1==e.length&&e[0][2])return $t(e[0][0],e[0][1]);return function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,s=!n;if(null==t)return!i;for(t=Object(t);o--;){var c=r[o];if(s&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<i;){var l=(c=r[o])[0],f=t[l],p=c[1];if(s&&c[2]){if(void 0===f&&!(l in t))return!1}else{var d=new jt;if(n)var h=n(f,p,l,t,e,d);if(!(void 0===h?Mt(p,f,n,a|u,d):h))return!1}}return!0}(r,t,e)}}(t):function(t){return Vt(t)?function(t){return function(e){return null==e?void 0:e[t]}}(Yt(t)):function(t){return function(e){return It(e,t)}}(t)}(t)}function Rt(t){if(!function(t){var e=t&&t.constructor,r="function"==typeof e&&e.prototype||Q;return t===r}(t))return ut(t);var e=[];for(var r in Object(t))tt.call(t,r)&&"constructor"!=r&&e.push(r);return e}function Nt(t){return Zt(t)?t:Ht(t)}function Lt(t,e,r,n,o,i){var s=o&u,c=t.length,l=e.length;if(c!=l&&!(s&&l>c))return!1;var f=i.get(t);if(f&&i.get(e))return f==e;var p=-1,d=!0,h=o&a?new St:void 0;for(i.set(t,e),i.set(e,t);++p<c;){var v=t[p],y=e[p];if(n)var m=s?n(y,v,p,e,t,i):n(v,y,p,t,e,i);if(void 0!==m){if(m)continue;d=!1;break}if(h){if(!V(e,function(t,e){if(!h.has(e)&&(v===t||r(v,t,n,o,i)))return h.add(e)})){d=!1;break}}else if(v!==y&&!r(v,y,n,o,i)){d=!1;break}}return i.delete(t),i.delete(e),d}function Gt(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map}function Ut(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Ft(r)?r:void 0}var zt=function(t){return et.call(t)};function Bt(t,e){return!!(e=null==e?c:e)&&("number"==typeof t||P.test(t))&&t>-1&&t%1==0&&t<e}function Vt(t,e){if(Zt(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!oe(t))||(E.test(t)||!j.test(t)||null!=e&&t in Object(e))}function qt(t){return t==t&&!re(t)}function $t(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}(st&&zt(new st(new ArrayBuffer(1)))!=S||ct&&zt(new ct)!=m||lt&&"[object Promise]"!=zt(lt.resolve())||ft&&zt(new ft)!=_||pt&&"[object WeakMap]"!=zt(new pt))&&(zt=function(t){var e=et.call(t),r=e==b?t.constructor:void 0,n=r?Jt(r):void 0;if(n)switch(n){case ht:return S;case vt:return m;case yt:return"[object Promise]";case mt:return _;case gt:return"[object WeakMap]"}return e});var Ht=Wt(function(t){t=function(t){return null==t?"":function(t){if("string"==typeof t)return t;if(oe(t))return _t?_t.call(t):"";var e=t+"";return"0"==e&&1/t==-s?"-0":e}(t)}(t);var e=[];return A.test(t)&&e.push(""),t.replace(k,function(t,r,n,o){e.push(n?o.replace(T,"$1"):r||t)}),e});function Yt(t){if("string"==typeof t||oe(t))return t;var e=t+"";return"0"==e&&1/t==-s?"-0":e}function Jt(t){if(null!=t){try{return X.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Wt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(o);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(Wt.Cache||Ct),r}function Qt(t,e){return t===e||t!=t&&e!=e}function Kt(t){return function(t){return ne(t)&&Xt(t)}(t)&&tt.call(t,"callee")&&(!it.call(t,"callee")||et.call(t)==l)}Wt.Cache=Ct;var Zt=Array.isArray;function Xt(t){return null!=t&&ee(t.length)&&!te(t)}function te(t){var e=re(t)?et.call(t):"";return e==v||e==y}function ee(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function re(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function ne(t){return!!t&&"object"==typeof t}function oe(t){return"symbol"==typeof t||ne(t)&&et.call(t)==x}var ie=z?function(t){return function(e){return t(e)}}(z):function(t){return ne(t)&&ee(t.length)&&!!M[et.call(t)]};function ae(t){return Xt(t)?Et(t):Rt(t)}function ue(t){return t}r.exports=function(t,e,r){var n=Zt(t)?B:q,o=arguments.length<3;return n(t,Dt(e),r,o,kt)}}).call(e,r(26),r(32)(t))},function(t,e,r){(function(t,r){var n=200,o="__lodash_hash_undefined__",i=9007199254740991,a="[object Arguments]",u="[object Boolean]",s="[object Date]",c="[object Function]",l="[object GeneratorFunction]",f="[object Map]",p="[object Number]",d="[object Object]",h="[object RegExp]",v="[object Set]",y="[object String]",m="[object Symbol]",g="[object ArrayBuffer]",b="[object DataView]",w="[object Float32Array]",_="[object Float64Array]",O="[object Int8Array]",x="[object Int16Array]",C="[object Int32Array]",S="[object Uint8Array]",j="[object Uint8ClampedArray]",E="[object Uint16Array]",A="[object Uint32Array]",k=/\w*$/,T=/^\[object .+?Constructor\]$/,I=/^(?:0|[1-9]\d*)$/,P={};P[a]=P["[object Array]"]=P[g]=P[b]=P[u]=P[s]=P[w]=P[_]=P[O]=P[x]=P[C]=P[f]=P[p]=P[d]=P[h]=P[v]=P[y]=P[m]=P[S]=P[j]=P[E]=P[A]=!0,P["[object Error]"]=P[c]=P["[object WeakMap]"]=!1;var M="object"==typeof t&&t&&t.Object===Object&&t,F="object"==typeof self&&self&&self.Object===Object&&self,D=M||F||Function("return this")(),R="object"==typeof e&&e&&!e.nodeType&&e,N=R&&"object"==typeof r&&r&&!r.nodeType&&r,L=N&&N.exports===R;function G(t,e){return t.set(e[0],e[1]),t}function U(t,e){return t.add(e),t}function z(t,e,r,n){var o=-1,i=t?t.length:0;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function B(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function V(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function q(t,e){return function(r){return t(e(r))}}function $(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var H=Array.prototype,Y=Function.prototype,J=Object.prototype,W=D["__core-js_shared__"],Q=function(){var t=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),K=Y.toString,Z=J.hasOwnProperty,X=J.toString,tt=RegExp("^"+K.call(Z).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=L?D.Buffer:void 0,rt=D.Symbol,nt=D.Uint8Array,ot=q(Object.getPrototypeOf,Object),it=Object.create,at=J.propertyIsEnumerable,ut=H.splice,st=Object.getOwnPropertySymbols,ct=et?et.isBuffer:void 0,lt=q(Object.keys,Object),ft=Rt(D,"DataView"),pt=Rt(D,"Map"),dt=Rt(D,"Promise"),ht=Rt(D,"Set"),vt=Rt(D,"WeakMap"),yt=Rt(Object,"create"),mt=zt(ft),gt=zt(pt),bt=zt(dt),wt=zt(ht),_t=zt(vt),Ot=rt?rt.prototype:void 0,xt=Ot?Ot.valueOf:void 0;function Ct(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function St(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function jt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Et(t){this.__data__=new St(t)}function At(t,e){var r=Vt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&qt(t)}(t)&&Z.call(t,"callee")&&(!at.call(t,"callee")||X.call(t)==a)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!Z.call(t,i)||o&&("length"==i||Gt(i,n))||r.push(i);return r}function kt(t,e,r){var n=t[e];Z.call(t,e)&&Bt(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function Tt(t,e){for(var r=t.length;r--;)if(Bt(t[r][0],e))return r;return-1}function It(t,e,r,n,o,i,T){var I;if(n&&(I=i?n(t,o,i,T):n(t)),void 0!==I)return I;if(!Yt(t))return t;var M=Vt(t);if(M){if(I=function(t){var e=t.length,r=t.constructor(e);e&&"string"==typeof t[0]&&Z.call(t,"index")&&(r.index=t.index,r.input=t.input);return r}(t),!e)return function(t,e){var r=-1,n=t.length;e||(e=Array(n));for(;++r<n;)e[r]=t[r];return e}(t,I)}else{var F=Lt(t),D=F==c||F==l;if($t(t))return function(t,e){if(e)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}(t,e);if(F==d||F==a||D&&!i){if(B(t))return i?t:{};if(I=function(t){return"function"!=typeof t.constructor||Ut(t)?{}:function(t){return Yt(t)?it(t):{}}(ot(t))}(D?{}:t),!e)return function(t,e){return Ft(t,Nt(t),e)}(t,function(t,e){return t&&Ft(e,Jt(e),t)}(I,t))}else{if(!P[F])return i?t:{};I=function(t,e,r,n){var o=t.constructor;switch(e){case g:return Mt(t);case u:case s:return new o(+t);case b:return function(t,e){var r=e?Mt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,n);case w:case _:case O:case x:case C:case S:case j:case E:case A:return function(t,e){var r=e?Mt(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,n);case f:return function(t,e,r){return z(e?r(V(t),!0):V(t),G,new t.constructor)}(t,n,r);case p:case y:return new o(t);case h:return function(t){var e=new t.constructor(t.source,k.exec(t));return e.lastIndex=t.lastIndex,e}(t);case v:return function(t,e,r){return z(e?r($(t),!0):$(t),U,new t.constructor)}(t,n,r);case m:return function(t){return xt?Object(xt.call(t)):{}}(t)}}(t,F,It,e)}}T||(T=new Et);var R=T.get(t);if(R)return R;if(T.set(t,I),!M)var N=r?function(t){return function(t,e,r){var n=e(t);return Vt(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,Jt,Nt)}(t):Jt(t);return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(N||t,function(o,i){N&&(o=t[i=o]),kt(I,i,It(o,e,r,n,i,t,T))}),I}function Pt(t){return!(!Yt(t)||function(t){return!!Q&&Q in t}(t))&&(Ht(t)||B(t)?tt:T).test(zt(t))}function Mt(t){var e=new t.constructor(t.byteLength);return new nt(e).set(new nt(t)),e}function Ft(t,e,r,n){r||(r={});for(var o=-1,i=e.length;++o<i;){var a=e[o],u=n?n(r[a],t[a],a,r,t):void 0;kt(r,a,void 0===u?t[a]:u)}return r}function Dt(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map}function Rt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Pt(r)?r:void 0}Ct.prototype.clear=function(){this.__data__=yt?yt(null):{}},Ct.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Ct.prototype.get=function(t){var e=this.__data__;if(yt){var r=e[t];return r===o?void 0:r}return Z.call(e,t)?e[t]:void 0},Ct.prototype.has=function(t){var e=this.__data__;return yt?void 0!==e[t]:Z.call(e,t)},Ct.prototype.set=function(t,e){return this.__data__[t]=yt&&void 0===e?o:e,this},St.prototype.clear=function(){this.__data__=[]},St.prototype.delete=function(t){var e=this.__data__,r=Tt(e,t);return!(r<0||(r==e.length-1?e.pop():ut.call(e,r,1),0))},St.prototype.get=function(t){var e=this.__data__,r=Tt(e,t);return r<0?void 0:e[r][1]},St.prototype.has=function(t){return Tt(this.__data__,t)>-1},St.prototype.set=function(t,e){var r=this.__data__,n=Tt(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},jt.prototype.clear=function(){this.__data__={hash:new Ct,map:new(pt||St),string:new Ct}},jt.prototype.delete=function(t){return Dt(this,t).delete(t)},jt.prototype.get=function(t){return Dt(this,t).get(t)},jt.prototype.has=function(t){return Dt(this,t).has(t)},jt.prototype.set=function(t,e){return Dt(this,t).set(t,e),this},Et.prototype.clear=function(){this.__data__=new St},Et.prototype.delete=function(t){return this.__data__.delete(t)},Et.prototype.get=function(t){return this.__data__.get(t)},Et.prototype.has=function(t){return this.__data__.has(t)},Et.prototype.set=function(t,e){var r=this.__data__;if(r instanceof St){var o=r.__data__;if(!pt||o.length<n-1)return o.push([t,e]),this;r=this.__data__=new jt(o)}return r.set(t,e),this};var Nt=st?q(st,Object):function(){return[]},Lt=function(t){return X.call(t)};function Gt(t,e){return!!(e=null==e?i:e)&&("number"==typeof t||I.test(t))&&t>-1&&t%1==0&&t<e}function Ut(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||J)}function zt(t){if(null!=t){try{return K.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Bt(t,e){return t===e||t!=t&&e!=e}(ft&&Lt(new ft(new ArrayBuffer(1)))!=b||pt&&Lt(new pt)!=f||dt&&"[object Promise]"!=Lt(dt.resolve())||ht&&Lt(new ht)!=v||vt&&"[object WeakMap]"!=Lt(new vt))&&(Lt=function(t){var e=X.call(t),r=e==d?t.constructor:void 0,n=r?zt(r):void 0;if(n)switch(n){case mt:return b;case gt:return f;case bt:return"[object Promise]";case wt:return v;case _t:return"[object WeakMap]"}return e});var Vt=Array.isArray;function qt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}(t.length)&&!Ht(t)}var $t=ct||function(){return!1};function Ht(t){var e=Yt(t)?X.call(t):"";return e==c||e==l}function Yt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Jt(t){return qt(t)?At(t):function(t){if(!Ut(t))return lt(t);var e=[];for(var r in Object(t))Z.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}r.exports=function(t){return It(t,!0,!0)}}).call(e,r(26),r(32)(t))},function(t,e){var r=-1,n=1,o=0;function i(t,e,c,l){if(t===e)return t?[[o,t]]:[];if(null!=c){var h=function(t,e,r){var n="number"==typeof r?{index:r,length:0}:r.oldRange,o="number"==typeof r?null:r.newRange,i=t.length,a=e.length;if(0===n.length&&(null===o||0===o.length)){var u=n.index,s=t.slice(0,u),c=t.slice(u),l=o?o.index:null,f=u+a-i;if((null===l||l===f)&&!(f<0||f>a)){var p=e.slice(0,f),h=e.slice(f);if(h===c){var v=Math.min(u,f),y=s.slice(0,v),m=p.slice(0,v);if(y===m){var g=s.slice(v),b=p.slice(v);return d(y,g,b,c)}}}if(null===l||l===u){var w=u,p=e.slice(0,w),h=e.slice(w);if(p===s){var _=Math.min(i-w,a-w),O=c.slice(c.length-_),x=h.slice(h.length-_);if(O===x){var g=c.slice(0,c.length-_),b=h.slice(0,h.length-_);return d(s,g,b,O)}}}}if(n.length>0&&o&&0===o.length){var y=t.slice(0,n.index),O=t.slice(n.index+n.length),v=y.length,_=O.length;if(!(a<v+_)){var m=e.slice(0,v),x=e.slice(a-_);if(y===m&&O===x){var g=t.slice(v,i-_),b=e.slice(v,a-_);return d(y,g,b,O)}}}return null}(t,e,c);if(h)return h}var v=u(t,e),y=t.substring(0,v);v=s(t=t.substring(v),e=e.substring(v));var m=t.substring(t.length-v),g=function(t,e){var c;if(!t)return[[n,e]];if(!e)return[[r,t]];var l=t.length>e.length?t:e,f=t.length>e.length?e:t,p=l.indexOf(f);if(-1!==p)return c=[[n,l.substring(0,p)],[o,f],[n,l.substring(p+f.length)]],t.length>e.length&&(c[0][0]=c[2][0]=r),c;if(1===f.length)return[[r,t],[n,e]];var d=function(t,e){var r=t.length>e.length?t:e,n=t.length>e.length?e:t;if(r.length<4||2*n.length<r.length)return null;function o(t,e,r){for(var n,o,i,a,c=t.substring(r,r+Math.floor(t.length/4)),l=-1,f="";-1!==(l=e.indexOf(c,l+1));){var p=u(t.substring(r),e.substring(l)),d=s(t.substring(0,r),e.substring(0,l));f.length<d+p&&(f=e.substring(l-d,l)+e.substring(l,l+p),n=t.substring(0,r-d),o=t.substring(r+p),i=e.substring(0,l-d),a=e.substring(l+p))}return 2*f.length>=t.length?[n,o,i,a,f]:null}var i,a,c,l,f,p=o(r,n,Math.ceil(r.length/4)),d=o(r,n,Math.ceil(r.length/2));if(!p&&!d)return null;i=d?p&&p[4].length>d[4].length?p:d:p;t.length>e.length?(a=i[0],c=i[1],l=i[2],f=i[3]):(l=i[0],f=i[1],a=i[2],c=i[3]);var h=i[4];return[a,c,l,f,h]}(t,e);if(d){var h=d[0],v=d[1],y=d[2],m=d[3],g=d[4],b=i(h,y),w=i(v,m);return b.concat([[o,g]],w)}return function(t,e){for(var o=t.length,i=e.length,u=Math.ceil((o+i)/2),s=u,c=2*u,l=new Array(c),f=new Array(c),p=0;p<c;p++)l[p]=-1,f[p]=-1;l[s+1]=0,f[s+1]=0;for(var d=o-i,h=d%2!=0,v=0,y=0,m=0,g=0,b=0;b<u;b++){for(var w=-b+v;w<=b-y;w+=2){for(var _=s+w,O=(E=w===-b||w!==b&&l[_-1]<l[_+1]?l[_+1]:l[_-1]+1)-w;E<o&&O<i&&t.charAt(E)===e.charAt(O);)E++,O++;if(l[_]=E,E>o)y+=2;else if(O>i)v+=2;else if(h){var x=s+d-w;if(x>=0&&x<c&&-1!==f[x]){var C=o-f[x];if(E>=C)return a(t,e,E,O)}}}for(var S=-b+m;S<=b-g;S+=2){for(var x=s+S,j=(C=S===-b||S!==b&&f[x-1]<f[x+1]?f[x+1]:f[x-1]+1)-S;C<o&&j<i&&t.charAt(o-C-1)===e.charAt(i-j-1);)C++,j++;if(f[x]=C,C>o)g+=2;else if(j>i)m+=2;else if(!h){var _=s+d-S;if(_>=0&&_<c&&-1!==l[_]){var E=l[_],O=s+E-_;if(E>=(C=o-C))return a(t,e,E,O)}}}}return[[r,t],[n,e]]}(t,e)}(t=t.substring(0,t.length-v),e=e.substring(0,e.length-v));return y&&g.unshift([o,y]),m&&g.push([o,m]),function t(e,i){e.push([o,""]);var a=0;var c=0;var l=0;var d="";var h="";var v;for(;a<e.length;)if(a<e.length-1&&!e[a][1])e.splice(a,1);else switch(e[a][0]){case n:l++,h+=e[a][1],a++;break;case r:c++,d+=e[a][1],a++;break;case o:var y=a-l-c-1;if(i){if(y>=0&&p(e[y][1])){var m=e[y][1].slice(-1);if(e[y][1]=e[y][1].slice(0,-1),d=m+d,h=m+h,!e[y][1]){e.splice(y,1),a--;var g=y-1;e[g]&&e[g][0]===n&&(l++,h=e[g][1]+h,g--),e[g]&&e[g][0]===r&&(c++,d=e[g][1]+d,g--),y=g}}if(f(e[a][1])){var m=e[a][1].charAt(0);e[a][1]=e[a][1].slice(1),d+=m,h+=m}}if(a<e.length-1&&!e[a][1]){e.splice(a,1);break}if(d.length>0||h.length>0){d.length>0&&h.length>0&&(0!==(v=u(h,d))&&(y>=0?e[y][1]+=h.substring(0,v):(e.splice(0,0,[o,h.substring(0,v)]),a++),h=h.substring(v),d=d.substring(v)),0!==(v=s(h,d))&&(e[a][1]=h.substring(h.length-v)+e[a][1],h=h.substring(0,h.length-v),d=d.substring(0,d.length-v)));var b=l+c;0===d.length&&0===h.length?(e.splice(a-b,b),a-=b):0===d.length?(e.splice(a-b,b,[n,h]),a=a-b+1):0===h.length?(e.splice(a-b,b,[r,d]),a=a-b+1):(e.splice(a-b,b,[r,d],[n,h]),a=a-b+2)}0!==a&&e[a-1][0]===o?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,l=0,c=0,d="",h=""}""===e[e.length-1][1]&&e.pop();var w=!1;a=1;for(;a<e.length-1;)e[a-1][0]===o&&e[a+1][0]===o&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)===e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),w=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),w=!0)),a++;w&&t(e,i)}(g,l),g}function a(t,e,r,n){var o=t.substring(0,r),a=e.substring(0,n),u=t.substring(r),s=e.substring(n),c=i(o,a),l=i(u,s);return c.concat(l)}function u(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var r=0,n=Math.min(t.length,e.length),o=n,i=0;r<o;)t.substring(i,o)==e.substring(i,o)?i=r=o:n=o,o=Math.floor((n-r)/2+r);return c(t.charCodeAt(o-1))&&o--,o}function s(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var r=0,n=Math.min(t.length,e.length),o=n,i=0;r<o;)t.substring(t.length-o,t.length-i)==e.substring(e.length-o,e.length-i)?i=r=o:n=o,o=Math.floor((n-r)/2+r);return l(t.charCodeAt(t.length-o))&&o--,o}function c(t){return t>=55296&&t<=56319}function l(t){return t>=56320&&t<=57343}function f(t){return l(t.charCodeAt(0))}function p(t){return c(t.charCodeAt(t.length-1))}function d(t,e,i,a){return p(t)||f(a)?null:function(t){for(var e=[],r=0;r<t.length;r++)t[r][1].length>0&&e.push(t[r]);return e}([[o,t],[r,e],[n,i],[o,a]])}function h(t,e,r){return i(t,e,r,!0)}h.INSERT=n,h.DELETE=r,h.EQUAL=o,t.exports=h},function(t,e,r){var n=r(343),o=r(479),i=r(484),a=r(486),u=r(487),s=r(489),c=Date.prototype.getTime;function l(t,e,r){var d=r||{};return!(d.strict?!i(t,e):t!==e)||(!t||!e||"object"!=typeof t&&"object"!=typeof e?d.strict?i(t,e):t==e:function(t,e,r){var i,d;if(typeof t!=typeof e)return!1;if(f(t)||f(e))return!1;if(t.prototype!==e.prototype)return!1;if(o(t)!==o(e))return!1;var h=a(t),v=a(e);if(h!==v)return!1;if(h||v)return t.source===e.source&&u(t)===u(e);if(s(t)&&s(e))return c.call(t)===c.call(e);var y=p(t),m=p(e);if(y!==m)return!1;if(y||m){if(t.length!==e.length)return!1;for(i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}if(typeof t!=typeof e)return!1;try{var g=n(t),b=n(e)}catch(t){return!1}if(g.length!==b.length)return!1;for(g.sort(),b.sort(),i=g.length-1;i>=0;i--)if(g[i]!=b[i])return!1;for(i=g.length-1;i>=0;i--)if(d=g[i],!l(t[d],e[d],r))return!1;return!0}(t,e,d))}function f(t){return null===t||void 0===t}function p(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}t.exports=l},function(t,e,r){"use strict";var n;if(!Object.keys){var o=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=r(344),u=Object.prototype.propertyIsEnumerable,s=!u.call({toString:null},"toString"),c=u.call(function(){},"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(t){var e=t.constructor;return e&&e.prototype===t},p={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!p["$"+t]&&o.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{f(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();n=function(t){var e=null!==t&&"object"==typeof t,r="[object Function]"===i.call(t),n=a(t),u=e&&"[object String]"===i.call(t),p=[];if(!e&&!r&&!n)throw new TypeError("Object.keys called on a non-object");var h=c&&r;if(u&&t.length>0&&!o.call(t,0))for(var v=0;v<t.length;++v)p.push(String(v));if(n&&t.length>0)for(var y=0;y<t.length;++y)p.push(String(y));else for(var m in t)h&&"prototype"===m||!o.call(t,m)||p.push(String(m));if(s)for(var g=function(t){if("undefined"==typeof window||!d)return f(t);try{return f(t)}catch(t){return!1}}(t),b=0;b<l.length;++b)g&&"constructor"===l[b]||!o.call(t,l[b])||p.push(l[b]);return p}}t.exports=n},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,o=r(480)("Object.prototype.toString"),i=function(t){return!(n&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===o(t)},a=function(t){return!!i(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==o(t)&&"[object Function]"===o(t.callee)},u=function(){return i(arguments)}();i.isLegacyArguments=a,t.exports=u?i:a},function(t,e,r){"use strict";var n=r(345),o=r(277),i=o(n("String.prototype.indexOf"));t.exports=function(t,e){var r=n(t,!!e);return"function"==typeof r&&i(t,".prototype.")>-1?o(r):r}},function(t,e,r){"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),r=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var n=Object.getOwnPropertySymbols(t);if(1!==n.length||n[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var o=Object.getOwnPropertyDescriptor(t,e);if(42!==o.value||!0!==o.enumerable)return!1}return!0}},function(t,e,r){"use strict";var n=Array.prototype.slice,o=Object.prototype.toString;t.exports=function(t){var e=this;if("function"!=typeof e||"[object Function]"!==o.call(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var r,i=n.call(arguments,1),a=Math.max(0,e.length-i.length),u=[],s=0;s<a;s++)u.push("$"+s);if(r=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof r){var o=e.apply(this,i.concat(n.call(arguments)));return Object(o)===o?o:this}return e.apply(t,i.concat(n.call(arguments)))}),e.prototype){var c=function(){};c.prototype=e.prototype,r.prototype=new c,c.prototype=null}return r}},function(t,e,r){"use strict";var n=r(276);t.exports=n.call(Function.call,Object.prototype.hasOwnProperty)},function(t,e,r){"use strict";var n=r(182),o=r(277),i=r(347),a=r(348),u=r(485),s=o(a(),Object);n(s,{getPolyfill:a,implementation:i,shim:u}),t.exports=s},function(t,e,r){"use strict";var n=r(348),o=r(182);t.exports=function(){var t=n();return o(Object,{is:t},{is:function(){return Object.is!==t}}),t}},function(t,e,r){"use strict";var n,o,i,a,u=r(346)()&&"symbol"==typeof Symbol.toStringTag;if(u){n=Function.call.bind(Object.prototype.hasOwnProperty),o=Function.call.bind(RegExp.prototype.exec),i={};var s=function(){throw i};a={toString:s,valueOf:s},"symbol"==typeof Symbol.toPrimitive&&(a[Symbol.toPrimitive]=s)}var c=Object.prototype.toString,l=Object.getOwnPropertyDescriptor;t.exports=u?function(t){if(!t||"object"!=typeof t)return!1;var e=l(t,"lastIndex");if(!(e&&n(e,"value")))return!1;try{o(t,a)}catch(t){return t===i}}:function(t){return!(!t||"object"!=typeof t&&"function"!=typeof t)&&"[object RegExp]"===c.call(t)}},function(t,e,r){"use strict";var n=r(182),o=r(277),i=r(349),a=r(350),u=r(488),s=o(i);n(s,{getPolyfill:a,implementation:i,shim:u}),t.exports=s},function(t,e,r){"use strict";var n=r(182).supportsDescriptors,o=r(350),i=Object.getOwnPropertyDescriptor,a=Object.defineProperty,u=TypeError,s=Object.getPrototypeOf,c=/a/;t.exports=function(){if(!n||!s)throw new u("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=o(),e=s(c),r=i(e,"flags");return r&&r.get===t||a(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},function(t,e,r){"use strict";var n=Date.prototype.getDay,o=Object.prototype.toString,i="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;t.exports=function(t){return"object"==typeof t&&null!==t&&(i?function(t){try{return n.call(t),!0}catch(t){return!1}}(t):"[object Date]"===o.call(t))}},function(t,e,r){(function(e){var r="Expected a function",n="__lodash_placeholder__",o=1,i=2,a=4,u=8,s=16,c=32,l=64,f=128,p=512,d=1/0,h=9007199254740991,v=1.7976931348623157e308,y=NaN,m=[["ary",f],["bind",o],["bindKey",i],["curry",u],["curryRight",s],["flip",p],["partial",c],["partialRight",l],["rearg",256]],g="[object Function]",b="[object GeneratorFunction]",w="[object Symbol]",_=/^\s+|\s+$/g,O=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,x=/\{\n\/\* \[wrapped with (.+)\] \*/,C=/,? & /,S=/^[-+]0x[0-9a-f]+$/i,j=/^0b[01]+$/i,E=/^\[object .+?Constructor\]$/,A=/^0o[0-7]+$/i,k=/^(?:0|[1-9]\d*)$/,T=parseInt,I="object"==typeof e&&e&&e.Object===Object&&e,P="object"==typeof self&&self&&self.Object===Object&&self,M=I||P||Function("return this")();function F(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function D(t,e){return!!(t?t.length:0)&&function(t,e,r){if(e!=e)return function(t,e,r,n){var o=t.length,i=r+(n?1:-1);for(;n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,R,r);var n=r-1,o=t.length;for(;++n<o;)if(t[n]===e)return n;return-1}(t,e,0)>-1}function R(t){return t!=t}function N(t,e){for(var r=-1,o=t.length,i=0,a=[];++r<o;){var u=t[r];u!==e&&u!==n||(t[r]=n,a[i++]=r)}return a}var L=Function.prototype,G=Object.prototype,U=M["__core-js_shared__"],z=function(){var t=/[^.]+$/.exec(U&&U.keys&&U.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),B=L.toString,V=G.hasOwnProperty,q=G.toString,$=RegExp("^"+B.call(V).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),H=Object.create,Y=Math.max,J=Math.min,W=function(){var t=rt(Object,"defineProperty"),e=rt.name;return e&&e.length>2?t:void 0}();function Q(t){return!(!at(t)||function(t){return!!z&&z in t}(t))&&(function(t){var e=at(t)?q.call(t):"";return e==g||e==b}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?$:E).test(function(t){if(null!=t){try{return B.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function K(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=function(t){return at(t)?H(t):{}}(t.prototype),n=t.apply(r,e);return at(n)?n:r}}function Z(t,e,r,n,a,c,l,d,h,v){var y=e&f,m=e&o,g=e&i,b=e&(u|s),w=e&p,_=g?void 0:K(t);return function o(){for(var i=arguments.length,u=Array(i),s=i;s--;)u[s]=arguments[s];if(b)var f=et(o),p=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&n++;return n}(u,f);if(n&&(u=function(t,e,r,n){for(var o=-1,i=t.length,a=r.length,u=-1,s=e.length,c=Y(i-a,0),l=Array(s+c),f=!n;++u<s;)l[u]=e[u];for(;++o<a;)(f||o<i)&&(l[r[o]]=t[o]);for(;c--;)l[u++]=t[o++];return l}(u,n,a,b)),c&&(u=function(t,e,r,n){for(var o=-1,i=t.length,a=-1,u=r.length,s=-1,c=e.length,l=Y(i-u,0),f=Array(l+c),p=!n;++o<l;)f[o]=t[o];for(var d=o;++s<c;)f[d+s]=e[s];for(;++a<u;)(p||o<i)&&(f[d+r[a]]=t[o++]);return f}(u,c,l,b)),i-=p,b&&i<v){var O=N(u,f);return X(t,e,Z,o.placeholder,r,u,O,d,h,v-i)}var x=m?r:this,C=g?x[t]:t;return i=u.length,d?u=function(t,e){for(var r=t.length,n=J(e.length,r),o=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(t);n--;){var i=e[n];t[n]=nt(i,r)?o[i]:void 0}return t}(u,d):w&&i>1&&u.reverse(),y&&h<i&&(u.length=h),this&&this!==M&&this instanceof o&&(C=_||K(C)),C.apply(x,u)}}function X(t,e,r,n,s,f,p,d,h,v){var y=e&u;e|=y?c:l,(e&=~(y?l:c))&a||(e&=~(o|i));var m=r(t,e,s,y?f:void 0,y?p:void 0,y?void 0:f,y?void 0:p,d,h,v);return m.placeholder=n,ot(m,t,e)}function tt(t,e,n,a,f,p,d,h){var v=e&i;if(!v&&"function"!=typeof t)throw new TypeError(r);var y=a?a.length:0;if(y||(e&=~(c|l),a=f=void 0),d=void 0===d?d:Y(st(d),0),h=void 0===h?h:st(h),y-=f?f.length:0,e&l){var m=a,g=f;a=f=void 0}var b=[t,e,n,a,f,m,g,p,d,h];if(t=b[0],e=b[1],n=b[2],a=b[3],f=b[4],!(h=b[9]=null==b[9]?v?0:t.length:Y(b[9]-y,0))&&e&(u|s)&&(e&=~(u|s)),e&&e!=o)w=e==u||e==s?function(t,e,r){var n=K(t);return function o(){for(var i=arguments.length,a=Array(i),u=i,s=et(o);u--;)a[u]=arguments[u];var c=i<3&&a[0]!==s&&a[i-1]!==s?[]:N(a,s);return(i-=c.length)<r?X(t,e,Z,o.placeholder,void 0,a,c,void 0,void 0,r-i):F(this&&this!==M&&this instanceof o?n:t,this,a)}}(t,e,h):e!=c&&e!=(o|c)||f.length?Z.apply(void 0,b):function(t,e,r,n){var i=e&o,a=K(t);return function e(){for(var o=-1,u=arguments.length,s=-1,c=n.length,l=Array(c+u),f=this&&this!==M&&this instanceof e?a:t;++s<c;)l[s]=n[s];for(;u--;)l[s++]=arguments[++o];return F(f,i?r:this,l)}}(t,e,n,a);else var w=function(t,e,r){var n=e&o,i=K(t);return function e(){return(this&&this!==M&&this instanceof e?i:t).apply(n?r:this,arguments)}}(t,e,n);return ot(w,t,e)}function et(t){return t.placeholder}function rt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Q(r)?r:void 0}function nt(t,e){return!!(e=null==e?h:e)&&("number"==typeof t||k.test(t))&&t>-1&&t%1==0&&t<e}var ot=W?function(t,e,r){var n=e+"";return W(t,"toString",{configurable:!0,enumerable:!1,value:function(t){return function(){return t}}(function(t,e){var r=e.length,n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(O,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(m,function(r){var n="_."+r[0];e&r[1]&&!D(t,n)&&t.push(n)}),t.sort()}(function(t){var e=t.match(x);return e?e[1].split(C):[]}(n),r)))})}:function(t){return t};var it=function(t,e){return e=Y(void 0===e?t.length-1:e,0),function(){for(var r=arguments,n=-1,o=Y(r.length-e,0),i=Array(o);++n<o;)i[n]=r[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=r[n];return a[e]=i,F(t,this,a)}}(function(t,e,r){var n=o;if(r.length){var i=N(r,et(it));n|=c}return tt(t,n,e,r,i)});function at(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function ut(t){return t?(t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&q.call(t)==w}(t))return y;if(at(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=at(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(_,"");var r=j.test(t);return r||A.test(t)?T(t.slice(2),r?2:8):S.test(t)?y:+t}(t))===d||t===-d?(t<0?-1:1)*v:t==t?t:0:0===t?t:0}function st(t){var e=ut(t),r=e%1;return e==e?r?e-r:e:0}it.placeholder={},t.exports=it}).call(e,r(26))},function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(n=(a=u.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&u.return&&u.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0};function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var u=r(218),s=r(217),c=r(160),l=r(492),f=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),a(r=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,u),o(e,[{key:"freeze",value:function(){c.freeze(this.data),c.freeze(this.data.rows),c.freeze(this.data.cols)}},{key:"name",value:function(){return"TableOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return{table:this.data}}},{key:"skipDiff",value:function(){return!0}},{key:"_genericSet",value:function(t){var r=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_genericSet",this).call(this,t),n=r.changed,o=r.op;if("object"==typeof o.data){if(o.data.rows||(o.data.rows=new s),o.data.cols||(o.data.cols=new s),o.data.cells||(o.data.cells={}),"function"!=typeof o.data.cells.name&&(o.data.cells=new l({action:o.action,cells:o.data.cells})),"function"!=typeof o.data.rows.pack)throw new Error("rows should be a Delta");if("function"!=typeof o.data.cols.pack)throw new Error("cols should be a Delta");"retain"===o.action&&o.data.rows.isEmpty()&&o.data.cols.isEmpty()&&!Object.keys(o.data.cells).length&&(o.data=1)}if("insert"===o.action){if(!o.data.rows.isDocument())throw new Error("rows should be a document");if(!o.data.cols.isDocument())throw new Error("cols should be a document")}return{changed:n,op:o}}},{key:"pack",value:function(){var t=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"pack",this).call(this);if("object"==typeof t[1]){var r=t[1],n=r.cells,o=r.rows,a=r.cols;if(t[1]=[n.pack()],o.isEmpty()&&a.isEmpty())return t;a.isEmpty()?t[1].push(o.pack()):(t[1].push(o.isEmpty()?0:o.pack()),t[1].push(a.pack()))}return t}},{key:"compose",value:function(t){var r=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"compose",this).call(this,t);if("number"==typeof this.data||"number"==typeof t.data)return r;var n={rows:r.data.rows.compose(t.data.rows),cols:r.data.cols.compose(t.data.cols)},o=new l({cells:r.data.cells,action:r.action});return o.composeWithMutations(t.data),t.data.cells.forEach(function(e){var r=o.get(e),n=t.data.cells.get(e);o.set(e,r.compose(n))}),n.cells=o,r.set({data:n})}},{key:"invert",value:function(t){var r=this,n=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"invert",this).call(this,t);if("number"==typeof this.data||"number"==typeof t.data)return n;var o={rows:this.data.rows.invert(t.data.rows),cols:this.data.cols.invert(t.data.cols)},a=new l({cells:t.data.cells,action:n.action});a.composeWithMutations(o,function(e,n){try{return r.data.cells.get(n).invert(e)}catch(e){throw new Error(e.message+": "+t.getAttributes().id+", "+n)}});var u=t.data.rows.isEmpty(),s=t.data.cols.isEmpty();return u&&s||this.data.cells.forEach(function(e){var n=c.parsePosition(e),o=n.row,i=n.col;null!==t.data.rows.composePosition(o)&&null!==t.data.cols.composePosition(i)||a.set(e,r.data.cells.get(e))}),o.cells=a,n.set({data:o})}},{key:"transform",value:function(t,r){var n=this,o=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"transform",this).call(this,t,r);if("number"==typeof this.data||"number"==typeof t.data)return o;var a={rows:o.data.rows.transform(this.data.rows,!r),cols:o.data.cols.transform(this.data.cols,!r)},u={rows:this.data.rows.transform(t.data.rows,r),cols:this.data.cols.transform(t.data.cols,r)},s=new l({cells:t.data.cells,action:o.action});s.composeWithMutations(a);var f=t.data.rows.isEmpty(),p=t.data.cols.isEmpty();return this.data.cells.forEach(function(t){var e=c.parsePosition(t),o=e.row,i=e.col;if(f||(o=u.rows.composePosition(o)),p||(i=u.cols.composePosition(i)),null!==o&&null!==i){var a=c.stringifyPosition(o,i);s.set(a,n.data.cells.get(t).transform(s.get(a),r))}}),u.cells=s,o.set({data:u})}}],[{key:"unpack",value:function(t){if(Array.isArray(t[1])){var r=n(t[1],3),o=r[0],a=r[1],u=r[2];t[1]={rows:a?s.unpack(a):null,cols:u?s.unpack(u):null,cells:o}}return i(e.__proto__||Object.getPrototypeOf(e),"unpack",this).call(this,t)}}]),e}();f.packId=3,t.exports=f},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o=r(351),i=r(217),a=r(160),u=r(493),s=function(){function t(e){var r=e.cells,n=e.action;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cells={},"function"==typeof r.name)for(var o in this.proto=r.proto,r.cells)r.cells.hasOwnProperty(o)&&(this.cells[o]=r.cells[o]);else this.proto=r;this.action=n}return n(t,[{key:"name",value:function(){return"CellManager"}},{key:"keys",value:function(){var t=[];return this.forEach(function(e){t.push(e)}),t}},{key:"get",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=void 0;return(n=void 0===this.cells[t]?this.proto[t]:this.cells[t])?(e&&Array.isArray(n)&&(n=this.cells[t]=o.operatorUnpacker(n)),n.action&&n.action!==this.action&&(n=this.cells[t]=n.set({action:this.action}))):n=r?null:new o({action:this.action,data:"insert"===this.action?new i:1}),n&&1===n.constructor.packId&&(n=new o({action:n.action,attributes:n.attributes,data:n.data})),n}},{key:"forEach",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var r in this.cells)!this.cells.hasOwnProperty(r)||e&&null===this.cells[r]||t(r);for(var n in this.proto)this.proto.hasOwnProperty(n)&&!this.cells.hasOwnProperty(n)&&null!==this.proto[n]&&t(n)}},{key:"some",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var r in this.cells)if(this.cells.hasOwnProperty(r)&&t(r))return!0;if(!e)for(var n in this.proto)if(this.proto.hasOwnProperty(n)&&!this.cells.hasOwnProperty(n)&&t(n))return!0;return!1}},{key:"set",value:function(t,e){this.cells[t]=e||null}},{key:"composeWithMutations",value:function(t,e){var r=this,n=t.rows,o=t.cols,i=n.isEmpty(),u=o.isEmpty();if(!i||!u||e){var s={},c={row:{},col:{}};this.forEach(function(t){var l=a.parsePosition(t),f=l.row,p=l.col;if(i||(void 0===c.row[f]&&(c.row[f]=n.composePosition(f)),f=c.row[f]),u||(void 0===c.col[p]&&(c.col[p]=o.composePosition(p)),p=c.col[p]),s[t]||(s[t]=null),null!==f&&null!==p){var d=a.stringifyPosition(f,p),h=r.get(t,!0,!e);s[d]=e?e(h,d):h}},!1),this.cells=s}}},{key:"pack",value:function(){var t=this,e={};return this.forEach(function(r){var n=t.get(r,!1);Array.isArray(n)?e[r]=n:(n.attributes||n.data.isEmpty&&!n.data.isEmpty())&&(e[r]=n.pack())}),u(e)?0:e}}]),t}();t.exports=s},function(t,e,r){(function(t,r){var n=9007199254740991,o="[object Arguments]",i="[object Function]",a="[object GeneratorFunction]",u="[object Map]",s="[object Set]",c=/^\[object .+?Constructor\]$/,l="object"==typeof t&&t&&t.Object===Object&&t,f="object"==typeof self&&self&&self.Object===Object&&self,p=l||f||Function("return this")(),d="object"==typeof e&&e&&!e.nodeType&&e,h=d&&"object"==typeof r&&r&&!r.nodeType&&r,v=h&&h.exports===d;var y=Function.prototype,m=Object.prototype,g=p["__core-js_shared__"],b=function(){var t=/[^.]+$/.exec(g&&g.keys&&g.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),w=y.toString,_=m.hasOwnProperty,O=m.toString,x=RegExp("^"+w.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),C=v?p.Buffer:void 0,S=m.propertyIsEnumerable,j=C?C.isBuffer:void 0,E=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),A=U(p,"DataView"),k=U(p,"Map"),T=U(p,"Promise"),I=U(p,"Set"),P=U(p,"WeakMap"),M=!S.call({valueOf:1},"valueOf"),F=B(A),D=B(k),R=B(T),N=B(I),L=B(P);function G(t){return!(!J(t)||function(t){return!!b&&b in t}(t))&&(Y(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?x:c).test(B(t))}function U(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return G(r)?r:void 0}var z=function(t){return O.call(t)};function B(t){if(null!=t){try{return w.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function V(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&$(t)}(t)&&_.call(t,"callee")&&(!S.call(t,"callee")||O.call(t)==o)}(A&&"[object DataView]"!=z(new A(new ArrayBuffer(1)))||k&&z(new k)!=u||T&&"[object Promise]"!=z(T.resolve())||I&&z(new I)!=s||P&&"[object WeakMap]"!=z(new P))&&(z=function(t){var e=O.call(t),r="[object Object]"==e?t.constructor:void 0,n=r?B(r):void 0;if(n)switch(n){case F:return"[object DataView]";case D:return u;case R:return"[object Promise]";case N:return s;case L:return"[object WeakMap]"}return e});var q=Array.isArray;function $(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}(t.length)&&!Y(t)}var H=j||function(){return!1};function Y(t){var e=J(t)?O.call(t):"";return e==i||e==a}function J(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}r.exports=function(t){if($(t)&&(q(t)||"string"==typeof t||"function"==typeof t.splice||H(t)||V(t)))return!t.length;var e=z(t);if(e==u||e==s)return!t.size;if(M||function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||m)}(t))return!E(t).length;for(var r in t)if(_.call(t,r))return!1;return!0}}).call(e,r(26),r(32)(t))},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var i=r(218),a=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),n(e,[{key:"name",value:function(){return"TextOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return this.data}},{key:"setData",value:function(t){switch(function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.action){case"insert":if("string"!=typeof this.data&&"object"!=typeof this.data)throw new Error('data should be a string or an object for "insert" action, got '+this.data);break;case"retain":if("number"!=typeof this.data)throw new Error('data should be a number for "'+this.action+'" action, got '+this.data)}return this}}]),e}();a.packId=2,t.exports=a},,,,,function(t,e,r){var n=r(749),o=r(531);t.exports=function(t){return n(o(t))}},function(t,e,r){var n=r(531);t.exports=function(t){return Object(n(t))}},function(t,e,r){var n=r(440),o=r(441),i=r(599);t.exports=n?function(t,e,r){return o.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on "+t);return t}},function(t,e){t.exports=!1},function(t,e,r){var n=r(757),o=Math.min;t.exports=function(t){return t>0?o(n(t),9007199254740991):0}},function(t,e,r){var n=r(667);t.exports=function(t){if(n(t))throw TypeError("Cannot convert a Symbol value to a string");return String(t)}},function(t,e,r){var n=r(265);t.exports=n},function(t,e,r){var n=r(441).f,o=r(317),i=r(238)("toStringTag");t.exports=function(t,e,r){t&&!o(t=r?t:t.prototype,i)&&n(t,i,{configurable:!0,value:e})}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.deltaConstructor=t,this.operatorConstructor=e}return t.prototype.compose=function(t,e,r){throw new Error("#compose() is not implemented")},t.prototype.transform=function(t,e,r){throw new Error("#transform() is not implemented")},t.prototype.invert=function(t,e){throw new Error("#invert() is not implemented")},t.prototype.parse=function(t){throw new Error("#parse() is not implemented")},t.prototype.pack=function(t,e){throw new Error("#pack() is not implemented")},t.prototype.toJSON=function(t){throw new Error("#toJSON() is not implemented")},t.prototype.explain=function(t,e){return""+t+e},t}();e.default=n},function(t,e,r){var n=r(440),o=r(664),i=r(599),a=r(499),u=r(666),s=r(317),c=r(1010),l=Object.getOwnPropertyDescriptor;e.f=n?l:function(t,e){if(t=a(t),e=u(e),c)try{return l(t,e)}catch(t){}if(s(t,e))return i(!o.f.call(t,e),t[e])}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,r){var n=r(265);t.exports=function(t,e){return arguments.length<2?function(t){return"function"==typeof t?t:void 0}(n[t]):n[t]&&n[t][e]}},function(t,e){t.exports={}},function(t,e,r){var n=r(265),o=r(765),i=Function.call;t.exports=function(t,e,r){return o(i,n[t].prototype[e],r)}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u=r(279),s=a(r(309)),c=a(r(262)),l=r(604),f=r(605),p=r(674),d=r(771);e.FORM_VERSION=2,e.CREATE_AT="CREATE_AT",e.CREATE_BY="CREATE_BY",e.CHANNEL="CHANNEL",e.DEFAULT_FORM_SHEET_ID="MODOC",e.DEFAULT_COLUMN_COUNT=18,e.DEFAULT_ROW_COUNT=200,e.getModocOperators=function(t){for(var e=[],r=t.getIter();r.hasNext();)e.push(r.next());return e},e.getOperatorSize=function(t){return t.reduce(function(t,e){return t+("number"==typeof e.data?e.data:1)},0)},e.getCellContent=function(t){if(t){var e=t.data,r=t.attributes;if(r&&null!=r.cellValue)return r.cellValue;if(Array.isArray(e&&e.delta)){var n=o(e&&e.delta,1)[0];return n?n.value:void 0}}},e.skipCellOp={action:"retain",attributes:{},data:1},e.createInlineImageCellOp=function(t,r,o){return void 0===o&&(o={}),null==t?e.skipCellOp:{action:"retain",attributes:n({"font-size":9,wrap:null,vertical:"middle",userId:r,authorId:r,cellValue:null,backgroundImage:t.url,backgroundImageLayout:4,backgroundImageSize:JSON.stringify([String(t.width),String(t.height)])},o),data:1}},e.createTextCellOp=function(t,r,o){return void 0===o&&(o={}),null==t||""===t?e.skipCellOp:{action:"retain",attributes:n({"font-size":9,wrap:"text-no-wrap",format:"@",vertical:"middle",userId:r,authorId:r,cellValue:t},o),data:1}},e.questionResponseToCellOp=function(t){var r=t.question,n=t.response,o=t.userId;if(!p.isQuestionTypeCompatible(r.type,n.type))throw new TypeError("question/response incompatible: "+r.type+", "+n.type);var i=d.questionProviders[n.type];if(r.type===f.FormQuestions.ImageType)return e.createInlineImageCellOp(n.response&&n.response.image,o);var a=i.getResponseText(r.question,n.response,{exportSpread:!0});return e.createTextCellOp(a,o)};var h=function(t){var e=t.data,r=t.getAttributes()||{},n=e.rows.ops.map(function(t){var e=t.data;return{attributes:t.getAttributes()||{},data:e}}),o=e.cols.ops.map(function(t){var e=t.data;return{attributes:t.getAttributes()||{},data:e}}),i=e.cells,a={};return i.forEach(function(t){var e=i.get(t),r=e.data,n=e.getAttributes()||{};a[t]={data:r,attributes:n}}),{attributes:r,cells:a,rows:n,columns:o}},v=function(t){var e=t.attributes,r=void 0===e?{}:e,n=t.data.table,o={},i=0;return{attributes:r,rows:n.rows.map(function(t){var e=t,r=e.attributes;return{attributes:void 0===r?{}:r,data:e.data}}),columns:n.cols.map(function(t){var e=t,r=e.attributes,n=void 0===r?{}:r,a=e.data;if("number"==typeof a)i+=a;else{var u=0;a.delta.forEach(function(t){var e=t,r=e.data,n=e.attributes,a=void 0===n?{}:n;if(a&&null!=a.cellValue||"number"!=typeof r){for(var s="number"==typeof r?r:1,c=0;c<s;c++)o[l.toCellName(u+c,i)]={attributes:a,data:r};u+=s}else u+=r}),i+=1}return{attributes:n,data:"number"==typeof a?a:1}}),cells:o}};e.toSpread=function(t,e){switch(e){case"modoc":return function(t){return t.toJSON().map(v)}("string"==typeof t?new s.Delta(t):t);case"richdoc":return function(t){return t.ops.map(h)}("string"==typeof t?c.unpack(t):t);default:return u.assertNever(e)}},e.toTextTable=function(t){for(var r=t.cells,n=Object.keys(r).filter(function(t){return e.getCellContent(r[t])}).map(l.fromCellName),o=Math.max.apply(Math,i([-1],n.map(function(t){return t.row})))+1,a=Math.max.apply(Math,i([-1],n.map(function(t){return t.column})))+1,u=[],s=0;s<o;s++){for(var c=[],f=0;f<a;f++){var p=l.toCellName(s,f);r[p]&&e.getCellContent(r[p])?c.push(e.getCellContent(r[p])):c.push(void 0)}u.push(c)}return u}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toColumnName=function(t){if(!(t>=0))throw new Error("Invalid column: "+t);for(var e=t+1,r="";e>0;){var n=(e-1)%26;r=String.fromCharCode(65+n)+r,e=Math.floor((e-n)/26)}return r},e.fromColumnName=function(t){for(var e=0,r=0;r<t.length;r++){var n=t[r].charCodeAt(0);if(!(n>=65&&n<=90))throw new Error("Invalid cell position "+t);e=26*e+n-64}return e},e.toCellName=function(t,e){if(!(t>=0&&e>=0))throw new Error("Invalid cell position "+t+":"+e);for(var r=e+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(t+1)},e.fromCellName=function(t){for(var e=0,r=0,n=0;n<t.length;n++){var o=t[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+t);e=10*e+o-48}}return{row:e-1,column:r-1}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form");!function(t){t.TextType="text",t.MultipleTextType="multiple_text",t.SingleChoiceType="single_choice",t.MultipleChoiceType="multiple_choice",t.DropdownListType="dropdown_list",t.RateType="rate",t.DateType="date",t.TimeType="time",t.NumberType="number",t.NameType="name",t.PhoneType="phone",t.EmailType="email",t.AddressType="address",t.ImageType="image",t.List=[t.TextType,t.MultipleTextType,t.SingleChoiceType,t.MultipleChoiceType,t.DropdownListType,t.RateType,t.DateType,t.TimeType,t.NumberType,t.ImageType,t.NameType,t.PhoneType,t.EmailType,t.AddressType]}(e.FormQuestions||(e.FormQuestions={})),function(t){t.ConditionalType="conditional"}(e.FormRules||(e.FormRules={}));e.FORM_KEYS=Object.keys({viewMode:"classic",title:"title",desc:"desc",descAlign:"left",questions:[],rules:[]}),e.FORM_DEFAULT_TITLE=n("未命名表单");var o={formId:1,status:"unpublished",spreadGuid:"123",sheetGuid:"123",fillLimit:"once",deadline:new Date,channels:[]};e.PUBLISH_STATUS_KEYS=Object.keys(o)},function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(1607));e.produce=o.produce},function(t,e,r){"use strict";var n;!function(t){t.Rendered="Rendered",t.Change="Change",t.SetContentSucceeded="SetContentSucceeded",t.SpreadRendered="SpreadRendered",t.SpreadReseted="SpreadReseted",t.AfterSheetRendered="AfterSheetRendered",t.SheetSwitched="SheetSwitched",t.SpreadAttributesChanged="SpreadAttributesChanged",t.BeforeChange="BeforeChange",t.ActiveCellAttrsChanged="ActiveCellAttrsChanged",t.FilterChanged="FilterChanged",t.FrozenChanged="FrozenChanged",t.ColWidthChanged="ColWidthChanged",t.RowHeightChanged="RowHeightChanged",t.AfterHoveredCellChanged="AfterHoveredCellChanged",t.NewSheetInserted="NewSheetInserted",t.CopiedSheet="CopiedSheet",t.BeforeSheetRename="BeforeSheetRename",t.RenamedSheet="RenamedSheet",t.AfterClipboardPasted="AfterClipboardPasted",t.AfterSelectionChanged="AfterSelectionChanged",t.BeforeChangeApplied="BeforeChangeApplied",t.AfterSheetTabChanged="AfterSheetTabChanged",t.AfterChangeApplied="AfterChangeApplied",t.AfterSheetFullApply="AfterSheetFullApply",t.AfterSheetQuickApply="AfterSheetQuickApply",t.AfterSheetFullRendered="AfterSheetFullRendered",t.AfterSheetQuickRendered="AfterSheetQuickRendered",t.AfterContentChanged="AfterContentChanged",t.FloatingObjectClick="FloatingObjectClick",t.TopRowChanged="TopRowChanged",t.RowOrColChanged="RowOrColChanged",t.RowOrColDeleted="RowOrColDeleted",t.RowOrColVisibleChanged="RowOrColVisibleChanged",t.LeftColumnChanged="LeftColumnChanged",t.SheetTabDeltaClick="SheetTabDeltaClick",t.SheetTabClick="SheetTabClick",t.RangeFiltered="RangeFiltered",t.BeforeSheetDelete="BeforeSheetDelete",t.DeleteSheet="DeleteSheet",t.PermissionChanged="PermissionChanged",t.DisplayTabFullname="DisplayTabFullname",t.OptionsChanged="OptionsChanged",t.OnCalcOperator="OnCalcOperator",t.CalcCsQueueEmpty="CalcCsQueueEmpty",t.ReadyToHandleChanges="readyToHandleChanges",t.PluginsReadyToHandleChanges="PluginsReadyToHandleChanges",t.PluginInstalled="PluginInstalled",t.HistoryPreviewShown="HistoryPreviewShown",t.HistoryPreviewHidden="HistoryPreviewHidden",t.VersionPreviewShown="VersionPreviewShown",t.VersionPreviewHidden="VersionPreviewHidden",t.ToggleSearch="ToggleSearch",t.StartSelectRange="StartSelectRange",t.QuitSelectRange="QuitSelectRange",t.AddToCache="AddToCache",t.Error="Error",t.InvertError="InvertError",t.ApplyChangeError="ApplyChangeError",t.CsError="CsError",t.StreamError="StreamError",t.GenerateOperatorError="GenerateOperatorError",t.Track="Track",t.Offlined="Offlined",t.SaveCsToLocalSuccess="SaveCsToLocalSuccess",t.CollectPasteDataError="CollectPasteDataError",t.AfterSelectedCellChanged="AfterSelectedCellChanged",t.LayoutChanged="LayoutChanged",t.TurnToFilterViewport="TurnToFilterViewport",t.QuitFilterViewport="QuitFilterViewport",t.BeforeOpenFilterDialog="BeforeOpenFilterDialog",t.UserZooming="UserZooming",t.Scrolling="Scrolling",t.CellClick="CellClick",t.CellLinkClick="CellLinkClick",t.CellDoubleClick="CellDoubleClick",t.CellLongTapped="CellLongTapped",t.EditStarted="EditStarted",t.EditChange="EditChange",t.EditEnded="EditEnded",t.PictureTapped="PictureTapped",t.PictureDoubleTapped="PictureDoubleTapped",t.FloatingObjectTapped="FloatingObjectTapped",t.FloatingObjectDoubleTapped="FloatingObjectDoubleTapped",t.FloatingObjectCutting="FloatingObjectCutting",t.SheetTabListUpdated="SheetTabListUpdated",t.ClipboardChanged="ClipboardChanged",t.PasteImageByChromeExtension="PasteImageByChromeExtension",t.SheetCalcFormulaParsed="SheetCalcFormulaParsed",t.RangeSorted="RangeSorted",t.FilterRangeSort="FilterRangeSort",t.AfterCellsChanged="AfterCellsChanged",t.EditorInited="EditorInited",t.NewCrossSheetRef="NewCrossSheetRef",t.OnFixCsrFormulas="OnFixCsrFormulas",t.AdjustFormulaOnRenameCustomName="AdjustFormulaOnRenameCustomName",t.AdjustCustomNameFormulasOnOperator="AdjustCustomNameFormulasOnOperator",t.RecalculateAllEnd="RecalculateAllEnd",t.RecalculateUpdated="RecalculateUpdated",t.ChangeStyleOnPaintingCell="ChangeStyleOnPaintingCell",t.ReceiveChangeReady="ReceiveChangeReady",t.ScrollStart="ScrollStart",t.ScrollEnd="ScrollEnd",t.InvalidOperation="InvalidOperation",t.CellMentionItemClicked="CellMentionItemClicked",t.ToggleHighlightPosition="ToggleHighlightPosition",t.RemarksFocusChanged="RemarksFocusChanged",t.CellAppendantPositionChanged="CellAppendantPositionChanged",t.AfterAddOrDeleteCells="AfterAddOrDeleteCells",t.ToggleMobileKeyboard="ToggleMobileKeyboard",t.FullScreenChange="FullScreenChange",t.ToggleFormulaVisibility="ToggleFormulaVisibility",t.MenuStateChanged="MenuStateChanged"}(n||(n={})),e.a=n},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1482),o=r(1494);!function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(748)),e.Changeset={Richdoc:o.changeset,Modoc:n.changeset}},function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.PUSHED=0]="PUSHED",t[t.MERGED=1]="MERGED",t[t.REORDERED=2]="REORDERED"}(n=e.PushResult||(e.PushResult={}));var o=function(){function t(t){void 0===t&&(t=[]),this.stringified=!1,this.ops=t}return t.prototype.push=function(t){if(this.stringified)throw new Error("Cannot push new operators to a stringified operatorList");var e=this.ops.length;if(0===e)return this.ops.push(t),n.PUSHED;var r=n.PUSHED,o=this.ops[e-1];if("remove"===o.action&&"insert"===t.action&&(e-=1,o=this.ops[e-1],r=n.REORDERED,void 0===o))return this.ops.unshift(t),r;var i=o.merge(t);return i?(this.ops[e-1]=i,r=n.MERGED):e===this.ops.length?this.ops.push(t):this.ops.splice(e,0,t),r},t.prototype.stringify=function(t){void 0===t&&(t=!1),this.stringified=!0;for(var e=this.ops.length,r="",n=0;n<e;n++){var o=this.ops[n];(!t||n<e-1||!o.isEmpty())&&(r+=o.stringify())}return r},t}();e.default=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.toColumnName=function(t){if(!(t>=0))throw new Error("Invalid column: "+t);for(var e=t+1,r="";e>0;){var n=(e-1)%26;r=String.fromCharCode(65+n)+r,e=Math.floor((e-n)/26)}return r},e.fromColumnName=function(t){for(var e=0,r=0;r<t.length;r++){var n=t[r].charCodeAt(0);if(!(n>=65&&n<=90))throw new Error("Invalid cell position "+t);e=26*e+n-64}return e},e.toCellName=function(t,e){if(!(t>=0&&e>=0))throw new Error("Invalid cell position "+t+":"+e);for(var r=e+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(t+1)},e.fromCellName=function(t){for(var e=0,r=0,n=0;n<t.length;n++){var o=t[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+t);e=10*e+o-48}}return{row:e-1,column:r-1}}},function(t,e,r){"use strict";function n(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}Object.defineProperty(e,"__esModule",{value:!0}),n(r(1497)),n(r(1003));var o=r(1006);e.ServerTypes=o;var i=r(1005);e.ServerAdapters=i},function(t,e,r){"use strict";var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!n.call({1:2},1);e.f=i?function(t){var e=o(this,t);return!!e&&e.enumerable}:n},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e,r){var n=r(1509),o=r(667);t.exports=function(t){var e=n(t,"string");return o(e)?e:String(e)}},function(t,e,r){var n=r(600),o=r(1009);t.exports=o?function(t){return"symbol"==typeof t}:function(t){var e=n("Symbol");return"function"==typeof e&&Object(t)instanceof e}},function(t,e,r){var n=r(265),o=r(501),i=r(317),a=r(754),u=r(1012),s=r(669),c=s.get,l=s.enforce,f=String(String).split("String");(t.exports=function(t,e,r,u){var s,c=!!u&&!!u.unsafe,p=!!u&&!!u.enumerable,d=!!u&&!!u.noTargetGet;"function"==typeof r&&("string"!=typeof e||i(r,"name")||o(r,"name",e),(s=l(r)).source||(s.source=f.join("string"==typeof e?e:""))),t!==n?(c?!d&&t[e]&&(p=!0):delete t[e],p?t[e]=r:o(t,e,r)):p?t[e]=r:a(e,r)})(Function.prototype,"toString",function(){return"function"==typeof this&&c(this).source||u(this)})},function(t,e,r){var n,o,i,a=r(1512),u=r(265),s=r(365),c=r(501),l=r(317),f=r(753),p=r(670),d=r(671),h=u.WeakMap;if(a||f.state){var v=f.state||(f.state=new h),y=v.get,m=v.has,g=v.set;n=function(t,e){if(m.call(v,t))throw new TypeError("Object already initialized");return e.facade=t,g.call(v,t,e),e},o=function(t){return y.call(v,t)||{}},i=function(t){return m.call(v,t)}}else{var b=p("state");d[b]=!0,n=function(t,e){if(l(t,b))throw new TypeError("Object already initialized");return e.facade=t,c(t,b,e),e},o=function(t){return l(t,b)?t[b]:{}},i=function(t){return l(t,b)}}t.exports={set:n,get:o,has:i,enforce:function(t){return i(t)?o(t):n(t,{})},getterFor:function(t){return function(e){var r;if(!s(e)||(r=o(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}}},function(t,e,r){var n=r(752),o=r(755),i=n("keys");t.exports=function(t){return i[t]||(i[t]=o(t))}},function(t,e){t.exports={}},function(t,e,r){var n=r(1014),o=r(758);t.exports=Object.keys||function(t){return n(t,o)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.defaultLocale="zh-CN";var n=e.defaultLocale;try{n=document.documentElement.getAttribute("lang")||navigator.language}catch(t){}e.locale={en:"en-US",jp:"ja-JP",cn:"zh-CN"}[n]||n||e.defaultLocale;var o=!1;try{o=/debug=1/.test(window.location.search)||/dev/.test(ENV.NODE_ENV)}catch(t){}e.isDebugging=o},function(t,e,r){"use strict";var n=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},s=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(u(arguments[e]));return t},c=this;Object.defineProperty(e,"__esModule",{value:!0});var l=r(178).getS18n("lizard-service-form"),f=r(1029),p=r(279),d=r(676),h=r(1610),v=r(1611),y=r(1612),m=r(606),g=r(675),b=r(771),w=r(1628),_=r(673);e.generateFormGuid=function(){return d.generateId(8)},e.generateQuestionGuid=function(){return d.generateId(8)},e.generateRuleGuid=function(){return d.generateId(8)},e.createForm=function(t){void 0===t&&(t={});var e=t.questions,r=void 0===e?[]:e,n=t.rules,o=void 0===n?[]:n,i=t.title,a=void 0===i?"":i,u=t.desc,s=void 0===u?"":u,c=t.descAlign,l=void 0===c?"center":c,f=t.viewMode;return{questions:r,rules:o,title:a,desc:s,descAlign:l,viewMode:void 0===f?"classic":f}},e.createQuestion=function(t){return{guid:e.generateQuestionGuid(),type:t.type,required:!0,subject:t.initSubject?t.initSubject():"",question:t.initQuestion(),response:t.initResponse()}},e.createRule=function(t){return{guid:e.generateRuleGuid(),type:t.type,rule:t.initRule()}},e.createPublishStatus=function(t){return{formId:t,status:"unpublished",channels:[]}},e.fillForm=function(t,r){return m.produce(t,function(t){t.questions.forEach(function(t){var n=b.questionProviders[t.type],o=r&&r.questions.find(function(r){return e.isQuestionEqual(r,t)});t.response=o&&o.response||n.initResponse(),t.error=void 0})})},e.toText=function(t,e){void 0===e&&(e={separator:"\n"});var r=t.title,n=t.desc,o=t.questions;return s([r,n],o.map(function(t){var r;switch(t.type){case"text":case"multiple_text":case"address":case"image":case"rate":case"time":case"email":case"number":case"date":case"name":case"phone":r="";break;case"multiple_choice":case"single_choice":case"dropdown_list":r=t.question.options.map(function(t){switch(t.type){case"normal":return t.label;case"other":return"";default:return p.softAssertNever(t),""}}).filter(Boolean).join(e.separator);break;default:p.softAssertNever(t),r=JSON.stringify(t.question)}return s([t.subject],""===r?[]:[r]).join(e.separator)})).join(e.separator)};var O=Object.keys(e.createForm()),x=["guid","question","required","subject","type"];e.isQuestionEqual=function(t,e){return x.every(function(r){return y.isDeepEqual(t[r],e[r],{ignoreEmptyKey:!0})})},e.isQuestionTypeCompatible=function(t,e){if(t===e)return!0;switch(t){case"text":case"multiple_text":switch(e){case"text":case"multiple_text":return!0;default:return!1}case"single_choice":case"multiple_choice":case"dropdown_list":switch(e){case"single_choice":case"multiple_choice":case"dropdown_list":return!0;default:return!1}case"address":case"date":case"email":case"number":case"rate":case"time":case"name":case"phone":case"image":return!1;default:return p.assertNever(t)}};var C=["guid","rule","type"];e.isRuleEqual=function(t,e){return C.every(function(r){return y.isDeepEqual(t[r],e[r],{ignoreEmptyKey:!0})})},e.isFormEqual=function(t,r){return!(!t||!r)&&O.every(function(n){switch(n){case"viewMode":case"title":case"desc":case"descAlign":return t[n]===r[n];case"questions":var o=t[n],i=r[n];return o&&i&&o.length===i.length&&o.every(function(t,r){return e.isQuestionEqual(t,i[r])});case"rules":var a=t[n],u=r[n];return a&&u&&a.length===u.length&&a.every(function(t,r){return e.isRuleEqual(t,u[r])});default:return p.assertNever(n)}})},e.validateChannel=function(t){if(!/^[0-9a-zA-Z\-]{1,15}$/.test(t))return l(E||(E=n(['后缀只能由 数字/字母/"-" 组成，长度 1~15'],['后缀只能由 数字/字母/"-" 组成，长度 1~15'])))};var S="/api/newforms";e.setApiBase=function(t){S=t};var j=function(t){if(t&&"string"==typeof t.errmsg)throw t;return t};e.checkForm=function(t,e){return i(c,void 0,void 0,function(){var r;return a(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,v.ajax.request(S+"/forms/"+t+"/valid",{method:"GET",data:e?{userFinger:e}:void 0})];case 1:return r=n.sent(),[2,g.convertCheckResult(r)];case 2:throw n.sent();case 3:return[2]}})})},e.fetchPublishedInfo=function(t){return i(c,void 0,void 0,function(){var e,r,n,o,i,u,s;return a(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),r=j,[4,v.ajax.request(S+"/forms/"+t+"/publications",{method:"GET"})];case 1:return e=r.apply(void 0,[a.sent()]),n=e&&JSON.parse(e.publishedContent),o=g.adaptOldForm(n),i=e&&g.fromServerPublishedStatus(e),u=e&&e.publishedRev,[2,{form:o,publishStatus:i,rev:u}];case 2:if((s=a.sent())&&(20221===s.code||/尚未发布/.test(s.errmsg)))return[2,void 0];throw s;case 3:return[2]}})})},e.fetchPublishedForm=function(t){return i(c,void 0,void 0,function(){var r;return a(this,function(n){switch(n.label){case 0:return[4,e.fetchPublishedInfo(t)];case 1:return r=n.sent(),[2,r&&r.form]}})})},e.fetchDraftForm=function(t,e){return void 0===e&&(e=!1),i(c,void 0,void 0,function(){var r,n,o;return a(this,function(i){switch(i.label){case 0:return[4,v.ajax.request(S+"/forms/"+t+"/content",{method:"GET"})];case 1:return(r=i.sent()).contentUrl?(n=function(t){var e="undefined"==typeof window?"https:":window.location.protocol;return t.replace(/^\w+:/,e)},[4,v.ajax.request(n(r.contentUrl),{method:"GET",extract:function(t){var r=t.data,n=t.headers,o=e?Number(n["x-amz-meta-head"]):Number(n["x-oss-meta-head"]),i=e?Number(n["x-amz-meta-length"]):Number(n["x-oss-meta-length"]);return{head:o,content:r.substr(0,i)}}})]):[2,void 0];case 2:return o=i.sent().content,[2,f.toForm(o)]}})})};var E,A=function(t){return t.split("").reverse().join("")};e.encodeDate=function(t,e){return e.substr(3,2)+A(t.getTime().toString(36))},e.decodeDate=function(t,e){try{var r=t.substr(0,2),n=t.substr(2);if(r!==e.substr(3,2))return;var o=parseInt(A(n),36);if(!o||isNaN(o))return;return new Date(o)}catch(t){return}},e.getPreviewLink=function(t,r,n){void 0===n&&(n=60);var o=new Date;return o.setSeconds(0),o.setMilliseconds(0),t+"/forms/"+r+"/preview?t="+e.encodeDate(new Date(o.getTime()+60*n*1e3),r)},e.parsePreviewLink=function(t){var r=u(/\/forms\/(\w+)\/preview\?t=(\w+)\b/.exec(t)||[],3),n=r[1],o=r[2];if(n&&o){var i=e.decodeDate(o,n);return i&&{formGuid:n,expireAt:i}}},e.fetchPublishStatus=function(t){return i(c,void 0,void 0,function(){var r;return a(this,function(n){switch(n.label){case 0:return[4,e.fetchPublishedInfo(t)];case 1:return[2,(r=n.sent())&&r.publishStatus]}})})},e.publishForm=function(t){return i(c,void 0,void 0,function(){var e,r;return a(this,function(n){switch(n.label){case 0:return e=o({},g.toServerPublishedStatus(t.publishStatus),{publishedContent:JSON.stringify(t.form),publishedRev:t.rev,userId:t.userId}),[4,v.ajax.request(S+"/forms/"+t.guid+"/publications",{method:"POST",data:e})];case 1:return r=n.sent(),[2,j(r)]}})})},e.patchPublishStatus=function(t){return i(c,void 0,void 0,function(){var e,r;return a(this,function(n){switch(n.label){case 0:return e=o({},g.toServerPublishedStatus(t.publishStatus),{userId:t.userId}),r=j,[4,v.ajax.request(S+"/forms/"+t.guid+"/publications",{method:"PATCH",data:e})];case 1:return[2,r.apply(void 0,[n.sent()])]}})})},e.unlinkFormAndSheet=function(t){return i(c,void 0,void 0,function(){var e;return a(this,function(r){switch(r.label){case 0:return[4,v.ajax.request(S+"/forms/"+t.guid+"/unlink",{method:"POST"})];case 1:return e=r.sent(),[2,j(e)]}})})},e.postSubmission=function(t){return i(c,void 0,void 0,function(){var e,r;return a(this,function(n){switch(n.label){case 0:return e=o({formRev:t.rev,userFinger:String(t.userId),userName:t.userName,responseContent:t.form.questions.map(function(t){var e=t.guid,r=t.type,n=t.response;return g.toServerResponse(e,r,n)}).filter(Boolean)},t.channel?{channel:t.channel}:{}),[4,v.ajax.request(S+"/forms/"+t.guid+"/submit",{method:"POST",data:e})];case 1:return r=n.sent(),[2,j(r)]}})})},e.batchPostSubmissions=function(t){return i(c,void 0,void 0,function(){var e,r;return a(this,function(n){switch(n.label){case 0:return e=o({formRev:t.rev,userName:t.userName},t.channel?{channel:t.channel}:{},{batchContent:t.submitActions.map(function(t){switch(t.action){case"add":return{action:"add",responseContent:t.form.questions.map(function(t){var e=t.guid,r=t.type,n=t.response;return g.toServerResponse(e,r,n)}).filter(Boolean)};case"del":return{action:"del",submitId:t.submitId};default:return p.assertNever(t)}})}),[4,v.ajax.request(S+"/forms/"+t.guid+"/batch",{method:"POST",data:e})];case 1:return r=n.sent(),[2,j(r)]}})})},e.fetchSubmissions=function(t){return i(c,void 0,void 0,function(){var e,r,n,o,i;return a(this,function(a){switch(a.label){case 0:return e={formGuid:t.guid,offset:t.offset,limit:t.limit},[4,v.ajax.request(S+"/forms/"+t.guid+"/responses",{method:"GET",data:e})];case 1:return r=a.sent(),n=j(r),o=n.total,i=n.responses,[2,{total:o,submissions:i.map(g.fromServerSubmission)}]}})})},e.fetchAllSubmissions=function(t){return i(c,void 0,void 0,function(){var r;return a(this,function(n){switch(n.label){case 0:return r=1e6,[4,e.fetchSubmissions({guid:t.guid,offset:0,limit:r})];case 1:return[2,n.sent().submissions]}})})},e.fetchStatistics=function(t,e){return i(c,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,v.ajax.request(S+"/forms/"+t+"/questions/"+e+"/assessments",{method:"GET"})];case 1:return[2,r.sent()]}})})},e.deleteSubmissionById=function(t,e){return i(c,void 0,void 0,function(){return a(this,function(r){switch(r.label){case 0:return[4,v.ajax.request(S+"/forms/"+t+"/responses/"+e,{method:"DELETE"})];case 1:return r.sent(),[2]}})})},e.fetchFormViewCount=function(t){return i(c,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,v.ajax.request(S+"/forms/"+t+"/views",{method:"GET"})];case 1:return[2,e.sent()]}})})},e.increaseFormViewCount=function(t){return i(c,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return[4,v.ajax.request(S+"/forms/"+t+"/views",{method:"POST"})];case 1:return e.sent(),[2]}})})},_.isDebugging&&h.logObject({fetchAllSubmissions:e.fetchAllSubmissions,fetchDraftForm:e.fetchDraftForm},"form"),e.fetchDistricts=function(t){return i(c,void 0,void 0,function(){var e;return a(this,function(r){switch(r.label){case 0:return[4,v.ajax.request("/api/district/district",{method:"GET",data:t})];case 1:return(e=r.sent().message)?w.isArray(e)?[2,e.map(function(t){return{code:t.code,name:t.name}})]:[2,e.children&&e.children.map(function(t){return{code:t.code,name:t.name}})]:[2,void 0]}})})}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o,i=r(605),a=r(279),u=r(1609),s=function(t){return null==t||""===t},c=function(t){return new Date(t).getTime()===new Date("0001-01-01T00:00:00Z").getTime()},l=[i.FormQuestions.TextType,i.FormQuestions.SingleChoiceType,i.FormQuestions.MultipleChoiceType,i.FormQuestions.DropdownListType,i.FormQuestions.MultipleTextType,i.FormQuestions.RateType,i.FormQuestions.DateType,i.FormQuestions.TimeType,i.FormQuestions.NumberType,i.FormQuestions.NameType,i.FormQuestions.PhoneType,i.FormQuestions.EmailType,i.FormQuestions.AddressType,i.FormQuestions.ImageType];e.toServerQuestionType=function(t){var e=l.indexOf(t);if(-1===e)throw new Error("unknown type: "+t);return e},e.fromServerQuestionType=function(t){return"number"==typeof t?l[t]:t},e.toServerPublishedStatus=function(t){if(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=r;switch(n){case"deadline":e[n]=t.deadline?t.deadline.toISOString():"0001-01-01T00:00:00Z";break;case"fillLimit":case"sheetGuid":case"spreadGuid":e[n]=t[n]||"";break;case"status":case"formId":e[n]=t[n];break;case"channels":e[n]=JSON.stringify(t[n]||[]);break;default:a.softAssertNever(n)}}return e}},e.fromServerPublishedStatus=function(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=r;switch(n){case"deadline":e[n]=t.deadline&&!c(t.deadline)?new Date(t.deadline):void 0;break;case"fillLimit":case"sheetGuid":case"spreadGuid":e[n]=s(t[n])?void 0:t[n];break;case"status":if(s(t[n]))throw new TypeError("unexpected `status`: "+t[n]);e[n]=t[n];break;case"formId":if(s(t[n]))throw new TypeError("unexpected `formId`: "+t[n]);e[n]=t[n];break;case"channels":e[n]=s(t[n])?[]:JSON.parse(t[n])}}return e},function(t){t[t.NotFound=20211]="NotFound",t[t.NotPublished=20212]="NotPublished",t[t.Overdue=20213]="Overdue",t[t.StoppedCollecting=20214]="StoppedCollecting",t[t.ReachLimitOnce=20215]="ReachLimitOnce",t[t.ReachLimitOncePerDay=20216]="ReachLimitOncePerDay",t[t.UnknownError=-1]="UnknownError"}(o=e.CheckError||(e.CheckError={})),e.convertCheckResult=function(t){var e=t.code;return{canSubmit:t.isValid,reason:e in o?e:o.UnknownError}},e.fromServerResponse=function(t){var r=t.choice,n=t.choices,o=t.text,i=t.rate,u=t.date,s=t.time,c=t.number,l=t.address,f=t.image,p=e.fromServerQuestionType(t.type);return{type:p,guid:t.guid,response:function(){switch(p){case"text":case"multiple_text":case"name":case"phone":case"email":return o&&null!==o.content?{content:o.content}:void 0;case"dropdown_list":case"single_choice":return null==r?void 0:{choice:r};case"multiple_choice":return null==n?void 0:{choices:n};case"number":return null==c?void 0:{number:c};case"date":return u&&u.date?{date:new Date(u.date)}:void 0;case"time":return s&&s.time?{time:new Date(s.time)}:void 0;case"rate":return i&&i.value?{value:i.value}:void 0;case"address":return null==l?void 0:l;case"image":return null==f?void 0:f;default:return a.assertNever(p)}}()}},e.toServerResponse=function(t,r,n){if(n){var o=e.toServerQuestionType(r);switch(r){case"text":case"multiple_text":case"name":case"phone":case"email":return{type:o,guid:t,text:{content:n.content}};case"dropdown_list":case"single_choice":return{type:o,guid:t,choice:n.choice};case"multiple_choice":return{type:o,guid:t,choices:n.choices};case"rate":return{type:o,guid:t,rate:{value:n.value}};case"date":return{type:o,guid:t,date:{date:n.date}};case"time":return{type:o,guid:t,time:{time:n.time}};case"number":return{type:o,guid:t,number:n.number};case"address":return{type:o,guid:t,address:{province:n.province,city:n.city,district:n.district,detail:n.detail}};case"image":return{type:o,guid:t,image:{image:n.image}};default:return a.assertNever(r)}}},e.fromServerSubmission=function(t){var r="string"==typeof t.content?u.parse(t.content):t.content;return{userId:Number(t.userFinger),userName:t.userName,channel:t.channel,responses:r.map(e.fromServerResponse),createdAt:"string"==typeof t.createdAt?new Date(t.createdAt):t.createdAt,submitId:t.submitId}},e.toServerSubmission=function(t){return{formGuid:t.formGuid,formRev:t.formRev,userFinger:t.userId,userName:t.userName,channel:t.channel,submitId:t.submitId,createdAt:t.createdAt&&new Date(t.createdAt).toISOString(),userId:t.userId,content:t.responses.map(function(t){return e.toServerResponse(t.guid,t.type,t.response)}).filter(Boolean)}},e.adaptOldForm=function(t){return n({},t,{viewMode:t.viewMode||"classic"})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";e.generateId=function(t){for(var e="",r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}},function(t,e,r){(function(n){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var n=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&"%c"===t&&(o=++n)}),e.splice(o,0,r)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){var t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==n&&"env"in n&&(t=Object({NODE_ENV:"production",HOST:"shimodev_com",VERSION:"sdk-1.5[8e9bbfa8c]",BRANCH:"sdk-1.5",COMMIT:"8e9bbfa8c",GC_VERSION:"8e9bbfa8c",SDK:!0}).DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||function(){},t.exports=r(769)(e),t.exports.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(e,r(170))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return k});var n,o=r(1),i=r.n(o),a=r(1479),u=(r.n(a),r(663)),s=(r.n(u),r(1503)),c=(r.n(s),r(771)),l=(r.n(c),r(309)),f=(r.n(l),r(262)),p=(r.n(f),r(2)),d=(r.n(p),r(269)),h=r.n(d),v=r(1036),y=r(1634),m=r(1636),g=r(1038),b=r(1637),w=r(1039),_=r(1639),O=r(1641),x=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,u)}s((n=n.apply(t,e||[])).next())})},C=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},S=s.formService.createQuestion,j=p.sheets.alert,E=j.confirm,A=j.showAlert;!function(t){t.FormChanged="FormChanged",t.FormUiChanged="FormUiChanged"}(n||(n={}));var k=function(t){var e,r=t.editor,o=t.pageBaseUrl,p=t.apiBaseUrl,d=t.user,j=o?o+"s":"/forms",k=u.createFormService({formApiUrl:p}),T=function(t,e){return x(void 0,void 0,Promise,function(){var r,n,o,i,a;return C(this,function(u){switch(u.label){case 0:return e!==v.a.V1?[3,2]:[4,k.fetchForm(t)];case 1:return r=u.sent(),[2,{formGuid:t,formVersion:e,data:a=r&&{form:r}}];case 2:return e!==v.a.V2?[3,4]:[4,Promise.all([s.formService.fetchPublishedInfo(t),y.a.fetchFile(t).catch(function(t){return console.error("[form] fetch file failed:",t),"denied"})])];case 3:return n=u.sent(),o=n[0],i=n[1],a=o&&i&&{form:o.form,publishStatus:o.publishStatus,file:i},[2,{formGuid:t,formVersion:e,data:a}];case 4:throw new Error("unexpected formVersion: "+e)}})})},I=Object(m.b)(T);g.a&&Object(_.a)(I,"form:cache"),I.on(m.a.Cached,function(){N.emit(n.FormChanged)});var P=function(t,e){return I.get(t,e)},M=function(t,e){if(!t)return!1;var r=P(t,e);if(!r||!r.data)return!1;if(r.formVersion===v.a.V1)return Boolean(r.data.form.spreadGuid);if(r.formVersion===v.a.V2){var n=r.data.publishStatus;return Boolean(n.spreadGuid&&"normal"===n.status)}throw new Error("unexpected formVersion: "+e)},F=function(t,e,o){return x(void 0,void 0,Promise,function(){var i,u,c,p,h;return C(this,function(y){switch(y.label){case 0:return o!==v.a.V1?[3,3]:[4,r.getContent()];case 1:return i=y.sent(),u=a.createChangeForUnlinkForm({spread:i,sheetGuid:t.id,type:-4===r.fileType?"modoc":"richdoc",userId:d.id}),[4,r.applyAndSendChange(u,{disableRecords:!0})];case 2:y.sent(),y.label=3;case 3:return o!==v.a.V2?[3,6]:[4,r.getContent()];case 4:return c=y.sent(),p=Array.isArray(c.ops)?"richdoc":"modoc",h=s.sheetChangeset.createChangeForUnlinkForm({spread:c,fileType:p,formGuid:e,userId:d.id}),[4,r.applyAndSendChange("richdoc"===p?f.unpack(h):new l.Delta(h),{disableRecords:!0})];case 5:y.sent(),y.label=6;case 6:return N.emit(n.FormChanged),[2]}})})},D=function(t,r,n){return x(void 0,void 0,Promise,function(){var t,o,a;return C(this,function(u){switch(u.label){case 0:return n!==v.a.V1?[3,2]:[4,k.fetchForm(r)];case 1:if(!(t=u.sent())||!t.guid)throw new Error(i()("表单不存在，请检查后再试"));(t.spreadGuid||t.sheetGuid)&&k.unlinkForm(r),u.label=2;case 2:return n!==v.a.V2?[3,5]:[4,s.formService.fetchPublishedInfo(r)];case 3:if(!(o=u.sent()))throw new Error(i()("表单不存在，请检查后再试"));return a=o.publishStatus,e&&a.spreadGuid===e?[4,s.formService.patchPublishStatus({guid:r,publishStatus:{spreadGuid:null,sheetGuid:null},userId:d.id})]:[3,5];case 4:u.sent(),u.label=5;case 5:return[2]}})})},R=function(t,e,r){return x(void 0,void 0,Promise,function(){return C(this,function(n){switch(n.label){case 0:return[4,F(t,e,r)];case 1:return n.sent(),[4,D(t,e,r)];case 2:return n.sent(),[2]}})})},N=Object.assign(new h.a,{setSpreadGuid:function(t){e=t},canReadForm:function(t,e){if(!t)return!1;var r=P(t,e);if(!r||!r.data)return!1;if(r.formVersion===v.a.V1)return d.id===r.data.form.creatorId;if(r.formVersion===v.a.V2){var n=r.data.file;return Boolean(n&&"object"==typeof n&&n.permissions.readable)}throw new Error("unexpected formVersion: "+e)},isFormPublished:M,getFillPageUrl:function(t,e){if(M(t,e))return(e===v.a.V1?o:j)+"/"+t+"/fill"},createForm:function(t){return x(void 0,void 0,Promise,function(){var n,o,a,u,c,p;return C(this,function(h){switch(h.label){case 0:n=window.open(),h.label=1;case 1:return h.trys.push([1,3,,4]),[4,function(t){return void 0===t&&(t={}),x(void 0,void 0,Promise,function(){var n,o,a,u,c,p,h,v,m,g,_,O,x;return C(this,function(C){switch(C.label){case 0:if(!e)throw new Error("spreadGuid is required");return[4,y.a.fetchFile(e)];case 1:return n=C.sent(),[4,y.a.fetchFileAncestors(e)];case 2:if(o=C.sent(),!n)throw new Error("sheetFile is not accessible");return p=function(t,e){if(-1===e.indexOf(t))return t;for(var r=1;-1!==e.indexOf(t+" "+r);)r++;return t+" "+r}("string"==typeof t.title?t.title:i()("未命名表单"),r.spread.sheets.map(function(t){return t.name})),a=Object(w.a)(s.formService.createForm(t),function(t){t.title=p}),h=s.formChangeset.toFormDelta(a).stringify(),[4,y.a.createFile({folder:o.length?o[o.length-1].guid:void 0,name:p,type:"form",content:h})];case 3:return u=C.sent(),c=u.guid,v=Object(b.a)(5),[4,r.getContent()];case 4:return m=C.sent(),g=Array.isArray(m.ops)?"richdoc":"modoc",_=s.sheetChangeset.createChangeForCreateForm({spread:m,fileType:g,formGuid:c,sheetGuid:v,sheetTitle:p,userId:d.id,questions:t&&t.questions||[]}),[4,r.applyAndSendChange("richdoc"===g?f.unpack(_):new l.Delta(_),{disableRecords:!0})];case 5:return C.sent(),O=Object(w.a)(s.formService.createPublishStatus(u.id),function(t){t.spreadGuid=n.guid,t.sheetGuid=v,t.status="unpublished"}),x=1,[4,s.formService.publishForm({guid:u.guid,publishStatus:O,userId:d.id,rev:x,form:a})];case 6:return C.sent(),r.spread.setActiveSheet(v),[2,{guid:c,name:p}]}})})}(t)];case 2:return o=h.sent(),a=o.guid,u=o.name,(c=r.pluginManager.get("HistoryList"))&&c.instance&&c.instance.addHistory({action:"create_form",options:{name:u}}),n&&(n.location.href=j+"/"+a+"/edit"),[2,{guid:a,name:u}];case 3:throw p=h.sent(),n&&n.close(),p;case 4:return[2]}})})},unlinkStaleForms:function(){return x(void 0,void 0,Promise,function(){var t,n,o,i,a,u,s,c,l,f,p;return C(this,function(d){switch(d.label){case 0:return e?(t=r.spread.getSheets().filter(function(t){return(t.gcSheet.attrs||{}).formGuid}),[4,Promise.all(t.map(function(t){return x(void 0,void 0,void 0,function(){var e,r,n,o;return C(this,function(i){switch(i.label){case 0:return e=t.gcSheet.attrs,r=e.formGuid,n=e.formVersion,[4,T(r,n).catch(function(){})];case 1:return o=i.sent(),[2,{sheet:t,record:o}]}})})}))]):[2];case 1:if(n=d.sent().filter(function(t){return t.record}),o=n.filter(function(t){var r=t.record,n=t.sheet;if(!r.data)return!1;if(e&&n.id){if(r.formVersion===v.a.V1){var o=r.data.form;return!(o.spreadGuid===e&&o.sheetGuid===n.id)}if(r.formVersion===v.a.V2){var i=r.data.publishStatus;return!(i.spreadGuid===e&&i.sheetGuid===n.id)}throw new Error("unexpected formVersion: "+r.formVersion)}return!1}),i=n.filter(function(t){var r=t.record,n=t.sheet;if(e&&n.id){if(r.formVersion===v.a.V1)return!1;if(r.formVersion===v.a.V2)return void 0===r.data;throw new Error("unexpected formVersion: "+r.formVersion)}return!1}),!o.length)return[3,5];console.warn("[form] found mismatching sheet:",o.length),u=0,d.label=2;case 2:return u<o.length?(a=o[u],c=a.sheet,l=a.record,console.warn("[form] unlinking:",c.id),[4,F(c,l.formGuid,l.formVersion)]):[3,5];case 3:d.sent(),d.label=4;case 4:return u++,[3,2];case 5:if(!i.length)return[3,10];console.warn("[form] found deleted sheet:",i.length),u=0,d.label=6;case 6:return u<i.length?(s=i[u],c=s.sheet,l=s.record,f=l.formGuid,p=l.formVersion,console.warn("[form] unlinking:",c.id),[4,F(c,f,p)]):[3,10];case 7:return d.sent(),[4,D(c,f,p).catch(function(){})];case 8:d.sent(),d.label=9;case 9:return u++,[3,6];case 10:return[2]}})})},unlink:R,ui:{openOrFocusPage:function(t,e,r){var n="form_"+t+"_"+e,i=(r===v.a.V1?o:j)+"/"+e+"/"+t;window.open(i,n)},confirmUnlinkForm:function(){var t=r.spread.getActiveSheet(),e=t.gcSheet.attrs,n=e.formGuid,o=e.formVersion;o===v.a.V1?E({title:i()("确定停用表单吗？"),description:i()("停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。"),confirmLabel:i()("停用"),confirmFun:function(){return x(void 0,void 0,void 0,function(){var e,r;return C(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,R(t,n,o)];case 1:return a.sent(),A({title:i()("表单已停用")}),[3,3];case 2:return e=a.sent(),r=e&&e.errmsg||i()("停用表单失败，请稍后再试"),A({title:r,type:"error"}),[3,3];case 3:return[2]}})})},abortLabel:i()("取消")}):o===v.a.V2&&E({title:i()("确定取消关联表单吗"),description:i()("取消关联后该表单的新回复将不再发送到该电子表格，但已有数据不会被删除。"),confirmLabel:i()("取消关联"),confirmFun:function(){return x(void 0,void 0,void 0,function(){var e,r;return C(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,R(t,n,o)];case 1:return a.sent(),A({title:i()("表单已取消关联")}),[3,3];case 2:return e=a.sent(),r=e&&e.errmsg||i()("取消关联失败，请稍后再试"),A({title:r,type:"error"}),[3,3];case 3:return[2]}})})},abortLabel:i()("取消")})},createFormPopup:{props:void 0,show:function(t){N.ui.createFormPopup.props={editor:r,formController:N,sheetGuid:t.sheetGuid,onCreate:function(e){return x(this,void 0,Promise,function(){var n,o,a;return C(this,function(u){switch(u.label){case 0:return n=r.spread.getSheet(t.sheetGuid),o=n?n.name+i()("_表单"):void 0,a=e.questions.map(function(t){var e=S(c.questionProviders.text);return e.subject=t,e}),[4,N.createForm({title:o,questions:a})];case 1:return[2,{guid:u.sent().guid}]}})})},onClose:N.ui.createFormPopup.hide},N.emit(n.FormUiChanged)},hide:function(){N.ui.createFormPopup.props=void 0,N.emit(n.FormUiChanged)}}},events:O.a,track:O.b});return g.a&&Object(_.a)(N,"form"),N}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TYPE_PROPERTY="__MODOC_NAME__"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(998),o=r(999),i="0:",a=function(){function t(e,r){this.action=e.action;var n,o=e.data;if(null===o||void 0===o)throw new Error('"data" is required for an Operator');if("object"==typeof o){var a=Object.keys(o)[0],u=o[a];if("string"==typeof u)this.data=o,this.dataType=a;else{var s=t.dataHandlers[a];if(!s)throw new Error('Unsupported nested data type "'+a+'"');var c=s.pack(u,"insert"===this.action);"delta"===a&&c===i?(this.data=1,this.dataType="number"):(this.data=((n={})[a]=c,n),this.dataType=a)}}else this.data=o,this.dataType=typeof o;this.packedAttributes=e.packedAttributes,this.pool=e.pool,this.packedData=r}return t.isOperator=function(t){return"function"==typeof t.getAttributes},t.registerDataHandler=function(e,r){t.dataHandlers[e]=r},t.getUnresolvedAttributes=function(t){return"function"==typeof t.getUnresolvedAttributes?t.getUnresolvedAttributes():t.getAttributes()},Object.defineProperty(t.prototype,"length",{get:function(){return"string"==typeof this.data?this.data.length:"number"==typeof this.data?this.data:1},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return"retain"===this.action&&(""===this.packedAttributes||void 0===this.packedAttributes)&&"number"==typeof this.data},t.prototype.getParsedData=function(){var e=t.dataHandlers[this.dataType];if(void 0===e)throw new Error("Unknown handler for "+this.dataType);return e.parse(this.getCustomData())},t.prototype.hasAttributes=function(){return void 0!==this.packedAttributes&&""!==this.packedAttributes},t.prototype.getAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes):{}},t.prototype.stringify=function(){if(void 0===this.packedData){var t=this.data,e=void 0;switch(this.action){case"insert":e="!";break;case"retain":e="@";break;default:e="#"}if("number"==typeof t)e+=t.toString(36)+"#";else if("string"==typeof t)e+=t.length.toString(36)+"!"+t;else{var r=this.dataType;if(void 0===r)throw new Error("ASSERT: dataType === undefined");var o=n.objectKeyToInitial[r];if(!o)throw new Error('Unsupport object data type: "'+r+'"');var i=""+o+t[r];e+=i.length.toString(36)+"@"+i}this.packedData=e}var a=void 0===this.packedAttributes?this.packedData:this.packedData+this.packedAttributes;return a.length.toString(36)+a},t.prototype.merge=function(e){if(this.action!==e.action)return null;var r=typeof this.data;if("object"===r||r!==typeof e.data)return null;var n=this.hasAttributes();if(n!==e.hasAttributes())return null;if(n)if(this.pool===e.pool){if(this.packedAttributes!==e.packedAttributes)return null}else if(!function(t,e){if(t===e)return!0;var r=Object.keys(t),n=r.length;if(n!==Object.keys(e).length)return!1;for(var o=0;o<n;o++)if(t[r[o]]!==e[r[o]])return!1;return!0}(this.getUnresolvedAttributes(),t.getUnresolvedAttributes(e)))return null;return new t({action:this.action,data:this.data+e.data,pool:this.pool,packedAttributes:this.packedAttributes})},t.prototype.getCustomData=function(){switch(typeof this.data){case"string":case"number":throw new Error("Cannot get custom data from a simple operator");default:return this.data[this.dataType]}},t.prototype.compose=function(e,r){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==e.action)throw new Error("Only retaining operator can be composed");var n,a,u,s=!1;if(e.hasAttributes()){if(void 0===this.pool)throw new Error("this.pool is undefined when composing");var c=t.getUnresolvedAttributes(e);s=c.hasOwnProperty("cellValue");var l=o.merge(this.getUnresolvedAttributes(),c,!r);a=this.pool.packAttributes(l)}else a=this.packedAttributes;if(s)n="number"===e.dataType?e.data:1;else if("number"===this.dataType)n=e.data;else if("number"===e.dataType)n=this.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when composing '+this.data+" with "+e.data);if(this.dataType!==e.dataType)throw new Error("Expect "+e.dataType+" to equal "+this.dataType+" when composing "+this.data+" with "+e.data);var f=t.dataHandlers[this.dataType];if(void 0===f)throw new Error("Unknown handler for "+this.dataType);var p=f.compose(this.getCustomData(),e.getCustomData(),r);n="delta"===this.dataType&&p===i?1:((u={})[this.dataType]=p,u)}return new t({action:this.action,data:n,pool:this.pool,packedAttributes:a})},t.prototype.transform=function(e,r){if(void 0===r&&(r=!1),"retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==e.action)throw new Error("Only retaining operator can be transformed");var n,a,u;if("number"===this.dataType||"number"===e.dataType)n=e.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when transforming '+this.data+" with "+e.data);if(this.dataType!==e.dataType)throw new Error("Expect "+e.dataType+" to equal "+this.dataType+" when transforming "+this.data+" with "+e.data);var s=t.dataHandlers[this.dataType];if(void 0===s)throw new Error("Unknown handler for "+this.dataType);var c=s.transform(this.getCustomData(),e.getCustomData(),r);n="delta"===this.dataType&&c===i?1:((u={})[this.dataType]=c,u)}if(e.hasAttributes()){var l=o.transform(this.getUnresolvedAttributes(),t.getUnresolvedAttributes(e),r);if(void 0===e.pool)throw new Error("ASSERT: other.pool === undefined when transforming");a=e.pool.packAttributes(l)}else a="";return new t({action:this.action,data:n,pool:e.pool,packedAttributes:a})},t.prototype.invert=function(e,r){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.dataType+")");if("retain"!==e.action)throw new Error("Only retaining operator can be inverted");var n,a,u,s=!1;if(e.hasAttributes()){var c=t.getUnresolvedAttributes(e);s=c.hasOwnProperty("cellValue");var l=o.invert(this.getUnresolvedAttributes(),c);if(void 0===e.pool)throw new Error("ASSERT: other.pool === undefined when inverting");a=e.pool.packAttributes(l)}else a="";if(s)n=this.data;else if(void 0!==r)n=r;else if("number"==typeof e.data)n=e.data;else if("number"==typeof this.data&&"delta"!==e.dataType)n=this.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when inverting '+this.data+" with "+e.data);if("number"===this.dataType&&"delta"===e.dataType){n={delta:(f=t.dataHandlers.delta).invert(i,e.getCustomData())}}else{if(this.dataType!==e.dataType)throw new Error("Expect "+e.dataType+" to equal "+this.dataType+" when inverting "+this.data+" with "+e.data);var f;if(void 0===(f=t.dataHandlers[this.dataType]))throw new Error("Unknown handler for "+this.dataType);var p=f.invert(this.getCustomData(),e.getCustomData());n="delta"===this.dataType&&p===i?1:((u={})[this.dataType]=p,u)}}return new t({data:n,action:"retain",pool:e.pool,packedAttributes:a})},t.prototype.toJSON=function(){var e,r={action:this.action};if(this.hasAttributes()&&(r.attributes=this.getAttributes()),"number"===this.dataType||"string"===this.dataType)r.data=this.data;else{var n=t.dataHandlers[this.dataType],o=this.getCustomData();r.data=((e={})[this.dataType]=n?n.toJSON(o):o,e)}return r},t.prototype.explain=function(e){void 0===e&&(e="");var r=this.stringify().length,n=e+"["+this.dataType+"("+this.action+")] #"+(r-String(r).length)+":\n";if("number"===this.dataType||"string"===this.dataType)n+=e+this.data;else{var o=t.dataHandlers[this.dataType],i=this.getCustomData();n+=o?o.explain(e+"  ",i):i}return n+"\n"+e+"PackedAttributes:"+this.packedAttributes+"\n"},t.prototype.getUnresolvedAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes,!1):{}},t.dataHandlers={},t}();e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Table="table",t.Column="column",t.Row="row",t.Cell="cell"}(e.Element||(e.Element={})),function(t){t.Insert="insert",t.Remove="remove",t.Retain="retain"}(e.Action||(e.Action={})),e.isOperator=function(t){return t&&-1!==["insert","remove","retain"].indexOf(t.action)},function(t){t.Richdoc="richdoc",t.Modoc="modoc"}(e.ChangesetType||(e.ChangesetType={}))},function(t,e,r){var n=r(364),o=r(665),i="".split;t.exports=n(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==o(t)?i.call(t,""):Object(t)}:Object},function(t,e,r){var n=r(751),o=r(364);t.exports=!!Object.getOwnPropertySymbols&&!o(function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&n&&n<41})},function(t,e,r){var n,o,i=r(265),a=r(1510),u=i.process,s=i.Deno,c=u&&u.versions||s&&s.version,l=c&&c.v8;l?o=(n=l.split("."))[0]<4?1:n[0]+n[1]:a&&(!(n=a.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=a.match(/Chrome\/(\d+)/))&&(o=n[1]),t.exports=o&&+o},function(t,e,r){var n=r(532),o=r(753);(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.16.1",mode:n?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},function(t,e,r){var n=r(265),o=r(754),i=n["__core-js_shared__"]||o("__core-js_shared__",{});t.exports=i},function(t,e,r){var n=r(265);t.exports=function(t,e){try{Object.defineProperty(n,t,{value:e,configurable:!0,writable:!0})}catch(r){n[t]=e}return e}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++r+n).toString(36)}},function(t,e,r){var n=r(1014),o=r(758).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return n(t,o)}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,r){var n=r(665);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){var n={};n[r(238)("toStringTag")]="z",t.exports="[object z]"===String(n)},function(t,e,r){var n,o=r(467),i=r(1521),a=r(758),u=r(671),s=r(1522),c=r(1011),l=r(670)("IE_PROTO"),f=function(){},p=function(t){return"<script>"+t+"<\/script>"},d=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},h=function(){try{n=new ActiveXObject("htmlfile")}catch(t){}h=document.domain&&n?d(n):function(){var t,e=c("iframe");if(e.style)return e.style.display="none",s.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F}()||d(n);for(var t=a.length;t--;)delete h.prototype[a[t]];return h()};u[l]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(f.prototype=o(t),r=new f,f.prototype=null,r[l]=t):r=h(),void 0===e?r:i(r,e)}},function(t,e,r){var n=r(238);e.f=n},function(t,e,r){var n=r(765),o=r(749),i=r(500),a=r(533),u=r(1016),s=[].push,c=function(t){var e=1==t,r=2==t,c=3==t,l=4==t,f=6==t,p=7==t,d=5==t||f;return function(h,v,y,m){for(var g,b,w=i(h),_=o(w),O=n(v,y,3),x=a(_.length),C=0,S=m||u,j=e?S(h,x):r||p?S(h,0):void 0;x>C;C++)if((d||C in _)&&(b=O(g=_[C],C,w),t))if(e)j[C]=b;else if(b)switch(t){case 3:return!0;case 5:return g;case 6:return C;case 2:s.call(j,g)}else switch(t){case 4:return!1;case 7:s.call(j,g)}return f?-1:c||l?l:j}};t.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterReject:c(7)}},function(t,e,r){var n=r(1524);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 0:return function(){return t.call(e)};case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,o){return t.call(e,r,n,o)}}return function(){return t.apply(e,arguments)}}},function(t,e,r){var n=r(238),o=r(762),i=r(441),a=n("unscopables"),u=Array.prototype;void 0==u[a]&&i.f(u,a,{configurable:!0,value:o(null)}),t.exports=function(t){u[a][t]=!0}},function(t,e,r){var n=r(1574);t.exports=function(t){if(n(t))throw TypeError("The method doesn't accept regular expressions");return t}},function(t,e,r){var n=r(238)("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(r){try{return e[n]=!1,"/./"[t](e)}catch(t){}}return!1}},function(t,e,r){t.exports=function(t){function e(t){for(var e=0,r=0;r<t.length;r++)e=(e<<5)-e+t.charCodeAt(r),e|=0;return n.colors[Math.abs(e)%n.colors.length]}function n(t){var r;function a(){var t=Array.prototype.slice.call(arguments);if(a.enabled){var e=a,o=Number(new Date),i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o,t[0]=n.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(r,o){if("%%"===r)return r;u++;var i=n.formatters[o];if("function"==typeof i){var a=t[u];r=i.call(e,a),t.splice(u,1),u--}return r}),n.formatArgs.call(e,t),(e.log||n.log).apply(e,t)}}return a.namespace=t,a.enabled=n.enabled(t),a.useColors=n.useColors(),a.color=e(t),a.destroy=o,a.extend=i,"function"==typeof n.init&&n.init(a),n.instances.push(a),a}function o(){var t=n.instances.indexOf(this);return-1!==t&&(n.instances.splice(t,1),!0)}function i(t,e){var r=n(this.namespace+(void 0===e?":":e)+t);return r.log=this.log,r}function a(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return n.debug=n,n.default=n,n.coerce=function(t){return t instanceof Error?t.stack||t.message:t},n.disable=function(){var t=n.names.map(a).concat(n.skips.map(a).map(function(t){return"-"+t})).join(",");return n.enable(""),t},n.enable=function(t){var e;n.save(t),n.names=[],n.skips=[];var r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(e=0;e<o;e++)r[e]&&("-"===(t=r[e].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")));for(e=0;e<n.instances.length;e++){var i=n.instances[e];i.enabled=n.enabled(i.namespace)}},n.enabled=function(t){if("*"===t[t.length-1])return!0;var e,r;for(e=0,r=n.skips.length;e<r;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;e<r;e++)if(n.names[e].test(t))return!0;return!1},n.humanize=r(770),Object.keys(t).forEach(function(e){n[e]=t[e]}),n.instances=[],n.names=[],n.skips=[],n.formatters={},n.selectColor=e,n.enable(n.load()),n}},function(t,e){var r=1e3,n=60*r,o=60*n,i=24*o,a=7*i,u=365.25*i;function s(t,e,r,n){var o=e>=1.5*r;return Math.round(t/r)+" "+n+(o?"s":"")}t.exports=function(t,e){e=e||{};var c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var s=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return s*u;case"weeks":case"week":case"w":return s*a;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(t);if("number"===c&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=i)return s(t,e,i,"day");if(e>=o)return s(t,e,o,"hour");if(e>=n)return s(t,e,n,"minute");if(e>=r)return s(t,e,r,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=i)return Math.round(t/i)+"d";if(e>=o)return Math.round(t/o)+"h";if(e>=n)return Math.round(t/n)+"m";if(e>=r)return Math.round(t/r)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1614),o=r(1615),i=r(1616),a=r(1617),u=r(1618),s=r(1619),c=r(1620),l=r(1621),f=r(1622),p=r(1623),d=r(1624),h=r(1625),v=r(1626),y=r(1627);e.questionProviders={address:i.address,date:a.date,dropdown_list:f.dropdownList,email:s.email,multiple_choice:p.multipleChoice,multiple_text:o.multipleText,name:u.name,number:d.number,phone:c.phone,rate:l.rate,single_choice:h.singleChoice,text:n.text,time:v.time,image:y.image}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form"),o=r(279);e.isOptionNormal=function(t){return"normal"===t.type},e.isOptionOther=function(t){return"other"===t.type},e.isOptionMatch=function(t,e){return t===e||!(!t||!e)&&Boolean("normal"===t.type&&"normal"===e.type&&t.value===e.value||"other"===t.type&&"other"===e.type)},e.getChoiceText=function(t,e){if(t){if("other"===t.type)return""===t.value?n("其他"):t.value.trim();if("normal"!==t.type)o.softAssertNever(t);else{var r=e.options.find(function(e){return"normal"===e.type&&e.value===t.value});if(r){if("normal"===r.type)return r.label.trim();throw new Error("unexpected type:"+r.type)}}}},e.getChoiceResponseText=function(t,r){var n=r?"choice"in r?r.choice?[r.choice]:[]:r.choices:[];return 0===n.length?"":t.options.map(function(t){return n.find(function(r){return e.isOptionMatch(r,t)})}).filter(Boolean).map(function(r){return e.getChoiceText(r,t)}).filter(function(t){return null!=t&&""!==t}).join(",")}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var a=r(660),u=r(1496),s=r(662),c=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]};e.createChangeForSubmitForm=function(t){var e=t.spread,r=t.type,o=t.response,l="richdoc"===r?a.Changeset.Richdoc:a.Changeset.Modoc,f="richdoc"===r?a.Changeset.Richdoc.from(e):a.Changeset.Modoc.from(e),p=i(f),d=p.findIndex(function(t){return t.attrs.formGuid===o.guid});if(-1===d)throw new Error("找不到关联的表");var h=p[d];if("number"==typeof h.data)throw new Error("工作表无数据");var v=h.data,y=v.rows,m=v.columns,g=v.cells,b=function(t){if(t)switch(t.type){case u.FormItemType.Text:return t.response;case u.FormItemType.SingleChoice:return t.choice&&t.choice.label;case u.FormItemType.MultipleChoice:return t.choices&&t.choices.map(function(t){return t.label}).join(",");case u.FormItemType.DropdownList:return t.choice&&t.choice.label;default:return function(t){throw new Error("Unexpected object: "+t)}(t)}},w=0,_=m.map(function(t){var e=t.attrs.formItemGuid,r=e&&o.items.find(function(t){return t.guid===e}),n=e?e===u.ColumnType.CREATE_AT?{value:function(t){var e=(new Date).getTimezoneOffset()/-60,r=new Date(t.valueOf()+60*(8-e)*60*1e3),n=r.getFullYear(),o=r.getMonth(),i=r.getDate(),a=r.getHours(),u=r.getMinutes(),s=r.getSeconds(),c=function(t){return t<10?"0"+t:""+t};return n+"/"+c(o+1)+"/"+c(i)+" "+c(a)+":"+c(u)+":"+c(s)}(o.createAt),guid:u.ColumnType.CREATE_AT,required:!0}:r&&{value:b(r),guid:r.guid,required:r.required}:void 0,i={colIndex:w,colItem:n};return w+=t.data,i}).filter(function(t){return t.colItem});if(c("columnData ",_),!_.some(function(t){return Boolean(t.colItem)}))throw new Error("找不到关联的表单列");for(var O=Object.keys(g).map(function(t){var e=s.fromCellName(t);return{row:e.row,column:e.column,cell:g[t]}}),x=O.filter(function(t){return function(t){return null!=t.attrs.cellValue}(t.cell)}),C=O.filter(function(t){return t.cell.attrs.rowspan}),S=function(t){return C.some(function(e){return t>e.row&&t<=e.row+e.cell.attrs.rowspan-1})},j=_.filter(function(t){return t.colItem&&t.colItem.required}),E=j.find(function(t){return t.colItem.guid===u.ColumnType.CREATE_AT}),A=function(t){var e=x.filter(function(e){return e.row===t});if(E){var r=e.find(function(t){return t.column===E.colIndex});return Boolean(r)}return j.length?j.every(function(t){return e.some(function(e){return e.column===t.colIndex})}):_.some(function(t){return e.some(function(e){return e.column===t.colIndex})})},k=1,T=y.reduce(function(t,e){return t+e.data},0);k<T&&(A(k)||S(k));)k++;c("insertAt ",k);var I=function(){var t={};_.filter(function(t){return t.colItem}).forEach(function(e){var r=s.toCellName(k,e.colIndex),i=e.colItem;t[r]=l.retain(a.Element.Cell,n({vertical:"middle",wrap:"text-no-wrap",format:"@","font-size":9,userID:o.userId,authorId:o.userId,cellValue:i&&i.value},e.colItem.guid===u.ColumnType.CREATE_AT?{format:"YYYY/MM/DD HH:mm:ss"}:{}),1)});var e=[l.retain(a.Element.Row,{},k),l.insert(a.Element.Row,{height:22},1)],r=i(0===d?[]:[l.retain(a.Element.Table,{},d)],[l.retain(a.Element.Table,{id:h.attrs.id},{cells:t,rows:e})]);return l.create(r)}();return c("change ",I),I.content}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(996);e.Delta=n.default;var o=r(747);r(1486).registerDataHandlers(o.default,n.default,o.default)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(661),o=r(997),i=r(746),a=r(747),u=r(1485),s=r(1e3),c=function(){function t(t,e){if(this[i.TYPE_PROPERTY]="Delta",Array.isArray(t)){var r=new n.default;o.default.isPool(e)&&0!==t.length||(e=new o.default);for(var u=0,s=t;u<s.length;u++){var c=s[u],l=e.packAttributes(c.attributes);r.push(new a.default({action:c.action,data:c.data,pool:e,packedAttributes:l}))}this.ops=r.stringify(!0),this.pool=e}else if(void 0===e){var f=t.indexOf(":");if(f<=0)throw new Error("Invalid delta: "+t);var p=parseInt(t.substring(0,f),36);if(isNaN(p))throw new Error("Invalid delta: "+t);var d=f+1+p;this.ops=t.substring(f+1,d),this.pool=0===p||t.length===d?new o.default:new o.default(t.substring(f+p+1))}else this.ops=t,this.pool=""===t?new o.default:e}return t.prototype.isEmpty=function(){return 0===this.ops.length},t.prototype.getIter=function(t){var e=void 0===t?{}:t,r=e.targetPool,n=e.sourcePool;return new u.default(this.ops,n||this.pool,r||this.pool,a.default)},Object.defineProperty(t.prototype,"length",{get:function(){for(var t=this.getIter(),e=0;t.hasNext();)e+=t.peekLength(),t.skip();return e},enumerable:!0,configurable:!0}),t.prototype.getPoolCopy=function(){return this.pool.clone()},t.prototype.map=function(e){for(var r=[],n=this.getIter();n.hasNext();)r.push(e(n.next()));return new t(r)},t.prototype.compose=function(e,r){var o=this.getPoolCopy(),i=new n.default([]),a=this.getIter({sourcePool:o,targetPool:o});Array.isArray(e)&&(e=new t(e,o));for(var u=e.getIter({targetPool:o});;){var s=a.hasNext(),c=u.hasNext();if(!s&&!c)break;if(!c)return new t(a.remainingStrs(i),o);if(!s&&u.isPoolCompatible())return new t(u.remainingStrs(i),o);if("insert"===u.peekAction())i.push(u.next());else if("remove"===a.peekAction())i.push(a.next());else{var l=Math.min(a.peekLength(),u.peekLength()),f=s?a.next(l):null,p=u.next(l);"retain"===p.action?i.push(f?f.compose(p,void 0===r?"insert"===f.action:r):p):f&&"retain"!==f.action||i.push(p)}}return new t(i.stringify(!0),o)},t.prototype.transform=function(e,r){void 0===r&&(r=!1),Array.isArray(e)&&(e=new t(e));for(var o=e.getPoolCopy(),i=new n.default,u=this.getIter(),s=e.getIter({sourcePool:o,targetPool:o});s.hasNext();){if(!u.hasNext())return new t(s.remainingStrs(i),o);if("insert"!==u.peekAction()||!r&&"insert"===s.peekAction())if("insert"===s.peekAction())i.push(s.next());else{var c=Math.min(u.peekLength(),s.peekLength()),l=u.next(c),f=s.next(c);if("remove"===l.action){if(l.hasAttributes()||"remove"===f.action&&f.hasAttributes())throw new Error("Cannot transform removing operations with attributes");continue}if("remove"===f.action){if(f.hasAttributes())throw new Error("Cannot transform removing operations with attributes");i.push(f)}else i.push(l.transform(f,r))}else i.push(new a.default({action:"retain",data:u.peekLength()})),u.skip()}return new t(i.stringify(!0),o)},t.prototype.invert=function(e,r){for(var i=new o.default,u=new n.default,s=this.getIter({targetPool:i}),c=(Array.isArray(e)?new t(e,new o.default):e).getIter({targetPool:i});c.hasNext();)if("insert"===c.peekAction())u.push(new a.default({action:"remove",data:c.peekLength()})),c.skip();else{if(!s.hasNext())throw new Error("Delta should be smaller than document");if("insert"!==s.peekAction())throw new Error("Only document can invert deltas");var l=Math.min(s.peekLength(),c.peekLength()),f=c.next(l),p=s.next(l);"remove"===f.action?u.push(p):u.push(r?r(p,f):p.invert(f))}return new t(u.stringify(!0),i)},t.prototype.stringify=function(){return this.isEmpty()?"0:":this.ops.length.toString(36)+":"+this.ops+this.pool.stringify()},t.prototype.toJSON=function(){for(var t=[],e=this.getIter();e.hasNext();)t.push(e.next().toJSON());return t},t.prototype.explain=function(t){void 0===t&&(t="");for(var e=t+"Delta #"+this.ops.length+":\n",r=this.getIter();r.hasNext();)e+=r.next().explain(t+"  ");return""+e+t+"Pool: "+this.pool.stringify()+"\n"},t.prototype.validateTable=function(){for(var t={},e=this.getIter();e.hasNext();){var r=e.next();if("table"===r.dataType){var n=r.getAttributes().name;if("string"!=typeof n)continue;var o="$$"+n+"$$";if(t.hasOwnProperty(o))throw new Error("Duplicated table name found: "+n);t[o]=!0}}return this},t.isDelta=s.isDelta,t}();e.default=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(746),o=r(1483),i=r(1484),a=!1,u=!1,s=!1,c=function(){function t(t){void 0===t&&(t={array:[],packedData:""}),this[n.TYPE_PROPERTY]="Pool",this.cache={},"string"==typeof t?(this.array=JSON.parse(t),this.packedData=t):(this.array=t.array,this.packedData=t.packedData)}return t.isPool=function(t){return"object"==typeof t&&null!==t&&"Pool"===t[n.TYPE_PROPERTY]},t.setIPoolConfig=function(t){t&&(a=!!t.enableCache,u=!!t.enableNullIgnore,s=!!t.enableRawString)},t.prototype.isSubsetOf=function(t){if(this===t)return!0;var e=this.array.length;if(0===e)return!0;if(e>t.array.length)return!1;for(var r=0;r<e;r++)if(this.array[r]!==t.array[r])return!1;return!0},t.prototype.getMap=function(){if(!this.map){this.map={};for(var t=0;t<this.array.length;t++)this.map[this.array[t]]=String(t)}return this.map},t.prototype.packAttributes=function(t){if(!t)return"";var e=Object.keys(t),r=e.length;if(0===r)return"";for(var n=[],o=[],a=0;a<r;a++){var u=e[a],s=t[u];if("object"==typeof s&&null!==s)for(var c=0,l=i.objectToKeyPaths(s,"."+u);c<l.length;c++){var f,p=l[c];" "===(f=this.getAddress(p[0],p[1]))[0]?n.push(f):o.push(f)}else" "===(f=this.getAddress(u,s))[0]?n.push(f):o.push(f)}return o.sort().join("")+n.sort().join("")},t.prototype.getAddress=function(t,e){var r=o.combinedAttributeWithValue(t,e),n=o.getGulByCombinedKeyValue(r);if("string"==typeof n)return n;var i=this.getMap();if(!i.hasOwnProperty(r)){this.packedData=void 0;var a=this.array.length;i[r]=String(a),this.array.push(r)}return" "+i[r]},t.prototype.unpackAttributes=function(t,e){void 0===e&&(e=!0);for(var r={},n=0;n<t.length&&" "!==t[n];){var c=o.getKeyValueByGul(t[n]),l=c[0],f=c[1];e&&"."===l[0]?i.keyPathToObject(r,l,f):r[l]=f,n+=1}if(n<t.length-1){var p=t.substring(n+1).split(" ");n++;for(var d=0,h=p;d<h.length;d++){var v=h[d],y=a?this.cache[v]||(this.cache[v]=o.parseCombinedAttributeValue(this.array[v])):o.parseCombinedAttributeValue(this.array[v]);l=y[0],f=y[1];e&&"."===l[0]?i.keyPathToObject(r,l,f):u&&null===f||(r[l]=f,!s||r.rawString||"cellValue"!==l&&"formula"!==l||(r.rawString=t.substring(0,n)+t.substring(n+v.length+1))),n+=v.length+1}}return s&&!r.rawString&&(r.rawString=t),r},t.prototype.stringify=function(){return"string"!=typeof this.packedData&&(this.packedData=this.array.length?JSON.stringify(this.array):""),this.packedData},t.prototype.clone=function(){return new t({array:this.array.slice(),packedData:this.packedData})},t}();e.default=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initialToObjectKey={A:"attachment",C:"cell",I:"image",D:"delta",T:"table",P:"presentation",S:"slide",M:"mention",N:"inline-break",V:"divide",U:"upload-placeholder-attachment",G:"gallery",B:"gallery-block",Z:"mindmap",O:"object",F:"form"},e.objectKeyToInitial=Object.keys(e.initialToObjectKey).reduce(function(t,r){return t[e.initialToObjectKey[r]]=r,t},{})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.merge=function(t,e,r){var n=Object.keys(t);if(r&&0===n.length)return e;for(var o=0,i=Object.keys(e);o<i.length;o++){var a=i[o];t[a]=e[a],r||null!==t[a]||delete t[a]}return t},e.transform=function(t,e,r){if(r)return e;var n=Object.keys(e);if(0===n.length)return e;var o=Object.keys(t);if(0===o.length)return e;if(o.length>n.length)for(var i=0,a=n;i<a.length;i++){var u=a[i];t.hasOwnProperty(u)&&delete e[u]}else for(var s=0,c=o;s<c.length;s++)delete e[c[s]];return e},e.invert=function(t,e){var r=Object.keys(e);if(0===r.length)return e;if(0===Object.keys(t).length)for(var n=0,o=r;n<o.length;n++)e[u=o[n]]=null;else for(var i=0,a=r;i<a.length;i++){var u,s=t[u=a[i]];e[u]=void 0===s?null:s}return e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(746);e.isDelta=function(t){return"object"==typeof t&&null!==t&&"Delta"===t[n.TYPE_PROPERTY]}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.possibleDeltaInputToString=function(t,e){if(void 0===e||null===e)return"";if(Array.isArray(e)){if(0===e.length)return"";var r=new t(e);return r.isEmpty()?"":r.stringify()}return e.isEmpty()?"":e.stringify()}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1001),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){for(var n=this.parse(t).slice(0),o=this.parse(e).slice(0),i=Math.max(n.length,o.length),a=new Array(i),u=0;u<i;u++){var s=n[u],c=o[u];a[u]=s?c?s.compose(c,r):s:c}return this.pack(a)},e.prototype.transform=function(t,e,r){for(var n=this.parse(t).slice(0),o=this.parse(e).slice(0),i=Math.max(n.length,o.length),a=new Array(i),u=0;u<i;u++){var s=n[u],c=o[u];a[u]=s?c?s.transform(c,r):void 0:c}return this.pack(a)},e.prototype.invert=function(t,e){for(var r=this.parse(t).slice(0),n=this.parse(e).slice(0),o=Math.max(r.length,n.length),i=new Array(o),a=0;a<o;a++){var u=r[a],s=n[a];i[a]=u?s?u.invert(s):void 0:s}return this.pack(i)},e.prototype.parse=function(t){for(var e=0,r=[];e<t.length;){var n=t.indexOf("$",e);if(-1===n)break;var o=parseInt(t.substring(e,n),36),i=n+1+o,a=0===o?void 0:new this.deltaConstructor(t.substring(n+1,i));e=i,r.push(a)}return r},e.prototype.pack=function(t){for(var e="",r=0,n=t;r<n.length;r++){var i=n[r],a=o.possibleDeltaInputToString(this.deltaConstructor,i);e+=a.length.toString(36)+"$"+a}return e},e.prototype.toJSON=function(t){return this.parse(t).map(function(t){return t?t.toJSON():void 0})},e.prototype.explain=function(t,e){for(var r=t+"List:\n",n=this.parse(e),o=0;o<n.length;o++){var i=n[o];r+=t+"Item #"+o+":\n",r+=i?i.explain(t):"[EMPTY]"}return r},e}(r(597).default);e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.Text="text",t.SingleChoice="single_choice",t.MultipleChoice="multiple_choice",t.DropdownList="dropdown_list"}(e.FormItemType||(e.FormItemType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.createLogger=function(t){var e=t.channel,r=t.logger;return function(t,n){return n=n||t.name,function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r.info.apply(r,["["+e+"]["+n+"] args:"].concat(o));try{var a=t.apply(void 0,o);if(a&&a.then)return a.then(function(t){return r.info("["+e+"]["+n+"] result:",t),t},function(t){throw r.error("["+e+"]["+n+"] error:",t),t})}catch(t){throw r.error("["+e+"]["+n+"] error:",t),t}}}}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=r(663),i=r(1006),a=r(1007);e.toServerFormItem=function(t){return{guid:t.guid,name:t.subject,type:function(t){var e;return((e={})[o.FormItemType.Text]=i.ServerFormItemType.Text,e[o.FormItemType.SingleChoice]=i.ServerFormItemType.SingleChoice,e[o.FormItemType.MultipleChoice]=i.ServerFormItemType.MultipleChoice,e[o.FormItemType.DropdownList]=i.ServerFormItemType.DropdownList,e)[t]}(t.type),isRequired:t.required?1:0,choices:t.type===o.FormItemType.Text?void 0:a.stringify(t.options),allowOther:t.type===o.FormItemType.Text||t.type===o.FormItemType.DropdownList?void 0:t.options.some(function(t){return"other"===t.type})}};var u=function(t){var e={guid:t.guid,required:1===t.isRequired,subject:t.name};if(t.type===i.ServerFormItemType.Text)return n({type:o.FormItemType.Text},e);if(t.type===i.ServerFormItemType.SingleChoice)return n({type:o.FormItemType.SingleChoice},e,{options:a.parse(t.choices)});if(t.type===i.ServerFormItemType.MultipleChoice)return n({type:o.FormItemType.MultipleChoice},e,{options:a.parse(t.choices)});if(t.type===i.ServerFormItemType.DropdownList)return n({type:o.FormItemType.DropdownList},e,{options:a.parse(t.choices)});throw new Error("unknown item type: "+t.type)};e.toServerForm=function(t){var e=t;return{guid:e.guid,name:e.title,description:"string"==typeof e.desc?e.desc:"",fileGuid:e.spreadGuid,sheetGuid:e.sheetGuid,expiredAt:"boolean"==typeof e.deadline?e.deadline?new Date(e.deadlineDate).getTime():null:void 0}},e.fromServerForm=function(t,e){var r=new Date(new Date((new Date).getTime()+6048e5).setHours(12,0,0,0));return{creatorId:t.creatorId,guid:t.guid,title:t.name||"",desc:"string"==typeof t.description?t.description:"",spreadGuid:t.fileGuid,sheetGuid:t.sheetGuid,deadline:Boolean(t.expiredAt),deadlineDate:t.expiredAt?new Date(t.expiredAt):r,items:e.map(u)}},e.fromServerItemReponse=function(t,e){var r=u(e);if(!r)throw new Error("formItem not found, item guid: "+t.guid);if(r.type===o.FormItemType.Text)return r.response=t.value,r;if(r.type===o.FormItemType.SingleChoice||r.type===o.FormItemType.DropdownList){if("single_choice"!==(n=a.parse(t.value)).type&&"dropdown_list"!==n.type)throw new Error("unexpected response type: "+n.type);return r.choice=n.value.choice,r}if(r.type===o.FormItemType.MultipleChoice){var n;if("multiple_choice"!==(n=a.parse(t.value)).type)throw new Error("unexpected response type: "+n.type);return r.choices=n.value.choices,r}throw new Error("unknown formItem type: "+JSON.stringify(r))},e.toServerItemReponse=function(t,e){var r={guid:t.guid,isRequired:t.required?1:0,importerId:""+e};if(t.type===o.FormItemType.Text)return n({},r,{value:t.response});if(t.type===o.FormItemType.SingleChoice)return n({},r,{value:a.stringify({type:"single_choice",value:{choice:t.choice}})});if(t.type===o.FormItemType.MultipleChoice)return n({},r,{value:a.stringify({type:"multiple_choice",value:{choices:t.choices}})});if(t.type===o.FormItemType.DropdownList)return n({},r,{value:a.stringify({type:"dropdown_list",value:{choice:t.choice}})});throw new Error("unknown item: "+JSON.stringify(t))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.Text=0]="Text",t[t.SingleChoice=1]="SingleChoice",t[t.MultipleChoice=2]="MultipleChoice",t[t.DropdownList=3]="DropdownList"}(e.ServerFormItemType||(e.ServerFormItemType={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parse=JSON.parse,e.stringify=JSON.stringify},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(660),a=r(662),u="CREATE_AT";e.createChangeForUpdateForm=function(t){var e=t.spread,r=t.form,n=t.type,s=t.userId,c="richdoc"===n?i.Changeset.Richdoc:i.Changeset.Modoc,l="richdoc"===n?i.Changeset.Richdoc.from(e):i.Changeset.Modoc.from(e),f=o(l),p=f.findIndex(function(t){return t.attrs.formGuid===r.guid});if(-1===p)throw new Error("找不到关联的表");var d=f[p];if("number"==typeof d.data)throw new Error("工作表无数据");for(var h=d.data,v=(h.rows,h.columns),y=h.cells,m=v.reduce(function(t,e){var r=t[t.length-1];return t.concat({colIndex:r?r.colIndex+r.colOperator.data:0,colOperator:e})},[]),g=m.length-1;g>=0;){if(null!=m[g].colOperator.attrs.formItemGuid)break;g--}var b=-1!==g?m[g].colIndex:-1,w={},_=m.slice(0,g+1).map(function(t){var e=t.colIndex,n=t.colOperator;if(null==n.attrs.formItemGuid)return c.retain(i.Element.Column,{},n.data);if(n.attrs.formItemGuid==u)return c.retain(i.Element.Column,{},n.data);var o=r.items.find(function(t){return t.guid===n.attrs.formItemGuid});if(o){var l=a.toCellName(0,e),f=y[l];return(f&&function(t){var e=t.data,r=t.attrs;if("number"!=typeof e)return r.cellValue}(f))!==o.subject&&(w[l]=c.retain(i.Element.Cell,{userId:s,authorId:s,cellValue:o.subject},1)),c.retain(i.Element.Column,{},n.data)}return c.retain(i.Element.Column,{formItemGuid:null,userId:s,authorId:s},n.data)}),O=r.items.filter(function(t){return!m.find(function(e){return e.colOperator.attrs.formItemGuid===t.guid})}).map(function(t,e){var r=a.toCellName(0,b+1+e);return w[r]=c.retain(i.Element.Cell,{userId:s,color:"#ffffff",background:"#41464b",format:"@",cellValue:null!=t.subject?t.subject:""},1),c.insert(i.Element.Column,{formItemGuid:t.guid},1)}),x=void 0;r.title!==d.attrs.name&&(f.map(function(t){return t.attrs.name}).every(function(t){return t!==r.title})&&(x=r.title));var C=o(0===p?[]:[c.retain(i.Element.Table,{},p)],[c.retain(i.Element.Table,{id:r.sheetGuid,name:x},{cells:w,columns:o(_,O)})]);return c.create(C).content}},function(t,e,r){var n=r(750);t.exports=n&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,r){var n=r(440),o=r(364),i=r(1011);t.exports=!n&&!o(function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a})},function(t,e,r){var n=r(265),o=r(365),i=n.document,a=o(i)&&o(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},function(t,e,r){var n=r(753),o=Function.toString;"function"!=typeof n.inspectSource&&(n.inspectSource=function(t){return o.call(t)}),t.exports=n.inspectSource},function(t,e,r){var n=r(317),o=r(1513),i=r(598),a=r(441);t.exports=function(t,e){for(var r=o(e),u=a.f,s=i.f,c=0;c<r.length;c++){var l=r[c];n(t,l)||u(t,l,s(e,l))}}},function(t,e,r){var n=r(317),o=r(499),i=r(1514).indexOf,a=r(671);t.exports=function(t,e){var r,u=o(t),s=0,c=[];for(r in u)!n(a,r)&&n(u,r)&&c.push(r);for(;e.length>s;)n(u,r=e[s++])&&(~i(c,r)||c.push(r));return c}},function(t,e,r){"use strict";var n=r(666),o=r(441),i=r(599);t.exports=function(t,e,r){var a=n(e);a in t?o.f(t,a,i(0,r)):t[a]=r}},function(t,e,r){var n=r(1517);t.exports=function(t,e){return new(n(t))(0===e?0:e)}},function(t,e,r){var n=r(761),o=r(668),i=r(1519);n||o(Object.prototype,"toString",i,{unsafe:!0})},function(t,e,r){var n=r(761),o=r(665),i=r(238)("toStringTag"),a="Arguments"==o(function(){return arguments}());t.exports=n?o:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),i))?r:a?o(e):"Object"==(n=o(e))&&"function"==typeof e.callee?"Arguments":n}},function(t,e,r){r(191)("iterator")},function(t,e,r){var n=r(265),o=r(1541),i=r(1021),a=r(501),u=r(238),s=u("iterator"),c=u("toStringTag"),l=i.values;for(var f in o){var p=n[f],d=p&&p.prototype;if(d){if(d[s]!==l)try{a(d,s,l)}catch(t){d[s]=l}if(d[c]||a(d,c,f),o[f])for(var h in i)if(d[h]!==i[h])try{a(d,h,i[h])}catch(t){d[h]=i[h]}}}},function(t,e,r){"use strict";var n=r(499),o=r(766),i=r(601),a=r(669),u=r(1022),s=a.set,c=a.getterFor("Array Iterator");t.exports=u(Array,"Array",function(t,e){s(this,{type:"Array Iterator",target:n(t),index:0,kind:e})},function(){var t=c(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}},"values"),i.Arguments=i.Array,o("keys"),o("values"),o("entries")},function(t,e,r){"use strict";var n=r(299),o=r(1542),i=r(1024),a=r(1544),u=r(536),s=r(501),c=r(668),l=r(238),f=r(532),p=r(601),d=r(1023),h=d.IteratorPrototype,v=d.BUGGY_SAFARI_ITERATORS,y=l("iterator"),m=function(){return this};t.exports=function(t,e,r,l,d,g,b){o(r,e,l);var w,_,O,x=function(t){if(t===d&&A)return A;if(!v&&t in j)return j[t];switch(t){case"keys":case"values":case"entries":return function(){return new r(this,t)}}return function(){return new r(this)}},C=e+" Iterator",S=!1,j=t.prototype,E=j[y]||j["@@iterator"]||d&&j[d],A=!v&&E||x(d),k="Array"==e&&j.entries||E;if(k&&(w=i(k.call(new t)),h!==Object.prototype&&w.next&&(f||i(w)===h||(a?a(w,h):"function"!=typeof w[y]&&s(w,y,m)),u(w,C,!0,!0),f&&(p[C]=m))),"values"==d&&E&&"values"!==E.name&&(S=!0,A=function(){return E.call(this)}),f&&!b||j[y]===A||s(j,y,A),p[e]=A,d)if(_={values:x("values"),keys:g?A:x("keys"),entries:x("entries")},b)for(O in _)!v&&!S&&O in j||c(j,O,_[O]);else n({target:e,proto:!0,forced:v||S},_);return _}},function(t,e,r){"use strict";var n,o,i,a=r(364),u=r(1024),s=r(501),c=r(317),l=r(238),f=r(532),p=l("iterator"),d=!1;[].keys&&("next"in(i=[].keys())?(o=u(u(i)))!==Object.prototype&&(n=o):d=!0);var h=void 0==n||a(function(){var t={};return n[p].call(t)!==t});h&&(n={}),f&&!h||c(n,p)||s(n,p,function(){return this}),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:d}},function(t,e,r){var n=r(317),o=r(500),i=r(670),a=r(1543),u=i("IE_PROTO"),s=Object.prototype;t.exports=a?Object.getPrototypeOf:function(t){return t=o(t),n(t,u)?t[u]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?s:null}},function(t,e,r){"use strict";var n=r(1556).charAt,o=r(534),i=r(669),a=r(1022),u=i.set,s=i.getterFor("String Iterator");a(String,"String",function(t){u(this,{type:"String Iterator",string:o(t),index:0})},function(){var t,e=s(this),r=e.string,o=e.index;return o>=r.length?{value:void 0,done:!0}:(t=n(r,o),e.index+=t.length,{value:t,done:!1})})},function(t,e,r){var n=r(440),o=r(672),i=r(499),a=r(664).f,u=function(t){return function(e){for(var r,u=i(e),s=o(u),c=s.length,l=0,f=[];c>l;)r=s[l++],n&&!a.call(u,r)||f.push(t?[r,u[r]]:u[r]);return f}};t.exports={entries:u(!0),values:u(!1)}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(1603);e.isValidLocaleResource=function(t){return!!t&&(!Array.isArray(t)&&("object"===(void 0===t?"undefined":n(t))&&Object.keys(t).every(function(e){var r=t[e];return null==r||"string"==typeof r||"object"===(void 0===r?"undefined":n(r))})))},e.sourceTextToKey=function(t){switch(t.type){case"string":var e=t.id,r=t.text;return e?r+"#"+e:r;case"interpolated":var n=t.textParts.length;return 1===n?t.textParts[0]:2===n?t.textParts[0]+"%s"+t.textParts[1]:t.textParts.map(function(e,r){return r===t.textParts.length-1?e:e+"%"+(r+1)}).join("");default:return o.assertNever(t)}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var a=r(178).getS18n("lizard-service-form"),u=r(603),s=i(r(309)),c=i(r(262)),l=r(279),f=r(279),p=r(604),d=r(1032),h=r(675),v=r(1631);e.createChangeForSubmitForm=function(t){var e=t.fileType,r=t.spread,i=t.form,y=t.formGuid,m=t.submission,g=t.time,b=[].concat(m);switch(e){case"modoc":return function(t){var e=t.spread,r=t.formGuid,i=t.submissions;f.assert(i.length,"submissions is empty"),f.assert(s.Delta.isDelta(e),"spread should be modoc.Delta"),f.assert("string"==typeof r,"formGuid should be string");var c=i.findIndex(function(t){return t.channel}),l=-1!==c?v.ensureChannelColumnModoc(e,r,i[c].userId):void 0;l&&(e=e.compose(l));var p=u.getModocOperators(e),y=p.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===r});if(-1===y)throw new Error(a("找不到指定的表单工作表"));var m,g=p[y],b=0===y?void 0:{action:"retain",attributes:{},data:y},w=[{action:"retain",attributes:{},data:1},{action:"insert",attributes:{height:22},data:i.length}],_={action:"retain",attributes:{userId:t.submissions[0].userId,authorId:t.submissions[0].userId},data:{table:{rows:w}}},O=b?[b,_]:[_];m=new s.Delta(O);var x,C,S,j=n(g.getParsedData(),2);j[0];C=j[1].toJSON().map(function(e){var r=e.attributes||{},n="number"==typeof e.data?e.data:1;if(!r.formItemGuid)return{action:"retain",attributes:{},data:n};var a=r.formItemGuid,s=t.form.questions.find(function(t){return t.guid===a}),c=i.reverse().map(function(e){var r=h.fromServerSubmission(e).responses.find(function(t){return t.guid===a});return a===u.CREATE_AT||a===u.CREATE_BY||a===u.CHANNEL||r&&s?a===u.CREATE_AT?u.createTextCellOp(d.stringifyDate(t.time),e.userId):a===u.CREATE_BY?u.createTextCellOp(e.userName||"",e.userId):a===u.CHANNEL?u.createTextCellOp(e.channel||"",e.userId):u.questionResponseToCellOp({question:s,response:r,userId:e.userId}):{action:"retain",attributes:{},data:n}});return{action:"retain",attributes:{},data:{delta:o([{action:"retain",attributes:{},data:1}],c)}}});_={action:"retain",attributes:{userId:i[0].userId,authorId:i[0].userId},data:{table:{cols:C}}};return S=b?[b,_]:[_],x=new s.Delta(S),(l?l.compose(m.compose(x)):m.compose(x)).stringify()}({spread:"string"==typeof r?new s.Delta(r):r,form:i,formGuid:y,submissions:b,time:g});case"richdoc":return function(t){var e=t.spread,r=t.formGuid,n=t.form,o=t.submissions,i=t.time;f.assert(o.length,"submissions is empty"),f.assert(Array.isArray(e&&e.ops),"spread should be richdoc.Delta"),f.assert("string"==typeof r,"formGuid should be string");var s=o.findIndex(function(t){return t.channel}),l=-1!==s?v.ensureChannelColumnRichdoc(e,r,o[s].userId):void 0;l&&(e=e.compose(l));var y=e.ops,m=y.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===r});if(-1===m)throw new Error(a("找不到指定的表单工作表"));var g,b,w=y[m],_=0===m?void 0:new c.TableOperator({action:"retain",attributes:{},data:m}),O=new c.Delta([new c.Operator({action:"retain",attributes:{},data:1}),new c.Operator({action:"insert",attributes:{height:22},data:o.length})]),x=new c.TableOperator({action:"retain",attributes:{userId:o[0].userId,authorId:o[0].userId},data:{rows:O}}),C=_?[_,x]:[x];g=new c.Delta(C);var S=w.data,j=S.cols,E=(S.rows,{}),A=0;j.ops.forEach(function(t){var e=t.getAttributes()||{},r=t.data,a="number"==typeof r?r:1;if(e.formItemGuid){var s=e.formItemGuid,l=n.questions.find(function(t){return t.guid===s});o.reverse().forEach(function(t,e){var r=h.fromServerSubmission(t).responses.find(function(t){return t.guid===s});(s===u.CREATE_AT||s===u.CREATE_BY||s===u.CHANNEL||r&&l)&&(E[p.toCellName(1+e,A)]=s===u.CREATE_AT?new c.CellOperator(u.createTextCellOp(d.stringifyDate(i),t.userId)):s===u.CREATE_BY?new c.CellOperator(u.createTextCellOp(t.userName||"",t.userId)):s===u.CHANNEL?new c.CellOperator(u.createTextCellOp(t.channel||"",t.userId)):new c.CellOperator(u.questionResponseToCellOp({question:l,response:r,userId:t.userId})))}),A+=a}else A+=a});C=void 0,x=new c.TableOperator({action:"retain",attributes:{userId:o[0].userId,authorId:o[0].userId},data:{cells:E}});C=_?[_,x]:[x],b=new c.Delta(C);var k=l?l.compose(g.compose(b)):g.compose(b);return c.pack(k)}({spread:"string"==typeof r?c.unpack(r):r,form:i,formGuid:y,submissions:b,time:g});default:return l.assertNever(e)}}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]])}return r},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u=r(674),s=r(279),c=r(606),l=r(309),f=a(r(309)),p=r(1608),d=r(675);r(673).isDebugging&&"undefined"!=typeof window&&(window.modoc=window.modoc||f),e.createQuestionOperator=p.createOperator,e.createRuleOperator=p.createOperator,e.createFormOperator=p.createOperator,e.createFormDelta=function(t){return new l.Delta(t)},e.toQuestionOperator=function(t,r){if("remove"===t)return e.createQuestionOperator(t,{},1);var o=r.guid,i=r.required,a=r.subject,u=r.question,s=r.type;return e.createQuestionOperator(t,{},{object:{guid:o,required:i,subject:a,question:n({type:s},u)}})},e.toRuleOperator=function(t,r){if("remove"===t)return e.createRuleOperator(t,{},1);var o=r.guid,i=r.type,a=r.rule;return e.createRuleOperator(t,{},{object:{guid:o,rule:n({type:i},a)}})},e.toFormOperatorAttributes=function(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=r;switch(n){case"viewMode":case"title":case"desc":case"descAlign":e[n]=t[n];break;case"questions":case"rules":break;default:return s.assertNever(n)}}return e},e.toFormOperator=function(t){var r=t.questions,n=t.rules,i=o(t,["questions","rules"]),a=r?r.map(function(t){return e.toQuestionOperator("insert",t)}):[],u=n?n.map(function(t){return e.toRuleOperator("insert",t)}):[];return e.createFormOperator("insert",e.toFormOperatorAttributes(i),{form:[a,u]})},e.toFormDelta=function(t){var r=e.toFormOperator(t);return e.createFormDelta([r])},e.createEmptyForm=function(t){var r=c.produce(u.createForm(),function(t){});return e.toFormDelta(r).stringify()},e.toFormQuestion=function(t){var e=t.action,r=t.data;if("insert"!==e)throw new Error("should be insert");if("number"==typeof r)throw new Error("should be object");var n=r.object,i=n.guid,a=n.required,u=n.subject,s=n.question;return{guid:i,type:s.type,required:a,subject:u,question:o(s,["type"])}},e.toFormRule=function(t){var e=t.action,r=t.data;if("insert"!==e)throw new Error("should be insert");if("number"==typeof r)throw new Error("should be object");var n=r.object,i=n.guid,a=n.rule;return{guid:i,type:a.type,rule:o(a,["type"])}};e.operatorToForm=function(t){var r=t.action,n=t.attributes,o=void 0===n?{}:n,a=t.data;if("insert"!==r)throw new Error("should be insert");if("number"==typeof a)throw new Error("should be object");var l=i(a.form,2),f=l[0],p=void 0===f?[]:f,h=l[1],v=void 0===h?[]:h,y=p.map(e.toFormQuestion),m=v.map(e.toFormRule),g=c.produce(u.createForm(),function(t){Object.assign(t,function(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=r;switch(n){case"viewMode":case"title":case"desc":case"descAlign":e[n]=null==t[n]?void 0:t[n];break;default:s.softAssertNever(n)}}return e}(o),{questions:y,rules:m})});return d.adaptOldForm(g)},e.toForm=function(t){var r=i("string"==typeof t?new l.Delta(t).toJSON():t.toJSON(),1)[0];return e.operatorToForm(r)},e.compose=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=i(t),n=r[0],o=r.slice(1);if(!n)throw new Error("no deltas to compose");return o.reduce(function(t,e){return t.compose(e)},n)}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){return"function"==typeof(t&&t.then)};function i(t){var e=t.onCalled,r=t.onReturned,n=t.onError,i=t.fnName,a=t.self,u=void 0===a?null:a;return function(t){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];e&&e(a,i||t.name);try{var c=t.apply(u,a);return o(c)?c.then(function(e){return r&&r(e,a,i||t.name),e},function(e){throw n&&n(e,a,i||t.name),e}):(r&&r(c,a,i||t.name),c)}catch(e){throw n&&n(e,a,i||t.name),e}}}}e.createDecorator=i,e.decorateObject=function(t,e){for(var r in t){var o=t[r];if("constructor"!==r&&"function"==typeof o){var a=i(n({},e,{self:t,fnName:r}));t[r]=a(o)}}return t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return("0"+String(t)).slice(-2)};e.formatTime=function(t,e){if(!t)return"";var r=(t=new Date(t)).getFullYear(),o=t.getMonth()+1,i=t.getDate(),a=t.getHours(),u=t.getMinutes(),s=t.getSeconds();return e.replace(/\bYYYY\b/,String(r)).replace(/\bMM\b/,n(o)).replace(/\bDD\b/,n(i)).replace(/\bhh\b/,n(a)).replace(/\bmm\b/,n(u)).replace(/\bss\b/,n(s))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=(new Date).getTimezoneOffset()/-60;e.parseDate=function(t,e){void 0===e&&(e=8);var r=new Date(t);return new Date(r.getTime()-60*(e-n)*60*1e3)},e.stringifyDate=function(t,e){void 0===e&&(e=8);var r=new Date(t.getTime()+60*(e-n)*60*1e3),o=r.getFullYear(),i=r.getMonth(),a=r.getDate(),u=r.getHours(),s=r.getMinutes(),c=r.getSeconds(),l=function(t){return t<10?"0"+t:""+t};return o+"/"+l(i+1)+"/"+l(a)+" "+l(u)+":"+l(s)+":"+l(c)}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},i=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u=r(178).getS18n("lizard-service-form"),s=r(603),c=a(r(309)),l=a(r(262)),f=r(279),p=r(279),d=r(604);e.createChangeForUpdateForm=function(t){var e=t.fileType,r=t.spread,a=t.form,h=t.formGuid,v=t.userId;switch(e){case"modoc":return function(t){var e=t.spread,r=t.formGuid,a=t.form,l=t.userId;p.assert(c.Delta.isDelta(e),"spread should be modoc.Delta"),p.assert("string"==typeof r,"formGuid should be string"),p.assert(a,"form is required"),p.assert(l,"userId should be string");var f=s.getModocOperators(e),d=f.map(function(t){return t.getAttributes()||{}}),h=d.map(function(t){return t.name}),v=d.findIndex(function(t){return t.formGuid===r});if(-1===v)throw new Error(u("找不到指定的表单工作表"));var y,m=f[v],g=0===v?void 0:{action:"retain",attributes:{},data:v},b=o(m.getParsedData(),2),w=(b[0],b[1].toJSON()),_=w.map(function(t){return(t.attributes||{}).formItemGuid}).filter(Boolean),O=-1;w.forEach(function(t,e){t.attributes&&t.attributes.formItemGuid&&(O=e)});var x=w.map(function(e,r){var n=e.attributes||{},o=e.data,i="number"==typeof o?o:1,a={action:"retain",attributes:{},data:i};if(!n.formItemGuid)return a;if(n.formItemGuid===s.CREATE_AT||n.formItemGuid===s.CREATE_BY||n.formItemGuid===s.CHANNEL)return a;var u=n.formItemGuid,c=u&&t.form.questions.find(function(t){return t.guid===u});return c?{action:"retain",attributes:{},data:{delta:[{action:"retain",attributes:{cellValue:c.subject},data:1}]}}:{action:"retain",attributes:{formItemGuid:null},data:i}});x=x.slice(0,O+1);var C,S=a.questions.filter(function(t){return-1===_.indexOf(t.guid)}).map(function(t){return{action:"insert",attributes:{formItemGuid:t.guid},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:l,authorId:l,background:"#41464b",format:"@",cellValue:t.subject||u("未命名问题")},data:1}]}}});y=i(x,S);var j={action:"retain",attributes:n({},-1===h.indexOf(a.title)?{name:a.title}:{},{userId:l,authorId:l}),data:{table:{cols:y}}};return C=g?[g,j]:[j],new c.Delta(C).stringify()}({spread:"string"==typeof r?new c.Delta(r):r,form:a,formGuid:h,userId:v});case"richdoc":return function(t){var e=t.spread,r=t.formGuid,o=t.form,a=t.userId;p.assert(Array.isArray(e.ops),"spread should be modoc.Delta"),p.assert("string"==typeof r,"formGuid should be string"),p.assert(o,"form is required"),p.assert(a,"userId should be string");var c=e.ops,f=c.map(function(t){return t.getAttributes()||{}}),h=f.map(function(t){return t.name}),v=f.findIndex(function(t){return t.formGuid===r});if(-1===v)throw new Error(u("找不到指定的表单工作表"));var y,m=c[v],g=0===v?void 0:new l.TableOperator({action:"retain",attributes:{},data:v}),b={},w=m.data,_=w.cells,O=w.cols.ops,x=O.map(function(t){return(t.getAttributes()||{}).formItemGuid}).filter(Boolean),C=-1,S=0,j=O.map(function(e,r){var n=e.getAttributes()||{},o=e.data,i="number"==typeof o?o:1,u=new l.Operator({action:"retain",attributes:{},data:i});if(!n.formItemGuid)return S+=i,u;if(n.formItemGuid===s.CREATE_AT||n.formItemGuid===s.CREATE_BY||n.formItemGuid===s.CHANNEL)return C=Math.max(r,C),S+=i,u;var c=n.formItemGuid,f=c&&t.form.questions.find(function(t){return t.guid===c});if(f){C=Math.max(r,C);var p=d.toCellName(0,S),h=_.get(p);return(h&&s.getCellContent(h))!==f.subject&&(b[p]=new l.CellOperator(s.createTextCellOp(f.subject,a))),S+=i,u}return S+=i,new l.Operator({action:"retain",attributes:{formItemGuid:null},data:i})});j=j.slice(0,C+1);var E,A=o.questions.filter(function(t){return-1===x.indexOf(t.guid)}),k=s.getOperatorSize(j),T=A.map(function(t,e){var r=d.toCellName(0,k+e);return b[r]=new l.CellOperator(s.createTextCellOp(t.subject||u("未命名问题"),a,{color:"#ffffff",background:"#41464b",format:"@"})),new l.Operator({action:"insert",attributes:{formItemGuid:t.guid},data:1})});y=i(j,T);var I=new l.TableOperator({action:"retain",attributes:n({},-1===h.indexOf(o.title)?{name:o.title}:{},{userId:a,authorId:a}),data:{cols:new l.Delta(y),cells:b}});return E=g?[g,I]:[I],l.pack(new l.Delta(E))}({spread:"string"==typeof r?l.unpack(r):r,form:a,formGuid:h,userId:v});default:return f.assertNever(e)}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=r(178).getS18n("lizard-service-form"),a=o(r(309)),u=o(r(262)),s=r(279),c=r(279);e.createChangeForUnlinkForm=function(t){var e=t.fileType,r=t.spread,o=t.formGuid,l=t.userId;switch(e){case"modoc":return function(t){var e=t.spread,r=t.formGuid,o=t.userId;c.assert(a.Delta.isDelta(e),"spread should be modoc.Delta"),c.assert("string"==typeof r,"formGuid should be string"),c.assert(o,"userId is not provided");for(var u=[],s=e.getIter();s.hasNext();)u.push(s.next());var l=u.map(function(t){return t.getAttributes()||{}}),f=l.findIndex(function(t){return t.formGuid===r});if(-1===f)throw new Error(i("找不到指定的表单工作表"));for(var p=u[f],d=l[f],h=n(p.getParsedData(),2)[1].getIter(),v=[];h.hasNext();)v.push(h.next());var y=v.map(function(t){var e=t.getAttributes(),r=t.data,n="number"==typeof r?r:1;return e.formItemGuid?{action:"retain",attributes:{formItemGuid:null},data:n}:{action:"retain",attributes:{},data:n}}),m=0===f?void 0:{action:"retain",attributes:{},data:f},g={action:"retain",attributes:d.formVersion?{formGuid:null,formVersion:null,userId:o,authorId:o}:{formGuid:null,userId:o,authorId:o},data:{table:{cols:y}}},b=m?[m,g]:[g];return new a.Delta(b).stringify()}({spread:"string"==typeof r?new a.Delta(r):r,formGuid:o,userId:l});case"richdoc":return function(t){var e=t.spread,r=t.formGuid,n=t.userId;c.assert(Array.isArray(e&&e.ops),"spread should be richdoc.Delta"),c.assert("string"==typeof r,"formGuid should be string"),c.assert(n,"userId is not provided");for(var o=[],a=e.getIter();a.hasNext();)o.push(a.next());var s=o.map(function(t){return t.getAttributes()||{}}),l=s.findIndex(function(t){return t.formGuid===r});if(-1===l)throw new Error(i("找不到指定的表单工作表"));for(var f=o[l],p=s[l],d=f.data.cols.getIter(),h=[];d.hasNext();)h.push(d.next());var v=new u.Delta(h.map(function(t){var e=t.getAttributes(),r=t.data,n="number"==typeof r?r:1;return e.formItemGuid?new u.Operator({action:"retain",attributes:{formItemGuid:null},data:n}):new u.Operator({action:"retain",attributes:{},data:n})})),y=0===l?void 0:new u.TableOperator({action:"retain",attributes:{},data:l}),m=new u.TableOperator({action:"retain",attributes:p.formVersion?{formGuid:null,formVersion:null,userId:n,authorId:n}:{formGuid:null,userId:n,authorId:n},data:{cols:v}}),g=new u.Delta(y?[y,m]:[m]);return u.pack(g)}({spread:"string"==typeof r?u.unpack(r):r,formGuid:o,userId:l});default:return s.assertNever(e)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.arrayOf=function(t){if(t<0)throw new Error("size should >= 0");for(var e=[],r=0;r<t;r++)e.push(void 0);return e}},function(t,e,r){"use strict";r.d(e,"a",function(){return n});var n={V1:void 0,V2:2}},function(t,e,r){"use strict";r.d(e,"a",function(){return n});r(1038);var n=function(t){throw new TypeError("Unexpected type: "+JSON.stringify(t))}},function(t,e,r){"use strict";(function(t){r.d(e,"a",function(){return n});var n=/debug=1/.test(window.location.search)||void 0!==t&&/dev/.test("production")}).call(e,r(170))},function(t,e,r){"use strict";r.d(e,"a",function(){return o});var n=r(1638),o=function(t,e){var r=Object(n.a)(t);return e(r),r}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1),o=r.n(n),i=(r(1476),r(2)),a=(r.n(i),r(745)),u=r(1642),s=r(3),c=r.n(s),l=r(1648),f=r(0),p=r.n(f),d=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),h=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,u)}s((n=n.apply(t,e||[])).next())})},v=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},y=i.sheets,m=y.root,g=y.path,b=y.Plugin,w=g.setByPath,_=(i.Editor,"Form"),O=function(t){function e(r){var n=r.editor,o=r.guid,i=r.apiBaseUrl,s=void 0===i?window.location.origin+"/api":i,c=r.pageBaseUrl,l=void 0===c?window.location.origin+"/form":c,f=r.currentUser,p=t.call(this,{name:_,Constructor:e,config:arguments[0]})||this;return p.getMenuConfig=function(){return Object(u.a)({formController:p.formController,editor:p.editor})},p.editor=n,p.formController=Object(a.b)({editor:n,apiBaseUrl:s,pageBaseUrl:l,user:f}),p.formController.setSpreadGuid(o),p.containerId="form-container-"+Math.floor(1e3*Math.random()),p.setupUi(),p.install(),p}return d(e,t),e.prototype.setLocale=function(t){o.a.setLocaleSync(t)},e.prototype.init=function(){},e.prototype.updateConfig=function(t){t.hasOwnProperty("guid")&&this.formController.setSpreadGuid(t.guid)},e.prototype.confirmUnlinkForm=function(){this.formController.ui.confirmUnlinkForm()},e.prototype.unlinkStaleForm=function(){return h(this,void 0,Promise,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.formController.unlinkStaleForms()];case 1:return t.sent(),[2]}})})},e.prototype.destroy=function(){var t=document.getElementById(this.containerId);t&&t.parentElement.removeChild(t)},e.prototype.setupUi=function(){var t=document.body.appendChild(document.createElement("DIV"));t.id=this.containerId,c.a.render(p.a.createElement(l.a,{editor:this.editor,formController:this.formController}),t)},e}(b);e.default=O,w(m,"shimo.sdk.sheet.plugins.Form",O)},function(t,e,r){"use strict";var n=r(1),o=r.n(n),i=r(1477),a=r.n(i),u=r(1478),s=r.n(u);o.a.addLocaleResource("en-US",a.a),o.a.addLocaleResource("ja-JP",s.a),o.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},function(t,e){t.exports={"未命名表单":"Unnamed form","确定停用表单吗？":"Are you sure to disable the form?","停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。":"Once disabled the worksheet would become a normal sheet.The created form would be void.No more feedbacks to the form would be reveived.","停用":"Disable","表单已停用":"Form has been disabled","停用表单失败，请稍后再试":"Form disable failed, Try again later","取消":"Cancel","确定取消关联表单吗":"Are you sure to unlink the form?","取消关联后该表单的新回复将不再发送到该电子表格，但已有数据不会被删除。":"New responses to this form will no longer be sent to the spreadsheet after disassociation, but existing data will not be deleted.","取消关联":"Unlink","表单已取消关联":"Form has been unlinked","取消关联失败，请稍后再试":"Unlink failed, please try again later","表单不存在，请检查后再试":"Form doesn't exist. Check and try again.","_表单":"_form","暂无权限访问该表单，请联系该表单的所有者":"No access to the form, please contact the owner of the form","取消关联表单":"Unlink form","停用表单":"Deactivate form","暂无权限取消关联表单":"No permission to unlink the form","表单":"Form","表格协作者才能创建表单":"Only the collaborator can create form","表单创建失败，请稍后重试":"Form create failed, Try it again later","指定的表单不存在":"The specified form does not exist","表单未发布":"Form not published","表单链接复制成功":"Form link copied successfully","表单链接复制失败":"Copy form link failed","创建表单失败，请稍后再试":"Failed to create form, please try again later","基于表头创建表单":"Create a form based on the header","选择表头内容行":"Select header content line","选择字段":"Select field","确定":"Confirm"}},function(t,e){t.exports={"未命名表单":"無名のフォーム","确定停用表单吗？":"本当にフォームを無効にしますか？","停用后该工作表会变成普通工作表，已创建的表单会失效，将不会再收到关于此表单内容的回复。":"無効にするとワークシートは通常のワークシートになります。作成されたフォームは無効になり、このフォームに対する返信を受け取ることはなくなります。","停用":"無効にする","表单已停用":"フォームが無効化されました。","停用表单失败，请稍后再试":"フォームの無効化に失敗しました。しばらくしてからもう一度お試しください。","取消":"キャンセル","确定取消关联表单吗":"フォームのリンクを解除しますか？","取消关联后该表单的新回复将不再发送到该电子表格，但已有数据不会被删除。":"リンクを解除すると、このフォームへの新しい回答はに送信されなくなりますが、既存のデータは削除されません。","取消关联":"リンク解除","表单已取消关联":"フォームのリンクが解除されました。","取消关联失败，请稍后再试":"リンクの解除に失敗しました。しばらくしてからもう一度お試しください。","表单不存在，请检查后再试":"フォームが存在しません。 確認してやり直してください。","_表单":"フォーム","暂无权限访问该表单，请联系该表单的所有者":"フォームにアクセスできません。オーナーに連絡してください。","取消关联表单":"フォームのリンクを解除","停用表单":"フォームを無効にする。","暂无权限取消关联表单":"フォームのリンクを解除する権限がありません。","表单":"フォーム","表格协作者才能创建表单":"フォーム共同編集者はフォームを作成できます。","表单创建失败，请稍后重试":"フォーム作成に失敗しました。しばらくしてからもう一度お試しください。","指定的表单不存在":"指定されたフォームは存在しません。","表单未发布":"フォームが公開されていません。","表单链接复制成功":"フォームリンクをコピーしました。","表单链接复制失败":"フォームリンクのコピーに失敗しました。","创建表单失败，请稍后再试":"フォームを作成できませんでした。しばらくしてからもう一度お試しください。","基于表头创建表单":"ヘッダーからフォームを作成します","选择表头内容行":"ヘッダー行を選択","选择字段":"フィールドを選択","确定":"確定"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1480);e.formEntryToChangeset=n.formEntryToChangeset;var o=r(994);e.createChangeForSubmitForm=o.createChangeForSubmitForm;var i=r(1501);e.createChangeForCreateForm=i.createChangeForCreateForm;var a=r(1008);e.createChangeForUpdateForm=a.createChangeForUpdateForm;var u=r(1502);e.createChangeForUnlinkForm=u.createChangeForUnlinkForm},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=o(r(1481)),a=r(994),u=r(663),s=r(1008),c=o(r(262)),l=o(r(309));e.formEntryToChangeset=function(t){var e=t.content,r=t.formEntry,o=t.userId,f=t.fileType,p=void 0===f?"richdoc":f;if(null==r.action)return i.genSheetFormChangeset({content:e,userId:o,formEntry:r});var d="richdoc"===p?c.unpack.bind(c):function(t){return new l.Delta(t)},h="richdoc"===p?c.pack.bind(c):function(t){return t.stringify()};if("submit_entry"===r.action){var v=r.payload,y=v.form,m=v.items,g=v.responses,b=v.userId;return h(a.createChangeForSubmitForm({spread:d(e),type:p,response:{guid:y.guid,items:m.map(function(t,e){var r=g[e];if(!r||r.guid!==t.guid)throw new Error("cannot find matching response for item["+e+"]: "+JSON.stringify(t));return u.ServerAdapters.fromServerItemReponse(n({},r,{importerId:""+b}),t)}),userId:b,createAt:new Date}}))}if("update_form"===r.action){var w=r.payload,_=(y=w.form,m=w.items,w.userId);return h(s.createChangeForUpdateForm({spread:d(e),type:p,form:u.ServerAdapters.fromServerForm(y,m),userId:_}))}throw new Error("unexpected formEntry: "+JSON.stringify(r))}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r(262)),u={ALPHABET:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",getColumnLabel:function(t){if(t>676)throw new Error("column index exceeds 26^2, not supported");var e=Math.floor(t/26),r=t%26;return""+(e?u.ALPHABET[e-1]:"")+u.ALPHABET[r]},parseColumnLabel:function(t){var e=n(t.split("").map(function(t){return u.ALPHABET.indexOf(t)}),2),r=e[0],o=e[1];return null==o?r:26*(r+1)+o},getCellName:function(t,e){return""+u.getColumnLabel(e)+(t+1)},parseCellName:function(t){return{column:u.parseColumnLabel(t.match(/^[a-zA-Z]+/)[0]),row:Number(t.match(/\d+$/)[0])-1}}},s=function(){var t=function(t,e,r,n){return void 0===n?new a[e+"Operator"]({action:t,data:r}):new a[e+"Operator"]({action:t,attributes:r,data:n})},e=function(t){return new a.Delta(t)};return Object.assign(e,{retain:t.bind(null,"retain"),insert:t.bind(null,"insert"),delete:t.bind(null,"delete")}),e}();e.genSheetFormChangeset=function(t){var e=t.content,r=t.formEntry,n=t.userId;e=a.unpack(e);var i=r.formGuid,c=r.formItems,l=e.ops.find(function(t){return(t.getAttributes()||{}).formGuid===i}),f=e.ops.findIndex(function(t){return(t.getAttributes()||{}).formGuid===i});if(!l)throw new Error("找不到关联的表");var p=function(){var t={};c.forEach(function(e){return t[e.guid]=e});for(var e=l.data.cols.length,r=o(new Array(e)),n=0,i=0;i<l.data.cols.ops.length;i++){var a=l.data.cols.ops[i],u=(a.getAttributes()||{}).formItemGuid;u&&t[u]&&(r[n]=t[u]),n+=a.data}return r}();if(!p.some(Boolean))throw new Error("找不到关联的表单列");var d=function(){var t=p.map(function(t,e){return t&&t.isRequired?e:null}).filter(function(t){return null!=t});0===t.length&&(t=[0]);for(var e=l.data.rows.length,r=function(e){return t.every(function(t){var r=u.getCellName(e,t);if(l.data.cells.get(r)){var n=l.data.cells.get(r).data.ops[0];return n&&"insert"===n.action}return!1})},n=l.data.cells.keys().map(function(t){return{row:u.parseCellName(t).row,column:u.parseCellName(t).column,cell:l.data.cells.get(t)}}).filter(function(t){var e=t.cell.getAttributes()||{},r=e.rowspan,n=e.colspan;return r||n}),o=function(t){return n.some(function(e){var r=e.row,n=(e.cell.getAttributes()||{}).rowspan;return r<t&&t<=r+n-1})},i=function(t){return 0===t},a=0;a<e&&(i(a)||r(a)||o(a));)a++;return a}(),h=function(){var t=s,e=p.map(function(t,e){return{row:d,col:e,item:t}}).reduce(function(e,r){var o=r.row,i=r.col,a=r.item;return e[u.getCellName(o,i)]=t.retain("Cell",{vertical:"middle",wrap:"text-no-wrap",format:"@","font-size":9,userID:n},a?t([t.insert("Text",{userID:n},a.value)]):1),e},{});return t([0!==f&&t.retain("Table",f),t.retain("Table",{id:(l.getAttributes()||{}).id},{cells:e,rows:t([0!==d&&t.retain("",d),t.insert("",{height:22},1)].filter(Boolean))})].filter(Boolean))}();return a.pack(h)}},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},u=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var s=u(r(309)),c=r(662),l=r(748),f=r(1493),p=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data;return"number"==typeof n?{action:e,data:n,attributes:r}:{action:e,data:1,attributes:r}},d=function(t){var e=t.action,r=(t.element,t.attrs);return{action:e,data:t.data,attributes:r}},h=function(t){var r=t.action,n=(t.element,t.attrs),o=t.data;return"number"==typeof o?{action:r,attributes:n,data:o}:{action:r,attributes:n,data:{table:{rows:o.rows&&o.rows.map(d),cols:function(t,r,n){t||(t=[]),r||(r=[]),n||(n={});var o={};Object.keys(n).forEach(function(t){var e=c.fromCellName(t),r=e.row,i=e.column;o[i]||(o[i]={}),o[i][r]=n[t]});var i=[];Object.keys(o).map(function(t){return+t}).sort(function(t,e){return t-e}).forEach(function(t){var r=-1,n=[];Object.keys(o[t]).map(function(t){return+t}).sort(function(t,e){return t-e}).forEach(function(i){var a=o[t][i],u=i-r-1;r=i,u?n.push(e.changeset.retain(l.Element.Cell,{},u),a):n.push(a)}),i.push({column:t,operator:m(n).map(p)})});for(var u=0,s=function(t,e){return i.filter(function(r){return r.column>=t&&r.column<=e})},f=function(t){return"number"==typeof t.data?t.data:1},d=function(t,e,r){var n=[],o=e,i=t?t.action:l.Action.Retain,a=t&&t.attrs||{},u=t?t.data:1/0;if(r.forEach(function(t){var e=t.column,r=t.operator,u=e-o;u>0&&n.push({action:i,data:u,attributes:a}),n.push({action:i,data:{delta:r},attributes:a}),o=e+1}),Number.isFinite(u)){var s=u-(o-e);s>0&&n.push({action:i,data:s,attributes:a})}return n},h=-1,v=-1,y=[];;){var g=t[u++],b=s(h=v+1,v=h+(g?f(g):1/0)-1);if(!g&&0===b.length)break;var w=d(g,h,b);y.push.apply(y,a(w))}return y}(o.columns,o.rows,o.cells)}}}},v=function(t){var r=t.data,n=t.action,o=t.attributes||{};return e.changeset[n](l.Element.Row,o,r)},y=function(t){var r=t.data,n=t.action,o=t.attributes||{};return e.changeset[n](l.Element.Column,o,"number"==typeof r?r:1)},m=function(t){for(var e=function(t,e){var r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&[].concat(r,n).every(function(r){return t[r]===e[r]})},r=[],n=0,o=void 0;n<t.length;){var i=t[n],a=t[n],u=a.action,s=a.data,c=a.attrs,l=(a.element,o&&u===o.action&&"number"==typeof s&&e(o.attrs,c)),f="number"==typeof s;o&&l?o.data+=s:(o&&(r.push(o),o=void 0),f?o=Object.assign({},i):r.push(i)),n++}return o&&(r.push(o),o=void 0),r},g=function(t){var r,o,a=t.toJSON(),u=a.action,s=a.attributes,f=void 0===s?{}:s,p=a.data;if("number"==typeof p)return(r={},r[l.Action.Insert]=e.changeset.insert,r[l.Action.Retain]=e.changeset.retain,r[l.Action.Remove]=e.changeset.remove,r)[u](l.Element.Table,f,p);var d=p.table.rows&&p.table.rows.map(v),h=p.table.cols&&p.table.cols.map(y),g={},b=0;(p.table.cols||[]).forEach(function(t){var r=t.action,o=t.data;if("insert"===r||"retain"===r)if("number"==typeof o)b+=o;else{var a=0;o.delta.forEach(function(r){var o=r.action,u=r.data,s=r.attributes;if("insert"===o||"retain"===o){s&&null!=s.cellValue||"number"!=typeof u?(r.action=t.action,g[c.toCellName(a,b)]=function(t){var r,o=t.data,a=t.action,u=t.attributes||{};if("number"!=typeof o&&Array.isArray(o&&o.delta)){var s=i(o.delta,2),c=s[0],f=s[1];f?r=f.data:c.action===l.Action.Remove?r=null:"string"==typeof c.data&&(r=c.data)}else"cellValue"in u&&(r=u.cellValue);return"number"==typeof o?e.changeset[a](l.Element.Cell,u,o):e.changeset[a](l.Element.Cell,n({},u,{cellValue:r}),1)}(r),a+=1):a+=u}else{if("remove"!==o)throw new Error("unknown action: "+o);a+=u}}),b+=1}else{if("remove"!==r)throw new Error("unknown action: "+r);b+=o}});var w=h&&m(h);return(o={},o[l.Action.Insert]=e.changeset.insert,o[l.Action.Retain]=e.changeset.retain,o[l.Action.Remove]=e.changeset.remove,o)[u](l.Element.Table,f,{rows:d,columns:w,cells:g})};function b(){var t,e;return o(this,function(r){switch(r.label){case 0:t=this.content.getIter(),r.label=1;case 1:return t.hasNext()?(e=t.next(),[4,g(e)]):[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}e.changeset={from:function(t){var e;return(e={type:l.ChangesetType.Modoc,content:t})[Symbol.iterator]=b,e},create:function(t){return e.changeset.from(new s.Delta(t.map(h)))},insert:function(t,e,r){return{action:l.Action.Insert,element:t,attrs:f.prune(e),data:r}},retain:function(t,e,r){return{action:l.Action.Retain,element:t,attrs:f.prune(e),data:r}},remove:function(t,e,r){return{action:l.Action.Remove,element:t,attrs:f.prune(e),data:r}},compose:function(t){return e.changeset.from(t.map(function(t){return t.content}).reduce(function(t,e){return t.compose(e)},new s.Delta([])))},transform:function(t,r){return e.changeset.from(t.content.transform(r.content))},invert:function(t,r){return e.changeset.from(t.content.invert(r.content))},serialize:function(t){return t.content.stringify()},deserialize:function(t){var r=new s.Delta(t);return e.changeset.from(r)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.keyToGul={color:"0",background:"1","font-size":"2",width:"3",height:"4",rowspan:"5",colspan:"6",align:"7",bold:"8",italic:"9",underline:"a",vertical:"b",strike:"c",wrap:"d",fixedRowsTop:"e",fixedColumnsLeft:"f",link:"g",format:"h",formula:"i",filter:"j","border-top":"k","border-right":"l","border-bottom":"m","border-left":"n",line:"o",guid:"p",author:"q",size:"r",list:"s",layout:"t",margin:"u",font:"v",header:"w",indent:"x",comment:"y","comment-block":"z","code-block":"A",name:"B",order:"C",autoFit:"D",userID:"E",nextIndex:"F",id:"G",colVisible:"H",rowVisible:"I",autoFormatter:"J",copyIndex:"K",manualAlign:"L",lock:"M",left:"N",top:"O"};var n=["color","background","font-size","width","height","rowspan","colspan","align","bold","italic","underline","vertical","strike","wrap","fixedRowsTop","fixedColumnsLeft","link","format","formula","filter","border-top","border-right","border-bottom","border-left","line","guid","author","size","list","layout","margin","font","header","indent","comment","comment-block","code-block","name","order","autoFit","userID","nextIndex","id","colVisible","rowVisible","autoFormatter","copyIndex","manualAlign","lock","left","top","cellValue"];function o(t){var e,r=t.charCodeAt(0);if(r>=48&&r<=57)e=n[r-48];else if(r>=65&&r<=90)e=n[r-29];else{if(!(r>=97&&r<=122))throw new Error('Unknown gul "'+t+'"');e=n[r-87]}return e}function i(t){var r=e.keyToGul[t];if(r)return r;var n=t.length.toString(36),o=n.length;if(o>2)throw new Error("Key length of attribute should <= 2: "+n);return""+(1===o?"$":"%")+n+t}e.getAttributeKeyByGul=o,e.getGulByAttributeKey=i,e.combinedAttributeWithValue=function(t,e){var r=i(t);return"string"==typeof e?r+":"+e:"number"==typeof e?r+"*"+e.toString():"boolean"==typeof e?r+(e?"1":"0"):r},e.keyValueToGul={81:"!","2*12":'"',"2*11":"#","2*10":"$","2*9":"%","2*8":"&","6*2":"'","6*3":"(","6*4":")","5*2":"*","5*3":"+","5*4":",","0:#ff0000":"-","0:#ffffff":".","b:bottom":"/","h:normal":"0",1:"1","1:#ffffff":"2","1:#ff0000":"3","1:#ffff00":"4","1:#00ffff":"5","7:left":"6","7:center":"7","7:right":"8","1*4":"9","d:text-wrap":":","d:text-no-wrap":";","h:YYYY/MM/DD":"<",'l:["",1]':"=",'n:["",1]':">",'k:["",1]':"?",'m:["",1]':"@",'l:["#2b2b2b",1]':"A",'n:["#2b2b2b",1]':"B",'k:["#2b2b2b",1]':"C",'m:["#2b2b2b",1]':"D"};var a=[["bold",!0],["font-size",12],["font-size",11],["font-size",10],["font-size",9],["font-size",8],["colspan",2],["colspan",3],["colspan",4],["rowspan",2],["rowspan",3],["rowspan",4],["color","#ff0000"],["color","#ffffff"],["vertical","bottom"],["format","normal"],["background",null],["background","#ffffff"],["background","#ff0000"],["background","#ffff00"],["background","#00ffff"],["align","left"],["align","center"],["align","right"],["background",4],["wrap","text-wrap"],["wrap","text-no-wrap"],["format","YYYY/MM/DD"],["border-right",'["",1]'],["border-left",'["",1]'],["border-top",'["",1]'],["border-bottom",'["",1]'],["border-right",'["#2b2b2b",1]'],["border-left",'["#2b2b2b",1]'],["border-top",'["#2b2b2b",1]'],["border-bottom",'["#2b2b2b",1]']];e.getGulByCombinedKeyValue=function(t){return e.keyValueToGul.hasOwnProperty(t)?e.keyValueToGul[t]:null},e.getKeyValueByGul=function(t){var e=t.charCodeAt(0)-33;return a[e]},e.parseCombinedAttributeValue=function(t){var e;if("$"===t[0]){var r=parseInt(t[1],36);e=t.substring(2,2+r),t=t.substring(1+r)}else"%"===t[0]?(r=parseInt(t[1]+t[2],36),e=t.substring(3,3+r),t=t.substring(2+r)):e=o(t[0]);if(1===t.length)return[e,null];var n=t[1];if("1"===n)return[e,!0];if("0"===n)return[e,!1];var i=t.substring(2);return[e,":"===n?i:Number(i)]}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.objectToKeyPaths=function t(e,r,n){void 0===n&&(n=[]);for(var o=0,i=Object.keys(e);o<i.length;o++){var a=i[o],u=e[a],s=r+"."+a;"object"==typeof u&&null!==u?t(u,s,n):n.push([s,u])}return n},e.keyPathToObject=function(t,e,r){for(var n=e.split("."),o=n.length,i=1;i<o-1;i++){var a=n[i],u=t[a];t="object"==typeof u&&null!==u?u:t[a]={}}var s=n[o-1];null===r&&void 0!==t[s]&&null!==t[s]||(t[s]=r)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(998),o=r(661),i=function(){function t(t,e,r,n){this.ops=t,this.pool=e,this.targetPool=r,this.operatorConstructor=n,this.cursor=0,this.offset=0}return t.prototype.isPoolCompatible=function(){return void 0===this.isCompatible&&(this.isCompatible=this.pool.isSubsetOf(this.targetPool)),this.isCompatible},t.prototype.hasNext=function(){return this.cursor<this.ops.length},t.prototype.remainingStrs=function(t){for(;this.hasNext();){var e=this.next();if(t.push(e)!==o.PushResult.REORDERED){var r=this.cursor;return this.cursor=this.ops.length,this.nextData=void 0,t.stringify()+this.ops.substring(r)}}return t.stringify(!0)},t.prototype.skip=function(t){void 0===t&&(t=1/0);var e=this.peekNext();if(null===e)throw new Error("No more operators");var r,n=this.offset;return t+n>=e.dataLength?(r=e.dataLength-n,this.nextData=void 0,this.cursor=e.opIndex+e.opLength,this.offset=0):(r=t,this.offset+=r),[r,n,e]},t.prototype.next=function(t,e){void 0===t&&(t=1/0);var r,o=this.skip(t),i=o[0],a=o[1],u=o[2];switch(u.dataType){case"number":r=i;break;case"string":r=this.ops.substring(u.dataIndex+1+a,u.dataIndex+1+a+i);break;default:var s=this.ops[u.dataIndex+1+a],c=this.ops.substring(u.dataIndex+1+1,u.dataIndex+1+u.actualLength);(f={})[n.initialToObjectKey[s]]=c,r=f}var l,f,p=this.ops.substring(u.dataIndex+1+u.actualLength,u.opIndex+u.opLength),d=this.targetPool,h=""!==p&&!this.isPoolCompatible();return 0!==a||i!==u.dataLength||h||(l=this.ops.substring(u.opIndex,u.dataIndex+1+u.actualLength)),h&&(p=d.packAttributes(this.pool.unpackAttributes(p))),new this.operatorConstructor({action:e||u.action,data:r,packedAttributes:p,pool:d},l)},t.prototype.peekAction=function(){var t=this.peekNext();return null===t?"retain":t.action},t.prototype.peekLength=function(){var t=this.peekNext();return null===t?1/0:t.dataLength-this.offset},t.prototype.peekNext=function(){if(!this.hasNext())return null;if(void 0===this.nextData){var t=void 0,e=void 0;e=this.cursor+1;for(var r=this.ops.length;e<r;){switch(this.ops[e]){case"!":t="insert";break;case"@":t="retain";break;case"#":t="remove"}if(void 0!==t)break;e+=1}var n=e,o=parseInt(this.ops.substring(this.cursor,n),36);e=n+1;for(var i=void 0;e<r;){switch(this.ops[e]){case"!":i="string";break;case"#":i="number";break;case"@":i="object"}if(void 0!==i)break;e+=1}var a=e,u=parseInt(this.ops.substring(n+1,a),36),s="number"===i?0:u,c="object"===i?1:u;this.nextData={action:t,dataIndex:a,dataLength:c,opIndex:n,opLength:o,dataType:i,actualLength:s}}return this.nextData},t}();e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1487),o=r(1489),i=r(1490),a=r(1491),u=r(1492),s=r(1002);e.registerDataHandlers=function(t,e,r){var c=function(t,e){return function(r){return new r(t,e)}}(e,r);t.registerDataHandler("delta",c(o.default)),t.registerDataHandler("table",c(n.default)),t.registerDataHandler("presentation",c(a.default)),t.registerDataHandler("slide",c(i.default)),t.registerDataHandler("mindmap",c(i.default)),t.registerDataHandler("object",c(u.default)),t.registerDataHandler("form",c(s.default))}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(1001),i=r(1488),a=r(597),u=r(309),s=r(661),c=r(996),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.pack=function(t){var e=t.rows,r=t.cols,n=o.possibleDeltaInputToString(this.deltaConstructor,e),i=o.possibleDeltaInputToString(this.deltaConstructor,r);return n.length.toString(36)+"$"+n+i},e.prototype.toJSON=function(t){var e=this.parse(t),r=e[0],n=e[1];return{rows:null===r?null:r.toJSON(),cols:null===n?null:n.toJSON()}},e.prototype.explain=function(t,e){var r=t+"Rows:\n",n=this.parse(e),o=n[0],i=n[1];return r+=null===o?"[EMPTY]":o.explain(t),r+=t+"Cols:\n",r+=null===i?"[EMPTY]":i.explain(t)},e.prototype.parse=function(t){var e=t.indexOf("$"),r=parseInt(t.substring(0,e),36),n=e+1+r;return[0===r?null:new this.deltaConstructor(t.substring(e+1,n)),t.length===n?null:new this.deltaConstructor(t.substring(n))]},e.prototype.compose=function(t,e,r){var n=this.parse(t),o=n[0],a=n[1],u=this.parse(e),s=u[0],c=u[1],l=null===s?o:null===o?s:o.compose(s,r),f=i.reindexInnerDeltas(a,s),p=null===c?f:null===f?c:f.compose(c,r);return this.pack({rows:l,cols:p})},e.prototype.transform=function(t,e,r){var n=this.parse(t),o=n[0],a=n[1],u=this.parse(e),s=u[0],c=u[1],l=null===o||null===s?s:o.transform(s,r),f=null===o||null===s?o:s.transform(o,!r),p=i.reindexInnerDeltas(a,l),d=i.reindexInnerDeltas(c,f),h=null===p||null===d?d:p.transform(d,r);return this.pack({rows:l,cols:h})},e.prototype.invert=function(t,e){var r=this,n=this.parse(t),o=n[0],a=n[1],l=this.parse(e),f=l[0],p=l[1],d=f&&(null===o?new this.deltaConstructor([]):o).invert(f),h=i.invertInnerDeltas(a,f);if(null!==p){var v=null===a?new c.default([]):a;if(h){var y=i.DeltaToIndexModifiers(p);h=i.reindexDelta(h,y)}var m=i.reindexInnerDeltas(p,d);if(null===m)throw new Error("ASSERT: targetCols === null");var g=v.invert(m,function(t,e){if("delta"!==e.dataType)return t.invert(e);for(var n=new u.Pool,o=new s.default([]),i="number"===t.dataType?null:new r.deltaConstructor(t.getCustomData()).getIter({targetPool:n}),a=new r.deltaConstructor(e.getCustomData()).getIter({targetPool:n});a.hasNext();){var c=void 0,l=void 0;if(null!==i&&i.hasNext()){var f=Math.min(i.peekLength(),a.peekLength());c=i.next(f,"insert"),l=a.next(f)}else{var p=a.peekLength();c=new r.operatorConstructor({action:"insert",data:p}),l=a.next()}o.push(c.invert(l))}return t.invert(e,{delta:new r.deltaConstructor(o.stringify(!0),n).stringify()})});h=h?h.compose(g):g}return this.pack({rows:d,cols:h})},e}(a.default);e.default=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(661),o=r(995),i=r(747);function a(t){for(var e=[],r=-1,n=t.getIter();n.hasNext();){var o=n.next(),i=o.action,a=o.length;-1!==r&&e[r][0]===i?e[r][1]+=a:e[++r]=[i,a]}return e}function u(t,e){for(var r=t.getPoolCopy(),a=new n.default([]),u=t.getIter({sourcePool:r,targetPool:r}),s=new Array(e.length),c=0;c<e.length&&u.hasNext();c++){var l=s[c]||e[c],f=l[0],p=l[1];switch(f){case"insert":a.push(new i.default({action:"retain",data:p,packedAttributes:"",pool:r}));break;case"retain":(d=u.peekLength())>=p?a.push(u.next(p)):(a.push(u.next()),s[c]=["retain",p-d],c-=1);break;case"remove":var d;(d=u.peekLength())>=p?u.skip(p):(u.skip(),s[c]=["remove",p-d],c-=1)}}for(;u.hasNext();)a.push(u.next());return new o.Delta(a.stringify(!0),r)}e.DeltaToIndexModifiers=a,e.reindexDelta=u,e.reindexInnerDeltas=function(t,e){if(null===t||null===e)return t;var r=a(e);return 0===r.length?t:t.map(function(t){var e={action:t.action,data:t.data};if("remove"!==e.action&&t.hasAttributes()&&(e.attributes=t.getAttributes()),"delta"===t.dataType){var n=u(new o.Delta(t.getCustomData()),r);e.data=n.isEmpty()?1:{delta:n.stringify()}}else e.data=t.data;return e})},e.invertInnerDeltas=function(t,e){if(null===t||null===e)return null;for(var r=a(e),u=!1,s=0,c=r;s<c.length;s++)if("remove"===c[s][0]){u=!0;break}return u?t.map(function(t){var e={action:"retain",data:t.data};if(t.hasAttributes()&&(e.attributes=t.getAttributes()),"delta"===t.dataType){var a=function(t,e){for(var r=t.getPoolCopy(),a=new n.default([]),u=t.getIter({sourcePool:r,targetPool:r}),s=new Array(e.length),c=0;c<e.length&&u.hasNext();c++){var l=s[c]||e[c],f=l[0],p=l[1];switch(f){case"retain":var d=u.peekLength(),h=Math.min(p,d);a.push(new i.default({action:"retain",data:h,packedAttributes:"",pool:r})),u.skip(h),d<p&&(s[c]=["retain",p-d],c-=1);break;case"remove":(d=u.peekLength())>=p?a.push(u.next(p)):(a.push(u.next()),s[c]=["remove",p-d],c-=1)}}for(var v=0;u.hasNext();)v+=u.peekLength(),u.skip();return v>0&&a.push(new i.default({action:"retain",data:v,packedAttributes:"",pool:r})),new o.Delta(a.stringify(!0),r)}(new o.Delta(t.getCustomData()),r);e.data=a.isEmpty()?1:{delta:a.stringify()}}else e.data=t.data;return e}):null}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(597),i=r(1e3),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){return this.parse(t).compose(this.parse(e),r).stringify()},e.prototype.transform=function(t,e,r){return this.parse(t).transform(this.parse(e),r).stringify()},e.prototype.invert=function(t,e){return this.parse(t).invert(this.parse(e)).stringify()},e.prototype.parse=function(t){return new this.deltaConstructor(t)},e.prototype.pack=function(t){if(Array.isArray(t))return new this.deltaConstructor(t).stringify();if(i.isDelta(t))return t.stringify();throw new Error("Unsupported delta value for packing "+t)},e.prototype.toJSON=function(t){return this.parse(t).toJSON()},e.prototype.explain=function(t,e){return this.parse(e).explain(t)},e}(o.default);e.default=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){for(var n=this.parse(t),o=this.parse(e),i=0,a=Object.keys(o);i<a.length;i++){var u=a[i],s=n[u],c=o[u];n[u]=void 0===s?c:s.compose(c,r)}return this.pack(n)},e.prototype.transform=function(t,e,r){for(var n=this.parse(t),o=this.parse(e),i=0,a=Object.keys(o);i<a.length;i++){var u=a[i],s=n[u];if(void 0!==s){var c=o[u];o[u]=s.transform(c,r)}}return this.pack(o)},e.prototype.invert=function(t,e){for(var r=this.parse(t),n=this.parse(e),o=0,i=Object.keys(n);o<i.length;o++){var a=i[o],u=r[a]||new this.deltaConstructor([]);n[a]=u.invert(n[a])}return this.pack(n)},e.prototype.parse=function(t){for(var e={},r=0;r<t.length;){var n=t.substring(r,r+8),o=t.indexOf("#",r+8),i=parseInt(t.substring(r+8,o),36),a=new this.deltaConstructor(t.substring(o+1,o+1+i));e[n]=a,r=o+1+i}return e},e.prototype.pack=function(t){for(var e="",r=0,n=Object.keys(t).sort();r<n.length;r++){var o=n[r];if(8!==o.length)throw new Error("element id length must equal to 8, got "+o);var i=t[o],a=Array.isArray(i)?new this.deltaConstructor(i):i;if(a.getIter().hasNext()){var u=a.stringify();e+=""+o+u.length.toString(36)+"#"+u}}return e},e.prototype.toJSON=function(t){for(var e={},r=this.parse(t),n=0,o=Object.keys(r);n<o.length;n++){var i=o[n],a=r[i];e[i]=a.toJSON()}return e},e.prototype.explain=function(t,e){for(var r=t+"Elements:\n",n=this.parse(e),o=0,i=Object.keys(n);o<i.length;o++){r+=n[i[o]].explain(t)}return r},e}(r(597).default);e.default=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.pack=function(e){return t.prototype.pack.call(this,Array.isArray(e)?e:[e.slides,e.layouts,e.notes])},e.prototype.toJSON=function(e){var r=t.prototype.toJSON.call(this,e);return{slides:r[0],layouts:r[1],notes:r[2]}},e.prototype.explain=function(t,e){var r=t+"Slides:\n",n=this.parse(e),o=n[0],i=n[1],a=n[2];return r+=o?o.explain(t):"[EMPTY]",r+=t+"Layouts:\n",r+=i?i.explain(t):"[EMPTY]",r+=t+"Notes:\n",r+=a?a.explain(t):"[EMPTY]"},e}(r(1002).default);e.default=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(597),i=r(999),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){return this.pack(i.merge(this.parse(t),this.parse(e),!r),r)},e.prototype.transform=function(t,e,r){return this.pack(i.transform(this.parse(t),this.parse(e),r),!1)},e.prototype.invert=function(t,e){return this.pack(i.invert(this.parse(t),this.parse(e)),!1)},e.prototype.parse=function(t){return JSON.parse(t)},e.prototype.pack=function(t,e){return e?JSON.stringify(t,function(t,e){return null===e?void 0:e}):JSON.stringify(t)},e.prototype.toJSON=function(t){return this.parse(t)},e.prototype.explain=function(t,e){return JSON.stringify(this.parse(e),null,t)},e}(o.default);e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.prune=function(t){if(!t)return t;var e={};for(var r in t)t.hasOwnProperty(r)&&void 0!==t[r]&&(e[r]=t[r]);return e}},function(t,e,r){"use strict";var n=this&&this.__assign||Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},a=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var u=a(r(262)),s=r(1495),c=r(748),l=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data;return"number"==typeof n?new u.CellOperator({action:e,data:n,attributes:r}):new u.CellOperator({action:e,data:1,attributes:r})},f=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data;return new u.Operator({action:e,data:n,attributes:r})},p=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data;return new u.Operator({action:e,data:n,attributes:r})};e.toRichdocTable=function(t){var e=t.action,r=(t.element,t.attrs),n=t.data,o="object"!=typeof n?n:{cells:"object"!=typeof n.cells?n.cells:s.mapObject(n.cells,l),rows:Array.isArray(n.rows)?new u.Delta(n.rows.map(p)):n.rows,cols:Array.isArray(n.columns)?new u.Delta(n.columns.map(f)):n.columns};return new u.TableOperator({action:e,data:o,attributes:r})};var d=function(t){var r=t.data,n=t.action,o=t.getAttributes()||{};return e.changeset[n](c.Element.Row,o,r)},h=function(t){var r=t.data,n=t.action,o=t.getAttributes()||{};return e.changeset[n](c.Element.Column,o,r)},v=function(t){var r,o=t.data,a=t.action,u=t.getAttributes()||{},s="object"!=typeof o?o:{rows:o.rows&&o.rows.ops.map(d),columns:o.cols&&o.cols.ops.map(h),cells:o.cells&&function(t){var r={};return t.forEach(function(o){r[o]=function(t){var r,o=t.data,a=t.action,u=t.getAttributes()||{};if("number"!=typeof o&&Array.isArray(o&&o.ops)&&o.ops.length){var s=i(o.ops,2),l=s[0],f=s[1];f?r=f.data:l.action===c.Action.Remove?r=null:"string"==typeof l.data&&(r=l.data)}else"cellValue"in u&&(r=u.cellValue);return"number"==typeof o?e.changeset[a](c.Element.Cell,u,o):e.changeset[a](c.Element.Cell,n({},u,{cellValue:r}),1)}(t.get(o))}),r}(o.cells)};return(r={},r[c.Action.Insert]=e.changeset.insert,r[c.Action.Retain]=e.changeset.retain,r[c.Action.Remove]=e.changeset.remove,r)[a](c.Element.Table,u,s)};function y(){var t,e;return o(this,function(r){switch(r.label){case 0:t=this.content.getIter(),r.label=1;case 1:return t.hasNext()?(e=t.next(),[4,v(e)]):[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}e.changeset={from:function(t){var e;return(e={type:c.ChangesetType.Richdoc,content:t})[Symbol.iterator]=y,e},create:function(t){return e.changeset.from(new u.Delta(t.map(e.toRichdocTable)))},insert:function(t,e,r){return{action:c.Action.Insert,element:t,attrs:e,data:r}},retain:function(t,e,r){return{action:c.Action.Retain,element:t,attrs:e,data:r}},remove:function(t,e,r){return{action:c.Action.Remove,element:t,attrs:e,data:r}},compose:function(t){return e.changeset.from(t.map(function(t){return t.content}).reduce(function(t,e){return t.compose(e)},new u.Delta([])))},transform:function(t,r){return e.changeset.from(t.content.transform(r.content))},invert:function(t,r){return e.changeset.from(t.content.invert(r.content))},serialize:function(t){return u.pack(t.content)},deserialize:function(t){return e.changeset.from(u.unpack(t))}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.mapObject=function(t,e){var r={};for(var n in t)if(t.hasOwnProperty(n)){var o=t[n];r[n]=e(o)}return r}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var r in t)e.hasOwnProperty(r)||(e[r]=t[r])}(r(663)),e.ColumnType={CREATE_AT:"CREATE_AT"}},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a=this;Object.defineProperty(e,"__esModule",{value:!0});var u=r(1003),s=r(1498),c=r(1004),l=r(1005),f=r(1007),p=r(1499),d=function(){},h={info:d,error:d};e.createFormService=function(t){var e=t.formApiUrl,r=t.isMocking,d=void 0!==r&&r,v=t.logger,y=void 0===v?h:v,m=t.isTesting,g=void 0!==m&&m;null==e&&(e=window.location.origin+"/form");var b=void 0,w=void 0,_=c.createLogger({channel:"form",logger:y}),O=p.createFormApi({formApiUrl:e,logger:y,isTesting:g}),x=function(t){return o(a,void 0,void 0,function(){var e,r;return i(this,function(n){switch(n.label){case 0:return d?[2,w&&w.guid===t?w:void 0]:[3,1];case 1:return n.trys.push([1,3,,4]),[4,O.fetchForm(t)];case 2:return e=n.sent(),[2,l.fromServerForm(e.form,e.formItems)];case 3:if((r=n.sent())&&404==r.code&&/不存在/.test(r.errmsg))return[2,void 0];throw r;case 4:return[2]}})})},C=function(t){return o(a,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:if(!d)return[3,1];if(!w)throw new Error("mock form does not exist, cannot update");return Object.assign(w,t),[3,3];case 1:return[4,O.updateForm(n({},l.toServerForm(t),{formGuid:t.guid,formItems:t.items&&f.stringify(t.items.map(l.toServerFormItem))}))];case 2:e.sent(),e.label=3;case 3:return[2]}})})},S=function(t){return o(a,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return d?(w=t,[3,3]):[3,1];case 1:return[4,O.createForm(n({},l.toServerForm(t),{formItems:f.stringify(t.items.map(l.toServerFormItem))}))];case 2:e.sent(),e.label=3;case 3:return[2]}})})},j=function(t){return o(a,void 0,void 0,function(){var e;return i(this,function(r){switch(r.label){case 0:return d?(w=void 0,[3,4]):[3,1];case 1:return[4,O.fetchFormDrafts(t)];case 2:return(e=r.sent())&&e.forms&&e.forms.length?[4,Promise.all(e.forms.map(function(t){return O.deleteForm(t.guid)}))]:[3,4];case 3:r.sent(),r.label=4;case 4:return[2]}})})};return{MAX_ITEM_COUNT:100,MAX_DESC_LENGTH:200,createForm:function(){var t=new Date(new Date((new Date).getTime()+6048e5).setHours(12,0,0,0));return{guid:s.genId(16),spreadGuid:"",sheetGuid:"",title:"",desc:"",items:[],deadline:!1,deadlineDate:t}},createFormOption:function(t,e){return void 0===t&&(t=""),void 0===e&&(e="normal"),{type:e,value:s.genId(5),label:t}},createFormItemText:function(){return{guid:s.genId(5),type:u.FormItemType.Text,subject:"",required:!0}},createFormItemSingleChoice:function(){return{guid:s.genId(5),type:u.FormItemType.SingleChoice,subject:"",required:!0,options:[]}},createFormItemMultipleChoice:function(){return{guid:s.genId(5),type:u.FormItemType.MultipleChoice,subject:"",required:!0,options:[]}},createFormItemDropdownList:function(){return{guid:s.genId(5),type:u.FormItemType.DropdownList,subject:"",required:!0,options:[]}},copyFormItem:function(t){return n({},function(t){return JSON.parse(JSON.stringify(t))}(t),{guid:s.genId(5)})},isFormUnlinked:function(t){return null==t.sheetGuid||null==t.spreadGuid},isFormOverdue:function(t){return t.deadline&&t.deadlineDate&&t.deadlineDate.getTime()<(new Date).getTime()},fetchForm:_(x),fetchFormDraft:_(function(t){return o(a,void 0,void 0,function(){var e,r,n;return i(this,function(o){switch(o.label){case 0:return d?[2,b&&b.guid===t?b:void 0]:[3,1];case 1:return o.trys.push([1,6,,7]),[4,O.fetchFormDrafts(t)];case 2:return(e=o.sent())&&e.forms&&e.forms.length?[4,x(e.forms[0].guid)]:[3,4];case 3:return(r=o.sent())&&(r.guid=t),[2,r];case 4:return[2,void 0];case 5:return[3,7];case 6:if((n=o.sent())&&404==n.code&&/不存在/.test(n.errmsg))return[2,void 0];throw n;case 7:return[2]}})})}),submitFilledForm:_(function(t){var e=t.guid,r=t.items,n=t.userId;return o(a,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return d?[2]:[4,O.submitForm({formGuid:e,formItems:f.stringify(r.map(function(t){return l.toServerItemReponse(t,n)}))})];case 1:return t.sent(),[2]}})})}),publishForm:_(function(t){return o(a,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return d?(b&&b.guid===t.guid&&(b=void 0),w=t,[3,8]):[3,1];case 1:return[4,x(t.guid)];case 2:return e.sent()?[3,4]:[4,_(S)(t)];case 3:return e.sent(),[3,6];case 4:return[4,_(C)(t)];case 5:e.sent(),e.label=6;case 6:return[4,j(t.guid)];case 7:e.sent(),e.label=8;case 8:return[2]}})})}),updateForm:_(C),unlinkForm:_(function(t){return o(a,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:if(!d)return[3,1];if(!w)throw new Error("mock form does not exist, cannot update");return w.spreadGuid=null,w.sheetGuid=null,[3,4];case 1:return[4,O.unlinkForm(t)];case 2:return e.sent(),[4,j(t)];case 3:e.sent(),e.label=4;case 4:return[2]}})})}),saveFormDraft:_(function(t){return o(a,void 0,void 0,function(){var e,r;return i(this,function(o){switch(o.label){case 0:return d?(b=t,[2]):[3,1];case 1:return[4,O.fetchFormDrafts(t.guid)];case 2:return(e=o.sent().forms).length?(r=e[0],[4,O.updateForm(n({},l.toServerForm(t),{guid:r.guid,formItems:f.stringify(t.items.map(l.toServerFormItem)),formGuid:r.guid}))]):[3,4];case 3:return o.sent(),[3,6];case 4:return[4,O.createFormDraft(n({},l.toServerForm(t),{formItems:f.stringify(t.items.map(l.toServerFormItem)),formGuid:t.guid}))];case 5:o.sent(),o.label=6;case 6:return[2]}})})}),updateFormDeadline:_(function(t){return o(a,void 0,void 0,function(){var e;return i(this,function(r){switch(r.label){case 0:return d?(w&&w.guid===t.guid&&Object.assign(w,{deadline:t.deadline,deadlineDate:t.deadlineDate}),[3,3]):[3,1];case 1:return e={guid:t.guid,deadline:t.deadline,deadlineDate:t.deadlineDate},[4,C(e)];case 2:r.sent(),r.label=3;case 3:return[2]}})})})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";e.genId=function(t){void 0===t&&(t=5);for(var e="",r=0;r<t;r++)e+=n.charAt(Math.floor(Math.random()*n.length));return e}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this;Object.defineProperty(e,"__esModule",{value:!0});var a=r(1004),u=r(1500),s=function(){},c={info:s,error:s};e.createFormApi=function(t){var e=t.formApiUrl,r=t.logger,s=void 0===r?c:r,l=t.isTesting,f=void 0!==l&&l,p=a.createLogger({channel:"request",logger:s})(function(t){var r=t.path,a=t.method,s=t.data;return n(i,void 0,void 0,function(){var t,n,i,c,l,p,d;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t={},f&&(t["x-shimo-user"]=JSON.stringify({id:12345}),(s=s||{}).test=1),[4,u.ajax.request(e+r,{method:a.toLowerCase(),data:s,headers:t})];case 1:return[2,o.sent()];case 2:throw n=o.sent(),i=n.response,c=i.status,l=i.data,p=(l||{}).message,(d=void 0===p?"":p)?{errmsg:d,code:c}:n;case 3:return[2]}})})});return{createForm:function(t){return p({path:"/forms",method:"POST",data:t})},createFormDraft:function(t){return p({path:"/forms/"+t.formGuid+"/drafts",method:"POST",data:t})},deleteForm:function(t){return p({path:"/forms/"+t,method:"DELETE"})},updateForm:function(t){return p({path:"/forms/"+t.formGuid,method:"PUT",data:t})},fetchForm:function(t){return p({path:"/forms/"+t,method:"GET"})},fetchFormDrafts:function(t){return p({path:"/forms/"+t+"/drafts",method:"GET"})},submitForm:function(t){return p({path:"/forms/"+t.formGuid+"/submitHistories",method:"POST",data:t})},unlinkForm:function(t){return p({path:"/forms/"+t+"/unLink",method:"POST",data:{formGuid:t}})}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(303);e.ajax={request:function(t,e){var r=e.method,o=e.data,i=e.headers;return"get"===r.toLowerCase()?n.default.request({url:t,method:r,params:o,headers:i}).then(function(t){return t.data}):n.default.request({url:t,method:r,data:o,headers:i}).then(function(t){return t.data})}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(660),a=r(662),u="CREATE_AT";e.createChangeForCreateForm=function(t){for(var e=t.spread,r=t.form,n=t.type,s=t.userId,c="richdoc"===n?i.Changeset.Richdoc:i.Changeset.Modoc,l="richdoc"===n?i.Changeset.Richdoc.from(e):i.Changeset.Modoc.from(e),f=o(l),p=f[0].attrs.nextIndex||1,d=o(["填写时间"],r.items.map(function(t){return t.subject})),h=Math.max(18,d.length),v={},y=0;y<h;y++){var m=d[y];v[a.toCellName(0,y)]=c.retain(i.Element.Cell,{userId:s,authorId:s,color:"#ffffff",background:"#41464b",format:"@",cellValue:m},1)}var g=[c.insert(i.Element.Row,{height:30},1),c.insert(i.Element.Row,{},199)],b=o([c.insert(i.Element.Column,{formItemGuid:u,width:135},1)],r.items.map(function(t){return c.insert(i.Element.Column,{formItemGuid:t.guid},1)}),[1+r.items.length<18?c.insert(i.Element.Column,{},18-(r.items.length+1)):null]).filter(Boolean),w=[c.retain(i.Element.Table,{nextIndex:p+1},1),f.length>1?c.retain(i.Element.Table,{},f.length-1):null,c.insert(i.Element.Table,{id:r.sheetGuid,name:r.title,order:p,formGuid:r.guid,fixedRowsTop:1},{cells:v,rows:g,columns:b})].filter(Boolean);return c.create(w).content}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(660);e.createChangeForUnlinkForm=function(t){var e=t.spread,r=t.sheetGuid,n=t.type,a=t.userId,u="richdoc"===n?i.Changeset.Richdoc:i.Changeset.Modoc,s="richdoc"===n?i.Changeset.Richdoc.from(e):i.Changeset.Modoc.from(e),c=o(s),l=c.findIndex(function(t){return(t.attrs||{}).id===r}),f=c[l],p=(f.data&&"number"!=typeof f.data&&f.data.columns||[]).map(function(t){return u.retain(i.Element.Column,{formItemGuid:null},t.data)}).filter(Boolean),d=[l>0?u.retain(i.Element.Table,{},l):null,u.retain(i.Element.Table,{formGuid:null,userId:a,authorId:a},{columns:p})].filter(Boolean);return u.create(d).content}},function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0}),r(1504),r(1602);var o=n(r(1606));e.formEntry=o;var i=n(r(674));e.formService=i;var a=n(r(605));e.types=a;var u=n(r(1029));e.formChangeset=u;var s=r(1632),c=r(1034),l=r(1033),f=r(1633),p=r(1028),d=r(1030).createDecorator({onError:function(t,e,r){console.info("------------------------"),console.info("["+r+"] params:",JSON.stringify(e,null,2)),console.error("["+r+"] error:",t),console.info("------------------------")}}),h={createChangeForCreateForm:d(s.createChangeForCreateForm),createChangeForUnlinkForm:d(c.createChangeForUnlinkForm),createChangeForUpdateForm:d(l.createChangeForUpdateForm),createChangeForCreateSpread:d(f.createChangeForCreateSpread),createChangeForSubmitForm:d(p.createChangeForSubmitForm)};e.sheetChangeset=h},function(t,e,r){"use strict";try{r(1505),r(1553),r(1557),r(1562),r(1566),r(1570),r(1575),r(1579),r(1583),r(1593),r(1597),r(1601).polyfill()}catch(t){throw console.error("[polyfill]",t),t}},function(t,e,r){var n=r(1506);r(1546),r(1547),r(1548),r(1549),r(1550),r(1551),r(1552),t.exports=n},function(t,e,r){var n=r(1507);r(1020),t.exports=n},function(t,e,r){r(1508),r(1017),r(1520),r(1525),r(1526),r(1527),r(1528),r(1019),r(1529),r(1530),r(1531),r(1532),r(1533),r(1534),r(1535),r(1536),r(1537),r(1538),r(1539),r(1540);var n=r(535);t.exports=n.Symbol},function(t,e,r){"use strict";var n=r(299),o=r(364),i=r(760),a=r(365),u=r(500),s=r(533),c=r(1015),l=r(1016),f=r(1518),p=r(238),d=r(751),h=p("isConcatSpreadable"),v=d>=51||!o(function(){var t=[];return t[h]=!1,t.concat()[0]!==t}),y=f("concat"),m=function(t){if(!a(t))return!1;var e=t[h];return void 0!==e?!!e:i(t)};n({target:"Array",proto:!0,forced:!v||!y},{concat:function(t){var e,r,n,o,i,a=u(this),f=l(a,0),p=0;for(e=-1,n=arguments.length;e<n;e++)if(i=-1===e?a:arguments[e],m(i)){if(p+(o=s(i.length))>9007199254740991)throw TypeError("Maximum allowed index exceeded");for(r=0;r<o;r++,p++)r in i&&c(f,p,i[r])}else{if(p>=9007199254740991)throw TypeError("Maximum allowed index exceeded");c(f,p++,i)}return f.length=p,f}})},function(t,e,r){var n=r(365),o=r(667),i=r(1511),a=r(238)("toPrimitive");t.exports=function(t,e){if(!n(t)||o(t))return t;var r,u=t[a];if(void 0!==u){if(void 0===e&&(e="default"),r=u.call(t,e),!n(r)||o(r))return r;throw TypeError("Can't convert object to primitive value")}return void 0===e&&(e="number"),i(t,e)}},function(t,e,r){var n=r(600);t.exports=n("navigator","userAgent")||""},function(t,e,r){var n=r(365);t.exports=function(t,e){var r,o;if("string"===e&&"function"==typeof(r=t.toString)&&!n(o=r.call(t)))return o;if("function"==typeof(r=t.valueOf)&&!n(o=r.call(t)))return o;if("string"!==e&&"function"==typeof(r=t.toString)&&!n(o=r.call(t)))return o;throw TypeError("Can't convert object to primitive value")}},function(t,e,r){var n=r(265),o=r(1012),i=n.WeakMap;t.exports="function"==typeof i&&/native code/.test(o(i))},function(t,e,r){var n=r(600),o=r(756),i=r(759),a=r(467);t.exports=n("Reflect","ownKeys")||function(t){var e=o.f(a(t)),r=i.f;return r?e.concat(r(t)):e}},function(t,e,r){var n=r(499),o=r(533),i=r(1515),a=function(t){return function(e,r,a){var u,s=n(e),c=o(s.length),l=i(a,c);if(t&&r!=r){for(;c>l;)if((u=s[l++])!=u)return!0}else for(;c>l;l++)if((t||l in s)&&s[l]===r)return t||l||0;return!t&&-1}};t.exports={includes:a(!0),indexOf:a(!1)}},function(t,e,r){var n=r(757),o=Math.max,i=Math.min;t.exports=function(t,e){var r=n(t);return r<0?o(r+e,0):i(r,e)}},function(t,e,r){var n=r(364),o=/#|\.prototype\./,i=function(t,e){var r=u[a(t)];return r==c||r!=s&&("function"==typeof e?n(e):!!e)},a=i.normalize=function(t){return String(t).replace(o,".").toLowerCase()},u=i.data={},s=i.NATIVE="N",c=i.POLYFILL="P";t.exports=i},function(t,e,r){var n=r(365),o=r(760),i=r(238)("species");t.exports=function(t){var e;return o(t)&&("function"!=typeof(e=t.constructor)||e!==Array&&!o(e.prototype)?n(e)&&null===(e=e[i])&&(e=void 0):e=void 0),void 0===e?Array:e}},function(t,e,r){var n=r(364),o=r(238),i=r(751),a=o("species");t.exports=function(t){return i>=51||!n(function(){var e=[];return(e.constructor={})[a]=function(){return{foo:1}},1!==e[t](Boolean).foo})}},function(t,e,r){"use strict";var n=r(761),o=r(1018);t.exports=n?{}.toString:function(){return"[object "+o(this)+"]"}},function(t,e,r){"use strict";var n=r(299),o=r(265),i=r(600),a=r(532),u=r(440),s=r(750),c=r(364),l=r(317),f=r(760),p=r(365),d=r(667),h=r(467),v=r(500),y=r(499),m=r(666),g=r(534),b=r(599),w=r(762),_=r(672),O=r(756),x=r(1523),C=r(759),S=r(598),j=r(441),E=r(664),A=r(501),k=r(668),T=r(752),I=r(670),P=r(671),M=r(755),F=r(238),D=r(763),R=r(191),N=r(536),L=r(669),G=r(764).forEach,U=I("hidden"),z=F("toPrimitive"),B=L.set,V=L.getterFor("Symbol"),q=Object.prototype,$=o.Symbol,H=i("JSON","stringify"),Y=S.f,J=j.f,W=x.f,Q=E.f,K=T("symbols"),Z=T("op-symbols"),X=T("string-to-symbol-registry"),tt=T("symbol-to-string-registry"),et=T("wks"),rt=o.QObject,nt=!rt||!rt.prototype||!rt.prototype.findChild,ot=u&&c(function(){return 7!=w(J({},"a",{get:function(){return J(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=Y(q,e);n&&delete q[e],J(t,e,r),n&&t!==q&&J(q,e,n)}:J,it=function(t,e){var r=K[t]=w($.prototype);return B(r,{type:"Symbol",tag:t,description:e}),u||(r.description=e),r},at=function(t,e,r){t===q&&at(Z,e,r),h(t);var n=m(e);return h(r),l(K,n)?(r.enumerable?(l(t,U)&&t[U][n]&&(t[U][n]=!1),r=w(r,{enumerable:b(0,!1)})):(l(t,U)||J(t,U,b(1,{})),t[U][n]=!0),ot(t,n,r)):J(t,n,r)},ut=function(t,e){h(t);var r=y(e),n=_(r).concat(ft(r));return G(n,function(e){u&&!st.call(r,e)||at(t,e,r[e])}),t},st=function(t){var e=m(t),r=Q.call(this,e);return!(this===q&&l(K,e)&&!l(Z,e))&&(!(r||!l(this,e)||!l(K,e)||l(this,U)&&this[U][e])||r)},ct=function(t,e){var r=y(t),n=m(e);if(r!==q||!l(K,n)||l(Z,n)){var o=Y(r,n);return!o||!l(K,n)||l(r,U)&&r[U][n]||(o.enumerable=!0),o}},lt=function(t){var e=W(y(t)),r=[];return G(e,function(t){l(K,t)||l(P,t)||r.push(t)}),r},ft=function(t){var e=t===q,r=W(e?Z:y(t)),n=[];return G(r,function(t){!l(K,t)||e&&!l(q,t)||n.push(K[t])}),n};(s||(k(($=function(){if(this instanceof $)throw TypeError("Symbol is not a constructor");var t=arguments.length&&void 0!==arguments[0]?g(arguments[0]):void 0,e=M(t),r=function(t){this===q&&r.call(Z,t),l(this,U)&&l(this[U],e)&&(this[U][e]=!1),ot(this,e,b(1,t))};return u&&nt&&ot(q,e,{configurable:!0,set:r}),it(e,t)}).prototype,"toString",function(){return V(this).tag}),k($,"withoutSetter",function(t){return it(M(t),t)}),E.f=st,j.f=at,S.f=ct,O.f=x.f=lt,C.f=ft,D.f=function(t){return it(F(t),t)},u&&(J($.prototype,"description",{configurable:!0,get:function(){return V(this).description}}),a||k(q,"propertyIsEnumerable",st,{unsafe:!0}))),n({global:!0,wrap:!0,forced:!s,sham:!s},{Symbol:$}),G(_(et),function(t){R(t)}),n({target:"Symbol",stat:!0,forced:!s},{for:function(t){var e=g(t);if(l(X,e))return X[e];var r=$(e);return X[e]=r,tt[r]=e,r},keyFor:function(t){if(!d(t))throw TypeError(t+" is not a symbol");if(l(tt,t))return tt[t]},useSetter:function(){nt=!0},useSimple:function(){nt=!1}}),n({target:"Object",stat:!0,forced:!s,sham:!u},{create:function(t,e){return void 0===e?w(t):ut(w(t),e)},defineProperty:at,defineProperties:ut,getOwnPropertyDescriptor:ct}),n({target:"Object",stat:!0,forced:!s},{getOwnPropertyNames:lt,getOwnPropertySymbols:ft}),n({target:"Object",stat:!0,forced:c(function(){C.f(1)})},{getOwnPropertySymbols:function(t){return C.f(v(t))}}),H)&&n({target:"JSON",stat:!0,forced:!s||c(function(){var t=$();return"[null]"!=H([t])||"{}"!=H({a:t})||"{}"!=H(Object(t))})},{stringify:function(t,e,r){for(var n,o=[t],i=1;arguments.length>i;)o.push(arguments[i++]);if(n=e,(p(e)||void 0!==t)&&!d(t))return f(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!d(e))return e}),o[1]=e,H.apply(null,o)}});$.prototype[z]||A($.prototype,z,$.prototype.valueOf),N($,"Symbol"),P[U]=!0},function(t,e,r){var n=r(440),o=r(441),i=r(467),a=r(672);t.exports=n?Object.defineProperties:function(t,e){i(t);for(var r,n=a(e),u=n.length,s=0;u>s;)o.f(t,r=n[s++],e[r]);return t}},function(t,e,r){var n=r(600);t.exports=n("document","documentElement")},function(t,e,r){var n=r(499),o=r(756).f,i={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(t){return a&&"[object Window]"==i.call(t)?function(t){try{return o(t)}catch(t){return a.slice()}}(t):o(n(t))}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}},function(t,e,r){r(191)("asyncIterator")},function(t,e,r){"use strict";var n=r(299),o=r(440),i=r(265),a=r(317),u=r(365),s=r(441).f,c=r(1013),l=i.Symbol;if(o&&"function"==typeof l&&(!("description"in l.prototype)||void 0!==l().description)){var f={},p=function(){var t=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),e=this instanceof p?new l(t):void 0===t?l():l(t);return""===t&&(f[e]=!0),e};c(p,l);var d=p.prototype=l.prototype;d.constructor=p;var h=d.toString,v="Symbol(test)"==String(l("test")),y=/^Symbol\((.*)\)[^)]+$/;s(d,"description",{configurable:!0,get:function(){var t=u(this)?this.valueOf():this,e=h.call(t);if(a(f,t))return"";var r=v?e.slice(7,-1):e.replace(y,"$1");return""===r?void 0:r}}),n({global:!0,forced:!0},{Symbol:p})}},function(t,e,r){r(191)("hasInstance")},function(t,e,r){r(191)("isConcatSpreadable")},function(t,e,r){r(191)("match")},function(t,e,r){r(191)("matchAll")},function(t,e,r){r(191)("replace")},function(t,e,r){r(191)("search")},function(t,e,r){r(191)("species")},function(t,e,r){r(191)("split")},function(t,e,r){r(191)("toPrimitive")},function(t,e,r){r(191)("toStringTag")},function(t,e,r){r(191)("unscopables")},function(t,e,r){var n=r(265);r(536)(n.JSON,"JSON",!0)},function(t,e,r){r(536)(Math,"Math",!0)},function(t,e,r){var n=r(299),o=r(265),i=r(536);n({global:!0},{Reflect:{}}),i(o.Reflect,"Reflect",!0)},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e,r){"use strict";var n=r(1023).IteratorPrototype,o=r(762),i=r(599),a=r(536),u=r(601),s=function(){return this};t.exports=function(t,e,r){var c=e+" Iterator";return t.prototype=o(n,{next:i(1,r)}),a(t,c,!1,!0),u[c]=s,t}},function(t,e,r){var n=r(364);t.exports=!n(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},function(t,e,r){var n=r(467),o=r(1545);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),e=r instanceof Array}catch(t){}return function(r,i){return n(r),o(i),e?t.call(r,i):r.__proto__=i,r}}():void 0)},function(t,e,r){var n=r(365);t.exports=function(t){if(!n(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,r){r(191)("asyncDispose")},function(t,e,r){r(191)("dispose")},function(t,e,r){r(191)("matcher")},function(t,e,r){r(191)("metadata")},function(t,e,r){r(191)("observable")},function(t,e,r){r(191)("patternMatch")},function(t,e,r){r(191)("replaceAll")},function(t,e,r){var n=r(1554);t.exports=n},function(t,e,r){var n=r(1555);r(1020),t.exports=n},function(t,e,r){r(1021),r(1017),r(1025),r(1019);var n=r(763);t.exports=n.f("iterator")},function(t,e,r){var n=r(757),o=r(534),i=r(531),a=function(t){return function(e,r){var a,u,s=o(i(e)),c=n(r),l=s.length;return c<0||c>=l?t?"":void 0:(a=s.charCodeAt(c))<55296||a>56319||c+1===l||(u=s.charCodeAt(c+1))<56320||u>57343?t?s.charAt(c):a:t?s.slice(c,c+2):u-56320+(a-55296<<10)+65536}};t.exports={codeAt:a(!1),charAt:a(!0)}},function(t,e,r){var n=r(1558);t.exports=n},function(t,e,r){var n=r(1559);t.exports=n},function(t,e,r){r(1560);var n=r(535);t.exports=n.Object.assign},function(t,e,r){var n=r(299),o=r(1561);n({target:"Object",stat:!0,forced:Object.assign!==o},{assign:o})},function(t,e,r){"use strict";var n=r(440),o=r(364),i=r(672),a=r(759),u=r(664),s=r(500),c=r(749),l=Object.assign,f=Object.defineProperty;t.exports=!l||o(function(){if(n&&1!==l({b:1},l(f({},"a",{enumerable:!0,get:function(){f(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},r=Symbol();return t[r]=7,"abcdefghijklmnopqrst".split("").forEach(function(t){e[t]=t}),7!=l({},t)[r]||"abcdefghijklmnopqrst"!=i(l({},e)).join("")})?function(t,e){for(var r=s(t),o=arguments.length,l=1,f=a.f,p=u.f;o>l;)for(var d,h=c(arguments[l++]),v=f?i(h).concat(f(h)):i(h),y=v.length,m=0;y>m;)d=v[m++],n&&!p.call(h,d)||(r[d]=h[d]);return r}:l},function(t,e,r){var n=r(1563);t.exports=n},function(t,e,r){var n=r(1564);t.exports=n},function(t,e,r){r(1565);var n=r(535);t.exports=n.Object.values},function(t,e,r){var n=r(299),o=r(1026).values;n({target:"Object",stat:!0},{values:function(t){return o(t)}})},function(t,e,r){var n=r(1567);t.exports=n},function(t,e,r){var n=r(1568);t.exports=n},function(t,e,r){r(1569);var n=r(535);t.exports=n.Object.entries},function(t,e,r){var n=r(299),o=r(1026).entries;n({target:"Object",stat:!0},{entries:function(t){return o(t)}})},function(t,e,r){var n=r(1571);t.exports=n},function(t,e,r){var n=r(1572);t.exports=n},function(t,e,r){r(1573);var n=r(602);t.exports=n("String","startsWith")},function(t,e,r){"use strict";var n=r(299),o=r(598).f,i=r(533),a=r(534),u=r(767),s=r(531),c=r(768),l=r(532),f="".startsWith,p=Math.min,d=c("startsWith");n({target:"String",proto:!0,forced:!(!l&&!d&&!!function(){var t=o(String.prototype,"startsWith");return t&&!t.writable}())&&!d},{startsWith:function(t){var e=a(s(this));u(t);var r=i(p(arguments.length>1?arguments[1]:void 0,e.length)),n=a(t);return f?f.call(e,n,r):e.slice(r,r+n.length)===n}})},function(t,e,r){var n=r(365),o=r(665),i=r(238)("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==o(t))}},function(t,e,r){var n=r(1576);t.exports=n},function(t,e,r){var n=r(1577);t.exports=n},function(t,e,r){r(1578);var n=r(602);t.exports=n("String","endsWith")},function(t,e,r){"use strict";var n=r(299),o=r(598).f,i=r(533),a=r(534),u=r(767),s=r(531),c=r(768),l=r(532),f="".endsWith,p=Math.min,d=c("endsWith");n({target:"String",proto:!0,forced:!(!l&&!d&&!!function(){var t=o(String.prototype,"endsWith");return t&&!t.writable}())&&!d},{endsWith:function(t){var e=a(s(this));u(t);var r=arguments.length>1?arguments[1]:void 0,n=i(e.length),o=void 0===r?n:p(i(r),n),c=a(t);return f?f.call(e,c,o):e.slice(o-c.length,o)===c}})},function(t,e,r){var n=r(1580);t.exports=n},function(t,e,r){var n=r(1581);t.exports=n},function(t,e,r){r(1582);var n=r(602);t.exports=n("String","includes")},function(t,e,r){"use strict";var n=r(299),o=r(767),i=r(531),a=r(534);n({target:"String",proto:!0,forced:!r(768)("includes")},{includes:function(t){return!!~a(i(this)).indexOf(a(o(t)),arguments.length>1?arguments[1]:void 0)}})},function(t,e,r){var n=r(1584);t.exports=n},function(t,e,r){var n=r(1585);t.exports=n},function(t,e,r){r(1025),r(1586);var n=r(535);t.exports=n.Array.from},function(t,e,r){var n=r(299),o=r(1587);n({target:"Array",stat:!0,forced:!r(1592)(function(t){Array.from(t)})},{from:o})},function(t,e,r){"use strict";var n=r(765),o=r(500),i=r(1588),a=r(1590),u=r(533),s=r(1015),c=r(1591);t.exports=function(t){var e,r,l,f,p,d,h=o(t),v="function"==typeof this?this:Array,y=arguments.length,m=y>1?arguments[1]:void 0,g=void 0!==m,b=c(h),w=0;if(g&&(m=n(m,y>2?arguments[2]:void 0,2)),void 0==b||v==Array&&a(b))for(r=new v(e=u(h.length));e>w;w++)d=g?m(h[w],w):h[w],s(r,w,d);else for(p=(f=b.call(h)).next,r=new v;!(l=p.call(f)).done;w++)d=g?i(f,m,[l.value,w],!0):l.value,s(r,w,d);return r.length=w,r}},function(t,e,r){var n=r(467),o=r(1589);t.exports=function(t,e,r,i){try{return i?e(n(r)[0],r[1]):e(r)}catch(e){throw o(t),e}}},function(t,e,r){var n=r(467);t.exports=function(t){var e=t.return;if(void 0!==e)return n(e.call(t)).value}},function(t,e,r){var n=r(238),o=r(601),i=n("iterator"),a=Array.prototype;t.exports=function(t){return void 0!==t&&(o.Array===t||a[i]===t)}},function(t,e,r){var n=r(1018),o=r(601),i=r(238)("iterator");t.exports=function(t){if(void 0!=t)return t[i]||t["@@iterator"]||o[n(t)]}},function(t,e,r){var n=r(238)("iterator"),o=!1;try{var i=0,a={next:function(){return{done:!!i++}},return:function(){o=!0}};a[n]=function(){return this},Array.from(a,function(){throw 2})}catch(t){}t.exports=function(t,e){if(!e&&!o)return!1;var r=!1;try{var i={};i[n]=function(){return{next:function(){return{done:r=!0}}}},t(i)}catch(t){}return r}},function(t,e,r){var n=r(1594);t.exports=n},function(t,e,r){var n=r(1595);t.exports=n},function(t,e,r){r(1596);var n=r(602);t.exports=n("Array","find")},function(t,e,r){"use strict";var n=r(299),o=r(764).find,i=r(766),a=!0;"find"in[]&&Array(1).find(function(){a=!1}),n({target:"Array",proto:!0,forced:a},{find:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("find")},function(t,e,r){var n=r(1598);t.exports=n},function(t,e,r){var n=r(1599);t.exports=n},function(t,e,r){r(1600);var n=r(602);t.exports=n("Array","findIndex")},function(t,e,r){"use strict";var n=r(299),o=r(764).findIndex,i=r(766),a=!0;"findIndex"in[]&&Array(1).findIndex(function(){a=!1}),n({target:"Array",proto:!0,forced:a},{findIndex:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}}),i("findIndex")},function(t,e,r){(function(e,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */
!function(e,r){t.exports=r()}(0,function(){"use strict";function t(t){return"function"==typeof t}var n=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=0,i=void 0,a=void 0,u=function(t,e){h[o]=t,h[o+1]=e,2===(o+=2)&&(a?a(v):y())};var s="undefined"!=typeof window?window:void 0,c=s||{},l=c.MutationObserver||c.WebKitMutationObserver,f="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),p="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(v,1)}}var h=new Array(1e3);function v(){for(var t=0;t<o;t+=2){(0,h[t])(h[t+1]),h[t]=void 0,h[t+1]=void 0}o=0}var y=void 0;function m(t,e){var r=this,n=new this.constructor(w);void 0===n[b]&&M(n);var o=r._state;if(o){var i=arguments[o-1];u(function(){return I(o,n,i,r._result)})}else k(r,n,t,e);return n}function g(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(w);return S(e,t),e}y=f?function(){return e.nextTick(v)}:l?function(){var t=0,e=new l(v),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}():p?function(){var t=new MessageChannel;return t.port1.onmessage=v,function(){return t.port2.postMessage(0)}}():void 0===s?function(){try{var t=Function("return this")().require("vertx");return void 0!==(i=t.runOnLoop||t.runOnContext)?function(){i(v)}:d()}catch(t){return d()}}():d();var b=Math.random().toString(36).substring(2);function w(){}var _=void 0,O=1,x=2;function C(e,r,n){r.constructor===e.constructor&&n===m&&r.constructor.resolve===g?function(t,e){e._state===O?E(t,e._result):e._state===x?A(t,e._result):k(e,void 0,function(e){return S(t,e)},function(e){return A(t,e)})}(e,r):void 0===n?E(e,r):t(n)?function(t,e,r){u(function(t){var n=!1,o=function(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}(r,e,function(r){n||(n=!0,e!==r?S(t,r):E(t,r))},function(e){n||(n=!0,A(t,e))},t._label);!n&&o&&(n=!0,A(t,o))},t)}(e,r,n):E(e,r)}function S(t,e){if(t===e)A(t,new TypeError("You cannot resolve a promise with itself"));else if(function(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}(e)){var r=void 0;try{r=e.then}catch(e){return void A(t,e)}C(t,e,r)}else E(t,e)}function j(t){t._onerror&&t._onerror(t._result),T(t)}function E(t,e){t._state===_&&(t._result=e,t._state=O,0!==t._subscribers.length&&u(T,t))}function A(t,e){t._state===_&&(t._state=x,t._result=e,u(j,t))}function k(t,e,r,n){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+O]=r,o[i+x]=n,0===i&&t._state&&u(T,t)}function T(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var n=void 0,o=void 0,i=t._result,a=0;a<e.length;a+=3)n=e[a],o=e[a+r],n?I(r,n,o,i):o(i);t._subscribers.length=0}}function I(e,r,n,o){var i=t(n),a=void 0,u=void 0,s=!0;if(i){try{a=n(o)}catch(t){s=!1,u=t}if(r===a)return void A(r,new TypeError("A promises callback cannot return that same promise."))}else a=o;r._state!==_||(i&&s?S(r,a):!1===s?A(r,u):e===O?E(r,a):e===x&&A(r,a))}var P=0;function M(t){t[b]=P++,t._state=void 0,t._result=void 0,t._subscribers=[]}var F=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(w),this.promise[b]||M(this.promise),n(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?E(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&E(this.promise,this._result))):A(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===_&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,n=r.resolve;if(n===g){var o=void 0,i=void 0,a=!1;try{o=t.then}catch(t){a=!0,i=t}if(o===m&&t._state!==_)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(r===D){var u=new r(w);a?A(u,i):C(u,t,o),this._willSettleAt(u,e)}else this._willSettleAt(new r(function(e){return e(t)}),e)}else this._willSettleAt(n(t),e)},t.prototype._settledAt=function(t,e,r){var n=this.promise;n._state===_&&(this._remaining--,t===x?A(n,r):this._result[e]=r),0===this._remaining&&E(n,this._result)},t.prototype._willSettleAt=function(t,e){var r=this;k(t,void 0,function(t){return r._settledAt(O,e,t)},function(t){return r._settledAt(x,e,t)})},t}();var D=function(){function e(t){this[b]=P++,this._result=this._state=void 0,this._subscribers=[],w!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e(function(e){S(t,e)},function(e){A(t,e)})}catch(e){A(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var r=this.constructor;return t(e)?this.then(function(t){return r.resolve(e()).then(function(){return t})},function(t){return r.resolve(e()).then(function(){throw t})}):this.then(e,e)},e}();return D.prototype.then=m,D.all=function(t){return new F(this,t).promise},D.race=function(t){var e=this;return n(t)?new e(function(r,n){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(r,n)}):new e(function(t,e){return e(new TypeError("You must pass an array to race."))})},D.resolve=g,D.reject=function(t){var e=new this(w);return A(e,t),e},D._setScheduler=function(t){a=t},D._setAsap=function(t){u=t},D._asap=u,D.polyfill=function(){var t=void 0;if(void 0!==r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=D},D.Promise=D,D})}).call(e,r(170),r(26))},function(t,e,r){"use strict";var n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var o=r(178),i=r(673),a=o.getS18n("lizard-service-form"),u=n(r(1605));a.addLocaleResource("ja-JP",u),a.setLocaleSync(i.locale)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertNever=function(t){throw new Error("unexpected type: "+JSON.stringify(t))}},function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(1027);e.interweave=function(t,e){return t.map(function(r,n){return n===t.length-1?r:""+r+e[n]}).join("")},e.getTextResult=function(t,e){return e&&e[t]};var i=/%(s|\d)/g;e.getInterpolateResult=function(t,e,r){try{if(!r)return;var a=o.sourceTextToKey({type:"interpolated",textParts:t}),u=r[a];if(!u)return;var s={},c=0;a.replace(i,function(t){return s[t]=e[c],c+=1,t});return"string"==typeof u?function(t,e){return t.replace(i,function(r){return null!==e[r]?String(e[r]):(console.warn("[s18n] interpolation failed:",{str:t,valueMap:e}),r)})}(u,s):"object"===(void 0===u?"undefined":n(u))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(u))}catch(n){var l={parts:t,values:e,resource:r};return console.error("[s18n] error when translating: ",l),void console.error(n)}}},function(t,e){t.exports={"填写时间":"提交時間","填写人":"直接入力","未命名问题":"質問の名前","数据来源":"データソース","找不到指定的表单工作表":"指定されたワークシートが見つかりません。",'后缀只能由 数字/字母/"-" 组成，长度 1~15':'サフィックスは数字/文字/ "-"、長さ1〜15のみで構成できます',"未命名表单":"フォーム名","地址":"住所","日期":"日付","下拉列表":"ドロップダウンリスト","列表":"リスト","请填写'其他'项内容":"「その他」の項目を記入してください。","选项%s":"オプション%s","邮箱":"E-mail","邮箱格式不正确":"メールボックスの形式が正しくありません","图片收集":"画像収集","图片":"画像","限定的选项数设置有误":"修飾されたオプションの数が正しく設定されていません。","选择 %s 项":"%sアイテムを選択してください","最少选择 %1 项，最多选择 %2 项":"少なくとも%1アイテムを選択し、最大で%2アイテムを選択してください","选择 %1 - %2 项":"%1-%2アイテムを選択してください","最少选择 %s 项":"少なくとも%s個のアイテムを選択してください","最多选择 %s 项":"最大%s個のアイテムを選択してください","多选":"複数選択","多行文本":"複数行のテキスト","多行":"複数行","姓名":"名前","数字":"数","电话":"電話","号码格式不正确":"数値の形式が正しくありません。","其他":"その他","评分":"スコア","单选":"ラジオ","单行文本":"一行のテキスト","单行":"一行","时间":"時間","缺少必要的信息":"必要な項目が不足しています","问题项不存在":"設問がありません","问题项必须为 单选/多选/下拉 类型":"設問項目はラジオボタン/複数選択/プルダウンでなければなりません","选项不存在":"オプションが存在しません","要显示的问题不存在":"表示する設問が存在しません","要显示的问题项须在触发问题项后面":"表示される設問は、元となる設問の後になければなりません","要显示的问题项已被其他规则指定":"表示する設問は別のルールで指定されています"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1028),o=r(1033),i=r(1034);e.formEntryToChangeset=function(t){var e=t.content,r=t.formEntry,a=(t.userId,t.fileType);if(a=a||"richdoc","submit_entry_v2"===r.action){var u=r.payload,s=u.form,c=u.formGuid,l=u.submission;u.userId;return n.createChangeForSubmitForm({spread:e,fileType:a,form:s,formGuid:c,submission:l,time:new Date})}if("submit_entry_batch_v2"===r.action){var f=r.payload;s=f.form,c=f.formGuid,l=f.submission,f.userId;return n.createChangeForSubmitForm({spread:e,fileType:a,form:s,formGuid:c,submission:l,time:new Date})}if("update_form_v2"===r.action){var p=r.payload,d=(s=p.form,c=p.formGuid,p.userId);return o.createChangeForUpdateForm({spread:e,fileType:a,form:s,formGuid:c,userId:d})}if("unlink_form_v2"===r.action){var h=r.payload,v=(c=h.formGuid,h.userId);return i.createChangeForUnlinkForm({spread:e,fileType:a,formGuid:c,userId:v})}throw new Error("unexpected formEntry: "+JSON.stringify(r))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){var n;r.d(e,"Immer",function(){return V}),r.d(e,"applyPatches",function(){return W}),r.d(e,"createDraft",function(){return Q}),r.d(e,"finishDraft",function(){return K}),r.d(e,"immerable",function(){return i}),r.d(e,"isDraft",function(){return u}),r.d(e,"isDraftable",function(){return s}),r.d(e,"nothing",function(){return o}),r.d(e,"original",function(){return c}),r.d(e,"produce",function(){return $}),r.d(e,"produceWithPatches",function(){return H}),r.d(e,"setAutoFreeze",function(){return Y}),r.d(e,"setUseProxies",function(){return J});var o="undefined"!=typeof Symbol?Symbol("immer-nothing"):((n={})["immer-nothing"]=!0,n),i="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("immer-draftable"):"__$immer_draftable",a="undefined"!=typeof Symbol&&Symbol.for?Symbol.for("immer-state"):"__$immer_state";function u(t){return!!t&&!!t[a]}function s(t){return!!t&&(function(t){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t))return!0;var e=Object.getPrototypeOf(t);return!e||e===Object.prototype}(t)||!!t[i]||!!t.constructor[i])}function c(t){if(t&&t[a])return t[a].base}var l=Object.assign||function(t,e){for(var r in e)v(e,r)&&(t[r]=e[r]);return t},f="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames;function p(t,e){if(void 0===e&&(e=!1),Array.isArray(t))return t.slice();var r=Object.create(Object.getPrototypeOf(t));return f(t).forEach(function(n){if(n!==a){var o=Object.getOwnPropertyDescriptor(t,n),i=o.value;if(o.get){if(!e)throw new Error("Immer drafts cannot have computed properties");i=o.get.call(t)}o.enumerable?r[n]=i:Object.defineProperty(r,n,{value:i,writable:!0,configurable:!0})}}),r}function d(t,e){if(Array.isArray(t))for(var r=0;r<t.length;r++)e(r,t[r],t);else f(t).forEach(function(r){return e(r,t[r],t)})}function h(t,e){var r=Object.getOwnPropertyDescriptor(t,e);return!!r&&r.enumerable}function v(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function y(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}function m(t){if(!s(t))return t;if(Array.isArray(t))return t.map(m);var e=Object.create(Object.getPrototypeOf(t));for(var r in t)e[r]=m(t[r]);return e}var g=function(t){this.drafts=[],this.parent=t,this.canAutoFreeze=!0,this.patches=null};function b(t){t[a].revoke()}g.prototype.usePatches=function(t){t&&(this.patches=[],this.inversePatches=[],this.patchListener=t)},g.prototype.revoke=function(){this.leave(),this.drafts.forEach(b),this.drafts=null},g.prototype.leave=function(){this===g.current&&(g.current=this.parent)},g.current=null,g.enter=function(){return this.current=new g(this.current)};var w={};function _(t,e){var r=Array.isArray(t),n=E(t);d(n,function(e){!function(t,e,r){var n=w[e];n?n.enumerable=r:w[e]=n={configurable:!0,enumerable:r,get:function(){return function(t,e){A(t);var r=C(x(t),e);if(t.finalizing)return r;if(r===C(t.base,e)&&s(r))return j(t),t.copy[e]=_(r,t);return r}(this[a],e)},set:function(t){!function(t,e,r){if(A(t),t.assigned[e]=!0,!t.modified){if(y(r,C(x(t),e)))return;S(t),j(t)}t.copy[e]=r}(this[a],e,t)}};Object.defineProperty(t,e,n)}(n,e,r||h(t,e))});var o=e?e.scope:g.current;return function(t,e,r){Object.defineProperty(t,e,{value:r,enumerable:!1,writable:!0})}(n,a,{scope:o,modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:e,base:t,draft:n,copy:null,revoke:O,revoked:!1}),o.drafts.push(n),n}function O(){this.revoked=!0}function x(t){return t.copy||t.base}function C(t,e){var r=t[a];if(r&&!r.finalizing){r.finalizing=!0;var n=t[e];return r.finalizing=!1,n}return t[e]}function S(t){t.modified||(t.modified=!0,t.parent&&S(t.parent))}function j(t){t.copy||(t.copy=E(t.base))}function E(t){var e=t&&t[a];if(e){e.finalizing=!0;var r=p(e.draft,!0);return e.finalizing=!1,r}return p(t)}function A(t){if(!0===t.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(x(t)))}function k(t){for(var e=t.length-1;e>=0;e--){var r=t[e][a];r.modified||(Array.isArray(r.base)?I(r)&&S(r):T(r)&&S(r))}}function T(t){for(var e=t.base,r=t.draft,n=Object.keys(r),o=n.length-1;o>=0;o--){var i=n[o],u=e[i];if(void 0===u&&!v(e,i))return!0;var s=r[i],c=s&&s[a];if(c?c.base!==u:!y(s,u))return!0}return n.length!==Object.keys(e).length}function I(t){var e=t.draft;if(e.length!==t.base.length)return!0;var r=Object.getOwnPropertyDescriptor(e,e.length-1);return!(!r||r.get)}var P=Object.freeze({willFinalize:function(t,e,r){t.drafts.forEach(function(t){t[a].finalizing=!0}),r?u(e)&&e[a].scope===t&&k(t.drafts):(t.patches&&function t(e){if(e&&"object"==typeof e){var r=e[a];if(r){var n=r.base,o=r.draft,i=r.assigned;if(Array.isArray(e)){if(I(r)){if(S(r),i.length=!0,o.length<n.length)for(var u=o.length;u<n.length;u++)i[u]=!1;else for(var s=n.length;s<o.length;s++)i[s]=!0;for(var c=0;c<o.length;c++)void 0===i[c]&&t(o[c])}}else Object.keys(o).forEach(function(e){void 0!==n[e]||v(n,e)?i[e]||t(o[e]):(i[e]=!0,S(r))}),Object.keys(n).forEach(function(t){void 0!==o[t]||v(o,t)||(i[t]=!1,S(r))})}}}(t.drafts[0]),k(t.drafts))},createProxy:_});function M(t,e){var r=e?e.scope:g.current,n={scope:r,modified:!1,finalized:!1,assigned:{},parent:e,base:t,draft:null,drafts:{},copy:null,revoke:null},o=Array.isArray(t)?Proxy.revocable([n],D):Proxy.revocable(n,F),i=o.revoke,a=o.proxy;return n.draft=a,n.revoke=i,r.drafts.push(a),a}var F={get:function(t,e){if(e===a)return t;var r=t.drafts;if(!t.modified&&v(r,e))return r[e];var n=R(t)[e];if(t.finalized||!s(n))return n;if(t.modified){if(n!==N(t.base,e))return n;r=t.copy}return r[e]=M(n,t)},has:function(t,e){return e in R(t)},ownKeys:function(t){return Reflect.ownKeys(R(t))},set:function(t,e,r){if(!t.modified){var n=N(t.base,e),o=r?y(n,r)||r===t.drafts[e]:y(n,r)&&e in t.base;if(o)return!0;L(t)}return t.assigned[e]=!0,t.copy[e]=r,!0},deleteProperty:function(t,e){void 0!==N(t.base,e)||e in t.base?(t.assigned[e]=!1,L(t)):t.assigned[e]&&delete t.assigned[e];t.copy&&delete t.copy[e];return!0},getOwnPropertyDescriptor:function(t,e){var r=R(t),n=Reflect.getOwnPropertyDescriptor(r,e);n&&(n.writable=!0,n.configurable=!Array.isArray(r)||"length"!==e);return n},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(t){return Object.getPrototypeOf(t.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},D={};function R(t){return t.copy||t.base}function N(t,e){var r=t[a],n=Reflect.getOwnPropertyDescriptor(r?R(r):t,e);return n&&n.value}function L(t){t.modified||(t.modified=!0,t.copy=l(p(t.base),t.drafts),t.drafts=null,t.parent&&L(t.parent))}d(F,function(t,e){D[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),D.deleteProperty=function(t,e){if(isNaN(parseInt(e)))throw new Error("Immer only supports deleting array indices");return F.deleteProperty.call(this,t[0],e)},D.set=function(t,e,r){if("length"!==e&&isNaN(parseInt(e)))throw new Error("Immer only supports setting array indices and the 'length' property");return F.set.call(this,t[0],e,r)};var G=Object.freeze({willFinalize:function(){},createProxy:M});function U(t,e,r,n){Array.isArray(t.base)?function(t,e,r,n){var o,i,a=t.base,u=t.copy,s=t.assigned;u.length<a.length&&(a=(o=[u,a])[0],u=o[1],r=(i=[n,r])[0],n=i[1]);var c=u.length-a.length,l=0;for(;a[l]===u[l]&&l<a.length;)++l;var f=a.length;for(;f>l&&a[f-1]===u[f+c-1];)--f;for(var p=l;p<f;++p)if(s[p]&&u[p]!==a[p]){var d=e.concat([p]);r.push({op:"replace",path:d,value:u[p]}),n.push({op:"replace",path:d,value:a[p]})}for(var h=r.length,v=f+c-1;v>=f;--v){var y=e.concat([v]);r[h+v-f]={op:"add",path:y,value:u[v]},n.push({op:"remove",path:y})}}(t,e,r,n):function(t,e,r,n){var o=t.base,i=t.copy;d(t.assigned,function(t,a){var u=o[t],s=i[t],c=a?t in o?"replace":"add":"remove";if(u!==s||"replace"!==c){var l=e.concat(t);r.push("remove"===c?{op:c,path:l}:{op:c,path:l,value:s}),n.push("add"===c?{op:"remove",path:l}:"remove"===c?{op:"add",path:l,value:u}:{op:"replace",path:l,value:u})}})}(t,e,r,n)}var z=function(t,e){for(var r=0,n=e;r<n.length;r+=1){var o=n[r],i=o.path,a=o.op,u=m(o.value);if(!i.length)throw new Error("Illegal state");for(var s=t,c=0;c<i.length-1;c++)if(!(s=s[i[c]])||"object"!=typeof s)throw new Error("Cannot apply patch, path doesn't resolve: "+i.join("/"));var l=i[i.length-1];switch(a){case"replace":s[l]=u;break;case"add":Array.isArray(s)?s.splice(l,0,u):s[l]=u;break;case"remove":Array.isArray(s)?s.splice(l,1):delete s[l];break;default:throw new Error("Unsupported patch operation: "+a)}}return t};var B={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:void 0===t&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},V=function(t){l(this,B,t),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)};V.prototype.produce=function(t,e,r){var n,i=this;if("function"==typeof t&&"function"!=typeof e){var a=e;e=t;var u=this;return function(t){var r=this;void 0===t&&(t=a);for(var n=[],o=arguments.length-1;o-- >0;)n[o]=arguments[o+1];return u.produce(t,function(t){return e.call.apply(e,[r,t].concat(n))})}}if("function"!=typeof e)throw new Error("The first or second argument to `produce` must be a function");if(void 0!==r&&"function"!=typeof r)throw new Error("The third argument to `produce` must be a function or undefined");if(s(t)){var c=g.enter(),l=this.createProxy(t),f=!0;try{n=e(l),f=!1}finally{f?c.revoke():c.leave()}return n instanceof Promise?n.then(function(t){return c.usePatches(r),i.processResult(t,c)},function(t){throw c.revoke(),t}):(c.usePatches(r),this.processResult(n,c))}return void 0===(n=e(t))?t:n!==o?n:void 0},V.prototype.produceWithPatches=function(t,e,r){var n,o,i=this;if("function"==typeof t)return function(e){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return i.produceWithPatches(e,function(e){return t.apply(void 0,[e].concat(r))})};if(r)throw new Error("A patch listener cannot be passed to produceWithPatches");return[this.produce(t,e,function(t,e){n=t,o=e}),n,o]},V.prototype.createDraft=function(t){if(!s(t))throw new Error("First argument to `createDraft` must be a plain object, an array, or an immerable object");var e=g.enter(),r=this.createProxy(t);return r[a].isManual=!0,e.leave(),r},V.prototype.finishDraft=function(t,e){var r=t&&t[a];if(!r||!r.isManual)throw new Error("First argument to `finishDraft` must be a draft returned by `createDraft`");if(r.finalized)throw new Error("The given draft is already finalized");var n=r.scope;return n.usePatches(e),this.processResult(void 0,n)},V.prototype.setAutoFreeze=function(t){this.autoFreeze=t},V.prototype.setUseProxies=function(t){this.useProxies=t,l(this,t?G:P)},V.prototype.applyPatches=function(t,e){var r;for(r=e.length-1;r>=0;r--){var n=e[r];if(0===n.path.length&&"replace"===n.op){t=n.value;break}}return u(t)?z(t,e):this.produce(t,function(t){return z(t,e.slice(r+1))})},V.prototype.processResult=function(t,e){var r=e.drafts[0],n=void 0!==t&&t!==r;if(this.willFinalize(e,t,n),n){if(r[a].modified)throw e.revoke(),new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");s(t)&&(t=this.finalize(t,null,e)),e.patches&&(e.patches.push({op:"replace",path:[],value:t}),e.inversePatches.push({op:"replace",path:[],value:r[a].base}))}else t=this.finalize(r,[],e);return e.revoke(),e.patches&&e.patchListener(e.patches,e.inversePatches),t!==o?t:void 0},V.prototype.finalize=function(t,e,r){var n=this,o=t[a];if(!o)return Object.isFrozen(t)?t:this.finalizeTree(t,null,r);if(o.scope!==r)return t;if(!o.modified)return o.base;if(!o.finalized){if(o.finalized=!0,this.finalizeTree(o.draft,e,r),this.onDelete)if(this.useProxies){var i=o.assigned;for(var u in i)i[u]||this.onDelete(o,u)}else{var s=o.base,c=o.copy;d(s,function(t){v(c,t)||n.onDelete(o,t)})}this.onCopy&&this.onCopy(o),this.autoFreeze&&r.canAutoFreeze&&Object.freeze(o.copy),e&&r.patches&&U(o,e,r.patches,r.inversePatches)}return o.copy},V.prototype.finalizeTree=function(t,e,r){var n=this,o=t[a];o&&(this.useProxies||(o.copy=p(o.draft,!0)),t=o.copy);var i=!!e&&!!r.patches,c=function(a,l,f){if(l===f)throw Error("Immer forbids circular references");var p=!!o&&f===t;if(u(l)){var v=p&&i&&!o.assigned[a]?e.concat(a):null;if(u(l=n.finalize(l,v,r))&&(r.canAutoFreeze=!1),Array.isArray(f)||h(f,a)?f[a]=l:Object.defineProperty(f,a,{value:l}),p&&l===o.base[a])return}else{if(p&&y(l,o.base[a]))return;s(l)&&!Object.isFrozen(l)&&d(l,c)}p&&n.onAssign&&n.onAssign(o,a,l)};return d(t,c),t};var q=new V,$=q.produce,H=q.produceWithPatches.bind(q),Y=q.setAutoFreeze.bind(q),J=q.setUseProxies.bind(q),W=q.applyPatches.bind(q),Q=q.createDraft.bind(q),K=q.finishDraft.bind(q);e.default=$}.call(e,r(170))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.createOperator=function(t,e,r){return{action:t,attributes:e&&function(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];void 0!==n&&(e[r]=n)}return e}(e),data:r}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parse=JSON.parse,e.stringify=JSON.stringify},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r(677)),u=r(1030);e.log=function(t){return a.default(t)},e.createLoggingDecorator=function(t,r){void 0===r&&(r=null);var n=e.log(t);return u.createDecorator({onCalled:function(t){n.apply(void 0,o(t))},onReturned:function(t){n(t)},onError:function(t){n(" <ERROR> "),console.error(t)}})},e.logObject=function(t,e){var r={},n=function(t){return r[t]||(r[t]=a.default(e+":"+t)),r[t]},i=u.decorateObject(t,{onCalled:function(t,e){n(e).apply(void 0,o(t))},onReturned:function(t,e,r){n(r)(t)},onError:function(t,e,r){n(r)(" <ERROR> "),console.error(t)}});if("undefined"!=typeof window){var s=window;s.logged||(s.logged={}),s.logged[e]=t}return i}},function(t,e,r){"use strict";var n=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):new r(function(e){e(t.value)}).then(a,u)}s((n=n.apply(t,e||[])).next())})},o=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var a=i(r(303));e.ajax={request:function(t,e){var r=e.method,i=e.data,u=e.extract,s=void 0===u?function(t){return t.data}:u;return n(this,void 0,void 0,function(){var e;return o(this,function(n){switch(n.label){case 0:return"get"!==r.toLowerCase()?[3,2]:[4,a.default.request({url:t,method:r,params:i})];case 1:return e=n.sent(),[2,s(e)];case 2:return[4,a.default.request({url:t,method:r,data:i})];case 3:return e=n.sent(),[2,s(e)]}})})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(1613);e.isDeepEqual=function(t,r,o){var i=(void 0===o?{ignoreEmptyKey:!1}:o).ignoreEmptyKey;if(t===r)return!0;var a=n.type(t);if(a!==n.type(r))return!1;if("array"===a)return t.length===r.length&&t.every(function(t,n){return e.isDeepEqual(t,r[n],{ignoreEmptyKey:i})});if(t instanceof Date&&r instanceof Date)return t.getTime()===r.getTime();if("object"===a){var u=Object.keys(t).sort().filter(function(e){return!(void 0===t[e]&&i)}),s=Object.keys(r).sort().filter(function(t){return!(void 0===r[t]&&i)});return u.length===s.length&&u.every(function(n,o){var a=s[o];return n===a&&e.isDeepEqual(t[n],r[a],{ignoreEmptyKey:i})})}return!("number"!=typeof t||!isNaN(t))||t===r}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.type=function(t){return null===t?"null":void 0===t?"undefined":Array.isArray(t)?"array":typeof t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form");e.text={type:"text",typeName:n("单行文本"),shortTypeName:n("单行"),tableViewMode:!0,initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,e){},isFilled:function(t,e){return Boolean(e&&e.content.trim().length>0)},getResponseText:function(t,e){return null==e?"":e.content.trim()},acceptTypes:{multiple_text:function(t){var r=t,n=r.subject;return{type:"text",required:r.required,guid:r.guid,subject:n,question:e.text.initQuestion(),response:e.text.initResponse()}}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form"),o="multiple_text";e.multipleText={type:o,typeName:n("多行文本"),shortTypeName:n("多行"),tableViewMode:!0,initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,e){},isFilled:function(t,e){return Boolean(e&&e.content.trim().length>0)},getResponseText:function(t,e){return null==e?"":e.content.trim()},acceptTypes:{text:function(t){var r=t,n=r.subject,i=r.required,a=r.guid,u=e.multipleText.initQuestion(),s=e.multipleText.initResponse();return{type:o,required:i,guid:a,subject:n,question:u,response:s}}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form");e.address={type:"address",typeName:n("地址"),shortTypeName:n("地址"),tableViewMode:!1,initQuestion:function(){return{}},initResponse:function(){return{province:void 0,city:void 0,district:void 0,detail:""}},verify:function(t,e){},isFilled:function(t,e){return Boolean(e&&e.province&&e.detail)},getResponseText:function(t,e){if(!e)return"";var r=e.province,n=e.city,o=e.district,i=e.detail;return(r?r.name:"")+" "+(n?n.name:"")+" "+(o?o.name:"")+" "+i},acceptTypes:{}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form"),o=r(279),i=r(1031);e.date={type:"date",typeName:n("日期"),shortTypeName:n("日期"),tableViewMode:!0,initQuestion:function(){return{format:"YMD"}},initResponse:function(){return{format:"YMD",date:void 0}},verify:function(t,e){},isFilled:function(t,e){return Boolean(e&&void 0!==e.date)},getResponseText:function(t,e,r){var n=r.exportSpread;if(!e)return"";var a=e.date;if(!a)return"";var u=(new Date).getTimezoneOffset()/-60;n&&(a=new Date(a.getTime()+60*(8-u)*60*1e3));var s=t.format;switch(s){case"YMD":return i.formatTime(a,"YYYY/MM/DD");case"YM":return i.formatTime(a,"YYYY/MM");case"YMDmh":return i.formatTime(a,"YYYY/MM/DD hh:mm");default:return o.assertNever(s)}},acceptTypes:{}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form");e.name={type:"name",typeName:n("姓名"),shortTypeName:n("姓名"),tableViewMode:!0,initSubject:function(){return n("姓名")},initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,e){},isFilled:function(t,e){return Boolean(e&&e.content.trim().length>0)},getResponseText:function(t,e){return null==e?"":e.content.trim()},acceptTypes:{}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form");e.email={type:"email",typeName:n("邮箱"),shortTypeName:n("邮箱"),tableViewMode:!0,initSubject:function(){return n("邮箱")},initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,e){if(e.content&&!/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.content))return{reason:n("邮箱格式不正确")}},isFilled:function(t,e){return Boolean(e&&e.content.trim().length>0)},getResponseText:function(t,e){return null==e?"":e.content.trim()},acceptTypes:{}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form");e.phone={type:"phone",typeName:n("电话"),shortTypeName:n("电话"),tableViewMode:!0,initSubject:function(){return n("电话")},initQuestion:function(){return{}},initResponse:function(){return{content:""}},verify:function(t,e){if(e.content&&!/^[0-9-+()]+$/.test(e.content))return{reason:n("号码格式不正确")}},isFilled:function(t,e){return Boolean(e&&e.content.trim().length>0)},getResponseText:function(t,e){return null==e?"":e.content.trim()},acceptTypes:{}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form");e.rate={type:"rate",typeName:n("评分"),shortTypeName:n("评分"),tableViewMode:!1,initQuestion:function(){return{shape:"star",sum:5}},initResponse:function(){return{shape:"star",sum:5,value:0}},verify:function(t,e){},isFilled:function(t,e){return Boolean(e&&e.value>0)},acceptTypes:{},getResponseText:function(t,e){if(!e)return"";return String(5===t.sum?e.value/2:e.value)}}},function(t,e,r){"use strict";var n=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t};Object.defineProperty(e,"__esModule",{value:!0});var o,i,a=r(178).getS18n("lizard-service-form"),u=r(772),s=r(676),c=r(606),l="dropdown_list";e.dropdownList={type:l,typeName:a("下拉列表"),shortTypeName:a("列表"),tableViewMode:!0,acceptTypes:{single_choice:function(t){var r=t,n=r.subject,o=r.required,i=r.question,a=r.guid,u=e.dropdownList.initResponse(),s=i.options;return{type:l,required:o,guid:a,subject:n,question:{options:s},response:u}},multiple_choice:function(t){var r=t,n=r.subject,o=r.required,i=r.question,a=r.guid,u=e.dropdownList.initResponse(),s=i.options;return{type:l,required:o,guid:a,subject:n,question:{options:s},response:u}}},initQuestion:function(){return{options:[{type:"normal",value:s.generateId(5),label:""}]}},initResponse:function(){return{choice:void 0}},verify:function(t,e){if(t.options.some(function(t){return"other"===t.type})){var r=t.options.find(function(t){return"other"===t.type});if(r&&"other"===r.type&&r.required&&e&&e.choice&&"other"===e.choice.type&&!e.choice.value)return{reason:a(o||(o=n(["请填写'其他'项内容"],["请填写'其他'项内容"])))}}},isFilled:function(t,e){return Boolean(e&&null!=e.choice)},fillWithDefaultQuestion:function(t){return c.produce(t,function(t){t&&t.options.length>0&&t.options.map(function(t,e){"normal"===t.type&&""===t.label.trim()&&(t.label=a(i||(i=n(["选项",""],["选项",""])),e+1))})})},getResponseText:function(t,e){return u.getChoiceResponseText(t,e)}}},function(t,e,r){"use strict";var n=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t};Object.defineProperty(e,"__esModule",{value:!0});var o,i,a,u,s,c,l,f=r(178).getS18n("lizard-service-form"),p=r(676),d=r(606),h=r(772),v="multiple_choice";e.getCountLimit=function(t){var e=t.options,r=t.limitCount,n=t.minCount,o=t.maxCount,i=e.length;if(r){var a=null==n?void 0:Math.max(1,Math.round(n)),u=null==o?void 0:Math.max(1,Math.round(o));if((null!=a||null!=u)&&!(null!=a&&null!=u&&a>u||null!=a&&a>i))return{min:a,max:u}}},e.getLimitSettingHint=function(t){var e=t.question,r=e.options,n=e.minCount,o=e.maxCount;return e.limitCount?null!=n&&null!=o&&n>o?f("限定的选项数设置有误"):null!=n&&n>r.length?f("限定的选项数设置有误"):"":""},e.getCountLimitHint=function(t,e){void 0===e&&(e=!1);var r=t.min,c=t.max,l="";return null!=r&&null!=c?l=r===c?f(o||(o=n(["选择 "," 项"],["选择 "," 项"])),r):f(e?i||(i=n(["最少选择 "," 项，最多选择 "," 项"],["最少选择 "," 项，最多选择 "," 项"])):a||(a=n(["选择 "," - "," 项"],["选择 "," - "," 项"])),r,c):null!=r?l=f(u||(u=n(["最少选择 "," 项"],["最少选择 "," 项"])),r):null!=c&&(l=f(s||(s=n(["最多选择 "," 项"],["最多选择 "," 项"])),c)),l},e.multipleChoice={type:v,typeName:f("多选"),shortTypeName:f("多选"),tableViewMode:!0,acceptTypes:{single_choice:function(t){var r=t,n=r.subject,o=r.required,i=r.question,a=r.guid,u=e.multipleChoice.initResponse(),s=i.options;return{type:v,required:o,guid:a,subject:n,question:{options:s},response:u}},dropdown_list:function(t){var r=t,n=r.subject,o=r.required,i=r.question,a=r.guid,u=e.multipleChoice.initResponse(),s=i.options;return{type:v,required:o,guid:a,subject:n,question:{options:s},response:u}}},initQuestion:function(){return{options:[{type:"normal",value:p.generateId(5),label:""}],limitCount:!1}},initResponse:function(){return{choices:[]}},verify:function(t,r){if(t.options.some(function(t){return"other"===t.type})){var o=t.options.find(function(t){return"other"===t.type});if(o&&"other"===o.type&&o.required){var i=r.choices.find(function(t){return"other"===t.type});if(i&&"other"===i.type&&!i.value)return{reason:f(c||(c=n(["请填写'其他'项内容"],["请填写'其他'项内容"])))}}}var a=e.getCountLimit(t);if(a){var u=a.min,s=a.max,l=r.choices.length;if(null!=u&&l<u||null!=s&&l>s)return{reason:e.getCountLimitHint(a,!0)}}},isFilled:function(t,e){return Boolean(e&&e.choices.length>0)},fillWithDefaultQuestion:function(t){return d.produce(t,function(t){t&&t.options.length>0&&t.options.map(function(t,e){"normal"===t.type&&""===t.label.trim()&&(t.label=f(l||(l=n(["选项",""],["选项",""])),e+1))})})},getResponseText:function(t,e){return h.getChoiceResponseText(t,e)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form");e.number={type:"number",typeName:n("数字"),shortTypeName:n("数字"),tableViewMode:!0,initQuestion:function(){return{}},initResponse:function(){return{number:void 0}},verify:function(t,e){},isFilled:function(t,e){return Boolean(e&&void 0!==e.number)},getResponseText:function(t,e){if(!e)return"";var r=e.number;return String(r)},acceptTypes:{}}},function(t,e,r){"use strict";var n=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t};Object.defineProperty(e,"__esModule",{value:!0});var o,i,a=r(178).getS18n("lizard-service-form"),u=r(676),s=r(606),c=r(772),l="single_choice";e.singleChoice={type:l,typeName:a("单选"),shortTypeName:a("单选"),tableViewMode:!1,acceptTypes:{multiple_choice:function(t){var r=t,n=r.subject,o=r.required,i=r.question,a=r.guid,u=e.singleChoice.initResponse(),s=i.options;return{type:l,required:o,guid:a,subject:n,question:{options:s},response:u}},dropdown_list:function(t){var r=t,n=r.subject,o=r.required,i=r.question,a=r.guid,u=e.singleChoice.initResponse(),s=i.options;return{type:l,required:o,guid:a,subject:n,question:{options:s},response:u}}},initQuestion:function(){return{options:[{type:"normal",value:u.generateId(5),label:""}]}},initResponse:function(){return{choice:void 0}},verify:function(t,e){if(t.options.some(function(t){return"other"===t.type})){var r=t.options.find(function(t){return"other"===t.type});if(r&&"other"===r.type&&r.required&&e&&e.choice&&"other"===e.choice.type&&!e.choice.value)return{reason:a(o||(o=n(["请填写'其他'项内容"],["请填写'其他'项内容"])))}}},isFilled:function(t,e){return Boolean(e&&null!=e.choice)},fillWithDefaultQuestion:function(t){return s.produce(t,function(t){t&&t.options.length>0&&t.options.map(function(t,e){"normal"===t.type&&""===t.label.trim()&&(t.label=a(i||(i=n(["选项",""],["选项",""])),e+1))})})},getResponseText:function(t,e){return c.getChoiceResponseText(t,e)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form"),o=r(279),i=r(1031);e.time={type:"time",typeName:n("时间"),shortTypeName:n("时间"),tableViewMode:!0,initQuestion:function(){return{format:"hms"}},initResponse:function(){return{format:"hms",time:void 0}},verify:function(t,e){},isFilled:function(t,e){return Boolean(e&&void 0!==e.time)},getResponseText:function(t,e,r){var n=r.exportSpread;if(!e)return"";var a=e.time;if(!a)return"";var u=(new Date).getTimezoneOffset()/-60;n&&(a=new Date(a.getTime()+60*(8-u)*60*1e3));var s=t.format;switch(s){case"hms":return i.formatTime(a,"hh:mm:ss");case"hm":return i.formatTime(a,"hh:mm");default:return o.assertNever(s)}},acceptTypes:{}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(178).getS18n("lizard-service-form");e.image={type:"image",typeName:n("图片收集"),shortTypeName:n("图片"),tableViewMode:!0,initQuestion:function(){return{}},initResponse:function(){return{image:void 0}},verify:function(t,e){},isFilled:function(t,e){return Boolean(e&&e.image)},getResponseText:function(t,e){return e&&e.image?""+e.image.url:""},acceptTypes:{}}},function(t,e,r){(function(t){var n=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),r={},n=0;n<e.length;n++)r[e[n]]=Object.getOwnPropertyDescriptor(t,e[n]);return r},o=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(u(arguments[r]));return e.join(" ")}r=1;for(var n=arguments,i=n.length,a=String(t).replace(o,function(t){if("%%"===t)return"%";if(r>=i)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}}),s=n[r];r<i;s=n[++r])v(s)||!w(s)?a+=" "+s:a+=" "+u(s);return a},e.deprecate=function(r,n){if(void 0!==t&&!0===t.noDeprecation)return r;if(void 0===t)return function(){return e.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(t.throwDeprecation)throw new Error(n);t.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var i,a={};function u(t,r){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),h(r)?n.showHidden=r:r&&e._extend(n,r),g(n.showHidden)&&(n.showHidden=!1),g(n.depth)&&(n.depth=2),g(n.colors)&&(n.colors=!1),g(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=s),l(n,t,n.depth)}function s(t,e){var r=u.styles[e];return r?"["+u.colors[r][0]+"m"+t+"["+u.colors[r][1]+"m":t}function c(t,e){return t}function l(t,r,n){if(t.customInspect&&r&&x(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,t);return m(o)||(o=l(t,o,n)),o}var i=function(t,e){if(g(e))return t.stylize("undefined","undefined");if(m(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(y(e))return t.stylize(""+e,"number");if(h(e))return t.stylize(""+e,"boolean");if(v(e))return t.stylize("null","null")}(t,r);if(i)return i;var a=Object.keys(r),u=function(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(r)),O(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(r);if(0===a.length){if(x(r)){var s=r.name?": "+r.name:"";return t.stylize("[Function"+s+"]","special")}if(b(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(_(r))return t.stylize(Date.prototype.toString.call(r),"date");if(O(r))return f(r)}var c,w="",C=!1,S=["{","}"];(d(r)&&(C=!0,S=["[","]"]),x(r))&&(w=" [Function"+(r.name?": "+r.name:"")+"]");return b(r)&&(w=" "+RegExp.prototype.toString.call(r)),_(r)&&(w=" "+Date.prototype.toUTCString.call(r)),O(r)&&(w=" "+f(r)),0!==a.length||C&&0!=r.length?n<0?b(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),c=C?function(t,e,r,n,o){for(var i=[],a=0,u=e.length;a<u;++a)E(e,String(a))?i.push(p(t,e,r,n,String(a),!0)):i.push("");return o.forEach(function(o){o.match(/^\d+$/)||i.push(p(t,e,r,n,o,!0))}),i}(t,r,n,u,a):a.map(function(e){return p(t,r,n,u,e,C)}),t.seen.pop(),function(t,e,r){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(c,w,S)):S[0]+w+S[1]}function f(t){return"["+Error.prototype.toString.call(t)+"]"}function p(t,e,r,n,o,i){var a,u,s;if((s=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?u=s.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):s.set&&(u=t.stylize("[Setter]","special")),E(n,o)||(a="["+o+"]"),u||(t.seen.indexOf(s.value)<0?(u=v(r)?l(t,s.value,null):l(t,s.value,r-1)).indexOf("\n")>-1&&(u=i?u.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+u.split("\n").map(function(t){return"   "+t}).join("\n")):u=t.stylize("[Circular]","special")),g(a)){if(i&&o.match(/^\d+$/))return u;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+u}function d(t){return Array.isArray(t)}function h(t){return"boolean"==typeof t}function v(t){return null===t}function y(t){return"number"==typeof t}function m(t){return"string"==typeof t}function g(t){return void 0===t}function b(t){return w(t)&&"[object RegExp]"===C(t)}function w(t){return"object"==typeof t&&null!==t}function _(t){return w(t)&&"[object Date]"===C(t)}function O(t){return w(t)&&("[object Error]"===C(t)||t instanceof Error)}function x(t){return"function"==typeof t}function C(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(r){if(g(i)&&(i=Object({NODE_ENV:"production",HOST:"shimodev_com",VERSION:"sdk-1.5[8e9bbfa8c]",BRANCH:"sdk-1.5",COMMIT:"8e9bbfa8c",GC_VERSION:"8e9bbfa8c",SDK:!0}).NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(i)){var n=t.pid;a[r]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",r,n,t)}}else a[r]=function(){};return a[r]},e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=h,e.isNull=v,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=g,e.isRegExp=b,e.isObject=w,e.isDate=_,e.isError=O,e.isFunction=x,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(1629);var j=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function E(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",function(){var t=new Date,e=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":");return[t.getDate(),j[t.getMonth()],e].join(" ")}(),e.format.apply(e,arguments))},e.inherits=r(1630),e._extend=function(t,e){if(!e||!w(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t};var A="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function k(t,e){if(!t){var r=new Error("Promise was rejected with a falsy value");r.reason=t,t=r}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(A&&t[A]){var e;if("function"!=typeof(e=t[A]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,A,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,r,n=new Promise(function(t,n){e=t,r=n}),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push(function(t,n){t?r(t):e(n)});try{t.apply(this,o)}catch(t){r(t)}return n}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),A&&Object.defineProperty(e,A,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,n(t))},e.promisify.custom=A,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};e.apply(this,r).then(function(e){t.nextTick(a,null,e)},function(e){t.nextTick(k,e,a)})}return Object.setPrototypeOf(r,Object.getPrototypeOf(e)),Object.defineProperties(r,n(e)),r}}).call(e,r(170))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var i=r(178).getS18n("lizard-service-form"),a=o(r(309)),u=o(r(262)),s=r(603),c=r(604),l=function(t){return t.map(function(t){return"number"==typeof t.data?t.data:1}).reduce(function(t,e){return t+e},0)};e.ensureChannelColumnModoc=function(t,e,r){var o=s.getModocOperators(t),u=o.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===e});if(-1===u)throw new Error(i("找不到指定的表单工作表"));var c=o[u],f=n(c.getParsedData(),2),p=(f[0],f[1].toJSON()),d=p.map(function(t){return(t.attributes||{}).formItemGuid});if(!d.some(function(t){return t===s.CHANNEL})){var h=d.findIndex(function(t){return t===s.CREATE_BY});h<0&&(h=d.findIndex(function(t){return t===s.CREATE_AT}));var v=-1===h?0:l(p.slice(0,h+1)),y=v?{action:"retain",attributes:{},data:v}:void 0,m={action:"insert",attributes:{formItemGuid:s.CHANNEL},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:r,authorId:r,background:"#41464b",format:"@",cellValue:i("数据来源")},data:1}]}},g=0===u?void 0:{action:"retain",attributes:{},data:u},b={action:"retain",attributes:{userId:r,authorId:r},data:{table:{cols:y?[y,m]:[m]}}},w=g?[g,b]:[b];return new a.Delta(w)}},e.ensureChannelColumnRichdoc=function(t,e,r){var n,o=t.ops,a=o.map(function(t){return t.getAttributes()||{}}).findIndex(function(t){return t.formGuid===e});if(-1===a)throw new Error(i("找不到指定的表单工作表"));var f=o[a].data,p=f.cols,d=(f.rows,p.ops),h=d.map(function(t){return(t.getAttributes()||{}).formItemGuid});if(!h.some(function(t){return t===s.CHANNEL})){var v=h.findIndex(function(t){return t===s.CREATE_BY});v<0&&(v=h.findIndex(function(t){return t===s.CREATE_AT}));var y=-1===v?0:l(d.slice(0,v+1)),m=y?new u.Operator({action:"retain",attributes:{},data:y}):void 0,g=((n={})[c.toCellName(0,y)]=new u.CellOperator(s.createTextCellOp(i("数据来源"),r,{color:"#ffffff",background:"#41464b",format:"@"})),n),b=new u.Operator({action:"insert",attributes:{formItemGuid:s.CHANNEL},data:1}),w=m?[m,b]:[b],_=0===a?void 0:new u.TableOperator({action:"retain",attributes:{},data:a}),O=new u.TableOperator({action:"retain",attributes:{userId:r,authorId:r},data:{cols:new u.Delta(w),cells:g}}),x=_?[_,O]:[O];return new u.Delta(x)}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t},i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var a=r(178).getS18n("lizard-service-form"),u=r(603),s=i(r(309)),c=i(r(262)),l=r(279),f=r(279),p=r(604),d=r(605),h=r(1035);e.avoidConfict=function(t,e){if(-1===e.indexOf(t))return t;for(var r=1;-1!==e.indexOf(t+" "+r);)r++;return t+" "+r};var v=function(t){return{action:"retain",attributes:{color:"#ffffff",userId:t,authorId:t,background:"#41464b",format:"@",cellValue:a("填写时间")},data:1}},y=function(t){return{action:"retain",attributes:{color:"#ffffff",userId:t,authorId:t,background:"#41464b",format:"@",cellValue:a("填写人")},data:1}},m=function(t){return{action:"retain",attributes:{color:"#ffffff",userId:t,authorId:t,background:"#41464b",format:"@"},data:1}};e.createChangeForCreateForm=function(t){var r=t.fileType,n=t.spread,i=t.formGuid,g=t.sheetGuid,b=t.sheetTitle,w=void 0===b?d.FORM_DEFAULT_TITLE:b,_=t.userId,O=t.questions;switch(r){case"modoc":return function(t){var r=t.spread,n=t.formGuid,i=t.sheetGuid,c=t.sheetTitle,l=t.userId,p=t.questions,d=void 0===p?[]:p;f.assert(s.Delta.isDelta(r),"spread should be modoc.Delta"),f.assert("string"==typeof n,"formGuid should be string"),f.assert(l,"userId is not provided");for(var g=[],b=r.getIter();b.hasNext();)g.push(b.next());var w=g.map(function(t){return t.getAttributes()||{}}),_=w.map(function(t){return t.name||""}),O=w.map(function(t){return t.order||0}),x=Math.min.apply(Math,o(O)),C={action:"insert",attributes:{formItemGuid:u.CREATE_AT,width:135},data:{delta:[v(l)]}},S={action:"insert",attributes:{formItemGuid:u.CREATE_BY},data:{delta:[y(l)]}},j={action:"insert",data:{delta:[m(l)]}},E=o([C,S],(d||[]).map(function(t){return{action:"insert",attributes:{formItemGuid:t.guid},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:l,authorId:l,background:"#41464b",format:"@",cellValue:t.subject||a("未命名问题")},data:1}]}}}),h.arrayOf(Math.max(0,16-d.length)).map(function(){return j})),A={action:"retain",attributes:{},data:g.length},k={action:"insert",attributes:{id:i,name:e.avoidConfict(c,_),order:x-1,formGuid:n,formVersion:u.FORM_VERSION,fixedRowsTop:1,userId:l,authorId:l},data:{table:{rows:[{action:"insert",attributes:{height:30},data:1},{action:"insert",data:199}],cols:E}}};return new s.Delta([A,k]).stringify()}({spread:"string"==typeof n?new s.Delta(n):n,formGuid:i,questions:O,sheetGuid:g,sheetTitle:w,userId:_});case"richdoc":return function(t){var r=t.spread,n=t.formGuid,i=t.sheetGuid,a=t.sheetTitle,s=t.userId,l=t.questions,d=void 0===l?[]:l;f.assert(Array.isArray(r&&r.ops),"spread should be richdoc.Delta"),f.assert("string"==typeof n,"formGuid should be string"),f.assert(s,"userId is not provided");for(var g=[],b=r.getIter();b.hasNext();)g.push(b.next());var w=g.map(function(t){return t.getAttributes()||{}}),_=w.map(function(t){return t.name||""}),O=w.map(function(t){return t.order||0}),x=Math.min.apply(Math,o(O)),C=new c.Operator({action:"insert",attributes:{formItemGuid:u.CREATE_AT,width:135},data:1}),S=new c.Operator({action:"insert",attributes:{formItemGuid:u.CREATE_BY},data:1}),j=new c.Operator({action:"insert",attributes:{},data:1}),E=new c.Delta(o([C,S],d.map(function(t){return new c.Operator({action:"insert",attributes:{formItemGuid:t.guid},data:1})}),h.arrayOf(Math.max(0,16-d.length)).map(function(){return j}))),A=new c.Delta([new c.Operator({action:"insert",attributes:{height:30},data:1}),new c.Operator({action:"insert",attributes:{},data:199})]),k={};h.arrayOf(Math.max(18,2+d.length)).forEach(function(t,e){var r=p.toCellName(0,e),n=d[e-2];k[r]=0===e?new c.CellOperator(v(s)):1===e?new c.CellOperator(y(s)):n?new c.CellOperator(function(t,e){return{action:"retain",attributes:{"font-size":9,wrap:"text-no-wrap",format:"@",vertical:"middle",userId:t,authorId:t,cellValue:e.subject,color:"#ffffff",background:"#41464b"},data:1}}(s,n)):new c.CellOperator(m(s))});var T=new c.TableOperator({action:"retain",attributes:{},data:O.length}),I=new c.TableOperator({action:"insert",attributes:{id:i,name:e.avoidConfict(a,_),order:x-1,formGuid:n,formVersion:u.FORM_VERSION,fixedRowsTop:1,userId:s,authorId:s},data:{rows:A,cols:E,cells:k}}),P=new c.Delta([T,I]);return c.pack(P)}({spread:"string"==typeof n?c.unpack(n):n,formGuid:i,sheetGuid:g,sheetTitle:w,userId:_,questions:O});default:return l.assertNever(r)}}},function(t,e,r){"use strict";var n=this&&this.__read||function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(t){o={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},o=this&&this.__spread||function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t};Object.defineProperty(e,"__esModule",{value:!0});var i=r(178).getS18n("lizard-service-form"),a=r(605),u=r(309),s=r(603),c=r(674),l=r(1032),f=r(1035),p=r(675);e.createChangeForCreateSpread=function(t){var e=t.form,r=t.formGuid,n=t.submissions,d=t.userId,h={};e.questions.forEach(function(t){h[t.guid]=t});var v=[{action:"insert",attributes:{height:30},data:1},{action:"insert",data:Math.max(199,n.length)}],y=n.some(function(t){return t.channel}),m=o([s.CREATE_AT,s.CREATE_BY],y?[s.CHANNEL]:[]),g=o(e.questions.map(function(t){return t.guid}),f.arrayOf(Math.max(0,18-(1+e.questions.length)))),b=o(m,g).map(function(t,r){if(!t)return{action:"insert",attributes:{},data:{delta:[{action:"retain",attributes:{color:"#ffffff",userId:d,authorId:d,background:"#41464b"},data:1}]}};var a={action:"retain",attributes:{color:"#ffffff",userId:d,authorId:d,background:"#41464b",format:"@",cellValue:t===s.CREATE_AT?i("填写时间"):t===s.CREATE_BY?i("填写人"):t===s.CHANNEL?i("数据来源"):h[t].subject||i("未命名问题")},data:1},u=n.map(p.fromServerSubmission).map(function(n){if(!n)return s.skipCellOp;if(t===s.CREATE_AT)return s.createTextCellOp(l.stringifyDate(n.createdAt),n.userId);if(t===s.CREATE_BY)return s.createTextCellOp(n.userName||"",n.userId);if(t===s.CHANNEL)return s.createTextCellOp(n.channel||"",n.userId);var o=r-m.length,i=e.questions[o],a=n.responses.find(function(t){return t.guid===i.guid&&c.isQuestionTypeCompatible(t.type,i.type)});return a?s.questionResponseToCellOp({question:i,response:a,userId:n.userId}):s.skipCellOp}),f=o([a],u);return{action:"insert",attributes:t===s.CREATE_AT?{formItemGuid:s.CREATE_AT,width:135}:t===s.CREATE_BY?{formItemGuid:s.CREATE_BY}:t===s.CHANNEL?{formItemGuid:s.CHANNEL}:{formItemGuid:t},data:{delta:f}}}),w=[{action:"insert",attributes:{id:s.DEFAULT_FORM_SHEET_ID,order:0,name:e.title||a.FORM_DEFAULT_TITLE,fixedRowsTop:1,formGuid:r,formVersion:s.FORM_VERSION,userId:d,authorId:d},data:{table:{rows:v,cols:b}}}];return new u.Delta(w).stringify()}},function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(1635),o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,u)}s((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},a={fetchFile:function(t,e){var r=(void 0===e?{}:e).contentUrl,a=void 0!==r&&r;return o(this,void 0,Promise,function(){var e,r,o;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,n.a.request("/lizard-api/files/"+t,{method:"GET",data:{collaboratorCount:!0,contentUrl:a,creator:1,updateViews:!0},headers:{"Cache-Control":"no-cache"}})];case 1:return[2,i.sent()];case 2:if(e=i.sent(),(o=(r=e)&&r.response&&r.response.data)&&(60001===o.errorCode||60002===o.errorCode||/(不存在|被删除)/.test(o.error)))return[2,void 0];throw e;case 3:return[2]}})})},fetchFileAncestors:function(t){return o(this,void 0,Promise,function(){return i(this,function(e){switch(e.label){case 0:return[4,n.a.request("/lizard-api/files/"+t+"/ancestors",{method:"GET"})];case 1:return[2,e.sent().ancestors||[]]}})})},fetchFileContent:function(t){return o(this,void 0,Promise,function(){return i(this,function(e){switch(e.label){case 0:return[4,n.a.request(t.contentUrl,{method:"GET"})];case 1:return[2,e.sent()]}})})},createFile:function(t){return o(this,void 0,Promise,function(){return i(this,function(e){switch(e.label){case 0:return[4,n.a.request("/lizard-api/files",{method:"POST",data:t})];case 1:return[2,e.sent()]}})})}}},function(t,e,r){"use strict";r.d(e,"a",function(){return u});var n=r(303),o=r.n(n),i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,u)}s((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},u={request:function(t,e){var r=e.method,n=e.data,u=e.headers,s=void 0===u?{}:u;return i(this,void 0,Promise,function(){return a(this,function(e){return"get"===r.toLowerCase()?[2,o.a.request({url:t,method:r,params:n,headers:s}).then(function(t){return t.data})]:[2,o.a.request({url:t,method:r,headers:s,data:n}).then(function(t){return t.data})]})})}}},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return u});var n,o=r(269),i=(r.n(o),r(1037)),a=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return JSON.stringify(t)};!function(t){t.Fulfilled="Fulfilled",t.Rejected="Rejected",t.Cached="Cached"}(n||(n={}));var u=function(t,e){void 0===e&&(e=a);var r={},u=Object.assign(new o.EventEmitter,{get:function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];var s=e.apply(void 0,o);if(s in r){var c=r[s];switch(c.status){case"fetching":return;case"success":return c.data;case"error":throw c.error;default:return Object(i.a)(c)}}r[s]={status:"fetching"},t.apply(void 0,o).then(function(t){r[s]={status:"success",data:t},u.emit(n.Fulfilled,t),u.emit(n.Cached)},function(t){r[s]={status:"error",error:t},u.emit(n.Rejected,t),u.emit(n.Cached)})}});return u}},function(t,e,r){"use strict";e.a=function(t){void 0===t&&(t=5);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r="",n=0;n<t;n++)r+=e.charAt(Math.floor(Math.random()*e.length));return r}},function(t,e,r){"use strict";r.d(e,"a",function(){return i});var n=JSON.parse,o=JSON.stringify,i=function(t){return n(o(t))}},function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(677),o=r.n(n),i=r(1640),a=function(t,e){var r={},n=function(t){return r[t]||(r[t]=o()(e+":"+t)),r[t]},a=Object(i.b)(t,{onCalled:function(t,e){n(e).apply(void 0,t)},onReturned:function(t,e,r){n(r)(t)},onError:function(t,e,r){n(r)(" <ERROR> "),console.error(t)}});if("undefined"!=typeof window){var u=window;u.logged||(u.logged={}),u.logged[e]=t}return a}},function(t,e,r){"use strict";e.a=i,e.b=function(t,e){for(var r in t){var o=t[r];if("constructor"!==r&&"function"==typeof o){var a=i(n(n({},e),{self:t,fnName:r}));t[r]=a(o)}}return t};var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t){return"function"==typeof(t&&t.then)};function i(t){var e=t.onCalled,r=t.onReturned,n=t.onError,i=t.fnName,a=t.self,u=void 0===a?null:a;return function(t){return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];e&&e(a,i||t.name);try{var c=t.apply(u,a);return o(c)?c.then(function(e){return r&&r(e,a,i||t.name),e},function(e){throw n&&n(e,a,i||t.name),e}):(r&&r(c,a,i||t.name),c)}catch(e){throw n&&n(e,a,i||t.name),e}}}}},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"b",function(){return a});var n=r(2),o=(r.n(n),n.sheets.track),i={menu:{create_form:"0100",share_form:"0101",unlink_form:"0102",create_form_dropdown:"0103",edit_form:"0114",publish_form:"0115"},create_dialog:{create_new:"0104",edit_draft:"0105"},form_editor:{create_form_click:"0106",create_form_success:"0107"},form_preview:{copy_link_click:"0108"},fill_page:{submit:"0109",enter:"0113"},guide:{view:"0110",dismiss:"0111",try_click:"0112"}},a=function(t){try{o(2,t)}catch(t){console.error("[form] failed to track:",t)}}},function(t,e,r){"use strict";e.a=function(t){var e,r=t.formController,n=function(){try{return/^(editor|owner)$/.test(window.cow.currentFile.role)}catch(t){return!1}},a=function(t,e){return r.canReadForm(t,e)},u=function(t){function e(e){var a=t.call(this,e)||this;return a.onCreateForm=function(){return m(a,void 0,Promise,function(){var t,e;return g(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),r.track(r.events.menu.create_form),n()?[4,r.createForm()]:(Object(i.showAlert)({title:o()("表格协作者才能创建表单"),type:"error"}),[2]);case 1:return a.sent(),[3,3];case 2:return t=a.sent(),console.error(t),e=t&&t.errmsg||o()("表单创建失败，请稍后重试"),Object(i.showAlert)({title:e,type:"error"}),[3,3];case 3:return[2]}})})},a.onCreateFormFromHeader=function(){return m(a,void 0,Promise,function(){return g(this,function(t){return r.ui.createFormPopup.show({sheetGuid:this.props.editor.spread.getActiveSheet().id}),[2]})})},a.onSelectMenuItem=function(t){var e=a.state,n=e.formGuid,o=e.formVersion,i=t.value;switch(i){case"edit":r.track(r.events.menu.edit_form),o===f.a.V2&&Object(d.b)(d.a.sheet_edit_forms),n&&r.ui.openOrFocusPage("edit",n,o);break;case"unlink":o===f.a.V2&&Object(d.b)(d.a.sheet_unlink_form),r.track(r.events.menu.unlink_form),r.ui.confirmUnlinkForm();break;case"create":Object(d.b)(d.a.create_from_sheets),r.track(r.events.menu.create_form_dropdown),a.onCreateForm();break;case"create_from_header":a.onCreateFormFromHeader();break;case"responses":o===f.a.V2&&Object(d.b)(d.a.sheet_view_response),n&&o===f.a.V2&&r.ui.openOrFocusPage("responses",n,o);break;case"copy_link":o===f.a.V2&&Object(d.b)(d.a.sheet_copy_url),a.onCopyLink();break;case"statistics":o===f.a.V2&&Object(d.b)(d.a.sheet_view_statistics),n&&o===f.a.V2&&r.ui.openOrFocusPage("statistics",n,o);break;default:Object(p.a)(i)}t.trackId&&b(2,t.trackId)},a.onMenuOpen=function(){b(2,8016)},a.onSheetChanged=function(){var t=a.props.editor.spread.getActiveSheet();if(t){var e=t.gcSheet,r=e.attrs,n=r.formGuid,o=r.formVersion;n===a.state.formGuid&&o===a.state.formVersion||a.setState({formGuid:n,formVersion:o})}else a.setState({formGuid:void 0,formVersion:void 0})},a.onCopyLink=function(){try{var t=a.state,e=t.formGuid,n=t.formVersion;if(!e)throw new Error(o()("指定的表单不存在"));var u=r.getFillPageUrl(e,n);if(!u)throw new Error(o()("表单未发布"));!function(t){var e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}(u),Object(i.showAlert)({title:o()("表单链接复制成功")})}catch(t){Object(i.showAlert)({title:o()("表单链接复制失败"),type:"error"})}},a.rerender=function(){a.forceUpdate?a.forceUpdate():a.setState({})},a.state={formGuid:void 0,formVersion:void 0},a}return v(e,t),e.prototype.componentDidMount=function(){this.props.editor.on(w.SheetSwitched,this.onSheetChanged),this.props.editor.on(w.AfterChangeApplied,this.onSheetChanged),this.props.editor.isRendered?this.onSheetChanged():this.props.editor.once(w.Rendered,this.onSheetChanged),r.on(l.a.FormChanged,this.rerender)},e.prototype.componentWillUnmount=function(){this.props.editor.off(w.SheetSwitched,this.onSheetChanged),this.props.editor.off(w.AfterChangeApplied,this.onSheetChanged),this.props.editor.off(w.Rendered,this.onSheetChanged),r.off(l.a.FormChanged,this.rerender)},e.prototype.shouldComponentUpdate=function(t,e){return this.props.permission.canEditFile!==t.permission.canEditFile||this.state.formGuid!==e.formGuid||this.state.formVersion!==e.formVersion},e.prototype.render=function(){var t,e=this,i=this.state,u=i.formGuid,l=i.formVersion,d=_().menuItems.form.map(function(t){return function(t,e,i){var u=t.value;switch(u){case"create":var s="form_create";return n()?y(y({},t),{icon:s}):y(y({},t),{icon:s,disabled:!0,disabledTip:""});case"create_from_header":var s="";return n()?y(y({},t),{icon:s}):y(y({},t),{icon:s,disabled:!0,disabledTip:""});case"edit":var s="form_edit";return e?a(e,i)?y(y({},t),{icon:s}):y(y({},t),{icon:s,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):y(y({},t),{icon:s,disabled:!0,disabledTip:""});case"unlink":var s="form_unlink",c=i===f.a.V2?o()("取消关联表单"):o()("停用表单");return e?n()?y(y({},t),{display:c,icon:s}):y(y({},t),{display:c,icon:s,disabled:!0,disabledTip:o()("暂无权限取消关联表单")}):y(y({},t),{display:c,icon:s,disabled:!0,disabledTip:""});case"responses":var s="form_responses";return i!==f.a.V2?y(y({},t),{icon:s,hidden:!0}):e?a(e,i)?y(y({},t),{icon:s}):y(y({},t),{icon:s,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):y(y({},t),{icon:s,disabled:!0,disabledTip:""});case"copy_link":var s="form_copy_link";return e&&r.isFormPublished(e,i)?y(y({},t),{icon:s}):y(y({},t),{icon:s,disabled:!0,disabledTip:""});case"statistics":var s="form_statistics";return i!==f.a.V2?y(y({},t),{icon:s,hidden:!0}):e?a(e,i)?y(y({},t),{icon:s}):y(y({},t),{icon:s,disabled:!0,disabledTip:o()("暂无权限访问该表单，请联系该表单的所有者")}):y(y({},t),{icon:s,disabled:!0,disabledTip:""});default:return Object(p.a)(u)}}(t,u,l)}).map(function(t,r){return t.hidden?[]:[s.a.createElement("div",{className:"tooltip--docker",key:r},s.a.createElement(c.e,{icon:t.icon,text:t.display,disabled:t.disabled&&"fake",onTap:function(){return e.onSelectMenuItem(t)}}),t.disabled&&t.disabledTip&&s.a.createElement(c.k,{option:t.disabledTip,direction:"left"})),"divider"===t.type&&s.a.createElement(c.d,{key:"d"+r})].filter(Boolean)}),v=(t=[]).concat.apply(t,d);return s.a.createElement(c.h,{disabled:!this.props.permission.canEditFile,tabName:function(){return o()("表单")},onOpen:this.onMenuOpen,tab:h.b.form,editor:this.props.editor},function(){return v})},e}(s.a.Component);return{tabList:(e={},e[h.b.form]=u,e)}};var n=r(1),o=r.n(n),i=r(1643),a=(r.n(i),r(2)),u=(r.n(a),r(0)),s=r.n(u),c=r(35),l=r(745),f=r(1036),p=r(1037),d=r(1647),h=r(43),v=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),y=this&&this.__assign||function(){return(y=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},m=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,u)}s((n=n.apply(t,e||[])).next())})},g=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},b=a.sheets.track,w=a.sheets.Events,_=a.sheets.menu.getMenuModel},function(t,e,r){(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.showAlert=function(e){var r=e.title,i=void 0===r?"":r,a=e.type,u=void 0===a?"success":a,s=e.duration,c=void 0===s?3e3:s,l=e.autoHide,f=void 0===l||l,p=e.customCls,d=void 0===p?"":p,h=e.priority,v=void 0===h?0:h,y=e.specifiedType,m=void 0===y?"":y,g=e.dangerousHtmlTitle,b=void 0===g?"":g,w=e.operation,_=void 0===w?void 0:w,O=(0,n.isMobile)()?"pt-mobile":"",x=o+" "+d+" "+O,C=t("."+o);if(C&&C.length){if(v<C.data("priority")&&"block"===C.css("display"))return;C.removeClass().addClass(x)}else{var S='<div class="'+x+'"><p class="sm-alert-content"><span class="s-error"></span><span class="sm-alert-title"></span><span class="sm-alert-operation"></span></p></div>';(C=t(S)).appendTo(t("body"))}C.find(t(".s-error")).css("display","error"===u?"inline-block":"none"),b?C.find(t(".sm-alert-title")).html(b):C.find(t(".sm-alert-title")).text(i);if(_){var j=C.find(t(".sm-alert-operation"));j.text(_.text).css("margin-left","10px"),j.on("click",function(){_.callback&&_.callback()})}else C.find(t(".sm-alert-operation")).text("").css("margin-left","0px");C.css("display","block").data("priority",v).data("type",m);var E=C.data("timerid");E&&clearTimeout(E);f&&(E=setTimeout(function(){return C.hide()},c),C.data("timerid",E))},e.hideAlert=function(e){var r=e&&e.specifiedType,n=t("."+o);n&&n.length>0&&(r&&r!==n.data("type")||n.hide())};var n=r(148);r(1644);var o="sm-sheet-alert-container"}).call(e,r(144))},function(t,e,r){var n=r(1645);"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r(25)(n,o);n.locals&&(t.exports=n.locals)},function(t,e,r){var n=r(71);(t.exports=r(24)(!1)).push([t.i,".sm-sheet-alert-container {\n  position: fixed;\n  top: 57px;\n  left: 0;\n  right: 0;\n  z-index: 2000;\n  text-align: center;\n  pointer-events: none;\n  font-size: 14px; }\n  .sm-sheet-alert-container.pt-mobile {\n    top: 9px;\n    font-size: 10px; }\n    .sm-sheet-alert-container.pt-mobile .sm-alert-content {\n      padding: 4px 22px;\n      max-width: auto; }\n\n.sm-alert-content {\n  display: inline-block;\n  max-width: 430px;\n  padding: 8px 25px;\n  font-size: 13px;\n  color: #41464b;\n  line-height: 22px;\n  word-break: break-all;\n  -webkit-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  -moz-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  -ms-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  -o-box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.15);\n  border-radius: 1px;\n  background-color: #dde7f3;\n  pointer-events: auto;\n  word-break: break-word;\n  background: #ffffff;\n  border: 1px solid #e5e5e5;\n  border-radius: 2px; }\n  .sm-alert-content .s-error {\n    width: 12px;\n    height: 12px;\n    background-image: url("+n(r(1646))+");\n    background-size: 12px 12px;\n    background-repeat: no-repeat;\n    position: relative;\n    top: 1px;\n    right: 9px;\n    display: none; }\n  .sm-alert-content .sm-alert-operation {\n    display: inline-block;\n    cursor: pointer;\n    color: #6da0e3; }\n",""])},function(t,e){t.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjQgKDY3Mzc4KSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5Db21iaW5lZCBTaGFwZTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSJUb2FzdC13aXRoLU9wZXJhdGlvbi1AMXgiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01MzQuMDAwMDAwLCAtNTQzLjAwMDAwMCkiIGZpbGw9IiNDRDQ3NDciPgogICAgICAgICAgICA8ZyBpZD0iR3JvdXAtNSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDY5LjAwMDAwMCwgNDMyLjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwLTE3IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0MC4wMDAwMDAsIDk2LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0zMSwyNyBDMjcuNjg2MjkxNSwyNyAyNSwyNC4zMTM3MDg1IDI1LDIxIEMyNSwxNy42ODYyOTE1IDI3LjY4NjI5MTUsMTUgMzEsMTUgQzM0LjMxMzcwODUsMTUgMzcsMTcuNjg2MjkxNSAzNywyMSBDMzcsMjQuMzEzNzA4NSAzNC4zMTM3MDg1LDI3IDMxLDI3IFogTTMxLDI2IEMzMy43NjE0MjM3LDI2IDM2LDIzLjc2MTQyMzcgMzYsMjEgQzM2LDE4LjIzODU3NjMgMzMuNzYxNDIzNywxNiAzMSwxNiBDMjguMjM4NTc2MywxNiAyNiwxOC4yMzg1NzYzIDI2LDIxIEMyNiwyMy43NjE0MjM3IDI4LjIzODU3NjMsMjYgMzEsMjYgWiBNMzAuNTIwNTQ4MiwxOS4yNDIyNiBDMzAuNDU0MjE0NSwxOC44MzIzMjExIDMwLjcyODAzMywxOC41IDMxLjE1MDYxMSwxOC41IEwzMS4zNDkzMTI1LDE4LjUgQzMxLjc2MzYyMDIsMTguNSAzMi4wNDcyMTc1LDE4LjgyMjk5OCAzMS45NzkzNzUyLDE5LjI0MjI2IEwzMS41MzMxMzU1LDIyIEwzMC45NjY3ODgsMjIgTDMwLjUyMDU0ODIsMTkuMjQyMjYgWiBNMzAuNSwyMy4yNSBDMzAuNSwyMi44MzU3ODY0IDMwLjgzMjg5ODYsMjIuNSAzMS4yNSwyMi41IEMzMS42NjQyMTM2LDIyLjUgMzIsMjIuODMyODk4NiAzMiwyMy4yNSBDMzIsMjMuNjY0MjEzNiAzMS42NjcxMDE0LDI0IDMxLjI1LDI0IEMzMC44MzU3ODY0LDI0IDMwLjUsMjMuNjY3MTAxNCAzMC41LDIzLjI1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSI+PC9wYXRoPgogICAgICAgICAgICAgICAgPC9nPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4="},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return i});var n,o=r(2);r.n(o);!function(t){t.create_from_desktop="create_from_desktop",t.create_from_header="create_from_header",t.create_from_sheets="create_from_sheets",t.add_text="add_text",t.add_multiple_text="add_multiple_text",t.add_single_choice="add_single_choice",t.add_multiple_choice="add_multiple_choice",t.add_dropdown_list="add_dropdown_list",t.response_expand_list="response_expand_list",t.response_create_sheet="response_create_sheet",t.response_view_in_sheets="response_view_in_sheets",t.response_unlink_forms="response_unlink_forms",t.stop_collect="stop_collect",t.preview="preview",t.publish="publish",t.publish_copy_url="publish_copy_url",t.publish_open_url="publish_open_url",t.publish_enable_deadline="publish_enable_deadline",t.publish_response_unlimited="publish_response_unlimited",t.publish_response_once="publish_response_once",t.publish_response_once_per_day="publish_response_once_per_day",t.sheet_edit_forms="sheet_edit_forms",t.sheet_view_response="sheet_view_response",t.sheet_view_statistics="sheet_view_statistics",t.sheet_copy_url="sheet_copy_url",t.sheet_unlink_form="sheet_unlink_form",t.sheet_unlink_forms_bottom="sheet_unlink_forms_bottom",t.sheet_delete_forms="sheet_delete_forms"}(n||(n={}));var i=function(t){try{if(!t)throw new TypeError("event is required");o.sheets.track.track("forms_click",{action:"click",object:t})}catch(t){console.error("[track]",t)}}},function(t,e,r){"use strict";r.d(e,"a",function(){return c});var n=r(0),o=r.n(n),i=r(745),a=r(1649),u=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},c=function(t){function e(e){var r=t.call(this,e)||this;return r.rerender=function(){r.forceUpdate()},r.state={},r}return u(e,t),e.prototype.componentDidMount=function(){this.props.formController.on(i.a.FormUiChanged,this.rerender)},e.prototype.componentWillUnmount=function(){this.props.formController.off(i.a.FormUiChanged,this.rerender)},e.prototype.render=function(){var t=this.props.formController.ui;return o.a.createElement(o.a.Fragment,null,t.createFormPopup.props?o.a.createElement(a.a,s({},t.createFormPopup.props)):void 0)},e}(o.a.Component)},function(t,e,r){"use strict";r.d(e,"a",function(){return g});var n=r(1),o=r.n(n),i=r(0),a=r.n(i),u=r(1650),s=r(1039),c=r(1651),l=r(2),f=(r.n(l),r(607)),p=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},h=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{s(n.next(t))}catch(t){i(t)}}function u(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,u)}s((n=n.apply(t,e||[])).next())})},v=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},y=l.sheets.spread.setSpreadFocus,m=l.sheets.alert.showAlert,g=function(t){function e(e){var r=t.call(this,e)||this;r.guessBestRow=function(){var t=Object(c.a)(5).map(function(t,e){return r.getFieldsFromSheetRow(e)}),e=t.map(function(t){return t.length}),n=Math.max.apply(Math,e),o=e.findIndex(function(t){return t===n});return{row:o,fields:t[o]}},r.getFieldsFromSheetRow=function(t){return Object(c.b)(r.props.editor,r.props.sheetGuid,t).map(function(t){return d(d({},t),{selected:!0})})},r.onChangeHeaderRow=function(t){r.setState({headerRow:t-1,fields:r.getFieldsFromSheetRow(t-1)})},r.onToggleField=function(t){var e=Object(s.a)(r.state.fields,function(e){var r=e[t];r.selected=!r.selected});r.setState({fields:e})},r.onSubmit=function(){return h(r,void 0,void 0,function(){var t,e,r,n;return v(this,function(i){switch(i.label){case 0:if(this.state.isCreating)return[2];this.setState({isCreating:!0}),i.label=1;case 1:return i.trys.push([1,3,,4]),t=this.state.fields,[4,this.props.onCreate({questions:t.filter(function(t){return t.selected}).map(function(t){return t.text})})];case 2:return e=i.sent().guid,this.props.editor.spread.setActiveSheet(e),this.props.onClose(),[3,4];case 3:return r=i.sent(),n=r&&r.errmsg||o()("创建表单失败，请稍后再试"),m({title:n,type:"error"}),this.setState({isCreating:!1}),[3,4];case 4:return[2]}})})};var n=r.guessBestRow(),i=n.row,a=n.fields;return r.state={headerRow:i,fields:a,isCreating:!1},r.props.editor.on(f.a.SheetSwitched,r.props.onClose),r._setSpreadFocus(!1),r}return p(e,t),e.prototype.componentWillUnmount=function(){this.props.editor.off(f.a.SheetSwitched,this.props.onClose),this._setSpreadFocus(!0)},e.prototype.render=function(){var t=this,e=this.props,r=e.onClose,n=e.editor,i=e.sheetGuid,s=this.state,c=s.headerRow,l=s.fields,f=n.spread.getSheet(i),p=f?f.getRowCount():0;return a.a.createElement("div",{className:"form-popup-wrapper f-center"},a.a.createElement("div",{className:"form-popup"},a.a.createElement("div",{className:"form-popup-header f-v-center"},a.a.createElement("h3",{className:"form-popup-heading f-1"},o()("基于表头创建表单")),a.a.createElement("div",{className:"form-popup-close-button sm-shortcut-close sm-icon-shortcut-close",onClick:r})),a.a.createElement("div",{className:"form-popup-content"},a.a.createElement("div",{className:"header-row-selector f-v-center"},a.a.createElement("div",{className:"header-row-select-label"},o()("选择表头内容行")),a.a.createElement("div",{className:"header-row-select-input f-1"},a.a.createElement(u.a,{value:c+1,min:1,max:p||1,onChange:this.onChangeHeaderRow}))),a.a.createElement("div",{className:"fields-selector"},a.a.createElement("div",{className:"fields-select-label"},o()("选择字段")),a.a.createElement("div",{className:"fields-select-input"},l.length?l.map(function(e,r){return a.a.createElement("div",{className:"form-field f-v-center",key:r,onClick:function(){return t.onToggleField(r)}},a.a.createElement("div",{className:"form-field-checkbox "+(e.selected?"is-selected":"")}),a.a.createElement("div",{className:"form-field-label f-1"},e.text))}):a.a.createElement("div",{className:"form-fields-placeholder"})))),a.a.createElement("div",{className:"form-popup-footer f-row f-m-end"},a.a.createElement("div",{className:"form-popup-confirm-button sm-btn-shortcut-confirm f-center "+(this.state.isCreating?"is-disabled":""),onClick:this.state.isCreating?void 0:this.onSubmit},o()("确定")))))},e.prototype._setSpreadFocus=function(t){var e=this.props.editor.spread.gcSpread,r=e.getActiveSheet();y(e,r,t)},e}(a.a.Component)},function(t,e,r){"use strict";r.d(e,"a",function(){return a});var n=r(0),o=r.n(n),i=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onIncrease=function(){var t=e.props,r=t.value;(0,t.onChange)(e.confine(r+1))},e.onDecrease=function(){var t=e.props,r=t.value;(0,t.onChange)(e.confine(r-1))},e.onChange=function(t){var r=e.props,n=r.value,o=r.onChange,i=t.target.value,a=Number(i);o(a!=a?e.confine(n):e.confine(a))},e.onKeyDown=function(t){switch(t.key){case"ArrowUp":e.onIncrease();break;case"ArrowDown":e.onDecrease()}},e.onFocus=function(t){var e=t.target;e.setSelectionRange(0,e.value.length)},e}return i(e,t),e.prototype.confine=function(t){var e=this.props,r=e.max,n=e.min,o=Math.floor(t);return null!=r&&o>r?r:null!=n&&o<n?n:o},e.prototype.render=function(){var t=this.props,e=t.value,r=t.max,n=t.min,i=!(null!=r&&e>=r),a=!(null!=n&&e<=n);return o.a.createElement("div",{className:"form-number-input f-row f-c-stretch"},o.a.createElement("input",{type:"text",className:"f-1 f-v-center",value:e,onChange:this.onChange,onKeyDown:this.onKeyDown,onFocus:this.onFocus}),o.a.createElement("div",{className:"number-spinners f-col f-c-stretch"},o.a.createElement("div",{className:"spinner spinner-increase f-1 f-center "+(i?"":"is-disabled"),onClick:i?this.onIncrease:void 0},o.a.createElement("div",{className:"spinner-icon"})),o.a.createElement("div",{className:"spinner spinner-decrease f-1 f-center "+(a?"":"is-disabled"),onClick:a?this.onDecrease:void 0},o.a.createElement("div",{className:"spinner-icon"}))))},e}(o.a.Component)},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"b",function(){return o});var n=function(t){for(var e=[],r=0;r<t;r++)e.push(void 0);return e},o=function(t,e,r){var o=t.spread.getSheet(e);if(!o)return[];if(r>=o.getRowCount())return[];var i=o.gcSheet;return n(o.getColumnCount()).map(function(t,e){var n=i.getSpan(r,e),o=n||{row:r,col:e,rowCount:1,colCount:1};if(i.isRangeReadable(o)){if(n)return e===n.col?i.getText(n.row,n.col):void 0;var a=i.getCellType(r,e);return a&&"8"===a.typeName?a.text():i.getText(r,e)}}).map(function(t,e){if(null!=t)return"string"==typeof t?""===t.trim()?void 0:{text:t,col:e}:"number"==typeof t?t!=t?void 0:{text:String(t),col:e}:void console.warn("[form] unknown cell text",t)}).filter(Boolean)}}])});