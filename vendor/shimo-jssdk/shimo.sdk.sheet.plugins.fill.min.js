!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://assets.smcdn.cn/sheet/",r(r.s=1924)}({1:function(t,e,r){"use strict";var n=function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function l(t){try{s(n.next(t))}catch(t){i(t)}}function a(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(l,a)}s((n=n.apply(t,e||[])).next())})},i=function(t,e){var r,n,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;l;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,n=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(o=(o=l.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=e.call(t,l)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},l=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],l=0,a=i.length;l<a;l++,o++)n[o]=i[l];return n};Object.defineProperty(e,"__esModule",{value:!0});var a=r(18),s=r(38),u={},c=function(t){return u[t]||(u[t]=g()),u[t]};e.getS18n=c;var h=function(){u={}};e.DEBUG_reset=h;var _=function(){return u};e.DEBUG_getInstances=_;var g=function(){var t,e,r="zh-CN",u="zh-CN",g={},f=function(t,e){if(!a.isValidLocaleResource(e))throw new Error("fetched locale resource is invalid");g[t]=n(n({},g[t]||{}),e)},d=function(t,r){return o(void 0,void 0,void 0,function(){var n;return i(this,function(o){switch(o.label){case 0:return!r&&g[t]?[3,2]:e?[4,e(t)]:[3,2];case 1:n=o.sent(),f(t,n),o.label=2;case 2:return[2]}})})},p=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("string"==typeof t[0]){var n=t[0],o=t[1],i=o&&"string"==typeof o._?o._:void 0,a=i?n+"#"+i:n;if(!a)return"";var c=s.getTextResult(a,g[r]);if("string"==typeof c)return c;var h=s.getTextResult(a,g[u]);return"string"==typeof h?h:n}if(t[0]&&"number"==typeof t[0].length){var _=t[0],f=t.slice(1);return s.getInterpolateResult(_,f,g[r])||s.getInterpolateResult(_,f,g[u])||s.interweave(_,f)}return console.warn.apply(console,l(["[s18n] invalid input:"],t)),""};return p.configure=function(r){if(r.fetchLocale){if("function"!=typeof r.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");e=r.fetchLocale}if(r.fetchLocaleSync){if("function"!=typeof r.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");t=r.fetchLocaleSync}},p.addLocaleResource=f,p.setLocaleAsync=function(t,e){return o(void 0,void 0,void 0,function(){return i(this,function(n){switch(n.label){case 0:if("string"!=typeof t)throw new Error("'locale' is required");return[4,d(t)];case 1:return n.sent(),r=t,"string"==typeof e&&(d(e),u=e),[2]}})})},p.setLocaleSync=function(e){if("string"!=typeof e)throw new Error("'locale' is required");if(t){var n=t(e);f(e,n)}r=e},p.getLocale=function(){return r},p.DEBUG_getLocaleResources=function(){return g},p.getS18n=c,p.DEBUG_reset=h,p.DEBUG_getInstances=_,p},f=c("__default_namespace__");t.exports=f,e.default=f},145:function(t,e,r){"use strict";r.p=("string"==typeof __SM_CDN_HOST__?__SM_CDN_HOST__:"https://assets.smcdn.cn")+"/sheet/"},148:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isRetina=function(){return window.devicePixelRatio>=2},e.isDingTalk=function(){return/dingtalk/i.test(r)},e.isDingtalk=function(){return!!r.match(/mobile.*dingtalk/i)},e.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},e.isWechatPc=n,e.isWxworkPc=o,e.isWechat=function(){return!!/micromessenger/.test(r)&&!n()},e.isMobile=function(){return!n()&&!o()&&!!r.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},e.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},e.isIOS=i,e.isAndroid=function(){return!!/(android)/g.test(r)},e.isAndroidApp=function(){return!!/shimo-android-app/g.test(r)},e.isIE=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},e.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},e.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},e.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},e.isWebIOS=function(){if(!window.cow.iOS&&i())return!0;return!1},e.isIphone6=function(){var t=!1;i()&&screen.height>568&&(t=!0);return t},e.isInWxMp=function(){return!(!navigator.userAgent.match(/micromessenger/i)||!navigator.userAgent.match(/miniprogram/i))||"miniprogram"===window.__wxjs_environment};var r=window.navigator.userAgent.toLowerCase();function n(){return!!/micromessenger.*?windowswechat/.test(r)}function o(){return!!/wxwork.*?micromessenger.*?wechat/i.test(r)}function i(){return!!/(ipad|iphone|ipod)/g.test(r)}},166:function(t,e){t.exports=function(t){return null==t}},18:function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(37);e.isValidLocaleResource=function(t){return!!t&&(!Array.isArray(t)&&("object"===(void 0===t?"undefined":n(t))&&Object.keys(t).every(function(e){var r=t[e];return null==r||"string"==typeof r||"object"===(void 0===r?"undefined":n(r))})))},e.sourceTextToKey=function(t){switch(t.type){case"string":var e=t.id,r=t.text;return e?r+"#"+e:r;case"interpolated":var n=t.textParts.length;return 1===n?t.textParts[0]:2===n?t.textParts[0]+"%s"+t.textParts[1]:t.textParts.map(function(e,r){return r===t.textParts.length-1?e:e+"%"+(r+1)}).join("");default:return o.assertNever(t)}}},1924:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"PLUGIN_NAME",function(){return b});var n=r(145),o=(r.n(n),r(148)),i=(r.n(o),r(2)),l=(r.n(i),r(1925)),a=r.n(l),s=r(1926),u=r(1),c=r.n(u),h=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_=this&&this.__assign||function(){return(_=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},g=i.sheets.Core,f=(i.Editor,i.sheets),d=f.range,p=f.perf,w=f.root,v=f.path,C=f.fill,m=f.Plugin,y=f.formula,R=v.setByPath,F=i.sheets.Hooks,S=g.Spread.Sheets,A=i.sheets.Events,x=C.fillZhSR,D=y.encodeFormula,T=o.isMac(),b="Fill",O=function(t){function e(r){var n=t.call(this,{name:b,Constructor:e,config:r})||this;n.render=function(){var t=n.editor;n.init(),g.Spread.Sheets.Fill.initSpread(t.spread.gcSpread),n.registerFillShortcut()},n.registerFillShortcut=function(){var t=n.editor,e=t.spread.gcSpread.commandManager();e.register("custom-fillBottom",function(){if(!t.permissions.query.canEditFile())return!0;var e=S.Fill,r=e.AutoFillType,o=e.FillDirection,i=n.editor.spread.getActiveSheet();if(!i.gcSheet.isEditing()){var l=i.getCurSelection(),a=i.gcSheet,s=a._commandManager(),u=a.name(),c=void 0,h=void 0;if(1===l.rowCount){var g=l.row-1;if(-1===g)return!0;c=_(_({},l),{row:g}),h=_(_({},l),{row:l.row,rowCount:l.rowCount})}else c=_(_({},l),{row:l.row,rowCount:1}),h=_(_({},l),{row:l.row+1,rowCount:l.rowCount-1});return c=d.createRange(c.row,c.col,c.rowCount,c.colCount),h=d.createRange(h.row,h.col,h.rowCount,h.colCount),s.execute({cmd:"fill",sheetName:u,startRange:c,fillRange:h,autoFillType:r.copyCells,fillDirection:o.down,srcRange:c}),!0}});e.setShortcutKey("custom-fillBottom",68,!T,!1,!1,T)},n.onCollectOperatorAfterDragFillBlockCompleted=function(t,e){var r=t.args,o=r.sheet,i=r.autoFillType,l=r.fillDirection,a=r.collectedCells,u=d.fixRange(o,r.fillRange),c=d.fixRange(o,r.srcRange);p.paintWrap({obj:o,func:s.a,suspendCalcService:!0})(o,l,c,u,a);var h=n.editor,_=o._rowFilter?o._rowFilter._getFilterArgs().filteredOutRows:[];for(var g in a)if(a[g].formula){var f=g.split("-").map(Number),w=f[0],v=f[1],C=o.getFormulaInformation(w,v);C.isArrayFormula&&(a[g].formula=D(o,w,v,C))}var m={fnName:"dragFill2Cs",params:h.opProcessor([o.guid(),{fillRange:u,autoFillType:i,fillDirection:l,srcRange:c,collectedCells:a,filteredRows:_}])};return e.push(m),e};var o=r.editor;return n.editor=o,n.bindEditorEvents(),n.registerHooks(),n.editor.isRendered&&n.render(),n.install(),n}return h(e,t),e.prototype.setLocale=function(t){c.a.setLocaleSync(t)},e.prototype.init=function(){g.Spread.Sheets.Fill||(a()(g),g.Spread.Sheets.Fill.install(g.Spread.Sheets),g.Spread.Sheets.Fill.SR.zh=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(g.Spread.Common.SR.zh,x))},e.prototype.bindEditorEvents=function(){this.editor.on(A.Rendered,this.render)},e.prototype.registerHooks=function(){(0,this.editor.hookManager.registerHook)(F.CollectOperatorAfterDragFillBlockCompleted,this.onCollectOperatorAfterDragFillBlockCompleted)},e}(m);e.default=O,R(w,"shimo.sdk.sheet.plugins.Fill",O)},1925:function(t,e){t.exports=function(e){e.Spread.Sheets.Fill=t.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=14)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"ROW_COUNT",function(){return u}),r.d(e,"COLUMN_COUNT",function(){return c}),r.d(e,"NUMBER_STRING",function(){return h}),r.d(e,"SER_NUMBER_STRING",function(){return _}),r.d(e,"SER_STRING",function(){return g}),r.d(e,"MONTH_STRING",function(){return f}),r.d(e,"DAY_STRING",function(){return d}),r.d(e,"WEEK_STRING",function(){return p}),r.d(e,"DATE_STRING",function(){return w}),e.getValType=function(t){switch(!0){case t instanceof Date:return w;case v(t):return h;case y(t):return d;case m(t):return p;case R(t):return f;case C(t):return _+t.toString().split(".").length;case F(t):return g;default:return null}},e.toArray=function(t){var e=[t];return e.rowCount=1,e.colCount=t.length,e},e.isNumber=v,e.isSerialNum=C,e.isWeek=m,e.isDay=y,e.isMonth=R,e.isAllSame=function(t){return!t.length||!t.some(function(e){return e!==t[0]})},e.isSameStep=function(t){if(t.length<=2)return!0;var e=t[1]-t[0];return!t.some(function(r,n){return 0!==n&&e!==r-t[n-1]})},e.isSerialString=F,e._hasOwnProperty=S,e._CopyProperty=function(t,e){for(var r in e)S(e,r)&&(t[r]=e[r])},e.printException=A,e.isValidRange=function(t,e,r,n,o,i){if(-1<=t&&t<o&&-1<=e&&e<i){if(-1===t&&-1===e)return!0;if(-1===t){if(0!==n&&e+n<=i)return!0}else if(-1===e){if(0!==r&&t+r<=o)return!0}else if(0!==n&&e+n<=i&&0!==r&&t+r<=o)return!0}return!1},e.cellRangeInflate=function t(e,r){var n=e.length;for(var o=0;o<n;o++){var i=e[o];if(r.intersect(i.row,i.col,i.rowCount,i.colCount))return e.splice(o--,1),t(e,r.union(i))}return r},e.isDefined=function(t){return void 0!==t},e.createElement=function(t){return document.createElement(t)},e.documentInsertBefore=function(t){document.body&&document.body.insertBefore(t,null)},e.cancelDefault=function(t){t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1);return!1},e._getPreferredZIndex=function(t){var e=document.body,r=t;for(;r&&r.parentElement&&r.parentElement!==e;)r=r.parentElement;var n,o=1e3;r&&r.parentElement===e&&(n=parseInt(a(r).css("z-index")),isNaN(n)||(o+=n));return o},e.device=function(){var t,e,r,n,o=navigator.userAgent,i=o.match(/iPad/i);i&&(t=i[0])&&(e="ipad"===t.toLowerCase());(i=o.match(/iPhone/i))&&(t=i[0])&&(r="iphone"===t.toLowerCase());(i=o.match(/android/i))&&(t=i[0])&&(n="android"===t.toLowerCase());return{ipad:!!e,iphone:!!r,android:!!n}},r.d(e,"browser",function(){return x}),e._createRange=function(t,e,r,n){return new l.a.Range(t,e,r,n)},e.spanContainsFilteredRow=function(t,e){if(t._isRowFilterOut)for(var r=e.row;r<e.row+e.rowCount;r++)if(t._isRowFilterOut(r))return!0;return!1},e._getColor=function(t,e){if(t&&e){var r=t._currentTheme;if(r)return r.getColor(e)}return e};var n=r(3),o=r.n(n),i=r(1),l=r.n(i),a=l.a.GC$,s=o.a._isNumber,u="rowCount",c="colCount",h="number",_="serialNumber",g="serialString",f="monthString",d="day",p="week",w="date";function v(t){return"string"!=typeof t&&s(t)}function C(t){if(!t)return!1;return t="string"!=typeof t?t.toString():t,/^\d+\.(\d+\.)+\d+$/.test(t)}function m(t){return/^周[一,二,三,四,五,六,天,日]$/.test(t)}function y(t){return/^星期[一,二,三,四,五,六,天,日]$/.test(t)}function R(t){return-1!==["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"].indexOf(t)||-1!==["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"].indexOf(t)}function F(t){return/.*\d$/.test(t)}function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function A(t){console.log("Exception from GC =>"),console.warn(t)}var x=function(){var t=navigator.userAgent,e=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(t),r={};e.browser&&(r[e.browser]=!0,r.version=e.version),r.chrome?r.webkit=!0:r.webkit&&(r.safari=!0),t.indexOf("PhantomJS")>=0&&(r.safari=!1,r.chrome=!0);var n=t.toLowerCase();n.indexOf("compatible")<0&&null!==/(trident)(?:.*? rv ([\w.]+)|)/.exec(n)&&(r.mozilla=void 0,r.msie=!0);var o=/Edge\/\d+/.exec(t);return null!==o&&o.length>0&&(r.webkit=void 0,r.chrome=void 0,r.msie=!0,r.edge=!0,r.version=o[0].substr(o[0].indexOf("/")+1)),r.msie&&function(){var t=null,e=!1;try{new ActiveXObject("htmlfile")}catch(e){A(e),t=e.name}try{e=!!new ActiveXObject("htmlfile")}catch(t){A(t),e=!1}return!(e="ReferenceError"===t||!1!==e)}()&&(r.metroMode=!0),t.indexOf("QQBrowser")>-1&&(r.QQBrowser=!0),r}()},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.Sheets},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.Common},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.Common._Types},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"SR",function(){return a}),r.d(e,"sR",function(){return s});var n=r(2),o=r.n(n),i=r(15),l=r.n(i),a={};function s(){return o.a._getResource(a)()}a.en=l.a,e.default={SR:a}},function(t,e,r){"use strict";var n=r(0),o=r(3),i=r.n(o),l=r(2),a=r.n(l),s=a.a._growth,u=a.a._leastSquare,c=i.a._isNullOrUndefined,h=function(){function t(t){this._startIndex=t}return t.prototype.add=function(t,e){c(this._type)&&(this._type=Object(n.getValType)(e)),this._indexes.push(t),this._innerValues.push(e)},t.prototype._dataCount=function(){return this._innerValues&&this._innerValues.length},t.prototype._values=function(){return this._innerValues},t.prototype._insert=function(t,e,r){c(this._type)&&(this._type=Object(n.getValType)(r)),this._indexes.splice(t,0,e),this._innerValues.splice(t,0,r)},t.prototype._indexes2=function(){var t=this._indexes,e=t?t.length:0;if(e>0){var r=this._startIndex,n=[],o=void 0;for(-1===r&&(r=t[0]),o=0;o<e;o++)n[o]=t[o]-r+1;return n}return null},t.prototype.valueConverter=function(){var t=this._innerValues;return t&&t.length?t:null},t.prototype._toActualValue=function(t){return t},t.prototype.getTrendOrGrowthValue=function(t,e,r,o){o=o||this.valueConverter(),r=r||this._indexes2();var i,l=Object(n.toArray)(o),a=Object(n.toArray)(r),u=Object(n.toArray)([e]),c=(i=t?this.trend(l,a,u,!0,function(t){return t},null,null,null):s(l,a,u,!0,null,null,null))&&i[0][0];return typeof c===n.NUMBER_STRING&&c.toString().length>15?+c.toPrecision(16):c},t.prototype._getInnerIncrease=function(t,e,r,o){var i=Object(n.getValType)(t);if(!i)return null;var l=null;if(e===i){if(this.patternMatch&&!this.patternMatch(t))return null;l=r?o?r.colCount:r.rowCount:1}return l},t.prototype.patternMatch=function(t){return!0},t.prototype.trend=function(t,e,r,o,i,l,a,s){var c,h,_,g=[],f=this.resultConverter&&this.resultConverter.bind(this),d=e[n.ROW_COUNT],p=e[n.COLUMN_COUNT],w=t[n.ROW_COUNT],v=t[n.COLUMN_COUNT],C=r[n.ROW_COUNT],m=r[n.COLUMN_COUNT];if(w!==d||v!==p)return null;var y=u(e,t,d,p),R=y.mm,F=y.d;for(c=0;c<C;c++)for(g[c]=[],h=0;h<m;h++)_=R*r[c][h]+F,g[c][h]=(f?f(_):_)||"";return g},t.prototype.resultConverter=function(t){return t},t}();e.a=h},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.CalcEngine},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4),o=r(0),i=r(16),l=c(r(1)),a=c(r(6)),s=c(r(2)),u=c(r(8));function c(t){return t&&t.__esModule?t:{default:t}}var h=o._createRange,_=l.default._supportsCalc,g=s.default._Types,f=Math.floor,d=g._isNullOrUndefined,p=s.default._ArrayHelper._getLength,w=s.default._DateTimeHelper,v=w._toOADate,C=w._fromOADate;function m(t,e){this._sheet=t,this.collectedCells=e}function y(t,e){switch(!0){case(0,o.isDay)(t):case(0,o.isWeek)(t):return new i.DaySource;case(0,o.isMonth)(t):return new i.MonthSource;case t instanceof Date&&u.default.isDateFormatter(e):return new i.DateSource;case(0,o.isNumber)(t):case(0,o.isSerialNum)(t):return new i.NumberSource;case(0,o.isSerialString)(t):return new i.SerialStringSource}}function R(t){return h(t.row,t.col,t.rowCount,t.colCount)}m.prototype={_fillLinearOrGrowth:function(t,e,r,n,o){var i=t?1:2;d(n)&&d(o)?this._seriesFillRange(e,r,i):this._seriesFillRange(e,r,i,n,o,null)},_seriesFillRange:function(t,e,r,o,i,l){var a=this._sheet,s=a._getActualRange(t),u=s.row,c=s.col,h=s.rowCount,_=s.colCount;if(a._getSpanModel().hasSpans(u,c,h,_))throw new Error((0,n.sR)().Exp_RangeContainsMergedCell);var g,f,d,w,v,C=arguments.length>3,m=0,y=1===e,R=y?_:h,F=y?u:c,S=y?u+h:c+_,A=C?1:R,x=this._sheet._eventHandler._fillStartRange,D=x.row===u&&x.rowCount===h&&x.col>c||x.col===c&&x.colCount===_&&x.row>u;for(g=F;g<S;g++){var T=D&&C?c+_-1:c,b=D&&C?u+h-1:u,O=y?this._getSeriesSource(g,T,1,A,e):this._getSeriesSource(b,g,A,1,e);if(O&&O._dataCount())for(w=O._indexes[0],C?(v=D?O._innerValues[p(O._innerValues)-1]:O._innerValues[0],f=this._calcSeriesData(D,v,R,r,o,i,l),D&&(m=R-p(f),w=O._indexes[p(O._indexes)-1])):f=this._calcSeriesTrendData(O,R,r),d=0;d<p(f);d++){var E=O._toActualValue(f[d]);y?this._copyCell(a,g,w,g,c+m+d,E,r,!1,void 0,void 0,!0):this._copyCell(a,w,g,u+m+d,g,E,r,!1,void 0,void 0,!0)}}},_getSeriesSource:function(t,e,r,n,l){for(var a,s=null,u=this._sheet,c=1===l,h=c?e+n-1:t+r-1,_=c?e:t;h>=_;)a=c?u.getValue(t,h):u.getValue(h,e),(0,o.isNumber)(a)&&(s||(s=new i.NumberSource(_)),s._insert(0,h,a)),h--;return s},_calcSeriesData:function(t,e,r,n,o,i,l){var a,s=[],u=e,c=o>=0,h=d(i);for(a=0;a<r;a++){var _=u>=i,g=u<=i;t&&(h||c&&_||!c&&g)?(s.unshift(u),1===n?u-=o:2===n?u/=o:3!==n||d(l)||(u=this._getNextDateValue(!0,l,e,u,o,a+1))):!t&&(h||c&&g||!c&&_)&&(s.push(u),1===n?u+=o:2===n?u*=o:3!==n||d(l)||(u=this._getNextDateValue(!1,l,e,u,o,a+1)))}return s},_calcSeriesTrendData:function(t,e,r){var n,o=[],i=1===r;if(i||2===r){for(1===t._dataCount()&&t.add(t._indexes[0]+1,i?t._toActualValue(t._innerValues[0]+1):t._values()[0]),n=0;n<e;n++)o.push(t.getTrendOrGrowthValue(i,n+1));return o}return null},_fillAuto:function(t,e,r,o){var i=this._sheet,l=i._getSpanModel(),a=i._getActualRange(t),s=a.row,u=a.col,c=a.rowCount,h=a.colCount,_=i._getActualRange(i._eventHandler._fillStartRange),g=_.row,f=_.col;if(l.hasPartSpans(g,f,_.rowCount,_.colCount)||l.hasPartSpans(s,u,c,h))throw new Error((0,n.sR)().Exp_ChangeMergedCell);for(var d=c,p=s;p<s+c;p++)i._isRowFilterOut&&i._isRowFilterOut(p)&&d--;return this._autoFillRange(_,d,h,e,r,!(s<g||u<f),o)},_autoFillRange:function(t,e,r,o,i,l,a){var s,u,c,_,g=this._sheet,d=l?1:-1,p=t.row,w=t.col,v=t.rowCount,C=t.colCount;if(!i){var m=function(){switch(!0){case 1===o&&l:return{row:t.row,col:t.col+t.colCount,rowCount:t.rowCount,colCount:r-t.colCount};case 1===o&&!l:return{row:t.row,col:t.col+t.colCount-r,rowCount:t.rowCount,colCount:r-t.colCount};case 1!==o&&l:return{row:t.row+t.rowCount,col:t.col,rowCount:e-t.rowCount,colCount:r};default:return{row:t.row+t.rowCount-e,col:t.col,rowCount:e-t.rowCount,colCount:r}}}(),y=g&&g._getCalcModel();if(y&&y._intersectWithArrayFormula(m.row,m.col,m.rowCount,m.colCount))return g&&g._raiseInvalidOperation(4,(0,n.sR)().Exp_ArrayFromulaPart,{message:(0,n.sR)().Exp_ArrayFromulaPart}),null}if(1===o){if(s=f(r/C),u=r%C,!i)for(_=1;_<s;_++)c=h(p,w+_*d*C,v,C),this._copyRange(t,c,o,4,i,void 0,void 0,void 0,void 0,a,[]);if(i&&s>1&&0===u&&(s-=1,u=C),s>0&&u>0)return c=h(p,l?w+s*C:w-s*C+C-u,v,u),this._copyRange(t,c,o,4,i,l,null,l?0:C-u,void 0,a,[])}else{for(var R=[],F=p;F<p+v;F++)this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(F)&&R.push(F);var S=v-R.length;s=f(e/S),u=e%S;var A=0;if(!i){var x=0,D=0,T=0;for(_=1;_<s;_++){var b=S;if(l){for(T=p+_*d*S+(l?R.length:0),T=Math.max(x,T);this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(T);)T++,A++;for(var O=T;O<T+b;O++)this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(O)&&(b++,A++);x=T+b*d}else{var E=p-1;for(1===_&&(D=p),E=Math.min(D-1,E);this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(E);)E--,A++;var I=0;for(T=E;I<S;)this._sheet._isRowFilterOut&&!this._sheet._isRowFilterOut(T)?I++:A++,I<S&&T--;b=E-T+1,D=T}c=h(T,w,b,C),this._copyRange(t,c,o,4,i,l,null,null,!0,a,R)}}if(i&&s>1&&0===u&&(s-=1,u=v),s>0&&u>0){for(var V=e%S,M=l?p+s*S+R.length+A:p-s*S+V-A;this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(M);)l?M++:M--;return c=h(M,w,u,C),this._copyRange(t,c,o,4,i,l,l?0:S-u,null,!0,a,R)}}},_copyRange:function(t,e,r,n,i,l,a,s,u,c,h){h||(h=[]);var _,g,f,d,p,w=this._sheet,v=null,C=1===r,m=C?t.row:t.col,R=C?t.col:t.row,F=C?e.row:e.col,S=C?e.col:e.row,A=C?t.rowCount-h.length:t.colCount,x=C?t.colCount:t.rowCount-h.length,D=C?e.colCount:e.rowCount,T=w.getArrayExpressionCellsInRange(t);for(d=0;d<A;d++){for(var b=null,O=null,E=0,I=m+d,V=F+d,M=I,P=V,N=(C?s:a)||0,k=C?0:N,B=C?null:u;E<x;){var j=R+E,L=S+E-N,H=null,U=j,W=L;if(!C){I=[j,j=M][0];for(var G=h.filter(function(t){return t<I});h.includes(I);)I++;for(I+=G.length,V=[L,L=P][0];w._isRowFilterOut&&w._isRowFilterOut(V);)V++}f=w._getSpanModel().find(I,j),_=w.getFormula&&w.getFormula(I,j);var Y=w.getArrayValueMark(I,j);_&&""!==_||Y&&T[Y]||(H=w.getValue(I,j));var Q=H,K=w.getCellType&&w.getCellType(I,j);if(K&&"8"==K.typeName&&(Q=""),4===n){var X=w.getFormatter(I,j)||w.getAutoFormatter(I,j);if(b=b||y(Q,X),g=(0,o.getValType)(Q),O||(O=g),b&&(v=b._getInnerIncrease(Q,O,f,C))){b.add(U,Q),E+=v;continue}}if(Q&&b&&b._dataCount()){if(p=this._autoFillTrendValues(C,t,e,M,P,b,i,l,k,B,c,h),i&&(p||0===p))return p;b=null,O=null}else{if(!f||f&&(C?f.row:f.col)===M){for(var Z=W===S+D-1;!C&&w._isRowFilterOut&&w._isRowFilterOut(W);)W++;if(i){if(f&&Z||!f&&(Z&&l||!l&&W===S))return H}else W<S+D&&W>=S&&(C||!C&&!(u&&w._isRowFilterOut&&w._isRowFilterOut(W)))&&this._copyCell(w,I,j,V,L,H,n,c,t,e,!1)}f?E+=C?f.colCount:f.rowCount:E++}}if(b&&b._dataCount()&&(p=this._autoFillTrendValues(C,t,e,M,P,b,i,l,k,B,c,h),i&&(p||0===p)))return p}return null},_copyCell:function(t,e,r,n,i,l,s,u,c,h,g){if(e!==n||!t._isRowFilterOut||!t._isRowFilterOut(e)){var f,d,p=t._getSpanModel(),w=this.collectedCells,v=n+"-"+i;w[v]?w[v].value=l:w[v]={value:l};var C=t.hasFormula(e,r);if(_&&(C||t.hasFormula(n,i))){var m=t.getFormulaInformation(n,i),y=m&&m.isArrayFormula;if(m&&m.hasFormula&&!C&&(w[v].formula=null),y){var F=m.baseRange;n===F.row&&i===F.col&&t.setArrayFormula(F.row,F.col,F.rowCount,F.colCount,null)}else t.setFormula(n,i,null);if(0===s||4===s){f=t._getCalcModel();var S=t.getFormulaInformation(e,r);if(S.hasFormula)if(S&&S.isArrayFormula){var A=S.baseRange;if(c){var x=function(t,e,r,n,o,i){switch(function(t,e,r,n){if(e>t)return"Down";if(e<t)return"Up";if(n>r)return"Right";if(n<r)return"Left"}(r,n,o,i)){case"Down":return{row:t.row,col:t.col,rowCount:e.rowCount,colCount:t.colCount};case"Up":return{row:t.row+(t.rowCount-e.rowCount),col:t.col,rowCount:e.rowCount,colCount:t.colCount};case"Right":return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:e.colCount};case"Left":return{row:t.row,col:t.col+(t.colCount-e.colCount),rowCount:t.rowCount,colCount:e.colCount}}return t}(c,h,e,n,r,i),D=R(A).getIntersect(R(x));D.row===e&&D.col===r&&a.default.CalcOperatorAdjustor.copyFormula(f,e,r,f,n,i,D.rowCount,D.colCount,void 0,void 0,W)}else a.default.CalcOperatorAdjustor.copyFormula(f,e,r,f,n,i,1,1,void 0,void 0,W)}else a.default.CalcOperatorAdjustor.copyFormula(f,e,r,f,n,i,1,1,void 0,void 0,W)}}t.setValue(n,i,l);var T=16380;if(u&&(T|=128),t._copyToCore(e,r,n,i,1,1,T,void 0,void 0,w,{ignoreNumberText:!1,clearRichText:g,fromAutoFill:!0}),!p.isEmpty()&&(t.removeSpan(n,i,3),(d=p.find(e,r))&&!(0,o.spanContainsFilteredRow)(t,d)&&e===d.row&&r===d.col)){t._addSpanImp(n,i,d.rowCount,d.colCount,3),w[e+"-"+r].mergeInfo=d;for(var b=c.row,O=c.col,E=c.rowCount,I=c.colCount,V=h.row,M=h.col,P=h.rowCount,N=h.colCount,k=n;k<n+d.rowCount;k++)for(var B=i;B<i+d.colCount;B++)if(k!==n||B!==i){if(t.setValue(k,B,null),t.getFormula(k,B)&&t.setFormula(k,B,null),w){var j=t._getStyleObject(k,B);j&&j.cellType&&"8"===j.cellType.typeName&&(j=Object.assign({},j,{cellType:j.cellType.toJSON()})),w[k+"-"+B]={style:j}}if(k>V+P-1||B>M+N-1){e=(k-b)%E+b;var L=(B-O)%I+O,H=t._getStyleObject(e,L);if(H&&H.clone&&(H=H.clone()),H&&delete H.ignoreNumberTextPrompt,t._setStyleObject(k,B,H),w){var U=e+"-"+L;H&&H.cellType&&"8"===H.cellType.typeName&&(H=Object.assign({},H,{cellType:H.cellType.toJSON()})),w[U]?w[U].style=H:w[U]={style:H}}}}}}function W(t){var e=t.formula,r=t.toRow+"-"+t.toColumn;w[r]?w[r].formula=e:w[r]={formula:e}}},_autoFillTrendValues:function(t,e,r,n,o,i,l,a,s,u,c,h){var _,g,f,d,p=this._sheet,w=t?r.col:r.row,v=t?e.col:e.row,C=t?r.colCount:r.rowCount,m=t?e.colCount:e.rowCount-h.length,y=a?1:-1;s=s||0,a&&!t&&(s+=h.length);var R=0;if(!t)for(var F=a?e.row+e.rowCount:r.row,S=a?r.row:e.row,A=F;A<S;A++)p._isRowFilterOut&&p._isRowFilterOut(A)&&R++;a&&!t?s+=R:s-=R;var x=i._dataCount(),D=(w-v-s)/m,T=this._isArithmeticProgression(i._indexes,i.valueConverter());if(T){for(f=[],g=0;g<x;g++)f[g]=g+1;_=x}else d=i._indexes[0],_=i._indexes[x-1]-d+1,1===x&&i.add(i._indexes[0]+1,i._toActualValue(i.increase(i._innerValues[0],1))),f=i._indexes2();for(g=0;g<_;g++){var b=i.getTrendOrGrowthValue(!0,_*D+g+1,f),O=w+C-1,E=T?i._indexes[g]:d+g,I=E+D*m;if(!t){for(I+=R*y,a&&(I+=h.length);p._isRowFilterOut&&p._isRowFilterOut(I);)I++;for(var V=h.filter(function(t){return t<E});h.includes(E);)E++;E+=V.length}if(l){if(T&&(a&&I===O||!a&&I===w)||!T&&I+s===O)return i._toActualValue(b)}else I<w+C&&I>=w&&(t?this._copyCell(p,n,E,o,I,i._toActualValue(b),4,c,e,r,!0):u&&p._isRowFilterOut&&p._isRowFilterOut(I)||this._copyCell(p,E,n,I,o,i._toActualValue(b),4,c,e,r,!0))}return null},_isArithmeticProgression:function(t,e){var r=p(e);if(r<=1||p(t)!==r)return!1;var n,o=t[1]-t[0],i=e[1]-e[0];for(n=2;n<r;n++)if(t[n]-t[n-1]!==o||e[n]-e[n-1]!==i)return!1;return!0},_fillAutoByDirection:function(t,e){var r,n=this._sheet,i=n.getSpans(),l=n._getActualRange(t),a=l.row,s=l.col,u=l.rowCount,c=l.colCount;r=0===e?h(a,s+c-1,u,1):1===e?h(a,s,u,1):h(2===e?a+u-1:a,s,1,c),(r=(0,o.cellRangeInflate)(i,r))&&this._directionFillRange(r,a,s,u,c,e)},_directionFillRange:function(t,e,r,o,i,l){var a,s,u,c,_,g,d,p,w=t.row,v=t.col,C=t.rowCount,m=t.colCount,y=this._sheet._getSpanModel();if(0===l?(p=y.hasSpans(e,r,o,i-m),g=0,d=-1*m,u=i,c=m,_=1):1===l?(p=y.hasSpans(e,r+m,o,i-m),g=0,d=m,u=i,c=m,_=1):2===l?(p=y.hasSpans(e,r,o-C,i),g=-1*C,d=0,u=o,c=C,_=0):(p=y.hasSpans(e+C,r,o-C,i),g=C,d=0,u=o,c=C,_=0),p)throw new Error((0,n.sR)().Exp_TargetContainsMergedCells);if(u%c!=0)throw new Error((0,n.sR)().Exp_MergedCellsIdentical);for(a=f(u/c),s=1;s<a;s++)this._copyRange(t,h(w+s*g,v+s*d,C,m),_,0)},_getNextDateValue:function(t,e,r,n,o,i){var l=t?-1:1,a=f(i*o),s=Math.abs(o),u=C(e>1?r:n);if(0===e)u.setDate(u.getDate()+l*o);else if(1===e)for(;s>0;)u.setDate(u.getDate()+l*(o>0?1:-1)),6!==u.getDay()&&0!==u.getDay()&&s--;else 2===e?u.setMonth(u.getMonth()+l*a):u.setFullYear(u.getFullYear()+l*a);return v(u)}},e.default=m},function(t,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.Formatter},function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),e.sheetEx=e.regiterCmds=e.FILL_FEATURE_NAME=void 0;var o=r(4),i=r(0),l=u(r(1)),a=u(r(2)),s=u(r(7));function u(t){return t&&t.__esModule?t:{default:t}}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=l.default.Events,_=l.default.Exception,g=l.default.Commands,f=l.default._SheetModel,d=l.default._supportsCalc,p=l.default.GC$,w=_.triggerError,v=g._prepareCommands,C=a.default._Types._isNullOrUndefined,m=Math.max,y=Math.floor,R=g.ActionBase,F=g._ChangedCells,S=g._CopyMoveHelper,A=S._saveViewportInfo,x=S._raiseRangeDataChanged,D=g._CopyMoveCellsInfo,T="startRange",b="fillRange",O="autoFillType",E="fillDirection",I="srcRange",V=g._performUndo,M=g._saveColumnHeaderInfo,P=g._saveViewportInfoForDragDrop,N=g._saveTableInfo,k=g._saveRowHeaderInfo,B=e.FILL_FEATURE_NAME="fill";e.regiterCmds=v((c(n={},B,{canUndo:!0,execute:function(t,e,r){return g._executeCommand(t,G,e,r)}}),c(n,"dragDrop",{canUndo:!0,execute:function(t,e,r){return g._executeCommand(t,Q,e,r)}}),n));function j(t){return t.rowCount}function L(t){return t.colCount}function H(t,e){return t.getRowCount(e)}function U(t,e){return t.getColumnCount(e)}var W=function(t){function e(e,r){var n=r[E],o=0===n,l=o||1===n,a=r[b],s=r[T],u=s.row,c=s.col,h=j(s),_=L(s);t.call(this),this._sheet=e,this._autoFillExtent=r,4===r[O]?this._clearValueUndoAction=new g._ClearValueUndoAction(e,[r[b]]):this._wholeFillRange=l?(0,i._createRange)(u,o?a.col:c,h,_+L(a)):(0,i._createRange)(2===n?a.row:u,c,h+j(a),_),this._fillSeries=l?1:0}p.inherit(e,t);var r={canExecute:function(){var t=this._sheet,e=this._autoFillExtent,r=e[T],n=e[b];return!!t._canChange(n.row,n.col,j(n),L(n))&&(4===e[O]||!n.intersect(r.row,r.col,j(r),L(r)))},execute:function(){if(this.canExecute()){var t=this._autoFillExtent,e=t[b],r=this._sheet;this._beforeAction(r);try{d&&r.suspendCalcService(),4===t[O]?this._executeDragFillClear(r):this._executeAutoFill(r)}catch(t){(0,i.printException)(t),w(t)}finally{this._afterAction(r),d&&r.resumeCalcService(!1),r._updateTableSlicer&&r._updateTableSlicer(e.row,e.col,j(e),L(e))}}},_executeDragFillClear:function(t){this._clearValueUndoAction.execute(t);var e,r=this._autoFillExtent,n=r[T],o=r[b],l=0===this._fillSeries,a=j(n),s=L(n),u=l?m(1,a-j(o)):a,c=l?s:m(1,s-L(o));n.equals(o)||(e=(0,i._createRange)(n.row,n.col,u,c),t._setActiveCellImp(m(t._getFirstVisualRow(),e.row),m(t._getFirstVisualColumn(),e.col),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.addSelection(e.row,e.col,j(e),L(e)))},_executeAutoFill:function(t){var e,r,n=this._sheet,o=this._autoFillExtent[T],i=this._autoFillExtent[b],l=this._autoFillExtent[O],a=this._wholeFillRange,s={fillType:4,series:this._fillSeries,withTag:!0,collectedCells:this._autoFillExtent.collectedCells},u={fromAutoFill:!0};if(1===l){if(n.fillAuto(o,a,s),n._getSpanModel().hasSpans(o.row,o.col,o.rowCount,o.colCount))for(e=0;e<i.rowCount;e++)if(!n._isRowFilterOut||!n._isRowFilterOut(i.row+e))for(r=0;r<i.colCount;r++){var c=o.row+y(e%o.rowCount),h=o.col+y(r%o.colCount),_=n._getStyleObject(c,h);if(_&&_.clone&&(_=_.clone()),_&&delete _.ignoreNumberTextPrompt,n._setStyleObject(i.row+e,i.col+r,_),s.collectedCells){var g=c+"-"+h;_&&_.cellType&&"8"===_.cellType.typeName&&(_=Object.assign({},_,{cellType:_.cellType.toJSON()})),s.collectedCells[g]?s.collectedCells[g].style=_:s.collectedCells[g]={style:_}}}}else if(0===l)this._copyCells(o,i,15867,u);else if(6===l)this._copyCells(o,i,15867,u);else if(2===l)this._copyCells(o,i,192,u);else if(3===l){if(!(1!==j(o)||1!==L(o)||-1===o.row&&-1!==o.col||-1===o.col&&-1!==o.row)){this._copyCells(o,i,187,u)}else{var d=n._getActualRange(a),p=d.row,w=d.col,v=j(d),C=L(d),R=new f(j(d),L(d),null);for(e=0;e<v;e++)for(r=0;r<C;r++)R.setStyle(e,r,n._getStyleObject(p+e,w+r));for(n.fillAuto(o,a,s),e=0;e<v;e++)for(r=0;r<C;r++)n._setStyleObject(p+e,w+r,R.getStyle(e,r))}}n._setActiveCellImp(m(t._getFirstVisualRow(),a.row),m(t._getFirstVisualColumn(),a.col),t._activeRowViewportIndex,t._activeColViewportIndex),t._selectionModel&&t._clearSelectionImp(),n.addSelection(a.row,a.col,j(a),L(a))},_copyCells:function(t,e,r,n){var o,i,l,a,s,u=this._sheet,c=u._getActualRange(t),h=u._getActualRange(e),_=c.row,g=c.col,f=j(c),d=L(c),p=h.row,w=h.col,v=j(h),C=L(h),m=this._autoFillExtent[E],R=3===m,F=1===m,S=y(v/f),A=v%f,x=y(C/d),D=C%d,T=u.hasFormula(_,g)?r:2^r;if(0===this._fillSeries){for(o=0;o<S;o++)a=R?p+o*f:p+v-(o+1)*f,u._isRowFilterOut&&u._isRowFilterOut(a)||u._copyToCore(_,g,a,w,f,d,T,!0,void 0,this._autoFillExtent.collectedCells,n);0!==A&&(i=R?_:_+(S+1)*f-v,a=R?p+f*S:p+v-S*f-A,u._isRowFilterOut&&u._isRowFilterOut(a)||(T=u.hasFormula(i,g)?r:2^r,u._copyToCore(i,g,a,w,A,d,T,!0,void 0,this._autoFillExtent.collectedCells,n)))}else{for(o=0;o<x;o++)s=F?w+o*d:w+C-(o+1)*d,u._copyToCore(_,g,p,s,f,d,T,!0,void 0,this._autoFillExtent.collectedCells,n);0!==D&&(l=F?g:g+(x+1)*d-C,s=F?w+d*x:w+C-x*d-D,T=u.hasFormula(_,l)?r:2^r,u._copyToCore(_,l,p,s,f,D,T,!0,void 0,this._autoFillExtent.collectedCells,n))}},saveState:function(){var t=this._autoFillExtent;4===t[O]?this._clearValueUndoAction.saveState():this._savedStartViewportCells=this._saveRangeStates(t[T]),this._sheet.isDirtySuspended()||(this._savedBeforeFillChangedCells=new F(this._sheet,t[b],16383)),this._savedFilledViewportCells=this._saveRangeStates(t[b])},_saveRangeStates:function(t){var e=this._sheet,r=e._getActualRange(t),n=new D(j(r),L(r));return A(e,n,r.row,r.col,16383),n},undo:function(){var t=this._sheet,e=!1;if(this.canUndo()){this._beforeAction(t,!0);try{d&&t.suspendCalcService();var r=t.getSelections(),n=this._autoFillExtent,o=t._fillDialog,l=n[b];e=4===n[O]?this._undoDragClear(t):this._undoDragFill(t),!t._skipCloseDragFillSmartTag&&o&&o.close(),x(t,l.row,l.col,j(l),L(l),this._savedAfterFilledChangedCells?this._savedAfterFilledChangedCells._getChangedCells():[],1),t._raiseSelectionChanging(r,t.getSelections())&&t._raiseSelectionChanged(r)}catch(t){(0,i.printException)(t),w(t)}finally{this._afterAction(t,!0),d&&t.resumeCalcService(!1)}}return e},_undoDragClear:function(t){var e=this._autoFillExtent[T],r=e.row,n=e.col,o=this._clearValueUndoAction.undo(t);return t._setActiveCellImp(m(t._getFirstVisualRow(),r),m(t._getFirstVisualColumn(),n),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.addSelection(r,n,j(e),L(e)),o},_undoDragFill:function(t){var e=this._autoFillExtent,r=e[T],n=r.row,o=r.col;d&&t.suspendCalcService();try{this._undoRangeStates(this._savedFilledViewportCells,e[b]),this._undoRangeStates(this._savedStartViewportCells,r),t._setActiveCellImp(m(t._getFirstVisualRow(),n),m(t._getFirstVisualColumn(),o),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.addSelection(n,o,j(r),L(r))}catch(t){(0,i.printException)(t),w(t)}finally{d&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},_undoRangeStates:function(t,e){var r=this._sheet,n=r._getActualRange(e);S._undoCellsInfo(r,t,n.row,n.col,3)}};return p.extend(e.prototype,r),e}(R),G=function(t){function e(e,r){t.call(this),this._sheet=e,this._fillExtent=r,this._startRange=r[T],this._fillRange=r[b],this._autoFillType=r[O],this._fillDirection=r[E],this._srcRange=r[I]}p.inherit(e,t);var r={execute:function(){var t=!1;if(this.canExecute()){var e=this._sheet,r=this._fillRange;this._beforeAction(e,!0);try{var n=e._eventHandler,o={sheet:e,sheetName:e._name,cancel:!1};o[b]=r,o[O]=this._autoFillType,o[E]=this._fillDirection,this._srcRange&&(o[I]=this._srcRange),e._trigger(h.DragFillBlock,o),o.cancel||(n._currentAutoFillType=o[O],n._isCancelFill=o.cancel,o.collectedCells={},this._executeFillAction(o),delete o.cancel,e._trigger(h.DragFillBlockCompleted,o),t=!0)}catch(t){(0,i.printException)(t),w(t)}finally{this._afterAction(e,!0)}}return t},_executeFillAction:function(t){var e=this._sheet,r=e._eventHandler,n=this._fillRange,o=this._autoFillType;if(r._currentAutoFillType=o,!r._isCancelFill){var i={};i[T]=this._startRange,i[b]=n,i[O]=5===t[O]?o:t[O],i[E]=this._fillDirection,i.collectedCells=t.collectedCells;var l=new W(e,i);e.suspendEvent("executeFillAction");try{l.execute()}catch(t){throw t}finally{e.resumeEvent("executeFillAction")}this._fillExtent._fillUndoActionImp=l}},saveState:function(){this._sheet.isDirtySuspended()||(this._savedBeforeFillChangedCells=new F(this._sheet,this._fillRange,16383))},undo:function(){var t=!1;if(this.canUndo()){var e=this._sheet,r=this._fillRange;this.saveState(),this._beforeAction(e);try{t=this._fillExtent._fillUndoActionImp.undo()}catch(t){(0,i.printException)(t),w(t)}finally{this._applyDataChanged(!1,e,r)}}return t},_applyDataChanged:function(t,e,r){this._afterAction(e,t);var n=[];e.isDirtySuspended()||(this._savedAfterFilledChangedCells=new F(e,r,16383),this._savedAfterFilledChangedCells._mergeCellsHasDiffData(this._savedBeforeFillChangedCells._getCellsData()),n=this._savedAfterFilledChangedCells._getChangedCells()),x(e,r.row,r.col,j(r),L(r),n,1)}};return p.extend(e.prototype,r),e}(R);function Y(t,e,r,n,o){t._clearSelectionImp(),t.addSelection(e,r,n,o);var i=e>0?e:t._getFirstVisualRow(),l=r>0?r:t._getFirstVisualColumn();t._setActiveCellImp(i,l,t._activeRowViewportIndex,t._activeColViewportIndex)}function Q(t,e){R.call(this),this._sheet=t,this._command=e}p.inherit(Q,R),p.extend(Q.prototype,{canExecute:function(){var t=this._sheet,e=this._command,r=e.fromRow,n=e.fromColumn,o=j(e),l=e.columnCount,a=e.toRow,s=e.toColumn;return!!(0,i.isValidRange)(r,n,o,l,H(t),U(t))&&(!(!e.insert&&!(0,i.isValidRange)(a,s,o,l,H(t),U(t)))&&(t._canChange(a,s,o,l,!!e.insert)&&t._canChange(r,n,o,l)))},execute:function(){var t=!1;if(this.canExecute()){var e,r,n,o=this._sheet,l=this._command,a=l.fromRow,s=l.fromColumn,u=l.toRow,c=l.toColumn,h=l.rowCount,_=l.columnCount,g=l.option,f=l.collectedCells;this._beforeAction(o,!0);try{if(l.insert){if(s>=0&&a<0){e=s,r=c,n=_;var d=c,p=o._beforeUpdateArrayExprCellsByAddCols&&o._beforeUpdateArrayExprCellsByAddCols(r,n);o.addColumns(r,n,!0),l.copy?(o.copyTo(-1,r<=e?e+n:e,-1,r,-1,n,g),o._updateArrayExprCellsByRowColOps&&p&&o._updateArrayExprCellsByRowColOps(p)):(o.moveTo(-1,r<=e?e+n:e,-1,r,-1,n,g,void 0,f),o._updateArrayExprCellsByRowColOps&&p&&o._updateArrayExprCellsByRowColOps(p),o.deleteColumns(r<=e?e+n:e,n,!0),e<r&&(d=r-n)),Y(o,-1,d,H(o),n)}else if(a>=0&&s<0){e=a,r=u,n=h;var w=u;p=o._beforeUpdateArrayExprCellsByAddRows&&o._beforeUpdateArrayExprCellsByAddRows(r,n);o.addRows(r,n,!0),l.copy?(o.copyTo(r<=e?e+n:e,-1,r,-1,n,-1,g),o._updateArrayExprCellsByRowColOps&&p&&o._updateArrayExprCellsByRowColOps(p)):(o.moveTo(r<=e?e+n:e,-1,r,-1,n,-1,g,void 0,f),o._updateArrayExprCellsByRowColOps&&p&&o._updateArrayExprCellsByRowColOps(p),o.deleteRows(r<=e?e+n:e,n,!0),e<r&&(w=r-n)),Y(o,w,-1,n,U(o))}}else l.copy?o.copyTo(a,s,u,c,h,_,g):o.moveTo(a,s,u,c,h,_,g,{row:u,col:c,rowCount:h,colCount:_},f),o&&Y(o,u,c,h,_);t=!0}catch(t){(0,i.printException)(t),Y(o,a,s,h,_),o._raiseInvalidOperation(0,"string"==typeof t?t:t.message)}finally{o._eventHandler._dragRect={},this._afterAction(o,!0)}}return t},_mergeCellsData:function(t,e,r,n,o,l,a){if(e&&e._isValueOrFormulaSaved()){var s=new F(t,(0,i._createRange)(n,o,l,a),this._command.option);return s._mergeCellsHasDiffData(r._getCellsData()),S._raiseRangeDataChanged(t,n,o,l,a,s._getChangedCells(),0),s}},saveState:function(){var t,e=this._sheet,r=this._command,n=r._state={},o=r.fromRow,l=r.fromColumn,a=r.toRow,s=r.toColumn,u=r.option,c=o<0?0:o,h=l<0?0:l,_=a<0?0:a,g=s<0?0:s,f=o<0?H(e):j(r),d=l<0?U(e):r.columnCount;if(r.insert){if(l<0&&o>=0){var p=e.tables;!r.copy&&p&&p._has(_,-1,1,-1)&&(t=k(e,c,f,u),n._savedFromRowHeaderCells=t.headerCells,n._savedFromRows=t.rows,n._savedFromViewportCells=P(e,c,h,f,d,u))}}else o<0&&(t=M(e,g,d,u),n._savedToColumnHeaderCells=t.headerCells,n._savedToColumns=t.columns,r.copy||(t=M(e,h,d,u),n._savedFromColumnHeaderCells=t.headerCells,n._savedFromColumns=t.columns)),l<0&&(t=k(e,_,f,u),n._savedToRowHeaderCells=t.headerCells,n._savedToRows=t.rows,r.copy||(t=k(e,c,f,u),n._savedFromRowHeaderCells=t.headerCells,n._savedFromRows=t.rows)),n._savedToTables=N(e,_,g,f,d),n._savedToViewportCells=P(e,_,g,f,d,u),r.copy||(n._savedFromTables=N(e,c,h,f,d),n._savedFromViewportCells=P(e,c,h,f,d,u),e.isDirtySuspended()||(n._savedFromBeforePastedChangedCells=new F(e,(0,i._createRange)(c,h,f,d),u))),e.isDirtySuspended()||(n._savedToBeforePastedChangedCells=new F(e,(0,i._createRange)(_,g,f,d),u));n._savedAcitveRowViewportIndex=e._activeRowViewportIndex,n._savedAcitveColumnViewportIndex=e._activeColViewportIndex,n._savedActiveRow=e._activeRowIndex,n._savedActiveColumn=e._activeColIndex},undo:function(){var t=0;if(this.canUndo()){var r,n,o,l=this._sheet,a=this._command,s=a.fromRow,u=a.fromColumn,c=a.toRow,h=a.toColumn,_=j(a),g=a.columnCount;if(!(0,i.isValidRange)(s,u,_,g,H(l),U(l)))return!1;if(!a.insert&&!(0,i.isValidRange)(c,h,_,g,H(l),U(l)))return!1;var f=a._state;this._beforeAction(l,!0);try{if(a.insert){if(!(u>=0&&s>=0))if(u>=0){var d=u;r=g,a.copy?l.deleteColumns(h,r):(n=h,o=u,u<h?n=h-r:o=u+r,l.addColumns(o,r),l.copyTo(-1,o<=n?n+r:n,-1,o,-1,r,a.option),l.deleteColumns(o<=n?n+r:n,r),n<o&&(d=o-r)),l&&Y(l,-1,d,H(l),r),t++}else if(s>=0){r=_;var p=s;a.copy?l.deleteRows(c,r):(n=c,o=s,s<c?n=c-r:o=s+r,l.addRows(o,r),t+=V(this,f._savedFromViewportCells),t+=V(this,f._savedFromRowHeaderCells),(t+=V(this,f._savedFromRows))||l.copyTo(o<=n?n+r:n,-1,o,-1,r,-1,a.option),l.deleteRows(o<=n?n+r:n,r),n<o&&(p=o-r)),l&&Y(l,p,-1,r,U(l)),t++}}else{var v=s<0?0:s,C=u<0?0:u,m=c<0?0:c,y=h<0?0:h,R=s<0?H(l):_,F=u<0?U(l):g;e._supportsCalc&&S._clearFormula(l,m,y,R,F);var A=null,x=null,D=f._savedFromViewportCells;!a.copy&&D&&D.data&&D.data._isValueOrFormulaSaved()&&(x=S._getValues(l,v,C,R,F));var T=f._savedToViewportCells;T&&T.data&&T.data._isValueOrFormulaSaved()&&(A=S._getValues(l,m,y,R,F)),t+=V(this,f._savedToTables),t+=V(this,f._savedToColumnHeaderCells),t+=V(this,f._savedToColumns),t+=V(this,T),t+=V(this,f._savedToRowHeaderCells),t+=V(this,f._savedToRows),t+=V(this,f._savedFromTables),t+=V(this,f._savedFromColumnHeaderCells),t+=V(this,f._savedFromColumns),t+=V(this,D),t+=V(this,f._savedFromRowHeaderCells),(t+=V(this,f._savedFromRows))&&l&&(Y(l,s,u,_,g),A&&S._raiseRangeDataChanged(l,m,y,R,F,f._savedToAfterPastedChangedCells?f._savedToAfterPastedChangedCells._getChangedCells():[],0),x&&S._raiseRangeDataChanged(l,v,C,R,F,f._savedFromAfterPastedChangedCells?f._savedFromAfterPastedChangedCells._getChangedCells():[],0))}if(t&&l){if(-1!==f._savedActiveRow&&-1!==f._savedActiveColumn){var b=l.getSelections()[0];b.contains(f._savedActiveRow,f._savedActiveColumn)?l._setActiveCellCore(f._savedActiveRow,f._savedActiveColumn):l._setActiveCellCore(b.row,b.col)}-2!==f._savedAcitveRowViewportIndex&&-2!==f._savedAcitveColumnViewportIndex&&-1!==f._savedActiveRow&&-1!==f._savedActiveColumn&&l.showCell(f._savedActiveRow,f._savedActiveColumn,3,3)}}catch(t){(0,i.printException)(t),w(t)}finally{this._afterAction(l,!0)}}return t>0}});e.sheetEx={fillAuto:function(t,e,r){if(!e)throw new Error((0,o.sR)().Exp_RangeIsNull);var n=r.fillType,i=r.series,l=r.direction,u=r.step,c=r.stop,h=r.collectedCells,_=new s.default(this,h);(function(t,e,r,n){return!!(t&&e&&e.containsRange(t))&&(!C(r)&&(1===r&&t.row===e.row&&j(t)===j(e)||0===r&&t.col===e.col&&L(t)===L(e))||!(C(n)||(2!==n&&3!==n||t.col!==e.col||L(t)!==L(e))&&(0!==n&&1!==n||t.row!==e.row||j(t)!==j(e))))})(t,e,l?null:i,l)&&(t&&(this._eventHandler._fillStartRange=t),4===n?_._fillAuto(e,i,!1,r.withTag):0===n?_._fillAutoByDirection(e,l):1===n||2===n?_._fillLinearOrGrowth(1===n,e,i,u,c):3===n&&_._seriesFillRange(e,i,3,u,C(c)?null:a.default._DateTimeHelper._toOADate(c),r.unit),this._invalidate())}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4),o=r(1),i=r.n(o),l=r(0),a=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),s=i.a.GC$,u=i.a._BaseDialog,c=l._getPreferredZIndex,h=l.device,_=s(document),g=" btn btn-default",f="sm-sheet-fill-type-item",d="sm-sheet-fill-menu-container",p="ui-icon ui-icon-check sm-sheet-check-image",w="sm-sheet-menu-item-input",v="ui-state-active sm-sheet-smart-tag-active",C="sm-sheet-tag-container",m="float",y="left",R="display",F="width",S="height",A="margin";function x(t,e,r,n,o,i){var a=t._isTouchMode,u=a?"160px":"150px",c=a?"25px":"20px",h=s(Object(l.createElement)("div")).css([R,F,S,"padding",A],["block",u,c,0,0]).addClass("sm-sheet-smartMenu-item-default "+r+" ui-state-default"+g),_=s(Object(l.createElement)("div")).addClass(w).appendTo(h),f=s(Object(l.createElement)("div")).addClass("sm-sheet-menu-item-text").appendTo(h),d=s(Object(l.createElement)("input")).attr({id:e,value:o,type:"radio",name:"fill-group",style:"display:none"}).appendTo(_);return s(Object(l.createElement)("span")).text(n).appendTo(f),i?(_.addClass(p),d.prop("checked","checked")):d.prop("checked",""),h}var D=function(t){function e(e,r){var o=t.call(this,e,c(r.parent._host))||this;o._sheet=r,o._smartTagContainer=s("."+C);var i=o._menuContainer=o._getContainer();return i.addClass(d),x(r,"smartMenuCopyCells",f,Object(n.sR)().CopyCells,"0",!0).appendTo(i),x(r,"smartMenuFillSeries",f,Object(n.sR)().FillSeries,"1").appendTo(i),x(r,"smartMenuFillFormattingOnly",f,Object(n.sR)().FillFormattingOnly,"2").appendTo(i),x(r,"smartMenuFillWithoutFormatting",f,Object(n.sR)().FillWithoutFormatting,"3").appendTo(i),o}return a(e,t),e.prototype._attachEvent=function(){var t=this;s("."+f).bind("mouseover",function(t){s(t.elementItem).addClass("ui-state-hover sm-sheet-smartMenu-item-hover")}).bind("mouseout",function(t){s(t.elementItem).removeClass("ui-state-hover sm-sheet-smartMenu-item-hover")}).bind("click",function(e){var r=s(e.elementItem),n=t._smartTagContainer,o=r.find("input[type=radio]"),i=o[0];i.checked=!0,o.trigger("change"),n.trigger("click"),n.trigger("mouseout"),r.removeClass("ui-state-hover sm-sheet-smartMenu-item-hover");var l=parseInt(s(i).attr("value"));t._changeFill(l)}),this._menuContainer.find("input[type=radio]").bind("change",function(t){s("."+w).removeClass(p),s(t.elementItem).parent().addClass(p)})},e.prototype._dettachEvent=function(){s("."+f).unbind("mouseover").unbind("mouseout").unbind("click"),this._menuContainer.find("input[type=radio]").unbind("change")},e.prototype._changeFill=function(t){var e=this._sheet,r=e._eventHandler;this._fillType!==t&&(this._fillType=t,e._skipCloseDragFillSmartTag=!0,e._skipCloseDragFillSmartTag=!1,e._commandManager().execute({cmd:"fill",sheetName:e.name(),startRange:r._fillStartRange,fillRange:r._currentFillRange,autoFillType:t,fillDirection:r._currentFillDirection}),this._smartTagContainer.trigger("fillTypeChanged",t))},e.prototype._isOpen=function(){return!!s("."+d).length},e}(u);function T(t){return t?"data:image/png;base64,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":"data:image/png;base64,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"}var b=function(t){function e(e,r,n){var o=t.call(this,e,c(r.parent._host))||this;o._sheet=r,o._fillInfo=n;var i=o._tagContainer=o._getContainer().addClass("sm-sheet-smart-tag-default "+C+" sm-sheet-no-select ui-widget-header"+g);return o._smartTag=s(Object(l.createElement)("img")).attr("src",T(0)).css(m,y).appendTo(i),o._smartTagDown=s(Object(l.createElement)("img")).attr("src",T(1)).css([m,R],[y,"none"]).appendTo(i),o}return a(e,t),e.prototype._doMouseEvent=function(t,e,r){var n=this._sheet._isTouchMode,o=s(e),i=this._menuDialog,l=this._smartTagDown,a=n?"38px":"32px",u=n?"24px":"18px";i&&i._isOpen()||(t?o.addClass("ui-state-hover sm-sheet-smart-tag-hover"):o.removeClass("ui-state-hover sm-sheet-smart-tag-hover"),o.css([F,S],[t?a:u,u]),r||(t?l.show():l.hide()))},e.prototype._registerEvent=function(){var t=this,e=t._tagContainer,r=h(),n=l.browser.safari&&(r.ipad||r.iphone);e.bind("mouseover",function(e){t._doMouseEvent(!0,e.elementItem,n)}).bind("mouseout",function(e){t._doMouseEvent(!1,e.elementItem,n)}),e.bind("click",function(e){var r=s(e.elementItem),o=t._menuDialog,i=t._smartTagDown;if(o&&o._isOpen())n&&i.hide(),r.removeClass(v),t._closeMenu();else{n&&i.show(),r.addClass(v),t._openMenu();var l=t._menuContainer,a=l&&l.find("input[type=radio]")[t._fillInfo.fillType];a&&!a.checked&&(a.checked=!0,s(a).trigger("change"))}}),_.bind("keydown.ui-fill",function(e){27===e.keyCode&&(t._menuDialog&&t._menuDialog._isOpen()?t._closeMenu():t.close(),Object(l.cancelDefault)(e))})},e.prototype._open=function(){var t=this._tagContainer,e=this._fillInfo,r=this._sheet._isTouchMode,n=r?"3px":"0px",o=r?"24px":"18px";t&&(t.css([y,"top"],[e.x,e.y])(this)._show(),this._registerEvent(),this._smartTag.css(A,n),this._smartTagDown.css(S,o),this._reset())},e.prototype._openMenu=function(){var t=this._sheet;this._menuDialog||(this._menuDialog=new D(t.parent._getContainerDiv(),t),this._menuContainer=this._menuDialog._getContainer());var e=this._tagContainer,r=e.css(y),n=e.css("top"),o=parseFloat(n),i=this._menuDialog,l=this._fillInfo;i._fillType=l.fillType,isNaN(o)||(n=o+e.height()+2),this._menuContainer.css([y,"top"],[r,n]),i._show(),i._attachEvent(),i._smartTagContainer.unbind("fillTypeChanged").bind("fillTypeChanged",function(t,e){l.fillType=e})},e.prototype._closeMenu=function(){var t=this._menuDialog;t&&(t._dettachEvent(),t.close())},e.prototype._reset=function(){var t=this._menuDialog,e=this._tagContainer;t&&(t._isOpen()&&e.trigger("click"),e.trigger("mouseout"))},e.prototype.close=function(){var e=this._sheet;this._reset(),_.unbind("keydown.ui-fill"),t.prototype.close.call(this),e&&e._setFocus()},e}(u);e.default=b},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"state",function(){return o}),r.d(e,"STATES",function(){return i});var n=r(3),o=(0,r.n(n).a.makeState)(),i={dragFillIndicatorRect:"_dragFillIndicatorRect",dragOldRect:"_dragOldRect",insertDragRect:"_insertDragRect"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._paintDragFillIndicator=function(t,e,r,n,o,s){var c=t._sheet,h=c._getSheetLayout(),_=c.parent,g=_&&_._themeVersion,f=function(t,e,r){var n=t._sheet,o=e.x,i=e.y,l=e.width,s=e.height,u=n._getActiveSelectedRange(),c=n._getSheetLayout(),h=4,_=-2.5;r>2007&&(h=5,_=-3);var g=new a(-4,-4,h,h);-1===u.col?(g.x=c._frozenX,g.y=i+s+_):-1===u.row?(g.x=o+l+_,g.y=c._frozenY):(g.x=o+l+_,g.y=i+s+_);return g}(t,o,g),d=f.x,p=f.y,w=f.width,v=f.height,C=h._viewportRect(r,n);if((!s||f.intersectRect(s))&&f.intersectRect(C)){var m=-1.5;g>2007&&(m=-1);var y=new a(d+m,p+m,w+2,v+2);y.x=Math.max(y.x,C.x),y.y=Math.max(y.y,C.y),t._commitPaintSync([u({rect:y})]),e.save(),s&&!s.containsRect(f)&&(e.rect(s.x,s.y,s.width,s.height),e.clip()),e.beginPath(),e.fillStyle=Object(l._getColor)(c,c.getSelectionBorderColor()),e.fillRect(d,p,w,v),Object(i.state)(i.STATES.dragFillIndicatorRect,new a(f.x,f.y,4,4)),e.beginPath(),e.restore()}},e._paintDragRectangle=function(t,e){var r=e.x,n=e.y,o=r+e.width,i=n+e.height;p(t,r,n,o,n),p(t,r,i,o,i),p(t,r,n,r,i),p(t,o,n,o,i)},e._paintDragInsertLine=_,e._paintDragDropRectangle=g,e._paintDragDropIndicator=d,e._refreshDragDropIndicator=function(t){var e=t._sheet,r=e._currentTarget;if(!r||!r.dragInfo)return;var n=t._getCtx(),o=e._getSheetLayout(),l=e._eventHandler._actualDragRange,s=e._eventHandler._dragRect;-1===s.row&&(s.col=l.col);-1===s.col&&(s.row=l.row);var u=e._getRangeWholeRect(l),c=e.frozenTrailingColumnCount(),h=e.frozenTrailingRowCount(),_=e.getColumnCount()-c,g=e.getRowCount()-h,f=o._viewportRect(1,1);c>0&&l.col+l.colCount<=_&&u.x+u.width>f.x+f.width&&u.intersectRect(f)&&(u=u.getIntersectRect(f));h>0&&l.row+l.rowCount<=g&&u.y+u.height>f.y+f.height&&u.intersectRect(f)&&(u=u.getIntersectRect(f));var p=new a(o._frozenX,o._frozenY,o._frozenTrailingX+o._frozenTrailingWidth,o._frozenTrailingY+o._frozenTrailingHeight);u.width>0&&u.height>0?(s.x=u.x,s.y=u.y,s.width=u.width-1,s.height=u.height-1,d(t,n,p)):0!==u.width&&0!==u.height||(s.x=u.x,s.y=u.y,s.width=u.width,s.height=u.height,d(t,n,p));!0===e._eventHandler._isDragInsert?Object(i.state)(i.STATES.dragOldRect,Object(i.state)(i.STATES.insertDragRect)):Object(i.state)(i.STATES.dragOldRect,new a(s.x,s.y,s.width,s.height))};var n=r(1),o=r.n(n),i=r(11),l=r(0),a=o.a.Rect,s=o.a._createLine,u=o.a._Directive_CopyBuffer,c=o.a._Directive_RepaintSelection,h="#71a1e6";function _(t,e){t.save(),t.strokeStyle=h,t.beginPath();var r=0===e.height?.1:e.height,n=0===e.width?.1:e.width;t.rect(e.x,e.y,n,r),t.closePath(),t.lineWidth=2,t.lineJoin="miter",t.stroke(),t.restore()}function g(t,e){t.save(),t.strokeStyle=h,t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.closePath(),t.lineWidth=2,t.lineJoin="miter",t.setLineDash([4,4]),t.stroke(),t.restore()}function f(t,e,r){var n=t._sheet;t._commitPaintSync([u({rect:e,clipRect:r}),c({range:n._getActiveSelectedRange(),clipRect:r})])}function d(t,e,r){var n=t._sheet,o=n._eventHandler._dragRect,l=o.hitTarget;if(o&&l){var s=o.hitCol,u=o.hitRow,c=n._eventHandler._isDragInsert,h=Object(i.state)(i.STATES.dragOldRect);if(e.save(),!0!==c||-1!==o.row&&-1!==o.col)h&&f(t,new a(h.x-2,h.y-2,h.width+4,h.height+4),r),g(e,o);else if(-1===o.row&&-1!==o.col){var d=n._getColumnLayout(0).findCol(s);if(d||(d=n._getColumnLayout(1).findCol(s)),d||(d=n._getColumnLayout(2).findCol(s)),d){var p=d.x,w=d.width;o.col=s,l.x>p+w/2&&(o.col<n._getLastFullyVisibleColumn()||o.col===n._getLastVisualColumn())&&(p=d.x+d.width,o.col++),h&&0===h.width||(h=n._eventHandler._dragRect),h&&f(t,new a(h.x-2,h.y-2,h.width+4,h.height+4),r);var v=new a(p,o.y,0,o.height);Object(i.state)(i.STATES.insertDragRect,v),_(e,v)}}else if(-1!==o.row&&-1===o.col){var C=n._getRowLayout(0).findRow(u);if(C||(C=n._getRowLayout(1).findRow(u)),C||(C=n._getRowLayout(2).findRow(u)),C){var m=C.y,y=C.height;o.row=u,l.y>m+y/2&&(o.row<n._getLastFullyVisibleRow()||o.row===n._getLastVisualRow())&&(m=C.y+C.height,o.row++),h&&0===h.height||(h=n._eventHandler._dragRect),h&&f(t,new a(h.x-2,h.y-2,h.width+4,h.height+4),r);v=new a(o.x,m,o.width,0);Object(i.state)(i.STATES.insertDragRect,v),_(e,v)}}e.beginPath(),e.restore()}}function p(t,e,r,n,o){var i;t.globalCompositeOperation="source-over",t.strokeStyle=h,t.save(),e===n?(t.rect(e-2,r,7,Math.abs(o-r)),t.clip(),t.beginPath(),r<o?(r-=3,o+=3):(r+=3,o-=3),i=s(e,r,n,o,"black",2)):r===o&&(t.rect(e,r-2,Math.abs(n-e),7),t.clip(),t.beginPath(),e<n?(e-=3,n+=3):(e+=3,n-=3),i=s(e,r,n,o,"black",1)),i._paintLine(t),t.stroke(),t.beginPath(),t.restore()}},function(t,e,r){"use strict";r.d(e,"a",function(){return n}),r.d(e,"d",function(){return o}),r.d(e,"e",function(){return i}),r.d(e,"f",function(){return l}),r.d(e,"c",function(){return a}),r.d(e,"b",function(){return s});var n={copyCells:0,fillSeries:1,fillFormattingOnly:2,fillWithoutFormatting:3,clearValues:4,auto:5},o={left:0,right:1,up:2,down:3},i={column:0,row:1},l={direction:0,linear:1,growth:2,date:3,auto:4},a={day:0,weekday:1,month:2,year:3},s={FILL:"fill",DRAG_DROP:"dragDrop"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.install=function(t){Object(n._CopyProperty)(t.Worksheet.prototype,o.sheetEx),Object(n._CopyProperty)(t.Worksheet.prototype,i.sheetEx),Object(n._CopyProperty)(t._SheetEventHandler.prototype,i.sheetEventHandlerExt),Object(h.a)(),Object(c.a)(),d("Fill")},e.initSpread=function(t){var e=t.getActiveSheet();e&&Object(o.regiterCmds)(e._commandManager())},r.d(e,"SR",function(){return p}),r.d(e,"_FillDialog",function(){return w}),r.d(e,"_FillImp",function(){return v});var n=r(0),o=r(9),i=(r.n(o),r(22)),l=(r.n(i),r(4)),a=r(10),s=r(7),u=r.n(s),c=r(23),h=r(24),_=r(1),g=r.n(_),f=r(13);r.d(e,"AutoFillType",function(){return f.a}),r.d(e,"FillDirection",function(){return f.d}),r.d(e,"FillSeries",function(){return f.e}),r.d(e,"FillType",function(){return f.f}),r.d(e,"FillDateUnit",function(){return f.c}),r.d(e,"COMMANDS",function(){return f.b});var d=g.a.activateFeatures;var p=l.SR,w=a.default,v=u.a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={CopyCells:"Copy Cells",FillSeries:"Fill Series",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",Exp_NumberOnly:"Only works for Numbers",Exp_RangeContainsMergedCell:"Range should not have merged cells.",Exp_TargetContainsMergedCells:"Target range should not have merged cells.",Exp_MergedCellsIdentical:"This operation requires the merged cells to be identically sized.",Exp_FillRangeContainsMergedCell:"There are merged cells in target range, please unmerge cells and then drag fill range.",Exp_FillCellsReadOnly:"The cells you are trying to fill are protected and therefore read-only.",Exp_ChangeMergedCell:"Cannot change part of merged cell.",Exp_ColumnReadOnly:"The column you are trying to change is protected and therefore read-only.",Exp_RowReadOnly:"The row you are trying to change is protected and therefore read-only.",Exp_CellReadOnly:"The cell you are trying to change is protected and therefore read-only.",Exp_RangeIsNull:"range is null",Exp_ChangePartOfArray:"Cannot change part of an array."}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(17),o=r(18),i=r(19),l=r(20),a=r(21);r.d(e,"NumberSource",function(){return n.a}),r.d(e,"DaySource",function(){return o.a}),r.d(e,"MonthSource",function(){return i.a}),r.d(e,"SerialStringSource",function(){return l.a}),r.d(e,"DateSource",function(){return a.a})},function(t,e,r){"use strict";var n=r(5),o=r(0),i=r(3),l=r.n(i),a=r(2),s=r.n(a),u=r(4),c=r(6),h=r.n(c),_=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),g=l.a._isNullOrUndefined,f=l.a._toDouble,d=s.a._trendSerial,p=s.a._trend,w=h.a.Convert,v=function(t){function e(e){var r=t.call(this,e)||this;return r._indexes=[],r._innerValues=[],r._type=null,r._startIndex=g(e)?-1:e,r}return _(e,t),e.prototype.increase=function(t,e){var r=Object(o.getValType)(t);if(this._isSerialNumber(r)){var n=t.split(".");return n[n.length-1]=String(+n[n.length-1]+e),n.join(".")}return t+e},e.prototype.trend=function(t,e,r,n,o,i,l,a){var s=[t,e,r,n,o,i,l,a];return this._isSerialNumber()?d.apply(null,s):p.apply(null,s)},e.prototype._values=function(){var t,e,r=[],n=this._innerValues,o=n?n.length:0;for(t=0;t<o;t++)e=n[t],r.push("object"===this._type?this._toDateTime(e):e);return r},e.prototype._insert=function(t,e,r){var n=r;if(!Object(o.isNumber)(n))throw new Error(Object(u.sR)().Exp_NumberOnly);g(this._type)&&(this._type=Object(o.getValType)(n)),this._isSerialNumber()||(n=f(n)),this._indexes.splice(t,0,e),this._innerValues.splice(t,0,n)},e.prototype.add=function(t,e){var r=e;g(this._type)&&(this._type=Object(o.getValType)(r)),this._isSerialNumber()||(r=f(r)),this._indexes.push(t),this._innerValues.push(r)},e.prototype._toActualValue=function(t){return this._type===o.DATE_STRING?this._toDateTime(t):t},e.prototype._toDateTime=function(t){var e=null;if(t instanceof Date)e=t;else if(w)try{e=w._toDateTime(t)}catch(r){Object(o.printException)(r),e=t}return e},e.prototype._isSerialNumber=function(t){return-1!==(t=t||this._type).indexOf(o.SER_NUMBER_STRING)},e}(n.a);e.a=v},function(t,e,r){"use strict";var n=r(5),o=r(0),i=r(3),l=r.n(i),a=r(2),s=r.n(a),u=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),c=s.a._DayList,h=s.a._DayListAlias,_=s.a._DayLen,g=s.a._getDayByIndex,f=l.a._isNullOrUndefined,d=function(t){function e(e){var r=t.call(this,e)||this;return r._indexes=[],r._innerValues=[],r._type=null,r._useSundayAlias=!1,r._startIndex=f(e)?-1:e,r._days=c,r._dayAlias=h,r._dayLength=_,r._SundayAlias="天",r}return u(e,t),e.prototype.valueConverter=function(){var t,e,r=this,n=this._innerValues;return n&&n.length?n.map(function(n,o){if(n=r._getDayNumber(String(n)),e=r._useSundayAlias?r._dayAlias.indexOf(String(n)):r._days.indexOf(String(n)),t=0===o?e:t,o>0)for(;e<t;)e+=r._dayLength;return e}):null},e.prototype.getTrendOrGrowthValue=function(e,r,n,o){if(o=o||this.valueConverter(),n=n||this._indexes2(),e&&o&&n){var i=o.length%this._dayLength||this._dayLength;o=o.slice(0-i),n=n.slice(0-i)}return t.prototype.getTrendOrGrowthValue.call(this,e,r,n,o)},e.prototype.increase=function(t,e){var r=this._getDayNumber(t),n=r===this._SundayAlias?6:this._days.indexOf(r);return n+=e,(this._type===o.DATE_STRING?t.slice(0,2):t[0])+g(n)},e.prototype.add=function(e,r){this._useSundayAlias||this._getDayNumber(r)!==this._SundayAlias||(this._useSundayAlias=!0),t.prototype.add.call(this,e,r)},e.prototype.resultConverter=function(t){var e=g(t,this._useSundayAlias);return e?e=this._type===o.DAY_STRING?"星期"+e:"周"+e:null},e.prototype._getDayNumber=function(t){return t[t.length-1]},e}(n.a);e.a=d},function(t,e,r){"use strict";var n=r(5),o=r(3),i=r.n(o),l=r(2),a=r.n(l),s=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),u=a.a._getMonthByIndex,c=a.a._MonthListAlias,h=a.a._MonthList,_=i.a._isNullOrUndefined,g=function(t){function e(e){var r=t.call(this,e)||this;return r._monthInNumber=!1,r._MonthLen=12,r._indexes=[],r._innerValues=[],r._type=null,r._startIndex=_(e)?-1:e,r}return s(e,t),e.prototype.increase=function(t,e){t=this._getMonthNumber(t);var r=this._isMonthInNumber(t),n=r?c.indexOf(t):h.indexOf(t);return u(n+e,r)+"月"},e.prototype.add=function(e,r){!this._monthInNumber&&this._isMonthInNumber(r)&&(this._monthInNumber=!0),t.prototype.add.call(this,e,r)},e.prototype.valueConverter=function(){var t,e,r=this,n=this._innerValues;return n&&n.length?n.map(function(n,o){if(n=String(n).replace("月",""),e=r._isMonthInNumber(n)?c.indexOf(n):h.indexOf(n),t=0===o?e:t,o>0)for(;e<t;)e+=r._MonthLen;return e}):null},e.prototype.getTrendOrGrowthValue=function(e,r,n,o){if(o=o||this.valueConverter(),n=n||this._indexes2(),e&&o&&n){var i=o.length%this._MonthLen||this._MonthLen;o=o.slice(0-i),n=n.slice(0-i)}return t.prototype.getTrendOrGrowthValue.call(this,e,r,n,o)},e.prototype.resultConverter=function(t){var e;return(e=u(t,this._monthInNumber))?e+"月":null},e.prototype._isMonthInNumber=function(t){return/^\d/.test(t.replace("月",""))},e.prototype._getMonthNumber=function(t){return t.replace("月","")},e}(n.a);e.a=g},function(t,e,r){"use strict";var n=r(5),o=r(3),i=r.n(o),l=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),a=i.a._isNullOrUndefined,s=function(t){function e(e){var r=t.call(this,e)||this;return r._indexes=[],r._innerValues=[],r._type=null,r._prefixReg=/\d+$/,r._startIndex=a(e)?-1:e,r}return l(e,t),e.prototype.valueConverter=function(){var t=this,e=this._innerValues;if(e&&e.length){var r=[];return e.forEach(function(e){var n=t.getPrefixRegMatch(String(e));n&&n[0]&&r.push(Number(n[0]))}),r}return null},e.prototype.increase=function(t,e){var r=this.getPrefixRegMatch(t);return r?t.slice(0,r.index)+(Number(r[0])+e):null},e.prototype.patternMatch=function(t){if(!this._dataCount())return!0;var e=this.getInvalidZeroCnt(String(this._innerValues[0])),r=this.getInvalidZeroCnt(t),n=e!==r&&0!==e&&0!==r;return this.getPrefix(String(this._innerValues[0]))===this.getPrefix(t)&&!n},e.prototype.resultConverter=function(t){t=Math.abs(Number(t)).toString();for(var e=this.getPrefix(String(this._innerValues[0])),r=String(this._innerValues[0]).replace(e,"");t.length<r.length;)t="0"+t;return e+t},e.prototype.getPrefix=function(t){var e=this.getPrefixRegMatch(t);return e?t.slice(0,e.index):""},e.prototype.getInvalidZeroCnt=function(t){for(var e=this.getPrefixRegMatch(t),r=0,n=e&&e[0];n&&"0"===n[r];)r++;return r},e.prototype.getPrefixRegMatch=function(t){return t.match(this._prefixReg)},e}(n.a);e.a=s},function(t,e,r){"use strict";var n=r(5),o=r(0),i=r(3),l=r.n(i),a=r(2),s=r.n(a),u=r(4),c=r(6),h=r.n(c),_=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),g=l.a._isNullOrUndefined,f=l.a._toDouble,d=s.a._trend,p=s.a._DateTimeHelper,w=h.a.Convert,v=function(t){function e(e){var r=t.call(this,e)||this;return r._indexes=[],r._innerValues=[],r._type=o.DATE_STRING,r._startIndex=g(e)?-1:e,r}return _(e,t),e.prototype.increase=function(t,e){return t+e},e.prototype.trend=function(t,e,r,n,i,l,a,s){for(var u,c=[],h=[],_=[],g=[],f=0,w=t[0].length;f<w;f++)t[0][f]=Math.floor(t[0][f]),u=this._toDateTime(t[0][f]),c.push(u.getFullYear()),h.push(u.getMonth()+1),g.push(12*u.getFullYear()+u.getMonth()+1),_.push(u.getDate());var v=Object(o.isAllSame)(c),C=Object(o.isAllSame)(h);if(!(!Object(o.isAllSame)(_)||v&&C)){var m=[],y=_[0],R=e[0].length,F=e[0][R-1],S=(F-e[0][0])/(R-1);if(v&&!C)if(Object(o.isSameStep)(h))for(var A=c[0],x=h[1]-h[0],D=0,T=r[0];D<T.length;D++){(B=((k=T[D])-F)/S*x+h[h.length-1])>12&&(A+=Math.floor(B/12),B%=12),m.push([p._toOADate(new Date(A,B-1,y))])}else m=this._copyFromKnowY(t,e,r);else if(!v&&C)if(Object(o.isSameStep)(c))for(var b=c[1]-c[0],O=0,E=r[0];O<E.length;O++){var I=((k=E[O])-F)/S*b+c[c.length-1];m.push([p._toOADate(new Date(I,h[0]-1,y))])}else m=this._copyFromKnowY(t,e,r);else if(Object(o.isSameStep)(g)){A=c[c.length-1],x=g[1]-g[0];for(var V=0,M=r[0];V<M.length;V++){(B=((k=M[V])-F)/S*x+h[h.length-1])>12&&(A+=Math.floor(B/12),B%=12),m.push([p._toOADate(new Date(A,B-1,y))])}}else if(Object(o.isSameStep)(c)&&Object(o.isSameStep)(h)){x=h[1]-h[0],b=c[1]-c[0];for(var P=0,N=r[0];P<N.length;P++){var k,B;I=((k=N[P])-F)/S*b+c[c.length-1];(B=(k-F)/S*x+h[h.length-1])>12&&(I+=Math.floor(B/12),B%=12),m.push([p._toOADate(new Date(I,B-1,y))])}}else m=this._copyFromKnowY(t,e,r);return m}if(!Object(o.isSameStep)(t[0]))return this._copyFromKnowY(t,e,r);var j=[t,e,r,n,i,l,a,s];return d.apply(null,j)},e.prototype._copyFromKnowY=function(t,e,r){for(var n=[],o=0,i=r[0].length;o<i;o++)n.push([t[0][(r[0][o]-e[0][0])%e[0].length]]);return n},e.prototype._values=function(){for(var t=[],e=this._innerValues,r=e?e.length:0,n=0;n<r;n++)t.push(e[n]);return t},e.prototype._insert=function(t,e,r){var n=r;if(!Object(o.isNumber)(n))throw new Error(Object(u.sR)().Exp_NumberOnly);g(this._type)&&(this._type=Object(o.getValType)(n)),this._indexes.splice(t,0,e),this._innerValues.splice(t,0,f(n))},e.prototype.add=function(t,e){var r=e;g(this._type)&&(this._type=Object(o.getValType)(r)),this._indexes.push(t),this._innerValues.push(f(r))},e.prototype._toActualValue=function(t){return this._toDateTime(t)},e.prototype._toDateTime=function(t){var e=null;if(t instanceof Date)e=t;else if(w)try{e=w._toDateTime(t)}catch(r){Object(o.printException)(r),e=t}return e},e}(n.a);e.a=v},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sheetEx=e.sheetEventHandlerExt=void 0;var n=r(4),o=g(r(10)),i=r(11),l=r(12),a=g(r(1)),s=g(r(6)),u=g(r(2)),c=g(r(7)),h=g(r(8)),_=r(0);function g(t){return t&&t.__esModule?t:{default:t}}var f=a.default._Directive_CopyBuffer,d=a.default._Directive_RepaintSelection,p=a.default.GC$,w=_._createRange,v=a.default._supportsCalc,C=a.default.Events,m=u.default._Types._isNullOrUndefined,y=a.default._getFeatureManager,R=a.default.HookNames,F=y("Worksheet"),S=Math.min,A=Math.abs,x=Math.max,D="drag";function T(t){return t.rowViewportIndex}function b(t){return t.colViewportIndex}function O(t){return t.hitTestType}function E(t,e){return t.getRowCount(e)}function I(t,e){return t.getColumnCount(e)}function V(t){return t.colCount}function M(t){return t.rowCount}function P(t,e,r,n,o,i,l,a,s,u,c,h){var _=e?C.DragDropBlock:C.DragDropBlockCompleted,g={sheet:t,sheetName:t._name,fromRow:r,fromCol:n,toRow:o,toCol:i,rowCount:l,colCount:a,copy:s,insert:u,copyOption:c,collectedCells:h},f=e?"dragDropBlock":"dragDropBlockCompleted";return e&&(g.cancel=!1),F.callHook(R.Worksheet[f],this,g),t._trigger(_,g),g.cancel}function N(t){var e=t.sheet,r=t.fromRow,o=t.fromCol,i=t.rowCount,l=t.colCount,a=t.toRow,s=t.toCol,u=t.isDragInsert,c=t.isDragCopy,h=e.options.dragDropCopyToOptions||16383,_={},g="",f=3,d=!1,p=!1,m=!1;if(e._trigger(C.BeforeDragDrop,t),!(g=t.invalidMessage)||0===g.length){var y=e._getActualRange(w(r,o,i,l)),R=e._getActualRange(w(a,s,i,l)),F=!e.isRangeEditable(y),S=!e.isRangeEditable(R);(F||S)&&(d=!0,e.parent.options.showPermissionError&&e.parent.options.showPermissionError({ranges:F?[y]:[R]})),!u||-1!==r&&-1!==o?a===r&&s===o||((e._hasPartSpans(r,o,i,l)||e._hasPartSpans(a,s,i,l))&&(d=!0,g=(0,n.sR)().Exp_ChangeMergedCell),d||v&&(e._hasPartArrayFormulas(r,o,i,l)||e._hasPartArrayFormulas(a,s,i,l))&&(d=!0,f=4,g=(0,n.sR)().Exp_ChangePartOfArray),d||(c||e.isRangeReadable(y)?c||e.isRangeEditable(R)||(e.parent.options.showPermissionError&&e.parent.options.showPermissionError({ranges:[R]}),p=!0):(e.parent.options.forbidCopyCallback&&e.parent.options.forbidCopyCallback(),p=!0)),d||(p||(p=P(e,!0,r,o,a,s,i,l,c,!1,h,_)),p||(m=e._commandManager().execute({cmd:"dragDrop",sheetName:e.name(),fromRow:r,fromColumn:o,toRow:a,toColumn:s,rowCount:i,columnCount:l,copy:c,insert:!1,option:h,collectedCells:_}))&&P(e,!1,r,o,a,s,i,l,c,!1,h,_))):o>=0&&r<0?(c&&(s<=o||s>=o+l)||!c&&(s<o||s>o+l))&&((e._hasPartSpans(-1,o,-1,l)||e._hasPartSpans(-1,s,-1,0))&&(d=!0,g=(0,n.sR)().Exp_ChangeMergedCell),d||(p=P(e,!0,-1,o,-1,s,-1,l,c,!0,h,_))||(m=e._commandManager().execute({cmd:"dragDrop",sheetName:e.name(),fromRow:-1,fromColumn:o,toRow:-1,toColumn:s,rowCount:-1,columnCount:l,copy:c,insert:!0,option:h,collectedCells:_}))&&P(e,!1,-1,o,-1,s,-1,l,c,!0,h,_)):r>=0&&o<0&&(c&&(a<=r||a>=r+i)||!c&&(a<r||a>r+i))&&((e._hasPartSpans(r,-1,i,-1)||e._hasPartSpans(a,-1,0,-1))&&(d=!0,g=(0,n.sR)().Exp_ChangeMergedCell),d||(p=P(e,!0,r,-1,a,-1,i,-1,c,!0,h,_))||(m=e._commandManager().execute({cmd:"dragDrop",sheetName:e.name(),fromRow:r,fromColumn:-1,toRow:a,toColumn:-1,rowCount:i,columnCount:-1,copy:self._isDragCopy,insert:!0,option:h,collectedCells:_}))&&P(e,!1,r,-1,a,-1,i,-1,c,!0,h,_))}m||(self._dragRect={},e.repaint()),d&&g&&e._raiseInvalidOperation(f,g)}e.sheetEventHandlerExt={_startDragDropping:function(t){if(!this._isDragDropping){var e=this._sheet,r=e._getCanvas();r&&(r.style.cursor="-webkit-grabbing");var n=null;if(1===e._selectionModel.length?n=e._selectionModel.data[0]:e._selectionModel.length<1&&(n=e._getSpanModel().get(e._activeRowIndex,e._activeColIndex)),n){this._isDragDropping=!0;var o,i=e._getActiveSelectedRange(),l=-1===i.row||-1===i.col;this._isDragInsert=l&&!this.shift,this._isWorking=!0,this._dragDropFromRange=n,o=-1===t.rowViewportIndex||-1===t.rowViewportIndex?e.getRangeRect(1,1,n):e.getRangeRect(T(t),b(t),n);var a=this._dragRect;a.x=o.x,a.y=o.y,a.width=o.width-1,a.height=o.height-1,a.row=n.row,a.col=n.col,a.rowCount=M(n),a.colCount=V(n);var s=e._getActualRange(n),u=t.row,c=t.col;u<s.row&&(u=s.row),u>=s.row+M(s)&&(u=s.row+M(s)-1),c<s.col&&(c=s.col),c>=s.col+V(s)&&(c=s.col+V(s)-1),a.hitRow=u,a.hitCol=c,a.rowOffset=u-s.row,a.colOffset=c-s.col,this._startHitInfo={_scrollRowViewportIndex:T(t),_scrollColViewportIndex:b(t),_hitTestType:O(t)},this._startScroll()}}},_continueDragDropping:function(){if(this._startHitInfo&&this._isWorking&&this._isDragDropping&&this._dragDropFromRange){var t=this._mousePosition,e=this._dragRect,r=e.width/2,n=e.x+r,o=e.height/2,i=e.y+o;e.hitTarget={x:t.x,y:t.y};var l=this._getHitRowIndex(),a=this._getHitColumnIndex(),s=!1;(A(n-t.x)>r+5||A(i-t.y)>o+5)&&(s=!0),l>=0&&a>=0&&s&&this._updateDragDropRect(l,a),this._continueScroll()}},_updateDragDropRect:function(t,e){if(this._isDragDropping&&this._dragDropFromRange){var r=this._sheet,n=this._dragRect,o=r._getActiveSelectedRange();-1===o.row&&-1!==o.col?(n.row=-1,n.col=x(0,S(I(r)-V(n),e-n.colOffset))):-1!==o.row&&-1===o.col?(n.row=x(0,S(E(r)-M(n),t-n.rowOffset)),n.col=-1):(n.row=n.row<0?-1:x(0,S(E(r)-M(n),t-n.rowOffset)),n.col=n.col<0?-1:x(0,S(I(r)-V(n),e-n.colOffset))),n.hitRow=t,n.hitCol=e;var i=r._getActualRange(n),a=this._oldDragRange;if(!(a&&i.row===a.row&&i.col===a.col&&M(i)===M(a)&&V(i)===V(a)&&i.row>r._getFirstVisualRow()&&i.col>r._getFirstVisualColumn()&&i.row+M(i)-1<r._getLastVisualRow()&&i.col+V(i)-1<r._getLastVisualColumn())){this._actualDragRange=i,(0,l._refreshDragDropIndicator)(r._render),this._oldDragRange=i;var s=r.parent;if(s&&s.options.showDragDropTip){var u=n.x+n.width+5,c=n.y+n.height+5;s._showTooltip(this._getDragDropRectString(i),u,c)}}}},_getDragDropRectString:function(t){if(t&&v){var e,r,n,o,i,l=this._sheet,a=l._getActiveSelectedRange(),u=l.getActiveRowIndex(),c=l.getActiveColumnIndex();if(u=u<0?0:u,c=c<0?0:c,1===M(a)&&1===V(a))e=s.default._createCellExpression(null,null,t.row-u,t.col-c,!0,!0);else-1===a.row&&a.col>=0?(r=o=s.default.BAND_INDEX_CONST,n=t.col-c,i=t.col-c+V(a)-1):-1===a.col&&a.row>=0?(n=i=s.default.BAND_INDEX_CONST,r=t.row-u,o=t.row-u+M(a)-1):a.row>=0&&a.col>=0&&(r=t.row-u,o=t.row-u+M(a)-1,n=t.col-c,i=t.col-c+V(a)-1),e=s.default._createRangeExpression(null,null,r,n,o,i,!0,!0,!0,!0);return l._getCalcServiceInternal().unparse(l._getSheetSource(),e,u,c)}},_stopDragDrop:function(){var t=this._sheet,e=t._getCanvas();e&&(e.style.cursor="-webkit-grab");var r=null;this._startHitInfo=null,this._stopScroll();var n=t._getActiveSelectedRange();(r=n&&(M(n)>0||V(n)>0)?{r:n.row,c:n.col,rc:M(n),cc:V(n)}:{r:t._activeRowIndex,c:t._activeColIndex,rc:1,cc:1},!0===this._isDragDropping&&!0===this._isWorking)&&N({sheet:t,fromRow:r.r,fromCol:r.c,rowCount:r.rc,colCount:r.cc,toRow:this._dragRect.row,toCol:this._dragRect.col,isDragInsert:this._isDragInsert,isDragCopy:this._isDragCopy});this._isWorking=!1,this._isDragDropping=!1,this._dragDropFromRange=null,this._isDragInsert=!1,this._isDragCopy=!1,this._oldDragRange=null,this._removeTooltip()},_startDragFill:function(t){!0!==this._isDraggingFill&&!0!==this._isWorking&&(this._updateDragFillStartRange(),this._fillStartRange&&(this._currentFillRange=void 0,this._isWorking=!0,this._isDraggingFill=!0,this._isDragAroundIndicator=!0,this._dragStartRowViewport=t,this._dragStartColumnViewport=b(t),this._dragToRowViewport=T(t),this._dragToColumnViewport=b(t),this._updateDragStartRangeViewports(),this._startHitInfo={_scrollRowViewportIndex:T(t),_scrollColViewportIndex:b(t),_hitTestType:O(t)},this._startScroll()))},_updateDragStartRangeViewports:function(){var t=function(t){return t.frozenRowCount()}(this._sheet),e=function(t){return t.frozenColumnCount()}(this._sheet),r=this._dragFillStartTopRow();r>=0&&r<t?this._dragFillStartTopRowViewport=0:r>=t&&r<=E(this._sheet)&&(this._dragFillStartTopRowViewport=1),this._isDragFillWholeColumns()?this._dragFillStartBottomRowViewport=1:this._dragFillStartBottomRowViewport=this._dragStartRowViewport;var n=this._dragFillStartLeftColumn();n>=0&&n<e?this._dragFillStartLeftColumnViewport=0:n>=e&&n<=I(this._sheet)&&(this._dragFillStartLeftColumnViewport=1),this._isDragFillWholeRows()?this._dragFillStartRightColumnViewport=1:this._dragFillStartRightColumnViewport=this._dragStartColumnViewport},_continueDragFill:function(){if(this._startHitInfo&&this._isDraggingFill&&this._isWorking&&this._fillStartRange){if(this._dragToRowViewport=this._getHitRowViewportIndex(),this._dragToColumnViewport=this._getHitColumnViewportIndex(),this._dragToRow=this._getHitRowIndex(),this._dragToColumn=this._getHitColumnIndex(),this._dragToRow>=0&&this._dragToColumn>=0){this._updateCurrentFillSettings(),this._updateCurrentFillRange();var t=this._sheet.parent,e=!1;this._getDragFillFrameRange()&&(e=this._validateFillRange(this._fillStartRange,this._currentFillRange,!0)),t&&t.options.showDragFillTip&&e&&this._showDragFillTooltip(),this._refreshDragFill()}this._continueScroll()}},_getDragFillTooltipContent:function(){var t,e=this._sheet,r=this._fillStartRange,n=this._currentFillRange,o=e.parent.options.defaultDragFillType,i=this._getAutoFillType(3===o?5:o),l=this._getCurrentFillDirection(),a=this._getDragFillFrameRange();if(1===i){t=0===l||1===l?1:0;var s=new c.default(e)._fillAuto(a,t,!0),_=this._getAvailableRange(l,n,r);if(!e.isRangeReadable(_))return"";var g=e.getActualStyle(_.row,_.col),f=g.cellType||e._getDefaultCellType(),d=g.formatter||g._autoFormatter,p=h.default&&h.default.GeneralFormatter;if(s instanceof Date&&p){var w=g.formatter||g._autoFormatter;w||(w=u.default.CultureManager._getCultureInfo().DateTimeFormat.shortDatePattern+" hh:mm:ss"),d=new p(w,0)}var v=this._startHitInfo,C=3;v&&(C=v._hitTestType);var m={sheet:e,row:_.row,col:_.col,sheetArea:C,quotePrefix:g.quotePrefix};return f.format(s,d,{},m)}return 0===i?(_=this._getAvailableRange(l,n,r),e.isRangeReadable(_)?e.getFormula(_.row,_.col)?null:e.getText(_.row,_.col):""):null},_getAvailableRange:function(t,e,r){var n=r.row,o=r.col,i=M(r),l=V(r),a=w(n,o,1,1);if(3===t){var s=M(e)%i;s=0===s?n+i-1:n+s-1,a.row=s,a.col=o}else 1===t?(s=0===(s=V(e)%l)?o+l-1:o+s-1,a.row=n,a.col=s):0===t?(s=0===(s=V(e)%l)?o:o+l-s,a.row=n,a.col=s):2===t&&(s=0===(s=M(e)%i)?n:n+i-s,a.row=s,a.col=o);return a},_showDragFillTooltip:function(){var t,e,r,n=this._sheet;if(4===this._getAutoFillType()||this._isDragFillWholeRows()||this._isDragFillWholeColumns())return this._removeTooltip(),null;var o=this._getCurrentFillDirection(),i=this._getDragFillFrameRange(),l=n._getRangeWholeRect(i);r=this._getDragFillTooltipContent(),3===o?(t=l.x+l.width+3,e=l.y+l.height+3):1===o?(t=l.x+l.width+3,e=l.y+l.height+3):0===o?(t=l.x+3,e=l.y+l.height+3):2===o&&(t=l.x+l.width+3,e=l.y+3),this._showTooltip(r,t,e)},_refreshDragFill:function(){this._clearDragFill(),this._refreshSelectionBorder(),this._paintDragFill(),this._oldDragFillFrameRange=this._getDragFillFrameRange()},_clearDragFill:function(){var t=this._sheet;if(this._oldDragFillFrameRange){var e=t._getRangeWholeRect(this._oldDragFillFrameRange);e.x-=2,e.y-=2,e.width+=4,e.height+=4,t._commitPaintSync([f({rect:e})])}},_refreshSelectionBorder:function(){this._sheet._commitPaintSync([d({range:this._fillStartRange})])},_paintDragFill:function(){var t=this._sheet,e=t._render,r=this._getDragFillFrameRange();if(r){var n=e._getCtx(),o=t._getRangeWholeRect(r);n.save(),n.beginPath(),(0,l._paintDragRectangle)(n,o),n.restore()}},_updateCurrentFillRange:function(){this._currentFillRange=this._getCurrentFillRange()},_isDragFillWholeRows:function(){return-1===this._fillStartRange.col&&-1!==this._fillStartRange.row},_isDragFillWholeColumns:function(){return-1===this._fillStartRange.row&&-1!==this._fillStartRange.col},_isDragClear:function(){return 4===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillRange:function(){var t=-1,e=-1,r=-1,n=-1;switch(this._currentFillDirection){case 0:this._isDragFillWholeColumns()?(t=-1,r=-1):(t=this._dragFillStartTopRow(),r=M(this._fillStartRange)),e=this._dragToColumn,n=this._dragFillStartLeftColumn()-e;break;case 1:this._isDragFillWholeColumns()?(t=-1,r=-1):(t=this._dragFillStartTopRow(),r=M(this._fillStartRange)),e=this._dragFillStartRightColumn()+1,n=this._dragToColumn-e+1;break;case 2:t=this._dragToRow,r=this._dragFillStartTopRow()-t,this._isDragFillWholeRows()?(e=-1,n=-1):(e=this._dragFillStartLeftColumn(),n=V(this._fillStartRange));break;case 3:t=this._dragFillStartBottomRow()+1,r=this._dragToRow-t+1,this._isDragFillWholeRows()?(e=-1,n=-1):(e=this._dragFillStartLeftColumn(),n=V(this._fillStartRange));break;case 5:t=this._dragToRow,r=this._dragFillStartBottomRow()-t+1,this._isDragFillWholeRows()?(e=-1,n=-1):(e=this._dragFillStartLeftColumn(),n=V(this._fillStartRange));break;case 4:this._isDragFillWholeColumns()?(t=-1,r=-1):(t=this._fillStartRange.row,r=M(this._fillStartRange)),e=this._dragToColumn,n=this._dragFillStartRightColumn()-e+1}return w(t,e,x(r,1),x(n,1))},_dragFillStartBottomRowLayout:function(){var t=this._dragFillStartBottomRow();return-1!==t?this._sheet._getRowLayout(this._dragFillStartBottomRowViewport).findRow(t):null},_dragFillToViewportBottomRowLayout:function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this._dragFillToViewportBottomRow())},_dragFillToViewportBottomRow:function(){return this._sheet.getViewportBottomRow(this._dragToRowViewport)},_dragFillStartRightColumnLayout:function(){var t=this._dragFillStartRightColumn();return-1!==t?this._sheet._getColumnLayout(this._dragFillStartRightColumnViewport).findCol(t):null},_dragFillToViewportRightColumnLayout:function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this._dragFillToViewportRightColumn())},_dragFillToViewportRightColumn:function(){return this._sheet.getViewportRightColumn(this._dragToColumnViewport)},_updateCurrentFillSettings:function(){var t,e,r=this._isDragFillWholeRows(),n=this._isDragFillWholeColumns(),o=p(this._sheet._getCanvas()).offset(),l=this._mousePosition.e,a=this._mousePosition.x,s=this._mousePosition.y,u=l.pageX-o.left,c=l.pageY-o.top,h=!1;if(r||n)n?this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=4:this._dragToColumn<this._dragFillStartLeftColumn()?this._currentFillDirection=0:this._dragToColumn>this._dragFillStartRightColumn()&&(this._currentFillDirection=1):r&&(this._dragToRow>=this._dragFillStartTopRow()&&this._dragToRow<=this._dragFillStartBottomRow()?this._currentFillDirection=5:this._dragToRow<this._dragFillStartTopRow()?this._currentFillDirection=2:this._dragToRow>this._dragFillStartBottomRow()&&(this._currentFillDirection=3));else if(this._dragToRow>=this._dragFillStartTopRow()&&this._dragToRow<=this._dragFillStartBottomRow())if(this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn())if(t=A(this._dragToColumn-this._dragFillStartRightColumn()),(e=A(this._dragToRow-this._dragFillStartBottomRow()))>t)this._currentFillDirection=5;else if(e<t)this._currentFillDirection=4;else{var _=this._dragFillStartBottomRowLayout();if(_||(_=this._dragFillToViewportBottomRowLayout()),s>_.y+_.height)this._currentFillDirection=3;else{var g=this._dragFillStartRightColumnLayout();g||(g=this._dragFillToViewportRightColumnLayout());var f=g.x+g.width-a,d=_.y+_.height-s;u>=g.x&&u<=g.x+g.width&&c>=_.y&&c<=_.y+_.height?this._currentFillDirection=f>=d?4:5:h=!0}}else this._dragToColumn<this._dragFillStartLeftColumn()?this._currentFillDirection=0:this._dragToColumn>this._dragFillStartRightColumn()&&(this._currentFillDirection=1);else this._dragToRow<this._dragFillStartTopRow()?this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=2:this._dragToColumn<this._dragFillStartLeftColumn()?(t=A(this._dragToColumn-this._dragFillStartLeftColumn()),e=A(this._dragToRow-this._dragFillStartTopRow()),this._currentFillDirection=e>=t?2:0):this._dragToColumn>this._dragFillStartRightColumn()&&(t=A(this._dragToColumn-this._dragFillStartRightColumn()),e=A(this._dragToRow-this._dragFillStartTopRow()),this._currentFillDirection=e>=t?2:1):this._dragToRow>this._dragFillStartBottomRow()&&(this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=3:this._dragToColumn<this._dragFillStartLeftColumn()?(t=A(this._dragToColumn-this._dragFillStartLeftColumn()),e=A(this._dragToRow-this._dragFillStartBottomRow()),this._currentFillDirection=e>=t?3:0):this._dragToColumn>this._dragFillStartRightColumn()&&(t=A(this._dragToColumn-this._dragFillStartRightColumn()),e=A(this._dragToRow-this._dragFillStartBottomRow()),this._currentFillDirection=e>=t?3:1));var w=(0,i.state)(i.STATES.dragFillIndicatorRect);if(w){var v=this._dragFillStartBottomRow(),C=this._dragFillStartRightColumn(),m=v+1,y=C+1,R=this._sheet.getRowHeight(v,3),F=this._sheet.getColumnWidth(C,3),x=this._sheet.getRowHeight(m,3),D=this._sheet.getColumnWidth(y,3),T=w.x+w.width/2-S(10,F/2),b=w.x+w.width/2+S(10,D/2),O=w.y+w.height/2-S(10,R/2),E=w.y+w.height/2+S(10,x/2),I=!1;r||n?n?I=T<=u&&u<=b:r&&(I=O<=c&&c<=E):I=T<=u&&u<=b&&O<=c&&c<=E,I||h?(this._isDragAroundIndicator=!0,this._currentFillDirection=4):this._isDragAroundIndicator=!1}},_dragFillStartTopRow:function(){return this._fillStartRange?-1===this._fillStartRange.row?0:this._fillStartRange.row:-1},_dragFillStartBottomRow:function(){return this._fillStartRange?-1===this._fillStartRange.row?E(this._sheet)-1:this._fillStartRange.row+M(this._fillStartRange)-1:-1},_dragFillStartLeftColumn:function(){return this._fillStartRange?-1===this._fillStartRange.col?0:this._fillStartRange.col:-1},_dragFillStartRightColumn:function(){return this._fillStartRange?-1===this._fillStartRange.col?I(this._sheet)-1:this._fillStartRange.col+V(this._fillStartRange)-1:-1},_endDragFill:function(){var t=this._sheet;if(this._startHitInfo=null,this._stopScroll(),this._removeTooltip(),this._isDraggingFill&&this._isWorking){this._isDraggingFill=!1,this._isWorking=!1;var e=this._getDragFillFrameRange();if(e&&this._fillStartRange&&this._currentFillRange){var r=!0;if(t.isRangeReadable(this._fillStartRange)||(t.parent.options.forbidCopyCallback&&t.parent.options.forbidCopyCallback(),r=!1),t.isRangeEditable(this._currentFillRange)||(t.parent.options.showPermissionError&&t.parent.options.showPermissionError({ranges:[this._currentFillRange]}),r=!1),!(r=r&&this._currentFillRange&&this._validateFillRange(this._fillStartRange,this._currentFillRange))||this._isDragAroundIndicator)this._resetDragFill(),this._refreshSelection(e);else{var n=this._getAutoFillType();t._commandManager().execute({cmd:"fill",sheetName:t.name(),startRange:t._eventHandler._fillStartRange,fillRange:this._currentFillRange,autoFillType:n,fillDirection:t._eventHandler._getCurrentFillDirection()}),!this._isCancelDragFill&&this._isDragFill()&&t.parent.options.showDragFillSmartTag&&4!==this._currentDragFillType?this._showDragFillSmartTag(this._currentDragFillType):this._refreshSelection(e),this._resetDragFill()}}}else this._resetDragFill()},_showDragFillSmartTag:function(t){var e=this._sheet,r=(0,i.state)(i.STATES.dragFillIndicatorRect),n={x:r.x+r.width,y:r.y+r.height,fillType:t};e._fillDialog=new o.default(e.parent._getContainerDiv(),e,n),e._fillDialog._open()},_updateDragFillStartRange:function(){var t=this._sheet;1===t._selectionModel.length?this._fillStartRange=t._selectionModel.data[0]:t._activeRowIndex>=0&&t._activeColIndex>=0&&(this._fillStartRange=w(t._activeRowIndex,t._activeColIndex,1,1))},_resetDragFill:function(){this._isWorking=!1,this._isDraggingFill=!1},_refreshSelection:function(t){this._sheet._render._repaintSelection(t)},_getAutoFillType:function(t){var e=this._sheet;void 0!==t||e.parent.options.defaultDragFillType;if(this._isDragClear())return 4;if(1===M(this._fillStartRange)&&1===V(this._fillStartRange)&&!this._isDragFillWholeColumns()&&!this._isDragFillWholeRows()){var r=this._fillStartRange.row,n=this._fillStartRange.col,o=!!e.getFormula(r,n);return this._isControlPressed||!o&&h.default.isDateFormatter(e.getFormatter(r,n)||e.getAutoFormatter(r,n))?1:0}return this._isControlPressed?0:1},_getDragFillFrameRange:function(){if(!this._fillStartRange)return null;if(this._isDragClear())return this._fillStartRange;if(!this._currentFillRange)return null;var t=0,e=0,r=0,n=0;return this._isVerticalDragFill()?(t=2===this._currentFillDirection?this._currentFillRange.row:this._fillStartRange.row,e=M(this._fillStartRange)+M(this._currentFillRange),r=this._fillStartRange.col,n=V(this._fillStartRange)):(t=this._fillStartRange.row,e=M(this._fillStartRange),r=0===this._currentFillDirection?this._currentFillRange.col:this._fillStartRange.col,n=V(this._fillStartRange)+V(this._currentFillRange)),w(t,r,e,n)},_validateFillRange:function(t,e,r){function o(t,e,r,n,o){for(var i=0;i<r.rowCount;i++){for(var l=0;l<r.colCount;l++){var a=t.getSpan(r.row+i,r.col+l);if(!a||a.rowCount!==e.rowCount||a.colCount!==e.colCount||(0,_.spanContainsFilteredRow)(a))return!1;n&&(l+=e.colCount)}o&&(i+=e.rowCount)}return!0}var i=this._sheet,l=!0,a="";return i._getSpanModel().hasSpans(e.row,e.col,M(e),V(e))&&!function(t,e,r){var n=e.row,i=e.rowCount,l=e.col,a=e.colCount,s=r.row,u=r.rowCount,c=r.col,h=r.colCount,g=n===s&&i===u,f=l===c&&a===h;if(!g&&!f)return!1;var d=t.getSpan(n,l);return!(!d||(0,_.spanContainsFilteredRow)(d)||!o(t,d,e,g,f))&&!t._getSpanModel().hasPartSpans(s,c,u,h)&&o(t,d,r,g,f)}(i,t,e)&&(l=!1,a=(0,n.sR)().Exp_FillRangeContainsMergedCell),l&&(i.isRangeEditable(e)||(l=!1,a=(0,n.sR)().Exp_FillCellsReadOnly)),l||r||i._raiseInvalidOperation(2,a),l},_isDragFill:function(){return this._isIncreaseFill()||this._isDecreaseFill()},_isIncreaseFill:function(){return 3===this._currentFillDirection||1===this._currentFillDirection},_isDecreaseFill:function(){return 0===this._currentFillDirection||2===this._currentFillDirection},_isVerticalDragFill:function(){return 2===this._currentFillDirection||3===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillDirection:function(){var t=this._currentFillDirection;return t>=0&&t<=3?t:4===t?0:5===t?2:3},_getDragInfo:function(t,e,r){var n=null,o=T(t),l=b(t);if(m(o)||m(l))return n;var a=this._sheet,s=a.parent,u=a._getActiveSelectedRange();if(-1===u.row&&-1===u.col)return n;if(-1===o&&-1!==l)return 1===a._selectionModel.length&&-1===u.row&&-1!==u.col&&u.col<=t.col&&u.col+u.colCount-1>=t.col?{action:D,side:"header"}:n;if(-1!==o&&-1===l)return 1===a._selectionModel.length&&-1!==u.row&&-1===u.col&&u.row<=t.row&&u.row+u.rowCount-1>=t.row?{action:D,side:"header"}:n;if(o>=0&&l>=0&&1===a._selectionModel.length){if(this._inGrayArea(o,l,e,r))return n;var c=a.getRangeRect(o,l,u);if(c.x-4<e&&e<c.x+4&&c.y<=r&&r<c.y+c.height&&(n={action:D,side:"left"}),!n){var h=(0,i.state)(i.STATES.dragFillIndicatorRect);h&&h.x<=e&&e<=h.x+h.width&&h.y<=r&&r<=h.y+h.height&&(n={action:D,side:"corner"})}n||c.x+c.width-4<e&&e<c.x+c.width+4&&c.y<=r&&r<c.y+c.height&&(n={action:D,side:"right"}),n||c.y-4<r&&r<c.y+4&&c.x<=e&&e<c.x+c.width&&(n={action:D,side:"top"}),n||c.y+c.height-4<r&&r<c.y+c.height+4&&c.x<=e&&e<c.x+c.width&&(n={action:D,side:"bottom"}),n&&(e<c.x||e>c.x+c.width||r<c.y||r>c.y+c.height)&&(n.outside=!0)}return s&&s.options.allowUserDragDrop||n&&"corner"!==n.side&&(n.side=null),s&&s.options.allowUserDragFill||n&&"corner"===n.side&&(n.side=null),n}},e.sheetEx={dragDrop:N}},function(t,e,r){"use strict";e.a=function(){u.register(h,{priority:1e3,exclusive:!0},{DBClick:{handler:function(){return _.doDoubleClickFill()},canHandle:function(t,e){return _.canTriggerDbClickFill(t,e)}}})};var n=r(0),o=r(1),i=r.n(o),l=r(13),a=r(8),s=r.n(a),u=i.a._SheetEventHandler.eventManager,c=n._createRange,h="DoubleClickAutoFill",_={_fillStartRange:null,_currentFillRange:null,_sheet:null,doDoubleClickFill:function(){var t=this._sheet;if(this._fillStartRange=t._selectionModel.data[0],!this.isFillStartRangeEmpty(this._fillStartRange)){var e=this.getDoubleClickFillFrameRange();if(e){var r=this._fillStartRange.row+this._fillStartRange.rowCount,n=e.rowCount-this._fillStartRange.rowCount;if(this._currentFillRange=c(r,e.col,n,e.colCount),t.isRangeReadable(this._fillStartRange)){var o=this._fillStartRange,i=o.rowCount,a=o.colCount,u=o.row,h=o.col,_=!1;if(1===i&&1===a){var g=t.getFormatter(u,h)||t.getAutoFormatter(u,h);_=!s.a.isDateFormatter(g)||t.getFormula(u,h)}t._commandManager().execute({cmd:"fill",sheetName:t.name(),startRange:this._fillStartRange,fillRange:this._currentFillRange,autoFillType:_?l.a.copyCells:l.a.fillSeries,fillDirection:l.d.down})}else t.parent.options.forbidCopyCallback&&t.parent.options.forbidCopyCallback(void 0,[this._fillStartRange])}}},canTriggerDbClickFill:function(t,e){this._sheet=e;var r=e._getCanvasOffset(),n=e.hitTest(t.pageX-r.left,t.pageY-r.top).dragInfo;return!!n&&"corner"===n.side},isRowFilteredOut:function(t){var e=this._sheet;return(e._rowFilter?e._rowFilter._getFilterArgs().filteredOutRows:[]).includes(t)},getFillReferenceAreaRowCount:function(t,e){for(var r=this._sheet.getRowCount(),n=0,o=t;o<r;o++){if(!this.isNotEmptyCell(o,e,"referenceArea")&&!this.isRowFilteredOut(o)){for(;this.isRowFilteredOut(o-1);)o--,n--;break}n++}return n},getWholeRangeRowCount:function(t,e,r,n){for(var o=this._sheet,i=o.getRowCount(),l=t+r;l<i;l++)for(var a=e;a<e+n;a++)if((this.isNotEmptyCell(l,a,"toBeFilled")||this.isCellMerged(l,a,o)||this.isCellLocked(l,a,o))&&!this.isRowFilteredOut(l))return l-t;return i-t},isValidCellValue:function(t){return!!t||0===t||!1===t},isCellLocked:function(t,e,r){var n=r.getSpan(t,e),o=n?n.row:t,i=n?n.col:e;return!r.isRangeEditable(o,i,1,1)},isNotEmptyCell:function(t,e,r){var n=this._sheet.getValue(t,e),o=this._sheet.getStyle(t,e);return"toBeFilled"===r?!!(this.isValidCellValue(n)||o&&o.backgroundImage):"fillStart"===r?!!(this.isValidCellValue(n)||o&&(o.backgroundImage||o.backColor)):this.isValidCellValue(n)},isCellMerged:function(t,e,r){var n=r.getSpan(t,e);return!!n&&(n.colCount>1||n.rowCount>1)},isFillStartRangeEmpty:function(t){for(var e=t.row,r=t.rowCount,n=t.col,o=t.colCount,i=e;i<e+r;i++)for(var l=n;l<n+o;l++)if(this.isNotEmptyCell(i,l,"fillStart"))return!1;return!0},getDoubleClickFillFrameRange:function(){var t=this._sheet;if(1===t._selectionModel.data.length){var e=t._selectionModel.data[0],r=e.row,n=e.col,o=e.rowCount,i=e.colCount,l=this.getFillReferenceAreaRowCount(r,n-1),a=this.getFillReferenceAreaRowCount(r,n+i),s=this.getWholeRangeRowCount(r,n,o,i);if(l>o)return c(r,n,Math.min(l,s),i);if(a>o)return c(r,n,Math.min(a,s),i)}return null}}},function(t,e,r){"use strict";e.a=function(){u("Worksheet").register("fill",c)};var n,o=r(12),i=r(1),l=r.n(i),a=r(9),s=(r.n(a),l.a.HookNames),u=l.a._getFeatureManager,c=((n={name:"fill"})[s.Worksheet.setHost]=function(t){t&&Object(a.regiterCmds)(this._commandManager())},n[s.Worksheet.dispose]=function(){var t=this._fillDialog;t&&t.close()},n._setMetaKeyStateOnEvent=function(t){var e=t.e,r=this._sheet;if(!0===this._isDragDropping){var n=r._getActiveSelectedRange(),i=this._isDragInsert,l=this._isDragCopy;-1===n.row||-1===n.col?this._isDragInsert=!e.shiftKey:this._isDragInsert=!1,this._isDragCopy=e.ctrlKey,i===this._isDragInsert&&l===this._isDragCopy||Object(o._refreshDragDropIndicator)(r._render)}},n._onPaintSelectionBorder=function(t){var e=t.ctx,r=t.rowViewportIndex,n=t.colViewportIndex,i=t.selectRect,l=t.clipRect;Object(o._paintDragFillIndicator)(this,e,r,n,i,l)},n)}])}},1926:function(t,e,r){"use strict";e.a=function(t,e,r,n,a){!function(t,e,r,n,o,l){for(var a=[],s={},u=r.row,c=r.col,h=r.rowCount,_=r.colCount,g=n.row,f=n.col,d=n.rowCount,p=n.colCount,w=g;w<g+d;w++)for(var v=f;v<f+p;v++){var C=o[w+"-"+v];if(C){var m=y(w,v);if(l(w,C,m)){s[g]=!0,a.push(w);break}}}function y(t,r){var n=0===e||1===e,i=n?t:(t-u)%h+u,l=n?(r-c)%_+c:r;return o[i+"-"+l]}i.sheets.cellCommand.autofitRows(t,a)}(t,e,r,n,a,function(e,r,n){var i=n.style||{},a=r.hasOwnProperty("value")?r.value:n.value,_=r.hasOwnProperty("formula")?r.formula:n.formula,g=r.style||{};if(!(i.backgroundImageSize===g.backgroundImageSize||o()(i.backgroundImageSize)&&o()(g.backgroundImageSize)))return!0;if(!o()(a)||_){var f=i.wordWrap,d=g.wordWrap;if(t._getActualRowHeight(e)<h)return!0;if((f&&"text-no-wrap"!==f||d&&"text-no-wrap"!==d)&&(f!==d||["text-wrap","text-linebreak-overflow"].includes(f)))return!0;var p=l(g),w=l(i),v=s(w["font-size"],i.richText),C=s(p["font-size"],g.richText);if(v&&9!==v||C&&9!==C)return!0;if(w["font-family"]!==p["font-family"]&&(c(w["font-family"])||c(p["font-family"])))return!0}else{if(t._getActualAutoFitRowHeight(e)>t._getActualRowHeight(e))return!0;if(i&&i.cellType&&"8"===i.cellType.typeName){var v=s(u(i),i.richText),C=s(u(g),g.richText);return v!==C&&!!(v&&9!==v||C&&9!==C)}}return!1})};var n=r(166),o=r.n(n),i=r(2),l=(r.n(i),i.sheets.cell.collectFontAttrs),a=i.sheets.cell,s=a.getCellMaxFontSize,u=a.getFontSizeFromStyle,c=a.isSupportedFont;var h=22},2:function(t,e){t.exports=shimo.sdk.sheet},37:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertNever=function(t){throw new Error("unexpected type: "+JSON.stringify(t))}},38:function(t,e,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=r(18);e.interweave=function(t,e){return t.map(function(r,n){return n===t.length-1?r:""+r+e[n]}).join("")},e.getTextResult=function(t,e){return e&&e[t]};var i=/%(s|\d)/g;e.getInterpolateResult=function(t,e,r){try{if(!r)return;var l=o.sourceTextToKey({type:"interpolated",textParts:t}),a=r[l];if(!a)return;var s={},u=0;l.replace(i,function(t){return s[t]=e[u],u+=1,t});return"string"==typeof a?function(t,e){return t.replace(i,function(r){return null!==e[r]?String(e[r]):(console.warn("[s18n] interpolation failed:",{str:t,valueMap:e}),r)})}(a,s):"object"===(void 0===a?"undefined":n(a))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(a))}catch(n){var c={parts:t,values:e,resource:r};return console.error("[s18n] error when translating: ",c),void console.error(n)}}}})});