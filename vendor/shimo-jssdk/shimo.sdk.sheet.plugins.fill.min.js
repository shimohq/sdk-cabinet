!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var i in r)("object"==typeof exports?exports:t)[i]=r[i]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="https://assets.smcdn.cn/sheet/",r(r.s=1174)}({1:function(t,e){t.exports=shimo.sdk.sheet},1174:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"PLUGIN_NAME",function(){return A});var i=r(220),o=(r.n(i),r(1)),n=(r.n(o),r(1175)),a=r.n(n),l=r(1176),s=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),u=this&&this.__assign||function(){return(u=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},c=o.sheets.Core,h=(o.Editor,o.sheets),_=h.range,g=h.collection,d=h.perf,f=h.root,p=h.path,w=h.fill,C=h.Plugin,v=p.setByPath,m=o.sheets.Hooks,R=c.Spread.Sheets,y=o.sheets.Events,F=w.fillZhSR,S=i.isMac(),A="Fill",D=function(t){function e(r){var i=t.call(this,{name:A,Constructor:e,config:r})||this;i.render=function(){var t=i.editor;i.init(),c.Spread.Sheets.Fill.initSpread(t.spread.gcSpread),i.registerFillShortcut()},i.registerFillShortcut=function(){var t=i.editor,e=t.spread.gcSpread.commandManager();e.register("custom-fillBottom",function(){if(!t.permissions.query.canEditFile())return!0;var e=R.Fill,r=e.AutoFillType,o=e.FillDirection,n=i.editor.spread.getActiveSheet();if(!n.gcSheet.isEditing()){var a=n.getCurSelection(),l=n.gcSheet,s=l._commandManager(),c=l.name(),h=void 0,g=void 0;if(1===a.rowCount){var d=a.row-1;if(-1===d)return!0;h=u({},a,{row:d}),g=u({},a,{row:a.row,rowCount:a.rowCount})}else h=u({},a,{row:a.row,rowCount:1}),g=u({},a,{row:a.row+1,rowCount:a.rowCount-1});return h=_.createRange(h.row,h.col,h.rowCount,h.colCount),g=_.createRange(g.row,g.col,g.rowCount,g.colCount),s.execute({cmd:"fill",sheetName:c,startRange:h,fillRange:g,autoFillType:r.copyCells,fillDirection:o.down}),!0}});e.setShortcutKey("custom-fillBottom",68,!S,!1,!1,S)},i.onCollectOperatorAfterDragFillBlockCompleted=function(t,e){var r=t.args,o=r.oldCells,n=r.sheet,a=g.appendNewCells(n,o,!0,!0);d.paintWrap({obj:n,func:l.a,suspendCalcService:!0})(n,a);var s={fnName:"editCell2Changeset",params:i.editor.opProcessor([n.guid(),g.addLinkAttrInfoForEditCell2Changeset(a),{skipParseFormat:!0}])};return e.push(s),e};var o=r.editor;return i.editor=o,i.bindEditorEvents(),i.registerHooks(),i.editor.isRendered&&i.render(),i.install(),i}return s(e,t),e.prototype.init=function(){c.Spread.Sheets.Fill||(a()(c),c.Spread.Sheets.Fill.install(c.Spread.Sheets),c.Spread.Sheets.Fill.SR.zh=function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}(c.Spread.Common.SR.zh,F))},e.prototype.bindEditorEvents=function(){this.editor.on(y.Rendered,this.render)},e.prototype.registerHooks=function(){(0,this.editor.hookManager.registerHook)(m.CollectOperatorAfterDragFillBlockCompleted,this.onCollectOperatorAfterDragFillBlockCompleted)},e}(C);e.default=D,v(f,"shimo.sdk.sheet.plugins.Fill",D)},1175:function(t,e){t.exports=function(e){e.Spread.Sheets.Fill=t.exports=function(t){var e={};function r(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=14)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"ROW_COUNT",function(){return u}),r.d(e,"COLUMN_COUNT",function(){return c}),r.d(e,"NUMBER_STRING",function(){return h}),r.d(e,"SER_NUMBER_STRING",function(){return _}),r.d(e,"SER_STRING",function(){return g}),r.d(e,"MONTH_STRING",function(){return d}),r.d(e,"DAY_STRING",function(){return f}),r.d(e,"WEEK_STRING",function(){return p}),r.d(e,"DATE_STRING",function(){return w}),e.getValType=function(t){switch(!0){case t instanceof Date:return w;case C(t):return h;case R(t):return f;case m(t):return p;case y(t):return d;case v(t):return _+t.toString().split(".").length;case F(t):return g;default:return null}},e.toArray=function(t){var e=[t];return e.rowCount=1,e.colCount=t.length,e},e.isNumber=C,e.isSerialNum=v,e.isWeek=m,e.isDay=R,e.isMonth=y,e.isAllSame=function(t){return!t.length||!t.some(function(e){return e!==t[0]})},e.isSameStep=function(t){if(t.length<=2)return!0;var e=t[1]-t[0];return!t.some(function(r,i){return 0!==i&&e!==r-t[i-1]})},e.isSerialString=F,e._hasOwnProperty=S,e._CopyProperty=function(t,e){for(var r in e)S(e,r)&&(t[r]=e[r])},e.printException=A,e.isValidRange=function(t,e,r,i,o,n){if(-1<=t&&t<o&&-1<=e&&e<n){if(-1===t&&-1===e)return!0;if(-1===t){if(0!==i&&e+i<=n)return!0}else if(-1===e){if(0!==r&&t+r<=o)return!0}else if(0!==i&&e+i<=n&&0!==r&&t+r<=o)return!0}return!1},e.cellRangeInflate=function t(e,r){var i=e.length;for(var o=0;o<i;o++){var n=e[o];if(r.intersect(n.row,n.col,n.rowCount,n.colCount))return e.splice(o--,1),t(e,r.union(n))}return r},e.isDefined=function(t){return void 0!==t},e.createElement=function(t){return document.createElement(t)},e.documentInsertBefore=function(t){document.body&&document.body.insertBefore(t,null)},e.cancelDefault=function(t){t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1);return!1},e._getPreferredZIndex=function(t){var e=document.body,r=t;for(;r&&r.parentElement&&r.parentElement!==e;)r=r.parentElement;var i,o=1e3;r&&r.parentElement===e&&(i=parseInt(l(r).css("z-index")),isNaN(i)||(o+=i));return o},e.device=function(){var t,e,r,i,o=navigator.userAgent,n=o.match(/iPad/i);n&&(t=n[0])&&(e="ipad"===t.toLowerCase());(n=o.match(/iPhone/i))&&(t=n[0])&&(r="iphone"===t.toLowerCase());(n=o.match(/android/i))&&(t=n[0])&&(i="android"===t.toLowerCase());return{ipad:!!e,iphone:!!r,android:!!i}},r.d(e,"browser",function(){return D}),e._createRange=function(t,e,r,i){return new a.a.Range(t,e,r,i)},e._getColor=function(t,e){if(t&&e){var r=t._currentTheme;if(r)return r.getColor(e)}return e};var i=r(3),o=r.n(i),n=r(1),a=r.n(n),l=a.a.GC$,s=o.a._isNumber,u="rowCount",c="colCount",h="number",_="serialNumber",g="serialString",d="monthString",f="day",p="week",w="date";function C(t){return"string"!=typeof t&&s(t)}function v(t){if(!t)return!1;return t="string"!=typeof t?t.toString():t,/^\d+\.(\d+\.)+\d+$/.test(t)}function m(t){return/^周[一,二,三,四,五,六,天,日]$/.test(t)}function R(t){return/^星期[一,二,三,四,五,六,天,日]$/.test(t)}function y(t){return-1!==["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"].indexOf(t)||-1!==["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"].indexOf(t)}function F(t){return/.*\d$/.test(t)}function S(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function A(t){console.log("Exception from GC =>"),console.warn(t)}var D=function(){var t=navigator.userAgent,e=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(t),r={};e.browser&&(r[e.browser]=!0,r.version=e.version),r.chrome?r.webkit=!0:r.webkit&&(r.safari=!0),t.indexOf("PhantomJS")>=0&&(r.safari=!1,r.chrome=!0);var i=t.toLowerCase();i.indexOf("compatible")<0&&null!==/(trident)(?:.*? rv ([\w.]+)|)/.exec(i)&&(r.mozilla=void 0,r.msie=!0);var o=/Edge\/\d+/.exec(t);return null!==o&&o.length>0&&(r.webkit=void 0,r.chrome=void 0,r.msie=!0,r.edge=!0,r.version=o[0].substr(o[0].indexOf("/")+1)),r.msie&&function(){var t=null,e=!1;try{new ActiveXObject("htmlfile")}catch(e){A(e),t=e.name}try{e=!!new ActiveXObject("htmlfile")}catch(t){A(t),e=!1}return!(e="ReferenceError"===t||!1!==e)}()&&(r.metroMode=!0),t.indexOf("QQBrowser")>-1&&(r.QQBrowser=!0),r}()},function(t,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.Sheets},function(t,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.Common},function(t,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.Common._Types},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"SR",function(){return l}),r.d(e,"sR",function(){return s});var i=r(2),o=r.n(i),n=r(15),a=r.n(n),l={};function s(){return o.a._getResource(l)()}l.en=a.a,e.default={SR:l}},function(t,e,r){"use strict";var i=r(0),o=r(3),n=r.n(o),a=r(2),l=r.n(a),s=l.a._growth,u=l.a._leastSquare,c=n.a._isNullOrUndefined,h=function(){function t(t){this._startIndex=t}return t.prototype.add=function(t,e){c(this._type)&&(this._type=Object(i.getValType)(e)),this._indexes.push(t),this._innerValues.push(e)},t.prototype._dataCount=function(){return this._innerValues&&this._innerValues.length},t.prototype._values=function(){return this._innerValues},t.prototype._insert=function(t,e,r){c(this._type)&&(this._type=Object(i.getValType)(r)),this._indexes.splice(t,0,e),this._innerValues.splice(t,0,r)},t.prototype._indexes2=function(){var t=this._indexes,e=t?t.length:0;if(e>0){var r=this._startIndex,i=[],o=void 0;for(-1===r&&(r=t[0]),o=0;o<e;o++)i[o]=t[o]-r+1;return i}return null},t.prototype.valueConverter=function(){var t=this._innerValues;return t&&t.length?t:null},t.prototype._toActualValue=function(t){return t},t.prototype.getTrendOrGrowthValue=function(t,e,r,o){o=o||this.valueConverter(),r=r||this._indexes2();var n,a=Object(i.toArray)(o),l=Object(i.toArray)(r),u=Object(i.toArray)([e]),c=(n=t?this.trend(a,l,u,!0,function(t){return t},null,null,null):s(a,l,u,!0,null,null,null))&&n[0][0];return typeof c===i.NUMBER_STRING&&c.toString().length>15?+c.toPrecision(16):c},t.prototype._getInnerIncrease=function(t,e,r,o){var n=Object(i.getValType)(t);if(!n)return null;var a=null;if(e===n){if(this.patternMatch&&!this.patternMatch(t))return null;a=r?o?r.colCount:r.rowCount:1}return a},t.prototype.patternMatch=function(t){return!0},t.prototype.trend=function(t,e,r,o,n,a,l,s){var c,h,_,g=[],d=this.resultConverter&&this.resultConverter.bind(this),f=e[i.ROW_COUNT],p=e[i.COLUMN_COUNT],w=t[i.ROW_COUNT],C=t[i.COLUMN_COUNT],v=r[i.ROW_COUNT],m=r[i.COLUMN_COUNT];if(w!==f||C!==p)return null;var R=u(e,t,f,p),y=R.mm,F=R.d;for(c=0;c<v;c++)for(g[c]=[],h=0;h<m;h++)_=y*r[c][h]+F,g[c][h]=(d?d(_):_)||"";return g},t.prototype.resultConverter=function(t){return t},t}();e.a=h},function(t,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.CalcEngine},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(4),o=r(0),n=r(16),a=c(r(1)),l=c(r(6)),s=c(r(2)),u=c(r(8));function c(t){return t&&t.__esModule?t:{default:t}}var h=o._createRange,_=a.default._supportsCalc,g=s.default._Types,d=Math.floor,f=g._isNullOrUndefined,p=s.default._ArrayHelper._getLength,w=s.default._DateTimeHelper,C=w._toOADate,v=w._fromOADate;function m(t){this._sheet=t}function R(t,e){switch(!0){case(0,o.isDay)(t):case(0,o.isWeek)(t):return new n.DaySource;case(0,o.isMonth)(t):return new n.MonthSource;case t instanceof Date&&u.default.isDateFormatter(e):return new n.DateSource;case(0,o.isNumber)(t):case(0,o.isSerialNum)(t):return new n.NumberSource;case(0,o.isSerialString)(t):return new n.SerialStringSource}}function y(t){return h(t.row,t.col,t.rowCount,t.colCount)}m.prototype={_fillLinearOrGrowth:function(t,e,r,i,o){var n=t?1:2;f(i)&&f(o)?this._seriesFillRange(e,r,n):this._seriesFillRange(e,r,n,i,o,null)},_seriesFillRange:function(t,e,r,o,n,a){var l=this._sheet,s=l._getActualRange(t),u=s.row,c=s.col,h=s.rowCount,_=s.colCount;if(l._getSpanModel().hasSpans(u,c,h,_))throw new Error((0,i.sR)().Exp_RangeContainsMergedCell);var g,d,f,w,C,v=arguments.length>3,m=0,R=1===e,y=R?_:h,F=R?u:c,S=R?u+h:c+_,A=v?1:y,D=this._sheet._eventHandler._fillStartRange,x=D.row===u&&D.rowCount===h&&D.col>c||D.col===c&&D.colCount===_&&D.row>u;for(g=F;g<S;g++){var T=x&&v?c+_-1:c,O=x&&v?u+h-1:u,b=R?this._getSeriesSource(g,T,1,A,e):this._getSeriesSource(O,g,A,1,e);if(b&&b._dataCount())for(w=b._indexes[0],v?(C=x?b._innerValues[p(b._innerValues)-1]:b._innerValues[0],d=this._calcSeriesData(x,C,y,r,o,n,a),x&&(m=y-p(d),w=b._indexes[p(b._indexes)-1])):d=this._calcSeriesTrendData(b,y,r),f=0;f<p(d);f++){var E=b._toActualValue(d[f]);R?this._copyCell(l,g,w,g,c+m+f,E,r,!1,void 0,void 0,!0):this._copyCell(l,w,g,u+m+f,g,E,r,!1,void 0,void 0,!0)}}},_getSeriesSource:function(t,e,r,i,a){for(var l,s=null,u=this._sheet,c=1===a,h=c?e+i-1:t+r-1,_=c?e:t;h>=_;)l=c?u.getValue(t,h):u.getValue(h,e),(0,o.isNumber)(l)&&(s||(s=new n.NumberSource(_)),s._insert(0,h,l)),h--;return s},_calcSeriesData:function(t,e,r,i,o,n,a){var l,s=[],u=e,c=o>=0,h=f(n);for(l=0;l<r;l++){var _=u>=n,g=u<=n;t&&(h||c&&_||!c&&g)?(s.unshift(u),1===i?u-=o:2===i?u/=o:3!==i||f(a)||(u=this._getNextDateValue(!0,a,e,u,o,l+1))):!t&&(h||c&&g||!c&&_)&&(s.push(u),1===i?u+=o:2===i?u*=o:3!==i||f(a)||(u=this._getNextDateValue(!1,a,e,u,o,l+1)))}return s},_calcSeriesTrendData:function(t,e,r){var i,o=[],n=1===r;if(n||2===r){for(1===t._dataCount()&&t.add(t._indexes[0]+1,n?t._toActualValue(t._innerValues[0]+1):t._values()[0]),i=0;i<e;i++)o.push(t.getTrendOrGrowthValue(n,i+1));return o}return null},_fillAuto:function(t,e,r,o){var n=this._sheet,a=n._getSpanModel(),l=n._getActualRange(t),s=l.row,u=l.col,c=l.rowCount,h=l.colCount,_=n._getActualRange(n._eventHandler._fillStartRange),g=_.row,d=_.col;if(a.hasPartSpans(g,d,_.rowCount,_.colCount)||a.hasPartSpans(s,u,c,h))throw new Error((0,i.sR)().Exp_ChangeMergedCell);for(var f=c,p=s;p<s+c;p++)n._isRowFilterOut&&n._isRowFilterOut(p)&&f--;return this._autoFillRange(_,f,h,e,r,!(s<g||u<d),o)},_autoFillRange:function(t,e,r,o,n,a,l){var s,u,c,_,g=this._sheet,f=a?1:-1,p=t.row,w=t.col,C=t.rowCount,v=t.colCount;if(!n){var m=function(){switch(!0){case 1===o&&a:return{row:t.row,col:t.col+t.colCount,rowCount:t.rowCount,colCount:r-t.colCount};case 1===o&&!a:return{row:t.row,col:t.col+t.colCount-r,rowCount:t.rowCount,colCount:r-t.colCount};case 1!==o&&a:return{row:t.row+t.rowCount,col:t.col,rowCount:e-t.rowCount,colCount:r};default:return{row:t.row+t.rowCount-e,col:t.col,rowCount:e-t.rowCount,colCount:r}}}(),R=g&&g._getCalcModel();if(R&&R._intersectWithArrayFormula(m.row,m.col,m.rowCount,m.colCount))return g&&g._raiseInvalidOperation(4,(0,i.sR)().Exp_ArrayFromulaPart,{message:(0,i.sR)().Exp_ArrayFromulaPart}),null}if(1===o){if(s=d(r/v),u=r%v,!n)for(_=1;_<s;_++)c=h(p,w+_*f*v,C,v),this._copyRange(t,c,o,4,n,void 0,void 0,void 0,void 0,l,0);if(n&&s>1&&0===u&&(s-=1,u=v),s>0&&u>0)return c=h(p,a?w+s*v:w-s*v+v-u,C,u),this._copyRange(t,c,o,4,n,a,null,a?0:v-u,void 0,l,0)}else{for(var y=0,F=p;F<p+C;F++)this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(F)&&y++;var S=C-y;s=d(e/S),u=e%S;var A=0;if(!n){var D=0,x=0,T=0;for(_=1;_<s;_++){var O=S;if(a){for(T=p+_*f*S+(a?y:0),T=Math.max(D,T);this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(T);)T++,A++;for(var b=T;b<T+O;b++)this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(b)&&(O++,A++);D=T+O*f}else{var E=p-1;for(1===_&&(x=p),E=Math.min(x-1,E);this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(E);)E--,A++;var I=0;for(T=E;I<S;)this._sheet._isRowFilterOut&&!this._sheet._isRowFilterOut(T)?I++:A++,I<S&&T--;O=E-T+1,x=T}c=h(T,w,O,v),this._copyRange(t,c,o,4,n,a,null,null,!0,l,y)}}if(n&&s>1&&0===u&&(s-=1,u=C),s>0&&u>0){for(var V=a?p+s*S+y+A:p-s*S+e%S-A;this._sheet._isRowFilterOut&&this._sheet._isRowFilterOut(V);)a?V++:V--;return c=h(V,w,u,v),this._copyRange(t,c,o,4,n,a,a?0:S-u,null,!0,l,y)}}},_copyRange:function(t,e,r,i,n,a,l,s,u,c,h){var _,g,d,f,p,w=this._sheet,C=null,v=1===r,m=v?t.row:t.col,y=v?t.col:t.row,F=v?e.row:e.col,S=v?e.col:e.row,A=v?t.rowCount-h:t.colCount,D=v?t.colCount:t.rowCount-h,x=v?e.colCount:e.rowCount,T=w.getArrayExpressionCellsInRange(t);for(f=0;f<A;f++){for(var O=null,b=null,E=0,I=m+f,V=F+f,M=I,P=V,N=(v?s:l)||0,k=v?0:N,B=v?null:u;E<D;){var L=y+E,j=S+E-N,H=null,U=L,W=j;if(!v){for(I=[L,L=M][0];w._isRowFilterOut&&w._isRowFilterOut(I);)I++;for(V=[j,j=P][0];w._isRowFilterOut&&w._isRowFilterOut(V);)V++}d=w._getSpanModel().find(I,L),_=w.getFormula&&w.getFormula(I,L);var Y=w.getArrayValueMark(I,L);_&&""!==_||Y&&T[Y]||(H=w.getValue(I,L));var G=H,Q=w.getCellType&&w.getCellType(I,L);if(Q&&"8"==Q.typeName&&(G=""),4===i){var K=w.getFormatter(I,L)||w.getAutoFormatter(I,L);if(O=O||R(G,K),g=(0,o.getValType)(G),b||(b=g),O&&(C=O._getInnerIncrease(G,b,d,v))){O.add(U,G),E+=C;continue}}if(G&&O&&O._dataCount()){if(p=this._autoFillTrendValues(v,t,e,M,P,O,n,a,k,B,c,h),n&&(p||0===p))return p;O=null,b=null}else{if(!d||d&&(v?d.row:d.col)===M){for(var X=W===S+x-1;!v&&w._isRowFilterOut&&w._isRowFilterOut(W);)W++;if(n){if(d&&X||!d&&(X&&a||!a&&W===S))return H}else W<S+x&&W>=S&&(v||!v&&!(u&&w._isRowFilterOut&&w._isRowFilterOut(W)))&&this._copyCell(w,I,L,V,j,H,i,c,t,e,!1)}d?E+=v?d.colCount:d.rowCount:E++}}if(O&&O._dataCount()&&(p=this._autoFillTrendValues(v,t,e,M,P,O,n,a,k,B,c,h),n&&(p||0===p)))return p}return null},_copyCell:function(t,e,r,i,o,n,a,s,u,c,h){if(e!==i||!t._isRowFilterOut||!t._isRowFilterOut(e)){var g,d,f=t._getSpanModel();if(_&&(t.hasFormula(e,r)||t.hasFormula(i,o))){var p=t.getFormulaInformation(i,o);if(p&&p.isArrayFormula){var w=p.baseRange;i===w.row&&o===w.col&&t.setArrayFormula(w.row,w.col,w.rowCount,w.colCount,null)}else t.setFormula(i,o,null);if(0===a||4===a){g=t._getCalcModel();var C=t.getFormulaInformation(e,r);if(C.hasFormula)if(C&&C.isArrayFormula){var v=C.baseRange;if(u){var m=function(t,e,r,i,o,n){switch(function(t,e,r,i){if(e>t)return"Down";if(e<t)return"Up";if(i>r)return"Right";if(i<r)return"Left"}(r,i,o,n)){case"Down":return{row:t.row,col:t.col,rowCount:e.rowCount,colCount:t.colCount};case"Up":return{row:t.row+(t.rowCount-e.rowCount),col:t.col,rowCount:e.rowCount,colCount:t.colCount};case"Right":return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:e.colCount};case"Left":return{row:t.row,col:t.col+(t.colCount-e.colCount),rowCount:t.rowCount,colCount:e.colCount}}return t}(u,c,e,i,r,o),R=y(v).getIntersect(y(m));R.row===e&&R.col===r&&l.default.CalcOperatorAdjustor.copyFormula(g,e,r,g,i,o,R.rowCount,R.colCount)}else l.default.CalcOperatorAdjustor.copyFormula(g,e,r,g,i,o,1,1)}else l.default.CalcOperatorAdjustor.copyFormula(g,e,r,g,i,o,1,1)}}t.setValue(i,o,n);var F=16380;if(s&&(F|=128),t._copyToCore(e,r,i,o,1,1,F,void 0,void 0,void 0,{ignoreNumberText:!1,clearRichText:h}),!f.isEmpty()&&(t.removeSpan(i,o,3),(d=f.find(e,r))&&e===d.row&&r===d.col)){t._addSpanImp(i,o,d.rowCount,d.colCount,3);for(var S=i;S<i+d.rowCount;S++)for(var A=o;A<o+d.colCount;A++)S===i&&A===o||(t.setValue(S,A,null),t.getFormula(S,A)&&t.setFormula(S,A,null))}}},_autoFillTrendValues:function(t,e,r,i,o,n,a,l,s,u,c,h){var _,g,d,f,p=this._sheet,w=t?r.col:r.row,C=t?e.col:e.row,v=t?r.colCount:r.rowCount,m=t?e.colCount:e.rowCount-h,R=l?1:-1;s=s||0,l&&!t&&(s+=h);var y=0;if(!t)for(var F=l?e.row+e.rowCount:r.row,S=l?r.row:e.row,A=F;A<S;A++)p._isRowFilterOut&&p._isRowFilterOut(A)&&y++;l&&!t?s+=y:s-=y;var D=n._dataCount(),x=(w-C-s)/m,T=this._isArithmeticProgression(n._indexes,n.valueConverter());if(T){for(d=[],g=0;g<D;g++)d[g]=g+1;_=D}else f=n._indexes[0],_=n._indexes[D-1]-f+1,1===D&&n.add(n._indexes[0]+1,n._toActualValue(n.increase(n._innerValues[0],1))),d=n._indexes2();for(g=0;g<_;g++){var O=n.getTrendOrGrowthValue(!0,_*x+g+1,d),b=w+v-1,E=T?n._indexes[g]:f+g,I=E+x*m;if(!t)for(I+=y*R,l&&(I+=h);p._isRowFilterOut&&p._isRowFilterOut(I);)I++;if(a){if(T&&(l&&I===b||!l&&I===w)||!T&&I+s===b)return n._toActualValue(O)}else I<w+v&&I>=w&&(t?this._copyCell(p,i,E,o,I,n._toActualValue(O),4,c,e,r,!0):u&&p._isRowFilterOut&&p._isRowFilterOut(I)||this._copyCell(p,E,i,I,o,n._toActualValue(O),4,c,e,r,!0))}return null},_isArithmeticProgression:function(t,e){var r=p(e);if(r<=1||p(t)!==r)return!1;var i,o=t[1]-t[0],n=e[1]-e[0];for(i=2;i<r;i++)if(t[i]-t[i-1]!==o||e[i]-e[i-1]!==n)return!1;return!0},_fillAutoByDirection:function(t,e){var r,i=this._sheet,n=i.getSpans(),a=i._getActualRange(t),l=a.row,s=a.col,u=a.rowCount,c=a.colCount;r=0===e?h(l,s+c-1,u,1):1===e?h(l,s,u,1):h(2===e?l+u-1:l,s,1,c),(r=(0,o.cellRangeInflate)(n,r))&&this._directionFillRange(r,l,s,u,c,e)},_directionFillRange:function(t,e,r,o,n,a){var l,s,u,c,_,g,f,p,w=t.row,C=t.col,v=t.rowCount,m=t.colCount,R=this._sheet._getSpanModel();if(0===a?(p=R.hasSpans(e,r,o,n-m),g=0,f=-1*m,u=n,c=m,_=1):1===a?(p=R.hasSpans(e,r+m,o,n-m),g=0,f=m,u=n,c=m,_=1):2===a?(p=R.hasSpans(e,r,o-v,n),g=-1*v,f=0,u=o,c=v,_=0):(p=R.hasSpans(e+v,r,o-v,n),g=v,f=0,u=o,c=v,_=0),p)throw new Error((0,i.sR)().Exp_TargetContainsMergedCells);if(u%c!=0)throw new Error((0,i.sR)().Exp_MergedCellsIdentical);for(l=d(u/c),s=1;s<l;s++)this._copyRange(t,h(w+s*g,C+s*f,v,m),_,0)},_getNextDateValue:function(t,e,r,i,o,n){var a=t?-1:1,l=d(n*o),s=Math.abs(o),u=v(e>1?r:i);if(0===e)u.setDate(u.getDate()+a*o);else if(1===e)for(;s>0;)u.setDate(u.getDate()+a*(o>0?1:-1)),6!==u.getDay()&&0!==u.getDay()&&s--;else 2===e?u.setMonth(u.getMonth()+a*l):u.setFullYear(u.getFullYear()+a*l);return C(u)}},e.default=m},function(t,r,i){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=e.Spread.Formatter},function(t,e,r){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.sheetEx=e.regiterCmds=e.FILL_FEATURE_NAME=void 0;var o=r(4),n=r(0),a=u(r(1)),l=u(r(2)),s=u(r(7));function u(t){return t&&t.__esModule?t:{default:t}}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var h=a.default.Events,_=a.default.Exception,g=a.default.Commands,d=a.default._SheetModel,f=a.default._supportsCalc,p=a.default.GC$,w=_.triggerError,C=g._prepareCommands,v=l.default._Types._isNullOrUndefined,m=Math.max,R=Math.floor,y=g.ActionBase,F=g._ChangedCells,S=g._CopyMoveHelper,A=S._saveViewportInfo,D=S._raiseRangeDataChanged,x=g._CopyMoveCellsInfo,T="startRange",O="fillRange",b="autoFillType",E="fillDirection",I="srcRange",V=g._performUndo,M=g._saveColumnHeaderInfo,P=g._saveViewportInfoForDragDrop,N=g._saveTableInfo,k=g._saveRowHeaderInfo,B=e.FILL_FEATURE_NAME="fill";e.regiterCmds=C((c(i={},B,{canUndo:!0,execute:function(t,e,r){return g._executeCommand(t,Y,e,r)}}),c(i,"dragDrop",{canUndo:!0,execute:function(t,e,r){return g._executeCommand(t,Q,e,r)}}),i));function L(t){return t.rowCount}function j(t){return t.colCount}function H(t,e){return t.getRowCount(e)}function U(t,e){return t.getColumnCount(e)}var W=function(t){function e(e,r){var i=r[E],o=0===i,a=o||1===i,l=r[O],s=r[T],u=s.row,c=s.col,h=L(s),_=j(s);t.call(this),this._sheet=e,this._autoFillExtent=r,4===r[b]?this._clearValueUndoAction=new g._ClearValueUndoAction(e,[r[O]]):this._wholeFillRange=a?(0,n._createRange)(u,o?l.col:c,h,_+j(l)):(0,n._createRange)(2===i?l.row:u,c,h+L(l),_),this._fillSeries=a?1:0}p.inherit(e,t);var r={canExecute:function(){var t=this._sheet,e=this._autoFillExtent,r=e[T],i=e[O];return!!t._canChange(i.row,i.col,L(i),j(i))&&(4===e[b]||!i.intersect(r.row,r.col,L(r),j(r)))},execute:function(){if(this.canExecute()){var t=this._autoFillExtent,e=t[O],r=this._sheet;this._beforeAction(r);try{f&&r.suspendCalcService(),4===t[b]?this._executeDragFillClear(r):this._executeAutoFill(r)}catch(t){(0,n.printException)(t),w(t)}finally{this._afterAction(r),f&&r.resumeCalcService(!1),r._updateTableSlicer&&r._updateTableSlicer(e.row,e.col,L(e),j(e))}}},_executeDragFillClear:function(t){this._clearValueUndoAction.execute(t);var e,r=this._autoFillExtent,i=r[T],o=r[O],a=0===this._fillSeries,l=L(i),s=j(i),u=a?m(1,l-L(o)):l,c=a?s:m(1,s-j(o));i.equals(o)||(e=(0,n._createRange)(i.row,i.col,u,c),t._setActiveCellImp(m(t._getFirstVisualRow(),e.row),m(t._getFirstVisualColumn(),e.col),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.addSelection(e.row,e.col,L(e),j(e)))},_executeAutoFill:function(t){var e,r,i=this._sheet,o=this._autoFillExtent[T],n=this._autoFillExtent[O],a=this._autoFillExtent[b],l=this._wholeFillRange,s={fillType:4,series:this._fillSeries,withTag:!0};if(1===a){if(i.fillAuto(o,l,s),i._getSpanModel().hasSpans(o.row,o.col,o.rowCount,o.colCount))for(e=0;e<n.rowCount;e++)for(r=0;r<n.colCount;r++){var u=i._getStyleObject(o.row+R(e%o.rowCount),o.col+R(r%o.colCount));u&&u.clone&&(u=u.clone()),u&&delete u.ignoreNumberTextPrompt,i._setStyleObject(n.row+e,n.col+r,u)}}else if(0===a)this._copyCells(o,n,15867,{feature:"fillAuto"});else if(6===a)this._copyCells(o,n,15867);else if(2===a)this._copyCells(o,n,192);else if(3===a){if(!(1!==L(o)||1!==j(o)||-1===o.row&&-1!==o.col||-1===o.col&&-1!==o.row)){this._copyCells(o,n,187)}else{var c=i._getActualRange(l),h=c.row,_=c.col,g=L(c),f=j(c),p=new d(L(c),j(c),null);for(e=0;e<g;e++)for(r=0;r<f;r++)p.setStyle(e,r,i._getStyleObject(h+e,_+r));for(i.fillAuto(o,l,s),e=0;e<g;e++)for(r=0;r<f;r++)i._setStyleObject(h+e,_+r,p.getStyle(e,r))}}i._setActiveCellImp(m(t._getFirstVisualRow(),l.row),m(t._getFirstVisualColumn(),l.col),t._activeRowViewportIndex,t._activeColViewportIndex),t._selectionModel&&t._clearSelectionImp(),i.addSelection(l.row,l.col,L(l),j(l))},_copyCells:function(t,e,r,i){var o,n,a,l,s,u=this._sheet,c=u._getActualRange(t),h=u._getActualRange(e),_=c.row,g=c.col,d=L(c),f=j(c),p=h.row,w=h.col,C=L(h),v=j(h),m=this._autoFillExtent[E],y=3===m,F=1===m,S=R(C/d),A=C%d,D=R(v/f),x=v%f;if(0===this._fillSeries){for(o=0;o<S;o++)l=y?p+o*d:p+C-(o+1)*d,u._isRowFilterOut&&u._isRowFilterOut(l)||u._copyToCore(_,g,l,w,d,f,r,!0,void 0,void 0,i);0!==A&&(n=y?_:_+(S+1)*d-C,l=y?p+d*S:p+C-S*d-A,u._isRowFilterOut&&u._isRowFilterOut(l)||u._copyToCore(n,g,l,w,A,f,r,!0,void 0,void 0,i))}else{for(o=0;o<D;o++)s=F?w+o*f:w+v-(o+1)*f,u._copyToCore(_,g,p,s,d,f,r,!0,void 0,void 0,i);0!==x&&(a=F?g:g+(D+1)*f-v,s=F?w+f*D:w+v-D*f-x,u._copyToCore(_,a,p,s,d,x,r,!0,void 0,void 0,i))}},saveState:function(){var t=this._autoFillExtent;4===t[b]?this._clearValueUndoAction.saveState():this._savedStartViewportCells=this._saveRangeStates(t[T]),this._sheet.isDirtySuspended()||(this._savedBeforeFillChangedCells=new F(this._sheet,t[O],16383)),this._savedFilledViewportCells=this._saveRangeStates(t[O])},_saveRangeStates:function(t){var e=this._sheet,r=e._getActualRange(t),i=new x(L(r),j(r));return A(e,i,r.row,r.col,16383),i},undo:function(){var t=this._sheet,e=!1;if(this.canUndo()){this._beforeAction(t,!0);try{f&&t.suspendCalcService();var r=t.getSelections(),i=this._autoFillExtent,o=t._fillDialog,a=i[O];e=4===i[b]?this._undoDragClear(t):this._undoDragFill(t),!t._skipCloseDragFillSmartTag&&o&&o.close(),D(t,a.row,a.col,L(a),j(a),this._savedAfterFilledChangedCells?this._savedAfterFilledChangedCells._getChangedCells():[],1),t._raiseSelectionChanging(r,t.getSelections())&&t._raiseSelectionChanged(r)}catch(t){(0,n.printException)(t),w(t)}finally{this._afterAction(t,!0),f&&t.resumeCalcService(!1)}}return e},_undoDragClear:function(t){var e=this._autoFillExtent[T],r=e.row,i=e.col,o=this._clearValueUndoAction.undo(t);return t._setActiveCellImp(m(t._getFirstVisualRow(),r),m(t._getFirstVisualColumn(),i),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.addSelection(r,i,L(e),j(e)),o},_undoDragFill:function(t){var e=this._autoFillExtent,r=e[T],i=r.row,o=r.col;f&&t.suspendCalcService();try{this._undoRangeStates(this._savedFilledViewportCells,e[O]),this._undoRangeStates(this._savedStartViewportCells,r),t._setActiveCellImp(m(t._getFirstVisualRow(),i),m(t._getFirstVisualColumn(),o),t._activeRowViewportIndex,t._activeColViewportIndex),t._clearSelectionImp(),t.addSelection(i,o,L(r),j(r))}catch(t){(0,n.printException)(t),w(t)}finally{f&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},_undoRangeStates:function(t,e){var r=this._sheet,i=r._getActualRange(e);S._undoCellsInfo(r,t,i.row,i.col,3)}};return p.extend(e.prototype,r),e}(y),Y=function(t){function e(e,r){t.call(this),this._sheet=e,this._fillExtent=r,this._startRange=r[T],this._fillRange=r[O],this._autoFillType=r[b],this._fillDirection=r[E],this._srcRange=r[I]}p.inherit(e,t);var r={execute:function(){var t=!1;if(this.canExecute()){var e=this._sheet,r=this._fillRange;this._beforeAction(e,!0);try{var i=e._eventHandler,o={sheet:e,sheetName:e._name,cancel:!1};o[O]=r,o[b]=this._autoFillType,o[E]=this._fillDirection,this._srcRange&&(o[I]=this._srcRange),e._trigger(h.DragFillBlock,o),o.cancel||(i._currentAutoFillType=o[b],i._isCancelFill=o.cancel,this._executeFillAction(o),delete o.cancel,e._trigger(h.DragFillBlockCompleted,o),t=!0)}catch(t){(0,n.printException)(t),w(t)}finally{this._afterAction(e,!0)}}return t},_executeFillAction:function(t){var e=this._sheet,r=e._eventHandler,i=this._fillRange,o=this._autoFillType;if(r._currentAutoFillType=o,!r._isCancelFill){var n={};n[T]=this._startRange,n[O]=i,n[b]=5===t[b]?o:t[b],n[E]=this._fillDirection;var a=new W(e,n);e.suspendEvent("executeFillAction");try{a.execute()}catch(t){throw t}finally{e.resumeEvent("executeFillAction")}this._fillExtent._fillUndoActionImp=a}},saveState:function(){this._sheet.isDirtySuspended()||(this._savedBeforeFillChangedCells=new F(this._sheet,this._fillRange,16383))},undo:function(){var t=!1;if(this.canUndo()){var e=this._sheet,r=this._fillRange;this.saveState(),this._beforeAction(e);try{t=this._fillExtent._fillUndoActionImp.undo()}catch(t){(0,n.printException)(t),w(t)}finally{this._applyDataChanged(!1,e,r)}}return t},_applyDataChanged:function(t,e,r){this._afterAction(e,t);var i=[];e.isDirtySuspended()||(this._savedAfterFilledChangedCells=new F(e,r,16383),this._savedAfterFilledChangedCells._mergeCellsHasDiffData(this._savedBeforeFillChangedCells._getCellsData()),i=this._savedAfterFilledChangedCells._getChangedCells()),D(e,r.row,r.col,L(r),j(r),i,1)}};return p.extend(e.prototype,r),e}(y);function G(t,e,r,i,o){t._clearSelectionImp(),t.addSelection(e,r,i,o);var n=e>0?e:t._getFirstVisualRow(),a=r>0?r:t._getFirstVisualColumn();t._setActiveCellImp(n,a,t._activeRowViewportIndex,t._activeColViewportIndex)}function Q(t,e){y.call(this),this._sheet=t,this._command=e}p.inherit(Q,y),p.extend(Q.prototype,{canExecute:function(){var t=this._sheet,e=this._command,r=e.fromRow,i=e.fromColumn,o=L(e),a=e.columnCount,l=e.toRow,s=e.toColumn;return!!(0,n.isValidRange)(r,i,o,a,H(t),U(t))&&(!(!e.insert&&!(0,n.isValidRange)(l,s,o,a,H(t),U(t)))&&(t._canChange(l,s,o,a,!!e.insert)&&t._canChange(r,i,o,a)))},execute:function(){var t=!1;if(this.canExecute()){var e,r,i,o=this._sheet,a=this._command;this.saveState();var l=a.fromRow,s=a.fromColumn,u=a.toRow,c=a.toColumn,h=a.rowCount,_=a.columnCount,g=a.option,d=a.collectedCells;this._beforeAction(o,!0);try{if(a.insert){if(s>=0&&l<0){e=s,r=c,i=_;var f=c,p=o._beforeUpdateArrayExprCellsByAddCols&&o._beforeUpdateArrayExprCellsByAddCols(r,i);o.addColumns(r,i,!0),a.copy?(o.copyTo(-1,r<=e?e+i:e,-1,r,-1,i,g),o._updateArrayExprCellsByRowColOps&&p&&o._updateArrayExprCellsByRowColOps(p)):(o.moveTo(-1,r<=e?e+i:e,-1,r,-1,i,g,void 0,d),o._updateArrayExprCellsByRowColOps&&p&&o._updateArrayExprCellsByRowColOps(p),o.deleteColumns(r<=e?e+i:e,i,!0),e<r&&(f=r-i)),G(o,-1,f,H(o),i)}else if(l>=0&&s<0){e=l,r=u,i=h;var w=u;p=o._beforeUpdateArrayExprCellsByAddRows&&o._beforeUpdateArrayExprCellsByAddRows(r,i);o.addRows(r,i,!0),a.copy?(o.copyTo(r<=e?e+i:e,-1,r,-1,i,-1,g),o._updateArrayExprCellsByRowColOps&&p&&o._updateArrayExprCellsByRowColOps(p)):(o.moveTo(r<=e?e+i:e,-1,r,-1,i,-1,g,void 0,d),o._updateArrayExprCellsByRowColOps&&p&&o._updateArrayExprCellsByRowColOps(p),o.deleteRows(r<=e?e+i:e,i,!0),e<r&&(w=r-i)),G(o,w,-1,i,U(o))}}else if(a.copy?o.copyTo(l,s,u,c,h,_,g):o.moveTo(l,s,u,c,h,_,g,{row:u,col:c,rowCount:h,colCount:_},d),o){G(o,u,c,h,_);var C=a._state;a.copy||o.isDirtySuspended()||(C._savedFromAfterPastedChangedCells=this._mergeCellsData(o,C._savedFromViewportCells.data,C._savedFromBeforePastedChangedCells,l,s,h,_)),o.isDirtySuspended()||(C._savedToAfterPastedChangedCells=this._mergeCellsData(o,C._savedToViewportCells.data,C._savedToBeforePastedChangedCells,u,c,h,_))}t=!0}catch(t){(0,n.printException)(t),G(o,l,s,h,_),o._raiseInvalidOperation(0,"string"==typeof t?t:t.message)}finally{o._eventHandler._dragRect={},this._afterAction(o,!0)}}return t},_mergeCellsData:function(t,e,r,i,o,a,l){if(e&&e._isValueOrFormulaSaved()){var s=new F(t,(0,n._createRange)(i,o,a,l),this._command.option);return s._mergeCellsHasDiffData(r._getCellsData()),S._raiseRangeDataChanged(t,i,o,a,l,s._getChangedCells(),0),s}},saveState:function(){var t,e=this._sheet,r=this._command,i=r._state={},o=r.fromRow,a=r.fromColumn,l=r.toRow,s=r.toColumn,u=r.option,c=o<0?0:o,h=a<0?0:a,_=l<0?0:l,g=s<0?0:s,d=o<0?H(e):L(r),f=a<0?U(e):r.columnCount;if(r.insert){if(a<0&&o>=0){var p=e.tables;!r.copy&&p&&p._has(_,-1,1,-1)&&(t=k(e,c,d,u),i._savedFromRowHeaderCells=t.headerCells,i._savedFromRows=t.rows,i._savedFromViewportCells=P(e,c,h,d,f,u))}}else o<0&&(t=M(e,g,f,u),i._savedToColumnHeaderCells=t.headerCells,i._savedToColumns=t.columns,r.copy||(t=M(e,h,f,u),i._savedFromColumnHeaderCells=t.headerCells,i._savedFromColumns=t.columns)),a<0&&(t=k(e,_,d,u),i._savedToRowHeaderCells=t.headerCells,i._savedToRows=t.rows,r.copy||(t=k(e,c,d,u),i._savedFromRowHeaderCells=t.headerCells,i._savedFromRows=t.rows)),i._savedToTables=N(e,_,g,d,f),i._savedToViewportCells=P(e,_,g,d,f,u),r.copy||(i._savedFromTables=N(e,c,h,d,f),i._savedFromViewportCells=P(e,c,h,d,f,u),e.isDirtySuspended()||(i._savedFromBeforePastedChangedCells=new F(e,(0,n._createRange)(c,h,d,f),u))),e.isDirtySuspended()||(i._savedToBeforePastedChangedCells=new F(e,(0,n._createRange)(_,g,d,f),u));i._savedAcitveRowViewportIndex=e._activeRowViewportIndex,i._savedAcitveColumnViewportIndex=e._activeColViewportIndex,i._savedActiveRow=e._activeRowIndex,i._savedActiveColumn=e._activeColIndex},undo:function(){var t=0;if(this.canUndo()){var r,i,o,a=this._sheet,l=this._command,s=l.fromRow,u=l.fromColumn,c=l.toRow,h=l.toColumn,_=L(l),g=l.columnCount;if(!(0,n.isValidRange)(s,u,_,g,H(a),U(a)))return!1;if(!l.insert&&!(0,n.isValidRange)(c,h,_,g,H(a),U(a)))return!1;var d=l._state;this._beforeAction(a,!0);try{if(l.insert){if(!(u>=0&&s>=0))if(u>=0){var f=u;r=g,l.copy?a.deleteColumns(h,r):(i=h,o=u,u<h?i=h-r:o=u+r,a.addColumns(o,r),a.copyTo(-1,o<=i?i+r:i,-1,o,-1,r,l.option),a.deleteColumns(o<=i?i+r:i,r),i<o&&(f=o-r)),a&&G(a,-1,f,H(a),r),t++}else if(s>=0){r=_;var p=s;l.copy?a.deleteRows(c,r):(i=c,o=s,s<c?i=c-r:o=s+r,a.addRows(o,r),t+=V(this,d._savedFromViewportCells),t+=V(this,d._savedFromRowHeaderCells),(t+=V(this,d._savedFromRows))||a.copyTo(o<=i?i+r:i,-1,o,-1,r,-1,l.option),a.deleteRows(o<=i?i+r:i,r),i<o&&(p=o-r)),a&&G(a,p,-1,r,U(a)),t++}}else{var C=s<0?0:s,v=u<0?0:u,m=c<0?0:c,R=h<0?0:h,y=s<0?H(a):_,F=u<0?U(a):g;e._supportsCalc&&S._clearFormula(a,m,R,y,F);var A=null,D=null,x=d._savedFromViewportCells;!l.copy&&x&&x.data&&x.data._isValueOrFormulaSaved()&&(D=S._getValues(a,C,v,y,F));var T=d._savedToViewportCells;T&&T.data&&T.data._isValueOrFormulaSaved()&&(A=S._getValues(a,m,R,y,F)),t+=V(this,d._savedToTables),t+=V(this,d._savedToColumnHeaderCells),t+=V(this,d._savedToColumns),t+=V(this,T),t+=V(this,d._savedToRowHeaderCells),t+=V(this,d._savedToRows),t+=V(this,d._savedFromTables),t+=V(this,d._savedFromColumnHeaderCells),t+=V(this,d._savedFromColumns),t+=V(this,x),t+=V(this,d._savedFromRowHeaderCells),(t+=V(this,d._savedFromRows))&&a&&(G(a,s,u,_,g),A&&S._raiseRangeDataChanged(a,m,R,y,F,d._savedToAfterPastedChangedCells?d._savedToAfterPastedChangedCells._getChangedCells():[],0),D&&S._raiseRangeDataChanged(a,C,v,y,F,d._savedFromAfterPastedChangedCells?d._savedFromAfterPastedChangedCells._getChangedCells():[],0))}if(t&&a){if(-1!==d._savedActiveRow&&-1!==d._savedActiveColumn){var O=a.getSelections()[0];O.contains(d._savedActiveRow,d._savedActiveColumn)?a._setActiveCellCore(d._savedActiveRow,d._savedActiveColumn):a._setActiveCellCore(O.row,O.col)}-2!==d._savedAcitveRowViewportIndex&&-2!==d._savedAcitveColumnViewportIndex&&-1!==d._savedActiveRow&&-1!==d._savedActiveColumn&&a.showCell(d._savedActiveRow,d._savedActiveColumn,3,3)}}catch(t){(0,n.printException)(t),w(t)}finally{this._afterAction(a,!0)}}return t>0}});e.sheetEx={fillAuto:function(t,e,r){if(!e)throw new Error((0,o.sR)().Exp_RangeIsNull);var i=r.fillType,n=r.series,a=r.direction,u=r.step,c=r.stop,h=new s.default(this);(function(t,e,r,i){return!!(t&&e&&e.containsRange(t))&&(!v(r)&&(1===r&&t.row===e.row&&L(t)===L(e)||0===r&&t.col===e.col&&j(t)===j(e))||!(v(i)||(2!==i&&3!==i||t.col!==e.col||j(t)!==j(e))&&(0!==i&&1!==i||t.row!==e.row||L(t)!==L(e))))})(t,e,a?null:n,a)&&(t&&(this._eventHandler._fillStartRange=t),4===i?h._fillAuto(e,n,!1,r.withTag):0===i?h._fillAutoByDirection(e,a):1===i||2===i?h._fillLinearOrGrowth(1===i,e,n,u,c):3===i&&h._seriesFillRange(e,n,3,u,v(c)?null:l.default._DateTimeHelper._toOADate(c),r.unit),this._invalidate())}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(4),o=r(1),n=r.n(o),a=r(0),l=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),s=n.a.GC$,u=n.a._BaseDialog,c=a._getPreferredZIndex,h=a.device,_=s(document),g=" btn btn-default",d="sm-sheet-fill-type-item",f="sm-sheet-fill-menu-container",p="ui-icon ui-icon-check sm-sheet-check-image",w="sm-sheet-menu-item-input",C="ui-state-active sm-sheet-smart-tag-active",v="sm-sheet-tag-container",m="float",R="left",y="display",F="width",S="height",A="margin";function D(t,e,r,i,o,n){var l=t._isTouchMode,u=l?"160px":"150px",c=l?"25px":"20px",h=s(Object(a.createElement)("div")).css([y,F,S,"padding",A],["block",u,c,0,0]).addClass("sm-sheet-smartMenu-item-default "+r+" ui-state-default"+g),_=s(Object(a.createElement)("div")).addClass(w).appendTo(h),d=s(Object(a.createElement)("div")).addClass("sm-sheet-menu-item-text").appendTo(h),f=s(Object(a.createElement)("input")).attr({id:e,value:o,type:"radio",name:"fill-group",style:"display:none"}).appendTo(_);return s(Object(a.createElement)("span")).text(i).appendTo(d),n?(_.addClass(p),f.prop("checked","checked")):f.prop("checked",""),h}var x=function(t){function e(e,r){var o=t.call(this,e,c(r.parent._host))||this;o._sheet=r,o._smartTagContainer=s("."+v);var n=o._menuContainer=o._getContainer();return n.addClass(f),D(r,"smartMenuCopyCells",d,Object(i.sR)().CopyCells,"0",!0).appendTo(n),D(r,"smartMenuFillSeries",d,Object(i.sR)().FillSeries,"1").appendTo(n),D(r,"smartMenuFillFormattingOnly",d,Object(i.sR)().FillFormattingOnly,"2").appendTo(n),D(r,"smartMenuFillWithoutFormatting",d,Object(i.sR)().FillWithoutFormatting,"3").appendTo(n),o}return l(e,t),e.prototype._attachEvent=function(){var t=this;s("."+d).bind("mouseover",function(t){s(t.elementItem).addClass("ui-state-hover sm-sheet-smartMenu-item-hover")}).bind("mouseout",function(t){s(t.elementItem).removeClass("ui-state-hover sm-sheet-smartMenu-item-hover")}).bind("click",function(e){var r=s(e.elementItem),i=t._smartTagContainer,o=r.find("input[type=radio]"),n=o[0];n.checked=!0,o.trigger("change"),i.trigger("click"),i.trigger("mouseout"),r.removeClass("ui-state-hover sm-sheet-smartMenu-item-hover");var a=parseInt(s(n).attr("value"));t._changeFill(a)}),this._menuContainer.find("input[type=radio]").bind("change",function(t){s("."+w).removeClass(p),s(t.elementItem).parent().addClass(p)})},e.prototype._dettachEvent=function(){s("."+d).unbind("mouseover").unbind("mouseout").unbind("click"),this._menuContainer.find("input[type=radio]").unbind("change")},e.prototype._changeFill=function(t){var e=this._sheet,r=e._eventHandler;this._fillType!==t&&(this._fillType=t,e._skipCloseDragFillSmartTag=!0,e._skipCloseDragFillSmartTag=!1,e._commandManager().execute({cmd:"fill",sheetName:e.name(),startRange:r._fillStartRange,fillRange:r._currentFillRange,autoFillType:t,fillDirection:r._currentFillDirection}),this._smartTagContainer.trigger("fillTypeChanged",t))},e.prototype._isOpen=function(){return!!s("."+f).length},e}(u);function T(t){return t?"data:image/png;base64,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":"data:image/png;base64,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"}var O=function(t){function e(e,r,i){var o=t.call(this,e,c(r.parent._host))||this;o._sheet=r,o._fillInfo=i;var n=o._tagContainer=o._getContainer().addClass("sm-sheet-smart-tag-default "+v+" sm-sheet-no-select ui-widget-header"+g);return o._smartTag=s(Object(a.createElement)("img")).attr("src",T(0)).css(m,R).appendTo(n),o._smartTagDown=s(Object(a.createElement)("img")).attr("src",T(1)).css([m,y],[R,"none"]).appendTo(n),o}return l(e,t),e.prototype._doMouseEvent=function(t,e,r){var i=this._sheet._isTouchMode,o=s(e),n=this._menuDialog,a=this._smartTagDown,l=i?"38px":"32px",u=i?"24px":"18px";n&&n._isOpen()||(t?o.addClass("ui-state-hover sm-sheet-smart-tag-hover"):o.removeClass("ui-state-hover sm-sheet-smart-tag-hover"),o.css([F,S],[t?l:u,u]),r||(t?a.show():a.hide()))},e.prototype._registerEvent=function(){var t=this,e=t._tagContainer,r=h(),i=a.browser.safari&&(r.ipad||r.iphone);e.bind("mouseover",function(e){t._doMouseEvent(!0,e.elementItem,i)}).bind("mouseout",function(e){t._doMouseEvent(!1,e.elementItem,i)}),e.bind("click",function(e){var r=s(e.elementItem),o=t._menuDialog,n=t._smartTagDown;if(o&&o._isOpen())i&&n.hide(),r.removeClass(C),t._closeMenu();else{i&&n.show(),r.addClass(C),t._openMenu();var a=t._menuContainer,l=a&&a.find("input[type=radio]")[t._fillInfo.fillType];l&&!l.checked&&(l.checked=!0,s(l).trigger("change"))}}),_.bind("keydown.ui-fill",function(e){27===e.keyCode&&(t._menuDialog&&t._menuDialog._isOpen()?t._closeMenu():t.close(),Object(a.cancelDefault)(e))})},e.prototype._open=function(){var t=this._tagContainer,e=this._fillInfo,r=this._sheet._isTouchMode,i=r?"3px":"0px",o=r?"24px":"18px";t&&(t.css([R,"top"],[e.x,e.y])(this)._show(),this._registerEvent(),this._smartTag.css(A,i),this._smartTagDown.css(S,o),this._reset())},e.prototype._openMenu=function(){var t=this._sheet;this._menuDialog||(this._menuDialog=new x(t.parent._getContainerDiv(),t),this._menuContainer=this._menuDialog._getContainer());var e=this._tagContainer,r=e.css(R),i=e.css("top"),o=parseFloat(i),n=this._menuDialog,a=this._fillInfo;n._fillType=a.fillType,isNaN(o)||(i=o+e.height()+2),this._menuContainer.css([R,"top"],[r,i]),n._show(),n._attachEvent(),n._smartTagContainer.unbind("fillTypeChanged").bind("fillTypeChanged",function(t,e){a.fillType=e})},e.prototype._closeMenu=function(){var t=this._menuDialog;t&&(t._dettachEvent(),t.close())},e.prototype._reset=function(){var t=this._menuDialog,e=this._tagContainer;t&&(t._isOpen()&&e.trigger("click"),e.trigger("mouseout"))},e.prototype.close=function(){var e=this._sheet;this._reset(),_.unbind("keydown.ui-fill"),t.prototype.close.call(this),e&&e._setFocus()},e}(u);e.default=O},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"state",function(){return o}),r.d(e,"STATES",function(){return n});var i=r(3),o=(0,r.n(i).a.makeState)(),n={dragFillIndicatorRect:"_dragFillIndicatorRect",dragOldRect:"_dragOldRect",insertDragRect:"_insertDragRect"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._paintDragFillIndicator=function(t,e,r,i,o,s){var c=t._sheet,h=c._getSheetLayout(),_=c.parent,g=_&&_._themeVersion,d=function(t,e,r){var i=t._sheet,o=e.x,n=e.y,a=e.width,s=e.height,u=i._getActiveSelectedRange(),c=i._getSheetLayout(),h=4,_=-2.5;r>2007&&(h=5,_=-3);var g=new l(-4,-4,h,h);-1===u.col?(g.x=c._frozenX,g.y=n+s+_):-1===u.row?(g.x=o+a+_,g.y=c._frozenY):(g.x=o+a+_,g.y=n+s+_);return g}(t,o,g),f=d.x,p=d.y,w=d.width,C=d.height,v=h._viewportRect(r,i);if((!s||d.intersectRect(s))&&d.intersectRect(v)){var m=-1.5;g>2007&&(m=-1);var R=new l(f+m,p+m,w+2,C+2);R.x=Math.max(R.x,v.x),R.y=Math.max(R.y,v.y),t._commitPaintSync([u({rect:R})]),e.save(),s&&!s.containsRect(d)&&(e.rect(s.x,s.y,s.width,s.height),e.clip()),e.beginPath(),e.fillStyle=Object(a._getColor)(c,c.getSelectionBorderColor()),e.fillRect(f,p,w,C),Object(n.state)(n.STATES.dragFillIndicatorRect,new l(d.x,d.y,4,4)),e.beginPath(),e.restore()}},e._paintDragRectangle=function(t,e){var r=e.x,i=e.y,o=r+e.width,n=i+e.height;p(t,r,i,o,i),p(t,r,n,o,n),p(t,r,i,r,n),p(t,o,i,o,n)},e._paintDragInsertLine=_,e._paintDragDropRectangle=g,e._paintDragDropIndicator=f,e._refreshDragDropIndicator=function(t){var e=t._sheet,r=e._currentTarget;if(!r||!r.dragInfo)return;var i=t._getCtx(),o=e._getSheetLayout(),a=e._eventHandler._actualDragRange,s=e._eventHandler._dragRect;-1===s.row&&(s.col=a.col);-1===s.col&&(s.row=a.row);var u=e._getRangeWholeRect(a),c=e.frozenTrailingColumnCount(),h=e.frozenTrailingRowCount(),_=e.getColumnCount()-c,g=e.getRowCount()-h,d=o._viewportRect(1,1);c>0&&a.col+a.colCount<=_&&u.x+u.width>d.x+d.width&&u.intersectRect(d)&&(u=u.getIntersectRect(d));h>0&&a.row+a.rowCount<=g&&u.y+u.height>d.y+d.height&&u.intersectRect(d)&&(u=u.getIntersectRect(d));var p=new l(o._frozenX,o._frozenY,o._frozenTrailingX+o._frozenTrailingWidth,o._frozenTrailingY+o._frozenTrailingHeight);u.width>0&&u.height>0?(s.x=u.x,s.y=u.y,s.width=u.width-1,s.height=u.height-1,f(t,i,p)):0!==u.width&&0!==u.height||(s.x=u.x,s.y=u.y,s.width=u.width,s.height=u.height,f(t,i,p));!0===e._eventHandler._isDragInsert?Object(n.state)(n.STATES.dragOldRect,Object(n.state)(n.STATES.insertDragRect)):Object(n.state)(n.STATES.dragOldRect,new l(s.x,s.y,s.width,s.height))};var i=r(1),o=r.n(i),n=r(11),a=r(0),l=o.a.Rect,s=o.a._createLine,u=o.a._Directive_CopyBuffer,c=o.a._Directive_RepaintSelection,h="#71a1e6";function _(t,e){t.save(),t.strokeStyle=h,t.beginPath();var r=0===e.height?.1:e.height,i=0===e.width?.1:e.width;t.rect(e.x,e.y,i,r),t.closePath(),t.lineWidth=2,t.lineJoin="miter",t.stroke(),t.restore()}function g(t,e){t.save(),t.strokeStyle=h,t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.closePath(),t.lineWidth=2,t.lineJoin="miter",t.setLineDash([4,4]),t.stroke(),t.restore()}function d(t,e,r){var i=t._sheet;t._commitPaintSync([u({rect:e,clipRect:r}),c({range:i._getActiveSelectedRange(),clipRect:r})])}function f(t,e,r){var i=t._sheet,o=i._eventHandler._dragRect,a=o.hitTarget;if(o&&a){var s=o.hitCol,u=o.hitRow,c=i._eventHandler._isDragInsert,h=Object(n.state)(n.STATES.dragOldRect);if(e.save(),!0!==c||-1!==o.row&&-1!==o.col)h&&d(t,new l(h.x-2,h.y-2,h.width+4,h.height+4),r),g(e,o);else if(-1===o.row&&-1!==o.col){var f=i._getColumnLayout(0).findCol(s);if(f||(f=i._getColumnLayout(1).findCol(s)),f||(f=i._getColumnLayout(2).findCol(s)),f){var p=f.x,w=f.width;o.col=s,a.x>p+w/2&&(o.col<i._getLastFullyVisibleColumn()||o.col===i._getLastVisualColumn())&&(p=f.x+f.width,o.col++),h&&0===h.width||(h=i._eventHandler._dragRect),h&&d(t,new l(h.x-2,h.y-2,h.width+4,h.height+4),r);var C=new l(p,o.y,0,o.height);Object(n.state)(n.STATES.insertDragRect,C),_(e,C)}}else if(-1!==o.row&&-1===o.col){var v=i._getRowLayout(0).findRow(u);if(v||(v=i._getRowLayout(1).findRow(u)),v||(v=i._getRowLayout(2).findRow(u)),v){var m=v.y,R=v.height;o.row=u,a.y>m+R/2&&(o.row<i._getLastFullyVisibleRow()||o.row===i._getLastVisualRow())&&(m=v.y+v.height,o.row++),h&&0===h.height||(h=i._eventHandler._dragRect),h&&d(t,new l(h.x-2,h.y-2,h.width+4,h.height+4),r);C=new l(o.x,m,o.width,0);Object(n.state)(n.STATES.insertDragRect,C),_(e,C)}}e.beginPath(),e.restore()}}function p(t,e,r,i,o){var n;t.globalCompositeOperation="source-over",t.strokeStyle=h,t.save(),e===i?(t.rect(e-2,r,7,Math.abs(o-r)),t.clip(),t.beginPath(),r<o?(r-=3,o+=3):(r+=3,o-=3),n=s(e,r,i,o,"black",2)):r===o&&(t.rect(e,r-2,Math.abs(i-e),7),t.clip(),t.beginPath(),e<i?(e-=3,i+=3):(e+=3,i-=3),n=s(e,r,i,o,"black",1)),n._paintLine(t),t.stroke(),t.beginPath(),t.restore()}},function(t,e,r){"use strict";r.d(e,"a",function(){return i}),r.d(e,"d",function(){return o}),r.d(e,"e",function(){return n}),r.d(e,"f",function(){return a}),r.d(e,"c",function(){return l}),r.d(e,"b",function(){return s});var i={copyCells:0,fillSeries:1,fillFormattingOnly:2,fillWithoutFormatting:3,clearValues:4,auto:5},o={left:0,right:1,up:2,down:3},n={column:0,row:1},a={direction:0,linear:1,growth:2,date:3,auto:4},l={day:0,weekday:1,month:2,year:3},s={FILL:"fill",DRAG_DROP:"dragDrop"}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.install=function(t){Object(i._CopyProperty)(t.Worksheet.prototype,o.sheetEx),Object(i._CopyProperty)(t.Worksheet.prototype,n.sheetEx),Object(i._CopyProperty)(t._SheetEventHandler.prototype,n.sheetEventHandlerExt),Object(h.a)(),Object(c.a)(),f("Fill")},e.initSpread=function(t){var e=t.getActiveSheet();e&&Object(o.regiterCmds)(e._commandManager())},r.d(e,"SR",function(){return p}),r.d(e,"_FillDialog",function(){return w}),r.d(e,"_FillImp",function(){return C});var i=r(0),o=r(9),n=(r.n(o),r(22)),a=(r.n(n),r(4)),l=r(10),s=r(7),u=r.n(s),c=r(23),h=r(24),_=r(1),g=r.n(_),d=r(13);r.d(e,"AutoFillType",function(){return d.a}),r.d(e,"FillDirection",function(){return d.d}),r.d(e,"FillSeries",function(){return d.e}),r.d(e,"FillType",function(){return d.f}),r.d(e,"FillDateUnit",function(){return d.c}),r.d(e,"COMMANDS",function(){return d.b});var f=g.a.activateFeatures;var p=a.SR,w=l.default,C=u.a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={CopyCells:"Copy Cells",FillSeries:"Fill Series",FillFormattingOnly:"Fill Formatting Only",FillWithoutFormatting:"Fill Without Formatting",Exp_NumberOnly:"Only works for Numbers",Exp_RangeContainsMergedCell:"Range should not have merged cells.",Exp_TargetContainsMergedCells:"Target range should not have merged cells.",Exp_MergedCellsIdentical:"This operation requires the merged cells to be identically sized.",Exp_FillRangeContainsMergedCell:"Cannot fill range that contains a merged cell.",Exp_FillCellsReadOnly:"The cells you are trying to fill are protected and therefore read-only.",Exp_ChangeMergedCell:"Cannot change part of merged cell.",Exp_ColumnReadOnly:"The column you are trying to change is protected and therefore read-only.",Exp_RowReadOnly:"The row you are trying to change is protected and therefore read-only.",Exp_CellReadOnly:"The cell you are trying to change is protected and therefore read-only.",Exp_RangeIsNull:"range is null",Exp_ChangePartOfArray:"Cannot change part of an array."}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(17),o=r(18),n=r(19),a=r(20),l=r(21);r.d(e,"NumberSource",function(){return i.a}),r.d(e,"DaySource",function(){return o.a}),r.d(e,"MonthSource",function(){return n.a}),r.d(e,"SerialStringSource",function(){return a.a}),r.d(e,"DateSource",function(){return l.a})},function(t,e,r){"use strict";var i=r(5),o=r(0),n=r(3),a=r.n(n),l=r(2),s=r.n(l),u=r(4),c=r(6),h=r.n(c),_=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),g=a.a._isNullOrUndefined,d=a.a._toDouble,f=s.a._trendSerial,p=s.a._trend,w=h.a.Convert,C=function(t){function e(e){var r=t.call(this,e)||this;return r._indexes=[],r._innerValues=[],r._type=null,r._startIndex=g(e)?-1:e,r}return _(e,t),e.prototype.increase=function(t,e){var r=Object(o.getValType)(t);if(this._isSerialNumber(r)){var i=t.split(".");return i[i.length-1]=String(+i[i.length-1]+e),i.join(".")}return t+e},e.prototype.trend=function(t,e,r,i,o,n,a,l){var s=[t,e,r,i,o,n,a,l];return this._isSerialNumber()?f.apply(null,s):p.apply(null,s)},e.prototype._values=function(){var t,e,r=[],i=this._innerValues,o=i?i.length:0;for(t=0;t<o;t++)e=i[t],r.push("object"===this._type?this._toDateTime(e):e);return r},e.prototype._insert=function(t,e,r){var i=r;if(!Object(o.isNumber)(i))throw new Error(Object(u.sR)().Exp_NumberOnly);g(this._type)&&(this._type=Object(o.getValType)(i)),this._isSerialNumber()||(i=d(i)),this._indexes.splice(t,0,e),this._innerValues.splice(t,0,i)},e.prototype.add=function(t,e){var r=e;g(this._type)&&(this._type=Object(o.getValType)(r)),this._isSerialNumber()||(r=d(r)),this._indexes.push(t),this._innerValues.push(r)},e.prototype._toActualValue=function(t){return this._type===o.DATE_STRING?this._toDateTime(t):t},e.prototype._toDateTime=function(t){var e=null;if(t instanceof Date)e=t;else if(w)try{e=w._toDateTime(t)}catch(r){Object(o.printException)(r),e=t}return e},e.prototype._isSerialNumber=function(t){return-1!==(t=t||this._type).indexOf(o.SER_NUMBER_STRING)},e}(i.a);e.a=C},function(t,e,r){"use strict";var i=r(5),o=r(0),n=r(3),a=r.n(n),l=r(2),s=r.n(l),u=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),c=s.a._DayList,h=s.a._DayListAlias,_=s.a._DayLen,g=s.a._getDayByIndex,d=a.a._isNullOrUndefined,f=function(t){function e(e){var r=t.call(this,e)||this;return r._indexes=[],r._innerValues=[],r._type=null,r._useSundayAlias=!1,r._startIndex=d(e)?-1:e,r._days=c,r._dayAlias=h,r._dayLength=_,r._SundayAlias="天",r}return u(e,t),e.prototype.valueConverter=function(){var t,e,r=this,i=this._innerValues;return i&&i.length?i.map(function(i,o){if(i=r._getDayNumber(String(i)),e=r._useSundayAlias?r._dayAlias.indexOf(String(i)):r._days.indexOf(String(i)),t=0===o?e:t,o>0)for(;e<t;)e+=r._dayLength;return e}):null},e.prototype.getTrendOrGrowthValue=function(e,r,i,o){if(o=o||this.valueConverter(),i=i||this._indexes2(),e&&o&&i){var n=o.length%this._dayLength||this._dayLength;o=o.slice(0-n),i=i.slice(0-n)}return t.prototype.getTrendOrGrowthValue.call(this,e,r,i,o)},e.prototype.increase=function(t,e){var r=this._getDayNumber(t),i=r===this._SundayAlias?6:this._days.indexOf(r);return i+=e,(this._type===o.DATE_STRING?t.slice(0,2):t[0])+g(i)},e.prototype.add=function(e,r){this._useSundayAlias||this._getDayNumber(r)!==this._SundayAlias||(this._useSundayAlias=!0),t.prototype.add.call(this,e,r)},e.prototype.resultConverter=function(t){var e=g(t,this._useSundayAlias);return e?e=this._type===o.DAY_STRING?"星期"+e:"周"+e:null},e.prototype._getDayNumber=function(t){return t[t.length-1]},e}(i.a);e.a=f},function(t,e,r){"use strict";var i=r(5),o=r(3),n=r.n(o),a=r(2),l=r.n(a),s=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),u=l.a._getMonthByIndex,c=l.a._MonthListAlias,h=l.a._MonthList,_=n.a._isNullOrUndefined,g=function(t){function e(e){var r=t.call(this,e)||this;return r._monthInNumber=!1,r._MonthLen=12,r._indexes=[],r._innerValues=[],r._type=null,r._startIndex=_(e)?-1:e,r}return s(e,t),e.prototype.increase=function(t,e){t=this._getMonthNumber(t);var r=this._isMonthInNumber(t),i=r?c.indexOf(t):h.indexOf(t);return u(i+e,r)+"月"},e.prototype.add=function(e,r){!this._monthInNumber&&this._isMonthInNumber(r)&&(this._monthInNumber=!0),t.prototype.add.call(this,e,r)},e.prototype.valueConverter=function(){var t,e,r=this,i=this._innerValues;return i&&i.length?i.map(function(i,o){if(i=String(i).replace("月",""),e=r._isMonthInNumber(i)?c.indexOf(i):h.indexOf(i),t=0===o?e:t,o>0)for(;e<t;)e+=r._MonthLen;return e}):null},e.prototype.getTrendOrGrowthValue=function(e,r,i,o){if(o=o||this.valueConverter(),i=i||this._indexes2(),e&&o&&i){var n=o.length%this._MonthLen||this._MonthLen;o=o.slice(0-n),i=i.slice(0-n)}return t.prototype.getTrendOrGrowthValue.call(this,e,r,i,o)},e.prototype.resultConverter=function(t){var e;return(e=u(t,this._monthInNumber))?e+"月":null},e.prototype._isMonthInNumber=function(t){return/^\d/.test(t.replace("月",""))},e.prototype._getMonthNumber=function(t){return t.replace("月","")},e}(i.a);e.a=g},function(t,e,r){"use strict";var i=r(5),o=r(3),n=r.n(o),a=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),l=n.a._isNullOrUndefined,s=function(t){function e(e){var r=t.call(this,e)||this;return r._indexes=[],r._innerValues=[],r._type=null,r._prefixReg=/\d+$/,r._startIndex=l(e)?-1:e,r}return a(e,t),e.prototype.valueConverter=function(){var t=this,e=this._innerValues;if(e&&e.length){var r=[];return e.forEach(function(e){var i=t.getPrefixRegMatch(String(e));i&&i[0]&&r.push(Number(i[0]))}),r}return null},e.prototype.increase=function(t,e){var r=this.getPrefixRegMatch(t);return r?t.slice(0,r.index)+(Number(r[0])+e):null},e.prototype.patternMatch=function(t){if(!this._dataCount())return!0;var e=this.getInvalidZeroCnt(String(this._innerValues[0])),r=this.getInvalidZeroCnt(t),i=e!==r&&0!==e&&0!==r;return this.getPrefix(String(this._innerValues[0]))===this.getPrefix(t)&&!i},e.prototype.resultConverter=function(t){t=Math.abs(Number(t)).toString();for(var e=this.getPrefix(String(this._innerValues[0])),r=String(this._innerValues[0]).replace(e,"");t.length<r.length;)t="0"+t;return e+t},e.prototype.getPrefix=function(t){var e=this.getPrefixRegMatch(t);return e?t.slice(0,e.index):""},e.prototype.getInvalidZeroCnt=function(t){for(var e=this.getPrefixRegMatch(t),r=0,i=e&&e[0];i&&"0"===i[r];)r++;return r},e.prototype.getPrefixRegMatch=function(t){return t.match(this._prefixReg)},e}(i.a);e.a=s},function(t,e,r){"use strict";var i=r(5),o=r(0),n=r(3),a=r.n(n),l=r(2),s=r.n(l),u=r(4),c=r(6),h=r.n(c),_=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),g=a.a._isNullOrUndefined,d=a.a._toDouble,f=s.a._trend,p=s.a._DateTimeHelper,w=h.a.Convert,C=function(t){function e(e){var r=t.call(this,e)||this;return r._indexes=[],r._innerValues=[],r._type=o.DATE_STRING,r._startIndex=g(e)?-1:e,r}return _(e,t),e.prototype.increase=function(t,e){return t+e},e.prototype.trend=function(t,e,r,i,n,a,l,s){for(var u,c=[],h=[],_=[],g=[],d=0,w=t[0].length;d<w;d++)t[0][d]=Math.floor(t[0][d]),u=this._toDateTime(t[0][d]),c.push(u.getFullYear()),h.push(u.getMonth()+1),g.push(12*u.getFullYear()+u.getMonth()+1),_.push(u.getDate());var C=Object(o.isAllSame)(c),v=Object(o.isAllSame)(h);if(!(!Object(o.isAllSame)(_)||C&&v)){var m=[],R=_[0],y=e[0].length,F=e[0][y-1],S=(F-e[0][0])/(y-1);if(C&&!v)if(Object(o.isSameStep)(h))for(var A=c[0],D=h[1]-h[0],x=0,T=r[0];x<T.length;x++){(B=((k=T[x])-F)/S*D+h[h.length-1])>12&&(A+=Math.floor(B/12),B%=12),m.push([p._toOADate(new Date(A,B-1,R))])}else m=this._copyFromKnowY(t,e,r);else if(!C&&v)if(Object(o.isSameStep)(c))for(var O=c[1]-c[0],b=0,E=r[0];b<E.length;b++){var I=((k=E[b])-F)/S*O+c[c.length-1];m.push([p._toOADate(new Date(I,h[0]-1,R))])}else m=this._copyFromKnowY(t,e,r);else if(Object(o.isSameStep)(g)){A=c[c.length-1],D=g[1]-g[0];for(var V=0,M=r[0];V<M.length;V++){(B=((k=M[V])-F)/S*D+h[h.length-1])>12&&(A+=Math.floor(B/12),B%=12),m.push([p._toOADate(new Date(A,B-1,R))])}}else if(Object(o.isSameStep)(c)&&Object(o.isSameStep)(h)){D=h[1]-h[0],O=c[1]-c[0];for(var P=0,N=r[0];P<N.length;P++){var k,B;I=((k=N[P])-F)/S*O+c[c.length-1];(B=(k-F)/S*D+h[h.length-1])>12&&(I+=Math.floor(B/12),B%=12),m.push([p._toOADate(new Date(I,B-1,R))])}}else m=this._copyFromKnowY(t,e,r);return m}if(!Object(o.isSameStep)(t[0]))return this._copyFromKnowY(t,e,r);var L=[t,e,r,i,n,a,l,s];return f.apply(null,L)},e.prototype._copyFromKnowY=function(t,e,r){for(var i=[],o=0,n=r[0].length;o<n;o++)i.push([t[0][(r[0][o]-e[0][0])%e[0].length]]);return i},e.prototype._values=function(){for(var t=[],e=this._innerValues,r=e?e.length:0,i=0;i<r;i++)t.push(e[i]);return t},e.prototype._insert=function(t,e,r){var i=r;if(!Object(o.isNumber)(i))throw new Error(Object(u.sR)().Exp_NumberOnly);g(this._type)&&(this._type=Object(o.getValType)(i)),this._indexes.splice(t,0,e),this._innerValues.splice(t,0,d(i))},e.prototype.add=function(t,e){var r=e;g(this._type)&&(this._type=Object(o.getValType)(r)),this._indexes.push(t),this._innerValues.push(d(r))},e.prototype._toActualValue=function(t){return this._toDateTime(t)},e.prototype._toDateTime=function(t){var e=null;if(t instanceof Date)e=t;else if(w)try{e=w._toDateTime(t)}catch(r){Object(o.printException)(r),e=t}return e},e}(i.a);e.a=C},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sheetEx=e.sheetEventHandlerExt=void 0;var i=r(4),o=g(r(10)),n=r(11),a=r(12),l=g(r(1)),s=g(r(6)),u=g(r(2)),c=g(r(7)),h=g(r(8)),_=r(0);function g(t){return t&&t.__esModule?t:{default:t}}var d=l.default._Directive_CopyBuffer,f=l.default._Directive_RepaintSelection,p=l.default.GC$,w=_._createRange,C=l.default._supportsCalc,v=l.default.Events,m=u.default._Types._isNullOrUndefined,R=l.default._getFeatureManager,y=l.default.HookNames,F=R("Worksheet"),S=Math.min,A=Math.abs,D=Math.max,x="drag";function T(t){return t.rowViewportIndex}function O(t){return t.colViewportIndex}function b(t){return t.hitTestType}function E(t,e){return t.getRowCount(e)}function I(t,e){return t.getColumnCount(e)}function V(t){return t.colCount}function M(t){return t.rowCount}function P(t,e,r,i,o,n,a,l,s,u,c,h){var _=e?v.DragDropBlock:v.DragDropBlockCompleted,g={sheet:t,sheetName:t._name,fromRow:r,fromCol:i,toRow:o,toCol:n,rowCount:a,colCount:l,copy:s,insert:u,copyOption:c,collectedCells:h},d=e?"dragDropBlock":"dragDropBlockCompleted";return e&&(g.cancel=!1),F.callHook(y.Worksheet[d],this,g),t._trigger(_,g),g.cancel}function N(t){var e=t.sheet,r=t.fromRow,o=t.fromCol,n=t.rowCount,a=t.colCount,l=t.toRow,s=t.toCol,u=t.isDragInsert,c=t.isDragCopy,h=e.options.dragDropCopyToOptions||16383,_={},g="",d=3,f=!1,p=!1,m=!1;if(e._trigger(v.BeforeDragDrop,t),!(g=t.invalidMessage)||0===g.length){var R=e._getActualRange(w(r,o,n,a)),y=e._getActualRange(w(l,s,n,a)),F=!e.isRangeEditable(R),S=!e.isRangeEditable(y);(F||S)&&(f=!0,e.parent.options.showPermissionError&&e.parent.options.showPermissionError({ranges:F?[R]:[y]})),!u||-1!==r&&-1!==o?l===r&&s===o||((e._hasPartSpans(r,o,n,a)||e._hasPartSpans(l,s,n,a))&&(f=!0,g=(0,i.sR)().Exp_ChangeMergedCell),f||C&&(e._hasPartArrayFormulas(r,o,n,a)||e._hasPartArrayFormulas(l,s,n,a))&&(f=!0,d=4,g=(0,i.sR)().Exp_ChangePartOfArray),f||(c||e.isRangeReadable(R)?c||e.isRangeEditable(y)||(e.parent.options.showPermissionError&&e.parent.options.showPermissionError({ranges:[y]}),p=!0):(e.parent.options.forbidCopyCallback&&e.parent.options.forbidCopyCallback(),p=!0)),f||(p||(p=P(e,!0,r,o,l,s,n,a,c,!1,h,_)),p||(m=e._commandManager().execute({cmd:"dragDrop",sheetName:e.name(),fromRow:r,fromColumn:o,toRow:l,toColumn:s,rowCount:n,columnCount:a,copy:c,insert:!1,option:h,collectedCells:_}))&&P(e,!1,r,o,l,s,n,a,c,!1,h,_))):o>=0&&r<0?(c&&(s<=o||s>=o+a)||!c&&(s<o||s>o+a))&&((e._hasPartSpans(-1,o,-1,a)||e._hasPartSpans(-1,s,-1,0))&&(f=!0,g=(0,i.sR)().Exp_ChangeMergedCell),f||(p=P(e,!0,-1,o,-1,s,-1,a,c,!0,h,_))||(m=e._commandManager().execute({cmd:"dragDrop",sheetName:e.name(),fromRow:-1,fromColumn:o,toRow:-1,toColumn:s,rowCount:-1,columnCount:a,copy:c,insert:!0,option:h,collectedCells:_}))&&P(e,!1,-1,o,-1,s,-1,a,c,!0,h,_)):r>=0&&o<0&&(c&&(l<=r||l>=r+n)||!c&&(l<r||l>r+n))&&((e._hasPartSpans(r,-1,n,-1)||e._hasPartSpans(l,-1,0,-1))&&(f=!0,g=(0,i.sR)().Exp_ChangeMergedCell),f||(p=P(e,!0,r,-1,l,-1,n,-1,c,!0,h,_))||(m=e._commandManager().execute({cmd:"dragDrop",sheetName:e.name(),fromRow:r,fromColumn:-1,toRow:l,toColumn:-1,rowCount:n,columnCount:-1,copy:self._isDragCopy,insert:!0,option:h,collectedCells:_}))&&P(e,!1,r,-1,l,-1,n,-1,c,!0,h,_))}m||(self._dragRect={},e.repaint()),f&&g&&e._raiseInvalidOperation(d,g)}e.sheetEventHandlerExt={_startDragDropping:function(t){if(!this._isDragDropping){var e=this._sheet,r=e._getCanvas();r&&(r.style.cursor="-webkit-grabbing");var i=null;if(1===e._selectionModel.length?i=e._selectionModel.data[0]:e._selectionModel.length<1&&(i=e._getSpanModel().get(e._activeRowIndex,e._activeColIndex)),i){this._isDragDropping=!0;var o,n=e._getActiveSelectedRange(),a=-1===n.row||-1===n.col;this._isDragInsert=a&&!this.shift,this._isWorking=!0,this._dragDropFromRange=i,o=-1===t.rowViewportIndex||-1===t.rowViewportIndex?e.getRangeRect(1,1,i):e.getRangeRect(T(t),O(t),i);var l=this._dragRect;l.x=o.x,l.y=o.y,l.width=o.width-1,l.height=o.height-1,l.row=i.row,l.col=i.col,l.rowCount=M(i),l.colCount=V(i);var s=e._getActualRange(i),u=t.row,c=t.col;u<s.row&&(u=s.row),u>=s.row+M(s)&&(u=s.row+M(s)-1),c<s.col&&(c=s.col),c>=s.col+V(s)&&(c=s.col+V(s)-1),l.hitRow=u,l.hitCol=c,l.rowOffset=u-s.row,l.colOffset=c-s.col,this._startHitInfo={_scrollRowViewportIndex:T(t),_scrollColViewportIndex:O(t),_hitTestType:b(t)},this._startScroll()}}},_continueDragDropping:function(){if(this._startHitInfo&&this._isWorking&&this._isDragDropping&&this._dragDropFromRange){var t=this._mousePosition,e=this._dragRect,r=e.width/2,i=e.x+r,o=e.height/2,n=e.y+o;e.hitTarget={x:t.x,y:t.y};var a=this._getHitRowIndex(),l=this._getHitColumnIndex(),s=!1;(A(i-t.x)>r+5||A(n-t.y)>o+5)&&(s=!0),a>=0&&l>=0&&s&&this._updateDragDropRect(a,l),this._continueScroll()}},_updateDragDropRect:function(t,e){if(this._isDragDropping&&this._dragDropFromRange){var r=this._sheet,i=this._dragRect,o=r._getActiveSelectedRange();-1===o.row&&-1!==o.col?(i.row=-1,i.col=D(0,S(I(r)-V(i),e-i.colOffset))):-1!==o.row&&-1===o.col?(i.row=D(0,S(E(r)-M(i),t-i.rowOffset)),i.col=-1):(i.row=i.row<0?-1:D(0,S(E(r)-M(i),t-i.rowOffset)),i.col=i.col<0?-1:D(0,S(I(r)-V(i),e-i.colOffset))),i.hitRow=t,i.hitCol=e;var n=r._getActualRange(i),l=this._oldDragRange;if(!(l&&n.row===l.row&&n.col===l.col&&M(n)===M(l)&&V(n)===V(l)&&n.row>r._getFirstVisualRow()&&n.col>r._getFirstVisualColumn()&&n.row+M(n)-1<r._getLastVisualRow()&&n.col+V(n)-1<r._getLastVisualColumn())){this._actualDragRange=n,(0,a._refreshDragDropIndicator)(r._render),this._oldDragRange=n;var s=r.parent;if(s&&s.options.showDragDropTip){var u=i.x+i.width+5,c=i.y+i.height+5;s._showTooltip(this._getDragDropRectString(n),u,c)}}}},_getDragDropRectString:function(t){if(t&&C){var e,r,i,o,n,a=this._sheet,l=a._getActiveSelectedRange(),u=a.getActiveRowIndex(),c=a.getActiveColumnIndex();if(u=u<0?0:u,c=c<0?0:c,1===M(l)&&1===V(l))e=s.default._createCellExpression(null,null,t.row-u,t.col-c,!0,!0);else-1===l.row&&l.col>=0?(r=o=s.default.BAND_INDEX_CONST,i=t.col-c,n=t.col-c+V(l)-1):-1===l.col&&l.row>=0?(i=n=s.default.BAND_INDEX_CONST,r=t.row-u,o=t.row-u+M(l)-1):l.row>=0&&l.col>=0&&(r=t.row-u,o=t.row-u+M(l)-1,i=t.col-c,n=t.col-c+V(l)-1),e=s.default._createRangeExpression(null,null,r,i,o,n,!0,!0,!0,!0);return a._getCalcServiceInternal().unparse(a._getSheetSource(),e,u,c)}},_stopDragDrop:function(){var t=this._sheet,e=t._getCanvas();e&&(e.style.cursor="-webkit-grab");var r=null;this._startHitInfo=null,this._stopScroll();var i=t._getActiveSelectedRange();(r=i&&(M(i)>0||V(i)>0)?{r:i.row,c:i.col,rc:M(i),cc:V(i)}:{r:t._activeRowIndex,c:t._activeColIndex,rc:1,cc:1},!0===this._isDragDropping&&!0===this._isWorking)&&N({sheet:t,fromRow:r.r,fromCol:r.c,rowCount:r.rc,colCount:r.cc,toRow:this._dragRect.row,toCol:this._dragRect.col,isDragInsert:this._isDragInsert,isDragCopy:this._isDragCopy});this._isWorking=!1,this._isDragDropping=!1,this._dragDropFromRange=null,this._isDragInsert=!1,this._isDragCopy=!1,this._oldDragRange=null,this._removeTooltip()},_startDragFill:function(t){!0!==this._isDraggingFill&&!0!==this._isWorking&&(this._updateDragFillStartRange(),this._fillStartRange&&(this._currentFillRange=void 0,this._isWorking=!0,this._isDraggingFill=!0,this._isDragAroundIndicator=!0,this._dragStartRowViewport=t,this._dragStartColumnViewport=O(t),this._dragToRowViewport=T(t),this._dragToColumnViewport=O(t),this._updateDragStartRangeViewports(),this._startHitInfo={_scrollRowViewportIndex:T(t),_scrollColViewportIndex:O(t),_hitTestType:b(t)},this._startScroll()))},_updateDragStartRangeViewports:function(){var t=function(t){return t.frozenRowCount()}(this._sheet),e=function(t){return t.frozenColumnCount()}(this._sheet),r=this._dragFillStartTopRow();r>=0&&r<t?this._dragFillStartTopRowViewport=0:r>=t&&r<=E(this._sheet)&&(this._dragFillStartTopRowViewport=1),this._isDragFillWholeColumns()?this._dragFillStartBottomRowViewport=1:this._dragFillStartBottomRowViewport=this._dragStartRowViewport;var i=this._dragFillStartLeftColumn();i>=0&&i<e?this._dragFillStartLeftColumnViewport=0:i>=e&&i<=I(this._sheet)&&(this._dragFillStartLeftColumnViewport=1),this._isDragFillWholeRows()?this._dragFillStartRightColumnViewport=1:this._dragFillStartRightColumnViewport=this._dragStartColumnViewport},_continueDragFill:function(){if(this._startHitInfo&&this._isDraggingFill&&this._isWorking&&this._fillStartRange){if(this._dragToRowViewport=this._getHitRowViewportIndex(),this._dragToColumnViewport=this._getHitColumnViewportIndex(),this._dragToRow=this._getHitRowIndex(),this._dragToColumn=this._getHitColumnIndex(),this._dragToRow>=0&&this._dragToColumn>=0){this._updateCurrentFillSettings(),this._updateCurrentFillRange();var t=this._sheet.parent,e=!1;this._getDragFillFrameRange()&&(e=this._validateFillRange(this._fillStartRange,this._currentFillRange,!0)),t&&t.options.showDragFillTip&&e&&this._showDragFillTooltip(),this._refreshDragFill()}this._continueScroll()}},_getDragFillTooltipContent:function(){var t,e=this._sheet,r=this._fillStartRange,i=this._currentFillRange,o=e.parent.options.defaultDragFillType,n=this._getAutoFillType(3===o?5:o),a=this._getCurrentFillDirection(),l=this._getDragFillFrameRange();if(1===n){t=0===a||1===a?1:0;var s=new c.default(e)._fillAuto(l,t,!0),_=this._getAvailableRange(a,i,r);if(!e.isRangeReadable(_))return"";var g=e.getActualStyle(_.row,_.col),d=g.cellType||e._getDefaultCellType(),f=g.formatter||g._autoFormatter,p=h.default&&h.default.GeneralFormatter;if(s instanceof Date&&p){var w=g.formatter||g._autoFormatter;w||(w=u.default.CultureManager._getCultureInfo().DateTimeFormat.shortDatePattern+" hh:mm:ss"),f=new p(w,0)}var C=this._startHitInfo,v=3;C&&(v=C._hitTestType);var m={sheet:e,row:_.row,col:_.col,sheetArea:v,quotePrefix:g.quotePrefix};return d.format(s,f,{},m)}return 0===n?(_=this._getAvailableRange(a,i,r),e.isRangeReadable(_)?e.getFormula(_.row,_.col)?null:e.getText(_.row,_.col):""):null},_getAvailableRange:function(t,e,r){var i=r.row,o=r.col,n=M(r),a=V(r),l=w(i,o,1,1);if(3===t){var s=M(e)%n;s=0===s?i+n-1:i+s-1,l.row=s,l.col=o}else 1===t?(s=0===(s=V(e)%a)?o+a-1:o+s-1,l.row=i,l.col=s):0===t?(s=0===(s=V(e)%a)?o:o+a-s,l.row=i,l.col=s):2===t&&(s=0===(s=M(e)%n)?i:i+n-s,l.row=s,l.col=o);return l},_showDragFillTooltip:function(){var t,e,r,i=this._sheet;if(4===this._getAutoFillType()||this._isDragFillWholeRows()||this._isDragFillWholeColumns())return this._removeTooltip(),null;var o=this._getCurrentFillDirection(),n=this._getDragFillFrameRange(),a=i._getRangeWholeRect(n);r=this._getDragFillTooltipContent(),3===o?(t=a.x+a.width+3,e=a.y+a.height+3):1===o?(t=a.x+a.width+3,e=a.y+a.height+3):0===o?(t=a.x+3,e=a.y+a.height+3):2===o&&(t=a.x+a.width+3,e=a.y+3),this._showTooltip(r,t,e)},_refreshDragFill:function(){this._clearDragFill(),this._refreshSelectionBorder(),this._paintDragFill(),this._oldDragFillFrameRange=this._getDragFillFrameRange()},_clearDragFill:function(){var t=this._sheet;if(this._oldDragFillFrameRange){var e=t._getRangeWholeRect(this._oldDragFillFrameRange);e.x-=2,e.y-=2,e.width+=4,e.height+=4,t._commitPaintSync([d({rect:e})])}},_refreshSelectionBorder:function(){this._sheet._commitPaintSync([f({range:this._fillStartRange})])},_paintDragFill:function(){var t=this._sheet,e=t._render,r=this._getDragFillFrameRange();if(r){var i=e._getCtx(),o=t._getRangeWholeRect(r);i.save(),i.beginPath(),(0,a._paintDragRectangle)(i,o),i.restore()}},_updateCurrentFillRange:function(){this._currentFillRange=this._getCurrentFillRange()},_isDragFillWholeRows:function(){return-1===this._fillStartRange.col&&-1!==this._fillStartRange.row},_isDragFillWholeColumns:function(){return-1===this._fillStartRange.row&&-1!==this._fillStartRange.col},_isDragClear:function(){return 4===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillRange:function(){var t=-1,e=-1,r=-1,i=-1;switch(this._currentFillDirection){case 0:this._isDragFillWholeColumns()?(t=-1,r=-1):(t=this._dragFillStartTopRow(),r=M(this._fillStartRange)),e=this._dragToColumn,i=this._dragFillStartLeftColumn()-e;break;case 1:this._isDragFillWholeColumns()?(t=-1,r=-1):(t=this._dragFillStartTopRow(),r=M(this._fillStartRange)),e=this._dragFillStartRightColumn()+1,i=this._dragToColumn-e+1;break;case 2:t=this._dragToRow,r=this._dragFillStartTopRow()-t,this._isDragFillWholeRows()?(e=-1,i=-1):(e=this._dragFillStartLeftColumn(),i=V(this._fillStartRange));break;case 3:t=this._dragFillStartBottomRow()+1,r=this._dragToRow-t+1,this._isDragFillWholeRows()?(e=-1,i=-1):(e=this._dragFillStartLeftColumn(),i=V(this._fillStartRange));break;case 5:t=this._dragToRow,r=this._dragFillStartBottomRow()-t+1,this._isDragFillWholeRows()?(e=-1,i=-1):(e=this._dragFillStartLeftColumn(),i=V(this._fillStartRange));break;case 4:this._isDragFillWholeColumns()?(t=-1,r=-1):(t=this._fillStartRange.row,r=M(this._fillStartRange)),e=this._dragToColumn,i=this._dragFillStartRightColumn()-e+1}return w(t,e,D(r,1),D(i,1))},_dragFillStartBottomRowLayout:function(){var t=this._dragFillStartBottomRow();return-1!==t?this._sheet._getRowLayout(this._dragFillStartBottomRowViewport).findRow(t):null},_dragFillToViewportBottomRowLayout:function(){return this._sheet._getRowLayout(this._dragToRowViewport).findRow(this._dragFillToViewportBottomRow())},_dragFillToViewportBottomRow:function(){return this._sheet.getViewportBottomRow(this._dragToRowViewport)},_dragFillStartRightColumnLayout:function(){var t=this._dragFillStartRightColumn();return-1!==t?this._sheet._getColumnLayout(this._dragFillStartRightColumnViewport).findCol(t):null},_dragFillToViewportRightColumnLayout:function(){return this._sheet._getColumnLayout(this._dragToColumnViewport).findCol(this._dragFillToViewportRightColumn())},_dragFillToViewportRightColumn:function(){return this._sheet.getViewportRightColumn(this._dragToColumnViewport)},_updateCurrentFillSettings:function(){var t,e,r=this._isDragFillWholeRows(),i=this._isDragFillWholeColumns(),o=p(this._sheet._getCanvas()).offset(),a=this._mousePosition.e,l=this._mousePosition.x,s=this._mousePosition.y,u=a.pageX-o.left,c=a.pageY-o.top,h=!1;if(r||i)i?this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=4:this._dragToColumn<this._dragFillStartLeftColumn()?this._currentFillDirection=0:this._dragToColumn>this._dragFillStartRightColumn()&&(this._currentFillDirection=1):r&&(this._dragToRow>=this._dragFillStartTopRow()&&this._dragToRow<=this._dragFillStartBottomRow()?this._currentFillDirection=5:this._dragToRow<this._dragFillStartTopRow()?this._currentFillDirection=2:this._dragToRow>this._dragFillStartBottomRow()&&(this._currentFillDirection=3));else if(this._dragToRow>=this._dragFillStartTopRow()&&this._dragToRow<=this._dragFillStartBottomRow())if(this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn())if(t=A(this._dragToColumn-this._dragFillStartRightColumn()),(e=A(this._dragToRow-this._dragFillStartBottomRow()))>t)this._currentFillDirection=5;else if(e<t)this._currentFillDirection=4;else{var _=this._dragFillStartBottomRowLayout();if(_||(_=this._dragFillToViewportBottomRowLayout()),s>_.y+_.height)this._currentFillDirection=3;else{var g=this._dragFillStartRightColumnLayout();g||(g=this._dragFillToViewportRightColumnLayout());var d=g.x+g.width-l,f=_.y+_.height-s;u>=g.x&&u<=g.x+g.width&&c>=_.y&&c<=_.y+_.height?this._currentFillDirection=d>=f?4:5:h=!0}}else this._dragToColumn<this._dragFillStartLeftColumn()?this._currentFillDirection=0:this._dragToColumn>this._dragFillStartRightColumn()&&(this._currentFillDirection=1);else this._dragToRow<this._dragFillStartTopRow()?this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=2:this._dragToColumn<this._dragFillStartLeftColumn()?(t=A(this._dragToColumn-this._dragFillStartLeftColumn()),e=A(this._dragToRow-this._dragFillStartTopRow()),this._currentFillDirection=e>=t?2:0):this._dragToColumn>this._dragFillStartRightColumn()&&(t=A(this._dragToColumn-this._dragFillStartRightColumn()),e=A(this._dragToRow-this._dragFillStartTopRow()),this._currentFillDirection=e>=t?2:1):this._dragToRow>this._dragFillStartBottomRow()&&(this._dragToColumn>=this._dragFillStartLeftColumn()&&this._dragToColumn<=this._dragFillStartRightColumn()?this._currentFillDirection=3:this._dragToColumn<this._dragFillStartLeftColumn()?(t=A(this._dragToColumn-this._dragFillStartLeftColumn()),e=A(this._dragToRow-this._dragFillStartBottomRow()),this._currentFillDirection=e>=t?3:0):this._dragToColumn>this._dragFillStartRightColumn()&&(t=A(this._dragToColumn-this._dragFillStartRightColumn()),e=A(this._dragToRow-this._dragFillStartBottomRow()),this._currentFillDirection=e>=t?3:1));var w=(0,n.state)(n.STATES.dragFillIndicatorRect);if(w){var C=this._dragFillStartBottomRow(),v=this._dragFillStartRightColumn(),m=C+1,R=v+1,y=this._sheet.getRowHeight(C,3),F=this._sheet.getColumnWidth(v,3),D=this._sheet.getRowHeight(m,3),x=this._sheet.getColumnWidth(R,3),T=w.x+w.width/2-S(10,F/2),O=w.x+w.width/2+S(10,x/2),b=w.y+w.height/2-S(10,y/2),E=w.y+w.height/2+S(10,D/2),I=!1;r||i?i?I=T<=u&&u<=O:r&&(I=b<=c&&c<=E):I=T<=u&&u<=O&&b<=c&&c<=E,I||h?(this._isDragAroundIndicator=!0,this._currentFillDirection=4):this._isDragAroundIndicator=!1}},_dragFillStartTopRow:function(){return this._fillStartRange?-1===this._fillStartRange.row?0:this._fillStartRange.row:-1},_dragFillStartBottomRow:function(){return this._fillStartRange?-1===this._fillStartRange.row?E(this._sheet)-1:this._fillStartRange.row+M(this._fillStartRange)-1:-1},_dragFillStartLeftColumn:function(){return this._fillStartRange?-1===this._fillStartRange.col?0:this._fillStartRange.col:-1},_dragFillStartRightColumn:function(){return this._fillStartRange?-1===this._fillStartRange.col?I(this._sheet)-1:this._fillStartRange.col+V(this._fillStartRange)-1:-1},_endDragFill:function(){var t=this._sheet;if(this._startHitInfo=null,this._stopScroll(),this._removeTooltip(),this._isDraggingFill&&this._isWorking){this._isDraggingFill=!1,this._isWorking=!1;var e=this._getDragFillFrameRange();if(e&&this._fillStartRange&&this._currentFillRange){var r=!0;if(t.isRangeReadable(this._fillStartRange)||(t.parent.options.forbidCopyCallback&&t.parent.options.forbidCopyCallback(),r=!1),t.isRangeEditable(this._currentFillRange)||(t.parent.options.showPermissionError&&t.parent.options.showPermissionError({ranges:[this._currentFillRange]}),r=!1),!(r=r&&this._currentFillRange&&this._validateFillRange(this._fillStartRange,this._currentFillRange))||this._isDragAroundIndicator)this._resetDragFill(),this._refreshSelection(e);else{var i=this._getAutoFillType();t._commandManager().execute({cmd:"fill",sheetName:t.name(),startRange:t._eventHandler._fillStartRange,fillRange:this._currentFillRange,autoFillType:i,fillDirection:t._eventHandler._getCurrentFillDirection()}),!this._isCancelDragFill&&this._isDragFill()&&t.parent.options.showDragFillSmartTag&&4!==this._currentDragFillType?this._showDragFillSmartTag(this._currentDragFillType):this._refreshSelection(e),this._resetDragFill()}}}else this._resetDragFill()},_showDragFillSmartTag:function(t){var e=this._sheet,r=(0,n.state)(n.STATES.dragFillIndicatorRect),i={x:r.x+r.width,y:r.y+r.height,fillType:t};e._fillDialog=new o.default(e.parent._getContainerDiv(),e,i),e._fillDialog._open()},_updateDragFillStartRange:function(){var t=this._sheet;1===t._selectionModel.length?this._fillStartRange=t._selectionModel.data[0]:t._activeRowIndex>=0&&t._activeColIndex>=0&&(this._fillStartRange=w(t._activeRowIndex,t._activeColIndex,1,1))},_resetDragFill:function(){this._isWorking=!1,this._isDraggingFill=!1},_refreshSelection:function(t){this._sheet._render._repaintSelection(t)},_getAutoFillType:function(t){var e=this._sheet;void 0!==t||e.parent.options.defaultDragFillType;if(this._isDragClear())return 4;if(1===M(this._fillStartRange)&&1===V(this._fillStartRange)&&!this._isDragFillWholeColumns()&&!this._isDragFillWholeRows()){var r=this._fillStartRange.row,i=this._fillStartRange.col,o=!!e.getFormula(r,i);return this._isControlPressed||!o&&h.default.isDateFormatter(e.getFormatter(r,i)||e.getAutoFormatter(r,i))?1:0}return this._isControlPressed?0:1},_getDragFillFrameRange:function(){if(!this._fillStartRange)return null;if(this._isDragClear())return this._fillStartRange;if(!this._currentFillRange)return null;var t=0,e=0,r=0,i=0;return this._isVerticalDragFill()?(t=2===this._currentFillDirection?this._currentFillRange.row:this._fillStartRange.row,e=M(this._fillStartRange)+M(this._currentFillRange),r=this._fillStartRange.col,i=V(this._fillStartRange)):(t=this._fillStartRange.row,e=M(this._fillStartRange),r=0===this._currentFillDirection?this._currentFillRange.col:this._fillStartRange.col,i=V(this._fillStartRange)+V(this._currentFillRange)),w(t,r,e,i)},_validateFillRange:function(t,e,r){function o(t,e,r,i,o){for(var n=0;n<r.rowCount;n++){for(var a=0;a<r.colCount;a++){var l=t.getSpan(r.row+n,r.col+a);if(!l||l.rowCount!==e.rowCount||l.colCount!==e.colCount)return!1;i&&(a+=e.colCount)}o&&(n+=e.rowCount)}return!0}var n=this._sheet,a=!0,l="";return n._getSpanModel().hasSpans(e.row,e.col,M(e),V(e))&&!function(t,e,r){var i=e.row,n=e.rowCount,a=e.col,l=e.colCount,s=r.row,u=r.rowCount,c=r.col,h=r.colCount,_=i===s&&n===u,g=a===c&&l===h;if(!_&&!g)return!1;var d=t.getSpan(i,a);return!(!d||!o(t,d,e,_,g))&&!t._getSpanModel().hasPartSpans(s,c,u,h)&&o(t,d,r,_,g)}(n,t,e)&&(a=!1,l=(0,i.sR)().Exp_FillRangeContainsMergedCell),a&&(n.isRangeEditable(e)||(a=!1,l=(0,i.sR)().Exp_FillCellsReadOnly)),a||r||n._raiseInvalidOperation(2,l),a},_isDragFill:function(){return this._isIncreaseFill()||this._isDecreaseFill()},_isIncreaseFill:function(){return 3===this._currentFillDirection||1===this._currentFillDirection},_isDecreaseFill:function(){return 0===this._currentFillDirection||2===this._currentFillDirection},_isVerticalDragFill:function(){return 2===this._currentFillDirection||3===this._currentFillDirection||5===this._currentFillDirection},_getCurrentFillDirection:function(){var t=this._currentFillDirection;return t>=0&&t<=3?t:4===t?0:5===t?2:3},_getDragInfo:function(t,e,r){var i=null,o=T(t),a=O(t);if(m(o)||m(a))return i;var l=this._sheet,s=l.parent,u=l._getActiveSelectedRange();if(-1===u.row&&-1===u.col)return i;if(-1===o&&-1!==a)return 1===l._selectionModel.length&&-1===u.row&&-1!==u.col&&u.col<=t.col&&u.col+u.colCount-1>=t.col?{action:x,side:"header"}:i;if(-1!==o&&-1===a)return 1===l._selectionModel.length&&-1!==u.row&&-1===u.col&&u.row<=t.row&&u.row+u.rowCount-1>=t.row?{action:x,side:"header"}:i;if(o>=0&&a>=0&&1===l._selectionModel.length){if(this._inGrayArea(o,a,e,r))return i;var c=l.getRangeRect(o,a,u);if(c.x-4<e&&e<c.x+4&&c.y<=r&&r<c.y+c.height&&(i={action:x,side:"left"}),!i){var h=(0,n.state)(n.STATES.dragFillIndicatorRect);h&&h.x<=e&&e<=h.x+h.width&&h.y<=r&&r<=h.y+h.height&&(i={action:x,side:"corner"})}i||c.x+c.width-4<e&&e<c.x+c.width+4&&c.y<=r&&r<c.y+c.height&&(i={action:x,side:"right"}),i||c.y-4<r&&r<c.y+4&&c.x<=e&&e<c.x+c.width&&(i={action:x,side:"top"}),i||c.y+c.height-4<r&&r<c.y+c.height+4&&c.x<=e&&e<c.x+c.width&&(i={action:x,side:"bottom"}),i&&(e<c.x||e>c.x+c.width||r<c.y||r>c.y+c.height)&&(i.outside=!0)}return s&&s.options.allowUserDragDrop||i&&"corner"!==i.side&&(i.side=null),s&&s.options.allowUserDragFill||i&&"corner"===i.side&&(i.side=null),i}},e.sheetEx={dragDrop:N}},function(t,e,r){"use strict";e.a=function(){u.register(h,{priority:1e3,exclusive:!0},{DBClick:{handler:function(){return _.doDoubleClickFill()},canHandle:function(t,e){return _.canTriggerDbClickFill(t,e)}}})};var i=r(0),o=r(1),n=r.n(o),a=r(13),l=r(8),s=r.n(l),u=n.a._SheetEventHandler.eventManager,c=i._createRange,h="DoubleClickAutoFill",_={_fillStartRange:null,_currentFillRange:null,_sheet:null,doDoubleClickFill:function(){var t=this._sheet;if(this._fillStartRange=t._selectionModel.data[0],!this.isFillStartRangeEmpty(this._fillStartRange)){var e=this.getDoubleClickFillFrameRange();if(e){var r=this._fillStartRange.row+this._fillStartRange.rowCount,i=e.rowCount-this._fillStartRange.rowCount;if(this._currentFillRange=c(r,e.col,i,e.colCount),t.isRangeReadable(this._fillStartRange)){var o=this._fillStartRange,n=o.rowCount,l=o.colCount,u=o.row,h=o.col,_=!1;if(1===n&&1===l){var g=t.getFormatter(u,h)||t.getAutoFormatter(u,h);_=!s.a.isDateFormatter(g)||t.getFormula(u,h)}t._commandManager().execute({cmd:"fill",sheetName:t.name(),startRange:this._fillStartRange,fillRange:this._currentFillRange,autoFillType:_?a.a.copyCells:a.a.fillSeries,fillDirection:a.d.down})}else t.parent.options.forbidCopyCallback&&t.parent.options.forbidCopyCallback(void 0,[this._fillStartRange])}}},canTriggerDbClickFill:function(t,e){this._sheet=e;var r=e._getCanvasOffset(),i=e.hitTest(t.pageX-r.left,t.pageY-r.top).dragInfo;return!!i&&"corner"===i.side},isRowFilteredOut:function(t){var e=this._sheet;return(e._rowFilter?e._rowFilter._getFilterArgs().filteredOutRows:[]).includes(t)},getFillReferenceAreaRowCount:function(t,e){for(var r=this._sheet.getRowCount(),i=0,o=t;o<r;o++){if(!this.isNotEmptyCell(o,e,"referenceArea")&&!this.isRowFilteredOut(o)){for(;this.isRowFilteredOut(o-1);)o--,i--;break}i++}return i},getWholeRangeRowCount:function(t,e,r,i){for(var o=this._sheet,n=o.getRowCount(),a=t+r;a<n;a++)for(var l=e;l<e+i;l++)if((this.isNotEmptyCell(a,l,"toBeFilled")||this.isCellMerged(a,l,o)||this.isCellLocked(a,l,o))&&!this.isRowFilteredOut(a))return a-t;return n-t},isValidCellValue:function(t){return!!t||0===t||!1===t},isCellLocked:function(t,e,r){var i=r.getSpan(t,e),o=i?i.row:t,n=i?i.col:e;return!r.isRangeEditable(o,n,1,1)},isNotEmptyCell:function(t,e,r){var i=this._sheet.getValue(t,e),o=this._sheet.getStyle(t,e);return"toBeFilled"===r?!!(this.isValidCellValue(i)||o&&o.backgroundImage):"fillStart"===r?!!(this.isValidCellValue(i)||o&&(o.backgroundImage||o.backColor)):this.isValidCellValue(i)},isCellMerged:function(t,e,r){var i=r.getSpan(t,e);return!!i&&(i.colCount>1||i.rowCount>1)},isFillStartRangeEmpty:function(t){for(var e=t.row,r=t.rowCount,i=t.col,o=t.colCount,n=e;n<e+r;n++)for(var a=i;a<i+o;a++)if(this.isNotEmptyCell(n,a,"fillStart"))return!1;return!0},getDoubleClickFillFrameRange:function(){var t=this._sheet;if(1===t._selectionModel.data.length){var e=t._selectionModel.data[0],r=e.row,i=e.col,o=e.rowCount,n=e.colCount,a=this.getFillReferenceAreaRowCount(r,i-1),l=this.getFillReferenceAreaRowCount(r,i+n),s=this.getWholeRangeRowCount(r,i,o,n);if(a>o)return c(r,i,Math.min(a,s),n);if(l>o)return c(r,i,Math.min(l,s),n)}return null}}},function(t,e,r){"use strict";e.a=function(){u("Worksheet").register("fill",c)};var i,o=r(12),n=r(1),a=r.n(n),l=r(9),s=(r.n(l),a.a.HookNames),u=a.a._getFeatureManager,c=((i={name:"fill"})[s.Worksheet.setHost]=function(t){t&&Object(l.regiterCmds)(this._commandManager())},i[s.Worksheet.dispose]=function(){var t=this._fillDialog;t&&t.close()},i._setMetaKeyStateOnEvent=function(t){var e=t.e,r=this._sheet;if(!0===this._isDragDropping){var i=r._getActiveSelectedRange(),n=this._isDragInsert,a=this._isDragCopy;-1===i.row||-1===i.col?this._isDragInsert=!e.shiftKey:this._isDragInsert=!1,this._isDragCopy=e.ctrlKey,n===this._isDragInsert&&a===this._isDragCopy||Object(o._refreshDragDropIndicator)(r._render)}},i._onPaintSelectionBorder=function(t){var e=t.ctx,r=t.rowViewportIndex,i=t.colViewportIndex,n=t.selectRect,a=t.clipRect;Object(o._paintDragFillIndicator)(this,e,r,i,n,a)},i)}])}},1176:function(t,e,r){"use strict";e.a=function(t,e){!function(t,e,r){var i=[],o={};e.forEach(function(t){var e=t[0];!o[e]&&r(t)&&(o[e]=!0,i.push(e))}),n.sheets.cellCommand.autofitRows(t,i)}(t,e,function(e){var r=e[0],i=e[2],n=e[3],l=n.attrs,s=n.value,u=i.attrs,c=i.value;if(!(l.backgroundImageSize===u.backgroundImageSize||o()(l.backgroundImageSize)&&o()(u.backgroundImageSize)))return!0;if(!o()(s)||l.formula){var h=l.wrap,_=l.format,g=u.wrap,d=u.format,f=l["font-size"],p=u["font-size"];if(t._getActualRowHeight(r)<a)return!0;if(h&&"text-no-wrap"!==h||g&&"text-no-wrap"!==g){if(h!==g)return!0;if("text-wrap"===h&&(_!==d&&(_||d)||s!==c))return!0;if("text-linebreak-overflow"===h){var w="string"==typeof c&&c.indexOf("\n")>-1,C="string"==typeof s&&s.indexOf("\n")>-1;return(w||C)&&s!==c}}if((f!==p||o()(c))&&(f&&9!==f||p&&9!==p))return!0}else{if(!o()(c)||u.formula)return t._getActualAutoFitRowHeight(r)>t._getActualRowHeight(r);if(l.link){var f=l["font-size"],p=u["font-size"];return f!==p&&!!(f&&9!==f||p&&9!==p)}}return!1})};var i=r(127),o=r.n(i),n=r(1);r.n(n);var a=22},127:function(t,e){t.exports=function(t){return null==t}},220:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isRetina=function(){return window.devicePixelRatio>=2},e.isDingTalk=function(){return/dingtalk/i.test(r)},e.isDingtalk=function(){return!!r.match(/mobile.*dingtalk/i)},e.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},e.isWechatPc=i,e.isWechat=function(){return!!/micromessenger/.test(r)&&!i()},e.isMobile=function(){return!i()&&!!r.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},e.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},e.isIOS=o,e.isAndroid=function(){return!!/(android)/g.test(r)},e.isAndroidApp=function(){return!!/shimo-android-app/g.test(r)},e.isIE=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},e.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},e.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},e.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},e.isWebIOS=function(){if(!window.cow.iOS&&o())return!0;return!1},e.isIphone6=function(){var t=!1;o()&&screen.height>568&&(t=!0);return t};var r=window.navigator.userAgent.toLowerCase();function i(){return!!/micromessenger.*?windowswechat/.test(r)}function o(){return!!/(ipad|iphone|ipod)/g.test(r)}}})});