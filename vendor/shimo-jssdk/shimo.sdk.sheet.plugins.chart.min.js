!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="https://assets.smcdn.cn/sheet/",i(i.s=1163)}({0:function(t,e){t.exports=React},1:function(t,e){t.exports=shimo.sdk.sheet},10:function(t,e,i){var n=i(39),r=i(77),o=i(58),a=i(11),s=i(23),l=i(28);t.exports=function(t){var e=l(t);if(!e&&!a(t))return r(t);var i=o(t),u=!!i,h=i||[],c=h.length;for(var p in t)!n(t,p)||u&&("length"==p||s(p,c))||e&&"constructor"==p||h.push(p);return h}},100:function(t,e,i){var n=i(17),r=Array.prototype.splice;t.exports=function(t){var e=this.__data__,i=n(e,t);return!(i<0||(i==e.length-1?e.pop():r.call(e,i,1),0))}},101:function(t,e,i){var n=i(17);t.exports=function(t){var e=this.__data__,i=n(e,t);return i<0?void 0:e[i][1]}},102:function(t,e,i){var n=i(17);t.exports=function(t){return n(this.__data__,t)>-1}},103:function(t,e,i){var n=i(17);t.exports=function(t,e){var i=this.__data__,r=n(i,t);return r<0?i.push([t,e]):i[r][1]=e,this}},104:function(t,e,i){var n=i(16);t.exports=function(){this.__data__=new n}},105:function(t,e){t.exports=function(t){return this.__data__.delete(t)}},106:function(t,e){t.exports=function(t){return this.__data__.get(t)}},107:function(t,e){t.exports=function(t){return this.__data__.has(t)}},108:function(t,e,i){var n=i(16),r=i(32),o=200;t.exports=function(t,e){var i=this.__data__;return i instanceof n&&i.__data__.length==o&&(i=this.__data__=new r(i.__data__)),i.set(t,e),this}},109:function(t,e,i){var n=i(110),r=i(16),o=i(44);t.exports=function(){this.__data__={hash:new n,map:new(o||r),string:new n}}},11:function(t,e,i){var n=i(79),r=i(14),o=i(12);t.exports=function(t){return null!=t&&o(n(t))&&!r(t)}},110:function(t,e,i){var n=i(111),r=i(112),o=i(113),a=i(114),s=i(115);function l(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,t.exports=l},111:function(t,e,i){var n=i(18);t.exports=function(){this.__data__=n?n(null):{}}},112:function(t,e){t.exports=function(t){return this.has(t)&&delete this.__data__[t]}},113:function(t,e,i){var n=i(18),r="__lodash_hash_undefined__",o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(n){var i=e[t];return i===r?void 0:i}return o.call(e,t)?e[t]:void 0}},114:function(t,e,i){var n=i(18),r=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:r.call(e,t)}},115:function(t,e,i){var n=i(18),r="__lodash_hash_undefined__";t.exports=function(t,e){return this.__data__[t]=n&&void 0===e?r:e,this}},116:function(t,e,i){var n=i(19);t.exports=function(t){return n(this,t).delete(t)}},1163:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),i.d(e,"ChartEvents",function(){return n}),i.d(e,"PLUGIN_NAME",function(){return J});var n,r,o=i(311),a=i.n(o),s=i(449),l=i.n(s),u=i(218),h=i.n(u),c=i(291),p=i.n(c),f=i(147),_=i.n(f),d=i(0),g=i.n(d),y=i(1164),m=i.n(y),v=i(211),b=(i.n(v),i(226)),S=i(454),C=i.n(S),x=i(1),T=(i.n(x),i(1165)),w=i(629),P=i(543),A=i(7),F=i.n(A),O=i(542),M=(i.n(O),i(1169)),D=i(1170),L=i(2),I=i.n(L),k=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),R=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(a,s)}l((n=n.apply(t,e||[])).next())})},N=this&&this.__generator||function(t,e){var i,n,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},E=x.sheets.Core,G=x.sheets,V=G.track,j=G.root,B=G.path.setByPath,U=(x.Editor,x.sheets),z=U.selection,H=U.range,W=U.changeset,X=U.Plugin,Y=z.getAllSelections,q=H.rangeToString,K=W.findRawTableOpById,Q=x.sheets.Events,Z=x.sheets.Hooks;!function(t){t[t.Chart_SIDEBAR_SHOW=0]="Chart_SIDEBAR_SHOW"}(n||(n={})),function(t){t[t.series=0]="series",t[t.axis=1]="axis",t[t.legend=3]="legend",t[t.label=4]="label",t[t.chartTitle=5]="chartTitle",t[t.plotArea=7]="plotArea",t[t.chartArea=8]="chartArea"}(r||(r={}));var J="Chart",$=function(t){function e(i){var o=t.call(this,{name:J,Constructor:e,config:i,localeOption:{localeResources:D.a,s18n:I.a}})||this;o.ChartEvents=n,o.getMenuConfig=function(){return Object(M.a)({showChartDialogFromMenu:o.onMenuChartBtnClick})},o.showChartSidebar=function(t,e){if(void 0===e&&(e=T.b.basic),o.editor.permissions.query.canEditFile()){o.emit(n.Chart_SIDEBAR_SHOW);var i=o.editor.spread.getActiveSheet().gcSheet,r=t||o.getSelectedChart(i),a=r&&{name:r.name(),options:P.i(r)};a&&o.chartSidebar.current.show(a,e)}},o.hideChartSidebar=function(){o.chartSidebar&&o.chartSidebar.current.close()},o.applyChartConfig=function(t){var e=t.gcSheet,i=t.chart,n=i.chartName,r=i.config,a={id:e.guid()};e.charts.get(n||(n="chart-"+Object(v.genGuid)()))||(r=Object.assign({},r,P.g(e,{width:572,height:394}))),a[n]=JSON.stringify(r),w.a(e,a);var s={fnName:"tableAttrs2Cs",params:[e.guid(),a]};o.editor.actions.calcOperator({operator:[s],label:"addChartOperator"})},o.deleteChart=function(t){var e=t.gcSheet,i=t.charts;if(0!==i.length){V(2,"0085"),e._trigger(E.Spread.Sheets.Events.FloatingObjectRemoved,{sheet:e,sheetName:e._name,floatingObject:i[0]});var n={id:e.guid()},r=[];h()(i,function(t){var i=t.name();n[i]=null,e.charts.remove(i),r.push(i)}),o.afterChartDelete(r);var a={fnName:"tableAttrs2Cs",params:[e.guid(),n]};P.a(e,i),C.a.notify("menu:commentDisabledToggle",!1),o.editor.actions.calcOperator({operator:[a],label:"deleteChartsOperator"})}},o.afterChartDelete=function(t){var e=o.chartSidebar.current;e&&e.state.isShow&&t.indexOf(e.state.chartName)>=0&&e.close()},o.afterChartUpdated=function(){o.chartSidebar&&o.chartSidebar.current&&o.chartSidebar.current.state.isShow&&setTimeout(function(){o.chartSidebar.current.updateSidebarChartConfig()},100)},o.render=function(){o.init(),o.renderContainer(),o.getSpreadOptions(null,o.editor.spread.gcSpread.options),o.renderChart()},o.genNewChartBySelections=function(){var t=o.editor.spread.gcSpread.getActiveSheet(),e=Y(t).map(function(t){return q(t,!0)}).join(",");if(e){var i="chart-"+Object(v.genGuid)(),n=_()({},O.defaultChart,{rangeFormula:e}),r=w.b(t,"temp-chart",_()({},n,{position:[0,0,500,300]}));return o.applyChartConfig({gcSheet:t,chart:{chartName:i,config:_()({},n,{series:P.k(r)})}}),t.charts.get(i)}},o.onMenuChartBtnClick=function(){var t=o.genNewChartBySelections();t&&o.showChartSidebar(t)},o.onChartDBClick=function(t){var e=t.chart,i=t.elementType,n=T.b.basic;[r.axis,r.chartTitle,r.label,r.legend].indexOf(i)>=0&&(n=T.b.advanced),o.showChartSidebar(e,n)},o.getSelectedChart=function(t){return l()(t.charts.all(),function(t){return t.isSelected()})},o.renderChart=function(){return R(o,void 0,Promise,function(){var t,e,i,n,r,o;return N(this,function(a){switch(a.label){case 0:return[4,(t=this.editor).getContent()];case 1:return e=a.sent(),i=t.spread.getActiveSheet(),n=i.id,r=K(e,n),o=r.getAttributes(),this.applyChart({sheet:i,tableActions:o}),[2]}})})},o.renderContainer=function(){F.a.render(g.a.createElement(T.a,{ref:o.chartSidebar,editor:o.editor,applyChart:o.applyChartConfig}),o.pluginContainer)},o.collectUpdatedTableAttrsAfterPasted=function(t,e){var i=t.gcSheet.charts.all();return h()(i,function(t){if(0!==t.name().indexOf("chart-")){var i="chart-"+Object(v.genGuid)(),n=P.i(t);t.name(i),e[i]=n}}),e},o.getSpreadOptions=function(t,e){e.genChartByJson=P.e,e.genChartJson=P.f},o.applyChart=function(t){if(t){var e=t.sheet,i=t.tableActions,n=e.gcSheet;w.a(n,i),o.afterChartUpdated()}},o.updateChart=function(t,e){var i=o.editor,n=i.spread.gcSpread,r=i.spread.getActiveSheet().gcSheet;r._chartSource&&r._chartSource.endCalculation();var s=P.l(n),l=[];return p()(s,function(t,e){if(!a()(t)){var n="undefined"===e?void 0:e,o={fnName:"tableAttrs2Cs",params:i.opProcessor([n,P.q(r,t)])};l.push(o)}}),l.length>0?e.concat(l):null},o.updateChartAfterFormulaRangeChanged=function(){var t=o.editor,e=t.spread.gcSpread,i=t.spread.getActiveSheet().gcSheet,n=P.l(e),r=[];p()(n,function(e,n){if(!a()(e)){var o="undefined"===n?void 0:n,s={fnName:"tableAttrs2Cs",params:t.opProcessor([o,P.q(i,e)])};r.push(s)}}),r.length>0&&(o.editor.actions.calcOperator({operator:r,label:"updateChartsOperator"}),o.afterChartUpdated())},o.updateChartAfterPasted=function(t,e){return t.isCutting?null:o.updateChart(null,e)},o.onFloatingObjectChanged=function(t,e){var i=t.args,n=o.editor,r=P.b(n),a="2"===i.floatingObject.typeName;if(r&&a){var s=P.c(n,{args:i});Object(b.f)(s)&&(e.push(s.value),o.afterChartUpdated())}return e},o.getUpdatedOpAfterSheetNameChanged=function(t,e){var i=t.args,n=P.n.apply(null,i);return e.push(n),e},o.getCharts=function(t,e){var i=t.gcSheet;return e.concat(i.charts.all())},o.onCopiedSheet=function(t){var e=t.newSheet,i=t.tableAttrs;P.o(e.gcSheet,i)},o.onRenamedSheet=function(t){var e=t.cs,i=o.editor;P.p(i.spread.gcSpread,e),o.afterChartUpdated()},o.onFloatingObjectDropdownItemClicked=function(t){var e=t.floatingObject,i=t.itemType,n=o.editor.spread.getActiveSheet().gcSheet;switch(i){case"chart:edit":return V(2,"0082"),o.showChartSidebar(e);case"chart:save-as-picture":return V(2,"0083"),P.m(e);case"chart:delete":return V(2,"0084"),o.deleteChart({gcSheet:n,charts:[e]})}},o.deleteChartByShortCut=function(t){var e=t.sheet,i=o.editor,n=e.gcSheet;if(!n.isEditing()&&i.permissions.query.canEditFile()){var r=P.h(n);o.deleteChart({gcSheet:n,charts:r})}};var s=i.editor;return o.editor=s,o.chartSidebar=g.a.createRef(),o.bindEvents(),o.registerHooks(),o.editor.isRendered&&o.render(),o.install(),o}return k(e,t),e.prototype.init=function(){if(!E.Spread.Sheets.Charts){var t=this.editor.spread;m()(E);var e=t.getSheets().map(function(t){return t.gcSheet});E.Spread.Sheets.Charts.install(t.gcSpread,e)}},e.prototype.bindEvents=function(){var t=this.editor;t.on(Q.Rendered,this.render),t.on(Q.DeleteByShortcut,this.deleteChartByShortCut),t.on(Q.AfterChangeApplied,this.applyChart),t.on(Q.AfterSheetRendered,this.applyChart),t.on(Q.CopiedSheet,this.onCopiedSheet),t.on(Q.RenamedSheet,this.onRenamedSheet),t.on(Q.FloatingObjectDropdownItemClicked,this.onFloatingObjectDropdownItemClicked),t.on(Q.UpdateChartAfterFormulaRangeChanged,this.updateChartAfterFormulaRangeChanged),t.on(Q.ChartDoubleClicked,this.onChartDBClick)},e.prototype.registerHooks=function(){var t=this.editor.hookManager.registerHook;t(Z.CollectUpdatedTableAttrsAfterPasted,this.collectUpdatedTableAttrsAfterPasted),t(Z.GetSpreadOptions,this.getSpreadOptions),t(Z.CollectOperatorAfterDragDropped,this.updateChart),t(Z.CollectOperatorAfterRowOrColChanged,this.updateChart),t(Z.CollectOperatorAfterPasted,this.updateChartAfterPasted),t(Z.FloatingObjectChanged,this.onFloatingObjectChanged),t(Z.GetUpdatedOpAfterSheetNameChanged,this.getUpdatedOpAfterSheetNameChanged),t(Z.GetFloatingObjects,this.getCharts)},e}(X);e.default=$,B(j,"shimo.sdk.sheet.plugins.Chart",$)},1164:function(t,e){t.exports=function(t){t.Spread.Sheets.Charts=function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=34)}([function(e,i,n){"use strict";function r(t,e){for(var i=0,n=t.length;i<n;i++)if(t[i].name===e)return t[i]}e.exports={install:function(e,i){var n=t.Spread.Sheets._getFeatureManager("Workbook")._features,o=t.Spread.Sheets._getFeatureManager("Worksheet")._features,a=r(n,"chart"),s=r(o,"chart");a.init.call(e),i.map(function(t){return s.init.call(t)}),console.log("chart installed")}}},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(){var e=i(0),r=i(3).GC$,o=i(4).StatefullBase,a=null,s=Math.max,l=Math.min,u=Math.floor,h=Math.log,c=Math.pow,p=Math.ceil,f=Math.abs;function _(t){return e.ARGBColor.FromArgb(t)}function d(t){return"number"==typeof t||t instanceof Date}function g(t,e,i){i.configurable=!0,i.enumerable=!0,Object.defineProperty(t,e,i)}function y(t){if(!t||0===t.length)return!1;if("["===(t=t.toUpperCase().trim())[0]){var e=t.indexOf("]");if(-1===e||e===t.length-1)return!1;t=t.substr(e+1)}for(var i,n=-1,r=0,o=!1,s=a,l=0;l<t.length;l++){var u=t[l];if("["===u)do{u=t[l],l++}while(l<t.length&&"]"!==u);if("Y"===u||"D"===u||"M"===u||"H"===u||"S"===u)o?r++:0!==l&&"\\"===t[l-1]||(o=!0,n=l,r=1);else{if(o=!1," "===u&&s)return!0;0!==r&&(i=t.substr(n,r),n=l,r=0,S.isNullOrUndefined(s)?s=m(i):s&=m(i))}}return 0!==r&&l===t.length&&(i=t.substr(n,r),S.isNullOrUndefined(s)?s=m(i):s&=m(i)),s}function m(t){var e={Y:4,D:4,M:5,H:2,S:2};if(!t)return!1;for(var i={},n=0;n<t.length;n++){var r=t[n];i[r]?i[r]=i[r]+1:i[r]=1}for(var o in i)if(i.hasOwnProperty(o)){var a=e[o];if(void 0===a)return!1;if(i[o]>a)return!1}return!0}var v=function(){function t(){}return t.FromOADate=function(t){t<60&&t++;var e=t-25569,i=new Date(864e5*e),n=e>=0?1:-1,r=i.getTimezoneOffset(),o=(864e5*t*1440+n-3181192704e6+864e5*r)/1440,a=new Date(o),s=r>=0?1:-1,l=new Date(o+36e5*s).getTimezoneOffset();if(r!==l){var u=new Date(o+60*(l-r)*1e3);if(r>l){if(-1===s||l===a.getTimezoneOffset())return u}else if(r<l&&(1===s||l===a.getTimezoneOffset()))return u}return a},t.ToOADate=function(t){if(S.isNullOrUndefined(t))return 0;"number"==typeof t&&(t=new Date(t));var e=(1440*t.getTime()+3181192704e6-864e5*t.getTimezoneOffset())/124416e6;return e<61&&e--,e},t.OADateMinAsDouble=-657435,t.OADateMaxAsDouble=2958466,t}();e.DateTimeExtension=v;var b=function(){function t(){}return t.log=function(t,e){return h(t)/h(e)},t.round=function(t,e){var i=c(10,e);return Math.round(t*i)/i},t.isNaNOrInfinite=function(t){return isNaN(t)||!isFinite(t)},t.GetTriangleAngle=function(t,e,i){if(0===t&&0===e)return 0;var n=(t*t+i*i-e*e)/f(2*t*i),r=0;return t<0&&e>0?r=90:t<0&&e<0?r=180:t>0&&e<0&&(r=270),180*Math.acos(n)/Math.PI+r},t.INT32_MAX_VALUE=2147483647,t.DOUBLE_MAX_VALUE=Number.MAX_VALUE,t.DOUBLE_MIN_VALUE=-Number.MAX_VALUE,t}();e.NumberExtension=b;var S=function(){function t(){}return t.pointToPixel=function(t){return function(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i}(96*t/72,2)},t.IsNullOrEmpty=function(e){return t.isNullOrUndefined(e)||""===e},t.IsNegativeInfinity=function(t){return t===Number.NEGATIVE_INFINITY},t.IsPositiveInfinity=function(t){return t===Number.POSITIVE_INFINITY},t.isNullOrUndefined=function(t){return void 0===t||t===a},t}();e.UnitHelper=S;var C=function(){function t(t,e,i,n){this.Row=t,this.Column=e,this.RowCount=i,this.ColumnCount=n}var e=t.prototype;return g(e,"Left",{get:function(){return this.Column}}),g(e,"Top",{get:function(){return this.Row}}),g(e,"Right",{get:function(){return this.Column+this.ColumnCount}}),g(e,"Bottom",{get:function(){return this.Row+this.RowCount}}),g(e,"IsFullColumn",{get:function(){return 0===this.Row&&this.RowCount===b.INT32_MAX_VALUE}}),g(e,"IsFullRow",{get:function(){return 0===this.Column&&this.ColumnCount===b.INT32_MAX_VALUE}}),e.Intersect=function(t){var e=t,i=s(this.Column,e.Column),n=s(this.Row,e.Row),r=l(this.Right,e.Right),o=l(this.Bottom,e.Bottom);i>=r||n>=o?(this.Column=0,this.Row=0,this.ColumnCount=0,this.RowCount=0):(this.Column=i,this.Row=n,this.ColumnCount=r-i,this.RowCount=o-n)},e.IntersectsWith=function(t){var e=t;return!(this.Left>=e.Right||this.Right<=e.Left||this.Top>=e.Bottom||this.Bottom<=e.Top)},t}();e.CellRect=C;var x=function(){function t(t,e){this.Worksheet=t,this._originalRects=e,this.UpdateRects()}var e=t.prototype;return e.UpdateRects=function(){var t,e,i;this._rects=[];for(var n=0;n<this._originalRects.length;n++){var r=(i=this._originalRects[n]).Row,o=i.Column;if(t=i.RowCount,e=i.ColumnCount,(r<0||t<0||o<0||e<0)&&((r<0||t<0)&&(r=0,t=b.INT32_MAX_VALUE),(o<0||e<0)&&(o=0,e=b.INT32_MAX_VALUE),this._originalRects[n]=new C(r,o,t,e)),(0!==r||t!==b.INT32_MAX_VALUE)&&(r<0||t<=0||r+t>1048576))throw new Error;if((0!==o||e!==b.INT32_MAX_VALUE)&&(o<0||e<=0||o+e>16384))throw new Error}for(var a=0,s=this._originalRects;a<s.length;a++)i=s[a],t=l(i.Bottom,1048576)-i.Top,e=l(i.Right,16384)-i.Left,this._rects.push(new C(i.Row,i.Column,t,e))},g(e,"Row",{get:function(){var t=this._rects[0].Row;return t<0?0:t}}),g(e,"Column",{get:function(){var t=this._rects[0].Column;return t<0?0:t}}),g(e,"RowCount",{get:function(){var t=this._rects[0].RowCount,e=this._rects[0].Row;return t<0||e<0?1048576:t}}),g(e,"ColumnCount",{get:function(){var t=this._rects[0].ColumnCount,e=this._rects[0].Column;return t<0||e<0?16384:t}}),g(e,"EntireRow",{get:function(){for(var e=[],i=0;i<this._rects.length;i++){var n=this._rects[i];n.Column=-1,n.ColumnCount=-1,e.push(n)}return new t(this.Worksheet,e)}}),g(e,"EntireColumn",{get:function(){for(var e=[],i=0;i<this._rects.length;i++){var n=this._rects[i];n.Row=-1,n.RowCount=-1,e.push(n)}return new t(this.Worksheet,e)}}),g(e,"Text",{get:function(){return this.Worksheet._GetCellText(this.Row,this.Column,this.RowCount,this.ColumnCount)}}),g(e,"Areas",{get:function(){for(var e=[],i=0,n=this._rects;i<n.length;i++){var r=n[i];e.push(new t(this.Worksheet,[r]))}return e}}),g(e,"Hidden",{get:function(){return this.Worksheet._IsHidden(this._originalRects)}}),t}();e.Range=x;var T=function(){function t(t,e,i,n,r){this.WorksheetName=t,this.Row=e,this.Column=i,void 0!==n&&(this.LastRow=n),void 0!==r&&(this.LastColumn=r)}var e=t.prototype;return g(e,"Row",{get:function(){return 1==(1&this.Kind)?this._row:0},set:function(t){this._row=t,this.Kind|=1}}),g(e,"Column",{get:function(){return 2==(2&this.Kind)?this._column:0},set:function(t){this._column=t,this.Kind|=2}}),g(e,"RowCount",{get:function(){return this.IsRange?1==(1&this.Kind)?this.RowIsRelative&&this.LastRowIsRelative||!this.RowIsRelative&&!this.LastRowIsRelative?this.LastRow-this.Row+1:-1:1048576:1}}),g(e,"ColumnCount",{get:function(){return this.IsRange?2==(2&this.Kind)?this.ColumnIsRelative&&this.LastColumnIsRelative||!this.ColumnIsRelative&&!this.LastColumnIsRelative?this.LastColumn-this.Column+1:-1:16384:1}}),g(e,"LastColumn",{get:function(){return this.IsRange?2==(2&this.Kind)?this._lastColumn:16383:this.Column},set:function(t){this._lastColumn=t,this.Kind|=66}}),g(e,"LastRow",{get:function(){return this.IsRange?1==(1&this.Kind)?this._lastRow:1048575:this.Row},set:function(t){this._lastRow=t,this.Kind|=65}}),g(e,"RowIsRelative",{get:function(){return 5==(5&this.Kind)}}),g(e,"ColumnIsRelative",{get:function(){return 10==(10&this.Kind)}}),g(e,"LastRowIsRelative",{get:function(){return this.IsRange?17==(17&this.Kind):this.RowIsRelative}}),g(e,"LastColumnIsRelative",{get:function(){return this.IsRange?34==(34&this.Kind):this.ColumnIsRelative}}),g(e,"IsRange",{get:function(){return 64==(64&this.Kind)},set:function(t){t?this.Kind|=64:this.Kind&=-65}}),g(e,"IsError",{get:function(){return"#REF"===this.WorksheetName}}),e.GetSourceRange=function(t,e){var i=this.Row,n=this.Column,r=this.LastRow,o=this.LastColumn;return new C(i,n,r-i+1,o-n+1)},e.ToR1C1Text=function(t){void 0===t&&(t=a);if(128==(128&this.Kind))return this.GetPrevText(t)+"#REF!";var e,i,n="";if(1==(1&this.Kind)&&(e=this.Row,this.RowIsRelative?n+=0===e?"R":"R["+e.toString()+"]":n+="R"+(e+1).toString()),2==(2&this.Kind)&&(i=this.Column,this.ColumnIsRelative?n+=0===i?"C":"C["+i.toString()+"]":n+="C"+(i+1).toString()),this.IsRange){var r=!1;3!=(3&this.Kind)&&(1==(1&this.Kind)?this.RowIsRelative===this.LastRowIsRelative&&this.Row===this.LastRow&&(r=!0):this.ColumnIsRelative===this.LastColumnIsRelative&&this.Column===this.LastColumn&&(r=!0)),r||(n+=":",1==(1&this.Kind)&&(e=this.LastRow,this.LastRowIsRelative?n+=0===e?"R":"R["+e.toString()+"]":n+="R"+(e+1).toString()),2==(2&this.Kind)&&(i=this.LastColumn,this.LastColumnIsRelative?n+=0===i?"C":"C["+i.toString()+"]":n+="C"+(i+1).toString()))}return this.GetPrevText(t)+n},e.ToA1Text=function(t,e,i){void 0===i&&(i=a);if(128==(128&this.Kind))return this.GetPrevText(i)+"#REF!";var n,r,o="";return 2==(2&this.Kind)&&(r=this.Column,this.ColumnIsRelative?r+=e:o+="$",o+=this.GetColumnIndexInA1Letter(r)),1==(1&this.Kind)&&(n=this.Row,this.RowIsRelative?n+=t:o+="$",o+=(n+1).toString()),this.IsRange&&(o+=":",2==(2&this.Kind)&&(r=this.LastColumn,this.LastColumnIsRelative?r+=e:o+="$",o+=this.GetColumnIndexInA1Letter(r)),1==(1&this.Kind)&&(n=this.LastRow,this.LastRowIsRelative?n+=t:o+="$",o+=(n+1).toString())),this.GetPrevText(i)+o},e.GetPrevText=function(t){var e="";this.Workbook>0&&(e="["+this.Workbook.toString()+"]");var i=this.WorksheetName;return S.isNullOrUndefined(i)&&(i=t),i&&(S.isNullOrUndefined(this.LastWorksheetName)?e+=i:e+=i+":"+this.LastWorksheetName),e?(e="'"+e.replace("'","''")+"'",e+="!"):""===i&&(e="!"),e},e.IsSpecialSheetName=function(e){if(!S.isNullOrUndefined(e)){if(e===t.ErrorWorksheetName)return!1;for(var i=0;i<e.length;i++){var n=e[i];if(!(n>="A"&&n<="Z"||n>="a"&&n<="z"||n>="0"&&n<="9"||"_"===n))return!0}}return!1},e.GetColumnIndexInA1Letter=function(t){for(var e=[],i=0;i=t%26,e.unshift("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[i]),0!==(t=parseInt(t/26));)t--;return e.join("")},t}();T.ErrorWorksheetName="#REF",e.Reference=T;var w=e.ChartConstants={XValuesMinMax:"XValuesMinMax",ValuesMinMax:"ValuesMinMax",PrimaryValuesMinMax:"PrimaryValuesMinMax",SecondaryValuesMinMax:"SecondaryValuesMinMax",PrimaryXValuesMinMax:"PrimaryXValuesMinMax",SecondaryXValuesMinMax:"SecondaryXValuesMinMax",Collection:"Collection",Restore:"Restore",ChartType:"ChartType",AxisGroup:"AxisGroup",AreAllXValuesDateTime:"AreAllXValuesDateTime",XValuesFormula:"XValuesFormula",XValues:"XValues",CategoryNames:"CategoryNames",CategoryType:"CategoryType",SecondaryPlot:"SecondaryPlot",SplitType:"SplitType",SplitValue:"SplitValue",IsMultiLevelXValues:"IsMultiLevelXValues",PlotOrder:"PlotOrder",FIELD_TYPE_CELLRANGE:"CELLRANGE",FIELD_TYPE_SERIESNAME:"SERIESNAME",FIELD_TYPE_CATEGORYNAME:"CATEGORYNAME",FIELD_TYPE_VALUE:"VALUE",FIELD_TYPE_XVALUE:"XVALUE",FIELD_TYPE_YVALUE:"YVALUE",FIELD_TYPE_BUBBLESIZE:"BUBBLESIZE",FIELD_TYPE_PERCENTAGE:"PERCENTAGE",FIELD_TYPE_TXLINK:"TxLink",FIELD_TEXT_CELLRANGE:"[CELLRANGE]",FIELD_TEXT_SERIESNAME:"[SERIES NAME]",FIELD_TEXT_CATEGORYNAME:"[CATEGORY NAME]",FIELD_TEXT_VALUE:"[VALUE]",FIELD_TEXT_XVALUE:"[XVALUE]",FIELD_TEXT_YVALUE:"[YVALUE]",FIELD_TEXT_BUBBLESIZE:"[BUBBLE SIZE]",CHART_LATIN_HEAD_FONT:"+mj-lt",CHART_LATIN_BODY_FONT:"+mn-lt",CHART_EA_HEAD_FONT:"+mj-ea",CHART_EA_BODY_FONT:"+mn-ea",CHART_CS_HEAD_FONT:"+mj-cs",CHART_CS_BODY_FONT:"+mn-cs",DefaultLineColorBrightness:.85,DefaultMarkerSize:5};e.ShapeConstants={ShapeTypePrefix:"Shape",PositiveFixedAngleConvert:6e4,PositionConver:1e5,CropPositionConver:1e3,ShadeConver:2e5,DefaultBrightness:.5,RelativeRectConver:1e3,DefaultTransparent:0,PositiveFixedPercentageConvert:1e5,DefaultOffset:2.07995176};var P=function(){function t(){}t.defineProperty=g,t.colorFormatToString=function(e,i){var n=e&&e.Color;if(n&&0!==n.ColorType){if(i){var r=n.GetColorData();if(4===r.ColorType)return t.toThemeColorString(r.Value,r.Tint)}var o=n.RGB;if(o)return"rgba("+o.R+","+o.G+","+o.B+","+o.A/255+")"}return"transparent"};var e={0:"background 1",2:"background 2",1:"text 1",3:"text 2",4:"accent 1",5:"accent 2",6:"accent 3",7:"accent 4",8:"accent 5",9:"accent 6",10:"accent 7",11:"accent 8",12:"accent 9",13:"accent 10",14:"accent 11",15:"accent 12",16:"hyperlink",17:"followedhyperlink"};t.toThemeColorString=function(t,i){return e[t]+" "+parseInt(100*i)};var r={"background 1":0,"background 2":2,"text 1":1,"text 2":3,"accent 1":4,"accent 2":5,"accent 3":6,"accent 4":7,"accent 5":8,"accent 6":9,"accent 7":10,"accent 8":11,"accent 9":12,"accent 10":13,"accent 11":14,"accent 12":15,hyperlink:16,followedhyperlink:17};function o(t){if(null===t||void 0===t)return!0;if(Array.isArray(t))return 0===t.length;if(t instanceof Date)return!1;if("object"!==(void 0===t?"undefined":n(t)))return!1;for(var e in t)return!1;return!0}function s(t,e){if(o(t))return null;for(var i in t)if(!(e.indexOf(i)>=0)){var r=t[i];Array.isArray(r)?0!==r.length&&null!==l(r,e)||delete t[i]:"object"===(void 0===r?"undefined":n(r))&&null===(r=s(r,e))&&delete t[i]}return o(t)?null:t}function l(t,e){var i=[],n=t.length;return t.forEach(function(t){var n=s(t,e);null!==n&&i.push(n)}),i.length<n&&[].splice.apply(t,[].concat(0,n,i)),i.length?t:null}return t.fromThemeColorString=function(t){var e=t.split(" "),i=e.length,n=e[0].toLowerCase(),o=e[1],a=e[2];if("hyperlink"===n||"followedhyperlink"===n){if(1===i)return{index:r[n],tint:0};if(2===i)return{index:r[n],tint:parseInt(o)/100}}if(i>=2){var s=r[n+" "+o];if(void 0!==s){if(2===i)return{index:s,tint:0};if(3===i)return{index:s,tint:parseInt(a)/100}}}},t.InitPresetColors=function(){var e=t.presetColors;e[0]=16766374,e[1]=10079474,e[2]=14276864,e[3]=12713798,e[4]=16777126,e[5]=10938086,e[6]=8439295,e[7]=0,e[8]=8966143,e[9]=14221312,e[10]=13180022,e[11]=2368652,e[12]=6135762,e[13]=8947281,e[14]=55660,e[15]=1661363,e[16]=1989375,e[17]=15234615,e[18]=9825023,e[19]=3346875,e[20]=14276864,e[21]=7733248,e[22]=7763456,e[23]=619164,e[24]=9474192,e[25]=21760,e[26]=5154734,e[27]=7733366,e[28]=2644808,e[29]=30681,e[30]=11348866,e[31]=118,e[32]=5010145,e[33]=7383408,e[34]=7746621,e[35]=4408104,e[36]=11710208,e[37]=11731070,e[38]=8257770,e[39]=14262784,e[40]=5855577,e[41]=15891200,e[42]=1908119,e[43]=10936831,e[44]=1930781,e[45]=14221529,e[46]=12303291,e[47]=16756141,e[48]=47065,e[49]=1805497,e[50]=7171437,e[51]=27904,e[52]=196507,e[53]=10944422,e[54]=10040319,e[55]=3881921,e[56]=7274560,e[57]=10944511,e[58]=5954537,e[59]=15641258,e[60]=12822271,e[61]=54889,e[62]=8975359,e[63]=14205567,e[64]=5197802,e[65]=16777112,e[66]=9761779,e[67]=11776947,e[68]=6219358,e[69]=9008383,e[70]=4290815,e[71]=9541403,e[72]=16299856,e[73]=8680547,e[74]=13411718,e[75]=10027007,e[76]=55552,e[77]=2797098,e[78]=11193582,e[79]=14221529,e[80]=109,e[81]=9945667,e[82]=11403264,e[83]=13120682,e[84]=13715573,e[85]=6330419,e[86]=15284819,e[87]=8639488,e[88]=12238640,e[89]=7410345,e[90]=6231317,e[91]=13959082,e[92]=10068991,e[93]=7654655,e[94]=7193855,e[95]=7143424,e[96]=10738424,e[97]=28013,e[98]=1997147,e[99]=36057,e[100]=15321,e[101]=13322704,e[102]=7854820,e[103]=6224222,e[104]=14934908,e[105]=7686353,e[106]=9426175,e[107]=7845887,e[108]=3109301,e[109]=9731583,e[110]=13530830,e[111]=14143106,e[112]=7143533,e[113]=217,e[114]=7368873,e[115]=13979170,e[116]=1063798,e[117]=4018680,e[118]=3181041,e[119]=4879911,e[120]=10799871,e[121]=2508424,e[122]=10724259,e[123]=14924631,e[124]=12597837,e[125]=8088927,e[126]=11448063,e[127]=7133440,e[128]=10055484,e[129]=6724547,e[130]=7171328,e[131]=12687809,e[132]=1456895,e[133]=12702498,e[134]=15159783,e[135]=8111854,e[136]=14277081,e[137]=13684944,e[138]=55769,e[139]=2797187},t.GetPresetColorRGB=function(e){return t.presetColors[e]},t.GetDimensioin=function(t){return{0:-1,1:2,33:2,34:2,35:2,36:2,11:3,48:3}[t]||1},t.AreValuesDateTime=function(t,e,i){if(S.isNullOrUndefined(e)||0===e.length)return!1;for(var n,r=!0,o=this.GetStylesFromCellRefers(t,e,i),a=this.GetValuesFromCellRefers(t,e,i),s=0;s<o.length;s++){for(var l=o[s],u=l.length,h=l[0]&&l[0].length,c=0;c<h;c++){for(var p=0;p<u;p++){var f=l[p][c];if(n=a[s][p][c],!S.isNullOrUndefined(n)&&!(n instanceof Date)&&(S.isNullOrUndefined(f)||!y(f.FormatCode)||!d(n))){r=!1;break}}if(!r)break}if(!r)break}if(r){for(var _=!0,g=0,m=a;g<m.length;g++)for(var v=0,b=m[g];v<b.length;v++)if(n=b[v],!S.isNullOrUndefined(n)){_=!1;break}return!_}return!1},t.AreAllNumbers=function(t){for(var e=!0,i=0,n=t;i<n.length;i++){if(!d(n[i])){e=!1;break}}return e},t.AreAllDate=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];if(null!==n&&!(n instanceof Date))return!1}return!0},t.toOADate=function(t){if(null==t)return 0;"number"==typeof t&&(t=new Date(t));var e=function(t){var e=t.getTimezoneOffset();return-485===e&&(e=-485-43/60),e}(t);return(1440*t.getTime()+3181192704e6-864e5*e)/124416e6},t.TryAllToNumbers=function(t,e,i){if(S.isNullOrUndefined(t)||0===t.length)return!1;for(var n=!0,r=[],o=t.length,a=0;a<o;a++){var s=t[a];if(S.isNullOrUndefined(s))i||r.push(s);else if(s instanceof Date)r.push(parseInt(this.toOADate(s)));else{var l={value:void 0};this.TryToDouble(s,l)?r.push(l.value):(n=!1,r.push(0))}}return Array.prototype.push.apply(e,r),n},t.TryToDouble=function(t,e,i){var r=a;if(!t)return e.value=0,!0;var o=void 0===t?"undefined":n(t);try{if("number"===o)r=t;else if("string"===o&&i){if(0===(t=t.trim()).length)return e.value=0,!0;0;var s=!1;if("%"===t.charAt(t.length-1)&&(s=!0,t=t.substr(0,t.length-1)),"$"===t[0])return!1;if(t.indexOf(".")!==t.lastIndexOf("."))return!1;if(t.length>=2&&"0"===t[0]&&"x"===t[1])return!1;if(r=new Number(t).valueOf(),b.isNaNOrInfinite(r)){var l=t.charCodeAt(0);if(l|=32,t.length>4&&l>=96&&l<=122){var u=t[0]+t[1]+t[2];if(!{JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12}[u=u.toUpperCase()])return!1}if("/"===t[0]||"/"===t[t.length-1])return!1;if(r=new Date(t),b.isNaNOrInfinite(r.valueOf()))return!1;r=v.ToOADate(r)}s&&(r/=100)}else if("boolean"===o)r=t?1:0;else{if(!(t instanceof Date))return!1;r=v.ToOADate(t)}}catch(t){return!1}return e.value=r,!0},t.IsBarChart=function(t){return 18===t||21===t||19===t||20===t||23===t||22===t},t._getChartTypeString=function(e){var n=t.chartTypeDict;if(!n){n=t.chartTypeDict={};var r=i(10).ChartType;for(var o in r)n[r[o]]=o.toLowerCase()}return n[e]},t.IsColumnChart=function(e){return t._getChartTypeString(e).indexOf("column")>=0},t.IsAnyPieChart=function(t){return this.IsPieChart(t)||this.IsDoughnutChart(t)||this.IsOfPieChart(t)},t.IsPieChart=function(e){return t._getChartTypeString(e).indexOf("pie")>=0},t.IsPieOrDoughnutChart=function(t){return this.IsPieChart(t)||this.IsDoughnutChart(t)},t.IsOfPieChart=function(t){return 29===t||32===t},t.IsStackedChart=function(e){return t._getChartTypeString(e).indexOf("stacked")>=0},t.IsStacked100Chart=function(e){return t._getChartTypeString(e).indexOf("stacked100")>=0},t.IsLineChart=function(t){return 5===t||9===t||26===t||27===t||28===t||24===t||25===t},t.IsLineMarkerChart=function(t){return 26===t||27===t||28===t},t.IsLineSeries=function(t){return 9===t||26===t||27===t||28===t||24===t||25===t||35===t||36===t||33===t||34===t||2===t||42===t},t.IsMarkerSeries=function(t){return 26===t||27===t||28===t||42===t||1===t||35===t||33===t},t.IsFillSeries=function(t){return!this.IsLineSeries(t)&&1!==t},t.IsRadarChart=function(e){return t._getChartTypeString(e).indexOf("radar")>=0},t.IsAreaChart=function(e){return t._getChartTypeString(e).indexOf("area")>=0},t.IsScatterChart=function(e){return t._getChartTypeString(e).indexOf("scatter")>=0},t.IsSurfaceChart=function(e){return t._getChartTypeString(e).indexOf("surface")>=0},t.IsBubbleChart=function(e){return t._getChartTypeString(e).indexOf("bubble")>=0},t.IsSmoothLine=function(e){return t._getChartTypeString(e).indexOf("smooth")>=0},t.Is3DChart=function(e){var i=t._getChartTypeString(e);return i.indexOf("3d")>=0&&48!==e||this.IsSurfaceChart(e)||i.indexOf("cylinder")>=0||i.indexOf("cone")>=0||i.indexOf("pyramid")>=0},t.IsSurface3DChart=function(t){return 44===t||45===t},t.IsDoughnutChart=function(t){return 3===t||41===t},t.IsExplodedChart=function(t){return 31===t||41===t||30===t},t.HasSeriesAx=function(t){return 6===t||7===t||5===t||this.IsSurfaceChart(t)},t.IsStockChart=function(e){return t._getChartTypeString(e).indexOf("stock")>=0},t.IsBuiltInComboChart=function(t){return this.IsStockChart(t)},t.ConvertToTextUnderlineType=function(t){var e=0;return 1===t?e=2:2===t&&(e=3),e},t.ToUnderlineType=function(t){var e=0;return 2===t?e=1:3===t&&(e=2),e},t.MapToGroupType=function(t){return{12:9,13:9,14:9,15:3,16:3,17:3,6:3,18:8,19:8,20:8,21:2,22:2,23:2,9:11,24:11,25:11,26:11,27:11,28:11,5:4,10:12,29:12,30:12,32:12,31:5,4:5,1:14,33:14,34:14,35:14,36:14,8:7,37:7,38:7,39:1,40:1,7:1,3:10,41:10,2:13,42:13,43:13,44:6,45:6,46:6,47:6,11:14,48:14,49:11,50:11,51:11,52:11}[t]||0},t.HasSeriesLines=function(t){return this.IsOfPieChart(t)},t.HasHiLoLines=function(t){return this.IsStockChart(t)},t.HasUpDownBars=function(t){return 50===t||52===t},t.RangesToReferences=function(e){var i=[];return e.forEach(function(e){for(var n=0,r=e.Areas;n<r.length;n++){var o=r[n];i.push(t.CreateReference(o.Worksheet.name(),o.Row,o.Column,o.RowCount,o.ColumnCount))}}),i.sort(function(t,e){return t.Row-e.Row||t.Column-e.Column})},t.CreateReference=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return 1===n&&1===r?new T(t,e,i):new T(t,e,i,e+n-1,i+r-1)},t.ReferencesToFormula=function(t,e){if(void 0===e&&(e=!1),S.isNullOrUndefined(t)||0===t.length)return a;for(var i=[],n=0;n<t.length;n++)n>0&&i.push(","),e?i.push(t[n].ToR1C1Text()):i.push(t[n].ToA1Text(0,0));return i.join("")},t.GetValuesFromCellRefers=function(t,e,i){var n=[];if(S.isNullOrUndefined(e)||0===e.length||e.some(function(t){return t.IsError}))return n;for(var r=0,o=e;r<o.length;r++){var a=o[r],s=this.GetValuesFromCellRefer(t,a,i);S.isNullOrUndefined(s)||n.push(s)}return n},t.GetValuesFromCellRefer=function(t,e,i){var n=t._GetSheet(e.WorksheetName);return S.isNullOrUndefined(n)?a:i?n._GetVisibleCellValues(e.Row,e.Column,e.RowCount,e.ColumnCount,!0):n._GetCellValues(e.Row,e.Column,e.RowCount,e.ColumnCount,!0)},t.GetStylesFromCellRefers=function(t,e,i){var n=[];if(S.isNullOrUndefined(e)||0===e.length||e.some(function(t){return t.IsError}))return n;for(var r=0,o=e;r<o.length;r++){var a=o[r],s=this.GetStylesFromCellRefer(t,a,i);S.isNullOrUndefined(s)||n.push(s)}return n},t.GetStylesFromCellRefer=function(t,e,i){var n=t._GetSheet(e.WorksheetName);return S.isNullOrUndefined(n)?a:i?n._GetVisibleCellStyles(e.Row,e.Column,e.RowCount,e.ColumnCount):n._GetCellStyles(e.Row,e.Column,e.RowCount,e.ColumnCount)},t.GetPrimaryAxises=function(t){var e=[];if(t.axes&&t.axes.length>0){var i=t.axes[0];e.push(i.axId),e.push(i.crossAx)}return e},t.GetAxises=function(e,i){var n=t.GetPrimaryAxises(e);if(0===i)return n;var r=[];if(!S.isNullOrUndefined(e.axes))for(var o=0,a=e.axes.filter(function(t){return n.indexOf(t.axId)<0});o<a.length;o++){var s=a[o];r.push(s.axId)}return r},t.GetCategoryAxises=function(t){for(var e=[],i=0,n=t.chartGroups;i<n.length;i++){var r=n[i];!S.isNullOrUndefined(r.axId)&&r.axId.length>0&&e.push(r.axId[0])}return e},t.GetChartType=function(e){var i=this.GetStockChartType(e);if(!S.isNullOrUndefined(i))return i;for(var n=[],r=0,o=e.chartGroups;r<o.length;r++){var a=o[r],s=t.GetChartTypeByChartBase(a);n.indexOf(s)<0&&n.push(s)}return 0===n.length?12:n.length>1?0:n[0]},t.GetStockChartType=function(e){var i=t.GetStockChart(e);if(0===i.length)return a;if(!S.isNullOrUndefined(e.chartGroups)&&e.chartGroups.length>1){if(3===i[0].ser.length)return 51;if(4===i[0].ser.length)return 52}else{if(3===i[0].ser.length)return 49;if(4===i[0].ser.length)return 50}return a},t.GetChartTypeByChartBase=function(e,i){return void 0===i&&(i=a),6===e.chartType||7===e.chartType?t.GetChartTypeByBarChart(e):4===e.chartType||5===e.chartType?t.GetChartTypeByAreaChart(e):8===e.chartType||9===e.chartType?t.GetChartTypeByLineChart(e,i):[10,11,12,13].indexOf(e.chartType)>=0?t.GetChartTypeByPieChart(e,i):2===e.chartType?t.GetChartTypeByRadarChart(e,i):1===e.chartType?t.GetChartTypeByScatterChart(e):3===e.chartType?t.GetChartTypeByBubbleChart(e):14===e.chartType||15===e.chartType?t.GetChartTypeBySurfaceChart(e):12},t.GetChartTypeByBarChart=function(t){var e=7===t.chartType;if(S.isNullOrUndefined(t.grouping))return e?0===t.barDir?21:15:0===t.barDir?18:12;switch(t.grouping){case 0:return e?0===t.barDir?23:17:0===t.barDir?20:14;case 1:return e?0===t.barDir?21:15:0===t.barDir?18:12;case 2:return e?0===t.barDir?21:6:0===t.barDir?18:12;case 3:return e?0===t.barDir?22:16:0===t.barDir?19:13}return 12},t.GetChartTypeByAreaChart=function(t){var e=5===t.chartType;if(S.isNullOrUndefined(t.grouping))return e?7:8;switch(t.grouping){case 0:return e?40:38;case 1:return e?7:8;case 2:return e?39:37}return 8},t.GetChartTypeByLineChart=function(t,e){var i=9===t.chartType,n=t.marker;if(n&&e&&e.marker&&4===e.marker.symbol&&(n=!1),S.isNullOrUndefined(t.grouping)){if(i)return 5}else switch(t.grouping){case 0:return i?5:n?28:25;case 1:return i?5:n?26:9;case 2:return i?5:n?27:24;default:return 8}return n?26:9},t.GetChartTypeByPieChart=function(t){return 10===t.chartType?10:11===t.chartType?4:13===t.chartType?1===t.ofPieType?32:29:12===t.chartType?3:10},t.GetChartTypeByRadarChart=function(t,e){var i=!S.isNullOrUndefined(e)&&!S.isNullOrUndefined(e.marker)&&!S.isNullOrUndefined(e.marker.symbol)&&4!==e.marker.symbol;if(!S.isNullOrUndefined(t.radarStyle))switch(t.radarStyle){case 0:case 1:return i?42:2;case 2:return 43}return 2},t.GetChartTypeByScatterChart=function(t){var e=t.scatterStyle;if(!S.isNullOrUndefined(e)){var i=e,n=t.ser[0],r=4===(n&&n.marker&&n.marker.symbol),o=n&&n.spPr&&n.spPr.ln,a=o&&o.noFill;return 2===i?a?i=3:r&&(i=1):5===i&&r&&(i=4),{0:1,1:36,2:35,3:1,4:34,5:33}[i]}return 1},t.GetChartTypeByBubbleChart=function(t){return t.bubble3D?48:11},t.GetChartTypeBySurfaceChart=function(t){return 15===t.chartType?t.wireframe?45:44:t.wireframe?47:46},t.GetTextFieldTypeString=function(t){return{0:w.FIELD_TYPE_CELLRANGE,1:w.FIELD_TYPE_SERIESNAME,2:w.FIELD_TYPE_CATEGORYNAME,3:w.FIELD_TYPE_VALUE,4:w.FIELD_TYPE_XVALUE,5:w.FIELD_TYPE_YVALUE,6:w.FIELD_TYPE_BUBBLESIZE,7:w.FIELD_TYPE_PERCENTAGE,8:w.FIELD_TYPE_TXLINK}[t]||""},t.GetTextFieldTypeText=function(t){return{0:w.FIELD_TEXT_CELLRANGE,1:w.FIELD_TEXT_SERIESNAME,2:w.FIELD_TEXT_CATEGORYNAME,3:w.FIELD_TEXT_VALUE,4:w.FIELD_TEXT_XVALUE,5:w.FIELD_TEXT_YVALUE,6:w.FIELD_TEXT_BUBBLESIZE}[t]||""},t.GetTextFieldType=function(t){var e=0;switch(t){case w.FIELD_TYPE_CELLRANGE:e=0;break;case w.FIELD_TYPE_SERIESNAME:e=1;break;case w.FIELD_TYPE_CATEGORYNAME:e=2;break;case w.FIELD_TYPE_VALUE:e=3;break;case w.FIELD_TYPE_XVALUE:e=4;break;case w.FIELD_TYPE_YVALUE:e=5;break;case w.FIELD_TYPE_BUBBLESIZE:e=6;break;case w.FIELD_TYPE_PERCENTAGE:e=7;break;case w.FIELD_TYPE_TXLINK:e=8}return e},t.GetPrimaryPieChart=function(t){return t[0]},t.GetPlotAreaCharts=function(t,e){return t.chartGroups.filter(function(t){return t.chartType===e})},t.GetAreaChart=function(e){return t.GetPlotAreaCharts(e,4)},t.GetArea3DChart=function(e){var i=t.GetPlotAreaCharts(e,5);return i.length>0?i[0]:a},t.GetBarChart=function(e){return t.GetPlotAreaCharts(e,6)},t.GetBar3DChart=function(e){var i=t.GetPlotAreaCharts(e,7);return i.length>0?i[0]:a},t.GetLineChart=function(e){return t.GetPlotAreaCharts(e,8)},t.GetLine3DChart=function(e){var i=t.GetPlotAreaCharts(e,9);return i.length>0?i[0]:a},t.GetStockChart=function(e){return t.GetPlotAreaCharts(e,0)},t.GetRadarChart=function(e){return t.GetPlotAreaCharts(e,2)},t.GetScatterChart=function(e){return t.GetPlotAreaCharts(e,1)},t.GetPieCharts=function(t){var e=[10,11,12,13];return t.chartGroups.filter(function(t){return e.indexOf(t.chartType)>=0})},t.GetPieChart=function(e){return t.GetPlotAreaCharts(e,10)},t.GetPie3DChart=function(e){var i=t.GetPlotAreaCharts(e,11);return i.length>0?i[0]:a},t.GetDoughnutChart=function(e){return t.GetPlotAreaCharts(e,12)},t.GetOfPieChart=function(e){return t.GetPlotAreaCharts(e,13)},t.GetSurfaceChart=function(e){var i=t.GetPlotAreaCharts(e,14);return i.length>0?i[0]:a},t.GetSurface3DChart=function(e){var i=t.GetPlotAreaCharts(e,15);return i.length>0?i[0]:a},t.GetBubbleChart=function(e){return t.GetPlotAreaCharts(e,3)},t.GetAxes=function(t,e){return t.axes.filter(function(t){return t.axisType===e})},t.removeEmptyArrayProperties=function(t){for(var e in t)if(t.hasOwnProperty(e)){var i=t[e];Array.isArray(i)&&0===i.length&&delete t[e]}},t.allSeriesIsScatterOrBubble=function(e){var i=e.ChartType;if(t.IsBubbleChart(i)||t.IsScatterChart(i))return!0;if(0===i){var n=e.SeriesCollection.AllSers;if(!n.length)return!1;var r,o=n.length,a=n[0].ChartType;if(t.IsBubbleChart(a)){for(r=1;r<o;r++)if(!t.IsBubbleChart(n[r].ChartType))return!1;return!0}if(t.IsScatterChart(a)){for(r=1;r<o;r++)if(!t.IsScatterChart(n[r].ChartType))return!1;return!0}}return!1},t.simpleJSONObject=s,t}();P.presetColors={},P.InitPresetColors(),e.ChartUtility=P;var A=function(){function t(t,i,n){var r=new e.ColorFormat(t);return r.ColorType=i,r.RGB=n,r}function i(t,i,n){var r=new e.GradientStop(t);return r.Position=i,r.Color=n,r}function n(t,i,n,r){var o=new e.ColorFormat(t);return o.ColorType=i,o.ObjectThemeColor=n,r&&(o.TintAndShade=r),o}function r(){}return r.InitGradientStops=function(t,i,n){if(i._SetGradientStops(new e.GradientStops(t)),1===n)this.InitGradientStopOneColor(t,i);else if(2===n)this.InitGradientStopTwoColor(t,i);else{if(3!==n)throw new Error;this.InitGradientStopPresetColor(t,i)}i.GradientAngle=this.GetGradientAngle(i.GradientStyle,i.GradientVariant)},r.InitGradientStopPresetColor=function(e,n){var r,o,a,s,l,u,h,c,p,f,d,g,y,m=n.GradientStops.GradientStopList;switch(n.PresetGradientType){case 0:r=i(e,0,t(e,2,_(130))),o=i(e,.3,t(e,2,_(6684815))),a=i(e,.64999,t(e,2,_(12189798))),s=i(e,.89999,t(e,2,_(16711680))),l=i(e,1,t(e,2,_(16744960))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l);break;case 1:r=i(e,0,t(e,2,_(0))),o=i(e,.2,t(e,2,_(64))),a=i(e,.5,t(e,2,_(4194368))),s=i(e,.75,t(e,2,_(9371712))),l=i(e,.89999,t(e,2,_(15889152))),u=i(e,1,t(e,2,_(16760576))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u);break;case 2:r=i(e,0,t(e,2,_(0))),o=i(e,.39999,t(e,2,_(660108))),a=i(e,.7,t(e,2,_(1580231))),s=i(e,.88,t(e,2,_(7341524))),l=i(e,1,t(e,2,_(9190801))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l);break;case 3:r=i(e,0,t(e,2,_(6201087))),o=i(e,.39999,t(e,2,_(8766207))),a=i(e,.7,t(e,2,_(12900075))),s=i(e,1,t(e,2,_(16772090))),m.push(r),m.push(o),m.push(a),m.push(s);break;case 4:r=i(e,0,t(e,2,_(14478325))),o=i(e,.08,t(e,2,_(8628163))),a=i(e,.13,t(e,2,_(7770041))),s=i(e,.21001,t(e,2,_(8628163))),l=i(e,.52,t(e,2,_(16777215))),u=i(e,.56,t(e,2,_(10249571))),h=i(e,.58,t(e,2,_(8400941))),c=i(e,.71001,t(e,2,_(12603982))),p=i(e,.94,t(e,2,_(15456980))),f=i(e,1,t(e,2,_(5580316))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c),m.push(p),m.push(f);break;case 5:r=i(e,0,t(e,2,_(16555979))),o=i(e,.87,t(e,2,_(16298057))),a=i(e,.78999,t(e,2,_(16298057))),s=i(e,.37,t(e,2,_(16705522))),l=i(e,.33,t(e,2,_(16339616))),u=i(e,.31,t(e,2,_(12912713))),h=i(e,.17999,t(e,2,_(11812485))),c=i(e,0,t(e,2,_(16298057))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c);break;case 6:r=i(e,0,t(e,2,_(251048))),o=i(e,.25,t(e,2,_(2217696))),a=i(e,.75,t(e,2,_(34790))),s=i(e,1,t(e,2,_(23743))),m.push(r),m.push(o),m.push(a),m.push(s);break;case 7:r=i(e,.5,t(e,2,_(13421823))),o=i(e,.41001,t(e,2,_(10079487))),a=i(e,.32,t(e,2,_(10053375))),s=i(e,.195,t(e,2,_(13408767))),l=i(e,.8999,t(e,2,_(10079487))),u=i(e,0,t(e,2,_(13421823))),h=i(e,.59,t(e,2,_(10079487))),c=i(e,.68,t(e,2,_(10053375))),p=i(e,.805,t(e,2,_(13408767))),f=i(e,.91001,t(e,2,_(10079487))),d=i(e,1,t(e,2,_(13421823))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c),m.push(p),m.push(f),m.push(d);break;case 8:r=i(e,0,t(e,2,_(16773632))),o=i(e,.45,t(e,2,_(16742912))),a=i(e,.7,t(e,2,_(16712448))),s=i(e,1,t(e,2,_(5048328))),m.push(r),m.push(o),m.push(a),m.push(s);break;case 9:r=i(e,0,t(e,2,_(8685764))),o=i(e,.53,t(e,2,_(13950719))),a=i(e,.83,t(e,2,_(13950719))),s=i(e,1,t(e,2,_(9874324))),m.push(r),m.push(o),m.push(a),m.push(s);break;case 10:r=i(e,0,t(e,2,_(14543823))),o=i(e,.25,t(e,2,_(10270830))),a=i(e,.5,t(e,2,_(1403667))),s=i(e,1,t(e,2,_(14543823))),l=i(e,.75,t(e,2,_(10270830))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l);break;case 11:r=i(e,0,t(e,2,_(3381759))),o=i(e,.16,t(e,2,_(52428))),a=i(e,.47,t(e,2,_(10066431))),s=i(e,.60001,t(e,2,_(3041170))),l=i(e,.71001,t(e,2,_(3355596))),u=i(e,.81,t(e,2,_(1143039))),h=i(e,1,t(e,2,_(26265))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h);break;case 12:r=i(e,0,t(e,2,_(16509639))),o=i(e,.17999,t(e,2,_(16705522))),a=i(e,.36,t(e,2,_(16435069))),s=i(e,.61,t(e,2,_(16492925))),l=i(e,.82001,t(e,2,_(16503964))),u=i(e,1,t(e,2,_(16705522))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u);break;case 13:r=i(e,0,t(e,2,_(16773073))),o=i(e,.64999,t(e,2,_(15789013))),a=i(e,1,t(e,2,_(13747103))),m.push(r),m.push(o),m.push(a);break;case 14:r=i(e,0,t(e,2,_(14070172))),o=i(e,.15,t(e,2,_(13934188))),a=i(e,.35,t(e,2,_(10900776))),s=i(e,.5,t(e,2,_(6696978))),l=i(e,1,t(e,2,_(14070172))),u=i(e,.85,t(e,2,_(13934188))),h=i(e,.65,t(e,2,_(10900776))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h);break;case 15:r=i(e,.5,t(e,2,_(10879915))),o=i(e,.395,t(e,2,_(530939))),a=i(e,.32499,t(e,2,_(1740104))),s=i(e,.24,t(e,2,_(16776960))),l=i(e,.135,t(e,2,_(15613719))),u=i(e,.6,t(e,2,_(15210342))),h=i(e,0,t(e,2,_(10879915))),c=i(e,.60501,t(e,2,_(530939))),p=i(e,.67501,t(e,2,_(1740104))),f=i(e,.76,t(e,2,_(16776960))),d=i(e,.865,t(e,2,_(15613719))),g=i(e,.94,t(e,2,_(15210342))),y=i(e,1,t(e,2,_(10879915))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c),m.push(p),m.push(f),m.push(d),m.push(g),m.push(y);break;case 16:r=i(e,0,t(e,2,_(16724889))),o=i(e,.25,t(e,2,_(16737843))),a=i(e,.5,t(e,2,_(16776960))),s=i(e,.75,t(e,2,_(108431))),l=i(e,1,t(e,2,_(3368703))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l);break;case 17:r=i(e,0,t(e,2,_(15129772))),o=i(e,.12,t(e,2,_(15128458))),a=i(e,.3,t(e,2,_(13085772))),s=i(e,.45,t(e,2,_(15128458))),l=i(e,.77,t(e,2,_(13085772))),u=i(e,1,t(e,2,_(15129772))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u);break;case 18:r=i(e,0,t(e,2,_(16508078))),o=i(e,.13,t(e,2,_(12423722))),a=i(e,.21001,t(e,2,_(12423722))),s=i(e,.63,t(e,2,_(16508078))),l=i(e,.67,t(e,2,_(12423722))),u=i(e,.69,t(e,2,_(8609303))),h=i(e,.82001,t(e,2,_(10651977))),c=i(e,1,t(e,2,_(16442295))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c);break;case 19:r=i(e,1,t(e,2,_(8541696))),o=i(e,.87,t(e,2,_(16754688))),a=i(e,.72,t(e,2,_(8541696))),s=i(e,.57001,t(e,2,_(16754688))),l=i(e,.42,t(e,2,_(8541696))),u=i(e,.28,t(e,2,_(16754688))),h=i(e,.13,t(e,2,_(8541696))),c=i(e,0,t(e,2,_(16754688))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c);break;case 20:r=i(e,0,t(e,2,_(16777215))),o=i(e,.16,t(e,2,_(2039583))),a=i(e,.17999,t(e,2,_(16777215))),s=i(e,.42,t(e,2,_(6513507))),l=i(e,.53,t(e,2,_(13619151))),u=i(e,.66,t(e,2,_(13619151))),h=i(e,.75999,t(e,2,_(2039583))),c=i(e,.78999,t(e,2,_(16777215))),p=i(e,1,t(e,2,_(8355711))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c),m.push(p);break;case 21:r=i(e,0,t(e,2,_(13355979))),o=i(e,.13,t(e,2,_(6250335))),a=i(e,.21001,t(e,2,_(6250335))),s=i(e,.63,t(e,2,_(16777215))),l=i(e,.67,t(e,2,_(11711154))),u=i(e,.69,t(e,2,_(2697513))),h=i(e,.82001,t(e,2,_(7829367))),c=i(e,1,t(e,2,_(15395562))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c);break;case 22:r=i(e,0,t(e,2,_(16777215))),o=i(e,.03501,t(e,2,_(15132390))),a=i(e,.16,t(e,2,_(8225942))),s=i(e,.235,t(e,2,_(15132390))),l=i(e,.42501,t(e,2,_(8225942))),u=i(e,.5,t(e,2,_(15132390))),h=i(e,1,t(e,2,_(15132390))),c=i(e,.965,t(e,2,_(15132390))),p=i(e,.84,t(e,2,_(8225942))),f=i(e,.765,t(e,2,_(15132390))),d=i(e,.575,t(e,2,_(8225942))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c),m.push(p),m.push(f),m.push(d);break;case 23:r=i(e,0,t(e,2,_(130))),o=i(e,.13,t(e,2,_(18431))),a=i(e,.28,t(e,2,_(130))),s=i(e,.42999,t(e,2,_(18431))),l=i(e,.58,t(e,2,_(130))),u=i(e,.72,t(e,2,_(18431))),h=i(e,.87,t(e,2,_(130))),c=i(e,1,t(e,2,_(18431))),m.push(r),m.push(o),m.push(a),m.push(s),m.push(l),m.push(u),m.push(h),m.push(c)}},r.InitGradientStopTwoColor=function(e,r){var o=r.GradientStyle;if(6!==o)if(4!==o){var a=r.GradientStops.GradientStopList,s=r.GradientVariant;1===s||2===s?(a.push(i(e,0,n(e,3,4))),a.push(i(e,1,t(e,2,_(16777215))))):3===s?(a.push(i(e,0,n(e,3,4))),a.push(i(e,.5,t(e,2,_(16777215)))),a.push(i(e,1,n(e,3,4)))):4===s&&(a.push(i(e,.5,n(e,3,4))),a.push(i(e,0,t(e,2,_(16777215)))),a.push(i(e,1,t(e,2,_(16777215)))))}else this.InitGradientTwoColorCornerStops(e,r);else this.InitGradientTwoColorCenterStops(e,r)},r.InitGradientTwoColorCornerStops=function(e,r){var o=r.GradientStops.GradientStopList;o.push(i(e,0,n(e,3,4))),o.push(i(e,1,t(e,2,_(16777215))))},r.InitGradientTwoColorCenterStops=function(e,r){var o=r.GradientStops.GradientStopList,a=r.GradientVariant;1===a?(o.push(i(e,0,n(e,3,4))),o.push(i(e,1,t(e,2,_(16777215))))):2===a?(o.push(i(e,0,t(e,2,_(16777215)))),o.push(i(e,1,n(e,3,4)))):3===a?(o.push(i(e,0,n(e,3,4))),o.push(i(e,.5,t(e,2,_(16777215)))),o.push(i(e,1,n(e,3,4)))):4===a&&(o.push(i(e,0,t(e,2,_(16777215)))),o.push(i(e,.5,n(e,3,4))),o.push(i(e,1,t(e,2,_(16777215)))))},r.InitGradientOneColorCornerStops=function(t,e){var r=n(t,3,4,this.GetTintAndShadeByDegree(e.GradientDegree)),o=e.GradientStops.GradientStopList;o.push(i(t,0,n(t,3,4))),o.push(i(t,1,r))},r.InitGradientOneColorCenterStops=function(t,e){var r=n(t,3,4,this.GetTintAndShadeByDegree(e.GradientDegree)),o=e.GradientStops.GradientStopList,a=e.GradientVariant;1===a?(o.push(i(t,0,n(t,3,4))),o.push(i(t,1,r))):2===a?(o.push(i(t,0,r)),o.push(i(t,1,n(t,3,4)))):3===a?(o.push(i(t,0,n(t,3,4))),o.push(i(t,.5,r)),o.push(i(t,1,n(t,3,4)))):4===a&&(o.push(i(t,0,r)),o.push(i(t,.5,n(t,3,4))),o.push(i(t,1,r)))},r.InitGradientStopOneColor=function(t,e){var r=e.GradientStyle;if(6!==r)if(4!==r){var o=this.GetTintAndShadeByDegree(e.GradientDegree),a=e.GradientStops.GradientStopList,s=e.GradientVariant;1===s||2===s?(a.push(i(t,0,n(t,3,4))),a.push(i(t,1,n(t,3,4,o)))):3===s?(a.push(i(t,0,n(t,3,4))),a.push(i(t,.5,n(t,3,4,o))),a.push(i(t,1,n(t,3,4)))):4===s&&(a.push(i(t,.5,n(t,3,4))),a.push(i(t,0,n(t,3,4))),a.push(i(t,1,n(t,3,4,o))))}else this.InitGradientOneColorCornerStops(t,e);else this.InitGradientOneColorCenterStops(t,e)},r.GetTintAndShadeByDegree=function(t){return 2*(t-.5)},r.GetGradientAngle=function(t,e){var i=0;switch(t){case 0:1===e?i=90:2===e||4===e?i=270:3===e&&(i=90);break;case 1:1===e||3===e?i=0:2!==e&&4!==e||(i=180);break;case 2:1===e||3===e?i=45:2!==e&&4!==e||(i=225);break;case 3:1===e||3===e?i=135:2!==e&&4!==e||(i=315);break;case 4:case 6:i=135}return i},r.ToLum=function(t){return 1e5-u(2e5*(1-t))},r.FromLum=function(t){return 1-(1e5-t)/2e5},r}();e.ShapeUtility=A;var F=function(){function t(){}function e(t){return 8===t||!P.Is3DChart(t)&&(P.IsBarChart(t)||P.IsColumnChart(t)||P.IsLineChart(t))}function i(t){var i=t.ChartType;if(0!==i)return e(i);for(var n=t.SeriesCollection.AllSers,r=0,o=n.length;r<o;r++)if(e(n[r].ChartType))return!0;return!1}return t.CalculateValidMinimum=function(t,e,i,n,r,o){return i?t===b.DOUBLE_MAX_VALUE||t<=0?e===b.DOUBLE_MIN_VALUE||e<=0?t=1:e<1?t=e/n:1===e?t=1/n:1<e&&(t=1):e<=t&&(e===b.DOUBLE_MIN_VALUE||e<=0||(e<1&&r&&!o?t=e/n:1===e&&r&&!o?t=1/n:1<e&&(r||!o)&&(t=1))):t===b.DOUBLE_MAX_VALUE?e===b.DOUBLE_MIN_VALUE?t=0:e<0?t=2*e:0===e?t=-1:0<e&&(t=0):e<=t&&(e===b.DOUBLE_MIN_VALUE||(e<0&&r&&!o?t=2*e:0===e&&r&&!o?t=-1:0<e&&(r||!o)&&(t=0))),t},t.CalculateValidMaximum=function(t,e,i,n){return i?e<=t&&(t<1?e=1:1===t?e=n:1<t&&(e=t*n)):e<=t&&(t<0?e=0:0===t?e=1:0<t&&(e=2*t)),e},t.calcMinMax=function(t,e,n,r){var o,a,s=e-t,l=.05*s,u=r.ChartType;return n?(o=t,a=e,e<1&&(o=a=1)):t>=0?(a=e,i(r)&&(a+=l),6*s>e?o=0:(o=t-s/2,(P.IsScatterChart(u)||P.IsBubbleChart(u))&&(o=t))):e<=0?(o=t,i(r)&&(o-=l),6*s+t>0?a=0:(a=e+s/2,(P.IsScatterChart(u)||P.IsBubbleChart(u))&&(a=e))):(o=t-l,a=e+l),{Min:o,Max:a}},t.CalculateMinimum2=function(t,e,i,n,r){return t=n?c(r,u(b.log(t,r))):u(t/i)*i},t.CalculateMaximum2=function(t,e,i,n,r){return e=n?c(r,p(b.log(e,r))):p(e/i)*i},t.CalculateMajorUnit=function(t,e,i,n,r,o){var a,l=f(e-t);return r?a=o:(l/(a=c(10,u(b.log(l,10))))<=1.6?a/=5:l/a<=4?a/=2:l/a>8&&(a*=2),i||(a=s(a,n))),a},t.CalculateMinorUnit=function(t,e,i,n){return n?i:i/5},t.GenerateAxisId=function(){for(var t=0;;)if(t=u(9e7*Math.random())+1e7,!this._axisIds[t]){this._axisIds[t]=!0;break}return t},t}();F._axisIds={},e.AxisUtility=F;var O=function(){function t(){}var e=t.prototype;return g(e,"ChartFormat",{get:function(){return S.isNullOrUndefined(this._format)&&(this._format=this.GetDefaultFormat()),this._format}}),e.CreateFormat=function(){return a},e.GetDefaultFormat=function(){return this.CreateFormat()},e.GetFormatInternal=function(){return this._format},e.FromShapeProperties=function(t){S.isNullOrUndefined(t)?this.ClearFormat():(S.isNullOrUndefined(this._format)&&(this._format=this.CreateFormat()),this._format.FromOOModel(t))},e.ToShapeProperties=function(){return S.isNullOrUndefined(this._format)?a:this._format.ToOOModel()},e.Delete=function(){S.isNullOrUndefined(this._format)||(this._format.ParentStateful=a)},e.ClearFormat=function(){S.isNullOrUndefined(this._format)||(this._format.SetParentForChildren(a),this._format.ParentStateful=a,this._format=a)},t}();e.ChartElementBase=O;var M=function(t){function e(e){return t.call(this,e)||this}r.inherit(e,t);var i=e.prototype;return g(i,"ChartFormat",{get:function(){return S.isNullOrUndefined(this._format)&&(this._format=this.GetDefaultFormat()),this._format},set:function(t){S.isNullOrUndefined(this._format)||this._format.SetParentForChildren(t);var e=this._format;this._format=t,S.isNullOrUndefined(e)||(this._format.ParentStateful=e.ParentStateful)}}),i.CreateFormat=function(){return a},i.GetDefaultFormat=function(){return this.CreateFormat()},i.FromShapeProperties=function(t){S.isNullOrUndefined(t)?this.ClearFormat():(S.isNullOrUndefined(this._format)&&(this._format=this.CreateFormat()),this._format.FromOOModel(t))},i.ToShapeProperties=function(){return S.isNullOrUndefined(this._format)?a:this._format.ToOOModel()},i.Delete=function(){S.isNullOrUndefined(this._format)||(this._format.ParentStateful=a)},i.ClearFormat=function(){S.isNullOrUndefined(this._format)||(this._format.SetParentForChildren(a),this._format.ParentStateful=a,this._format=a)},e}(o);e.StatefulChartElementBase=M,t.exports=e}()},function(e,i,n){"use strict";e.exports=t.Spread.Common},function(e,i,n){"use strict";e.exports=t.Spread.Sheets},function(t,e,i){"use strict";!function(){var e=i(2)._Types,n=e._extend,r=e._isNullOrUndefined,o=i(0),a=function(){function t(t){this._children=[],this._workingState=0,this._states=0,this._parentStateFull=t,this._parentStateFull&&this._parentStateFull.AddChildInternal(this)}var e=t.prototype,i=Object.defineProperty;return n(e,{SetState:function(t,e){var i=t;e?this._states|=i:this._states&=~i,this.IsClearChildrenStateSuspended||this._children.forEach(function(e){e.SetState(t,!1)})},GetState:function(t,e){var i=t,n=(i&this._states)===i;return n||!e||r(this._parentStateFull)||(n=this._parentStateFull.GetState(t,!0)),n},OnStateChanged:function(t){},Dirty:function(t){this.SetState(t,!0)},UnDirty:function(t){this.SetState(t,!1)},UnDirtyAll:function(){this._states=0},IsDirty:function(t){return this.GetState(t)},IsPropDirtyIncludingParent:function(t,e){return!!this.GetState(t)||!(!e||r(this._parentStateFull))&&this._parentStateFull.IsPropDirtyIncludingParent(t,!0)},IsDirtyIncludingParent:function(t){return this._states>0||!(!t||r(this._parentStateFull))&&this._parentStateFull.IsDirtyIncludingParent(!0)},AddChildInternal:function(t){var e=this._children;-1===e.indexOf(t)&&e.push(t)},RemoveChildInternal:function(t){var e=this._children,i=e.indexOf(t);-1!==i&&e.splice(i,1)},SetParentForChildren:function(t){this._children.slice(0).forEach(function(e){e.ParentStateful=t})},OnParentChanged:function(t){},SuspendClearChildrenState:function(){this._workingState++},ResumeClearChilrenState:function(){this._workingState--}}),i(e,"ParentStateful",{get:function(){return this._parentStateFull},set:function(t){t!==this._parentStateFull&&(this._parentStateFull&&this._parentStateFull.RemoveChildInternal(this),this._parentStateFull=t,this._parentStateFull&&this._parentStateFull.AddChildInternal(this),this.OnParentChanged(t))},enumerable:!0,configurable:!0}),i(e,"Children",{get:function(){return this._children},enumerable:!0,configurable:!0}),i(e,"IsClearChildrenStateSuspended",{get:function(){return this._workingState>0},enumerable:!0,configurable:!0}),t}();o.StatefullBase=a,t.exports=o}()},function(t,e,i){"use strict";!function(){var e=i(0),n=i(3).GC$,r=i(1),o=r.UnitHelper.isNullOrUndefined,a=r.ChartUtility.defineProperty,s=i(11).FillFormat,l=i(22).LineFormat,u=i(7).ColorFormat,h=i(23).ThreeDFormat,c=i(24),p=c.ShadowFormat,f=c.GlowFormat,_=c.SoftEdgeFormat,d=c.ReflectionFormat,g=i(8).ARGBColor,y=i(4).StatefullBase,m=null,v=void 0;e.ChartFormatStates={Fill:1,Glow:2,Line:4,PictureFormat:8,Shadow:16,SoftEdge:32,ThreeD:64};var b=function(t){function e(e,i,n,r){i===v&&(i=m);var o=t.call(this,i)||this;return o._oomodel=m,o._chart=e,o._parentChartFormat=i,o._autoFillColorFormat=n||o._getAutoFillColorFormat.bind(o),o._autoLineColorFormat=r||o._getAutoLineColorFormat.bind(o),o}n.inherit(e,t);var i=e.prototype;return i._getAutoFillColorFormat=function(){var t=this._parentChartFormat,e=new u(this._chart,t&&t.FillInternal);return e.RGB=g.FromRgb(255,255,255),e},i._getAutoLineColorFormat=function(){var t=this._parentChartFormat,e=new u(this._chart,t&&t.FillInternal);return e.RGB=g.FromRgb(0,0,0),e},a(i,"Fill",{get:function(){return this.FillInternal}}),a(i,"Line",{get:function(){return this.LineInternal}}),a(i,"ThreeD",{get:function(){return this.ThreedInternal}}),i.FromOOModel=function(t){this._oomodel=t,o(t)||(o(t.solidFill)?o(t.noFill)?o(t.blipFill)?o(t.gradFill)?o(t.pattFill)||this.FillInternal.FromOOModel(t.pattFill,1):this.FillInternal.FromOOModel(t.gradFill,2):this.FillInternal.FromOOModel(t.blipFill,3):this.FillInternal.Color.ColorType=0:this.FillInternal.FromOOModel(t.solidFill,0),o(t.ln)||this.LineInternal.FromOOModel(t.ln),o(t.scene3d)&&o(t.sp3d)||this.ThreedInternal.FromOOModel({Scene3D:t.scene3d,Shape3D:t.sp3d}),this.FromCT_EffectList(t.effectLst))},i.ToOOModel=function(){return this.ToCT_ShapeProperties()},i.ToCT_ShapeProperties=function(){var t=o(this._oomodel)?{}:this._oomodel;if(delete t.solidFill,delete t.pattFill,delete t.blipFill,delete t.gradFill,delete t.noFill,!o(this._fill)){var e=this._fill.ToOOModel();0===e.colorFillType?t.solidFill=e:1===e.colorFillType?t.pattFill=e:2===e.colorFillType?t.gradFill=e:3===e.colorFillType?t.blipFill=e:5===e.colorFillType&&(t.noFill=!0),delete e.colorFillType}if(o(this._line)?delete t.ln:t.ln=this._line.ToOOModel(),!o(this._threeDFormat)&&this._threeDFormat.IsDirtyIncludingParent()){var i=this._threeDFormat.ToOOModel();t.scene3d=i.Scene3D,t.sp3d=i.Shape3D}return t.effectLst=this.ToCT_EffectList(),t},i.Clone=function(){var t=new e(this._chart);return o(this._fill)||(t._fill=this._fill.Clone()),o(this._line)?t._line=m:t._line=this._line.Clone(),o(this._threeDFormat)||(t._threeDFormat=this._threeDFormat.Clone()),t._states=this._states,t._parentChartFormat=this._parentChartFormat,t},i.IsDirtyIncludingParent=function(e){return e===v&&(e=!1),!(o(this._fill)||!this._fill.IsDirtyIncludingParent())||(!(o(this._line)||!this._line.IsDirtyIncludingParent())||(!(o(this._threeDFormat)||!this._threeDFormat.IsDirtyIncludingParent())||t.prototype.IsDirtyIncludingParent.call(this,e)))},i.OnParentChanged=function(t){this._parentChartFormat=t,o(this._parentChartFormat)?(o(this._fill)||(this._fill.ParentStateful=m),o(this._line)||(this._line.ParentStateful=m),o(this._threeDFormat)||(this._threeDFormat.ParentStateful=m),o(this._glow)||(this._glow.ParentStateful=m),o(this._shadow)||(this._shadow.ParentStateful=m),o(this._softEdge)||(this._softEdge.ParentStateful=m),o(this._relfection)||(this._relfection.ParentStateful=m)):(o(this._fill)||(this._fill.ParentStateful=this._parentChartFormat.Fill),o(this._line)||(this._line.ParentStateful=this._parentChartFormat.Line),o(this._threeDFormat)||(this._threeDFormat.ParentStateful=this._parentChartFormat.ThreeD),o(this._glow)||(this._glow.ParentStateful=this._parentChartFormat.GlowFormatInternal),o(this._shadow)||(this._shadow.ParentStateful=this._parentChartFormat.ShadowFormatInternal),o(this._softEdge)||(this._softEdge.ParentStateful=this._parentChartFormat.SoftEdgeFormatInternal),o(this._relfection)||(this._relfection.ParentStateful=this._parentChartFormat.ReflectionFormatInternal))},i.FromCT_EffectList=function(t){if(o(t))return this.SetShadowField(m),this.SetGlowField(m),this.SetSoftEdgeField(m),void this.SetReflectionField(m);o(t.innerShdw)?o(t.outerShdw)?o(t.prstShdw)?this.SetShadowField(m):this.ShadowFormatInternal.FromOOModel(t.prstShdw):this.ShadowFormatInternal.FromOOModel(t.outerShdw):this.ShadowFormatInternal.FromOOModel(t.innerShdw),o(t.glow)?this.SetGlowField(m):this.GlowFormatInternal.FromOOModel(t.glow),o(t.softEdge)?this.SetSoftEdgeField(m):this.SoftEdgeFormatInternal.FromOOModel(t.softEdge),o(t.reflection)?this.SetReflectionField(m):this.ReflectionFormatInternal.FromOOModel(t.reflection)},i.ToCT_EffectList=function(){var t=o(this._oomodel)||o(this._oomodel.effectLst)?{}:this._oomodel.effectLst;if(delete t.outerShdw,delete t.innerShdw,delete t.prstShdw,!o(this._shadow)){var e=this._shadow.ToOOModel();if(e){var i=e.shadowEffectType;0===i?t.outerShdw=e:1===i?t.innerShdw=e:2===i&&(t.prstShdw=e)}}return delete t.glow,o(this._glow)||(t.glow=this._glow.ToOOModel()),delete t.softEdge,o(this._softEdge)||(t.softEdge=this._softEdge.ToOOModel()),delete t.reflection,o(this._relfection)||(t.reflection=this._relfection.ToOOModel()),this.IsEffectListDirty(t)?t:{}},a(i,"FillInternal",{get:function(){return o(this._fill)&&(this._fill=new s(this._chart,o(this._parentChartFormat)?m:this._parentChartFormat.FillInternal,this._autoFillColorFormat,this._chart.Parent)),this._fill}}),a(i,"LineInternal",{get:function(){return o(this._line)&&(this._line=new l(this._chart,o(this._parentChartFormat)?m:this._parentChartFormat.LineInternal,this._autoLineColorFormat)),this._line}}),a(i,"ThreedInternal",{get:function(){return o(this._threeDFormat)&&(this._threeDFormat=new h(this._chart,o(this._parentChartFormat)?m:this._parentChartFormat.ThreedInternal)),this._threeDFormat}}),a(i,"ShadowFormatInternal",{get:function(){return o(this._shadow)&&(this._shadow=new p(this._chart,o(this._parentChartFormat)?m:this._parentChartFormat.ShadowFormatInternal)),this._shadow}}),a(i,"GlowFormatInternal",{get:function(){return o(this._glow)&&(this._glow=new f(this._chart,o(this._parentChartFormat)?m:this._parentChartFormat.GlowFormatInternal)),this._glow}}),a(i,"SoftEdgeFormatInternal",{get:function(){return o(this._softEdge)&&(this._softEdge=new _),this._softEdge}}),a(i,"ReflectionFormatInternal",{get:function(){return o(this._relfection)&&(this._relfection=new d(this._chart,o(this._parentChartFormat)?m:this._parentChartFormat.ReflectionFormatInternal)),this._relfection}}),i.AdjustStateful=function(t,e){o(t)||(t.SetParentForChildren(e),o(e)||(e.ParentStateful=t.ParentStateful),t.ParentStateful=m)},i.SetFillField=function(t){this.AdjustStateful(this._fill,t),this._fill=t},i.SetLineField=function(t){this.AdjustStateful(this._line,t),this._line=t},i.SetThreeDField=function(t){this.AdjustStateful(this._threeDFormat,t),this._threeDFormat=t},i.SetShadowField=function(t){this.AdjustStateful(this._shadow,t),this._shadow=t},i.SetGlowField=function(t){this.AdjustStateful(this._glow,t),this._glow=t},i.SetReflectionField=function(t){this.AdjustStateful(this._relfection,t),this._relfection=t},i.SetSoftEdgeField=function(t){this.AdjustStateful(this._softEdge,t),this._softEdge=t},i.IsEffectListDirty=function(t){return!(o(t.blur)&&o(t.fillOverlay)&&o(t.glow)&&o(t.innerShdw)&&o(t.outerShdw)&&o(t.prstShdw)&&o(t.reflection)&&o(t.softEdge))},e}(y);e.ChartFormat=b,t.exports=e}()},function(t,e,i){"use strict";!function(){var e=i(0),n=i(3).GC$.inherit,r=i(1),o=r.UnitHelper,a=r.ChartUtility.defineProperty,s=r.UnitHelper.isNullOrUndefined,l=r.ChartElementBase,u=i(5).ChartFormat,h=i(25).DrawingTextBody,c=null,p=void 0,f=function(){function t(t){this._drawing=t}var e=t.prototype;return a(e,"Formula",{get:function(){return this.GetFormula(!1)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t)}}),a(e,"FormulaR1C1",{get:function(){return this.GetFormula(!0)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t,!0)}}),a(e,"Parent",{get:function(){return this._drawing}}),a(e,"ReferingText",{get:function(){return this.GetReferingText()}}),a(e,"Worksheet",{get:function(){return this._drawing.sheet()}}),a(e,"TextRefer",{get:function(){return this._textRefer},set:function(t){this.SetTextRefer(t)}}),e.SetTextRefer=function(t,e){e===p&&(e=!0),this.SetTextReferInternal(t,e),this.OnSetTextRefer(t)},e.OnSetTextRefer=function(t){},e.GetReferingText=function(){var t="";if(!s(this._textRefer))for(var e=0,i=this.GetTextList(this._textRefer);e<i.length;e++)t+=i[e];return t},e.GetTextList=function(t){var e=[],i=this.Worksheet;s(t.WorksheetName)&&(t.WorksheetName=i.name());for(var n=i._GetSheet(t.WorksheetName),r=t.Row;r<=t.LastRow;r++)for(var o=t.Column;o<=t.LastColumn;o++){var a=n._GetRange(r,o).Text;e.push(s(a)?"":a)}return e},e.SetTextReferInternal=function(t,e){this._textRefer=t},e.GetFormula=function(t){t===p&&(t=!1);var e=this._textRefer;if(!e)return"";var i=this.Worksheet.name();return t?e.ToR1C1Text(i):e.ToA1Text(0,0,i)},e.UpdateTextByFormulas=function(t,e){e===p&&(e=!1);var i=this.Worksheet._ParseFormula(t,0,0,e).references;this._textRefer=i?i[0]:c},t}();e.ReferenceText=f;var _=function(t){function e(e,i,n,r){i===p&&(i=c),n===p&&(n=c),r===p&&(r=c);var o=t.call(this,e)||this;return o._textBody=c,o._ooText=c,o._defaultText=n,o._fontDefaultOptions=r,o.InitRichTextFields(i),o}n(e,t);var i=e.prototype;return i.InitRichTextFields=function(t){var e=new h(this._drawing,this._fontDefaultOptions);s(this._textBody)||this._textBody.Font.SetParentForChildren(e.Font),this._textBody=e,this._textBody.Font.ParentStateful=t,s(this._defaultText)||this._textBody.AddParagraph(this._defaultText)},a(i,"TextBody",{get:function(){return this._textBody}}),a(i,"Font",{get:function(){return this._textBody.Font}}),a(i,"Text",{get:function(){return s(this.TextRefer)?this._textBody.Text:this.ReferingText},set:function(t){this.SetTextInternal(t)}}),i.SetTextInternal=function(t){this.SetTextReferInternal(c),this.UpdateTextBody(t)},i.UpdateTextBody=function(t){this._textBody.Clear();var e=s(t)?this._defaultText:t;s(e)||this._textBody.AddParagraph(e)},i.OnSetTextRefer=function(e){t.prototype.OnSetTextRefer.call(this,e),this.UpdateTextBody(c)},i.FromOOModel=function(t){this._ooText=t,this.InitRichTextFields(this._textBody.Font.ParentStateful),s(t.rich)||this._textBody.FromOOModel(t.rich),!s(t.strRef)&&t.strRef.f&&this.UpdateTextByFormulas(t.strRef.f)},i.ToOOModel=function(){var t=s(this._ooText)?{}:this._ooText;return s(this._textRefer)?t.rich=this._textBody.ToOOModel():(t.strRef={f:this.Formula},t.rich=this._textBody.ToOOModel()),t},i.SetParagraphSplitFlag=function(t){for(var e=this._textBody,i=0;i<e.Count;i++)e.Get(i).SplitSpaceFlag=t},i.UpdateFiledElementTextLink=function(t){for(var e=this._textBody,i=0;i<e.Count;i++)for(var n=e.Get(i),r=0;r<n.Count;r++){var o=n.Get(r);if(!s(o)&&8===o.Type)return void o.UpdateTextByFormulas(t)}},e}(f);e.DrawingText=_;var d=function(t){function e(e){var i=t.call(this)||this;return i._includeInLayout=!0,i._chartText=c,i._ooTitle=c,i._chart=e,i._chartText=i.GetDefaultChartText(),i}n(e,t);var i=e.prototype;return i.GetChartTextInternal=function(){return this._chartText},a(i,"Font",{get:function(){return s(this._chartText)&&(this._chartText=this.GetDefaultChartText()),this._chartText.Font}}),a(i,"Format",{get:function(){return this.ChartFormat}}),a(i,"Formula",{get:function(){return s(this._chartText)?c:this._chartText.Formula},set:function(t){s(this._chartText)&&(this._chartText=this.GetDefaultChartText()),this._chartText.Formula=t}}),a(i,"FormulaR1C1",{get:function(){return s(this._chartText)?c:this._chartText.FormulaR1C1},set:function(t){s(this._chartText)&&(this._chartText=this.GetDefaultChartText()),this._chartText.FormulaR1C1=t}}),a(i,"IncludeInLayout",{get:function(){return this._includeInLayout},set:function(t){this._includeInLayout=t}}),a(i,"Parent",{get:function(){return this._chart}}),a(i,"Text",{get:function(){return s(this._chartText)?c:this._chartText.Text},set:function(t){s(this._chartText)&&(this._chartText=this.GetDefaultChartText()),this._chartText.Text=t}}),a(i,"DefaultText",{get:function(){return c}}),a(i,"DefaultFontSize",{get:function(){return 0}}),a(i,"Worksheet",{get:function(){return this._chart.Parent.sheet()}}),i.GetTextList=function(t){for(var e=[],i=this.Worksheet._GetSheet(t.WorksheetName),n=t.Row;n<=t.LastRow;n++)for(var r=t.Column;r<=t.LastColumn;r++){var o=i._GetRange(n,r).Text;e.push(s(o)?"":o)}return e},i.GetDefaultChartText=function(){var t=new _(this._chart.Parent,this._chart.ChartArea.Font,c,c);return t.Font.Size=this.DefaultFontSize,t},i.CreateFormat=function(){var t=new u(this._chart);return t.Fill.Color.ColorType=0,t.Line.Color.ColorType=0,t},i.FromOOModel=function(e){if(this._ooTitle=e,e){if(s(e.tx))if(s(e.txPr))this._chartText=c;else{var i={};i.rich=e.txPr,this._chartText.FromOOModel(i)}else s(e.tx.strRef)||s(e.txPr)||(e.tx.rich=e.txPr),this._chartText.FromOOModel(e.tx);s(e.overlay)||(this._includeInLayout=!e.overlay),t.prototype.FromShapeProperties.call(this,e.spPr)}},i.ToOOModel=function(){var e=s(this._ooTitle)?{}:this._ooTitle;if(s(this._chartText))delete e.tx,delete e.txPr;else{var i=this._chartText.ToOOModel();e.tx={},s(this._chartText.TextRefer)?this._chartText.Text?(delete e.tx.strRef,e.tx.rich=i.rich):(delete e.tx,e.txPr=i.rich):(e.tx.strRef=i.strRef,e.txPr=i.rich)}return e.overlay=!this._includeInLayout,e.spPr=t.prototype.ToShapeProperties.call(this),e},e}(l);e.ChartTitleBase=d;var g=function(t){function e(e){return t.call(this,e)||this}n(e,t);var i=e.prototype;return a(i,"DefaultText",{get:function(){return"Chart Title"}}),a(i,"DefaultFontSize",{get:function(){return o.pointToPixel(14)}}),i.Delete=function(){this._chart.HasTitle=!1},i.ToOOModel=function(){var e=t.prototype.ToOOModel.call(this);if(s(e.tx)&&s(e.txPr)){var i=e.txPr={p:[]},n={elements:[],pPr:{}};n.pPr.defRPr={b:!1},i.p.push(n),s(i.bodyPr)&&(i.bodyPr={}),s(i.lstStyle)&&(i.lstStyle={})}return this.CorrectChartTitleOOModel(e),e},i.CorrectChartTitleOOModel=function(t){if(t){var e,i=t.txPr,n=t.tx,r=this.Font.Size;i&&i.p&&i.p.length>0&&i.p[0].pPr?(e=i.p[0].pPr.defRPr)&&(e.sz=r):n&&n.rich&&n.rich.p&&n.rich.p.length>0&&n.rich.p[0].pPr&&(e=n.rich.p[0].pPr.defRPr)&&(e.sz=r)}},e}(d);e.ChartTitle=g,t.exports=e}()},function(t,e,i){"use strict";!function(){var e=i(0),n=i(2)._ColorHelper,r=i(3).GC$.inherit,o=i(1),a=o.ChartUtility,s=a.defineProperty,l=o.UnitHelper.isNullOrUndefined,u=o.ShapeConstants,h=u.DefaultTransparent,c=u.PositionConver,p=i(12).ColorData,f=i(8).ARGBColor,_=i(4).StatefullBase,d=null,g=Math.abs,y=Math.floor;var m=function(t){function e(e,i){void 0===i&&(i=d);var n=t.call(this,i)||this;n._themeColor=-4142,n._rgbColor=d,n._tint=0,n._brightness=0,n._transparency=h,n._context=e,n._parent=i;var r=n._context.DrawingType;return 0===r?n._colorType=3:1===r?n._colorType=1:2===r&&(n._colorType=0),n}r(e,t);var i=e.prototype;function o(t){delete t.hslClr,delete t.prstClr,delete t.scrgbClr,delete t.srgbClr,delete t.sysClr}function u(t,e,i){e.length>0&&(t.lumMod=e),i.length>0&&(t.lumOff=i)}return s(i,"Brightness",{get:function(){return this.GetState(1)||l(this._parent)?this._brightness:this._parent.Brightness},set:function(t){if(t<-1||t>1)throw new Error;this._brightness=t,this.Dirty(1)}}),s(i,"ObjectThemeColor",{get:function(){return this.GetState(2)||l(this._parent)?this._themeColor:this._parent.ObjectThemeColor},set:function(t){this._themeColor=t,this.Dirty(2),this.ColorType=3,this._rgbColor=d,this.UnDirty(4),this._brightness=0,this.Dirty(1)}}),s(i,"RGB",{get:function(){return this.HasOwnColor()||l(this._parent)?this._context._ToARGBColor(this.GetColorData()):this._parent.RGB},set:function(t){this._rgbColor=t,this.Transparency=1-t.A/255,this.Dirty(4),this.ColorType=2,this._themeColor=-4142,this.Dirty(2),this._brightness=0,this._tint=0,this.Dirty(1),this.Dirty(8)}}),s(i,"TintAndShade",{get:function(){return this.GetState(8)||l(this._parent)?this._tint:this._parent.TintAndShade},set:function(t){this._tint=t,this.Dirty(8)}}),s(i,"Transparency",{get:function(){return this.GetState(32)||l(this._parent)?this._transparency:this._parent.Transparency},set:function(t){this._transparency=t,this.Dirty(32)}}),s(i,"ColorType",{get:function(){return this.GetState(16)||l(this._parent)?this._colorType:this._parent.ColorType},set:function(t){this._colorType=t,this.Dirty(16)}}),i.setColor=function(t,e){if(t&&function(t,e){return t.getColor(e)!==e}(t.currentTheme(),e)){var i=a.fromThemeColorString(e);i&&(this.ObjectThemeColor=i.index,void 0!==i.tint&&(this.TintAndShade=i.tint))}else{var r=n._fromString(e);this.RGB=f.FromArgbs(r.a,r.r,r.g,r.b)}},i.GetColorData=function(){var t=new p;t.ColorType=2;var e=this._colorType;if(0===e)t.ColorType=0;else if(1===e){t.ColorType=1;var i=this.GetAutoColorFormat();if(!l(i))return i.GetColorData()}else 2===e?l(this._rgbColor)||(t.ColorType=2,t.Value=this._rgbColor.ToArgb()):3===e&&(t.ColorType=4,t.Value=this._themeColor,t.Tint=this._tint||this._brightness);return t},i.HasOwnColor=function(){return this.GetState(2)||this.GetState(4)||this.GetAutoColorFormat()!==d},i.GetAutoColorFormat=function(){if(1===this.ColorType&&!l(this.AutoColorFormat)){var t=this.AutoColorFormat();if(!l(t)&&1!==t.ColorType)return t}return d},i.OnParentChanged=function(t){this._parent=t},i.ClearModel=function(){this._ooModel=d;for(var t=0,e=this.Children;t<e.length;t++){e[t].ClearModel()}},i.CalcBrightness=function(t,e){return t&&t.length>0&&e&&e.length>0?e[0]/c:t&&t.length>0?t[0]/c-1:0},i.CalcLumModeOff=function(t,e){this.Brightness>0?(t.push(y((1-this.Brightness)*c)),e.push(y(this.Brightness*c))):this.Brightness<0&&t.push(y((1+this.Brightness)*c))},i.FromCT_ColorProperties=function(t){if(this._ooModel=t,l(t))this.ColorType=0;else if(l(t.schemeClr))if(l(t.srgbClr)||l(t.srgbClr.val)||3!==t.srgbClr.val.length)if(l(t.scrgbClr))if(l(t.sysClr)){if(!l(t.prstClr)){var e=t.prstClr;this.RGB=f.FromArgb(a.GetPresetColorRGB(e.val)),this.Brightness=this.CalcBrightness(e.lumMod,e.lumOff),!l(e.alpha)&&e.alpha.length>0&&(this.Transparency=e.alpha[0]/c)}}else{var i=t.sysClr,n=i.val;l(n)?l(i.lastClr)||3!==i.lastClr.length||(this.RGB=f.FromRgb(i.lastClr[0],i.lastClr[1],i.lastClr[2])):this.RGB=f.FromKnownColor(n),this.Brightness=this.CalcBrightness(i.lumMod,i.lumOff),!l(i.alpha)&&i.alpha.length>0&&this.FromTransparency(i.alpha[0])}else{var r=t.scrgbClr;this.RGB=f.FromRgb(r.r,r.g,r.b)}else{var o=t.srgbClr;this.RGB=f.FromRgb(o.val[0],o.val[1],o.val[2]),this.Brightness=this.CalcBrightness(o.lumMod,o.lumOff),!l(o.alpha)&&o.alpha.length>0&&this.FromTransparency(o.alpha[0]),!l(o.tint)&&o.tint.length>0&&this.FromTint(o.tint[0])}else{var s=t.schemeClr;this.ObjectThemeColor=s.val,this.Brightness=this.CalcBrightness(s.lumMod,s.lumOff),!l(s.tint)&&s.tint.length>0&&this.FromTint(s.tint[0]),!l(s.alpha)&&s.alpha.length>0&&this.FromTransparency(s.alpha[0])}},i.ToCT_ColorProperties=function(t){var e=this._ooModel||t,i=[],n=[],r=e.schemeClr;if(r&&a.removeEmptyArrayProperties(r),3===this.ColorType)o(e),r||(r=e.schemeClr={}),r.val=this.ObjectThemeColor,this.CalcLumModeOff(i,n),u(r,i,n),this.TintAndShade>0?r.tint=[this.ToTint()]:this.TintAndShade<0&&(r.shade=[this.ToShade()]),this.Transparency!==h&&(r.alpha=[this.ToTransparency()]);else if(2===this.ColorType){o(e),delete e.schemeClr;var s=d;if(this._rgbColor&&this._rgbColor.IsKnownColor&&(s=this._rgbColor.ToKnownColor()),l(s)){var c=e.srgbClr={};c.val=[this.RGB.R,this.RGB.G,this.RGB.B],this.CalcLumModeOff(i,n),u(c,i,n),this.Transparency!==h&&(c.alpha=[this.ToTransparency()]),this.TintAndShade>0?c.tint=[this.ToTint()]:this.TintAndShade<0&&(c.shade=[this.ToShade()])}else{var p=e.sysClr={};p.val=s,p.lastClr=[this.RGB.R,this.RGB.G,this.RGB.B],this.CalcLumModeOff(i,n),u(p,i,n),this.Transparency!==h&&(p.alpha=[this.ToTransparency()])}}var f=t&&t.colorFillType;return l(f)||(e.colorFillType=f),e},i.FromTint=function(t){this.TintAndShade=1-t/c},i.FromShade=function(t){this.TintAndShade=t/c-1},i.ToTint=function(){return y(g((1-this.TintAndShade)*c))},i.ToShade=function(){return y(g((1+this.TintAndShade)*c))},i.FromTransparency=function(t){this.Transparency=1-t/c},i.ToTransparency=function(){return y((1-this.Transparency)*c)},i.Clone=function(){var t=new e(this._context);return t._brightness=this._brightness,t._colorType=this._colorType,t._context=this._context,t._rgbColor=this._rgbColor,t._themeColor=this._themeColor,t._tint=this._tint,t.AutoColorFormat=this.AutoColorFormat,t},i.FromOOModel=function(t){this.FromCT_ColorProperties(t)},i.ToOOModel=function(){var t=this.ColorType;return 1===t?{}:0===t?{colorFillType:5}:this.ToCT_ColorProperties({colorFillType:0})},i.Color_FromOOModel=function(t){this.FromCT_ColorProperties(t)},i.Color_ToOOModel=function(){return this.ToCT_ColorProperties({})},i.GradientStop_FromOOModel=function(t){this.FromCT_ColorProperties(t)},i.GradientStop_ToOOModel=function(){return this.ToCT_ColorProperties({})},i.ColorData_FromOOModel=function(t){2===t.ColorType||3===t.ColorType?this.RGB=f.FromArgb(t.Value):4===t.ColorType&&(this.ObjectThemeColor=t.Value,this.TintAndShade=t.Tint)},i.ColorData_ToOOModel=function(){var t=new p;return 2===this.ColorType?(t.Value=this.RGB.Value,t.ColorType=2):3===this.ColorType&&(t.Value=this.ObjectThemeColor,t.Tint=this.TintAndShade,t.ColorType=4),t},e}(_);e.ColorFormat=m,t.exports=e}()},function(t,e,i){"use strict";!function(){var e=i(0),n=i(2)._ColorHelper,r=i(1),o=r.ChartUtility.defineProperty,a=r.UnitHelper.isNullOrUndefined,s=function(){function t(t,e,i,n){this.value=t,this.state=e,this.name=i,this.knownColor=n}var i=t.prototype;o(i,"Transparent",{get:function(){return t.FromKnownColor(27)}}),t.FromKnownColor=function(e){return new t(0,t.StateKnownColorValid,null,e)},t.FromIndexedColor=function(e,i){var n=t.IndexedColors;return n||(n=t.IndexedColors=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,t.FromKnownColor(26).ToArgb(),t.FromKnownColor(24).ToArgb()]),t.FromArgb(n[e]).GetTintColor(i)},o(i,"R",{get:function(){return this.Value>>16&255}}),o(i,"G",{get:function(){return this.Value>>8&255}}),o(i,"B",{get:function(){return 255&this.Value}}),o(i,"A",{get:function(){return this.Value>>24&255}}),o(i,"IsKnownColor",{get:function(){return 0!=(this.state&t.StateKnownColorValid)}}),o(i,"IsEmpty",{get:function(){return 0===this.state}}),o(i,"IsNamedColor",{get:function(){return 0!=(this.state&t.StateNameValid)||this.IsKnownColor}}),o(i,"IsSystemColor",{get:function(){return!!this.IsKnownColor&&(!(this.knownColor>26)||this.knownColor>167)}}),o(i,"Name",{get:function(){if(0!=(this.state&t.StateNameValid))return this.name;if(!this.IsKnownColor)return this.value.toString(16);var i=e.KnownColorTable.KnownColorToName(this.knownColor);return a(i)?"":i}}),o(i,"Value",{get:function(){return 0!=(this.state&t.StateValueMask)?this.value:this.IsKnownColor?e.KnownColorTable.KnownColorToArgb(this.knownColor):t.NotDefinedValue}}),t.FromArgb=function(e){return new t(e,t.StateARGBValueValid,null,0)},t.FromArgbs=function(e,i,n,r){return t.CheckByte(e,"alpha"),t.CheckByte(i,"red"),t.CheckByte(n,"green"),t.CheckByte(r,"blue"),new t(t.MakeArgb(e,i,n,r),t.StateARGBValueValid,null,0)},t.FromBaseColor=function(e,i){return t.CheckByte(e,"alpha"),new t(t.MakeArgb(e,i.R,i.G,i.B),t.StateARGBValueValid,null,0)},t.FromRgb=function(e,i,n){return t.FromArgbs(255,e,i,n)},i.GetBrightness=function(){var t=this.R/255,e=this.G/255,i=this.B/255,n=t,r=t;return e>n&&(n=e),i>n&&(n=i),e<r&&(r=e),i<r&&(r=i),(n+r)/2},i.GetHue=function(){if(this.R===this.G&&this.G===this.B)return 0;var t=this.R/255,e=this.G/255,i=this.B/255,n=0,r=t,o=t;e>r&&(r=e),i>r&&(r=i),e<o&&(o=e),i<o&&(o=i);var a=r-o;return t===r?n=(e-i)/a:e===r?n=2+(i-t)/a:i===r&&(n=4+(t-e)/a),(n*=60)<0&&(n+=360),n},i.GetSaturation=function(){var t=this.R/255,e=this.G/255,i=this.B/255,n=t,r=t;return e>n&&(n=e),i>n&&(n=i),e<r&&(r=e),i<r&&(r=i),n===r?0:(n+r)/2<=.5?(n-r)/(n+r):(n-r)/(2-n-r)},i.ToArgb=function(){return this.Value},i.ToKnownColor=function(){return this.knownColor},i.ToString=function(){var e="ARGBColor";return e+=" [",0!=(this.state&t.StateNameValid)?e+=this.Name:0!=(this.state&t.StateKnownColorValid)?e+=this.Name:0!=(this.state&t.StateValueMask)?(e+="A=",e+=this.A,e+=", R=",e+=this.R,e+=", G=",e+=this.G,e+=", B=",e+=this.B):e+="Empty",e+="]"},i.Equals=function(e){if(e instanceof t){var i=e;return this.Value===i.Value}return!1},t.CheckByte=function(t,e){if(t<0||t>255)throw new Error("InvalidEx2BoundArgument")};var r=Math.pow(2,24);return t.MakeArgb=function(t,e,i,n){return r*t+(e<<16|i<<8|n)},i.GetTintColor=function(t){if(0===t)return this;var i=n._applyTint({r:this.R,g:this.G,b:this.B},t);return e.ARGBColor.FromArgbs(i.a,i.r,i.g,i.b)},t}();s.StateKnownColorValid=1,s.StateARGBValueValid=2,s.StateValueMask=2,s.StateNameValid=8,s.NotDefinedValue=0,e.ARGBColor=s;var l=e.KnownColor={ActiveBorder:1,ActiveCaption:2,ActiveCaptionText:3,AliceBlue:28,AntiqueWhite:29,AppWorkspace:4,Aqua:30,Aquamarine:31,Azure:32,Beige:33,Bisque:34,Black:35,BlanchedAlmond:36,Blue:37,BlueViolet:38,Brown:39,BurlyWood:40,ButtonFace:168,ButtonHighlight:169,ButtonShadow:170,CadetBlue:41,Chartreuse:42,Chocolate:43,Control:5,ControlDark:6,ControlDarkDark:7,ControlLight:8,ControlLightLight:9,ControlText:10,Coral:44,CornflowerBlue:45,Cornsilk:46,Crimson:47,Cyan:48,DarkBlue:49,DarkCyan:50,DarkGoldenrod:51,DarkGray:52,DarkGreen:53,DarkKhaki:54,DarkMagenta:55,DarkOliveGreen:56,DarkOrange:57,DarkOrchid:58,DarkRed:59,DarkSalmon:60,DarkSeaGreen:61,DarkSlateBlue:62,DarkSlateGray:63,DarkTurquoise:64,DarkViolet:65,DeepPink:66,DeepSkyBlue:67,Desktop:11,DimGray:68,DodgerBlue:69,Firebrick:70,FloralWhite:71,ForestGreen:72,Fuchsia:73,Gainsboro:74,GhostWhite:75,Gold:76,Goldenrod:77,GradientActiveCaption:171,GradientInactiveCaption:172,Gray:78,GrayText:12,Green:79,GreenYellow:80,Highlight:13,HighlightText:14,Honeydew:81,HotPink:82,HotTrack:15,InactiveBorder:16,InactiveCaption:17,InactiveCaptionText:18,IndianRed:83,Indigo:84,Info:19,InfoText:20,Ivory:85,Khaki:86,Lavender:87,LavenderBlush:88,LawnGreen:89,LemonChiffon:90,LightBlue:91,LightCoral:92,LightCyan:93,LightGoldenrodYellow:94,LightGray:95,LightGreen:96,LightPink:97,LightSalmon:98,LightSeaGreen:99,LightSkyBlue:100,LightSlateGray:101,LightSteelBlue:102,LightYellow:103,Lime:104,LimeGreen:105,Linen:106,Magenta:107,Maroon:108,MediumAquamarine:109,MediumBlue:110,MediumOrchid:111,MediumPurple:112,MediumSeaGreen:113,MediumSlateBlue:114,MediumSpringGreen:115,MediumTurquoise:116,MediumVioletRed:117,Menu:21,MenuBar:173,MenuHighlight:174,MenuText:22,MidnightBlue:118,MintCream:119,MistyRose:120,Moccasin:121,NavajoWhite:122,Navy:123,OldLace:124,Olive:125,OliveDrab:126,Orange:127,OrangeRed:128,Orchid:129,PaleGoldenrod:130,PaleGreen:131,PaleTurquoise:132,PaleVioletRed:133,PapayaWhip:134,PeachPuff:135,Peru:136,Pink:137,Plum:138,PowderBlue:139,Purple:140,Red:141,RosyBrown:142,RoyalBlue:143,SaddleBrown:144,Salmon:145,SandyBrown:146,ScrollBar:23,SeaGreen:147,SeaShell:148,Sienna:149,Silver:150,SkyBlue:151,SlateBlue:152,SlateGray:153,Snow:154,SpringGreen:155,SteelBlue:156,Tan:157,Teal:158,Thistle:159,Tomato:160,Transparent:27,Turquoise:161,Violet:162,Wheat:163,White:164,WhiteSmoke:165,Window:24,WindowFrame:25,WindowText:26,Yellow:166,YellowGreen:167},u=function(){function t(){}return t.ArgbToKnownColor=function(e){this.EnsureColorTable();for(var i=0;i<t.colorTable.length;i++){if(this.colorTable[i]===e){var n=s.FromArgb(i);if(!n.IsSystemColor)return n}}return s.FromArgb(e)},t.Encode=function(t,e,i,n){return e<<16|i<<8|n|t<<24},t.EnsureColorNameTable=function(){a(t.colorNameTable)&&t.InitColorNameTable()},t.EnsureColorTable=function(){a(this.colorTable)&&this.InitColorTable()},t.InitColorNameTable=function(){var e=[];for(var i in l)e[l[i]]=i;t.colorNameTable=e},t.InitColorTable=function(){var e=[];!function(t){t[1]=4290032820,t[2]=4288263377,t[3]=4278190080,t[4]=4289440683,t[5]=4293980400,t[6]=4288716960,t[7]=4285098345,t[8]=4293125091,t[9]=4294967295,t[10]=4278190080,t[11]=4278190080,t[12]=4285361517,t[13]=4281571839,t[14]=4294967295,t[15]=4278216396,t[16]=4294244348,t[17]=4290760155,t[18]=4278190080,t[19]=4294967265,t[20]=4278190080,t[21]=4293980400,t[22]=4278190080,t[23]=4291348680,t[24]=4294967295,t[25]=4284769380,t[26]=4278190080,t[168]=4293980400,t[169]=4294967295,t[170]=4288716960,t[171]=4290367978,t[172]=4292338930,t[173]=4293980400,t[174]=4281571839}(e),e[27]=16777215,e[28]=-984833,e[29]=-332841,e[30]=-16711681,e[31]=-8388652,e[32]=-983041,e[33]=-657956,e[34]=-6972,e[35]=-16777216,e[36]=-5171,e[37]=-16776961,e[38]=-7722014,e[39]=-5952982,e[40]=-2180985,e[41]=-10510688,e[42]=-8388864,e[43]=-2987746,e[44]=-32944,e[45]=-10185235,e[46]=-1828,e[47]=-2354116,e[48]=-16711681,e[49]=-16777077,e[50]=-16741493,e[51]=-4684277,e[52]=-5658199,e[53]=-16751616,e[54]=-4343957,e[55]=-7667573,e[56]=-11179217,e[57]=-29696,e[58]=-6737204,e[59]=-7667712,e[60]=-1468806,e[61]=-7357301,e[62]=-12042869,e[63]=-13676721,e[64]=-16724271,e[65]=-7077677,e[66]=-60269,e[67]=-16728065,e[68]=-9868951,e[69]=-14774017,e[70]=-5103070,e[71]=-1296,e[72]=-14513374,e[73]=-65281,e[74]=-2302756,e[75]=-460545,e[76]=-10496,e[77]=-2448096,e[78]=-8355712,e[79]=-16744448,e[80]=-5374161,e[81]=-983056,e[82]=-38476,e[83]=-3318692,e[84]=-11861886,e[85]=-16,e[86]=-989556,e[87]=-1644806,e[88]=-3851,e[89]=-8586240,e[90]=-1331,e[91]=-5383962,e[92]=-1015680,e[93]=-2031617,e[94]=-329006,e[95]=-2894893,e[96]=-7278960,e[97]=-18751,e[98]=-24454,e[99]=-14634326,e[100]=-7876870,e[101]=-8943463,e[102]=-5192482,e[103]=-32,e[104]=-16711936,e[105]=-13447886,e[106]=-331546,e[107]=-65281,e[108]=-8388608,e[109]=-10039894,e[110]=-16777011,e[111]=-4565549,e[112]=-7114533,e[113]=-12799119,e[114]=-8689426,e[115]=-16713062,e[116]=-12004916,e[117]=-3730043,e[118]=-15132304,e[119]=-655366,e[120]=-6943,e[121]=-6987,e[122]=-8531,e[123]=-16777088,e[124]=-133658,e[125]=-8355840,e[126]=-9728477,e[127]=-23296,e[128]=-47872,e[129]=-2461482,e[130]=-1120086,e[131]=-6751336,e[132]=-5247250,e[133]=-2396013,e[134]=-4139,e[135]=-9543,e[136]=-3308225,e[137]=-16181,e[138]=-2252579,e[139]=-5185306,e[140]=-8388480,e[141]=-65536,e[142]=-4419697,e[143]=-12490271,e[144]=-7650029,e[145]=-360334,e[146]=-744352,e[147]=-13726889,e[148]=-2578,e[149]=-6270419,e[150]=-4144960,e[151]=-7876885,e[152]=-9807155,e[153]=-9404272,e[154]=-1286,e[155]=-16711809,e[156]=-12156236,e[157]=-2968436,e[158]=-16744320,e[159]=-2572328,e[160]=-40121,e[161]=-12525360,e[162]=-1146130,e[163]=-663885,e[164]=-1,e[165]=-657931,e[166]=-256,e[167]=-6632142,t.colorTable=e},t.KnownColorToArgb=function(t){return this.EnsureColorTable(),t<=174?this.colorTable[t]:0},t.KnownColorToName=function(e){return this.EnsureColorNameTable(),e<=174?t.colorNameTable[e]:null},t.IsKnowColor=function(e){return t.EnsureColorTable(),-1!==t.colorTable.indexOf(e)},t}();e.KnownColorTable=u,t.exports=e}()},function(e,i,n){"use strict";var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=n(14).sR,s=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(t){t.__Constant_Core_Control_ClassName="gcdv-flexdv",t.__Constant_Core_Header_ClassName="gcdv-header",t.__Constant_Core_Footer_ClassName="gcdv-footer",t.__Constant_Core_Plot_Area_ClassName="gcdv-plotarea",t.__Constant_Core_Plot_ClassName="gcdv-plot",t.__Constant_Core_Legend_ClassName="gcdv-legend",t.__Constant_Core_Axis_X_ClassName="gcdv-axis-x",t.__Constant_Core_Axis_Y_ClassName="gcdv-axis-y",t.__Constant_Core_Label_ClassName="gcdv-label",t.__Constant_Core_Title_ClassName="gcdv-title",t.__Constant_Core_Tick_Major_ClassName="gcdv-tick-major",t.__Constant_Core_Tick_Minor_ClassName="gcdv-tick-minor",t.__Constant_Core_Grid_Line_Major_ClassName="gcdv-gridline-major",t.__Constant_Core_Grid_Line_Minor_ClassName="gcdv-gridline-minor",t.__Constant_Core_Line_ClassName="gcdv-line",t.__Constant_Core_Tooltip_Threshold=15,t.__Constant_Core_Default_Border_Stroke="#666",t.__Constant_Core_Default_Date_Formats=["r"],t.__Constant_Core_Bar_Lines_Color="black",t.__Constant_Core_Color_Field_VALUESNAME="VALUESNAME"}(r||(r={})),function(t){var e=function(){function e(i,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var o=this;this._focus=!1,this._updating=0,this._fullUpdate=!1,this.gotFocus=new t.core.Event,this.lostFocus=new t.core.Event,t.core.assert(null==e.getControl(i),"Element is already hosting a control.");var a=t.core.getElement(i);if(t.core.assert(null!=a,"Cannot find the host element."),this._orgOuter=a.outerHTML,this._orgInner=a.innerHTML,this._orgTag=a.tagName,"INPUT"!=a.tagName&&"SELECT"!=a.tagName||(a=this._replaceWithDiv(a)),this._e=a,a[e._DATA_KEY]=this,1==r){this._szCtl=new t.core.Size(a.offsetWidth,a.offsetHeight);var s=this._handleResize.bind(this);this.addEventListener(window,"resize",s)}this.addEventListener(a,"focus",function(){setTimeout(function(){o._updateFocusState()})},!0),this.addEventListener(a,"blur",function(){setTimeout(function(){o._updateFocusState()},20)},!0);var l=this._handleDisabled.bind(this);if(this.addEventListener(a,"mousedown",l,!0),this.addEventListener(a,"mouseup",l,!0),this.addEventListener(a,"click",l,!0),this.addEventListener(a,"dblclick",l,!0),this.addEventListener(a,"keydown",l,!0),this.addEventListener(a,"wheel",l,!0),null==e._touching&&(e._touching=!1,"ontouchstart"in window||"onpointerdown"in window)){var u=document.body,h=this._handleTouchStart,c=this._handleTouchEnd;"ontouchstart"in window?(u.addEventListener("touchstart",h),u.addEventListener("touchend",c),u.addEventListener("touchcancel",c),u.addEventListener("touchleave",c)):"onpointerdown"in window&&(u.addEventListener("pointerdown",h),u.addEventListener("pointerup",c),u.addEventListener("pointerout",c),u.addEventListener("pointercancel",c),u.addEventListener("pointerleave",c))}}return e.prototype.getTemplate=function(){for(var t=Object.getPrototypeOf(this);t;t=Object.getPrototypeOf(t)){var e=t.constructor.controlTemplate;if(e)return e}return null},e.prototype.applyTemplate=function(e,i,n,r){var o=this._e;e&&t.core.addClass(o,e);var a=null;i&&(a=t.core.createElement(i,o));var s=o.querySelectorAll("input"),l=1==s.length?s[0]:null,u=o.attributes;if(l&&u)for(var h=0;h<u.length;h++)u[h].name.match(/name|autofocus|autocomplete|minlength|maxlength|pattern/i)&&l.setAttribute(u[h].name,u[h].value);if(l&&o.id){var c=document.querySelector('label[for="'+o.id+'"]'),p=o.id+"_input",f=p;if(c instanceof HTMLLabelElement){for(h=0;null!=document.getElementById(f);h++)f=p+h;l.id=f,c.htmlFor=f}}if(l){var _=document.createEvent("HTMLEvents"),d=l.value;_.initEvent("change",!0,!1),this.addEventListener(l,"input",function(){d=l.value},!0),this.gotFocus.addHandler(function(){d=l.value}),this.lostFocus.addHandler(function(){d!=l.value&&l.dispatchEvent(_)})}if(o.getAttribute("tabindex")||(o.tabIndex=null!=l?-1:0),this._updateState(),n){var g=n;for(var y in g){var m=g[y];if(this[y]=a.querySelector('[wj-part="'+m+'"]'),null==this[y]&&a.getAttribute("wj-part")==m&&(this[y]=a),null==this[y])throw'Missing template part: "'+m+'"';if(m==r){var v=o.attributes,b="name",S=v[b];S&&S.value&&this[y].setAttribute(b,S.value),(S=v[b="accesskey"])&&S.value&&(this[y].setAttribute(b,S.value),o.removeAttribute(b))}}}return a},e.prototype.dispose=function(){for(var i=this._e.querySelectorAll(".wj-control"),n=0;n<i.length;n++){var r=e.getControl(i[n]);r&&r.dispose()}this._toInv&&clearTimeout(this._toInv),this.removeEventListener();for(var o in this){if(o.length>2&&0==o.indexOf("on"))(l=this[o[2].toLowerCase()+o.substr(3)])instanceof t.core.Event&&l.removeAllHandlers()}var a=this.collectionView;if(a instanceof t.core.collections.CollectionView){var s=a;for(var o in s){var l;(l=s[o])instanceof t.core.Event&&l.removeHandler(null,this)}}this._e.parentNode&&(this._e.outerHTML=this._orgOuter),this._e[e._DATA_KEY]=null,this._e=this._orgOuter=this._orgInner=this._orgTag=null},e.getControl=function(i){var n=t.core.getElement(i);return n?t.core.asType(n[e._DATA_KEY],e,!0):null},Object.defineProperty(e.prototype,"hostElement",{get:function(){return this._e},enumerable:!0,configurable:!0}),e.prototype.focus=function(){this._e&&this._e.focus()},e.prototype.containsFocus=function(){if(!this._e)return!1;for(var i=this._e.querySelectorAll(".wj-control"),n=0;n<i.length;n++){var r=e.getControl(i[n]);if(r&&r!=this&&r.containsFocus())return!0}var o=t.core.getActiveElement(),a=e.getControl(t.core.closest(o,".wj-control.wj-popup"));return!!(a&&a.owner&&t.core.contains(this._e,a.owner))||t.core.contains(this._e,o)},e.prototype.refreshDelay=function(t){var i=this;void 0===t&&(t=!0),this._fullUpdate=this._fullUpdate||t,this._toInv&&(clearTimeout(this._toInv),this._toInv=null),this.isUpdating||(this._toInv=window.setTimeout(function(){i.refresh(i._fullUpdate)},e._REFRESH_INTERVAL))},e.prototype.refresh=function(t){void 0===t&&(t=!0),!this.isUpdating&&this._toInv&&(clearTimeout(this._toInv),this._toInv=null,this._fullUpdate=!1)},e.invalidateAll=function(t){if(t||(t=document.body),t.children)for(var i=0;i<t.children.length;i++)e.invalidateAll(t.children[i]);var n=e.getControl(t);n&&n.refreshDelay()},e.refreshAll=function(t){if(t||(t=document.body),t.children)for(var i=0;i<t.children.length;i++)e.refreshAll(t.children[i]);var n=e.getControl(t);n&&n.refresh()},e.disposeAll=function(t){var i=e.getControl(t);if(i)i.dispose();else if(t.children)for(var n=0;n<t.children.length;n++)e.disposeAll(t.children[n])},e.prototype.beginUpdate=function(){this._updating++},e.prototype.endUpdate=function(){this._updating--,this._updating<=0&&this.refreshDelay()},Object.defineProperty(e.prototype,"isUpdating",{get:function(){return this._updating>0},enumerable:!0,configurable:!0}),e.prototype.deferUpdate=function(t){try{this.beginUpdate(),t()}finally{this.endUpdate()}},Object.defineProperty(e.prototype,"isTouching",{get:function(){return e._touching},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDisabled",{get:function(){return this._e&&null!=this._e.getAttribute("disabled")},set:function(e){(e=t.core.asBoolean(e,!0))!=this.isDisabled&&t.core.enable(this._e,!e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function(){return t.core._deprecated("disabled","isDisabled"),this.isDisabled},set:function(e){t.core._deprecated("disabled","isDisabled"),this.isDisabled=e},enumerable:!0,configurable:!0}),e.prototype.initialize=function(e){e&&(this.beginUpdate(),t.core.copy(this,e),this.endUpdate())},e.prototype.addEventListener=function(t,e,i,n){void 0===n&&(n=!1),t&&(t.addEventListener(e,i,n),null==this._listeners&&(this._listeners=[]),this._listeners.push({target:t,type:e,fn:i,capture:n}))},e.prototype.removeEventListener=function(t,e,i,n){var r=0;if(this._listeners)for(var o=0;o<this._listeners.length;o++){var a=this._listeners[o];null!=t&&t!=a.target||null!=e&&e!=a.type||null!=i&&i!=a.fn||null!=n&&n!=a.capture||(a.target.removeEventListener(a.type,a.fn,a.capture),this._listeners.splice(o,1),o--,r++)}return r},e.prototype.onGotFocus=function(t){this.gotFocus.raise(this,t)},e.prototype.onLostFocus=function(t){this.lostFocus.raise(this,t)},e.prototype._handleResize=function(){if(this._e.parentElement){var e=new t.core.Size(this._e.offsetWidth,this._e.offsetHeight);e.equals(this._szCtl)||(this._szCtl=e,this.refreshDelay())}},e.prototype._updateFocusState=function(){var t=this;setTimeout(function(){for(var i=t._e;i;i=i.parentElement){var n=e.getControl(i);if(n){var r=n.containsFocus();r!=n._focus&&(n._focus=r,r?n.onGotFocus():n.onLostFocus(),n._updateState())}}})},e.prototype._updateState=function(){var e=this.hostElement;if(e){t.core.toggleClass(e,"wj-state-focused",this.containsFocus());var i=e.querySelector("input");if(i instanceof HTMLInputElement){t.core.toggleClass(e,"wj-state-empty",0==i.value.length),t.core.toggleClass(e,"wj-state-readonly",i.readOnly);var n=i.validationMessage;t.core.toggleClass(e,"wj-state-invalid",n&&n.length>0)}}},e.prototype._handleTouchStart=function(t){null!=t.pointerType&&"touch"!=t.pointerType||(e._touching=!0)},e.prototype._handleTouchEnd=function(t){null!=t.pointerType&&"touch"!=t.pointerType||setTimeout(function(){e._touching=!1},400)},e.prototype._handleDisabled=function(t){this.isDisabled&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation())},e.prototype._replaceWithDiv=function(t){var e=document.createElement("div");t.parentElement.replaceChild(e,t),e.innerHTML=t.innerHTML;for(var i=t.attributes,n=0;n<i.length;n++){var r=i[n].name;i[n].name.match(/id|style|class/i)&&e.setAttribute(r,i[n].value)}return e},e._DATA_KEY="gcdv-Control",e._REFRESH_INTERVAL=10,e}();t.Control=e}(r||(r={})),function(t){!function(e){var i=function(){function i(t,e){this.__fields={},this.__items=t,this.__option=e,this.__fields=this._analyseItems(this._items())}return i.prototype._fields=function(){return this.__fields},i.prototype._items=function(){return this.__items},i.prototype._dateParser=function(){if(null==this.__dateParser){var e=[],i=this.__option.dateFormats;e="boolean"==typeof i?i?t.__Constant_Core_Default_Date_Formats:[]:i,this.__dateParser=new t.models._DateStringParser(e)}return this.__dateParser},i.prototype._analyseItems=function(i){for(var n={},r=0,o=i;r<o.length;r++){var a=o[r];for(var s in a){var l=n[s];void 0===l&&(n[s]=l=new e._NullFieldInfo(s));var u=a[s];if(void 0===l._type&&(t.core.isNumber(u)?n[s]=l=new e._NumberFieldInfo(s):t.core.isString(u)?null==this._dateParser()._parseDate(u)?n[s]=l=new e._StringFieldInfo(s):n[s]=l=new e._DateFieldInfo(s,[],this._dateParser()):t.core.isDate(u)?n[s]=l=new e._DateFieldInfo(s,[],this._dateParser()):t.core.isBoolean(u)&&(n[s]=l=new e._BooleanFieldInfo(s))),l instanceof e._NumberFieldInfo){var h=t.core.asNumber(u,!0);null!==h&&isFinite(h)&&((void 0===l._minimum()||l._minimum()>h)&&l._minimum(h),(void 0===l._maximum()||l._maximum()<h)&&l._maximum(h),-1==l._values.indexOf(h)&&l._values.push(h))}else if(l instanceof e._DateFieldInfo){var c=null;null!=u&&null!==(c=t.core.isDate(u)?t.core.asDate(u,!0):this._dateParser()._parseDate(u.toString()))&&((void 0===l._minimum()||l._minimum()>c.valueOf())&&l._minimum(c.valueOf()),(void 0===l._maximum()||l._maximum()<c.valueOf())&&l._maximum(c.valueOf()),-1==l._values.indexOf(c.valueOf())&&l._values.push(c.valueOf()))}else if(l instanceof e._StringFieldInfo){var p=t.core.asString(u,!0);null!==p&&-1==l._values.indexOf(p)&&l._values.push(p)}else if(l instanceof e._BooleanFieldInfo){var f=t.core.asBoolean(u,!0);null!==f&&-1==l._values.indexOf(f)&&l._values.push(f)}}}return n},i}();e._DataSource=i}(t.data||(t.data={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(t,e){this._name=t,this._type=e}return t.prototype._equals=function(t){return t._type==this._type&&this._name==t._name},t}();t._FieldInfo=e}(t.data||(t.data={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(i,n){void 0===n&&(n=[]);var r=e.call(this,i,t.core.DataType.Boolean)||this;return r._values=n,r}return s(i,e),i.prototype._minimum=function(e){if(void 0===e)return 0;t._assertDebug(function(){return!0})},i.prototype._maximum=function(e){if(void 0===e)return this._values?this._values.length-1:0;t._assertDebug(function(){return!0})},i.prototype._toItem=function(e){if(null==e)return null;if(!Array.isArray(e))return t.core.asBoolean(e[this._name],!0);for(var i=0,n=e;i<n.length;i++){var r=n[i],o=t.core.asBoolean(r[this._name],!0);if(null!=o)return o}},i.prototype._toValue=function(t){var e=this._toItem(t);return null==e?null:this._values.indexOf(e)},i}(e._FieldInfo);e._BooleanFieldInfo=i}(t.data||(t.data={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(i,n,r){void 0===n&&(n=[]);var o=e.call(this,i,t.core.DataType.Date)||this;return o.__dateParser=r,o._values=n,o}return s(i,e),i.prototype._minimum=function(t){if(void 0===t)return this.__minimum;this.__minimum=t},i.prototype._maximum=function(t){if(void 0===t)return this.__maximum;this.__maximum=t},i.prototype._dateParser=function(){return this.__dateParser},i.prototype._parse=function(t){return"string"==typeof t?this._dateParser()._parseDate(t):t instanceof Date?t:null},i.prototype._toItem=function(t){if(null==t)return null;if(!Array.isArray(t))return this.__dateParser._parseDate(t[this._name]);for(var e=0,i=t;e<i.length;e++){var n=i[e],r=this._parse(n[this._name]);if(null!=r)return r}},i.prototype._toValue=function(t){var e=this._toItem(t);return null==e?null:e.valueOf()},i}(e._FieldInfo);e._DateFieldInfo=i}(t.data||(t.data={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){return e.call(this,t,void 0)||this}return s(i,e),i.prototype._minimum=function(e){return t._assertDebug(function(){return!0}),NaN},i.prototype._maximum=function(e){return t._assertDebug(function(){return!0}),NaN},i.prototype._toItem=function(t){return null},i.prototype._toValue=function(t){return null},i}(e._FieldInfo);e._NullFieldInfo=i}(t.data||(t.data={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(i,n){void 0===n&&(n=[]);var r=e.call(this,i,t.core.DataType.Number)||this;return r._values=n,r}return s(i,e),i.prototype._minimum=function(t){if(void 0===t)return this.__minimum;this.__minimum=t},i.prototype._maximum=function(t){if(void 0===t)return this.__maximum;this.__maximum=t},i.prototype._toItem=function(e){if(null==e)return null;if(!Array.isArray(e))return t.core.asNumber(e[this._name],!0);for(var i=0,n=e;i<n.length;i++){var r=n[i],o=t.core.asNumber(r[this._name],!0);if(null!=o)return o}},i.prototype._toValue=function(t){return this._toItem(t)},i}(e._FieldInfo);e._NumberFieldInfo=i}(t.data||(t.data={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(i,n){void 0===n&&(n=[]);var r=e.call(this,i,t.core.DataType.String)||this;return r._values=n,r}return s(i,e),i.prototype._minimum=function(e){if(void 0===e)return 0;t._assertDebug(function(){return!0})},i.prototype._maximum=function(e){if(void 0===e)return this._values?this._values.length-1:0;t._assertDebug(function(){return!0})},i.prototype._toItem=function(e){if(null==e)return null;if(!Array.isArray(e))return t.core.asString(e[this._name],!0);for(var i=0,n=e;i<n.length;i++){var r=n[i],o=t.core.asString(r[this._name],!0);if(null!=o)return o}},i.prototype._toValue=function(t){var e=this._toItem(t);return null==e?null:this._values.indexOf(e)},i}(e._FieldInfo);e._StringFieldInfo=i}(t.data||(t.data={}))}(r||(r={})),function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(t._FieldInfo);t._DetailFieldInfo=e}(t.data||(t.data={}))}(r||(r={})),function(t){!function(t){var e=function(t){function e(e,i,n,r){void 0===i&&(i=[]);var o=t.call(this,e,i)||this;return o._group=n,o._excludeNulls=r,o}return s(e,t),e}(t._BooleanFieldInfo);t._BooleanDetailFieldInfo=e}(t.data||(t.data={}))}(r||(r={})),function(t){!function(t){var e=function(t){function e(e,i,n,r,o){void 0===i&&(i=[]);var a=t.call(this,e,i,n)||this;return a._group=r,a._excludeNulls=o,a}return s(e,t),e}(t._DateFieldInfo);t._DateDetailFieldInfo=e}(t.data||(t.data={}))}(r||(r={})),function(t){!function(t){var e=function(t){function e(e,i,n,r){void 0===i&&(i=[]);var o=t.call(this,e,i)||this;return o._group=n,o._excludeNulls=r,o}return s(e,t),e}(t._NumberFieldInfo);t._NumberDetailFieldInfo=e}(t.data||(t.data={}))}(r||(r={})),function(t){!function(t){var e=function(t){function e(e,i,n,r){void 0===i&&(i=[]);var o=t.call(this,e,i)||this;return o._group=n,o._excludeNulls=r,o}return s(e,t),e}(t._StringFieldInfo);t._StringDetailFieldInfo=e}(t.data||(t.data={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(t,e){this._lowerField=t,this._upperField=e}return Object.defineProperty(t.prototype,"name",{get:function(){return""},enumerable:!0,configurable:!0}),t.prototype.toItem=function(t){for(var e=null,i=null,n=0,r=t;n<r.length;n++){var o=r[n],a=this._lowerField._parse(o[this._lowerField._name]);null!=a&&(null==i||i.valueOf()>a.valueOf())&&(i=a);var s=this._upperField._parse(o[this._upperField._name]);null!=s&&(null==e||e.valueOf()<s.valueOf())&&(e=s)}return{upper:e,lower:i}},t.prototype.toValue=function(t){var e=this.toItem(t);return e.upper.valueOf()-e.lower.valueOf()},t.prototype.equals=function(e){return e instanceof t&&(this._lowerField==e._lowerField&&this._upperField==e._upperField)},t}();t._DateRangeValueDefinition=e}(t.data||(t.data={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(t,e){this._lowerField=t,this._upperField=e,this.__name=t._name+" - "+e._name}return Object.defineProperty(e.prototype,"name",{get:function(){return this.__name},enumerable:!0,configurable:!0}),e.prototype.toItem=function(e){var i=new t.core.collections.CollectionView(e),n=i.getAggregate(t.Aggregate.Min,this._lowerField._name);return{upper:i.getAggregate(t.Aggregate.Max,this._upperField._name),lower:n}},e.prototype.toValue=function(e){var i=new t.core.collections.CollectionView(e),n=i.getAggregate(t.Aggregate.Min,this._lowerField._name);return i.getAggregate(t.Aggregate.Max,this._upperField._name)-n},e.prototype.equals=function(t){return t instanceof e&&(this._lowerField==t._lowerField&&this._upperField==t._upperField)},e}();e._NumberRangeValueDefinition=i}(t.data||(t.data={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(e,i){void 0===i&&(i=t.Aggregate.Sum),this._field=e,this._aggregate=i}return Object.defineProperty(e.prototype,"name",{get:function(){return this._field._name},enumerable:!0,configurable:!0}),e.prototype.toItem=function(e){return this._aggregate!=t.Aggregate.List?this._aggregateItems(e):this._field._toItem(e)},e.prototype.toValue=function(e){return this._aggregate!=t.Aggregate.List?this._aggregateItems(e):this._field._toValue(e)},e.prototype.equals=function(t){return t instanceof e&&(this._field==t._field&&this._aggregate==t._aggregate)},e.prototype._aggregateItems=function(e){return new t.core.collections.CollectionView(e).getAggregate(this._aggregate,this.name)},e}();e._SingleAggregateValueDefinition=i}(t.data||(t.data={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(t){this._field=t}return Object.defineProperty(t.prototype,"name",{get:function(){return this._field._name},enumerable:!0,configurable:!0}),t.prototype.toItem=function(t){return this._field._toItem(t)},t.prototype.toValue=function(t){return this._field._toValue(t)},t.prototype.equals=function(e){return e instanceof t&&this._field==e._field},t}();t._SingleValueDefinition=e}(t.data||(t.data={}))}(r||(r={})),function(t){t.data||(t.data={})}(r||(r={})),function(t){var e=null;t._isCalculationEngineExist=function(){if(null==e){var t=window.GC;if(null==t)return!1;if(null==(t=t.Spread))return!1;if(null==(t=t.CalcEngine))return!1;e=!0}return e}}(r||(r={})),function(t){var e;!function(t){t[t.List=0]="List",t[t.Sum=1]="Sum",t[t.Count=2]="Count",t[t.Average=3]="Average",t[t.Max=4]="Max",t[t.Min=5]="Min",t[t.Range=6]="Range",t[t.StandardDeviation=7]="StandardDeviation",t[t.Variance=8]="Variance",t[t.PopulationStandardDeviation=9]="PopulationStandardDeviation",t[t.PopulationVariance=10]="PopulationVariance",t[t.CountOfAll=11]="CountOfAll"}(e=t.Aggregate||(t.Aggregate={})),t._getAggregate=function(i,n,r){var o=0,a=0,s=0,l=0,u=null,h=null,c=r?new t.core.Binding(r):null;if((i=t.core.asEnum(i,t.Aggregate))==t.Aggregate.CountOfAll)return n.length;for(var p=0;p<n.length;p++){var f=n[p];c&&(f=c.getValue(f)),null!=f&&(o++,(null==u||f<u)&&(u=f),(null==h||f>h)&&(h=f),t.core.isNumber(f)&&!isNaN(f)?(a++,s+=f,l+=f*f):"boolean"==typeof f&&(a++,1==f&&(s++,l++)))}var _=0==a?0:s/a;switch(i){case e.Average:return _;case e.Count:return o;case e.Max:return h;case e.Min:return u;case e.Range:return h-u;case e.Sum:return s;case e.PopulationVariance:return a<=1?0:l/a-_*_;case e.PopulationStandardDeviation:return a<=1?0:Math.sqrt(l/a-_*_);case e.Variance:return a<=1?0:(l/a-_*_)*a/(a-1);case e.StandardDeviation:return a<=1?0:Math.sqrt((l/a-_*_)*a/(a-1))}throw"Invalid aggregate type."}}(r||(r={})),function(t){!function(t){t[t.Auto=0]="Auto",t[t.Show=1]="Show"}(t.AxisOverlappingLabels||(t.AxisOverlappingLabels={}))}(r||(r={})),function(t){!function(t){t[t.None=0]="None",t[t.Near=1]="Near",t[t.Far=2]="Far"}(t.AxisPosition||(t.AxisPosition={}))}(r||(r={})),function(t){!function(t){t[t.X=0]="X",t[t.Y=1]="Y"}(t.AxisType||(t.AxisType={}))}(r||(r={})),function(t){!function(t){t[t.None=0]="None",t[t.Fit=1]="Fit",t[t.Clip=2]="Clip"}(t.ClippingMode||(t.ClippingMode={}))}(r||(r={})),function(t){!function(t){t[t.Shape=0]="Shape",t[t.Label=1]="Label",t[t.Legend=2]="Legend",t[t.LegendItem=3]="LegendItem",t[t.Axis=4]="Axis",t[t.Plot=5]="Plot",t[t.Header=6]="Header",t[t.Footter=7]="Footter",t[t.Series=8]="Series",t[t.PlotArea=9]="PlotArea",t[t.Control=10]="Control"}(t.ElementType||(t.ElementType={}))}(r||(r={})),function(t){!function(t){t[t.Cluster=0]="Cluster",t[t.Stack=1]="Stack"}(t.Group||(t.Group={}))}(r||(r={})),function(t){!function(t){t[t.Left=0]="Left",t[t.Center=1]="Center",t[t.Right=2]="Right"}(t.HAlign||(t.HAlign={}))}(r||(r={})),function(t){!function(t){t[t.Color=0]="Color",t[t.Size=1]="Size",t[t.Shape=2]="Shape"}(t.LegendType||(t.LegendType={}))}(r||(r={})),function(t){!function(t){t[t.Default=0]="Default",t[t.Spline=1]="Spline",t[t.StepLeft=2]="StepLeft",t[t.StepRight=3]="StepRight",t[t.StepCenter=4]="StepCenter"}(t.LineAspect||(t.LineAspect={}))}(r||(r={})),function(t){!function(t){t[t.Auto=0]="Auto",t[t.Center=1]="Center"}(t.LinePosition||(t.LinePosition={}))}(r||(r={})),function(t){!function(t){t[t.Horizontal=0]="Horizontal",t[t.Vertical=1]="Vertical"}(t.Orientation||(t.Orientation={}))}(r||(r={})),function(t){!function(t){t[t.Auto=0]="Auto",t[t.Show=1]="Show"}(t.OverlappingLabels||(t.OverlappingLabels={}))}(r||(r={})),function(t){!function(t){t[t.Standard=0]="Standard",t[t.Cocoa=1]="Cocoa",t[t.Coral=2]="Coral",t[t.Dark=3]="Dark",t[t.HighContrast=4]="HighContrast",t[t.Light=5]="Light",t[t.Midnight=6]="Midnight",t[t.Modern=7]="Modern",t[t.Organic=8]="Organic",t[t.Slate=9]="Slate",t[t.Zen=10]="Zen",t[t.Cyborg=11]="Cyborg",t[t.Superhero=12]="Superhero",t[t.Flatly=13]="Flatly",t[t.Darkly=14]="Darkly",t[t.Cerulan=15]="Cerulan",t[t.Office=16]="Office",t[t.Office2010=17]="Office2010",t[t.Grayscale=18]="Grayscale",t[t.BlueWarm=19]="BlueWarm",t[t.Blue=20]="Blue",t[t.Blue2=21]="Blue2",t[t.BlueGreen=22]="BlueGreen",t[t.Green=23]="Green",t[t.GreenYellow=24]="GreenYellow",t[t.Yellow=25]="Yellow",t[t.YellowOrange=26]="YellowOrange",t[t.Orange=27]="Orange",t[t.OrangeRed=28]="OrangeRed",t[t.RedOrange=29]="RedOrange",t[t.Red=30]="Red",t[t.RedViolet=31]="RedViolet",t[t.Violet=32]="Violet",t[t.Violet2=33]="Violet2",t[t.Median=34]="Median",t[t.Paper=35]="Paper",t[t.Marquee=36]="Marquee",t[t.Slipstream=37]="Slipstream",t[t.Aspect=38]="Aspect"}(t.Palette||(t.Palette={}))}(r||(r={})),function(t){!function(t){t[t.Bar=0]="Bar",t[t.Line=1]="Line",t[t.Scatter=2]="Scatter",t[t.Area=3]="Area"}(t.PlotType||(t.PlotType={}))}(r||(r={})),function(t){!function(t){t[t.Left=0]="Left",t[t.Top=1]="Top",t[t.Right=2]="Right",t[t.Bottom=3]="Bottom"}(t.Position||(t.Position={}))}(r||(r={})),function(t){!function(t){t[t.SVG=0]="SVG",t[t.Canvas=1]="Canvas"}(t.RenderMethod||(t.RenderMethod={}))}(r||(r={})),function(t){!function(t){t[t.None=0]="None",t[t.Point=1]="Point",t[t.Points=2]="Points",t[t.Group=3]="Group",t[t.Color=4]="Color",t[t.Shape=5]="Shape",t[t.Size=6]="Size",t[t.Custom=7]="Custom"}(t.SelectionMode||(t.SelectionMode={}))}(r||(r={})),function(t){!function(t){t[t.Gaps=0]="Gaps",t[t.Zeros=1]="Zeros",t[t.Connected=2]="Connected"}(t.ShowNulls||(t.ShowNulls={}))}(r||(r={})),function(t){!function(t){t[t.Auto=0]="Auto",t[t.Outside=1]="Outside",t[t.Center=2]="Center",t[t.Inside=3]="Inside"}(t.TextPosition||(t.TextPosition={}))}(r||(r={})),function(t){!function(t){t[t.None=0]="None",t[t.Outside=1]="Outside",t[t.Inside=2]="Inside",t[t.Cross=3]="Cross"}(t.TickMark||(t.TickMark={}))}(r||(r={})),function(t){!function(t){t[t.Ordinal=0]="Ordinal",t[t.Linear=1]="Linear",t[t.Logarithmic=2]="Logarithmic",t[t.Percentage=3]="Percentage"}(t.ValueScaleType||(t.ValueScaleType={}))}(r||(r={})),function(t){t._assertDebug=function(t){if(!t())throw"Debug: Assert Fail."}}(r||(r={})),function(t){!function(t){t[t.Unknown=0]="Unknown",t[t.InvalidOperation=1]="InvalidOperation",t[t.EmptyName=2]="EmptyName",t[t.PlotTypeIsRegistered=3]="PlotTypeIsRegistered",t[t.UnknownPlotType=4]="UnknownPlotType",t[t.CoordinateSystemTypeIsRegistered=5]="CoordinateSystemTypeIsRegistered",t[t.UnknownCoordinateSystemType=6]="UnknownCoordinateSystemType",t[t.LegendSymbolTypeIsRegistered=7]="LegendSymbolTypeIsRegistered",t[t.UnknownLegendSymbolType=8]="UnknownLegendSymbolType",t[t.PlotTypeCannotSupportCoordinateSystem=9]="PlotTypeCannotSupportCoordinateSystem",t[t.Option_PlotArea_InvalidRow=4097]="Option_PlotArea_InvalidRow",t[t.Option_PlotArea_InvalidColumn=4098]="Option_PlotArea_InvalidColumn",t[t.Option_Config_DuplicatedRowAndColumnOfPlotArea=4353]="Option_Config_DuplicatedRowAndColumnOfPlotArea",t[t.AdornerRender_InvalidTypeName=8193]="AdornerRender_InvalidTypeName",t[t.AdornerRender_InvalidPlugin=8194]="AdornerRender_InvalidPlugin",t[t.AdornerRender_IsRegistered=8195]="AdornerRender_IsRegistered",t[t.ConditionalFormattingRule_InvalidTypeName=8209]="ConditionalFormattingRule_InvalidTypeName",t[t.ConditionalFormattingRule_InvalidPlugin=8210]="ConditionalFormattingRule_InvalidPlugin",t[t.ConditionalFormattingRule_IsRegistered=8211]="ConditionalFormattingRule_IsRegistered",t[t.DataContentProvider_InvalidTypeName=8225]="DataContentProvider_InvalidTypeName",t[t.DataContentProvider_InvalidPlugin=8226]="DataContentProvider_InvalidPlugin",t[t.DataContentProvider_IsRegistered=8227]="DataContentProvider_IsRegistered",t[t.DateParser_InvalidTypeName=8241]="DateParser_InvalidTypeName",t[t.DateParser_InvalidPlugin=8242]="DateParser_InvalidPlugin",t[t.DateParser_IsRegistered=8243]="DateParser_IsRegistered",t[t.RenderEngine_InvalidTypeName=8257]="RenderEngine_InvalidTypeName",t[t.RenderEngine_InvalidPlugin=8258]="RenderEngine_InvalidPlugin",t[t.RenderEngine_IsRegistered=8259]="RenderEngine_IsRegistered",t[t.StringFormatting_InvalidTypeName=8273]="StringFormatting_InvalidTypeName",t[t.StringFormatting_InvalidPlugin=8274]="StringFormatting_InvalidPlugin",t[t.StringFormatting_IsRegistered=8275]="StringFormatting_IsRegistered",t[t.Symbol_InvalidTypeName=8289]="Symbol_InvalidTypeName",t[t.Symbol_InvalidPlugin=8290]="Symbol_InvalidPlugin",t[t.Symbol_IsRegistered=8291]="Symbol_IsRegistered",t[t.DataGraph_InvalidTypeName=8305]="DataGraph_InvalidTypeName",t[t.DataGraph_InvalidPlugin=8306]="DataGraph_InvalidPlugin",t[t.DataGraph_IsRegistered=8307]="DataGraph_IsRegistered"}(t.Exception||(t.Exception={}))}(r||(r={})),function(t){var e=[{exception:t.Exception.Unknown,message:"Unknown exception."},{exception:t.Exception.InvalidOperation,message:"Invalid operation exception."},{exception:t.Exception.EmptyName,message:"The name is empty."},{exception:t.Exception.Option_PlotArea_InvalidRow,message:"The row is invalid in the plot area option."},{exception:t.Exception.Option_PlotArea_InvalidColumn,message:"The column is invalid in the plot area option."}];t._throwException=function(t){throw e.forEach(function(e){if(e.exception==t)throw new Error(e.message)}),new Error("Unknown exception.")}}(r||(r={})),function(t){var e=function(e){function i(i,n){var r=e.call(this,i,null,!0)||this;return r.__renderMethod=t.RenderMethod.SVG,r.__event=new t.core.Event,r.__enabled=!0,r._isSelected=!1,r.applyTemplate(t.__Constant_Core_Control_ClassName,null,null),r._initializeNotificationHandlers(),r.__renderEngine=r._createRenderEngine(r.hostElement,r.__renderMethod),r.initialize(n),r.refreshDelay(),r}return s(i,e),Object.defineProperty(i.prototype,"option",{get:function(){return this.__option},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"devicePixelRatio",{get:function(){return this.__renderEngine.devicePixelRatio},set:function(e){isNaN(e)||null==e||this.__renderEngine.devicePixelRatio==e||this.__renderMethod==t.RenderMethod.Canvas&&(this.__renderEngine&&this.hostElement.removeChild(this.__renderEngine.element),this.__renderEngine=this._createRenderEngine(this.hostElement,this.__renderMethod),this.__renderEngine.devicePixelRatio=e,this.refreshDelay())},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"enabled",{get:function(){return this.__enabled},set:function(t){null!=t&&(this.__enabled=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"renderMethod",{get:function(){return this.__renderMethod},set:function(e){if(null!=this.__dv){var i=t.core.asEnum(e,t.RenderMethod,!0);null!=i&&i!=this.__renderMethod&&(this.__renderMethod=i,this.__renderEngine&&this.hostElement.removeChild(this.__renderEngine.element),this.__renderEngine=this._createRenderEngine(this.hostElement,this.__renderMethod),this.refreshDelay())}},enumerable:!0,configurable:!0}),i.prototype._tooltip=function(){return null==this.__tooltip&&(this.__tooltip=new t.core.Tooltip,this.__tooltip.showDelay=200),this.__tooltip},i.prototype.initialize=function(e){if(null!=e){this.__option=e,this.renderMethod=e.renderMethod;var i=new t.options._DataOption(e.data),n=this._createPlotOptions(e.plots);this.__dv=new t._DvView(this,new t.options._ConfigOption(e.config),i,n),this.__dv._bindData(i.values)}else this.__option=null,this.__dv=new t._DvView(this,new t.options._ConfigOption(null),new t.options._DataOption(null),[])},i.prototype.load=function(t){null!=this.__dv&&(this.initialize(t),this.refreshDelay())},i.prototype.refresh=function(i){if(void 0===i&&(i=!0),null!=this.__dv&&(e.prototype.refresh.call(this,i),!this.isUpdating)){var n=this._getHostSize(),r=new t.core.Rect(0,0,n.width,n.height);this._layout(this.__renderEngine,r),this._render(this.__renderEngine,r)}},i.prototype.invalidate=function(){if(null!=this.__dv){var e=this._getHostSize();this._render(this.__renderEngine,new t.core.Rect(0,0,e.width,e.height))}},i.prototype._layout=function(t,e){return t.beginRender(),t.setViewportSize(e.width,e.height),null!=this.__dv&&this.__dv._layout(t,e),t.endRender(),e},i.prototype._render=function(t,e){if(t.beginRender(),t.setViewportSize(e.width,e.height),null!=this.__dv&&this.__dv._render(t),this.__dv._option().selectedStyle.adorners)for(var i=0,n=this.__dv.plotAreas;i<n.length;i++)for(var r=0,o=n[i]._plotViews();r<o.length;r++)for(var a=0,s=o[r]._getSelections();a<s.length;a++){s[a]._render(t,!0)}t.endRender()},i.prototype._getHostSize=function(){var e=new t.core.Size(0,0),i=this._getHostComputedStyle();if(null!=i){var n=this.hostElement;e=new t.core.Size(n.clientWidth,n.clientHeight);var r=parseFloat(i.paddingLeft.replace("px","")),o=parseFloat(i.paddingRight.replace("px","")),a=parseFloat(i.paddingTop.replace("px","")),s=parseFloat(i.paddingBottom.replace("px",""));isNaN(r)||(e.width-=r),isNaN(o)||(e.width-=o),isNaN(a)||(e.height-=a),isNaN(s)||(e.height-=s)}return e},i.prototype._getHostComputedStyle=function(){var t=this.hostElement;return null!=t&&null!=t.ownerDocument&&null!=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(this.hostElement):null},i.prototype._createRenderEngine=function(e,i){if(i==t.RenderMethod.SVG){var n=t._Render._renderFromType(this.hostElement,"SVG");return n.strokeWidth=null,n}return i==t.RenderMethod.Canvas?t._Render._renderFromType(this.hostElement,"Canvas"):(t._assertDebug(function(){return!1}),null)},i.prototype._createPlotOptions=function(e){var i=[];if(null!=e){Array.isArray(e)||(e=[e]);for(var n=0,r=e;n<r.length;n++){var o=r[n];i.push(new t.options._PlotOption(o))}}return i},i.prototype._showTooltip=function(t,e,i){var n=this;null!=this.__tooltipTimer&&(clearTimeout(this.__tooltipTimer),this.__tooltipTimer=null),this._tooltip().showDelay>0?this.__tooltipTimer=window.setTimeout(function(){n.__tooltipTimer=null,n._tooltip().show(n.hostElement,t,e),n._applyTooltipStyle(i),n._tooltip().hideDelay>0&&(n.__tooltipTimer=window.setTimeout(function(){n.__tooltipTimer=null,n._tooltip().hide()},n._tooltip().hideDelay))},this._tooltip().showDelay):(this._tooltip().show(this.hostElement,t,e),this._applyTooltipStyle(i),this._tooltip().hideDelay>0&&(this.__tooltipTimer=window.setTimeout(function(){n.__tooltipTimer=null,n._tooltip().hide()},this._tooltip().hideDelay)))},i.prototype._hideTooltip=function(){null!=this.__tooltipTimer&&(clearTimeout(this.__tooltipTimer),this.__tooltipTimer=null),this._tooltip().hide()},i.prototype._applyTooltipStyle=function(t){var e=document.querySelector(".gcdv-tooltip");e.style.backgroundColor=t.backgroundColor||null,e.style.padding=null==t.padding?null:t.padding,e.style.borderColor=t.borderStyle.stroke||null,e.style.borderWidth=null==t.borderStyle.strokeWidth?null:t.borderStyle.strokeWidth+"px",e.style.color=t.textStyle.color||null,e.style.fontFamily=t.textStyle.fontFamily||null,e.style.fontSize=null==t.textStyle.fontSize?null:t.textStyle.fontSize+"px"},i.prototype._initializeNotificationHandlers=function(){this.hostElement.addEventListener("mousemove",this.ontouch.bind(this),!1),this.hostElement.addEventListener("mousewheel",this.ontouch.bind(this),!1),this.hostElement.addEventListener("mouseleave",this.ontouch.bind(this),!1),this.hostElement.addEventListener("click",this.ontouch.bind(this),!1),this.hostElement.addEventListener("dblclick",this.ontouch.bind(this),!1),this.hostElement.addEventListener("wheel",this.ontouch.bind(this),!1)},i.prototype.ontouch=function(e){if(this.enabled){e=e||window.event;var i=new t.MotionEvent(0,0,0);switch(e.type){case"touchstart":i=new t.MotionEvent(t.MotionEvent.ACTION_DOWN);break;case"touchend":i=new t.MotionEvent(t.MotionEvent.ACTION_UP);break;case"touchcancel":i=new t.MotionEvent(t.MotionEvent.ACTION_CANCEL);break;case"touchmove":i=new t.MotionEvent(t.MotionEvent.ACTION_MOVE);break;case"mousedown":i=new t.MotionEvent(t.MotionEvent.ACTION_MOUSE_DOWN);break;case"mousemove":i=new t.MotionEvent(t.MotionEvent.ACTION_MOUSE_MOVE);break;case"mouseup":i=new t.MotionEvent(t.MotionEvent.ACTION_MOUSE_UP);break;case"mouseout":i=new t.MotionEvent(t.MotionEvent.ACTION_MOUSE_OUT);break;case"mouseover":i=new t.MotionEvent(t.MotionEvent.ACTION_MOUSE_OVER);break;case"click":i=new t.MotionEvent(t.MotionEvent.ACTION_CLICK);break;case"dblclick":i=new t.MotionEvent(t.MotionEvent.ACTION_DBCLICK);break;case"mouseenter":i=new t.MotionEvent(t.MotionEvent.ACTION_MOUSE_ENTER);break;case"mouseleave":i=new t.MotionEvent(t.MotionEvent.ACTION_MOUSE_LEAVE);break;case"wheel":i=new t.MotionEvent(t.MotionEvent.ACTION_WHEEL)}var n=this._toControl(e,0);i.x=n.x,i.y=n.y,i.originalEvent=e;var r=this.__dv.onHitted(i);if(null!=r)if(r.event=i,this.__event.raise(this,r),i.action==t.MotionEvent.ACTION_CLICK||i.action==t.MotionEvent.ACTION_DBCLICK){if(r&&this.__dv._option().selectionMode!=t.SelectionMode.None&&this.__dv._option().selectionMode!=t.SelectionMode.Custom){var o=this.__dv._option().selectionMode;if(r.elementType[0]==t.ElementType.Shape&&r.model&&r.model instanceof t.models._PointData&&r.plot)o==t.SelectionMode.Points&&(e.metaKey||e.ctrlKey||(o=t.SelectionMode.Point)),this._isSelected=!0,r.plot.setSelected(r.model,o),this.invalidate();else if(r.elementType[0]==t.ElementType.Series&&null!=r.model)o==t.SelectionMode.Points&&(e.metaKey||e.ctrlKey||(o=t.SelectionMode.Point)),r.plot instanceof t._LineGraph||(r.plot,t._AreaGraph),r.plot.setSelected(r.model,o),this._isSelected=!0,this.invalidate();else if(r.elementType[0]!=t.ElementType.Series&&r.elementType[0]!=t.ElementType.Shape&&this._isSelected){this._isSelected=!1;for(var a=0,s=this.__dv.plotAreas;a<s.length;a++)for(var l=0,u=s[a]._plotViews();l<u.length;l++){(S=u[l]).setSelected(null,t.SelectionMode.Point)}this.invalidate()}}}else if(i.action==t.MotionEvent.ACTION_MOUSE_MOVE||i.action==t.MotionEvent.ACTION_MOUSE_OVER){if(r.elementType[0]==t.ElementType.Header&&this.__dv.header.chartTitleOverflow){var h=this.__dv.header.title,c=this.__renderEngine.__stringRender._measureMultipleLines(h,200),p=c.map(function(t){return t.text}),f=c.reduce(function(t,e){return t+e.size.height},0),_=p.join("<br />");this._showTooltip(_,new t.core.Rect(e.clientX,e.clientY,200,f),{backgroundColor:"white",padding:"8px",borderStyle:{stroke:"#575757",strokeWidth:10},textStyle:{color:"#575757",fontSize:14,fontFamily:""}})}else if(r.elementType[0]==t.ElementType.Shape){if(null!=r.model.tooltipContentSite){var d=this.__dv._dataContentProvider().toHtml(r.model.tooltipContentSite);d&&d.length>0&&this._showTooltip(d,new t.core.Rect(e.clientX,e.clientY,5,5),r.plot._tooltipStyle())}}else this._hideTooltip();if(r.elementType[0]==t.ElementType.Shape||r.elementType[0]==t.ElementType.Series){if(r.plot&&r.element instanceof t._View&&!r.element._hovered)(C=r.plot.config.hoverStyle)instanceof t.options._DataPointStyleOption&&C._isEmpty()||(r.plot.setHovered(r.element),this.invalidate())}else if(r.plot)(C=r.plot.config.hoverStyle)instanceof t.options._DataPointStyleOption&&C._isEmpty()||(r.plot.setHovered(null),this.invalidate())}if(i.action==t.MotionEvent.ACTION_MOUSE_LEAVE||i.action==t.MotionEvent.ACTION_WHEEL){for(var g=!1,y=0,m=this.__dv.plotAreas;y<m.length;y++)for(var v=0,b=m[y]._plotViews();v<b.length;v++){var S,C;(C=(S=b[v]).config.hoverStyle)instanceof t.options._DataPointStyleOption&&C._isEmpty()||(S.setHovered(null),g=!0)}this._hideTooltip(),g&&this.invalidate()}}},i.prototype.hitTest=function(e){return null!=this.__dv&&this.__dv._rectangle().contains(e)?this.__dv.onHitted(new t.MotionEvent(0,e.x,e.y)):null},i.prototype.Select=function(e,i,n){if(void 0===i&&(i=null),void 0===n&&(n=null),null!=this.__dv&&this.__dv._option().selectionMode!=t.SelectionMode.None){for(var r=0,o=this.__dv.plotAreas;r<o.length;r++)for(var a=0,s=o[r]._plotViews();a<s.length;a++){s[a].setSelected(null,t.SelectionMode.Point)}if(null!=e){null!=i&&(this.__dv._option().selectedStyle=new t.options._SelectionStyleOption(i));var l=[];e instanceof Array?l=e:l.push(e);for(var u=0,h=l;u<h.length;u++){var c=h[u];c instanceof t.models._BaseData&&(c.field=n,c._select())}}this.refresh()}},i.prototype.Query=function(t){if(null!=this.__dv){for(var e=[],i=0,n=this.__dv.plotAreas;i<n.length;i++)for(var r=0,o=n[i]._plotViews();r<o.length;r++){var a=o[r];e=e.concat(a.Query(t))}return e}},Object.defineProperty(i.prototype,"event",{get:function(){return this.__event},enumerable:!0,configurable:!0}),i.prototype._toControl=function(e,i){t.core.isNumber(e)&&t.core.isNumber(i)?e=new t.core.Point(e,i):e instanceof MouseEvent&&(e=new t.core.Point(e.pageX,e.pageY)),t.core.asType(e,t.core.Point);var n=e.clone(),r=t.core.getElementRect(this.hostElement);n.x-=r.left,n.y-=r.top;var o=this._getHostComputedStyle();if(o){var a=parseInt(o.paddingLeft.replace("px",""));a&&!isNaN(a)&&(n.x-=a);var s=parseInt(o.paddingTop.replace("px",""));s&&!isNaN(s)&&(n.y-=s)}return n},i.prototype.dispose=function(){e.prototype.dispose.call(this),this.__dv=null},i}(t.Control);t.FlexDV=e}(r||(r={})),function(t){!function(t){var e=function(){function t(t){this.path=t}return Object.defineProperty(t.prototype,"path",{get:function(){return this._path},set:function(t){this._path=t,this._parts=t?t.split("."):[];for(var e=0;e<this._parts.length;e++){var i=this._parts[e],n=i.indexOf("[");n>-1&&(this._parts[e]=i.substr(0,n),this._parts.splice(++e,0,parseInt(i.substr(n+1))))}this._key=1==this._parts.length?this._parts[0]:null},enumerable:!0,configurable:!0}),t.prototype.getValue=function(t){if(t){if(this._key)return t[this._key];if(this._path in t)return t[this._path];for(var e=0;e<this._parts.length&&t;e++)t=t[this._parts[e]]}return t},t.prototype.setValue=function(t,e){if(t){if(this._path in t)return void(t[this._path]=e);for(var i=0;i<this._parts.length-1;i++)if(null==(t=t[this._parts[i]]))return;t[this._parts[this._parts.length-1]]=e}},t}();t.Binding=e}(t.core||(t.core={}))}(r||(r={})),function(t){!function(e){!function(i){var n=function(){function t(t,e,i,n){this._gd=t,this._name=e,this._level=i,this._isBottomLevel=n,this._groups=[],this._items=[]}return Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"level",{get:function(){return this._level},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"groups",{get:function(){return this._groups},enumerable:!0,configurable:!0}),t}();i.CollectionViewGroup=n;var r=function(){function r(t,n){var r=this;this._idx=-1,this._srtDsc=new i.ObservableArray,this._grpDesc=new i.ObservableArray,this._newItem=null,this._edtItem=null,this._pgSz=0,this._pgIdx=0,this._updating=0,this._stableSort=!1,this._canFilter=!0,this._canGroup=!0,this._canSort=!0,this._canAddNew=!0,this._canCancelEdit=!0,this._canRemove=!0,this._canChangePage=!0,this._trackChanges=!1,this._chgAdded=new i.ObservableArray,this._chgRemoved=new i.ObservableArray,this._chgEdited=new i.ObservableArray,this.collectionChanged=new e.Event,this.sourceCollectionChanging=new e.Event,this.sourceCollectionChanged=new e.Event,this.currentChanged=new e.Event,this.currentChanging=new e.Event,this.pageChanged=new e.Event,this.pageChanging=new e.Event,this._srtDsc.collectionChanged.addHandler(function(){for(var t=r._srtDsc,i=0;i<t.length;i++)e.assert(t[i]instanceof l,"sortDescriptions array must contain SortDescription objects.");r.canSort&&r.refresh()}),this._grpDesc.collectionChanged.addHandler(function(){for(var t=r._grpDesc,i=0;i<t.length;i++)e.assert(t[i]instanceof o,"groupDescriptions array must contain GroupDescription objects.");r.canGroup&&r.refresh()}),this.sourceCollection=t||new i.ObservableArray,n&&(this.beginUpdate(),e.copy(this,n),this.endUpdate())}return Object.defineProperty(r.prototype,"sortComparer",{get:function(){return this._srtCmp},set:function(t){t!=this._srtCmp&&(this._srtCmp=e.asFunction(t,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"useStableSort",{get:function(){return this._stableSort},set:function(t){this._stableSort=e.asBoolean(t)},enumerable:!0,configurable:!0}),r.prototype.getAggregate=function(e,i,n){var r=n?this._pgView:this._view;return t._getAggregate(e,r,i)},Object.defineProperty(r.prototype,"trackChanges",{get:function(){return this._trackChanges},set:function(t){this._trackChanges=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"itemsAdded",{get:function(){return this._chgAdded},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"itemsRemoved",{get:function(){return this._chgRemoved},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"itemsEdited",{get:function(){return this._chgEdited},enumerable:!0,configurable:!0}),r.prototype.clearChanges=function(){this._chgAdded.clear(),this._chgRemoved.clear(),this._chgEdited.clear()},r.prototype.implementsInterface=function(t){switch(t){case"ICollectionView":case"IEditableCollectionView":case"IPagedCollectionView":case"INotifyCollectionChanged":return!0}return!1},r.prototype.onCollectionChanged=function(t){void 0===t&&(t=e.NotifyCollectionChangedEventArgs.reset),this._committing||this._canceling||t.action!=e.NotifyCollectionChangedAction.Change||t.item==this.currentEditItem||this._trackItemChanged(t.item),this.collectionChanged.raise(this,t)},r.prototype._raiseCollectionChanged=function(t,i,n){void 0===t&&(t=e.NotifyCollectionChangedAction.Reset);var r=new e.NotifyCollectionChangedEventArgs(t,i,n);this.onCollectionChanged(r)},r.prototype.onSourceCollectionChanging=function(t){return this.sourceCollectionChanging.raise(this,t),!t.cancel},r.prototype.onSourceCollectionChanged=function(t){this.sourceCollectionChanged.raise(this,t)},Object.defineProperty(r.prototype,"canFilter",{get:function(){return this._canFilter},set:function(t){this._canFilter=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canGroup",{get:function(){return this._canGroup},set:function(t){this._canGroup=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canSort",{get:function(){return this._canSort},set:function(t){this._canSort=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentItem",{get:function(){return this._pgView&&this._idx>-1&&this._idx<this._pgView.length?this._pgView[this._idx]:null},set:function(t){this.moveCurrentTo(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentPosition",{get:function(){return this._idx},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"filter",{get:function(){return this._filter},set:function(t){this._filter!=t&&(this._filter=e.asFunction(t),this.canFilter&&this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"groupDescriptions",{get:function(){return this._grpDesc},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"groups",{get:function(){return this._groups},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isEmpty",{get:function(){return!this._pgView||!this._pgView.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sortDescriptions",{get:function(){return this._srtDsc},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"sourceCollection",{get:function(){return this._src},set:function(t){if(t!=this._src){if(!this.onSourceCollectionChanging(new e.CancelEventArgs))return;var i=this.currentPosition;this.commitEdit(),this.commitNew(),null!=this._ncc&&this._ncc.collectionChanged.removeHandler(this._sourceChanged),this._src=e.asArray(t,!1),this._ncc=e.tryCast(this._src,"INotifyCollectionChanged"),this._ncc&&this._ncc.collectionChanged.addHandler(this._sourceChanged,this),this.clearChanges(),this.refresh(),this.moveCurrentToFirst(),this.onSourceCollectionChanged(),this.currentPosition<0&&i>-1&&this.onCurrentChanged()}},enumerable:!0,configurable:!0}),r.prototype._sourceChanged=function(t,e){this._updating<=0&&this.refresh()},r.prototype.contains=function(t){return this._pgView.indexOf(t)>-1},r.prototype.moveCurrentTo=function(t){return this.moveCurrentToPosition(this._pgView.indexOf(t))},r.prototype.moveCurrentToFirst=function(){return this.moveCurrentToPosition(0)},r.prototype.moveCurrentToLast=function(){return this.moveCurrentToPosition(this._pgView.length-1)},r.prototype.moveCurrentToPrevious=function(){return this._idx>0&&this.moveCurrentToPosition(this._idx-1)},r.prototype.moveCurrentToNext=function(){return this.moveCurrentToPosition(this._idx+1)},r.prototype.moveCurrentToPosition=function(t){if(t>=-1&&t<this._pgView.length){var i=new e.CancelEventArgs;this._idx!=t&&this.onCurrentChanging(i)&&(this._edtItem&&this._pgView[t]!=this._edtItem&&this.commitEdit(),this._newItem&&this._pgView[t]!=this._newItem&&this.commitNew(),this._idx=t,this.onCurrentChanged())}return this._idx==t},r.prototype.refresh=function(){this._updating>0||this._newItem||this._edtItem||(this._performRefresh(),this.onCollectionChanged())},r.prototype._performRefresh=function(){var t=this.currentItem;this._src?this._filter&&this.canFilter?this._view=this._performFilter(this._src):this._view=this._srtDsc.length>0&&this.canSort?this._src.slice(0):this._src:this._view=[],this.canSort&&this._srtDsc.length>0&&this._performSort(this._view),this._groups=this.canGroup?this._createGroups(this._view):null,this._fullGroups=this._groups,this._groups&&(this._view=this._mergeGroupItems(this._groups)),this._pgIdx=u(this._pgIdx,0,this.pageCount-1),this._pgView=this._getPageView(),this._groups&&this.pageCount>1&&(this._groups=this._createGroups(this._pgView),this._mergeGroupItems(this._groups));var e=this._pgView.indexOf(t);e<0&&(e=Math.min(this._idx,this._pgView.length-1)),this._idx=e,this._digest=this._getGroupsDigest(this.groups),this.currentItem!==t&&this.onCurrentChanged()},r.prototype._performSort=function(t){if(this._stableSort){var e=t.map(function(t,e){return{item:t,index:e}}),i=this._compareItems();e.sort(function(t,e){var n=i(t.item,e.item);return 0==n?t.index-e.index:n});for(var n=0;n<t.length;n++)t[n]=e[n].item}else t.sort(this._compareItems())},r.prototype._compareItems=function(){var t=this._srtDsc,e=this._srtCvt,i=this._srtCmp,n=!0,r=0;return function(o,a){for(var s=0;s<t.length;s++){var l=t[s],u=l._bnd.getValue(o),h=l._bnd.getValue(a);if(e&&(u=e(l,o,u,n),h=e(l,a,h,!1),n=!1),i&&null!=(r=i(u,h)))return l.ascending?+r:-r;if(u!=u&&(u=null),h!=h&&(h=null),"string"==typeof u&&"string"==typeof h){var c=u.toLowerCase(),p=h.toLowerCase();c!=p&&(u=c,h=p)}if(null!=u&&null==h)return-1;if(null==u&&null!=h)return 1;if(0!=(r=u<h?-1:u>h?1:0))return l.ascending?+r:-r}return 0}},r.prototype._performFilter=function(t){return this.canFilter&&this._filter?t.filter(this._filter,this):t},r.prototype.onCurrentChanged=function(t){void 0===t&&(t=e.EventArgs.empty),this.currentChanged.raise(this,t)},r.prototype.onCurrentChanging=function(t){return this.currentChanging.raise(this,t),!t.cancel},Object.defineProperty(r.prototype,"items",{get:function(){return this._pgView},enumerable:!0,configurable:!0}),r.prototype.beginUpdate=function(){this._updating++},r.prototype.endUpdate=function(){this._updating--,this._updating<=0&&this.refresh()},Object.defineProperty(r.prototype,"isUpdating",{get:function(){return this._updating>0},enumerable:!0,configurable:!0}),r.prototype.deferUpdate=function(t){try{this.beginUpdate(),t()}finally{this.endUpdate()}},Object.defineProperty(r.prototype,"canAddNew",{get:function(){return this._canAddNew},set:function(t){this._canAddNew=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canCancelEdit",{get:function(){return this._canCancelEdit},set:function(t){this._canCancelEdit=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"canRemove",{get:function(){return this._canRemove},set:function(t){this._canRemove=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentAddItem",{get:function(){return this._newItem},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"currentEditItem",{get:function(){return this._edtItem},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isAddingNew",{get:function(){return null!=this._newItem},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isEditingItem",{get:function(){return null!=this._edtItem},enumerable:!0,configurable:!0}),r.prototype.editItem=function(t){t!=this._edtItem&&this.moveCurrentTo(t)&&(this.commitEdit(),this._edtItem=t,this._edtClone={},this._extend(this._edtClone,this._edtItem))},r.prototype.commitEdit=function(){var t=this._edtItem;if(null!=t){this._committing=!0;var i=this._sameContent(t,this._edtClone);this._edtItem=null,this._edtClone=null;var n=this._pgView.indexOf(t),r=this._digest;this._performRefresh(),i||this._trackItemChanged(t),this._pgView.indexOf(t)==n&&r==this._digest?this._raiseCollectionChanged(e.NotifyCollectionChangedAction.Change,t,n):this._raiseCollectionChanged(),this._committing=!1}},r.prototype.cancelEdit=function(){var t=this._edtItem;if(null!=t){if(this._edtItem=null,!this.canCancelEdit)return void e.assert(!1,"cannot cancel edits (canCancelEdit == false).");var i=this._src.indexOf(t);if(i<0||!this._edtClone)return;this._extend(this._src[i],this._edtClone),this._edtClone=null,this._canceling=!0,this._raiseCollectionChanged(e.NotifyCollectionChangedAction.Change,t,i),this._canceling=!1}},r.prototype.commitNew=function(){var t=this._newItem;if(null!=t){this._newItem=null;var i=this._pgView.indexOf(t),n=this._digest;if(this._performRefresh(),1==this._trackChanges){var r=this._chgEdited.indexOf(t);r>-1&&this._chgEdited.removeAt(r),this._chgAdded.indexOf(t)<0&&this._chgAdded.push(t)}this._pgView.indexOf(t)==i&&n==this._digest?this._raiseCollectionChanged(e.NotifyCollectionChangedAction.Change,t,i):this._raiseCollectionChanged()}},r.prototype.cancelNew=function(){var t=this._newItem;null!=t&&this.remove(t)},r.prototype.remove=function(t){var i=t==this._newItem;if(i&&(this._newItem=null),t==this._edtItem&&this.cancelEdit(),this.canRemove){var n=this._src.indexOf(t);if(n>-1){var r=this.currentItem;this._updating++,this._src.splice(n,1),this._updating--;var o=this._digest;if(this._performRefresh(),1==this._trackChanges){var a=this._chgAdded.indexOf(t);a>-1&&this._chgAdded.removeAt(a);var s=this._chgEdited.indexOf(t);s>-1&&this._chgEdited.removeAt(s),this._chgRemoved.indexOf(t)<0&&!i&&a<0&&this._chgRemoved.push(t)}var l=this.sortDescriptions.length>0,u=this.pageSize>0&&this._pgIdx>-1;l||u||o!=this._getGroupsDigest(this.groups)?this._raiseCollectionChanged():this._raiseCollectionChanged(e.NotifyCollectionChangedAction.Remove,t,n),this.currentItem!==r&&this.onCurrentChanged()}}else e.assert(!1,"cannot remove items (canRemove == false).")},r.prototype.removeAt=function(t){t=e.asInt(t),this.remove(this._pgView[t])},r.prototype._trackItemChanged=function(t){if(this._trackChanges){var i=this._chgEdited.indexOf(t);if(i<0&&this._chgAdded.indexOf(t)<0)this._chgEdited.push(t);else if(i>-1){var n=new e.NotifyCollectionChangedEventArgs(e.NotifyCollectionChangedAction.Change,t,i);this._chgEdited.onCollectionChanged(n)}else if((i=this._chgAdded.indexOf(t))>-1){n=new e.NotifyCollectionChangedEventArgs(e.NotifyCollectionChangedAction.Change,t,i);this._chgAdded.onCollectionChanged(n)}}},r.prototype._extend=function(t,e){for(var i in e)t[i]=e[i]},r.prototype._sameContent=function(t,e){for(var i in e)if(!this._sameValue(t[i],e[i]))return!1;for(var i in t)if(!this._sameValue(t[i],e[i]))return!1;return!0},r.prototype._sameValue=function(t,i){return t==i||e.DateTime.equals(t,i)},Object.defineProperty(r.prototype,"canChangePage",{get:function(){return this._canChangePage},set:function(t){this._canChangePage=e.asBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isPageChanging",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"itemCount",{get:function(){return this._pgView.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pageIndex",{get:function(){return this._pgIdx},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pageSize",{get:function(){return this._pgSz},set:function(t){t!=this._pgSz&&(this._pgSz=e.asInt(t),this.refresh())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"totalItemCount",{get:function(){return this._view.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pageCount",{get:function(){return this.pageSize?Math.ceil(this.totalItemCount/this.pageSize):1},enumerable:!0,configurable:!0}),r.prototype.moveToFirstPage=function(){return this.moveToPage(0)},r.prototype.moveToLastPage=function(){return this.moveToPage(this.pageCount-1)},r.prototype.moveToNextPage=function(){return this.moveToPage(this.pageIndex+1)},r.prototype.moveToPage=function(t){var i=u(t,0,this.pageCount-1);if(i!=this._pgIdx){this.canChangePage||e.assert(!1,"cannot change pages (canChangePage == false).");var n=new e.PageChangingEventArgs(i);this.onPageChanging(n)&&(this._pgIdx=i,this._pgView=this._getPageView(),this._idx=0,this.groupDescriptions&&0!=this.groupDescriptions.length?this.refresh():(this.onPageChanged(),this.onCollectionChanged()))}return this._pgIdx==t},r.prototype.moveToPreviousPage=function(){return this.moveToPage(this.pageIndex-1)},r.prototype.onPageChanged=function(t){void 0===t&&(t=e.EventArgs.empty),this.pageChanged.raise(this,t)},r.prototype.onPageChanging=function(t){return this.pageChanging.raise(this,t),!t.cancel},r.prototype._getFullGroup=function(t){var e=this._getGroupByPath(this._fullGroups,t.level,t._path);return null!=e&&(t=e),t},r.prototype._getGroupByPath=function(t,e,i){for(var n=0;n<t.length;n++){var r=t[n];if(r.level==e&&r._path==i)return r;if(r.level<e&&0==i.indexOf(r._path)&&null!=(r=this._getGroupByPath(r.groups,e,i)))return r}return null},r.prototype._getPageView=function(){if(this.pageSize<=0||this._pgIdx<0)return this._view;var t=this._pgSz*this._pgIdx,e=Math.min(t+this._pgSz,this._view.length);return this._view.slice(t,e)},r.prototype._createGroups=function(t){if(!this._grpDesc||!this._grpDesc.length)return null;for(var i=[],n={},r=null,o=0;o<t.length;o++)for(var a=t[o],s=i,l=this._grpDesc.length,u="",h=0;h<l;h++){var c=this._grpDesc[h],p=c.groupNameFromItem(a,h),f=h==l-1;!(r=n[u])&&e.isPrimitive(p)&&(r={},n[u]=r);var _=this._getGroup(c,s,r,p,h,f);u+="/"+p,_._path=u,f&&_.items.push(a),s=_.groups}return i},r.prototype._getGroupsDigest=function(t){for(var e="",i=0;null!=t&&i<t.length;i++){var n=t[i];e+="{"+n.name+":"+(n.items?n.items.length:"*"),n.groups.length>0&&(e+=",",e+=this._getGroupsDigest(n.groups)),e+="}"}return e},r.prototype._mergeGroupItems=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i];if(!n._isBottomLevel)for(var r=this._mergeGroupItems(n.groups),o=0,a=r.length;o<a;o++)n._items.push(r[o]);for(o=0,a=n._items.length;o<a;o++)e.push(n._items[o])}return e},r.prototype._getGroup=function(t,i,r,o,a,s){var l;if(r&&e.isPrimitive(o)){if(l=r[o])return l}else for(var u=0;u<i.length;u++)if(t.namesMatch(i[u].name,o))return i[u];var h=new n(t,o,a,s);return i.push(h),r&&(r[o]=h),h},r}();i.CollectionView=r;var o=function(){function t(){}return t.prototype.groupNameFromItem=function(t,e){return""},t.prototype.namesMatch=function(t,e){return t===e},t}();i.GroupDescription=o;var a=function(t){function i(i,n){var r=t.call(this)||this;return r._bnd=new e.Binding(i),r._converter=n,r}return s(i,t),Object.defineProperty(i.prototype,"propertyName",{get:function(){return this._bnd.path},enumerable:!0,configurable:!0}),i.prototype.groupNameFromItem=function(t,e){return this._converter?this._converter(t,this.propertyName):this._bnd.getValue(t)},i.prototype.namesMatch=function(t,e){return t===e},i}(o);i.PropertyGroupDescription=a;var l=function(){function t(t,i){this._bnd=new e.Binding(t),this._asc=i}return Object.defineProperty(t.prototype,"property",{get:function(){return this._bnd.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ascending",{get:function(){return this._asc},enumerable:!0,configurable:!0}),t}();function u(t,e,i){return null!=t&&(null!=i&&t>i&&(t=i),null!=e&&t<e&&(t=e)),t}}(e.collections||(e.collections={}))}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){!function(e){var i=function(){function t(){this.length=0,Array.apply(this,arguments)}return t.prototype.pop=function(){return null},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0},t.prototype.splice=function(t,e,i){return null},t.prototype.slice=function(t,e){return null},t.prototype.indexOf=function(t,e){return-1},t.prototype.sort=function(t){return null},t.prototype.forEach=function(t,e){return null},t.prototype.filter=function(t,e){return null},t}();e.ArrayBase=i,i.prototype=Array.prototype;var n=function(e){function i(i){var n=e.call(this)||this;if(n._updating=0,n.collectionChanged=new t.Event,i){i=t.asArray(i),n._updating++;for(var r=0;r<i.length;r++)n.push(i[r]);n._updating--}return n}return s(i,e),i.prototype.push=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];for(var r=this.length,o=0;i&&o<i.length;o++)r=e.prototype.push.call(this,i[o]),this._updating||this._raiseCollectionChanged(t.NotifyCollectionChangedAction.Add,i[o],r-1);return r},i.prototype.pop=function(){var i=e.prototype.pop.call(this);return this._raiseCollectionChanged(t.NotifyCollectionChangedAction.Remove,i,this.length),i},i.prototype.splice=function(i,n,r){var o;return n&&r?(o=e.prototype.splice.call(this,i,n,r),1==n?this._raiseCollectionChanged(t.NotifyCollectionChangedAction.Change,r,i):this._raiseCollectionChanged(),o):r?(o=e.prototype.splice.call(this,i,0,r),this._raiseCollectionChanged(t.NotifyCollectionChangedAction.Add,r,i),o):(o=e.prototype.splice.call(this,i,n),1==n?this._raiseCollectionChanged(t.NotifyCollectionChangedAction.Remove,o[0],i):this._raiseCollectionChanged(),o)},i.prototype.slice=function(t,i){return e.prototype.slice.call(this,t,i)},i.prototype.indexOf=function(t,i){return e.prototype.indexOf.call(this,t,i)},i.prototype.sort=function(t){var i=e.prototype.sort.call(this,t);return this._raiseCollectionChanged(),i},i.prototype.insert=function(t,e){this.splice(t,0,e)},i.prototype.remove=function(t){var e=this.indexOf(t);return e>-1&&(this.removeAt(e),!0)},i.prototype.removeAt=function(t){this.splice(t,1)},i.prototype.setAt=function(t,e){t>this.length&&(this.length=t),this.splice(t,1,e)},i.prototype.clear=function(){0!==this.length&&(this.splice(0,this.length),this._raiseCollectionChanged())},i.prototype.beginUpdate=function(){this._updating++},i.prototype.endUpdate=function(){this._updating>0&&(this._updating--,0==this._updating&&this._raiseCollectionChanged())},Object.defineProperty(i.prototype,"isUpdating",{get:function(){return this._updating>0},enumerable:!0,configurable:!0}),i.prototype.deferUpdate=function(t){try{this.beginUpdate(),t()}finally{this.endUpdate()}},i.prototype.implementsInterface=function(t){return"INotifyCollectionChanged"==t},i.prototype.onCollectionChanged=function(e){void 0===e&&(e=t.NotifyCollectionChangedEventArgs.reset),this.isUpdating||this.collectionChanged.raise(this,e)},i.prototype._raiseCollectionChanged=function(e,i,n){if(void 0===e&&(e=t.NotifyCollectionChangedAction.Reset),!this.isUpdating){var r=new t.NotifyCollectionChangedEventArgs(e,i,n);this.onCollectionChanged(r)}},i}(i);e.ObservableArray=n}(t.collections||(t.collections={}))}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){function e(){}return e.addDays=function(t,e){var i=new Date(t);return i.setDate(i.getDate()+e),i},e.addMonths=function(t,e){var i=new Date(t);return i.setMonth(i.getMonth()+e),i},e.addYears=function(t,e){var i=new Date(t);return i.setFullYear(i.getFullYear()+e),i},e.addHours=function(t,e){var i=new Date(t);return i.setHours(i.getHours()+e),i},e.addMinutes=function(t,e){var i=new Date(t);return i.setMinutes(i.getMinutes()+e),i},e.addSeconds=function(t,e){var i=new Date(t);return i.setSeconds(i.getSeconds()+e),i},e.sameDate=function(e,i){return t.isDate(e)&&t.isDate(i)&&e.getFullYear()==i.getFullYear()&&e.getMonth()==i.getMonth()&&e.getDate()==i.getDate()},e.sameTime=function(e,i){return t.isDate(e)&&t.isDate(i)&&e.getHours()==i.getHours()&&e.getMinutes()==i.getMinutes()&&e.getSeconds()==i.getSeconds()},e.equals=function(e,i){return t.isDate(e)&&t.isDate(i)&&e.getTime()==i.getTime()},e.fromDateTime=function(t,e){return t||e?(t||(t=e),e||(e=t),new Date(t.getFullYear(),t.getMonth(),t.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())):null},e.toFiscal=function(i,n){var r=t.culture.Globalize.calendar;return Array.isArray(r.fiscalYearOffsets)?e.addMonths(i,-r.fiscalYearOffsets[n?0:1]):i},e.fromFiscal=function(i,n){var r=t.culture.Globalize.calendar;return Array.isArray(r.fiscalYearOffsets)?e.addMonths(i,+r.fiscalYearOffsets[n?0:1]):i},e.newDate=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())},e.clone=function(t){return e.fromDateTime(t,t)},e}();t.DateTime=e}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){return function(t,e,i){var n=Math.max(Math.max(t,e),i),r=Math.min(Math.min(t,e),i),o=n+r;this.luminosity=parseInt(((240*o+255)/510).toString(),10);var a=n-r;if(0===a)this.saturation=0,this.hue=160;else{this.luminosity<=120?this.saturation=parseInt(((240*a+o/2)/o).toString(),10):this.saturation=parseInt(((240*a+(510-o)/2)/(510-o)).toString(),10);var s=(40*(n-t)+a/2)/a,l=(40*(n-e)+a/2)/a,u=(40*(n-i)+a/2)/a;this.hue=t===n?parseInt((u-l).toString(),10):e===n?parseInt((80+s-u).toString(),10):parseInt((160+l-s).toString(),10),this.hue<0&&(this.hue+=240),this.hue>240&&(this.hue-=240)}}}();function i(t,e,i){function n(t,e,i){return parseInt(((255*function(t,e,i){i<0&&(i+=240);i>240&&(i-=240);if(i<40)return t+((e-t)*i+20)/40;if(i<120)return e;if(i<160)return t+((e-t)*(160-i)+20)/40;return t}(t,e,i)+120)/240).toString(),10)}var r,o,a,s,l;0===e?r=o=a=parseInt((255*i/240).toString(),10):(r=n(s=2*i-(l=i<=120?(i*(240+e)+120)/240:i+e-(i*e+120)/240),l,t+80),o=n(s,l,t),a=n(s,l,t-80));return{a:255,r:r,g:o,b:a}}t.HslColor=e,t.applyTint=function(t,n){if(0===n)return t;var r=new e(t.r,t.g,t.b),o=parseInt((n>0?((240-r.luminosity)*n).toString():r.luminosity*n).toString(),10),a=i(r.hue,r.saturation,r.luminosity+o);return{r:a.r,g:a.g,b:a.b,a:t.a}},t.fromHsl=i}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e;!function(t){t[t.Add=0]="Add",t[t.Remove=1]="Remove",t[t.Change=2]="Change",t[t.Reset=3]="Reset"}(e=t.NotifyCollectionChangedAction||(t.NotifyCollectionChangedAction={}));var i=function(){return function(t,e){this.handler=t,this.self=e}}(),n=function(){function e(){this._handlers=[]}return e.prototype.addHandler=function(e,n){t.asFunction(e),this._handlers.push(new i(e,n))},e.prototype.removeHandler=function(e,i){t.asFunction(e);for(var n=0;n<this._handlers.length;n++){var r=this._handlers[n];if((r.handler==e||null==e)&&(r.self==i||null==i)&&(this._handlers.splice(n,1),e&&i))break}},e.prototype.removeAllHandlers=function(){this._handlers.length=0},e.prototype.raise=function(t,e){void 0===e&&(e=r.empty);for(var i=0;i<this._handlers.length;i++){var n=this._handlers[i];n.handler.call(n.self,t,e)}},Object.defineProperty(e.prototype,"hasHandlers",{get:function(){return this._handlers.length>0},enumerable:!0,configurable:!0}),e}();t.Event=n;var r=function(){function t(){}return t.empty=new t,t}();t.EventArgs=r;var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cancel=!1,e}return s(e,t),e}(r);t.CancelEventArgs=o;var a=function(t){function i(i,n,r){void 0===i&&(i=e.Reset),void 0===n&&(n=null),void 0===r&&(r=-1);var o=t.call(this)||this;return o.action=i,o.item=n,o.index=r,o}return s(i,t),i.reset=new i(e.Reset),i}(r);t.NotifyCollectionChangedEventArgs=a;var l=function(t){function e(e){var i=t.call(this)||this;return i.newPageIndex=e,i}return s(e,t),e}(o);t.PageChangingEventArgs=l}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.clamp=function(t,e,i){return null!=t&&(null!=i&&t>i&&(t=i),null!=e&&t<e&&(t=e)),t}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.cloneDeep=function t(e){if(null==e||"number"==typeof e||"string"==typeof e||"boolean"==typeof e)return e;if(Array.isArray(e)){for(var i=[],n=0,r=e;n<r.length;n++){var o=r[n];i.push(t(o))}return i}if(e instanceof Date)return new Date(e.getTime());var a={};for(var s in e)"function"==typeof e[s]?a[s]=e[s]:a[s]=t(e[s]);return a}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.culture={Globalize:{numberFormat:{".":".",",":",",percent:{pattern:["-n %","n %"]},currency:{decimals:2,symbol:"$",pattern:["($n)","$n"]}},calendar:{"/":"/",":":":",firstDay:0,days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],am:["AM","A"],pm:["PM","P"],eras:["A.D.","B.C."],patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",t:"h:mm tt",T:"h:mm:ss tt",M:"MMMM d",m:"MMMM d",Y:"MMMM, yyyy",y:"MMMM, yyyy",g:"M/d/yyyy h:mm tt",G:"M/d/yyyy h:mm:ss tt",s:'yyyy"-"MM"-"dd"T"HH":"mm":"ss',o:'yyyy"-"MM"-"dd"T"HH":"mm":"ss"."fffffffK',O:'yyyy"-"MM"-"dd"T"HH":"mm":"ss"."fffffffK',U:"dddd, MMMM dd, yyyy h:mm:ss tt"},fiscalYearOffsets:[-3,-3]}}}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.find=function(t,e){if(null!=t)for(var i=0,n=t;i<n.length;i++){var r=n[i];if(e(r))return r}return null}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.asArray=function(e,i){return void 0===i&&(i=!0),t.assert(i&&null==e||t.isArray(e),"Array expected."),e}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.asBoolean=function(e,i){return void 0===i&&(i=!1),t.assert(i&&null==e||t.isBoolean(e),"Boolean expected."),e}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.asEnum=function(e,i,n){if(void 0===n&&(n=!1),null==e&&n)return null;var r=i[e];return t.assert(null!=r,"Invalid enum value."),t.isNumber(r)?r:e}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.asFunction=function(e,i){return void 0===i&&(i=!0),t.assert(i&&null==e||t.isFunction(e),"Function expected."),e}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.asInt=function(e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!1),t.assert(i&&null==e||t.isInt(e),"Integer expected."),n&&e&&e<0)throw"Positive integer expected.";return e}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.asNumber=function(e,i,n){if(void 0===i&&(i=!1),void 0===n&&(n=!1),t.assert(i&&null==e||t.isNumber(e),"Number expected."),n&&e&&e<0)throw"Positive number expected.";return e}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.assert=function(t,e){if(!t)throw e?"Assertion failed: "+e:"Assertion failed!"}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.asString=function(e,i){return void 0===i&&(i=!0),i&&null==e?e:"string"==typeof e?e:void t.assert(!1,"A string value is expected.")}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.isArray=function(t){return t instanceof Array}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.isBoolean=function(t){return"boolean"==typeof t}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.isDate=function(t){return t instanceof Date&&!isNaN(t.getTime())}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.isFunction=function(t){return"function"==typeof t}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.isInt=function(e){return t.isNumber(e)&&e==Math.round(e)}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.isNumber=function(t){return"number"==typeof t}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.isObject=function(e){return null!=e&&"object"==(void 0===e?"undefined":o(e))&&!t.isDate(e)&&!t.isArray(e)}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.isPrimitive=function(e){return t.isString(e)||t.isNumber(e)||t.isBoolean(e)||t.isDate(e)}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.isString=function(t){return"string"==typeof t}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.merge=function t(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var n=new Object,r=0,o=e;r<o.length;r++){var a=o[r];if(null!=a&&"number"!=typeof a&&"string"!=typeof a&&"boolean"!=typeof a)if(Array.isArray(a)){Array.isArray(n)||(n=[]);for(var s=0;s<a.length;s++)s<a.length&&s<n.length?n[s]=t(n[s],a[s]):n.push(t(a[s]))}else for(var l in a)null===a[l]||"number"==typeof a[l]||"string"==typeof a[l]||"boolean"==typeof a[l]?n[l]=a[l]:void 0===a[l]||(n[l]=t(n[l],a[l]))}return n}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){t.toFixed=function(t,e,i){if(i){var n=(r=t.toString()).indexOf(".");n>-1&&(r=r.substr(0,n+1+e),t=parseFloat(r))}else{var r=t.toFixed(e);t=parseFloat(r)}return t}}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){function e(t){this._r=0,this._g=0,this._b=0,this._a=1,t&&this._parse(t)}return Object.defineProperty(e.prototype,"r",{get:function(){return this._r},set:function(e){this._r=t.clamp(t.asNumber(e),0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"g",{get:function(){return this._g},set:function(e){this._g=t.clamp(t.asNumber(e),0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"b",{get:function(){return this._b},set:function(e){this._b=t.clamp(t.asNumber(e),0,255)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"a",{get:function(){return this._a},set:function(e){this._a=t.clamp(t.asNumber(e),0,1)},enumerable:!0,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&this.r==t.r&&this.g==t.g&&this.b==t.b&&this.a==t.a},e.prototype.toString=function(){var t=Math.round(100*this.a);return t>99?"#"+((1<<24)+(this.r<<16)+(this.g<<8)+this.b).toString(16).slice(1):"rgba("+this.r+","+this.g+","+this.b+","+t/100+")"},e.fromRgba=function(i,n,r,o){void 0===o&&(o=1);var a=new e(null);return a.r=Math.round(t.clamp(t.asNumber(i),0,255)),a.g=Math.round(t.clamp(t.asNumber(n),0,255)),a.b=Math.round(t.clamp(t.asNumber(r),0,255)),a.a=t.clamp(t.asNumber(o),0,1),a},e.fromHsb=function(i,n,r,o){void 0===o&&(o=1);var a=e._hsbToRgb(t.clamp(t.asNumber(i),0,1),t.clamp(t.asNumber(n),0,1),t.clamp(t.asNumber(r),0,1));return e.fromRgba(a[0],a[1],a[2],o)},e.fromHsl=function(i,n,r,o){void 0===o&&(o=1);var a=e._hslToRgb(t.clamp(t.asNumber(i),0,1),t.clamp(t.asNumber(n),0,1),t.clamp(t.asNumber(r),0,1));return e.fromRgba(a[0],a[1],a[2],o)},e.fromString=function(i){var n=new e(null);return n._parse(t.asString(i))?n:null},e.prototype.getHsb=function(){return e._rgbToHsb(this.r,this.g,this.b)},e.prototype.getHsl=function(){return e._rgbToHsl(this.r,this.g,this.b)},e.interpolate=function(i,n,r){r=t.clamp(t.asNumber(r),0,1);var o=e._rgbToHsl(i.r,i.g,i.b),a=e._rgbToHsl(n.r,n.g,n.b),s=1-r,l=i.a*s+n.a*r,u=[o[0]*s+a[0]*r,o[1]*s+a[1]*r,o[2]*s+a[2]*r],h=e._hslToRgb(u[0],u[1],u[2]);return e.fromRgba(h[0],h[1],h[2],l)},e.toOpaque=function(n,r){if(1==(n=t.isString(n)?e.fromString(n):i(n,e)).a)return n;r=null==r?e.fromRgba(255,255,255,1):t.isString(r)?e.fromString(r):i(r,e);var o=n.a,a=1-o;return e.fromRgba(n.r*o+r.r*a,n.g*o+r.g*a,n.b*o+r.b*a)},e.prototype._parse=function(t){if("transparent"==(t=t.toLowerCase()))return this._r=this._g=this._b=this._a=0,!0;if(t&&0!=t.indexOf("#")&&0!=t.indexOf("rgb")&&0!=t.indexOf("hsl")){var i=document.createElement("div");i.style.color=t;var n=i.style.color;n==t&&((n=window.getComputedStyle(i).color)||(document.body.appendChild(i),n=window.getComputedStyle(i).color,document.body.removeChild(i))),t=n.toLowerCase()}if(0==t.indexOf("#"))return 4==t.length?(this.r=parseInt(t[1]+t[1],16),this.g=parseInt(t[2]+t[2],16),this.b=parseInt(t[3]+t[3],16),this.a=1,!0):7==t.length&&(this.r=parseInt(t.substr(1,2),16),this.g=parseInt(t.substr(3,2),16),this.b=parseInt(t.substr(5,2),16),this.a=1,!0);if(0==t.indexOf("rgb")){var r=t.indexOf("("),o=t.indexOf(")");if(r>-1&&o>-1)if((a=t.substr(r+1,o-(r+1)).split(",")).length>2)return this.r=parseInt(a[0]),this.g=parseInt(a[1]),this.b=parseInt(a[2]),this.a=a.length>3?parseFloat(a[3]):1,!0}if(0==t.indexOf("hsl")){var a;r=t.indexOf("("),o=t.indexOf(")");if(r>-1&&o>-1)if((a=t.substr(r+1,o-(r+1)).split(",")).length>2){var s=parseInt(a[0])/360,l=parseInt(a[1]),u=parseInt(a[2]);a[1].indexOf("%")>-1&&(l/=100),a[2].indexOf("%")>-1&&(u/=100);var h=e._hslToRgb(s,l,u);return this.r=h[0],this.g=h[1],this.b=h[2],this.a=a.length>3?parseFloat(a[3]):1,!0}}return!1},e._hslToRgb=function(i,n,r){var o,a,s;if(t.assert(i>=0&&i<=1&&n>=0&&n<=1&&r>=0&&r<=1,"bad HSL values"),0==n)o=a=s=r;else{var l=r<.5?r*(1+n):r+n-r*n,u=2*r-l;o=e._hue2rgb(u,l,i+1/3),a=e._hue2rgb(u,l,i),s=e._hue2rgb(u,l,i-1/3)}return[Math.round(255*o),Math.round(255*a),Math.round(255*s)]},e._hue2rgb=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},e._rgbToHsl=function(e,i,n){t.assert(e>=0&&e<=255&&i>=0&&i<=255&&n>=0&&n<=255,"bad RGB values"),e/=255,i/=255,n/=255;var r,o,a=Math.max(e,i,n),s=Math.min(e,i,n),l=(a+s)/2;if(a==s)r=o=0;else{var u=a-s;switch(o=l>.5?u/(2-a-s):u/(a+s),a){case e:r=(i-n)/u+(i<n?6:0);break;case i:r=(n-e)/u+2;break;case n:r=(e-i)/u+4}r/=6}return[r,o,l]},e._rgbToHsb=function(i,n,r){t.assert(i>=0&&i<=255&&n>=0&&n<=255&&r>=0&&r<=255,"bad RGB values");var o=e._rgbToHsl(i,n,r);return e._hslToHsb(o[0],o[1],o[2])},e._hsbToRgb=function(t,i,n){var r=e._hsbToHsl(t,i,n);return e._hslToRgb(r[0],r[1],r[2])},e._hsbToHsl=function(e,i,n){t.assert(e>=0&&e<=1&&i>=0&&i<=1&&n>=0&&n<=1,"bad HSB values");var r=t.clamp(n*(2-i)/2,0,1),o=1-Math.abs(2*r-1),a=t.clamp(o>0?n*i/o:i,0,1);return t.assert(!isNaN(r)&&!isNaN(a),"bad conversion to HSL"),[e,a,r]},e._hslToHsb=function(e,i,n){t.assert(e>=0&&e<=1&&i>=0&&i<=1&&n>=0&&n<=1,"bad HSL values");var r=t.clamp(1==n?1:(2*n+i*(1-Math.abs(2*n-1)))/2,0,1),o=t.clamp(r>0?2*(r-n)/r:i,0,1);return t.assert(!isNaN(r)&&!isNaN(o),"bad conversion to HSB"),[e,o,r]},e}();function i(e,i,r){return void 0===r&&(r=!1),e=n(e,i),t.assert(r||null!=e,i+" expected."),e}function n(e,i){return null==e?null:t.isString(i)?t.isFunction(e.implementsInterface)&&e.implementsInterface(i)?e:null:e instanceof i?e:null}t.Color=e,t.asType=i,t.tryCast=n}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){function e(){}return e.format=function(i,n,r,o){return t.isString(i)?i:t.isNumber(i)?(n=n||(i==Math.round(i)?"n0":"n2"),e.formatNumber(i,n,r,o)):t.isDate(i)?(n=n||"d",e.formatDate(i,n)):null!=i?i.toString():""},e.formatNumber=function(i,n,r,o){t.asNumber(i),t.asString(n);var a,s=n?n.match(/([a-z])(\d*)(,*)(.*)/i):null,l=t.culture.Globalize.numberFormat,u=s?s[1].toLowerCase():"n",h=s&&s[2]?parseInt(s[2]):"c"==u?l.currency.decimals:i==Math.round(i)?0:2,c=s&&s[3]?3*s[3].length:0,p=s&&s[4]?s[4]:l.currency.symbol,f=l["."],_=l[","];if(c&&(i/=Math.pow(10,c)),"d"==u||"x"==u){for(a=Math.round(Math.abs(i)).toString("d"==u?10:16);a.length<h;)a="0"+a;return i<0&&(a="-"+a),n&&"X"==n[0]&&(a=a.toUpperCase()),a}if("p"==u&&(i=e._mul100(i)),o&&(i=t.toFixed(i,h,!0)),a="c"==u||"p"==u?Math.abs(i).toFixed(h):i.toFixed(h),(r||"g"==u)&&a.indexOf(".")>-1&&(a=(a=a.replace(/(\.[0-9]*?)0+$/g,"$1")).replace(/\.$/,"")),"."!=f&&(a=a.replace(".",f)),_&&("n"==u||"c"==u||"p"==u)){var d=a.indexOf(f),g=/\B(?=(\d\d\d)+(?!\d))/g;a=d>-1?a.substr(0,d).replace(g,_)+a.substr(d):a.replace(g,_)}"c"==u&&(a=l.currency.pattern[i<0?0:1].replace("n",a).replace("$",p));"p"==u&&(a=l.percent.pattern[i<0?0:1].replace("n",a));return a},e.formatDate=function(t,i){switch(i){case"r":case"R":return t.toUTCString();case"u":return t.toISOString().replace(/\.\d{3}/,"")}i=e._expandFormat(i);for(var n=e._parseDateFormat(i),r="",o=0;o<n.length;o++)r+=e._formatDatePart(t,i,n[o]);return r},e.parseInt=function(t,i){return Math.round(e.parseFloat(t,i))},e.parseFloat=function(e,i){var n=e.indexOf("-")>-1||e.indexOf("(")>-1&&e.indexOf(")")>-1?-1:1,r=e.indexOf("%")>-1?.01:1,o=i?i.match(/,+/):null,a=o?3*o[0].length:0;if(i&&("x"==i[0]||"X"==i[0]))return e=e.replace(/[^0-9a-f]+.*$/gi,""),parseInt(e,16)*n*r*Math.pow(10,a);var s=t.culture.Globalize.numberFormat["."],l=new RegExp("[^\\d\\"+s+"]","g"),u=e.replace(l,"").replace(s,".");return parseFloat(u)*n*r*Math.pow(10,a)},e.parseDate=function(i,n){if(!(i=t.asString(i)))return null;if("u"==n)return new Date(i);if("R"==n||"r"==n){var r=i.match(/(([0-9]+)\-([0-9]+)\-([0-9]+))?\s?(([0-9]+):([0-9]+)(:([0-9]+))?)?/);if(r[1]||r[5]){var o=r[1]?new Date(parseInt(r[2]),parseInt(r[3])-1,parseInt(r[4])):new Date;r[5]&&(o.setHours(parseInt(r[6])),o.setMinutes(parseInt(r[7])),o.setSeconds(r[8]?parseInt(r[9]):0))}else o=new Date(i);return isNaN(o.getTime())?null:o}n=e._expandFormat(n||"d");var a,s,l,u,h,c=t.culture.Globalize.calendar,p=e._CJK,f=new RegExp("(\\"+c["/"]+")|(\\"+c[":"]+")|(\\d+)|(["+p+"\\.]{2,})|(["+p+"]+)","gi"),_=i.match(f),d=e._parseDateFormat(n),g=0,y=-1,m=0,v=1,b=0,S=0,C=0,x=0,T=-1;if(!(_&&_.length&&d&&d.length))return null;for(var w=0;w<d.length&&_;w++){var P=w-g,A=P>-1&&P<_.length?_[P]:"",F=d[w].length;switch(d[w]){case"EEEE":case"EEE":case"EE":case"E":case"eeee":case"eee":case"ee":case"e":h=d[w];case"yyyy":case"yyy":case"yy":case"y":F>1&&A.length>F&&(_[P]=A.substr(F),A=A.substr(0,F),g++),y=parseInt(A);break;case"MMMM":case"MMM":u=!0;var O=A.toLowerCase();m=-1;for(var M=0;M<12;M++)if(0==c.months[M].toLowerCase().indexOf(O)){m=M;break}if(m>-1)break;case"MM":case"M":u=!0,F>1&&A.length>F&&(_[P]=A.substr(F),A=A.substr(0,F),g++),m=parseInt(A)-1;break;case"dddd":case"ddd":a=!0;break;case"dd":case"d":F>1&&A.length>F&&(_[P]=A.substr(F),A=A.substr(0,F),g++),v=parseInt(A),s=!0;break;case"hh":case"h":F>1&&A.length>F&&(_[P]=A.substr(F),A=A.substr(0,F),g++),b=12==(b=parseInt(A))?0:b;break;case"HH":F>1&&A.length>F&&(_[P]=A.substr(F),A=A.substr(0,F),g++),b=parseInt(A);break;case"H":b=parseInt(A);break;case"mm":case"m":F>1&&A.length>F&&(_[P]=A.substr(F),A=A.substr(0,F),g++),S=parseInt(A);break;case"ss":case"s":F>1&&A.length>F&&(_[P]=A.substr(F),A=A.substr(0,F),g++),C=parseInt(A);break;case"fffffff":case"FFFFFFF":case"ffffff":case"FFFFFF":case"fffff":case"FFFFF":case"ffff":case"FFFF":case"fff":case"FFF":case"ff":case"FF":case"f":case"F":x=parseInt(A)/Math.pow(10,F-3);break;case"tt":case"t":A=A.toUpperCase(),(c.pm[0]&&A==c.pm[0]&&b<12||c.pm[1]&&A==c.pm[1]&&b<12)&&(b+=12);break;case"q":case"Q":case"u":case"U":l=!0;break;case"ggg":case"gg":case"g":T=c.eras.length>1?e._getEra(A,c):-1;break;case c["/"]:case c[":"]:if(A&&A!=d[w])return null;break;case"K":break;default:e._unquote(d[w])!=A&&g++}}if(u&&s&&(isNaN(b)&&(b=0),isNaN(S)&&(S=0),isNaN(C)&&(C=0)),m<0||m>11||isNaN(m)||v<0||v>31||isNaN(v)||b<0||b>24||isNaN(b)||S<0||S>60||isNaN(S)||C<0||C>60||isNaN(C))return null;if(h){if(!u)return null;o=new Date(y,m),y=(o=t.DateTime.fromFiscal(o,"E"==h[0])).getFullYear(),m=o.getMonth()}if(a&&!s)return null;if(l&&!u)return null;if(y<0&&(y=(new Date).getFullYear()),T>-1)y=y+c.eras[T].start.getFullYear()-1;else if(y<100){y+=y+2e3<(t.isNumber(c.twoDigitYearMax)?c.twoDigitYearMax:2029)?2e3:1900}return o=new Date(y,m,v,b,S+0,C,x),isNaN(o.getTime())?null:o},e.getFirstDayOfWeek=function(){var e=t.culture.Globalize.calendar.firstDay;return e||0},e.getNumberDecimalSeparator=function(){var e=t.culture.Globalize.numberFormat["."];return e||"."},e._unquote=function(t){return t.length>1&&t[0]==t[t.length-1]&&("'"==t[0]||'"'==t[0])?t.substr(1,t.length-2):t},e._parseDateFormat=function(t){if(t in e.__dateFomatParts)return e.__dateFomatParts[t];var i,n,r=[];for(i=0;i>-1&&i<t.length;i++){var o=t[i];if(("'"==o||'"'==o)&&(n=t.indexOf(o,i+1))>-1)r.push(t.substring(i,n+1)),i=n;else{for(n=i+1;n<t.length&&t[n]==o;n++);r.push(t.substring(i,n)),i=n-1}}return e.__dateFomatParts[t]=r,r},e._formatDatePart=function(i,n,r){var o,a=t.culture.Globalize.calendar,s=0,l=0,u=0,h=r.length;switch(r){case"yyyy":case"yyy":case"yy":case"y":case"EEEE":case"EEE":case"EE":case"E":case"eeee":case"eee":case"ee":case"e":return l=(o="E"==r[0]?t.DateTime.toFiscal(i,!0):"e"==r[0]?t.DateTime.toFiscal(i,!1):i).getFullYear(),a.eras.length>1&&n.indexOf("g")>-1&&(s=e._getEra(i,a))>-1&&(l=l-a.eras[s].start.getFullYear()+1),e._zeroPad(l,4).substr(4-r.length);case"MMMM":return a.months[i.getMonth()];case"MMM":return a.monthsAbbr[i.getMonth()];case"MM":case"M":return e._zeroPad(i.getMonth()+1,h);case"dddd":return a.days[i.getDay()];case"ddd":return a.daysAbbr[i.getDay()];case"dd":return e._zeroPad(i.getDate(),2);case"d":return i.getDate().toString();case"hh":case"h":return e._zeroPad(e._h12(i),h);case"HH":case"H":return e._zeroPad(i.getHours(),h);case"mm":case"m":return e._zeroPad(i.getMinutes(),h);case"ss":case"s":return e._zeroPad(i.getSeconds(),h);case"fffffff":case"FFFFFFF":case"ffffff":case"FFFFFF":case"fffff":case"FFFFF":case"ffff":case"FFFF":case"fff":case"FFF":case"ff":case"FF":case"f":case"F":return u=i.getMilliseconds()*Math.pow(10,h-3),"f"==r[0]?e._zeroPad(u,h):u.toFixed(0);case"tt":return i.getHours()<12?a.am[0]:a.pm[0];case"t":return i.getHours()<12?a.am[1]:a.pm[1];case"q":case"Q":return(Math.floor(i.getMonth()/3)+1).toString();case"u":case"U":return o=t.DateTime.toFiscal(i,"U"==r),(Math.floor(o.getMonth()/3)+1).toString();case"ggg":case"gg":case"g":return a.eras.length>1&&(s=e._getEra(i,a))>-1?"ggg"==r?a.eras[s].name:"gg"==r?a.eras[s].name[0]:a.eras[s].symbol:a.eras[0];case":":case"/":return a[r];case"K":var c=i.toString().match(/(\+|\-)(\d{2})(\d{2})/);return c?c[1]+c[2]+c[3]:""}return h>1&&r[0]==r[h-1]&&('"'==r[0]||"'"==r[0])?r.substr(1,h-2):r},e._getEra=function(e,i){if(t.isDate(e)){for(var n=0;n<i.eras.length;n++)if(e>=i.eras[n].start)return n}else if(t.isString(e))for(n=0;n<i.eras.length;n++)if(i.eras[n].name&&(0==i.eras[n].name.indexOf(e)||0==i.eras[n].symbol.indexOf(e)))return n;return-1},e._expandFormat=function(e){var i=t.culture.Globalize.calendar.patterns[e];return i||e},e._zeroPad=function(t,e){var i=t.toFixed(0),n=e-i.length+1;return n>0?Array(n).join("0")+i:i},e._h12=function(e){var i=t.culture.Globalize.calendar,n=e.getHours();return i.am&&i.am[0]&&0==(n%=12)&&(n=12),n},e._mul100=function(t){var e=t.toString(),i=e.indexOf(".");return i<0?e+="00":(i+=2,e=(e=e.replace(".","")+"00").substr(0,i)+"."+e.substr(i)),parseFloat(e)},e._CJK="a-z"+"u00c0-u017fu3000-u30ffu4e00-u9faf".replace(/u/g,"\\u")+"u1100-u11ffu3130-u318fua960-ua97fuac00-ud7afud7b0-ud7ff".replace(/u/g,"\\u"),e.__dateFomatParts={},e}();t.Globalize=e}(t.core||(t.core={}))}(r||(r={})),function(t){!function(e){function i(t,e){t.style.display="none",e&&t.parentElement&&t.parentElement.removeChild(t)}function n(){var t=document.activeElement;if(t){var e=t.shadowRoot;e&&e.activeElement&&(t=e.activeElement)}return t}function r(t,i,n){void 0===i&&(i=400),void 0===n&&(n=35),e.asFunction(t),e.asNumber(i,!1,!0),e.asNumber(n,!1,!0);var r=Date.now(),o=setInterval(function(){var e=Math.min(1,(Date.now()-r)/i);e=Math.sin(e*Math.PI/2),e*=e,requestAnimationFrame(function(){t(e)}),e>=1&&clearInterval(o)},n);return Number(o)}e.showPopup=function(o,a,s,l,u){void 0===a&&(a=null),void 0===s&&(s=!1),void 0===l&&(l=!1),void 0===u&&(u=!0);var h=document.body;if(a instanceof HTMLElement){if(!e.contains(document.body,a))return;for(var c=a.parentElement;c;c=c.parentElement)if("fixed"==getComputedStyle(c).position){h=c;break}}else for(c=n();c;c=c.parentElement)if(!e.hasClass(c,"gcdv-popup")&&"fixed"==getComputedStyle(c).position){h=c;break}if(h.lastChild!=o&&h.appendChild(o),a instanceof HTMLElement&&u){var p=getComputedStyle(a);new e.Color(p.backgroundColor).a&&e.setCss(o,{color:p.color,backgroundColor:p.backgroundColor,fontFamily:p.fontFamily,fontSize:p.fontSize,fontWeight:p.fontWeight,fontStyle:p.fontStyle})}e.setCss(o,{position:"absolute",visibility:"hidden",display:""}),t.Control.refreshAll(o);var f=getComputedStyle(o),_=parseFloat(f.marginTop)+parseFloat(f.marginBottom),d=parseFloat(f.marginLeft)+parseFloat(f.marginRight),g=new e.Size(o.offsetWidth+d,o.offsetHeight+_),y=new e.Point,m=null;if(a&&null!=a.clientX&&null!=a.clientY&&null!=a.pageX&&null!=a.pageY)a.clientX<=0&&a.clientY<=0&&a.target?m=a.target.getBoundingClientRect():(y.x=Math.max(0,a.pageX-pageXOffset),y.y=Math.max(0,a.pageY-pageYOffset));else if(a instanceof e.Point)y=a;else if(a instanceof HTMLElement)m=a.getBoundingClientRect();else if(a&&null!=a.top&&null!=a.left)m=a;else{if(null!=a)throw"Invalid ref parameter.";y.x=Math.max(0,(innerWidth-g.width)/2),y.y=Math.max(0,Math.round((innerHeight-g.height)/2*.7))}var v=parseFloat(f.minWidth);if(m){var b=m.top,S=innerHeight-m.bottom,C="rtl"==getComputedStyle(o).direction;y.x=C?Math.max(0,m.right-g.width):Math.max(0,Math.min(m.left,innerWidth-g.width)),y.y=s?b>g.height||b>S?Math.max(0,m.top-g.height):m.bottom:S>g.height||S>b?m.bottom:Math.max(0,m.top-g.height),v=Math.max(v,m.width),e.isIE()&&(v-=o.offsetWidth-(o.clientWidth+parseInt(f.borderLeftWidth)+parseInt(f.borderRightWidth)))}var x=new e.Point(0,0);if(null!=a)if(h==document.body)x=new e.Point(-pageXOffset,-pageYOffset);else if(h){var T=h.getBoundingClientRect();x=new e.Point(T.left-h.scrollLeft,T.top-h.scrollTop)}var w={position:null==a?"fixed":"absolute",left:y.x-x.x,top:y.y-x.y,minWidth:v,display:"",visibility:"",zIndex:1500};l&&(o.style.opacity="0",r(function(t){o.style.opacity=1==t?"":t.toString()})),e.setCss(o,w);var P=a instanceof MouseEvent?a.target:a;if(P instanceof HTMLElement)for(var A,F=P.parentElement;F&&F!=document.body;F=F.parentElement)"auto"==getComputedStyle(F).overflowY&&F.scrollHeight>F.offsetHeight&&(A||(A=new t.Control(document.createElement("div"))),A.addEventListener(F,"scroll",function(t){i(o,!0),A.dispose()}))},e.hidePopup=function(t,e,n){void 0===e&&(e=!0),void 0===n&&(n=!1),n?r(function(n){t.style.opacity=(1-n).toString(),1==n&&(i(t,e),t.style.opacity="")}):i(t,e)},e.getActiveElement=n,e.animate=r}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){function e(e){this._showAutoTipBnd=this._showAutoTip.bind(this),this._hideAutoTipBnd=this._hideAutoTip.bind(this),this._html=!0,this._gap=6,this._showAtMouse=!1,this._showDelay=500,this._hideDelay=0,this._tips=[],this.popup=new t.Event,t.copy(this,e)}return e.prototype.setTooltip=function(e,i){e=t.getElement(e),i=this._getContent(i);var n=this._indexOf(e);n>-1&&(this._detach(e),this._tips.splice(n,1)),i&&(this._attach(e),this._tips.push({element:e,content:i}))},e.prototype.show=function(n,r,o){n=t.getElement(n),r=this._getContent(r),o||(o=t.Rect.fromBoundingRect(n.getBoundingClientRect()));var a=e._eTip;a||(a=e._eTip=document.createElement("div"),t.addClass(a,"gcdv-tooltip"),a.style.visibility="none",document.body.appendChild(a)),this._setContent(r);var s=new i(r);this.onPopup(s),s.content&&!s.cancel&&(this._setContent(s.content),a.style.minWidth="",o=new t.Rect(o.left-(a.offsetWidth-o.width)/2,o.top-this.gap,a.offsetWidth,o.height+2*this.gap),(a.offsetWidth>600||o.left<0)&&(o.height=0,o.width=0,a.innerHTML=""),t.showPopup(a,o,!0),document.addEventListener("mousedown",this._hideAutoTipBnd))},e.prototype.hide=function(){e._eTip&&(e._eTip.style.visibility="hidden",e._eTip.innerHTML=""),document.removeEventListener("mousedown",this._hideAutoTipBnd)},Object.defineProperty(e.prototype,"isVisible",{get:function(){return e._eTip&&"hidden"!=e._eTip.style.visibility},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isContentHtml",{get:function(){return this._html},set:function(e){this._html=t.asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"gap",{get:function(){return this._gap},set:function(e){this._gap=t.asNumber(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showAtMouse",{get:function(){return this._showAtMouse},set:function(e){this._showAtMouse=t.asBoolean(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDelay",{get:function(){return this._showDelay},set:function(e){this._showDelay=t.asInt(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideDelay",{get:function(){return this._hideDelay},set:function(e){this._hideDelay=t.asInt(e)},enumerable:!0,configurable:!0}),e.prototype.onPopup=function(t){this.popup&&this.popup.raise(this,t)},e.prototype._indexOf=function(t){for(var e=0;e<this._tips.length;e++)if(this._tips[e].element==t)return e;return-1},e.prototype._attach=function(t){t.addEventListener("mouseenter",this._showAutoTipBnd),t.addEventListener("mouseleave",this._hideAutoTipBnd),t.addEventListener("click",this._showAutoTipBnd)},e.prototype._detach=function(t){t.removeEventListener("mouseenter",this._showAutoTipBnd),t.removeEventListener("mouseleave",this._hideAutoTipBnd),t.removeEventListener("click",this._showAutoTipBnd)},e.prototype._showAutoTip=function(e){var i=this,n="mouseenter"==e.type?this._showDelay:0;this._clearTimeouts(),this._toShow=setTimeout(function(){var n=i._indexOf(e.target);if(n>-1){var r=i._tips[n],o=i._showAtMouse?new t.Rect(e.clientX,e.clientY,0,0):null;i.show(r.element,r.content,o),i._hideDelay>0&&(i._toHide=setTimeout(function(){i.hide()},i._hideDelay))}},n)},e.prototype._hideAutoTip=function(){this._clearTimeouts(),this.hide()},e.prototype._clearTimeouts=function(){this._toShow&&(clearTimeout(this._toShow),this._toShow=null),this._toHide&&(clearTimeout(this._toHide),this._toHide=null)},e.prototype._getContent=function(e){if((e=t.asString(e))&&"#"==e[0]){var i=t.getElement(e);i&&(e=i.innerHTML)}return e},e.prototype._setContent=function(t){var i=e._eTip;i&&(this.isContentHtml?i.innerHTML=t:i.textContent=t)},e}();t.Tooltip=e;var i=function(e){function i(i){var n=e.call(this)||this;return n._content=t.asString(i),n}return s(i,e),Object.defineProperty(i.prototype,"content",{get:function(){return this._content},set:function(e){this._content=t.asString(e)},enumerable:!0,configurable:!0}),i}(t.CancelEventArgs);t.TooltipEventArgs=i}(t.core||(t.core={}))}(r||(r={})),function(t){!function(t){var e=function(){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=0),this.width=t.asNumber(e),this.height=t.asNumber(i)}return e.prototype.equals=function(t){return t instanceof e&&this.width==t.width&&this.height==t.height},e.prototype.clone=function(){return new e(this.width,this.height)},e}();function i(t,e){if(t&&e&&t.setAttribute&&!n(t,e)){var i=t.getAttribute("class");t.setAttribute("class",i?i+" "+e:e)}}function n(t,e){if(t&&t.getAttribute){var i=new RegExp("(\\s|^)"+e+"(\\s|$)");return t&&i.test(t.getAttribute("class"))}return!1}t.Size=e,t.addClass=i,t.createElement=function(t,e){var i=document.createElement("div");i.innerHTML=t;var n=i.removeChild(i.firstChild);return e instanceof HTMLElement?e.appendChild(n):n},t.getElement=function(e){return e instanceof Element?e:t.isString(e)?document.querySelector(e):e&&e.jquery?e[0]:null},t.hasClass=n;var r=function(){function e(e,i,n,r){this.left=t.asNumber(e),this.top=t.asNumber(i),this.width=t.asNumber(n),this.height=t.asNumber(r)}return Object.defineProperty(e.prototype,"right",{get:function(){return this.left+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.top+this.height},enumerable:!0,configurable:!0}),e.prototype.equals=function(t){return t instanceof e&&this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height},e.prototype.clone=function(){return new e(this.left,this.top,this.width,this.height)},e.fromBoundingRect=function(i){return null!=i.left?new e(i.left,i.top,i.width,i.height):null!=i.x?new e(i.x,i.y,i.width,i.height):void t.assert(!1,"Invalid source rectangle.")},e.union=function(t,i){var n=Math.min(t.left,i.left),r=Math.min(t.top,i.top);return new e(n,r,Math.max(t.right,i.right)-n,Math.max(t.bottom,i.bottom)-r)},e.intersection=function(t,i){var n=Math.max(t.left,i.left),r=Math.max(t.top,i.top);return new e(n,r,Math.min(t.right,i.right)-n,Math.min(t.bottom,i.bottom)-r)},e.prototype.contains=function(i){if(i instanceof a)return i.x>=this.left&&i.x<=this.right&&i.y>=this.top&&i.y<=this.bottom;if(i instanceof e){var n=i;return n.left>=this.left&&n.right<=this.right&&n.top>=this.top&&n.bottom<=this.bottom}t.assert(!1,"Point or Rect expected.")},e.prototype.inflate=function(t,i){return new e(this.left-t,this.top-i,this.width+2*t,this.height+2*i)},e}();t.Rect=r;var o,a=function(){function e(e,i){void 0===e&&(e=0),void 0===i&&(i=0),this.x=t.asNumber(e),this.y=t.asNumber(i)}return e.prototype.equals=function(t){return t instanceof e&&this.x==t.x&&this.y==t.y},e.prototype.clone=function(){return new e(this.x,this.y)},e}();function s(t,e,r){null==r&&(r=!n(t,e)),r?i(t,e):l(t,e)}function l(t,e){if(t&&e&&t.setAttribute&&n(t,e)){var i=new RegExp("((\\s|^)"+e+"(\\s|$))","g"),r=t.getAttribute("class");r=r.replace(i," ").replace(/ +/g," ").trim(),t.setAttribute("class",r)}}function u(e,i,n){if(null!=e){if(t.isString(e))switch(i){case o.Number:var r=t.Globalize.parseFloat(e,n);return isNaN(r)?e:r;case o.Date:var a=t.Globalize.parseDate(e,n);return a||n||!e||(a=new Date(e)),a&&isFinite(a.getTime())?a:e;case o.Boolean:switch(e.toLowerCase()){case"true":return!0;case"false":return!1}return e}if(i==o.String)return t.Globalize.format(e,n)}return e}t.Point=a,t.copy=function e(i,n){if(n)for(var r in n)if("_"!=r[0]){t.assert(r in i,'Unknown property "'+r+'".');var o=n[r];i._copy&&i._copy(r,o)||(i[r]instanceof t.Event&&t.isFunction(o)?i[r].addHandler(o):t.isObject(o)&&i[r]&&"itemsSource"!=r?e(i[r],o):i[r]=o)}},t.getElementRect=function(t){var e=t.getBoundingClientRect();return new r(e.left+pageXOffset,e.top+pageYOffset,e.width,e.height)},t.contains=function(t,e){for(var i=e;i&&t;){if(i===t)return!0;var n=i;i=n=n.parentNode||n.host}return!1},t.setCss=function e(i,n){if(t.isArray(i))i.forEach(function(t){e(t,n)});else{var r=i.style;for(var o in n){var a=n[o];"number"==typeof a&&o.match(/width|height|left|top|right|bottom|size|padding|margin'/i)&&(a+="px"),r[o]!=a&&(r[o]=a.toString())}}},t.isIE=function(){return null!=navigator.userAgent.match(/MSIE |Trident\/|Edge\//)},t.closest=function(t,e){var i=t?t.matches||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector:null;if(i)for(;t;t=t.parentNode)if(t instanceof Element&&i.call(t,e))return t;return null},t.enable=function(t,e){s(t,"gcdv-state-disabled",!e),e?t.removeAttribute("disabled"):t.setAttribute("disabled","true");for(var i=t.querySelectorAll("input"),n=0;n<i.length;n++){var r=i[n];e?r.removeAttribute("disabled"):r.setAttribute("disabled","true")}},t.toggleClass=s,t.removeClass=l,t._deprecated=function(t,e){console.error('** WARNING: "'+t+'" has been deprecated; please use "'+e+'" instead.')},function(t){t[t.Object=0]="Object",t[t.String=1]="String",t[t.Number=2]="Number",t[t.Boolean=3]="Boolean",t[t.Date=4]="Date",t[t.Array=5]="Array"}(o=t.DataType||(t.DataType={})),t.asDate=function(e,i){if(void 0===i&&(i=!1),t.isString(e)){var n=u(e,o.Date,"r");t.isDate(n)&&(e=n)}return t.assert(i&&null==e||t.isDate(e),"Date expected."),e},t.changeType=u}(t.core||(t.core={}))}(r||(r={})),function(t){var e=function(){return function(t,e,i,n,r,o,a){this.hitPoint=t,this.model=e,this.plot=i,this.element=n,this.elementType=r,this.selection=o,this.field=a}}();t.HitInfo=e}(r||(r={})),function(t){!function(e){var i=function(){function e(e){this.__tiny=[0,-.5,.5,-.25,.25],t._assertDebug(function(){return null!=e&&Array.isArray(e)}),this.__colors=e}return e.prototype.getColor=function(e){if(this.__colors){var i=new t.core.Color(this.__colors[e%this.__colors.length]),n=this.__tiny[Math.floor(e/this.__colors.length)%this.__tiny.length],r=t.core.applyTint(i,n);return t.core.Color.fromRgba(r.r,r.g,r.b,r.a).toString()}return"grey"},e}();e._PaletteColorProvider=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(){}return t.Standard=["#88bde6","#fbb258","#90cd97","#f6aac9","#bfa554","#bc99c7","#eddd46","#f07e6e","#8c8c8c"],t.Cocoa=["#466bb0","#c8b422","#14886e","#b54836","#6e5944","#8b3872","#73b22b","#b87320","#141414"],t.Coral=["#84d0e0","#f48256","#95c78c","#efa5d6","#ba8452","#ab95c2","#ede9d0","#e96b7d","#888888"],t.Dark=["#005fad","#f06400","#009330","#e400b1","#b65800","#6a279c","#d5a211","#dc0127","#000000"],t.HighContrast=["#ff82b0","#0dda2c","#0021ab","#bcf28c","#19c23b","#890d3a","#607efd","#1b7700","#000000"],t.Light=["#ddca9a","#778deb","#cb9fbb","#b5eae2","#7270be","#a6c7a7","#9e95c7","#95b0c7","#9b9b9b"],t.Midnight=["#83aaca","#e37849","#14a46a","#e097da","#a26d54","#a584b7","#d89c54","#e86996","#2c343b"],t.Modern=["#2d9fc7","#ec993c","#89c235","#e377a4","#a68931","#a672a6","#d0c041","#e35855","#68706a"],t.Organic=["#9c88d9","#a3d767","#8ec3c0","#e9c3a9","#91ab36","#d4ccc0","#61bbd8","#e2d76f","#80715a"],t.Slate=["#7493cd","#f99820","#71b486","#e4a491","#cb883b","#ae83a4","#bacc5c","#e5746a","#505d65"],t.Zen=["#7bb5ae","#e2d287","#92b8da","#eac4cb","#7b8bbd","#c7d189","#b9a0c8","#dfb397","#a9a9a9"],t.Cyborg=["#2a9fd6","#77b300","#9933cc","#ff8800","#cc0000","#00cca3","#3d6dcc","#525252","#000000"],t.Superhero=["#5cb85c","#f0ad4e","#5bc0de","#d9534f","#9f5bde","#46db8c","#b6b86e","#4e5d6c","#2b3e4b"],t.Flatly=["#18bc9c","#3498db","#f39c12","#6cc1be","#99a549","#8f54b5","#e74c3c","#8a9899","#2c3e50"],t.Darkly=["#375a7f","#00bc8c","#3498db","#f39c12","#e74c3c","#8f61b3","#b08725","#4a4949","#000000"],t.Cerulan=["#033e76","#87c048","#59822c","#53b3eb","#fc6506","#d42323","#e3bb00","#cccccc","#222222"],t.Office=["#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"],t.Office2010=["#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646"],t.Grayscale=["#dddddd","#b2b2b2","#969696","#808080","#5f5f5f","#4d4d4d"],t.BlueWarm=["#4a66ac","#629dd1","#297fd5","#7f8fa9","#5aa2ae","#9d90a0"],t.Blue=["#0f6fc6","#009dd9","#0bd0d9","#10cf9b","#7cca62","#a5c249"],t.Blue2=["#1cade4","#2683c6","#27ced7","#42ba97","#3e8853","#62a39f"],t.BlueGreen=["#3494ba","#58b6c0","#75bda7","#7a8c8e","#84acb6","#2683c6"],t.Green=["#549e39","#8ab833","#c0cf3a","#029676","#4ab5c4","#0989b1"],t.GreenYellow=["#99cb38","#63a537","#37a76f","#44c1a3","#4eb3cf","#51c3f9"],t.Yellow=["#ffca08","#f8931d","#ce8d3e","#ec7016","#e64823","#9c6a6a"],t.YellowOrange=["#f0a22e","#a5644e","#b58b80","#c3986d","#a19574","#c17529"],t.Orange=["#e48312","#bd582c","#865640","#9b8357","#c2bc80","#94a088"],t.OrangeRed=["#d34817","#9b2d1f","#a28e6a","#956251","#918485","#855d5d"],t.RedOrange=["#e84c22","#ffbd47","#b64926","#ff8427","#cc9900","#b22600"],t.Red=["#a5300f","#d55816","#e19825","#b19c7d","#7f5f52","#b27d49"],t.RedViolet=["#e32d91","#c830cc","#4ea6dc","#4775e7","#8971e1","#d54773"],t.Violet=["#ad84c6","#8784c7","#5d739a","#6997af","#84acb6","#6f8183"],t.Violet2=["#92278f","#9b57d3","#755dd9","#665eb8","#45a5ed","#5982db"],t.Median=["#94b6d2","#dd8047","#a5ab81","#d8b25c","#7ba79d","#968c8c"],t.Paper=["#a5b592","#f3a447","#e7bc29","#d092a7","#9c85c0","#809ec2"],t.Marquee=["#418ab3","#a6b727","#f69200","#838383","#fec306","#df5327"],t.Slipstream=["#4e67c8","#5eccf3","#a7ea52","#5dceaf","#ff8021","#f14124"],t.Aspect=["#f07f09","#9f2936","#1b587c","#4e8542","#604878","#c19859"],t}();t._Palettes=e}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){!function(t){var e=function(){function t(t){this.__items=t}return Object.defineProperty(t.prototype,"items",{get:function(){return this.__items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isSelected",{get:function(){return this.__isSelected},enumerable:!0,configurable:!0}),t.prototype._select=function(){this.__isSelected=!0},t.prototype._unselect=function(){this.__isSelected=!1,this.__field=null},Object.defineProperty(t.prototype,"field",{get:function(){return this.__field},set:function(t){this.__field=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tooltipContentSite",{get:function(){return null},enumerable:!0,configurable:!0}),t}();t._BaseData=e}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t,e,n){var r=i.call(this,e)||this;return r.__fields={},r.__plotView=t,r.__option=n,r.__fields=r._analyseItems(r.items),r}return s(n,i),Object.defineProperty(n.prototype,"parent",{get:function(){return this.__plotView.plotArea},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return this._option().name},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"legends",{get:function(){return this._legendManager()._items},enumerable:!0,configurable:!0}),n.prototype._plotView=function(){return this.__plotView},n.prototype._legendManager=function(){return null==this.__legendManager&&(this.__legendManager=new e._PlotLegendManager(this)),this.__legendManager},n.prototype._legendSymbol=function(){return null},n.prototype._option=function(){return this.__option},Object.defineProperty(n.prototype,"fields",{get:function(){return this.__fields},enumerable:!0,configurable:!0}),n.prototype._createValueDefinitionList=function(t,e){void 0===e&&(e=null);var i=[];if(null!=t)for(var n=0,r=t;n<r.length;n++){var o=r[n],a=this._createValueDefinition(o,e);null!=a&&i.push(a)}return i},n.prototype._createValueDefinition=function(e,i){if(null!=e&&null!=e.field&&"string"==typeof e.field){var n=e.field.split(",");if(n.length>0){var r=this.fields[n[0].trim()];if(null!=r)return null==e.aggregate||null==i?new t.data._SingleValueDefinition(r):new t.data._SingleAggregateValueDefinition(r,null==e.aggregate?i:e.aggregate)}}return null},n.prototype._createDetailFields=function(t,e){var i=[];if(null==t)return i;var n=t;Array.isArray(t)||(n=[t]);for(var r=0,o=n;r<o.length;r++){var a=o[r],s=this._createDetailField(a,e);if(s&&s.length>0)for(var l=0,u=s;l<u.length;l++){for(var h=u[l],c=!1,p=0,f=i;p<f.length;p++){if(f[p]._equals(h)){c=!0;break}}c||i.push(h)}}return i},n.prototype._createDetailField=function(e,i){var n=[];if(null==e)return n;if(null!=e.field&&"string"==typeof e.field)for(var r=null!=e.group?t.core.asEnum(e.group,t.Group,!0):null,o=0,a=e.field.split(">");o<a.length;o++){var s=a[o],l=this.fields[s.trim()];null!=l&&(i=r||i,l._type==t.core.DataType.String?n.push(new t.data._StringDetailFieldInfo(l._name,l._values,i,e.excludeNulls)):l._type==t.core.DataType.Boolean?n.push(new t.data._BooleanDetailFieldInfo(l._name,l._values,i,e.excludeNulls)):l._type==t.core.DataType.Number?n.push(new t.data._NumberDetailFieldInfo(l._name,l._values,i,e.excludeNulls)):l._type==t.core.DataType.Date&&n.push(new t.data._DateDetailFieldInfo(l._name,l._values,l._dateParser(),i,e.excludeNulls)))}return n},n.prototype._createOrdinalField=function(e){if(null==e||null==e.field)return null;var i=this.fields[e.field];if(i){if(i._type==t.core.DataType.String)return i;if(i._type==t.core.DataType.Boolean)return i}return null},n.prototype._createLinearField=function(e){if(null==e||null==e.field)return null;var i=this.fields[e.field];if(i){if(i._type==t.core.DataType.Number)return i;if(i._type==t.core.DataType.Date)return i}},n.prototype._createAggregateFields=function(e,i){var n=[];if(null==e)return n;var r=e;Array.isArray(e)||(r=[e]);for(var o=0,a=r;o<a.length;o++){var s=a[o];if(s&&s.field)for(var l=s.aggregate?t.core.asEnum(s.aggregate,t.Aggregate):i,u=0,h=s.field.split(",");u<h.length;u++){var c=h[u],p=this.fields[c.trim()];null!=p&&n.push(new t.data._SingleAggregateValueDefinition(p,l))}}return n},n.prototype._analyseItems=function(e){for(var i={},n=0,r=e;n<r.length;n++){var o=r[n];for(var a in o){var s=i[a];void 0===s&&(i[a]=s=new t.data._NullFieldInfo(a));var l=o[a];if(void 0===s._type&&(t.core.isNumber(l)?i[a]=s=new t.data._NumberFieldInfo(a):t.core.isString(l)?null==this.parent.parent._dateParser()._parseDate(l)?i[a]=s=new t.data._StringFieldInfo(a):i[a]=s=new t.data._DateFieldInfo(a,[],this.parent.parent._dateParser()):t.core.isDate(l)?i[a]=s=new t.data._DateFieldInfo(a,[],this.parent.parent._dateParser()):t.core.isBoolean(l)&&(i[a]=s=new t.data._BooleanFieldInfo(a))),s._type==t.core.DataType.Number){var u=s,h=t.core.asNumber(l,!0);null!==h&&isFinite(h)&&((void 0===u._minimum()||u._minimum()>h)&&u._minimum(h),(void 0===u._maximum()||u._maximum()<h)&&u._maximum(h),-1==u._values.indexOf(h)&&u._values.push(h))}else if(s._type==t.core.DataType.Date){var c=s,p=null;null!=l&&null!==(p=t.core.isDate(l)?t.core.asDate(l,!0):this.parent.parent._dateParser()._parseDate(l.toString()))&&((void 0===c._minimum()||c._minimum()>p.valueOf())&&c._minimum(p.valueOf()),(void 0===c._maximum()||c._maximum()<p.valueOf())&&c._maximum(p.valueOf()),-1==c._values.indexOf(p.valueOf())&&c._values.push(p.valueOf()))}else if(s._type==t.core.DataType.String){var f=s,_=t.core.asString(l,!0);null!==_&&-1==f._values.indexOf(_)&&f._values.push(_)}else if(s._type==t.core.DataType.Boolean){var d=s,g=t.core.asBoolean(l,!0);null!==g&&-1==d._values.indexOf(g)&&d._values.push(g)}}}return i},n}(e._BaseData);e._PlotData=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.__item=new Object,i}return s(e,t),Object.defineProperty(e.prototype,"item",{get:function(){return this.__item},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataLabelContentSite",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype._assign=function(t){for(var e=0,i=Object.keys(t);e<i.length;e++){var n=i[e];this.item[n]=t[n]}},e}(t._BaseData);t._PointData=e}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t,e,n){var r=i.call(this,t,e,n)||this;return r.__valueDefinitionList=[],r.__textFields=[],r.__tooltipFields=[],r.__seriesList=[],r.__totalValue={},r.__totalValueByCategory={},r._analyseEncodings(),r._applyColorLegend(),r._applySizeLegend(),r._applyShapeLegend(),r.__seriesList=r._createDataSeriesList(),r._applyConditionFormattingRules(r._createGroupConditionalFormattingRules(r._option().config.rules),r._createDataPointConditionalFormattingRules(r._option().config.rules)),r}return s(n,i),Object.defineProperty(n.prototype,"xSite",{get:function(){return null==this.__xSite&&(this.__xSite=this._createXSite(this.items)),this.__xSite},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ySite",{get:function(){return null==this.__ySite&&(this.__ySite=this._createYSite(this.dataSeriesList,this._plotView().config.showNulls)),this.__ySite},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"xField",{get:function(){return this.__xField},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"valueDefinitions",{get:function(){return this.__valueDefinitionList},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dataSeriesList",{get:function(){return this.__seriesList},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"detailFields",{get:function(){return this.__detailFields},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"colorField",{get:function(){return this.__colorField},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sizeField",{get:function(){return this.__sizeField},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"shapeField",{get:function(){return this.__shapeField},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textFields",{get:function(){return this.__textFields},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tooltipFields",{get:function(){return this.__tooltipFields},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"legends",{get:function(){return this._legendManager()._items},enumerable:!0,configurable:!0}),n.prototype._percentage=function(){for(var t={},i={},n=0,r=this.dataSeriesList;n<r.length;n++)for(var o=0,a=r[n].dataPoints;o<a.length;o++){var s=NaN;(p=a[o])instanceof e._XyValuePointData?s=p.yValue:p instanceof e._XyRangeValuePointData&&(s=Math.max(p.yUpperValue,p.yLowerValue)),s>=0?(null==t[p.xValue]||t[p.xValue]<s)&&(t[p.xValue]=s):(null==i[p.xValue]||i[p.xValue]<s)&&(i[p.xValue]=s)}for(var l=0,u=this.dataSeriesList;l<u.length;l++)for(var h=0,c=u[l].dataPoints;h<c.length;h++){var p;(p=c[h])instanceof e._XyValuePointData?p._percentage((null==t[p.xValue]?0:Math.abs(t[p.xValue]))+(null==i[p.xValue]?0:Math.abs(i[p.xValue]))):p instanceof e._XyRangeValuePointData&&p._percentage((null==t[p.xValue]?0:Math.abs(t[p.xValue]))+(null==i[p.xValue]?0:Math.abs(i[p.xValue])))}},n.prototype._getPointColor=function(e){if(null!=this.colorField&&(this.colorField instanceof t.data._StringFieldInfo||this.colorField instanceof t.data._BooleanFieldInfo)){var i=this.colorField._toValue(e.items),n=this._legendManager()._findPointLegendItem(this.colorField,i);if(null!=n)return n.color}return null},n.prototype._getPointShape=function(t){if(null!=this.__shapeField){var e=this.__shapeField._toValue(t.items),i=this._legendManager()._findPointLegendItem(this.__shapeField,e);if(null!=i)return i.shape}return null},n.prototype._getPointSize=function(t){if(this.__sizeField){var e=this.__sizeField._toValue(t.items),i=this._legendManager()._findPointLegendItem(this.__sizeField,e);if(null!=i)return i.size}return null},n.prototype._getSeriesColor=function(t){if(t){var e=this.parent._legendManager()._findSeriesLegendItem(t);if(null!=e)return e.color}return null},n.prototype._totalValue=function(t){var e=this.__valueDefinitionList.indexOf(t);if(null==this.__totalValue[e]){this.__totalValue[e]=0;for(var i=0,n=this.dataSeriesList;i<n.length;i++){var r=n[i];r.valueDefinition==t&&(this.__totalValue[e]+=r._totalValue())}}return this.__totalValue[e]},n.prototype._totalValueByCategoryValue=function(t,e){var i=this.__valueDefinitionList.indexOf(t);null==this.__totalValueByCategory[i]&&(this.__totalValueByCategory[i]={});var n=this.__totalValueByCategory[i];if(null==n[e]){n[e]=0;for(var r=0,o=this.dataSeriesList;r<o.length;r++){var a=o[r];a.valueDefinition==t&&(n[e]+=a._totalValueByCategoryValue(e))}}return n[e]},n.prototype._fieldsFromToken=function(e){return"xField"==e&&null!=this.xField?[this.xField]:"detailFields"==e?this.detailFields:"colorField"==e?null!=this.colorField&&(this.colorField instanceof t.data._StringFieldInfo||this.colorField instanceof t.data._BooleanFieldInfo)?[this.colorField]:[null]:"sizeField"==e?[this.sizeField]:"shapeField"==e?[this.shapeField]:null},n.prototype._analyseEncodings=function(){if(this._option().encodings){this.__valueDefinitionList=[];var e=this._createValueDefinitionList(this._option().encodings.values);if(null!=e)if(e.length>1)for(var i=0,n=e;i<n.length;i++){var r=n[i];null==this.__xField&&r instanceof t.data._SingleValueDefinition?this.__xField=r._field:this.__valueDefinitionList.push(r)}else e.length>0&&this.__valueDefinitionList.push(e[0]);this.__detailFields=this._createDetailFieldList(this._option().encodings.details),this.__colorField=this._createColorField(this._option().encodings.color),this.__sizeField=this._createSizeField(this._option().encodings.size),this.__shapeField=this._createShapeField(this._option().encodings.shape),this.__textFields=this._createTextFieldList(this._option().encodings.text),this.__tooltipFields=this._createTooltipFieldList(this._option().encodings.tooltip)}else this.__xField=null,this.__valueDefinitionList=null,this.__detailFields=null,this.__colorField=null,this.__sizeField=null,this.__shapeField=null,this.__textFields=null,this.__tooltipFields=null},n.prototype._applyColorLegend=function(){"string"!=typeof this.colorField&&this._legendManager()._applyColorField(this.colorField)},n.prototype._applySizeLegend=function(){this._legendManager()._applySizeField(this.__sizeField)},n.prototype._applyShapeLegend=function(t){void 0===t&&(t=null),this._legendManager()._applyShapeField(this.__shapeField,t)},n.prototype._createValueDefinition=function(e,i){if(null!=this.__xField)return null;if(null!=e&&null!=e.field&&"string"==typeof e.field){var n=e.field.split(",");if(n.length>1){if(this.__xField=this.fields[n[0].trim()],null!=(r=this.fields[n[1].trim()]))return null==e.aggregate||null==i?new t.data._SingleValueDefinition(r):new t.data._SingleAggregateValueDefinition(r,null==e.aggregate?i:e.aggregate)}else if(n.length>0){var r;if(null!=(r=this.fields[n[0].trim()]))return null==e.aggregate||null==i?new t.data._SingleValueDefinition(r):new t.data._SingleAggregateValueDefinition(r,null==e.aggregate?i:e.aggregate)}}return null},n.prototype._createDetailFieldList=function(e){return this._createDetailFields(e,t.Group.Cluster)},n.prototype._createColorField=function(e){return e.field==t.__Constant_Core_Color_Field_VALUESNAME?t.__Constant_Core_Color_Field_VALUESNAME:this._createOrdinalField(e)},n.prototype._createSizeField=function(t){return this._createLinearField(t)},n.prototype._createShapeField=function(t){return this._createOrdinalField(t)},n.prototype._createTextFieldList=function(e){return this._createAggregateFields(e,t.Aggregate.List)},n.prototype._createTooltipFieldList=function(e){return this._createAggregateFields(e,t.Aggregate.List)},n.prototype._createXSite=function(t,i){return void 0===i&&(i=0),null!=this.xField?new e._XSiteModel(this.xField,i):new e._EmptySiteModel(i)},n.prototype._createYSite=function(t,i){return null==t||t.length<=0?new e._EmptySiteModel(0):new e._YSiteModel(t,i)},n.prototype._createDataSeriesList=function(){for(var e=[],i=0,n=this.__valueDefinitionList;i<n.length;i++){var r=n[i];if(this.__detailFields&&this.__detailFields.length>0){var o=this.__detailFields[0];this._legendManager()._applyColorField(this.__detailFields[0],!1);var a=new t.core.collections.CollectionView(this.items),s=new t.core.collections.PropertyGroupDescription(o._name);a.groupDescriptions.push(s);for(var l=!0,u=null,h=null,c=0,p=a.groups;c<p.length;c++){var f=p[c];if(!(null==(g=this._createDataSeries(f.items,r,f.name,l?t.Group.Cluster:o._group))||o._excludeNulls&&g._isNullGroup())){e.push(g),l=!1;var _=this.__detailFields[0]._toValue(f.items),d=this._legendManager()._findPointLegendItem(this.__detailFields[0],_);null!=d&&(g.color=d.color),null==u&&null==h?(u={},h={},g._stack(u,h)):g._group==t.Group.Stack&&g._stack(u,h)}}}else{var g;if(null!=(g=this._createDataSeries(this.items,r,null,t.Group.Cluster))){e.push(g),this.parent._legendManager()._applySeries(g,this.colorField==t.__Constant_Core_Color_Field_VALUESNAME);var y=this.parent._legendManager()._findSeriesLegendItem(g);null!=y&&(g.color=y.color)}}}if(1===e.length){var m=this.parent._legendManager()._findSeriesLegendItem(e[0]);null!=m&&this._legendManager()._items.forEach(function(t){t.items.forEach(function(t){t.seriesColor=m.color})})}return e},n.prototype._createGroupConditionalFormattingRules=function(e){var i=[],n=t.plugins._conditionalFormattingRulePlugin("Group");return null==n?i:(e.forEach(function(t){if(null!=t&&"Group"==t.type){var e=n.create(t);null!=e&&i.push(e)}}),i)},n.prototype._createDataPointConditionalFormattingRules=function(e){var i=[],n=t.plugins._conditionalFormattingRulePlugin("DataPoint");return null==n?i:(e.forEach(function(t){if(null!=t&&"DataPoint"==t.type){var e=n.create(t);null!=e&&i.push(e)}}),i)},n.prototype._applyConditionFormattingRules=function(t,e){for(var i=0,n=this.dataSeriesList;i<n.length;i++){n[i]._applyConditionFormattingRules(t,e)}},Object.defineProperty(n.prototype,"detail",{get:function(){return this.__detailFields&&this.__detailFields.length>0?this.__detailFields[0]:null},enumerable:!0,configurable:!0}),n}(e._PlotData);e._XyPlotData=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t,i,n){var r=e.call(this,i)||this;return r.__parent=t,r.__value=t.valueDefinition.toValue(r.items),r.__xValue=n,r.color=r.parent.parent._getPointColor(r),r.size=r.parent.parent._getPointSize(r),r.shape=r.parent.parent._getPointShape(r),r}return s(i,e),Object.defineProperty(i.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"style",{get:function(){return null==this.__style&&(this.__style=new t.options._DataPointStyleOption(this.parent.parent._option().config.style)),this.__style},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this.__color},set:function(t){this.__color!=t&&(this.__color=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shape",{get:function(){return this.__shape},set:function(t){this.__shape!=t&&(this.__shape=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return this.__size},set:function(t){this.__size!=t&&(this.__size=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"offset",{get:function(){return this.__offset},set:function(t){this.__offset!=t&&(this.__offset=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"xValue",{get:function(){return this.__xValue},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.__value},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tooltipContentSite",{get:function(){return new r(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataLabelContentSite",{get:function(){return new o(this)},enumerable:!0,configurable:!0}),i.prototype._applyConditionFormattingRules=function(t){for(var e=0,i=t;e<i.length;e++){i[e].evaluate(this)}},Object.defineProperty(i.prototype,"PercentageCategory",{get:function(){return null!=this.xValue?this.value/this.parent.parent._totalValueByCategoryValue(this.parent.valueDefinition,this.xValue):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PercentageDetail",{get:function(){return null!=this.parent.parent.detailFields&&this.parent.parent.detailFields.length>0?this.value/this.parent._totalValue():null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"PercentagePlot",{get:function(){return this.value/this.parent.parent._totalValue(this.parent.valueDefinition)},enumerable:!0,configurable:!0}),i}(e._PointData);e._XyPointData=i;var n=function(){function e(e){this.defaultProperty="value",t._assertDebug(function(){return null!=e}),this.__point=e}return Object.defineProperty(e.prototype,"stringFormatting",{get:function(){return this.__point.parent.parent.parent.parent._stringFormatting()},enumerable:!0,configurable:!0}),e.prototype._fromTokenByType=function(e,i,n){var r=this,o={name:null,value:null,aggregate:null};return"PercentageCategory"==e?(o.name="PercentageCategory",o.value=this.__point.PercentageCategory):"PercentageDetail"==e?(o.name="PercentageDetail",o.value=this.__point.PercentageDetail):"PercentagePlot"==e&&(o.name="PercentagePlot",o.value=this.__point.PercentagePlot),o.name?o:n.some(function(i){if(i.name==e)return o.name=i.name,o.value=i.toItem(r.__point.items),o.aggregate=t.Aggregate[i._aggregate],!0})?o:(this.literalTokens.some(function(t){if(t.name==e){var n;if("valueField"==t.name)(n=r.__point.parent.parent.valueDefinitions)&&n.length&&i>=0&&i<n.length&&(o.name=n[i].name,o.value=n[i].toItem(r.__point.items));else(n=r.__point.parent.parent._fieldsFromToken(e))&&n.length&&i>=0&&i<n.length&&(o.name=n[i]._name,o.value=n[i]._toItem(r.__point.items));return!0}}),o)},Object.defineProperty(e.prototype,"literalTokens",{get:function(){return null==this.__literalTokens&&(this.__literalTokens=[{name:"xField"},{name:"valueField"},{name:"categoryField"},{name:"colorField"},{name:"detailFields"},{name:"shapeField"},{name:"sizeField"},{name:"trellisField"},{name:"textField"},{name:"PercentageCategory",defaultFormat:this.stringFormatting.defaultFormat(t.core.DataType.Number,!0)},{name:"PercentageDetail",defaultFormat:this.stringFormatting.defaultFormat(t.core.DataType.Number,!0)},{name:"PercentagePlot",defaultFormat:this.stringFormatting.defaultFormat(t.core.DataType.Number,!0)}]),this.__literalTokens},enumerable:!0,configurable:!0}),e}(),r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),Object.defineProperty(e.prototype,"template",{get:function(){if(null==this.__point.parent.parent.tooltipFields||0===this.__point.parent.parent.tooltipFields.length)return null;var t=this.__point.parent.parent._option();return t&&t.encodings&&t.encodings.tooltip&&null!=t.config&&null!=t.config.tooltip&&t.config.tooltip.template?t.config.tooltip.template:this._defaultTemplate()},enumerable:!0,configurable:!0}),e.prototype._defaultTemplate=function(){var t=null,e=this.__point.parent.parent,i=[];return null!=e.xField&&(t=null!=t?t+"\n":"",t+="{xField.name}: {xField.value}",i.push(e.xField)),e.detailFields&&e.detailFields.length>0&&(t=null!=t?t+"\n":"",t+="{detailFields.name}: {detailFields.value}",i.push(e.detailFields[0])),e.tooltipFields.forEach(function(e){!e._aggregate&&i.some(function(t){return t._name==e.name})||(t+="\n{"+e.name+".name}: {"+e.name+".value}")}),t},e.prototype.fromToken=function(t,e){return this._fromTokenByType(t,e,this.__point.parent.parent.tooltipFields)},e}(n),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),Object.defineProperty(e.prototype,"template",{get:function(){if(null==this.__point.parent.parent.textFields||0===this.__point.parent.parent.textFields.length)return null;var t=this.__point.parent.parent._option();return t&&t.encodings&&t.encodings.text&&null!=t.config&&null!=t.config.text&&t.config.text.template?t.config.text.template:this._defaultTemplate()},enumerable:!0,configurable:!0}),e.prototype._defaultTemplate=function(){var t=[],e=this.__point.parent.parent._option().encodings;if(e&&e.text)for(var i=0,n=e.text;i<n.length;i++){var r=n[i];t.push("{"+r.field+".value}")}return t.join("; ")},e.prototype.fromToken=function(t,e){return this._fromTokenByType(t,e,this.__point.parent.parent.textFields)},e}(n)}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t,e,n,r,o){var a=i.call(this,e)||this;return a.__totalValueByCategoryValue={},a.__parent=t,a.__detail=r,a.__valueDefinition=n,a._group=o,a}return s(n,i),Object.defineProperty(n.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"detail",{get:function(){return this.__detail},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return null==this.__style&&(this.__style=new t.options._DataPointStyleOption(this.parent._option().config.style)),this.__style},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"color",{get:function(){return this.__color},set:function(t){this.__color!=t&&(this.__color=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dataPoints",{get:function(){return null==this.__dataPoints&&(this.__dataPoints=this._createDataPointList()),this.__dataPoints},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"valueDefinition",{get:function(){return this.__valueDefinition},enumerable:!0,configurable:!0}),n.prototype._totalValue=function(){if(null==this.__totalValue){this.__totalValue=0;for(var t=0,e=this.dataPoints;t<e.length;t++){var i=e[t];this.__totalValue+=i.value}}return this.__totalValue},n.prototype._isNullGroup=function(){for(var t=0,e=this.dataPoints;t<e.length;t++){if(null!=e[t].value)return!1}return!0},n.prototype._containsNull=function(){for(var t=0,e=this.dataPoints;t<e.length;t++){if(null==e[t].value)return!0}return!1},n.prototype._applyConditionFormattingRules=function(t,e){for(var i=0,n=t;i<n.length;i++){n[i].evaluate(this)}if(null!=this.dataPoints)for(var r=0,o=this.dataPoints;r<o.length;r++){o[r]._applyConditionFormattingRules(e)}},n.prototype._stack=function(e,i){for(var n=0,r=this.dataPoints;n<r.length;n++){var o=r[n];if(this._group==t.Group.Cluster){var a=o._stack(null,null);a>=0?(null==e[o.xValue]||a>e[o.xValue])&&(e[o.xValue]=a):(null==i[o.xValue]||a>i[o.xValue])&&(i[o.xValue]=a)}else{var s=o._stack(e[o.xValue],i[o.xValue]);s>=0?e[o.xValue]=s:i[o.xValue]=s}}},n.prototype._totalValueByCategoryValue=function(t){if(null==this.__totalValueByCategoryValue[t]){this.__totalValueByCategoryValue[t]=0;for(var e=0,i=this.dataPoints;e<i.length;e++){var n=i[e],r=n.xValue;null!=r&&r==t&&(this.__totalValueByCategoryValue[t]+=n.value)}}return this.__totalValueByCategoryValue[t]},n.prototype._createDataPointList=function(){var t=[];if(null!=this.parent.xSite.groups){for(var i=this.parent.xSite,n={},r=0,o=this.items;r<o.length;r++)for(var a=o[r],s=0;s<i._values.length;s++)if(-1!=i._values[s].items.indexOf(a)){null==n[s]&&(n[s]=[]),n[s].push(a);break}for(s=0;s<i._values.length;s++)null!=n[s]&&t.push(this._createDataPoint(n[s],s))}else if(this.parent.xSite instanceof e._XSiteModel)for(var l=0,u=this.items;l<u.length;l++){a=u[l];t.push(this._createDataPoint([a],this.parent.xSite._field()._toValue([a])))}else if(this.parent.xSite instanceof e._EmptySiteModel)for(var h=0,c=this.items;h<c.length;h++){a=c[h];t.push(this._createDataPoint([a],0))}return t},n}(e._BaseData);e._XySeriesData=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return s(n,i),Object.defineProperty(n.prototype,"categoryFields",{get:function(){return this.__categoryFields},enumerable:!0,configurable:!0}),n.prototype._analyseEncodings=function(){this.__categoryFields=this._createCategoryFieldList(this._option().encodings.category),i.prototype._analyseEncodings.call(this),null!=this.__categoryFields&&this.__categoryFields.length>0&&(this.__xField=this.__categoryFields[0])},n.prototype._createValueDefinition=function(e,n){if(void 0===n&&(n=null),null==this.__categoryFields||this.__categoryFields.length<=0){var r=new t.options._ValueAggregateEncodingOption(e);return r.aggregate=null,i.prototype._createValueDefinition.call(this,r,n)}if(null!=e.field)if("object"==o(e.field)){if(null!=e.field.lower&&"string"==typeof e.field.lower&&null!=e.field.upper&&"string"==typeof e.field.upper&&null!=this.fields[e.field.lower]&&null!=this.fields[e.field.upper]){if(this.fields[e.field.lower]._type==t.core.DataType.Number&&this.fields[e.field.upper]._type==t.core.DataType.Number)return new t.data._NumberRangeValueDefinition(this.fields[e.field.lower],this.fields[e.field.upper]);if(this.fields[e.field.lower]._type==t.core.DataType.Date&&this.fields[e.field.upper]._type==t.core.DataType.Date)return new t.data._DateRangeValueDefinition(this.fields[e.field.lower],this.fields[e.field.upper])}}else if("string"==typeof e.field){null!=e.aggregate&&t.core.asEnum(e.aggregate,t.Aggregate,!0);var a=e.field.split(",");if(a.length>0){var s=this.fields[a[0].trim()];if(null!=s)return new t.data._SingleAggregateValueDefinition(s,null==e.aggregate?t.Aggregate.Sum:e.aggregate)}}return null},n.prototype._createCategoryFieldList=function(e){var i=[];if(null==e.field)return null;for(var n=0,r=e.field.split(">").reverse();n<r.length;n++){var o=r[n],a=this.fields[o.trim()];null!=a&&(a._type==t.core.DataType.String?i.push(a):a._type==t.core.DataType.Boolean?i.push(a):t._assertDebug(function(){return!1}))}return i},n.prototype._createXSite=function(t,n){return void 0===n&&(n=0),null!=this.categoryFields&&this.categoryFields.length>0?new e._XCategorySiteModel(this.categoryFields,t,n):i.prototype._createXSite.call(this,t,n)},n.prototype._fieldsFromToken=function(t){return"categoryField"==t?this.categoryFields:i.prototype._fieldsFromToken.call(this,t)},n}(e._XyPlotData);e._XyAggregationPlotData=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(i,n,r){var o=e.call(this,i,n,r)||this;if(o.__yLowerValue=NaN,o.__yUpperValue=NaN,o.__yPreviousValue=NaN,i.valueDefinition instanceof t.data._NumberRangeValueDefinition){var a=i.valueDefinition.toItem(o.items);o.__yLowerValue=Math.min(a.lower,a.upper),o.__yUpperValue=Math.max(a.lower,a.upper);var s={};null!=i.parent.xField&&(s[i.parent.xField._name]=n[0][i.parent.xField._name]),s[i.valueDefinition._lowerField._name]=a.lower,s[i.valueDefinition._upperField._name]=a.upper,o._assign(s)}else if(i.valueDefinition instanceof t.data._DateRangeValueDefinition){a=i.valueDefinition.toItem(o.items);o.__yLowerValue=Math.min(a.lower.valueOf(),a.upper.valueOf()),o.__yUpperValue=Math.max(a.lower.valueOf(),a.upper.valueOf());s={};null!=i.parent.xField&&(s[i.parent.xField._name]=n[0][i.parent.xField._name]),s[i.valueDefinition._lowerField._name]=a.lower,s[i.valueDefinition._upperField._name]=a.upper,o._assign(s)}return o}return s(i,e),Object.defineProperty(i.prototype,"yLowerValue",{get:function(){return this.__yLowerValue},set:function(t){this.__yLowerValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"yPreviousValue",{get:function(){return this.__yPreviousValue},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"yUpperValue",{get:function(){return this.__yUpperValue},set:function(t){this.__yUpperValue=t},enumerable:!0,configurable:!0}),i.prototype._stack=function(t,e){if(this.yLowerValue>=0){if(null==t)return Math.max(this.yLowerValue,this.yUpperValue);this.__yPreviousValue=t,this.yUpperValue=this.yUpperValue-this.yLowerValue+t,this.yLowerValue=t}else{if(null==e)return Math.min(this.yLowerValue,this.yUpperValue);this.__yPreviousValue=e,this.yLowerValue=this.yLowerValue-this.yUpperValue+e,this.yUpperValue=e}},i.prototype._percentage=function(t){this.__yLowerValue=this.__yLowerValue/t,this.__yUpperValue=this.__yUpperValue/t},i}(e._XyPointData);e._XyRangeValuePointData=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return s(i,t),Object.defineProperty(i.prototype,"ySite",{get:function(){return null==this.__ySite&&(this.__ySite=new n(this,this.valueDefinition)),this.__ySite},enumerable:!0,configurable:!0}),i.prototype._createDataPoint=function(t,i){return new e._XyRangeValuePointData(this,t,i)},i}(e._XySeriesData);e._XyRangeValueSeriesData=i;var n=function(){function e(t,e){this.__isOrdinal=!1,this.valueCount=NaN,this.groups=null,this.groupLevels=0,this.__parent=t,this.__valueDefinition=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this.__valueDefinition._lowerField._name+"-"+this.__valueDefinition._upperField._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){for(var t=NaN,e=0,i=this.__parent.dataPoints;e<i.length;e++){var n=i[e],r=Math.min(n.yLowerValue,n.yUpperValue);(isNaN(t)||t>r)&&(t=r)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){for(var t=NaN,e=0,i=this.__parent.dataPoints;e<i.length;e++){var n=i[e],r=Math.max(n.yLowerValue,n.yUpperValue);(isNaN(t)||t<r)&&(t=r)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return this.__valueDefinition instanceof t.data._NumberRangeValueDefinition?t.core.DataType.Number:this.__valueDefinition instanceof t.data._DateRangeValueDefinition?t.core.DataType.Date:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOrdinal",{get:function(){return!1},set:function(t){throw"Not support!"},enumerable:!0,configurable:!0}),e.prototype.labelFromValue=function(e,i){var n=t.plugins._stringFormattingPlugin("Default");if(null!=n){var r=n.create();if(null!=r)return r.format(i,e)}return null},e}()}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(i,n,r){var o=e.call(this,i,n,r)||this;o.__yValue=NaN,o.__yPreviousValue=NaN,o.__yValue=i.valueDefinition.toValue(o.items);var a={};return null!=i.parent.xField&&(a[i.parent.xField._name]=n[0][i.parent.xField._name]),i.valueDefinition instanceof t.data._SingleValueDefinition?a[i.valueDefinition._field._name]=i.valueDefinition.toItem(o.items):i.valueDefinition instanceof t.data._SingleAggregateValueDefinition&&(a[i.valueDefinition._field._name]=i.valueDefinition.toItem(o.items)),o._assign(a),o}return s(i,e),Object.defineProperty(i.prototype,"yValue",{get:function(){return this.__yValue},set:function(t){this.__yValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"yPreviousValue",{get:function(){return this.__yPreviousValue},enumerable:!0,configurable:!0}),i.prototype._stack=function(t,e){return null==this.yValue?null!=t&&(this.__yPreviousValue=t):this.yValue>=0?null!=t&&(this.__yPreviousValue=t,this.yValue+=t):null!=e&&(this.__yPreviousValue=e,this.yValue+=e),this.yValue},i.prototype._percentage=function(t){this.__yValue=this.__yValue/t,this.__yPreviousValue=this.__yPreviousValue/t},i}(e._XyPointData);e._XyValuePointData=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return s(i,t),Object.defineProperty(i.prototype,"ySite",{get:function(){return null==this.__ySite&&(this.__ySite=new n(this,this.valueDefinition)),this.__ySite},enumerable:!0,configurable:!0}),i.prototype._createDataPoint=function(t,i){return new e._XyValuePointData(this,t,i)},i}(e._XySeriesData);e._XyValueSeriesData=i;var n=function(){function e(t,e){this.groups=null,this.groupLevels=0,this.__parent=t,this.__valueDefinotion=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this.__valueDefinotion._field._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){for(var t=NaN,e=0,i=this.__parent.dataPoints;e<i.length;e++){var n=i[e];(isNaN(t)||t>n.yValue)&&(t=n.yValue)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){for(var t=NaN,e=0,i=this.__parent.dataPoints;e<i.length;e++){var n=i[e];(isNaN(t)||t<n.yValue)&&(t=n.yValue)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return this.__valueDefinotion instanceof t.data._SingleAggregateValueDefinition&&this.__valueDefinotion._aggregate!=t.Aggregate.List?t.core.DataType.Number:this.__valueDefinotion._field._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOrdinal",{get:function(){return!(this.__valueDefinotion instanceof t.data._SingleAggregateValueDefinition&&this.__valueDefinotion._aggregate!=t.Aggregate.List)&&(this.__valueDefinotion._field._type==t.core.DataType.String||this.__valueDefinotion._field._type==t.core.DataType.Boolean)},set:function(t){throw"Not support!"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){if(this.__valueDefinotion instanceof t.data._SingleAggregateValueDefinition){if(this.__valueDefinotion._aggregate==t.Aggregate.List){if(this.__valueDefinotion._field instanceof t.data._StringFieldInfo)return this.__valueDefinotion._field._values.length;if(this.__valueDefinotion._field instanceof t.data._BooleanFieldInfo)return this.__valueDefinotion._field._values.length}else if(this.__valueDefinotion instanceof t.data._SingleValueDefinition){if(this.__valueDefinotion._field instanceof t.data._StringFieldInfo)return this.__valueDefinotion._field._values.length;if(this.__valueDefinotion._field instanceof t.data._BooleanFieldInfo)return this.__valueDefinotion._field._values.length}return NaN}},enumerable:!0,configurable:!0}),e.prototype.labelFromValue=function(e,i){if(this.__valueDefinotion instanceof t.data._SingleAggregateValueDefinition){if(this.__valueDefinotion._aggregate==t.Aggregate.List){if(this.__valueDefinotion._field instanceof t.data._StringFieldInfo)return this.__valueDefinotion._field._values[e];if(this.__valueDefinotion._field instanceof t.data._BooleanFieldInfo)return this.__valueDefinotion._field._values[e].toString()}}else if(this.__valueDefinotion instanceof t.data._SingleValueDefinition){if(this.__valueDefinotion._field instanceof t.data._StringFieldInfo)return this.__valueDefinotion._field._values[e];if(this.__valueDefinotion._field instanceof t.data._BooleanFieldInfo)return this.__valueDefinotion._field._values[e].toString()}var n=t.plugins._stringFormattingPlugin("Default");if(null!=n){var r=n.create();if(null!=r)return r.format(i,e)}return null},e}()}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){!function(t){var e=function(){function t(t){void 0===t&&(t=0),this.groups=null,this.groupLevels=0,this._padding=0,this._padding=t}return Object.defineProperty(t.prototype,"name",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return-.5},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return.5},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dataType",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOrdinal",{get:function(){return!1},set:function(t){throw"Not support!"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"valueCount",{get:function(){return NaN},enumerable:!0,configurable:!0}),t.prototype.labelFromValue=function(t,e){return null},t}();t._EmptySiteModel=e}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(e,i,n){void 0===n&&(n=0),this._padding=0,t._assertDebug(function(){return null!=e&&e.length>0}),this._padding=n,this.groupLevels=e.length-1,this.name=e[0]._name,this.dataType=e[0]._type,this.isOrdinal=!0,this._values=[];for(var r=new t.core.collections.CollectionView(i),o=e.length-1;o>=0;o--){var a=e[o],s=new t.core.collections.PropertyGroupDescription(a._name);r.groupDescriptions.push(s)}this.groups=[];for(var l=0,u=0,h=r.groups;u<h.length;u++){var c=h[u],p=this._createGroup(l,c,this._values);null!=p.children&&this.groups.push(p),l=p.end+1}}return Object.defineProperty(e.prototype,"min",{get:function(){return 0-this._padding},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._values.length-1+this._padding},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){return this._values?this._values.length:0},enumerable:!0,configurable:!0}),e.prototype.labelFromValue=function(t,e){if(null!=this._values&&this._values.length>0){var i=this._values[t];return i?i.label:null}return null},e.prototype._createGroup=function(t,e,i){if(null!=e.groups&&e.groups.length>0){for(var n=[],r=t,o=0,a=e.groups;o<a.length;o++){var s=a[o],l=this._createGroup(r,s,i);null!=l.children&&n.push(l),r=l.end+1}return{label:e.name.toString(),children:n,items:e.items,start:t,end:r-1}}return i.push({label:e.name.toString(),items:e.items}),{label:e.name.toString(),items:e.items,start:t,end:t}},e}();e._XCategorySiteModel=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(t,e){void 0===e&&(e=0),this.groups=null,this.groupLevels=0,this.__padding=e,this.__field=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this.__field._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.isOrdinal?null!=this.__field?0-this.padding():-.5:null!=this.__field?this.__field._minimum()-this.padding():-.5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.isOrdinal?null!=this.__field?this.__field._values.length-1+this.padding():.5:null!=this.__field?this.__field._maximum()+this.padding():.5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return null!=this.__field?this.__field._type:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOrdinal",{get:function(){return null==this.__isOrdinal&&(this.__isOrdinal=this.__field._type==t.core.DataType.String||this.__field._type==t.core.DataType.Boolean),this.__isOrdinal},set:function(t){this.__isOrdinal!=t&&(this.__isOrdinal=t)},enumerable:!0,configurable:!0}),e.prototype.padding=function(t){if(void 0===t)return this.isOrdinal?.5:this.__padding;this.__padding!=t&&(this.__padding=t)},Object.defineProperty(e.prototype,"valueCount",{get:function(){return null!=this.__field?this.__field._values.length:NaN},enumerable:!0,configurable:!0}),e.prototype._field=function(){return this.__field},e.prototype.labelFromValue=function(e,i){if(null!=this.__field){if(this.__field instanceof t.data._StringFieldInfo)return this.__field._values[e];if(this.__field instanceof t.data._BooleanFieldInfo)return this.__field._values[e].toString();if(this.__field instanceof t.data._NumberFieldInfo){if(this.isOrdinal&&(e=this.__field._values[e]),null!=(n=t.plugins._stringFormattingPlugin("Default")))if(null!=(r=n.create()))return r.format(i,e);return e.toString()}if(this.__field instanceof t.data._DateFieldInfo){this.isOrdinal&&(e=this.__field._values[e]);var n,r,o=new Date(e);if(null!=(n=t.plugins._stringFormattingPlugin("Default")))if(null!=(r=n.create()))return r.format(i,o);return o.toString()}return null}},e}();e._XSiteModel=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(e,i){this.__majorOrdinalSite=null,this.__seriesList=[],this.__min=NaN,this.__max=NaN,this.__name=null,this.__dataType=null,this.__valueCount=NaN,this.groups=null,this.groupLevels=0,this.__min=NaN,this.__seriesList=e;for(var n=[],r=!1,o=0,a=e;o<a.length;o++){var s=a[o];null!=s&&(null!=s.ySite.name&&s.ySite.name.length>0&&-1==n.indexOf(s.ySite.name)&&n.push(s.ySite.name),!r&&s.ySite.isOrdinal?(this.__majorOrdinalSite=s.ySite,this.__dataType=s.ySite.dataType,(isNaN(this.__valueCount)||this.__valueCount<s.ySite.valueCount)&&(this.__valueCount=s.ySite.valueCount)):s.ySite.isOrdinal?s.ySite.dataType==t.core.DataType.Number&&(this.__dataType=s.ySite.dataType):(r=!0,this.__majorOrdinalSite=null,this.__valueCount=NaN,this.__dataType=s.ySite.dataType),(isNaN(this.__min)||this.__min>s.ySite.min)&&(this.__min=s.ySite.min),(isNaN(this.__max)||this.__max<s.ySite.max)&&(this.__max=s.ySite.max),this.__min>0&&i==t.ShowNulls.Zeros&&s._containsNull()&&(this.__min=0))}if(n.length>0&&(this.__name=n.join(",")),this.__dataType==t.core.DataType.Number||this.__dataType==t.core.DataType.Date){var l=(this.__max-this.__min)/1.5;this.__min>0&&(this.__min=this.__min-l,this.__min<0&&(this.__min=0))}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.__name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.__min},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.__max},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return this.__dataType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOrdinal",{get:function(){return null!=this.__majorOrdinalSite},set:function(t){throw"Not support!"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){return this.__valueCount},enumerable:!0,configurable:!0}),e.prototype.labelFromValue=function(e,i){if(null!=this.__majorOrdinalSite)return this.__majorOrdinalSite.labelFromValue(e,i);var n=t.plugins._stringFormattingPlugin("Default");if(null!=n){var r=n.create();if(null!=r)return r.format(i,e)}return null},e}();e._YSiteModel=i}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){!function(e){var i=function(t){function e(e,i,n){var r=t.call(this,n)||this;return r.__children=[],r.__name=e,r.__value=i.toValue(n),r}return s(e,t),Object.defineProperty(e.prototype,"item",{get:function(){return this.__value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this.__color},set:function(t){this.__color!=t&&(this.__color=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.__name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.__value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this.__children},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tooltipContentSite",{get:function(){return new r(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataLabelContentSite",{get:function(){return new o(this)},enumerable:!0,configurable:!0}),e}(e._PointData);e._HierarchicalBasePointData=i;var n=function(){function n(i){if(this._root=null,this.defaultProperty="value",this.literalTokens=[],t._assertDebug(function(){return null!=i}),this._point=i,this._point instanceof e._HierarchicalRootPointData?this._root=this._point:this._point instanceof e._HierarchicalPointData&&(this._root=this._point._root()),null!=this._root){var n=this._root.parent._detailFields();this._details=[];for(var r=0;r<n.length&&r<i.depth;++r)this._details[r]=n[r]._name}}return Object.defineProperty(n.prototype,"stringFormatting",{get:function(){return this._root.parent.parent.parent._stringFormatting()},enumerable:!0,configurable:!0}),n.prototype.fromToken=function(e,i){var n=this,r=this._root.parent._option().config.tooltip.template;if(-1!=this._tokens.indexOf(e)){var o=this._details.indexOf(e);if(-1!=o){var a=this._getParent(this._point,o);if(null!=a)return{name:e,value:a.name}}if(null!=r){var s=this._root.parent._detailFields(),l=[];if(s instanceof Array)for(var u=0,h=s;u<h.length;u++){var c=h[u];c instanceof t.data._FieldInfo&&l.push(c._name)}if(!(l.indexOf(e)<0))return{name:e,value:""};var p={name:null,value:null,aggregate:null};if(this._root.parent._tooltipFields().some(function(i){if(i.name==e)return p.name=i.name,p.value=i.toItem(n._point.items),p.aggregate=t.Aggregate[i._aggregate],!0}))return p}}return null},n.prototype._getParent=function(t,e){if(null!=t){if(t.depth==e+1)return t;if(t.parent instanceof i)return this._getParent(t.parent,e)}return null},n}(),r=function(t){function e(e){var i=t.call(this,e)||this,n=i._root.parent._option().config.tooltip.template;if(null==n||n.length<=0)i._tokens=[],i._tokens=i._details;else{i._tokens=[];var r=i._root.parent._option().encodings.tooltip;if(r.length>0)for(var o=0,a=r;o<a.length;o++){var s=a[o];-1==i._tokens.indexOf(s.field)&&i._tokens.push(s.field)}}return i}return s(e,t),Object.defineProperty(e.prototype,"template",{get:function(){var t=this._root.parent._tooltipFields();if(null==t||t.length<=0)return null;var e=this._root.parent._option().config.tooltip.template;return null!=e?e:this._defaultTemplate()},enumerable:!0,configurable:!0}),e.prototype._defaultTemplate=function(){return this._root.parent._option().encodings.tooltip.length>0?this._tokens.map(function(t){return"{"+t+".name}:{"+t+".value}"}).join("\n"):null},e}(n),o=function(t){function e(e){var i=t.call(this,e)||this,n=i._root.parent._option().config.text.template;if(null==n||n.length<=0)i._tokens=[],i._tokens=i._details;else{i._tokens=[];var r=i._root.parent._option().encodings.text;if(r.length>0)for(var o=0,a=r;o<a.length;o++){var s=a[o];-1==i._tokens.indexOf(s.field)&&i._tokens.push(s.field)}}return i}return s(e,t),Object.defineProperty(e.prototype,"template",{get:function(){var t=this._root.parent._option().encodings.text;if(null==t||t.length<=0)return null;var e=this._root.parent._option().config.text.template;return null!=e?e:this._defaultTemplate()},enumerable:!0,configurable:!0}),e.prototype._defaultTemplate=function(){var t=this._root.parent._option().encodings.text,e=[];if(!(t.length>0))return null;for(var i=0,n=t;i<n.length;i++){var r=n[i];-1==e.indexOf(r.field)&&e.push(r.field)}return e.map(function(t){return"{"+t+".name}:{"+t+".value}"}).join("\n")},e}(n)}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t,e,n){var r=i.call(this,t,e,n)||this;return r.__textFields=[],r.__tooltipFields=[],r._analyseEncodings(),r.__root=r._createHierarchicalPoints(),r}return s(n,i),Object.defineProperty(n.prototype,"root",{get:function(){return this.__root},enumerable:!0,configurable:!0}),n.prototype._valueDefinition=function(){return this.__valueDefinition},n.prototype._detailFields=function(){return this.__detailFields},n.prototype._tooltipFields=function(){return this.__tooltipFields},n.prototype._analyseEncodings=function(){this.__valueDefinition=null;var e=this._createValueDefinitionList(this._option().encodings.values,t.Aggregate.Sum);if(e&&e.length>0)for(var i=0,n=e;i<n.length;i++){var r=n[i];if(r instanceof t.data._SingleAggregateValueDefinition){if(r._field instanceof t.data._NumberFieldInfo){this.__valueDefinition=r;break}}else if(r instanceof t.data._SingleValueDefinition&&r._field instanceof t.data._NumberFieldInfo){this.__valueDefinition=r;break}}this.__detailFields=this._createDetailFields(this._option().encodings.details,null),this.__textFields=this._createAggregateFields(this._option().encodings.text,t.Aggregate.List),this.__tooltipFields=this._createAggregateFields(this._option().encodings.tooltip,t.Aggregate.List)},n.prototype._createValueDefinition=function(e,i){if(null!=e&&null!=e.field&&"string"==typeof e.field){var n=e.field.split(",");if(n.length>0){var r=this.fields[n[0].trim()];if(null!=r)return new t.data._SingleAggregateValueDefinition(r,null==e.aggregate?t.Aggregate.Sum:e.aggregate)}}return null},n.prototype._createPoint=function(t,i,n,r){return new e._HierarchicalPointData(t,i,n,r)},n.prototype._createRootPoint=function(t,i,n,r){return new e._HierarchicalRootPointData(t,i,n,r)},n.prototype._createHierarchicalPoints=function(){var e=this._createRootPoint(this,"",this.__valueDefinition,this.items);if(this.__detailFields&&this.__detailFields.length>0){for(var i=new t.core.collections.CollectionView(this.items),n=0,r=this.__detailFields;n<r.length;n++){var o=r[n],a=new t.core.collections.PropertyGroupDescription(o._name);i.groupDescriptions.push(a)}for(var s=0;s<i.groups.length;s++){var l=this._createPointFromGroup(e,i.groups[s]);l.color=this.parent.parent._colorProvider().getColor(s),e.children.push(l)}}return e},n.prototype._createPointFromGroup=function(t,e){var i=this._createPoint(t,e.name,this.__valueDefinition,e._items);if(null!=e.groups&&e.groups.length>0)for(var n=0,r=e.groups;n<r.length;n++){var o=r[n];null!=o.name&&i.children.push(this._createPointFromGroup(i,o))}return i},Object.defineProperty(n.prototype,"legends",{get:function(){return[]},enumerable:!0,configurable:!0}),n}(e._PlotData);e._HierarchicalPlotData=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t,e,n,r){var o=i.call(this,e,n,r)||this;return o.__parent=t,o}return s(n,i),Object.defineProperty(n.prototype,"style",{get:function(){return null==this.__style&&(this.__style=new t.options._DataPointStyleOption(this._root().parent._option().config.style)),this.__style},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"depth",{get:function(){return this.parent.depth+1},enumerable:!0,configurable:!0}),n.prototype._root=function(){return this.parent instanceof n?this.parent._root():this.parent instanceof e._HierarchicalRootPointData?this.parent:null},n.prototype._top=function(){return this.parent instanceof n?this.parent._top():this.parent instanceof e._HierarchicalRootPointData?this:null},n}(e._HierarchicalBasePointData);e._HierarchicalPointData=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t,i,n,r){var o=e.call(this,i,n,r)||this;return o.__parent=t,o}return s(i,e),Object.defineProperty(i.prototype,"style",{get:function(){return null==this.__style&&(this.__style=new t.options._DataPointStyleOption(this.parent._option().config.style)),this.__style},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"depth",{get:function(){return 0},enumerable:!0,configurable:!0}),i.prototype._root=function(){return this},i}(e._HierarchicalBasePointData);e._HierarchicalRootPointData=i}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),r||(r={}),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){!function(e){var i=function(){function e(e){this.__option=new t.options._LegendOption(e)}return Object.defineProperty(e.prototype,"hidden",{get:function(){return null==this.__hidden?null!=this._option().hidden?this._option().hidden:null!=this.parent._option().legend.hidden?this.parent._option().legend.hidden:!!this.parent.parent._option().legend.hidden&&this.parent.parent._option().legend.hidden:this.__hidden},set:function(t){this.hidden!=t&&(this.__hidden=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orientation",{get:function(){return null!=this._option().orientation?this._option().orientation:null!=this.parent._option().legend.orientation?this.parent._option().legend.orientation:this.parent.parent._option().legend.orientation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return null!=this._option().position?this._option().position:null!=this.parent._option().legend.position?this.parent._option().legend.position:null!=this.parent.parent._option().legend.position?this.parent.parent._option().legend.position:t.Position.Right},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titlePosition",{get:function(){return t.Position.Top},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){return t.Position.Right},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipsize",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemPadding",{get:function(){return 20},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"wrapping",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backgroundColor",{get:function(){return this._option().style.backgroundColor?this._option().style.backgroundColor:this.parent._option().legend.style.backgroundColor?this.parent._option().legend.style.backgroundColor:this.parent.parent._option().legend.style.backgroundColor?this.parent.parent._option().legend.style.backgroundColor:"none"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"borderStyle",{get:function(){var t={opacity:void 0,stroke:void 0,strokeWidth:void 0,strokeDasharray:void 0};return this._option().style.borderStyle.opacity?t.opacity=this._option().style.borderStyle.opacity:this.parent._option().legend.style.borderStyle.opacity?t.opacity=this.parent._option().legend.style.borderStyle.opacity:this.parent.parent._option().legend.style.borderStyle.opacity&&(t.opacity=this.parent.parent._option().legend.style.borderStyle.opacity),this._option().style.borderStyle.stroke?t.stroke=this._option().style.borderStyle.stroke:this.parent._option().legend.style.borderStyle.stroke?t.stroke=this.parent._option().legend.style.borderStyle.stroke:this.parent.parent._option().legend.style.borderStyle.stroke&&(t.stroke=this.parent.parent._option().legend.style.borderStyle.stroke),this._option().style.borderStyle.strokeWidth?t.strokeWidth=this._option().style.borderStyle.strokeWidth:this.parent._option().legend.style.borderStyle.strokeWidth?t.strokeWidth=this.parent._option().legend.style.borderStyle.strokeWidth:this.parent.parent._option().legend.style.borderStyle.strokeWidth&&(t.strokeWidth=this.parent.parent._option().legend.style.borderStyle.strokeWidth),this._option().style.borderStyle.strokeDasharray?t.strokeDasharray=this._option().style.borderStyle.strokeDasharray:this.parent._option().legend.style.borderStyle.strokeDasharray?t.strokeDasharray=this.parent._option().legend.style.borderStyle.strokeDasharray:this.parent.parent._option().legend.style.borderStyle.strokeDasharray&&(t.strokeDasharray=this.parent.parent._option().legend.style.borderStyle.strokeDasharray),t},enumerable:!0,configurable:!0}),e.prototype._option=function(){return this.__option},e}();e._Legend=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(t){var e=function(){return function(t){this.title=t}}();t._LegendItem=e}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.render=function(e,i){var n={opacity:this._style.symbolOpacity,fill:this._style.symbolFill,stroke:this._style.symbolStroke,strokeWidth:this._style.symbolStrokeWidth,strokeDasharray:this._style.symbolStrokeDasharray};if(null!=this._shape){var r=t.plugins._symbolPlugin(this._shape);if(null!=r){var o=r.create();return o._color=this._color,void o.render(e,i,n)}}var a=i.width<i.height?i.width/2:i.height/2;e.drawEllipse((i.right+i.left)/2,(i.top+i.bottom)/2,a,a,null,t.core.merge({fill:this._color,stroke:this._color,strokeWidth:0},n))},e}();e._LegendSymbol=i}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){!function(e){var i=function(){function i(e){this._valuesNameLegend=null,t._assertDebug(function(){return null!=e}),this.__plotArea=e}return i.prototype._plotArea=function(){return this.__plotArea},i.prototype._colorProvider=function(){return this._plotArea().parent._colorProvider()},i.prototype._symbolProvider=function(){return this._plotArea().parent._symbolProvider()},i.prototype._applySeries=function(i,n){null!=i&&(null==this.__seriesLegend&&(this.__seriesLegend=new e._SeriesLegend(this,new t.options._LegendOption({}))),this.__seriesLegend._applySeries(i,this._plotArea()._paletteOffset)&&(n&&(null==this._valuesNameLegend&&(this._valuesNameLegend=new e._SeriesLegend(this,new t.options._LegendOption({}))),this._valuesNameLegend._applySeries(i,this._plotArea()._paletteOffset)),this._plotArea()._paletteOffset++))},i.prototype._findSeriesLegendItem=function(t){return null!=t&&null!=this.__seriesLegend?this.__seriesLegend._findLegendItem(t):null},i}();e._PlotAreaLegendManager=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function i(e){this._items=[],t._assertDebug(function(){return null!=e}),this.__plot=e}return i.prototype._plot=function(){return this.__plot},i.prototype._colorProvider=function(){return this._plot().parent.parent._colorProvider()},i.prototype._symbolProvider=function(){return this._plot().parent.parent._symbolProvider()},i.prototype._applyColorField=function(i,n){if(void 0===n&&(n=null),null!=i){var r,o=this._plot().parent._option().legends;if(null!=o&&o.length>0)for(var a=0,s=o;a<s.length;a++){var l=s[a];if(l.type==t.LegendType.Color){r=l;break}}var u=this._findPointLegend(i);null==u&&(u=new e._PointLegend(this,i,r,n),this._items.push(u)),n&&(u.hidden=!1),isNaN(u._paletteOffset())&&(u._applyColor(this._plot().parent._paletteOffset),this._plot().parent._paletteOffset+=u.items.length)}},i.prototype._applySizeField=function(i){if(null!=i){var n,r=this._plot().parent._option().legends;if(null!=r&&r.length>0)for(var o=0,a=r;o<a.length;o++){var s=a[o];if(s.type==t.LegendType.Size){n=s;break}}var l=this._findPointLegend(i);null==l&&(l=new e._PointLegend(this,i,n),this._items.push(l)),l._applySize()}},i.prototype._applyShapeField=function(i,n){if(void 0===n&&(n=null),null!=i){var r,o=this._plot().parent._option().legends;if(null!=o&&o.length>0)for(var a=0,s=o;a<s.length;a++){var l=s[a];if(l.type==t.LegendType.Size){r=l;break}}var u=this._findPointLegend(i);null==u&&(u=new e._PointLegend(this,i,r),this._items.push(u)),u._applyShape(n)}},i.prototype._findPointLegend=function(t){if(null==t)return null;for(var i=0,n=this._items;i<n.length;i++){var r=n[i];if(r instanceof e._PointLegend&&r._field._name==t._name)return r}return null},i.prototype._findPointLegendItem=function(t,e){if(null!=t){var i=this._findPointLegend(t);if(null!=i)return i._findLegendItem(e)}return null},i}();e._PlotLegendManager=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(i){function r(r,o,a,s){void 0===s&&(s=null);var l=i.call(this,a)||this;if(l.__paletteOffset=NaN,l.__items=[],t._assertDebug(function(){return null!=r}),l.__legendManager=r,t._assertDebug(function(){return null!=o}),l._field=o,null!=s&&(l.hidden=!s),l._field._type==t.core.DataType.String||l._field._type==t.core.DataType.Boolean)for(var u=l._field,h=0;h<u._values.length;h++){var c=u._values[h].toString();l.items.push(new n(l,c,{start:h,to:h+1}))}else if(l._field._type==t.core.DataType.Number||l._field._type==t.core.DataType.Date){var p=l._field;if(l._option()&&l._option().ranges&&Array.isArray(l._option().ranges)){l._option().ranges.sort(function(t,e){return null==t.to?1:null==e.to?-1:t.to>e.to?1:t.to<e.to?-1:0});for(var f=Number.MIN_VALUE,_=0,d=l._option().ranges;_<d.length;_++){var g=d[_];g.to?(l.items.push(new n(l,g.title,{start:f,to:g.to})),f=g.to):l.items.push(new n(l,g.title,{start:f,to:Number.MAX_VALUE}))}}else{var y=new e._NumberTicksGenerator(p._minimum(),p._maximum(),5,!0);y._min<y.ticks[0]&&l.items.push(new n(l,y.ticks.toString(),{start:y._min,to:y.ticks[0]}));for(f=y.ticks[0],h=1;h<y.ticks.length;h++){var m=y.ticks[h];l.items.push(new n(l,m.toString(),{start:f,to:m})),f=m}f<y._max&&l.items.push(new n(l,y._max.toString(),{start:f,to:y._max}))}}else t._assertDebug(function(){return!1});return l}return s(r,i),Object.defineProperty(r.prototype,"parent",{get:function(){return this._legendManager()._plot().parent},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"title",{get:function(){var e=this._option()?t.core.asString(this._option().title,!0):null;return null==e&&(e=this._field._name),e},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"items",{get:function(){return this.__items},enumerable:!0,configurable:!0}),r.prototype._style=function(){return this._legendManager()._plot()._plotView().config.style},r.prototype._legendManager=function(){return this.__legendManager},r.prototype._paletteOffset=function(){return this.__paletteOffset},r.prototype._applyColor=function(t){this.__paletteOffset=t;for(var e=0,i=this.items;e<i.length;e++){var n=i[e];n.color=this._legendManager()._colorProvider().getColor(this.__paletteOffset+this.items.indexOf(n))}},r.prototype._applyShape=function(t){void 0===t&&(t=null);for(var e=0,i=this.items;e<i.length;e++){var n=i[e];n.shape=null!=t?t:this._legendManager()._symbolProvider().getSymbol(this.items.indexOf(n))}},r.prototype._applySize=function(){for(var t=0,e=this.items;t<e.length;t++){var i=e[t];i.size=10+10*this.items.indexOf(i)}},r.prototype._findLegendItem=function(t){if(this.__items.length<=0)return null;for(var e=0,i=this.__items;e<i.length;e++){var n=i[e];if(n._range.start<=t&&t<n._range.to)return n}var r=this.__items[this.__items.length-1];return r._range.start<=t&&t<=r._range.to?r:null},r}(e._Legend);e._PointLegend=i;var n=function(t){function i(e,i,n){var r=t.call(this,i)||this;return r.__parent=e,r._range=n,r}return s(i,t),Object.defineProperty(i.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"style",{get:function(){return this.parent._style()},enumerable:!0,configurable:!0}),i.prototype._symbol=function(){var t=this.parent._legendManager()._plot()._legendSymbol();return null==t&&(t=new e._LegendSymbol),t._color=this.color,t._shape=this.shape,t},i}(e._LegendItem)}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(i,n){var r=e.call(this,n)||this;return r.__items=[],t._assertDebug(function(){return null!=i}),r.__legendManager=i,r}return s(i,e),Object.defineProperty(i.prototype,"parent",{get:function(){return this._legendManager()._plotArea()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this._option()?t.core.asString(this._option().title,!0):null},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"items",{get:function(){return this.__items},enumerable:!0,configurable:!0}),i.prototype._legendManager=function(){return this.__legendManager},i.prototype._applySeries=function(t,e){for(var i=0,r=this.__items;i<r.length;i++){if(r[i]._series()==t)return!1}return this.items.push(new n(this,t,this._legendManager()._colorProvider().getColor(e))),!0},i.prototype._findLegendItem=function(t){for(var e=0,i=this.__items;e<i.length;e++){var n=i[e];if(n._series()==t)return n}return null},i}(e._Legend);e._SeriesLegend=i;var n=function(t){function i(e,i,n){var r=t.call(this,i.valueDefinition.name)||this;return r.__parent=e,r.__series=i,r.color=n,r}return s(i,t),Object.defineProperty(i.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"style",{get:function(){return this._series().parent._plotView().config.style},enumerable:!0,configurable:!0}),i.prototype._series=function(){return this.__series},i.prototype._symbol=function(){var t=this.__series.parent._legendSymbol();return null==t&&(t=new e._LegendSymbol),t._color=this.color,t._shape=this.shape,t},i}(e._LegendItem)}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(t){this.__formats=t}return e.prototype._formats=function(){return this.__formats},e.prototype._parseDate=function(t){if(null!=t&&"string"==typeof t)for(var e=0,i=this._formats();e<i.length;e++){var n=i[e],r=this._dateParser().parse(t,n);if(null!=r)return r}return null},e.prototype._dateParser=function(){if(null==this.__dateParser){var e=t.plugins._dateParserPlugin("Default");e&&(this.__dateParser=e.create())}return this.__dateParser},e}();e._DateStringParser=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(){}return t.prototype.render=function(t,e){for(var i=0,n=e;i<n.length;i++){var r=n[i];t.drawRect(r.x-3,r.y-3,6,6,null,{fill:"transparent",stroke:"#80A3BE",storkeWidth:1})}},t}();t._BoxAdornerRender=e}(t.models||(t.models={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(){}return t.prototype.render=function(t,e){for(var i=0,n=e;i<n.length;i++){var r=n[i];t.drawEllipse(r.x,r.y,3,3,null,{fill:"#B3D6F2",stroke:"#047AD8",strokeWidth:1})}},t}();t._DotAdornerRender=e}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(e){!function(i){var n=function(){function i(t){this.__option=t,null!=t.condition&&t.condition.length>0&&null!=t.actions&&t.actions.length>0?this.__proxy=this._generateCalcSourceProxy():this.__proxy=null}return i.prototype._option=function(){return this.__option},i.prototype._current=function(){return this.__current},i.prototype.evaluate=function(t){e._isCalculationEngineExist&&null!=this.__proxy&&(this.__current=t,this.__proxy.getCalcSourceModel().setFormulaByName("condition",this._option().condition))},i.prototype._isIdentityExpression=function(t){return"current"==t||t.length>8&&"current."==t.substring(0,8)||("parent"==t||t.length>5&&"parent."==t.substring(0,5))},i.prototype._getValue=function(t){return("parent"==t||t.length>7&&"parent."==t.substring(0,7))&&(t="current."+t),"current"==t?this._current():t.length>8&&"current."==t.substring(0,8)&&null!=this._current()?new e.core.Binding(t.substring(8)).getValue(this._current()):void 0},i.prototype._applyActions=function(){for(var t=0,e=this._option().actions;t<e.length;t++){var i=e[t],n=this._findActionTarget(i);if(null!=n)new r(i)._apply(n)}},i.prototype._findActionTarget=function(t){return this._current()},i.prototype._generateCalcSourceProxy=function(){return e._isCalculationEngineExist?new(function(i){function n(n){var r=i.call(this,new t.Spread.CalcEngine.CalcService)||this;return e._assertDebug(function(){return null!=n}),r.__rule=n,r.getCalcService().getSourceModel(r),r}return s(n,i),n.prototype.getParserContext=function(e,i,n){var r=this,o=new t.Spread.CalcEngine.ParserContext(this,e,i||{},n),a=new t.Spread.CalcEngine.TokenResolver(7e3);return a.resolveToken=function(e,i,n,o){var a=n[o],s=a._stringValue;if(0===a._type&&0===a._subType&&r.__rule._isIdentityExpression(s)){var l=new t.Spread.CalcEngine.Expression(25);return l.value=s,l}},o.addResolver(a),o},n.prototype.getEvaluatorContext=function(e,i,n){var r=new t.Spread.CalcEngine.EvaluateContext(this,e,i,n),o=this;return r.evaluate=function(t,e,i){return this.getValue(o,t.value)},r},n.prototype.getValueByName=function(t){return""},n.prototype.setValueByName=function(t,i){"CONDITION"==t?1==i&&this.__rule._applyActions():e._assertDebug(function(){return!1})},n.prototype.getValue=function(t){return this.__rule._getValue(t)},n}(t.Spread.CalcEngine.CalcSource))(this):null},i}();i._ConditionalFormattingRule=n;var r=function(){function t(t){this._option=t}return t.prototype._apply=function(t){for(var i=0,n=this._option.properties;i<n.length;i++){var r=n[i];new e.core.Binding(r.name).setValue(t,r.value)}},t}()}(e.models||(e.models={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return s(n,i),n.prototype._isIdentityExpression=function(t){return"index"==t||("previous"==t||t.length>9&&"previous."==t.substring(0,9)||("next"==t||t.length>5&&"next."==t.substring(0,5)||("parent"==t||t.length>5&&"parent."==t.substring(0,5)||i.prototype._isIdentityExpression.call(this,t))))},n.prototype._getValue=function(n){var r=this._current();if(r instanceof e._XyValuePointData||r instanceof e._XyRangeValuePointData){if("index"==n)return this._index(r);if("previous"==n)return this._previous(r);if(n.length>9&&"previous."==n.substring(0,9)&&null!=this._previous(r))return new t.core.Binding(n.substring(9)).getValue(this._previous(r));if("next"==n)return this._next(r);if(n.length>5&&"next."==n.substring(0,5)&&null!=this._next(r))return new t.core.Binding(n.substring(5)).getValue(this._next(r))}return i.prototype._getValue.call(this,n)},n.prototype._findActionTarget=function(t){return"DataPoint"==t.targetElement?this._current():null},n.prototype._previous=function(t){var e=t.parent,i=this._index(t);return i>0?e.dataPoints[i-1]:void 0},n.prototype._next=function(t){var e=t.parent,i=this._index(t);return i<e.dataPoints.length-1?e.dataPoints[i+1]:void 0},n.prototype._index=function(t){return t.parent.dataPoints.indexOf(t)},n}(e._ConditionalFormattingRule);e._DataPointConditionalFormattingRule=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return s(n,i),n.prototype._isIdentityExpression=function(t){return"index"==t||("previous"==t||t.length>9&&"previous."==t.substring(0,9)||("next"==t||t.length>5&&"next."==t.substring(0,5)||("parent"==t||t.length>5&&"parent."==t.substring(0,5)||i.prototype._isIdentityExpression.call(this,t))))},n.prototype._getValue=function(n){if(this._current()instanceof e._XyValueSeriesData||this._current()instanceof e._XyRangeValueSeriesData){if("index"==n)return this._index(this._current());if("previous"==n)return this._previous(this._current());if(n.length>9&&"previous."==n.substring(0,9)&&null!=this._previous(this._current()))return new t.core.Binding(n.substring(9)).getValue(this._previous(this._current()));if("next"==n)return this._next(this._current());if(n.length>5&&"next."==n.substring(0,5)&&null!=this._next(this._current()))return new t.core.Binding(n.substring(5)).getValue(this._next(this._current()))}return i.prototype._getValue.call(this,n)},n.prototype._findActionTarget=function(t){return"Group"==t.targetElement?this._current():null},n.prototype._previous=function(t){var e=t.parent,i=this._index(t);return i>0?e.dataSeriesList[i-1]:void 0},n.prototype._next=function(t){var e=t.parent,i=this._index(t);return i<e.dataSeriesList.length-1?e.dataSeriesList[i+1]:void 0},n.prototype._index=function(t){return t.parent.dataSeriesList.indexOf(t)},n}(e._ConditionalFormattingRule);e._GroupConditionalFormattingRule=i}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.toHtml=function(t){var e=this._translateTemplate(t);return e?e.replace(/\n/g,"<br />"):""},e.prototype.toLines=function(t){var e=this._translateTemplate(t);return e?e.split("\n"):[]},e.prototype._translateTemplate=function(t){if(null==t)return null;var e=t.template;if(null==e)return null;var i=/\{\s*(\w+)(\[(\d+)\])?(\.\w*)*\s*(\:\s*.+?)*\s*\}/g,n=e.match(i);if(null!=n&&n.length>0)for(var r=0,o=n;r<o.length;r++){var a=o[r],s=(i=/\{\s*(\w+)(\[(\d+)\])?((\.\w*)*)\s*(\:\s*(.+))*\s*\}/g).exec(a);if(null!=s){var l=s[3]?parseInt(s[3]):0,u=this._translateToken(t,s[1],l,s[4],s[7]);e=e.replace(a,u||"")}}return e},e.prototype._translateToken=function(e,i,n,r,o){var a=e.fromToken(i,n);if(null==a)return"";var s=(r?new t.core.Binding(r.substring(1)):new t.core.Binding(e.defaultProperty)).getValue(a);if(null==s)return"";null==o&&e.literalTokens.some(function(t){return t.name==i&&(o=t.defaultFormat,!0)}),null==o&&(t.core.isNumber(s)?o=e.stringFormatting.defaultFormat(t.core.DataType.Number,!1):t.core.isDate(s)&&(o=e.stringFormatting.defaultFormat(t.core.DataType.Date,!1)));try{var l=e.__point.__items[0].xFormat;"x"===i&&l&&(o=l)}catch(t){console.log(t)}return"string"==typeof i&&i.indexOf("value")>-1||!t.core.isNumber(s)&&!t.core.isDate(s)?s.toString():e.stringFormatting.format(o,s)},e}();e._DataContentProvider=i}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),r||(r={}),function(t){!function(e){var i=function(){function e(){}return e.prototype.parse=function(e,i){return t.core.Globalize.parseDate(e,i)},e}();e._DateParser=i}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){!function(e){var i=function(){function i(i,n){void 0===n&&(n=!0),this.__opacity=1,this.__strokeWidth=1,this.__fontSize=null,this.__fontFamily=null,this.__devicePixelRatio=NaN,this.__fontSizeWithPixel=null,this._applyCanvasClip=function(t,e){var i=this._canvasRect[e];i&&(t.beginPath(),t.rect(i.left,i.top,i.width,i.height),t.clip(),t.closePath())},this._applyCanvasStyles=function(e,i,n,r,o){var a,s,l=this.__canvasElement.getContext("2d"),u=this.stroke,h=this.fill,c=this.opacity,p=this.strokeWidth,f=this.strokeDasharray;if(i&&void 0!==i.opacity&&(c=i.opacity),i&&void 0!==i.stroke&&(u=i.stroke),i&&void 0!==i.strokeDasharray&&(f=i.strokeDasharray),i&&void 0!==i.fill&&(h=this._getOpacityColor(i.fill,i["fill-opacity"])),e&&((s=t.core.cloneDeep(window.getComputedStyle(e))).fontFamily=this._convertFontFamily(s.fontFamily)),o)s?(l.globalAlpha=c,l.fillStyle=s.fill,a=s.fontStyle+" "+s.fontSize+" "+s.fontFamily,l.font=a,l.font.replace(/\"/g,"'")!==a.replace(/\"/g,"'")&&(a=s.fontStyle+" "+s.fontSize+" "+(l.font.split(" ").splice(1).join(" ")||"sans-serif"),l.font=a)):this.__fontSizeWithPixel?(l.globalAlpha=c,l.fillStyle=this.textFill,l.font=this.__fontSizeWithPixel+" "+(this.fontFamily||"sans-serif")):this._canvasDefaultFont&&(l.globalAlpha=c,l.fillStyle=this._canvasDefaultFont.textFill,a=this._canvasDefaultFont.fontSize+" "+this._canvasDefaultFont.fontFamily,l.font=a,l.font.replace(/\"/g,"'")!==a.replace(/\"/g,"'")&&(a=this._canvasDefaultFont.fontSize+" "+(l.font.split(" ")[1]||"sans-serif"),l.font=a));else{if(s){var _=s;if(u=s.stroke&&"none"!==s.stroke?s.stroke:u,h=s.fill&&"none"!==s.fill?this._getOpacityColor(s.fill,_["fill-opacity"]):h,p=s.strokeWidth?s.strokeWidth:p,f=s.strokeDasharray?s.strokeDasharray:f,t.core.isString(p)){var d=t.core.asString(p);d=d.replace("px",""),p=parseFloat(d)}}null!=c&&"none"!==c&&(l.globalAlpha=c),r&&null!=h&&"transparent"!==h&&"none"!==h&&(l.fillStyle=h,l.fill()),"none"!==u&&null!=u&&0!==p&&(l.strokeStyle=u,l.lineWidth=p,null!=f&&"none"!==f&&(f=f.match(/\d+(\.\d+)?/g),l.setLineDash(f)),l.stroke())}},this.__htmlElement=i;this.__canvasElement=document.createElement("canvas"),this.__svgEngine=new e._SvgRenderEngine(i),this.__htmlElement.appendChild(this.__canvasElement),this._applyCSSStyles=n}return Object.defineProperty(i.prototype,"opacity",{get:function(){return this.__opacity},set:function(t){this.__svgEngine.opacity=t,this.__opacity=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this.__fill},set:function(t){this.__svgEngine.fill=t,this.__fill=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this.__stroke},set:function(t){this.__svgEngine.stroke=t,this.__stroke=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"strokeWidth",{get:function(){return this.__strokeWidth},set:function(t){this.__svgEngine.strokeWidth=t,this.__strokeWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"strokeDasharray",{get:function(){return this.__strokeDasharray},set:function(t){this.__svgEngine.strokeDasharray=t,this.__strokeDasharray=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textFill",{get:function(){return this.__textFill},set:function(t){this.__svgEngine.textFill=t,this.__textFill=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this.__fontSize},set:function(t){this.__svgEngine.fontSize=t,this.__fontSize=t,this.__fontSizeWithPixel=null==t||isNaN(t)?t:t+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fontFamily",{get:function(){return this.__fontFamily},set:function(t){this.__svgEngine.fontFamily=t,this.__fontFamily=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"element",{get:function(){return this.__canvasElement},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"devicePixelRatio",{get:function(){return this.__devicePixelRatio},set:function(t){isNaN(t)||null==t||(this.__devicePixelRatio=t)},enumerable:!0,configurable:!0}),i.prototype.beginRender=function(){var t,e=this.__svgEngine.element,i=this.__htmlElement;this._applyCSSStyles&&(this.__svgEngine.beginRender(),i=e),this.__htmlElement.appendChild(e),this._canvasRect={},t=window.getComputedStyle(i),this._canvasDefaultFont={fontSize:t.fontSize,fontFamily:t.fontFamily,textFill:t.color}},i.prototype.endRender=function(){this._applyCSSStyles&&this.__svgEngine.endRender(),this.__svgEngine.element.parentNode.removeChild(this.__svgEngine.element)},i.prototype.setViewportSize=function(t,e){var i,n,r=this.__canvasElement,o=(r.getContext("2d"),this.fill),a=window.devicePixelRatio||1;a=a<1?1:a,null==this.__devicePixelRatio||isNaN(this.__devicePixelRatio)||(a=this.__devicePixelRatio),this._applyCSSStyles&&this.__svgEngine.setViewportSize(t,e),r.width=t*a,r.height=e*a,r.style.width=t+"px",r.style.height=e+"px",r.getContext("2d").scale(a,a),i=window.getComputedStyle(this.__htmlElement).backgroundColor,n=this.stroke,i&&(this.stroke=null,this.fill=i,this.drawRect(0,0,t,e),this.fill=o,this.stroke=n)},i.prototype.addClipRect=function(t,e){t&&e&&(this._applyCSSStyles&&this.__svgEngine.addClipRect(t,e),this._canvasRect[e]=t)},i.prototype.drawEllipse=function(t,e,i,n,r,o){var a,s=this.__canvasElement.getContext("2d");return this._applyCSSStyles&&(a=this.__svgEngine.drawEllipse(t,e,i,n,r,o)),s.save(),s.beginPath(),s.ellipse?s.ellipse(t,e,i,n,0,0,2*Math.PI):(s.translate(t,e),s.scale(1,n/i),s.translate(-t,-e),s.arc(t,e,i,0,2*Math.PI),s.scale(1,1)),this._applyCanvasStyles(a,o,r,!0),s.restore(),a},i.prototype.drawRect=function(t,e,i,n,r,o,a){var s,l=this.__canvasElement.getContext("2d");return this._applyCSSStyles&&(s=this.__svgEngine.drawRect(t,e,i,n,r,o,a)),l.save(),this._applyCanvasClip(l,a),l.beginPath(),l.rect(t,e,i,n),this._applyCanvasStyles(s,o,r,!0),l.restore(),s},i.prototype.drawLine=function(t,e,i,n,r,o){var a,s=this.__canvasElement.getContext("2d");return this._applyCSSStyles&&(a=this.__svgEngine.drawLine(t,e,i,n,r,o)),s.save(),s.beginPath(),s.moveTo(t,e),s.lineTo(i,n),this._applyCanvasStyles(a,o,r),s.restore(),a},i.prototype.drawLines=function(t,e,i,n,r){if(t&&e&&0!==t.length&&0!==e.length){var o,a,s=this.__canvasElement.getContext("2d"),l=Math.min(t.length,e.length);for(this._applyCSSStyles&&(o=this.__svgEngine.drawLines([0,1],[1,0],i,n,r)),s.save(),this._applyCanvasClip(s,r),s.beginPath(),s.moveTo(t[0],e[0]),a=1;a<l;a++)s.lineTo(t[a],e[a]);return this._applyCanvasStyles(o,n,i),s.restore(),o}},i.prototype.drawSplines=function(e,i,n,r,o){if(e&&i&&0!==e.length&&0!==i.length){var a,s,l=this.__canvasElement.getContext("2d"),u=new t._Spline(e,i).calculate(),h=u.xs,c=u.ys,p=Math.min(h.length,c.length);for(this._applyCSSStyles&&(a=this.__svgEngine.drawSplines([0,1],[1,0],n,r,o)),l.save(),this._applyCanvasClip(l,o),l.beginPath(),l.moveTo(h[0],c[0]),s=1;s<p;s++)l.lineTo(h[s],c[s]);return this._applyCanvasStyles(a,r,n),l.restore(),a}},i.prototype.drawPolygon=function(t,e,i,n,r){if(t&&e&&0!==t.length&&0!==e.length){var o,a,s=this.__canvasElement.getContext("2d"),l=Math.min(t.length,e.length);for(this._applyCSSStyles&&(o=this.__svgEngine.drawPolygon([0,1,1],[1,0,1],i,n,r)),s.save(),this._applyCanvasClip(s,r),s.beginPath(),s.moveTo(t[0],e[0]),a=1;a<l;a++)s.lineTo(t[a],e[a]);return s.closePath(),this._applyCanvasStyles(o,n,i,!0),s.restore(),o}},i.prototype.drawPieSegment=function(t,e,i,n,r,o,a,s){var l,u=this.__canvasElement.getContext("2d"),h=n,c=n+r;return this._applyCSSStyles&&(l=this.__svgEngine.drawPieSegment(t,e,i,n,r,o,a,s)),u.save(),this._applyCanvasClip(u,s),u.beginPath(),u.moveTo(t,e),u.arc(t,e,i,h,c,!1),u.lineTo(t,e),this._applyCanvasStyles(l,a,o,!0),u.restore(),l},i.prototype.drawDonutSegment=function(e,i,n,r,o,a,s,l,u){var h,c,p,f=this.__canvasElement.getContext("2d"),_=o,d=o+a;return this._applyCSSStyles&&(h=this.__svgEngine.drawDonutSegment(e,i,n,r,o,a,s,l,u)),(c=new t.core.Point(e,i)).x+=r*Math.cos(_),c.y+=r*Math.sin(_),(p=new t.core.Point(e,i)).x+=r*Math.cos(d),p.y+=r*Math.sin(d),f.save(),this._applyCanvasClip(f,u),f.beginPath(),f.moveTo(c.x,c.y),f.arc(e,i,n,_,d,!1),f.lineTo(p.x,p.y),f.arc(e,i,r,d,_,!0),this._applyCanvasStyles(h,l,s,!0),f.restore(),h},i.prototype.drawString=function(t,e,i,n){if(null!=t){var r,o=this.__canvasElement.getContext("2d");return this._applyCSSStyles&&(r=this.__svgEngine.drawString(t,e,i,n)),o.save(),o.textBaseline="bottom",this._applyCanvasStyles(r,n,i,!0,!0),o.fillText(t.trim(),e.x,e.y),o.restore(),r}},i.prototype.drawStringRotated=function(t,e,i,n,r,o){if(null!=t){var a,s=this.__canvasElement.getContext("2d");s.measureText(t);return this._applyCSSStyles&&(a=this.__svgEngine.drawStringRotated(t,e,i,n,r,o)),s.save(),s.textBaseline="bottom",s.translate(i.x,i.y),s.rotate(Math.PI/180*n),s.translate(-i.x,-i.y),this._applyCanvasStyles(a,o,r,!0,!0),s.fillText(t,e.x,e.y),s.restore(),a}},i.prototype.measureString=function(e,i,n,r){var o,a=this.__canvasElement.getContext("2d");return this._applyCSSStyles?this.__svgEngine.measureString(e,i,n,r):(this._applyCanvasStyles(null,null,i,!0,!0),o=a.measureText(e).width,new t.core.Size(o,1.5*parseInt(a.font)))},i.prototype.startGroup=function(t,e,i){void 0===i&&(i=!1);var n,r=this.__canvasElement.getContext("2d");return this._applyCSSStyles&&(n=this.__svgEngine.startGroup(t,e,i)),r.save(),this._applyCanvasClip(r,e),n},i.prototype.endGroup=function(){this._applyCSSStyles&&this.__svgEngine.endGroup(),this.__canvasElement.getContext("2d").restore()},i.prototype.drawImage=function(t,e,i,n,r){var o,a=this.__canvasElement.getContext("2d"),s=new Image;return this._applyCSSStyles&&(o=this.__svgEngine.drawImage(t,e,i,n,r)),s.onload=function(){a.drawImage(s,e,i,n,r)},s.src=t,o},i.prototype._getOpacityColor=function(e,i){"none"==e&&(e="transparent");var n=new t.core.Color(e);return null!=i&&1===n.a&&(n.a=isNaN(i)?1:Number(i)),n.toString()},i.prototype._convertFontFamily=function(t){var e=t;return e&&'"'===e[0]&&(e=e.substring(1)),e&&'"'===e[e.length-1]&&(e=e.slice(0,-1)),e},i}();e._CanvasRenderEngine=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(t,e){void 0===e&&(e=!1),this.__opacity=1,this.__strokeWidth=1,this.__fontSize=null,this.__fontFamily=null,this.__devicePixelRatio=NaN,this.__fontSizeWithPixel=null,this._applyCanvasClip=function(t,e){var i=this._canvasRect[e];i&&(t.beginPath(),t.rect(i.left,i.top,i.width,i.height),t.clip(),t.closePath())},this._applyCanvasStyles=function(t,e,i,n,r){var o,a=this.__canvasElement.getContext("2d"),s=this.stroke,l=this.fill,u=this.opacity,h=this.strokeWidth,c=this.strokeDasharray;e&&void 0!==e.opacity&&(u=e.opacity),e&&void 0!==e.stroke&&(s=e.stroke),e&&void 0!==e.strokeDasharray&&(c=e.strokeDasharray),e&&void 0!==e.fill&&(l=this._getOpacityColor(e.fill,e["fill-opacity"])),e&&void 0!==e.strokeWidth&&(h=e.strokeWidth),r?this.__fontSizeWithPixel?(a.globalAlpha=u,a.fillStyle=this.textFill,a.font=this.__fontSizeWithPixel+" "+(this.fontFamily||"sans-serif")):this._canvasDefaultFont&&(a.globalAlpha=u,a.fillStyle=this._canvasDefaultFont.textFill,o=this._canvasDefaultFont.fontSize+" "+this._canvasDefaultFont.fontFamily,a.font=o,a.font.replace(/\"/g,"'")!==o.replace(/\"/g,"'")&&(o=this._canvasDefaultFont.fontSize+" "+(a.font.split(" ")[1]||"sans-serif"),a.font=o)):(null!=u&&"none"!==u&&(a.globalAlpha=u),n&&null!=l&&"transparent"!==l&&"none"!==l&&(a.fillStyle=l,a.fill()),"none"!==s&&null!=s&&0!==h&&(a.strokeStyle=s,a.lineWidth=h,null!=c&&"none"!==c&&(c=c.match(/\d+(\.\d+)?/g),a.setLineDash(c)),a.stroke()))},this.__htmlElement=t;this.__canvasElement=document.createElement("canvas"),this.__htmlElement.appendChild(this.__canvasElement)}return Object.defineProperty(e.prototype,"opacity",{get:function(){return this.__opacity},set:function(t){this.__opacity=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this.__fill},set:function(t){this.__fill=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stroke",{get:function(){return this.__stroke},set:function(t){this.__stroke=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeWidth",{get:function(){return this.__strokeWidth},set:function(t){this.__strokeWidth=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeDasharray",{get:function(){return this.__strokeDasharray},set:function(t){this.__strokeDasharray=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textFill",{get:function(){return this.__textFill},set:function(t){this.__textFill=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this.__fontSize},set:function(t){this.__fontSize=t,this.__fontSizeWithPixel=null==t||isNaN(t)?t:t+"px"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this.__fontFamily},set:function(t){this.__fontFamily=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"element",{get:function(){return this.__canvasElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"devicePixelRatio",{get:function(){return this.__devicePixelRatio},set:function(t){isNaN(t)||null==t||(this.__devicePixelRatio=t)},enumerable:!0,configurable:!0}),e.prototype.beginRender=function(){var t,e=this.__htmlElement;this._canvasRect={},t=window.getComputedStyle(e),this._canvasDefaultFont={fontSize:t.fontSize,fontFamily:t.fontFamily,textFill:t.color}},e.prototype.endRender=function(){},e.prototype.setViewportSize=function(t,e){var i,n,r=this.__canvasElement,o=(r.getContext("2d"),this.fill),a=window.devicePixelRatio||1;a=a<1?1:a,null==this.__devicePixelRatio||isNaN(this.__devicePixelRatio)||(a=this.__devicePixelRatio),r.width=t*a,r.height=e*a,r.style.width=t+"px",r.style.height=e+"px",r.getContext("2d").scale(a,a),i=window.getComputedStyle(this.__htmlElement).backgroundColor,n=this.stroke,i&&(this.stroke=null,this.fill=i,this.drawRect(0,0,t,e),this.fill=o,this.stroke=n)},e.prototype.addClipRect=function(t,e){t&&e&&(this._canvasRect[e]=t)},e.prototype.drawEllipse=function(t,e,i,n,r,o){var a=this.__canvasElement.getContext("2d");a.save(),a.beginPath(),a.ellipse?a.ellipse(t,e,Math.max(i,0),Math.max(n,0),0,0,2*Math.PI):(a.translate(t,e),a.scale(1,n/i),a.translate(-t,-e),a.arc(t,e,Math.max(i,0),0,2*Math.PI),a.scale(1,1)),this._applyCanvasStyles(void 0,o,r,!0),a.restore()},e.prototype.drawRect=function(t,e,i,n,r,o,a){var s=this.__canvasElement.getContext("2d");s.save(),this._applyCanvasClip(s,a),s.beginPath(),s.rect(t,e,i,n),this._applyCanvasStyles(void 0,o,r,!0),s.restore()},e.prototype.drawLine=function(t,e,i,n,r,o){var a=this.__canvasElement.getContext("2d");a.save(),a.beginPath(),a.moveTo(t,e),a.lineTo(i,n),this._applyCanvasStyles(void 0,o,r),a.restore()},e.prototype.drawLines=function(t,e,i,n,r){if(t&&e&&0!==t.length&&0!==e.length){var o,a=this.__canvasElement.getContext("2d"),s=Math.min(t.length,e.length);for(a.save(),this._applyCanvasClip(a,r),a.beginPath(),a.moveTo(t[0],e[0]),o=1;o<s;o++)a.lineTo(t[o],e[o]);this._applyCanvasStyles(void 0,n,i),a.restore()}},e.prototype.drawSplines=function(e,i,n,r,o){if(e&&i&&0!==e.length&&0!==i.length){var a,s=this.__canvasElement.getContext("2d"),l=new t._Spline(e,i).calculate(),u=l.xs,h=l.ys,c=Math.min(u.length,h.length);for(s.save(),this._applyCanvasClip(s,o),s.beginPath(),s.moveTo(u[0],h[0]),a=1;a<c;a++)s.lineTo(u[a],h[a]);this._applyCanvasStyles(void 0,r,n),s.restore()}},e.prototype.drawPolygon=function(t,e,i,n,r){if(t&&e&&0!==t.length&&0!==e.length){var o,a=this.__canvasElement.getContext("2d"),s=Math.min(t.length,e.length);for(a.save(),this._applyCanvasClip(a,r),a.beginPath(),a.moveTo(t[0],e[0]),o=1;o<s;o++)a.lineTo(t[o],e[o]);a.closePath(),this._applyCanvasStyles(void 0,n,i,!0),a.restore()}},e.prototype.drawPieSegment=function(t,e,i,n,r,o,a,s){var l=this.__canvasElement.getContext("2d"),u=n,h=n+r;l.save(),this._applyCanvasClip(l,s),l.beginPath(),l.moveTo(t,e),l.arc(t,e,i,u,h,!1),l.lineTo(t,e),this._applyCanvasStyles(void 0,a,o,!0),l.restore()},e.prototype.drawDonutSegment=function(e,i,n,r,o,a,s,l,u){var h,c,p=this.__canvasElement.getContext("2d"),f=o,_=o+a;(h=new t.core.Point(e,i)).x+=r*Math.cos(f),h.y+=r*Math.sin(f),(c=new t.core.Point(e,i)).x+=r*Math.cos(_),c.y+=r*Math.sin(_),p.save(),this._applyCanvasClip(p,u),p.beginPath(),p.moveTo(h.x,h.y),p.arc(e,i,Math.max(n,0),f,_,!1),p.lineTo(c.x,c.y),p.arc(e,i,Math.max(r,0),_,f,!0),this._applyCanvasStyles(void 0,l,s,!0),p.restore()},e.prototype.drawString=function(t,e,i,n){if(null!=t){var r=this.__canvasElement.getContext("2d");r.save(),r.textBaseline="bottom",this._applyCanvasStyles(void 0,n,i,!0,!0),r.fillText(t.trim(),e.x,e.y),r.restore()}},e.prototype.drawStringRotated=function(t,e,i,n,r,o){if(null!=t){var a=this.__canvasElement.getContext("2d");a.measureText(t);a.save(),a.textBaseline="bottom",a.translate(i.x,i.y),a.rotate(Math.PI/180*n),a.translate(-i.x,-i.y),this._applyCanvasStyles(void 0,o,r,!0,!0),a.fillText(t,e.x,e.y),a.restore()}},e.prototype.measureString=function(e,i,n,r){var o,a=this.__canvasElement.getContext("2d");return this._applyCanvasStyles(null,null,i,!0,!0),o=a.measureText(e).width,new t.core.Size(o,1.5*parseInt(a.font))},e.prototype.startGroup=function(t,e,i){void 0===i&&(i=!1);var n=this.__canvasElement.getContext("2d");n.save(),this._applyCanvasClip(n,e)},e.prototype.endGroup=function(){this.__canvasElement.getContext("2d").restore()},e.prototype.drawImage=function(t,e,i,n,r){var o=this.__canvasElement.getContext("2d"),a=new Image;a.onload=function(){o.drawImage(a,e,i,n,r)},a.src=t},e.prototype._getOpacityColor=function(e,i){"none"==e&&(e="transparent");var n=new t.core.Color(e);return null!=i&&1===n.a&&(n.a=isNaN(i)?1:Number(i)),n.toString()},e.prototype._convertFontFamily=function(t){var e=t;return e&&'"'===e[0]&&(e=e.substring(1)),e&&'"'===e[e.length-1]&&(e=e.slice(0,-1)),e},e}();e._PureCanvasRenderEngine=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(i){this.devicePixelRatio=NaN,this.opacity=1,this.fill=null,this.stroke=null,this.strokeWidth=1,this.strokeDasharray=null,this.textFill=null,this.fontSize=null,this.fontFamily=null,this._savedGradient={},this._cache={},this.__htmlElement=i,this.__svgElement=document.createElementNS(e.__svgNS,"svg"),this.__defsElement=document.createElementNS(e.__svgNS,"defs"),this.__textElement=this._createTextElement(new t.core.Point(-1e3,-1e3),""),this.__textGroupElement=document.createElementNS(e.__svgNS,"g"),this.__textGroupElement.appendChild(this.__textElement),this.__svgElement.appendChild(this.__defsElement),this.__svgElement.appendChild(this.__textGroupElement),this.__htmlElement.appendChild(this.__svgElement),void 0===e._isff&&(e._isff=navigator.userAgent.toLowerCase().indexOf("firefox")>=0)}return Object.defineProperty(e.prototype,"element",{get:function(){return this.__svgElement},enumerable:!0,configurable:!0}),e.prototype.beginRender=function(){for(;this.__svgElement.firstChild;)this.__svgElement.removeChild(this.__svgElement.firstChild);this.__svgElement.appendChild(this.__defsElement),this.__svgElement.appendChild(this.__textGroupElement),this._savedGradient={}},e.prototype.endRender=function(){this.__textGroupElement.parentNode&&this.__svgElement.removeChild(this.__textGroupElement)},e.prototype.setViewportSize=function(e,i){t._assertDebug(function(){return null!=e&&e>0}),t._assertDebug(function(){return null!=i&&i>0}),this.__svgElement.setAttribute("width",e.toString()),this.__svgElement.setAttribute("height",i.toString())},e.prototype.addClipRect=function(t,i){if(t&&i){var n=document.createElementNS(e.__svgNS,"clipPath"),r=document.createElementNS(e.__svgNS,"rect");r.setAttribute("x",t.left.toFixed(1)),r.setAttribute("y",t.top.toFixed(1)),r.setAttribute("width",t.width.toFixed(1)),r.setAttribute("height",t.height.toFixed(1)),n.appendChild(r),n.setAttribute("id",i),this.__svgElement.appendChild(n)}},e.prototype.drawEllipse=function(t,i,n,r,o,a){var s=document.createElementNS(e.__svgNS,"ellipse");return this._applyColor(s,"stroke",this.stroke),null!=this.opacity&&s.setAttribute("opacity",this.opacity.toString()),null!==this.strokeWidth&&s.setAttribute("stroke-width",this.strokeWidth.toString()),null!==this.strokeDasharray&&s.setAttribute("stroke-dasharray",this.strokeDasharray),this._applyColor(s,"fill",this.fill),s.setAttribute("cx",t.toFixed(1)),s.setAttribute("cy",i.toFixed(1)),s.setAttribute("rx",n.toFixed(1)),s.setAttribute("ry",r.toFixed(1)),o&&s.setAttribute("class",o),this._applyStyle(s,a),this._appendChild(s),s},e.prototype.drawRect=function(t,i,n,r,o,a,s){var l=document.createElementNS(e.__svgNS,"rect");return this._applyColor(l,"fill",this.fill),this._applyColor(l,"stroke",this.stroke),null!=this.opacity&&l.setAttribute("opacity",this.opacity.toString()),null!==this.strokeWidth&&l.setAttribute("stroke-width",this.strokeWidth.toString()),null!==this.strokeDasharray&&l.setAttribute("stroke-dasharray",this.strokeDasharray),l.setAttribute("x",t.toFixed(1)),l.setAttribute("y",i.toFixed(1)),n>0&&n<.05?l.setAttribute("width","0.1"):l.setAttribute("width",n.toFixed(1)),r>0&&r<.05?l.setAttribute("height","0.1"):l.setAttribute("height",r.toFixed(1)),s&&l.setAttribute("clip-path","url(#"+s+")"),o&&l.setAttribute("class",o),this._applyStyle(l,a),this._appendChild(l),l},e.prototype.drawLine=function(t,i,n,r,o,a){var s=document.createElementNS(e.__svgNS,"line");return this._applyColor(s,"stroke",this.stroke),null!=this.opacity&&s.setAttribute("opacity",this.opacity.toString()),null!==this.strokeWidth&&s.setAttribute("stroke-width",this.strokeWidth.toString()),null!==this.strokeDasharray&&s.setAttribute("stroke-dasharray",this.strokeDasharray),s.setAttribute("x1",t.toFixed(1)),s.setAttribute("x2",n.toFixed(1)),s.setAttribute("y1",i.toFixed(1)),s.setAttribute("y2",r.toFixed(1)),o&&s.setAttribute("class",o),this._applyStyle(s,a),this._appendChild(s),s},e.prototype.drawLines=function(t,i,n,r,o){if(t&&i){var a=Math.min(t.length,i.length);if(a>0){var s=document.createElementNS(e.__svgNS,"polyline");this._applyColor(s,"stroke",this.stroke),null!=this.opacity&&s.setAttribute("opacity",this.opacity.toString()),null!==this.strokeWidth&&s.setAttribute("stroke-width",this.strokeWidth.toString()),null!==this.strokeDasharray&&s.setAttribute("stroke-dasharray",this.strokeDasharray),s.setAttribute("fill","none");for(var l="",u=0;u<a;u++)l+=t[u].toFixed(1)+","+i[u].toFixed(1)+" ";return s.setAttribute("points",l),n&&s.setAttribute("class",n),o&&s.setAttribute("clip-path","url(#"+o+")"),this._applyStyle(s,r),this._appendChild(s),s}}return null},e.prototype.drawSplines=function(i,n,r,o,a){if(i&&n){var s=new t._Spline(i,n).calculate(),l=s.xs,u=s.ys,h=Math.min(l.length,u.length);if(h>0){var c=document.createElementNS(e.__svgNS,"polyline");this._applyColor(c,"stroke",this.stroke),null!=this.opacity&&c.setAttribute("opacity",this.opacity.toString()),null!==this.strokeWidth&&c.setAttribute("stroke-width",this.strokeWidth.toString()),null!==this.strokeDasharray&&c.setAttribute("stroke-dasharray",this.strokeDasharray),c.setAttribute("fill","none");for(var p="",f=0;f<h;f++)p+=l[f].toFixed(1)+","+u[f].toFixed(1)+" ";return c.setAttribute("points",p),r&&c.setAttribute("class",r),a&&c.setAttribute("clip-path","url(#"+a+")"),this._applyStyle(c,o),this._appendChild(c),c}}return null},e.prototype.drawPolygon=function(t,i,n,r,o){if(t&&i){var a=Math.min(t.length,i.length);if(a>0){var s=document.createElementNS(e.__svgNS,"polygon");this._applyColor(s,"stroke",this.stroke),null!=this.opacity&&s.setAttribute("opacity",this.opacity.toString()),null!==this.strokeWidth&&s.setAttribute("stroke-width",this.strokeWidth.toString()),null!==this.strokeDasharray&&s.setAttribute("stroke-dasharray",this.strokeDasharray),this._applyColor(s,"fill",this.fill);for(var l="",u=0;u<a;u++)l+=t[u].toFixed(1)+","+i[u].toFixed(1)+" ";return s.setAttribute("points",l),n&&s.setAttribute("class",n),o&&s.setAttribute("clip-path","url(#"+o+")"),this._applyStyle(s,r),this._appendChild(s),s}}return null},e.prototype.drawPieSegment=function(i,n,r,o,a,s,l,u){if(a>=2*Math.PI)return this.drawEllipse(i,n,r,r,s,l);var h=document.createElementNS(e.__svgNS,"path");this._applyColor(h,"fill",this.fill),this._applyColor(h,"stroke",this.stroke),null!=this.opacity&&h.setAttribute("opacity",this.opacity.toString()),null!==this.strokeWidth&&h.setAttribute("stroke-width",this.strokeWidth.toString()),null!==this.strokeDasharray&&h.setAttribute("stroke-dasharray",this.strokeDasharray);var c=new t.core.Point(i,n);c.x+=r*Math.cos(o),c.y+=r*Math.sin(o);var p=o+a,f=new t.core.Point(i,n);f.x+=r*Math.cos(p),f.y+=r*Math.sin(p);var _=" 0 0,1 ";Math.abs(a)>Math.PI&&(_=" 0 1,1 ");var d="M "+c.x.toFixed(1)+","+c.y.toFixed(1);return d+=" A "+r.toFixed(1)+","+r.toFixed(1)+_,d+=f.x.toFixed(1)+","+f.y.toFixed(1),d+=" L "+i.toFixed(1)+","+n.toFixed(1)+" z",h.setAttribute("d",d),u&&h.setAttribute("clip-path","url(#"+u+")"),s&&h.setAttribute("class",s),this._applyStyle(h,l),this._appendChild(h),h},e.prototype.drawDonutSegment=function(i,n,r,o,a,s,l,u,h){var c=!1;s>=2*Math.PI&&(c=!0,s-=.001);var p=document.createElementNS(e.__svgNS,"path");this._applyColor(p,"fill",this.fill),this._applyColor(p,"stroke",this.stroke),null!=this.opacity&&p.setAttribute("opacity",this.opacity.toString()),null!==this.strokeWidth&&p.setAttribute("stroke-width",this.strokeWidth.toString()),null!==this.strokeDasharray&&p.setAttribute("stroke-dasharray",this.strokeDasharray);var f=new t.core.Point(i,n);f.x+=r*Math.cos(a),f.y+=r*Math.sin(a);var _=a+s,d=new t.core.Point(i,n);d.x+=r*Math.cos(_),d.y+=r*Math.sin(_);var g=new t.core.Point(i,n);g.x+=o*Math.cos(_),g.y+=o*Math.sin(_);var y=new t.core.Point(i,n);y.x+=o*Math.cos(a),y.y+=o*Math.sin(a);var m=" 0 0,1 ",v=" 0 0,0 ";Math.abs(s)>Math.PI&&(m=" 0 1,1 ",v=" 0 1,0 ");var b="M "+f.x.toFixed(3)+","+f.y.toFixed(3);return b+=" A "+r.toFixed(3)+","+r.toFixed(3)+m,b+=d.x.toFixed(3)+","+d.y.toFixed(3),b+=c?" M "+g.x.toFixed(3)+","+g.y.toFixed(3):" L "+g.x.toFixed(3)+","+g.y.toFixed(3),b+=" A "+o.toFixed(3)+","+o.toFixed(3)+v,b+=y.x.toFixed(3)+","+y.y.toFixed(3),c||(b+=" z"),p.setAttribute("d",b),h&&p.setAttribute("clip-path","url(#"+h+")"),l&&p.setAttribute("class",l),this._applyStyle(p,u),this._appendChild(p),p},e.prototype.drawString=function(t,e,i,n){var r=this._createTextElement(e,t);i&&r.setAttribute("class",i),this._applyStyle(r,n),this._appendChild(r);var o=this._getBBox(r);return r.setAttribute("y",(e.y-(o.y+o.height-e.y)).toFixed(1)),r},e.prototype.drawStringRotated=function(t,i,n,r,o,a){var s=this._createTextElement(i,t);o&&s.setAttribute("class",o),this._applyStyle(s,a);var l=document.createElementNS(e.__svgNS,"g");l.setAttribute("transform","rotate("+r.toFixed(1)+","+n.x.toFixed(1)+","+n.y.toFixed(1)+")"),l.appendChild(s),this._appendChild(l);var u=this._getBBox(s);return s.setAttribute("y",(i.y-(u.y+u.height-i.y)).toFixed(1)),s},e.prototype.measureString=function(e,i,n,r){var o=new t.core.Size(0,0);this.fontSize&&this.__textElement.setAttribute("font-size",this.fontSize),this.fontFamily&&this.__textElement.setAttribute("font-family",this.fontFamily),i&&this.__textElement.setAttribute("class",i),n&&this.__textGroupElement.setAttribute("class",n),this._applyStyle(this.__textElement,r),this._setText(this.__textElement,e);var a=this._getBBox(this.__textElement);if(o.width=a.width,o.height=a.height,this.__textElement.removeAttribute("font-size"),this.__textElement.removeAttribute("font-family"),this.__textElement.removeAttribute("class"),r)for(var s in r)this.__textElement.removeAttribute(this._deCase(s));return this.__textGroupElement.removeAttribute("class"),this.__textElement.textContent=null,o},e.prototype.startGroup=function(t,i,n){void 0===n&&(n=!1);var r=document.createElementNS(e.__svgNS,"g");return t&&r.setAttribute("class",t),i&&r.setAttribute("clip-path","url(#"+i+")"),this._appendChild(r),n&&r.transform.baseVal.appendItem(this.__svgElement.createSVGTransform()),this._group=r,r},e.prototype.endGroup=function(){if(this._group){var t=this._group.parentNode;t==this.__svgElement?this._group=null:this._group=t}},e.prototype.drawImage=function(t,i,n,r,o){var a=document.createElementNS(e.__svgNS,"image");return a.setAttributeNS(e.__xlinkNS,"href",t),a.setAttribute("x",i.toFixed(1)),a.setAttribute("y",n.toFixed(1)),a.setAttribute("width",r.toFixed(1)),a.setAttribute("height",o.toFixed(1)),this._appendChild(a),a},e.prototype._appendChild=function(t){var e=this._group;e||(e=this.__svgElement),e.appendChild(t)},e.prototype._setText=function(t,e){var i=e?e.toString():null;if(i&&i.indexOf("tspan")>=0)try{t.textContent=null;for(var n=new DOMParser,r='<svg xmlns="http://www.w3.org/2000/svg">'+i+"</svg>",o=n.parseFromString(r,"text/xml").documentElement.firstChild;o;)t.appendChild(t.ownerDocument.importNode(o,!0)),o=o.nextSibling}catch(t){throw new Error("Error parsing XML string.")}else t.textContent=i},e.prototype._createTextElement=function(t,i){var n=document.createElementNS(e.__svgNS,"text");return this._setText(n,i),null!=this.textFill&&n.setAttribute("fill",this.textFill),n.setAttribute("x",t.x.toFixed(1)),n.setAttribute("y",t.y.toFixed(1)),this.fontSize&&n.setAttribute("font-size",this.fontSize),this.fontFamily&&n.setAttribute("font-family",this.fontFamily),n},e.prototype._applyStyle=function(t,e){if(e)for(var i in e){var n=e[i];void 0!==n&&null!==n&&("fill"===i||"stroke"===i?this._applyColor(t,i,e[i]):"strokeWidth"===i?t.setAttribute("stroke-width",n):"fontSize"===i?t.setAttribute("font-size",n):"fontFamily"===i?t.setAttribute("font-family",n):"strokeDasharray"===i?t.setAttribute("stroke-dasharray",n):"color"===i?t.setAttribute("color",n):"opacity"===i?t.setAttribute("opacity",n):"_"==i.substring(0,1)||"constructor"==i||"hAlign"==i||t.setAttribute(this._deCase(i),e[i]))}},e.prototype._deCase=function(t){return t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()})},e.prototype._getBBox=function(i){var n=i.getAttribute("font-size"),r=i.getAttribute("font-family"),o=n+","+(t.core.isIE()?i.textContent:i.innerHTML)+","+i.getAttribute("x")+","+i.getAttribute("y")+r;if(null!=this._cache[o])return this._cache[o];var a=null;if(e._isff)try{a=i.getBBox()}catch(t){a={x:0,y:0,width:0,height:0}}else a=i.getBBox();return this._cache[o]=a,a},e.prototype._applyColor=function(i,r,o){var a=n.tryParse(o);if(null!=a)if(t.core.isString(a))i.setAttribute(r,a);else{if(null==this._savedGradient[o]){var s,l="gc"+(1e6*Math.random()).toFixed();null!=a.x1?(s=document.createElementNS(e.__svgNS,"linearGradient"),["x1","y1","x2","y2","gradientUnits"].forEach(function(t){null!=a[t]&&s.setAttribute(t,a[t])})):null!=a.r&&(s=document.createElementNS(e.__svgNS,"radialGradient"),["cx","cy","r","fx","fy","fr","gradientUnits"].forEach(function(t){null!=a[t]&&s.setAttribute(t,a[t])})),a.colors&&a.colors&&a.colors.length>0&&a.colors.forEach(function(t){var i=document.createElementNS(e.__svgNS,"stop");null!=t.color&&i.setAttribute("stop-color",t.color),null!=t.offset&&i.setAttribute("offset",t.offset),null!=t.opacity&&i.setAttribute("stop-opacity",t.opacity),s.appendChild(i)}),s.setAttribute("id",l),this.__defsElement.appendChild(s),this._savedGradient[o]=l}i.setAttribute(r,"url(#"+this._savedGradient[o]+")")}},e.__svgNS="http://www.w3.org/2000/svg",e.__xlinkNS="http://www.w3.org/1999/xlink",e}();e._SvgRenderEngine=i;var n=function(){function t(){}return t.tryParse=function(e){if(t.parsedColor[e])return t.parsedColor[e];if(null==e||-1===e.indexOf("-"))return e;var i,n=e.replace(/\s+/g,"").split(/\-/g),r=n[0][0],o=!1,a=n[0].match(/\(\S+\)/)[0].replace(/[\(\\)]/g,"").split(/\,/g);"l"===r||"L"===r?(i={x1:"0",y1:"0",x2:"0",y2:"0",colors:[]},"l"===r&&(o=!0),["x1","y1","x2","y2"].forEach(function(t,e){null!=a[e]&&(i[t]=o?100*+a[e]+"%":a[e]+"")})):"r"!==r&&"R"!==r||(i={cx:"0",cy:"0",r:"0",colors:[]},"r"===r&&(o=!0),["cx","cy","r","fx","fy","fr"].forEach(function(t,e){null!=a[e]&&""!==a[e]&&(i[t]=o?100*+a[e]+"%":a[e]+"")})),o||(i.gradientUnits="userSpaceOnUse"),t.parsedColor[e]=i;var s=n.length-1;return n.forEach(function(t,e){t.indexOf(")")>-1&&(t=t.match(/\)\S+/)[0].replace(")",""));var n=t.split(":"),r={color:"black"};null!=n[0]&&(r.color=n[0]),null!=n[1]?r.offset=o?100*+n[1]+"%":n[1]+"":r.offset=e/s*100+"%",null!=n[2]&&(r.opacity=n[2]),i.colors.push(r)}),i},t.parsedColor={},t}()}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.format=function(e,i){return t.core.Globalize.format(i,e)},e.prototype.defaultFormat=function(e,i){switch(void 0===i&&(i=!1),e){case t.core.DataType.Number:return i?"p":"N";case t.core.DataType.Date:return"d";default:return""}},e}();e._StringFormatting=i}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.render=function(e,i,n){void 0===n&&(n=null);var r=i.width<i.height?i.width:i.height;e.drawRect((i.right+i.left)/2-r/2,i.top,r,r,null,t.core.merge({fill:this._color,strokeWidth:0},n))},e}();e._BoxSymbol=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.render=function(e,i,n){void 0===n&&(n=null);var r=i.width<i.height?i.width:i.height,o={x:.5*(i.left+i.right),y:.5*(i.top+i.bottom)},a=t.core.merge({stroke:this._color,strokeWidth:2,strokeDasharray:"2,2"},n);a.strokeWidth=2,a.strokeDasharray="2.2",e.drawLine(o.x-.5*r,o.y,o.x+.5*r,o.y,null,a)},e}();e._DashSymbol=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.render=function(e,i,n){void 0===n&&(n=null);var r=i.width<i.height?i.width:i.height,o={x:.5*(i.left+i.right),y:.5*(i.top+i.bottom)},a=[o.x,o.x+.5*r,o.x,o.x-.5*r],s=[o.y-.5*r,o.y,o.y+.5*r,o.y];e.drawPolygon(a,s,null,t.core.merge({fill:this._color,strokeWidth:0},n))},e}();e._DiamondSymbol=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.render=function(e,i,n){void 0===n&&(n=null);var r=i.width<i.height?i.width/2:i.height/2;e.drawEllipse((i.right+i.left)/2,(i.top+i.bottom)/2,r,r,null,t.core.merge({fill:this._color,stroke:this._color,strokeWidth:0},n))},e}();e._DotSymbol=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.render=function(e,i,n){void 0===n&&(n=null);var r=i.width<i.height?i.width:i.height,o={x:.5*(i.left+i.right),y:.5*(i.top+i.bottom)};e.drawLine(o.x,o.y-.5*r,o.x,o.y+.5*r,null,t.core.merge({stroke:this._color,strokeWidth:2},n)),e.drawLine(o.x-.5*r,o.y,o.x+.5*r,o.y,null,t.core.merge({stroke:this._color,strokeWidth:2},n))},e}();e._PlusSymbol=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.render=function(e,i,n){void 0===n&&(n=null);var r=i.width<i.height?i.width:i.height,o=i.clone();i.width>i.height&&(o.left=o.left+(i.width-r)/2,o.width=r),i.height>i.width&&(o.top=o.top+(i.height-r)/2,o.height=r);var a=new t.core.Point(o.left+o.width/2,o.top),s=new t.core.Point(o.left,o.width/2/.5773502691896257+o.top),l=new t.core.Point(o.right,s.y),u=[],h=[];u.push(a.x),u.push(s.x),u.push(l.x),h.push(a.y),h.push(s.y),h.push(l.y),e.drawPolygon(u,h,null,t.core.merge({fill:this._color,strokeWidth:0},n))},e}();e._TriangleSymbol=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.render=function(e,i,n){void 0===n&&(n=null);var r=i.width<i.height?i.width:i.height,o=.5*(i.left+i.right),a=.5*(i.top+i.bottom),s=t.core.merge({stroke:this._color,strokeWidth:2},n);s.strokeWidth=2,e.drawLine(o-.5*r,a-.5*r,o+.5*r,a+.5*r,null,s),e.drawLine(o+.5*r,a-.5*r,o-.5*r,a+.5*r,null,s)},e}();e._XSymbol=i}(t.models||(t.models={}))}(r||(r={})),function(t){t.models||(t.models={})}(r||(r={})),function(e){var i=function(){function i(t,e,i,n){this._lastValue=!0,this._proxy=this._generateCalcSourceProxy(),this._rules=this._parseExpress(t),this._getvalueCallback=e,this._containsCallback=i,this._resultCallback=n}return i.prototype._parseExpress=function(t){for(var e=t.split("].["),i=0;i<e.length;++i){var n=e[i];n=n.replace("[","").replace("]",""),e[i]=n}return e},i.prototype.evaluate=function(t){if(this._lastValue=!0,e._isCalculationEngineExist){this._current=t;for(var i=0;i<this._rules.length&&this._lastValue;++i)if(this._containsCallback(this._current,this._rules[i]))this._lastValue=this._lastValue,i==this._rules.length-1&&this._lastValue&&this._resultCallback(this._current);else try{this._proxy.getCalcSourceModel().setFormulaByName("QUERY"+i,this._rules[i])}catch(t){}}},i.prototype._isIdentityExpression=function(t){return!0},i.prototype._getValue=function(t){var i=this._getvalueCallback(this._current,t);return e.core.assert(null!=i,"can not find field "+t),i},i.prototype._applyActions=function(t,e){var i=t.replace("QUERY","");this._lastValue&&e?this._lastValue=!0:this._lastValue=!1,parseInt(i)==this._rules.length-1&&(this._lastValue&&this._resultCallback(this._current),this._lastValue=!0)},i.prototype._generateCalcSourceProxy=function(){return e._isCalculationEngineExist?new(function(i){function n(n){var r=i.call(this,new t.Spread.CalcEngine.CalcService)||this;return e._assertDebug(function(){return null!=n}),r._owner=n,r.getCalcService().getSourceModel(r),r}return s(n,i),n.prototype.getParserContext=function(e,i,n){var r=this,o=new t.Spread.CalcEngine.ParserContext(this,e,i||{},n),a=new t.Spread.CalcEngine.TokenResolver(7e3);return a.resolveToken=function(e,i,n,o){var a=n[o],s=a._stringValue;if(0===a._type&&0===a._subType&&r._owner._isIdentityExpression(s)){var l=new t.Spread.CalcEngine.Expression(25);return l.value=s,l}},o.addResolver(a),o},n.prototype.getEvaluatorContext=function(e,i,n){var r=new t.Spread.CalcEngine.EvaluateContext(this,e,i,n),o=this;return r.evaluate=function(t,e,i){return this.getValue(o,t.value)},r},n.prototype.getValueByName=function(t){return""},n.prototype.setValueByName=function(t,e){this._owner._applyActions(t,e)},n.prototype.getValue=function(t){return this._owner._getValue(t)},n}(t.Spread.CalcEngine.CalcSource))(this):null},i}();e._SelectionConditionalFormattingRule=i}(r||(r={})),r||(r={}),function(t){var e=function(){function t(t){this._unit=NaN,this._actual_unit=NaN,this.bound=!1,this.id=t}return Object.defineProperty(t.prototype,"format",{get:function(){return this._format},set:function(t){this._format=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"reversed",{get:function(){return this._reversed},set:function(t){this._reversed=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"min",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.domain=function(t){return this.domains=t,this},t.prototype.range=function(t){return this.ranges=t,this.refresh()},t.prototype.rangeBounds=function(t){return this},t.prototype.refresh=function(){return this._tickNumber||(this._tickNumber=this.domains.length),this},Object.defineProperty(t.prototype,"tickNumber",{get:function(){return this._tickNumber},set:function(t){this._tickNumber=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"unit",{get:function(){return this._actual_unit},set:function(t){this._unit=t},enumerable:!0,configurable:!0}),t.prototype.getScaleValue=function(t){return 0},Object.defineProperty(t.prototype,"ticks",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startPosition",{get:function(){return this.start},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"endPosition",{get:function(){return this.end},enumerable:!0,configurable:!0}),t}();t.Scale=e}(r||(r={})),function(t){var e=function(e){function i(t){var i=e.call(this,t)||this;return i._ticksnumber=10,i}return s(i,e),i.prototype.refresh=function(){return this.start=this.ranges[0],this.end=this.ranges[1],this.minValue=this.domains[0],this.maxValue=this.domains[1],this._ticks=t.ColorUtils.gradientColor(this.start,this.end,this.tickNumber),this},i.prototype.range=function(t){return this.ranges=t,this.bound=!1,this.refresh(),this},i.prototype.domain=function(t){return this.domains=t,this},i.prototype.getScaleValue=function(t){var e=this.maxValue-this.minValue;e<=0&&(e=1);var i=(t-this.minValue)/e*this._ticks.length;return this._ticks[Math.floor(i)]},Object.defineProperty(i.prototype,"tickNumber",{get:function(){return this._ticksnumber},set:function(t){this._ticksnumber=t,this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ticks",{get:function(){return this._ticks},enumerable:!0,configurable:!0}),i}(t.Scale);t.ColorScale=e}(r||(r={})),function(t){var e=function(t){function e(e){return t.call(this,e)||this}return s(e,t),Object.defineProperty(e.prototype,"tickNumber",{get:function(){return this._tickNumber?this._tickNumber:10},set:function(t){isNaN(this._unit)&&(this._tickNumber=t),this.refresh()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._actual_max},set:function(t){this.maxValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._actual_min},set:function(t){this.minValue=t},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){this.reversed?(this.start=this.ranges[1],this.end=this.ranges[0]):(this.start=this.ranges[0],this.end=this.ranges[1]);var t=this._actual_min,e=this._actual_max;this._actual_min=this.domains[0],this._actual_max=this.domains[1],t<this._actual_min&&(this._actual_min=t),e>this._actual_max&&(this._actual_max=e),isNaN(this.maxValue)||(this._actual_max=this.maxValue),isNaN(this.minValue)||(this._actual_min=this.minValue),this._actual_min==this.maxValue&&(this._actual_min-=.5,this._actual_max+=.5);var i=this._actual_max-this._actual_min;return isNaN(this._unit)?(this._actual_unit=this._calcMajorUnit(),(0==this._actual_unit||isNaN(this._actual_unit))&&(this._actual_unit=.1*this._niceTickNumber(i/this.tickNumber))):(this._tickNumber=Math.round(i/this._unit+.5)+1,this._actual_unit=this._unit),0==this.unit&&(this.unit=void 0),this.niceMaxValue=(Math.floor(this._actual_max/this.unit)+1)*this.unit,this.niceMinValue=0==this._actual_min?this._actual_min:(Math.floor(this._actual_min/this.unit)-1)*this.unit,this._ticks=this._createTicks(),this},e.prototype._createTicks=function(){var t=[];if(!isNaN(this.niceMinValue))for(var e=NaN,i=0;isNaN(e)||e<this._actual_max;++i)(e=i*this.unit+this.niceMinValue)<=this._actual_max&&e>=this._actual_min&&t.push(e);return t},Object.defineProperty(e.prototype,"ticks",{get:function(){return this._ticks},enumerable:!0,configurable:!0}),e.prototype.getScaleValue=function(t){return this._actual_max==this._actual_min?(this.end-this.start)/2+this.start:(this.end-this.start)/(this._actual_max-this._actual_min)*(t-this._actual_min)+this.start},e.prototype.range=function(t){return this.ranges=t,this.refresh(),this},e.prototype._calcMajorUnit=function(){var t=NaN;if(isNaN(t)){var e=this._actual_max-this._actual_min,i=this._nicePrecision(e),n=e/this.tickNumber;(t=this._niceNumber(2*n,-i,!0))<n&&(t=this._niceNumber(n,1-i,!1)),t<n&&(t=this._niceTickNumber(n))}return t},e.prototype._nicePrecision=function(t){if(t<=0||isNaN(t))return 0;var e,i=Math.log(t)/Math.LN10;e=i>=0?Math.floor(i):Math.ceil(i);var n=t/Math.pow(10,e);return n<3&&(e=1-e,(n=t/Math.pow(10,e))<3&&(e+=1)),e},e.prototype._niceNumber=function(t,e,i){if(0==t)return t;t<0&&(t=-t);var n=t/Math.pow(10,e),r=10;return i?n<1.5?r=1:n<3?r=2:n<4.5?r=4:n<7&&(r=5):n<=1?r=1:n<=2?r=2:n<=5&&(r=5),r*Math.pow(10,e)},e.prototype._niceTickNumber=function(t){if(0==t)return t;t<0&&(t=-t);var e=Math.log(t)/Math.LN10,i=Math.floor(e),n=t/Math.pow(10,i),r=10;return n<=1?r=1:n<=2?r=2:n<=5&&(r=5),r*Math.pow(10,i)},e}(t.Scale);t.LinearScale=e}(r||(r={})),function(t){var e=function(t){function e(e,i){var n=t.call(this,i)||this;return n.logBase=e,n}return s(e,t),Object.defineProperty(e.prototype,"max",{get:function(){return this._actual_max},set:function(t){this.maxValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._actual_min},set:function(t){this.minValue=t},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){if(this.reversed?(this.start=this.ranges[1],this.end=this.ranges[0]):(this.start=this.ranges[0],this.end=this.ranges[1]),this._actual_min=this.domains[0],this._actual_max=this.domains[1],isNaN(this.maxValue)||(this._actual_max=this.maxValue),isNaN(this.minValue)||(this._actual_min=this.minValue),this.logBase>0){var t=this.logBase,e=Math.log(t),i=Math.ceil(Math.log(this._actual_max)/e);this._actual_max=Math.pow(t,i);var n=Math.floor(Math.log(this._actual_min)/e);this._actual_min=Math.pow(t,n),(this._actual_min<=0||isNaN(this._actual_min))&&(this._actual_min=1),this._actual_max<this._actual_min&&(this._actual_max=this._actual_min+1)}return this._vals=[],this._createLogarithmicLabels(this._actual_min,this._actual_max,this.unit,this._vals,!1),this._vals.sort(function(t,e){return t>e?1:-1}),this},e.prototype.range=function(t){return this.ranges=t,this.refresh(),this},e.prototype.getScaleValue=function(t){t<this.minValue&&(t=this.minValue);var e=Math.log(this._actual_max/this._actual_min);return Math.log(t/this._actual_min)/e*(this.end-this.start)+this.start},Object.defineProperty(e.prototype,"ticks",{get:function(){return this._vals},enumerable:!0,configurable:!0}),e.prototype._createLogarithmicLabels=function(t,e,i,n,r){var o=this.logBase,a=Math.log(o),s=Math.floor(Math.log(t)/a),l=Math.ceil(Math.log(e)/a),u=o,h=!0;i>0&&(h=!1,u=i),u<o&&(u=o);var c=(l-s+1)*o/u,p=1;if(r){var f=this.tickNumber;c>f?p=Math.floor(c/f+1):h&&(c<=.2*f?u=.2*o:c<=.1*f&&(u=.1*o))}for(var _=s;_<=l;_+=p){if(h)for(var d=Math.pow(o,_),g=0;g*u<o-1;g++){var y;(y=d*(1+g*u))>=t&&y<=e&&(0==g?n.unshift(y):n.push(y))}else(y=Math.pow(u,_))>=t&&y<=e&&n.push(y)}},e}(t.Scale);t.LogScale=e}(r||(r={})),function(t){var e=function(t){function e(e,i){var n=t.call(this,i)||this;return n.isRanges=!1,n._ticksize=e,n}return s(e,t),e.prototype.refresh=function(){var t=this._actual_min,e=this._actual_max;this._actual_min=this.domains[0],this._actual_max=this.domains[1],t<this._actual_min&&(this._actual_min=t),e>this._actual_max&&(this._actual_max=e),isNaN(this.maxValue)||(this._actual_max=this.maxValue),isNaN(this.minValue)||(this._actual_min=this.minValue),this._actual_min==this.maxValue&&(this._actual_min-=.5,this._actual_max+=.5),this.reversed?(this.start=this.ranges[1],this.end=this.ranges[0]):(this.start=this.ranges[0],this.end=this.ranges[1]),isNaN(this._unit)&&(this._unit=1),this._ticks=[];for(var i=Math.round(this._actual_min);i<=Math.floor(this._actual_max);i+=this._unit)this._ticks.push(parseFloat(i.toFixed(1/this._unit)));return this},e.prototype.range=function(t){return this.ranges=t,this.bound=!1,this.refresh(),this},e.prototype.domain=function(t){return this.domains=t,this},e.prototype.getScaleValue=function(t){var e;return this._actual_max==this._actual_min?e=(this.end-this.start)/2+this.start:(t<this._actual_min&&(t=this._actual_min),t>this._actual_max&&(t=this._actual_max),e=(this.end-this.start)/(this._actual_max-this._actual_min)*(t-this._actual_min)+this.start),e},Object.defineProperty(e.prototype,"tickNumber",{get:function(){return Math.floor(this._actual_max)+1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ticks",{get:function(){return this._ticks},enumerable:!0,configurable:!0}),e}(t.LinearScale);t.OrdinalScale=e}(r||(r={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),Object.defineProperty(i.prototype,"max",{get:function(){return this.maxValue},set:function(t){this.maxValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"min",{get:function(){return this.minValue},set:function(t){this.minValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tickNumber",{get:function(){return this._tickNumber?this._tickNumber:10},set:function(t){this._tickNumber=t,this.refresh()},enumerable:!0,configurable:!0}),i.prototype.refresh=function(){this.reversed?(this.start=this.ranges[1],this.end=this.ranges[0]):(this.start=this.ranges[0],this.end=this.ranges[1]);var e=this.minValue,i=this.maxValue;this.minValue=this.domains[0],this.maxValue=this.domains[1],e<this.minValue&&(this.minValue=e),i>this.maxValue&&(this.maxValue=i),this.minValue==this.maxValue&&(this.minValue-=.5,this.maxValue+=.5);var n=this.maxValue-this.minValue;this.niceMaxValue=(Math.floor(this.maxValue/this._unit)+1)*this._unit,this.niceMinValue=0==this.minValue?this.minValue:(Math.floor(this.minValue/this._unit)-1)*this._unit;var r=Math.min(t._LineAxis.MAX_MAJOR,Math.floor(n/this._unit)+1),o=Math.floor(this.minValue/this._unit)*this._unit;return o<this.minValue&&(o+=this._unit),this._ticks=this._createTimeLabels(o,r),this},Object.defineProperty(i.prototype,"ticks",{get:function(){return this._ticks},enumerable:!0,configurable:!0}),i.prototype.getScaleValue=function(t){return this.maxValue==this.minValue?(this.end-this.start)/2+this.start:(this.end-this.start)/(this.maxValue-this.minValue)*(t-this.minValue)+this.start},i.prototype.range=function(t){return this.ranges=t,this.refresh(),this},Object.defineProperty(i.prototype,"format",{get:function(){return this._format},set:function(t){this._format=t},enumerable:!0,configurable:!0}),i.prototype._createTimeLabels=function(e,i){var n=[],r=this.minValue,o=this.maxValue,a=new Date(this.minValue),s=new Date(this.maxValue),l=this.format,u=this.tickNumber;u>12&&(u=12);var h=.001*(this.maxValue-this.minValue)/u,c=new t._timeSpan(h*t._timeSpan.TicksPerSecond),p=isNaN(this._unit)?t._timeHelper.NiceTimeSpan(c,l):t._timeSpan.fromDays(this._unit),f=p.Ticks,_=t._timeHelper.RoundTime(r,p.TotalDays,!1);isFinite(_)&&(r=_);var d=t._timeHelper.RoundTime(o,p.TotalDays,!0);isFinite(d)&&(o=d);var g=new Date(r);new Date(o);if(p.TotalDays>=365&&isNaN(this._unit)){(g=new Date(a.getFullYear(),1,1))<a&&g.setFullYear(g.getFullYear()+1);var y=p.TotalDays/365;y-=y%1;for(var m=g;m<=s;m.setFullYear(m.getFullYear()+y)){var v=m.valueOf();n.push(v)}}else if(p.TotalDays>=30&&isNaN(this._unit)){(g=new Date(a.getFullYear(),a.getMonth(),1))<a&&g.setMonth(g.getMonth()+1);var b=p.TotalDays/30;b-=b%1;for(m=g;m<=s;m.setMonth(m.getMonth()+b)){v=m.valueOf();n.push(v)}}else{var S=1e3*f/t._timeSpan.TicksPerSecond,C=(m=g,a.getTime()-m.getTime());for(C>S&&(m=new Date(m.getTime()+Math.floor(C/S)*S));m<=s;m=new Date(m.getTime()+S))if(m>=a){v=m.valueOf();n.push(v)}}return n},i}(t.LinearScale);t.TimeScale=e}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.getSymbol=function(e){var i=t.plugins._symbolNames();return null!=i&&i.length>0?i[e%i.length]:null},e}();e._SymbolProvider=i}(t.models||(t.models={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(t,e,i,n){void 0===n&&(n=!1),this.__actualMin=t,this.__actualMax=e,this.__round=n,t==e?(this._min=t,this._max=e,this._unit=0):(this._unit=this._calculateUnit(t,e,i),n?(this._min=this._calculateRoundedMin(this.__actualMin,this._unit),this._max=this._calculateRoundedMax(this.__actualMax,this._unit)):(this._min=t,this._max=e))}return Object.defineProperty(t.prototype,"ticks",{get:function(){var t=[];if(this._min==this._max)t.push(this._min);else if(this.__round)for(var e=this._min;e<=this._max;)t.push(e),e+=this._unit;else for((e=this._calculateRoundedMin(this.__actualMin,this._unit))<this._min&&(e+=this._unit);e<=this._max;)t.push(e),e+=this._unit;return t},enumerable:!0,configurable:!0}),t.prototype._calculateRoundedMin=function(t,e){var i=this._niceTickNumber(t);if(i>t)for(;i>t;)i-=e;else for(;i+e<=t;)i+=e;return i},t.prototype._calculateRoundedMax=function(t,e){var i=this._niceTickNumber(t);if(i<t)for(;i<t;)i+=e;else for(;i-e>=t;)i-=e;return i},t.prototype._calculateUnit=function(t,e,i){var n=e-t,r=this._nicePrecision(n),o=n/i,a=this._niceNumber(2*o,-r,!0);return a<o&&(a=this._niceNumber(o,1-r,!1)),a<o&&(a=this._niceTickNumber(o)),a},t.prototype._nicePrecision=function(t){if(t<=0||isNaN(t))return 0;var e,i=Math.log(t)/Math.LN10;e=i>=0?Math.floor(i):Math.ceil(i);var n=t/Math.pow(10,e);return n<3&&(e=1-e,(n=t/Math.pow(10,e))<3&&(e+=1)),e},t.prototype._niceNumber=function(t,e,i){if(0==t)return t;t<0&&(t=-t);var n=t/Math.pow(10,e),r=10;return i?n<1.5?r=1:n<3?r=2:n<4.5?r=4:n<7&&(r=5):n<=1?r=1:n<=2?r=2:n<=5&&(r=5),r*Math.pow(10,e)},t.prototype._niceTickNumber=function(t){if(0==t)return t;t<0&&(t=-t);var e=Math.log(t)/Math.LN10,i=Math.floor(e),n=t/Math.pow(10,i),r=10;return n<=1?r=1:n<=2?r=2:n<=5&&(r=5),r*Math.pow(10,i)},t}();t._NumberTicksGenerator=e}(t.models||(t.models={}))}(r||(r={})),function(t){!function(t){var e=function(){function t(t){this.__option=null==t?{}:t}return t.prototype._option=function(){return this.__option},t.prototype._isEmpty=function(){return Object.getOwnPropertyNames(this._option()).length<=0},t}();t.__Option=e}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(e){var n=i.call(this,e)||this;return n.type=n._option().type,n.plots=n._option().plots,n.title=n._option().title,n.position=n._option().position,n.overlappingLabels=n._option().overlappingLabels,n.labels=n._option().labels,n.max=n._option().max,n.min=n._option().min,n.format=n._option().format,n.scale=n._option().scale,n.style=n._option().style,n.textStyle=n._option().textStyle,n.labelStyle=n._option().labelStyle,n.titleStyle=n._option().titleStyle,n.majorUnit=n._option().majorUnit,n.minorUnit=n._option().minorUnit,n.majorTicks=n._option().majorTicks,n.minorTicks=n._option().minorTicks,n.majorTickSize=n._option().majorTickSize,n.minorTickSize=n._option().minorTickSize,n.majorTickStyle=n._option().majorTickStyle,n.minorTickStyle=n._option().minorTickStyle,n.majorGrid=n._option().majorGrid,n.minorGrid=n._option().minorGrid,n.majorGridStyle=n._option().majorGridStyle,n.minorGridStyle=n._option().minorGridStyle,n.lineStyle=n._option().lineStyle,n.origin=n._option().origin,n.reversed=n._option().reversed,n.labelAngle=n._option().labelAngle,n.logBase=n._option().logBase,null==n.majorTicks&&(n.majorTicks=t.TickMark.None),null==n.minorTicks&&(n.minorTicks=t.TickMark.None),null==n.overlappingLabels&&(n.overlappingLabels=t.AxisOverlappingLabels.Auto),null==n.position&&(n.position=t.AxisPosition.Near),null==n.minorGrid&&(n.minorGrid=!1),null==n.labels&&(n.labels=!0),null==n.axisLine&&(n.axisLine=!0),n}return s(n,i),Object.defineProperty(n.prototype,"type",{get:function(){return this.__type},set:function(e){null!=this.__type&&this.__type==e||(this.__type=t.core.asEnum(e,t.AxisType,!0),null==this.__type&&(this.__type=t.AxisType.X))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"plots",{get:function(){return this.__plots},set:function(e){if((null==this.__plots||this.__plots!=e)&&(this.__plots=[],null!=e)){Array.isArray(e)||(e=[e]);for(var i=0,n=e;i<n.length;i++){var r=n[i],o=t.core.asString(r,!0);null!=o&&this.__plots.push(o)}}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"title",{get:function(){return this.__title},set:function(e){null!=this.__title&&this.__title==e||(this.__title=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.__position},set:function(e){null!=this.__position&&this.__position==e||(this.__position=t.core.asEnum(e,t.AxisPosition,!0),null==this.__position&&(this.__position=t.AxisPosition.Near))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"overlappingLabels",{get:function(){return this.__overlappingLabels},set:function(e){null!=this.__overlappingLabels&&this.__overlappingLabels==e||(this.__overlappingLabels=t.core.asEnum(e,t.AxisOverlappingLabels,!0),null==this.__overlappingLabels&&(this.__overlappingLabels=t.AxisOverlappingLabels.Auto))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"labels",{get:function(){return this.__labels},set:function(e){null!=this.__labels&&this.__labels==e||(this.__labels=t.core.asBoolean(e,!0),null==this.__labels&&(this.__labels=!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"max",{get:function(){return this.__max},set:function(e){this.__max!=e&&(t.core.isDate(e)?this.__max=t.core.asDate(e,!0):this.__max=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"min",{get:function(){return this.__min},set:function(e){this.__min!=e&&(t.core.isDate(e)?this.__min=t.core.asDate(e,!0):this.__min=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"format",{get:function(){return this.__format},set:function(e){this.__format!=e&&(this.__format=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"scale",{get:function(){return this.__scale},set:function(i){if(null==this.__scale||this.__scale!=i){var n=new e._ValueScaleOption(i);if(this.type==t.AxisType.Y&&null!=n&&n.type==t.ValueScaleType.Ordinal)throw"Ordinal Scale is not supported in y axis!";this.__scale=n}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"axisLine",{get:function(){return this.__axisLine},set:function(e){e!=this.__axisLine&&(this.__axisLine=t.core.asBoolean(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.__style},set:function(t){null!=this.__style&&this.__style==t||(this.__style=new e._StyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textStyle",{get:function(){return this.__textStyle},set:function(t){null!=this.__textStyle&&this.__textStyle==t||(this.__textStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"labelStyle",{get:function(){return this.__labelStyle},set:function(t){null!=this.__labelStyle&&this.__labelStyle==t||(this.__labelStyle=new e._LabelStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"titleStyle",{get:function(){return this.__titleStyle},set:function(t){null!=this.__titleStyle&&this.__titleStyle==t||(this.__titleStyle=new e._LabelStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"majorUnit",{get:function(){return this.__majorUnit},set:function(e){this.__majorUnit!=e&&(this.__majorUnit=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minorUnit",{get:function(){return this.__minorUnit},set:function(e){this.__minorUnit!=e&&(this.__minorUnit=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"majorTicks",{get:function(){return this.__majorTicks},set:function(e){null!=this.__majorTicks&&this.__majorTicks==e||(this.__majorTicks=t.core.asEnum(e,t.TickMark,!0),null==this.__majorTicks&&(this.__majorTicks=t.TickMark.Outside))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minorTicks",{get:function(){return this.__minorTicks},set:function(e){null!=this.__minorTicks&&this.__minorTicks==e||(this.__minorTicks=t.core.asEnum(e,t.TickMark,!0),null==this.__minorTicks&&(this.__minorTicks=t.TickMark.None))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"majorTickSize",{get:function(){return this.__majorTickSize},set:function(e){null!=this.__majorTickSize&&this.__majorTickSize==e||(this.__majorTickSize=t.core.asNumber(e,!0),null==this.__majorTickSize&&(this.__majorTickSize=4))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minorTickSize",{get:function(){return this.__minorTickSize},set:function(e){null!=this.__minorTickSize&&this.__minorTickSize==e||(this.__minorTickSize=t.core.asNumber(e,!0),null==this.__minorTickSize&&(this.__minorTickSize=2))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"majorTickStyle",{get:function(){return this.__majorTickStyle},set:function(t){null!=this.__majorTickStyle&&this.__majorTickStyle==t||(this.__majorTickStyle=new e._LineStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minorTickStyle",{get:function(){return this.__minorTickStyle},set:function(t){null!=this.__minorTickStyle&&this.__minorTickStyle==t||(this.__minorTickStyle=new e._LineStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"majorGrid",{get:function(){return this.__majorGrid},set:function(e){null!=this.__majorGrid&&this.__majorGrid==e||(this.__majorGrid=t.core.asBoolean(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minorGrid",{get:function(){return this.__minorGrid},set:function(e){null!=this.__minorGrid&&this.__minorGrid==e||(this.__minorGrid=t.core.asBoolean(e,!0),null==this.__minorGrid&&(this.__minorGrid=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"majorGridStyle",{get:function(){return this.__majorGridStyle},set:function(t){null!=this.__majorGridStyle&&this.__majorGridStyle==t||(this.__majorGridStyle=new e._LineStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"minorGridStyle",{get:function(){return this.__minorGridStyle},set:function(t){null!=this.__minorGridStyle&&this.__minorGridStyle==t||(this.__minorGridStyle=new e._LineStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineStyle",{get:function(){return this.__lineStyle},set:function(t){null!=this.__lineStyle&&this.__lineStyle==t||(this.__lineStyle=new e._LineStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"origin",{get:function(){return this.__origin},set:function(e){this.__origin!=e&&(this.__origin=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"reversed",{get:function(){return this.__reversed},set:function(e){null!=this.__reversed&&this.__reversed==e||(this.__reversed=t.core.asBoolean(e,!0),null==this.__reversed&&(this.__reversed=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"labelAngle",{get:function(){return this.__labelAngle},set:function(e){null!=this.__labelAngle&&this.__labelAngle==e||(this.__labelAngle=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"logBase",{get:function(){return this.__logBase},set:function(e){null!=this.__logBase&&this.__logBase==e||(this.__logBase=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),n}(e.__Option);e._AxisOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.topWidth=i._option().topWidth,i.width=i._option().width,i.bottomWidth=i._option().bottomWidth,i.neckHeight=i._option().neckHeight,i.overlap=i._option().overlap,i}return s(i,e),Object.defineProperty(i.prototype,"width",{get:function(){return this.__width},set:function(e){null!=e&&this.__width!=e&&(this.__width=t.core.asNumber(e,!0),this.__width>1?this.__width=1:this.__width<0&&(this.__width=0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottomWidth",{get:function(){return this.__bottomWidth},set:function(t){null!=t&&this.__bottomWidth!=t&&(this.__bottomWidth=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topWidth",{get:function(){return this.__width},set:function(e){null!=e&&this.__width!=e&&(this.__width=t.core.asNumber(e,!0),this.__width>1?this.__width=1:this.__width<0&&(this.__width=0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"neckHeight",{get:function(){return this.__neckHeight},set:function(t){null!=t&&this.__neckHeight!=t&&(this.__neckHeight=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"overlap",{get:function(){return this.__barOverlap},set:function(e){null!=this.__barOverlap&&this.__barOverlap==e||(this.__barOverlap=t.core.asNumber(e,!0),null==this.__barOverlap?this.__barOverlap=0:this.__barOverlap>1?this.__barOverlap=1:this.__barOverlap<-1&&(this.__barOverlap=-1))},enumerable:!0,configurable:!0}),i}(e.__Option);e._BarOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.header=e._option().header,e.headerStyle=e._option().headerStyle,e.headerTextStyle=e._option().headerTextStyle,e.footer=e._option().footer,e.footerStyle=e._option().footerStyle,e.footerTextStyle=e._option().footerTextStyle,e.palette=e._option().palette,e.plotAreas=e._option().plotAreas,e.plotAreaLayout=e._option().plotAreaLayout,e.borderStyle=e._option().borderStyle,e.backgroundColor=e._option().backgroundColor,e.legend=e._option().legend,e.selectionMode=e._option().selectionMode,e.selectedStyle=e._option().selectedStyle,e.unselectedStyle=e._option().unselectedStyle,e.style=e._option().style,e.textStyle=e._option().textStyle,e.bar=e._option().bar,e}return s(n,i),Object.defineProperty(n.prototype,"bar",{get:function(){return this.__bar},set:function(t){null!=this.__bar&&this.__bar==t||(this.__bar=new e._BarOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"header",{get:function(){return this.__header},set:function(e){this.__header!=e&&(this.__header=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"headerStyle",{get:function(){return this.__headerStyle},set:function(t){null!=this.__headerStyle&&this.__headerStyle==t||(this.__headerStyle=new e._StyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"headerTextStyle",{get:function(){return this.__headerTextStyle},set:function(t){null!=this.__headerTextStyle&&this.__headerTextStyle==t||(this.__headerTextStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"footer",{get:function(){return this.__footer},set:function(e){this.__footer!=e&&(this.__footer=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"footerStyle",{get:function(){return this.__footerStyle},set:function(t){null!=this.__footerStyle&&this.__footerStyle==t||(this.__footerStyle=new e._StyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"footerTextStyle",{get:function(){return this.__footerTextStyle},set:function(t){null!=this.__footerTextStyle&&this.__footerTextStyle==t||(this.__footerTextStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"palette",{get:function(){return this.__palette},set:function(e){if(null==this.__palette||this.__palette!=e)if(Array.isArray(e)){this.__palette=[];for(var i=0,n=e;i<n.length;i++){var r=n[i],o=t.core.asString(r,!0);null!=o&&this.__palette.push(o)}this.__palette.length<=0&&(this.__palette=t.Palette.Office)}else this.__palette=t.core.asEnum(e,t.Palette,!0),null==this.__palette&&(this.__palette=t.Palette.Office)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"plotAreas",{get:function(){return this.__plotAreas},set:function(i){if((null==this.__plotAreas||this.__plotAreas!=i)&&(this.__plotAreas=[],null!=i)){Array.isArray(i)||(i=[i]);for(var n=0;n<i.length;n++){var r=new e._PlotAreaOption(i[n]);null==r.row&&(r.row=n),null==r.column&&(r.column=0);for(var o=0,a=this.__plotAreas;o<a.length;o++){var s=a[o];s.row==r.row&&s.column==r.column&&t._throwException(t.Exception.Option_Config_DuplicatedRowAndColumnOfPlotArea)}this.__plotAreas.push(r)}}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"plotAreaLayout",{get:function(){return this.__plotAreaLayout},set:function(t){null!=this.__plotAreaLayout&&this.__plotAreaLayout==t||(this.__plotAreaLayout=new e._PlotAreaLayoutOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"borderStyle",{get:function(){return this.__borderStyle},set:function(t){null!=this.__borderStyle&&this.__borderStyle==t||(this.__borderStyle=new e._LineStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.__backgroundColor},set:function(e){null!=this.__backgroundColor&&this.__backgroundColor==e||(this.__backgroundColor=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"legend",{get:function(){return this.__legend},set:function(t){null!=this.__legend&&this.__legend==t||(this.__legend=new e._GlobalLegendOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectionMode",{get:function(){return this.__selectionMode},set:function(e){null!=this.__selectionMode&&this.__selectionMode==e||(this.__selectionMode=t.core.asEnum(e,t.SelectionMode,!0),null==this.__selectionMode&&(this.__selectionMode=t.SelectionMode.None))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"selectedStyle",{get:function(){return this.__selectedStyle},set:function(t){null!=this.__selectedStyle&&this.__selectedStyle==t||(this.__selectedStyle=new e._SelectionStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"unselectedStyle",{get:function(){return this.__unSelectedStyle},set:function(t){null!=this.__unSelectedStyle&&this.__unSelectedStyle==t||(this.__unSelectedStyle=new e._SelectionStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.__style},set:function(t){null!=this.__style&&this.__style==t||(this.__style=new e._StyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textStyle",{get:function(){return this.__textStyle},set:function(t){null!=this.__textStyle&&this.__textStyle==t||(this.__textStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),n}(e.__Option);e._ConfigOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.name=i._option().name,i.values=i._option().values,i.dateFormats=i._option().dateFormats,i}return s(i,e),Object.defineProperty(i.prototype,"name",{get:function(){return this.__name},set:function(e){this.__name!=e&&(this.__name=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"values",{get:function(){return this.__values},set:function(t){if((null==this.__values||this.__values!=t)&&(this.__values=[],null!=t)){Array.isArray(t)||(t=[t]);for(var e=0,i=t;e<i.length;e++){var n=i[e];this.__values.push(n)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dateFormats",{get:function(){return this.__dateFormats},set:function(e){if(null==this.__dateFormats||this.__dateFormats!=e)if(null==e)this.__dateFormats=!0;else if("boolean"==typeof e)this.__dateFormats=e;else if("string"==typeof e)this.__dateFormats=[e];else if(Array.isArray(e)){for(var i=[],n=0,r=e;n<r.length;n++){var o=r[n],a=t.core.asString(o,!0);null!=a&&i.push(a)}this.__dateFormats=i}else t.core.assert(!1,"A date format is wrong.")},enumerable:!0,configurable:!0}),i}(e.__Option);e._DataOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.opacity=i._option().opacity,i.fill=i._option().fill,i.stroke=i._option().stroke,i.strokeWidth=i._option().strokeWidth,i.strokeDasharray=i._option().strokeDasharray,i.symbolOpacity=i._option().symbolOpacity,i.symbolFill=i._option().symbolFill,i.symbolStroke=i._option().symbolStroke,i.symbolStrokeWidth=i._option().symbolStrokeWidth,i.symbolStrokeDasharray=i._option().symbolStrokeDasharray,i}return s(i,e),Object.defineProperty(i.prototype,"opacity",{get:function(){return this.__opacity},set:function(e){this.__opacity!=e&&(this.__opacity=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fill",{get:function(){return this.__fill},set:function(e){this.__fill!=e&&(this.__fill=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this.__stroke},set:function(e){this.__stroke!=e&&(this.__stroke=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"strokeWidth",{get:function(){return this.__strokeWidth},set:function(e){this.__strokeWidth!=e&&(this.__strokeWidth=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"strokeDasharray",{get:function(){return this.__strokeDasharray},set:function(e){this.__strokeDasharray!=e&&(this.__strokeDasharray=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"symbolOpacity",{get:function(){return this.__symbolOpacity},set:function(e){this.__symbolOpacity!=e&&(this.__symbolOpacity=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"symbolFill",{get:function(){return this.__symbolFill},set:function(e){this.__symbolFill!=e&&(this.__symbolFill=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"symbolStroke",{get:function(){return this.__symbolStroke},set:function(e){this.__symbolStroke!=e&&(this.__symbolStroke=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"symbolStrokeWidth",{get:function(){return this.__symbolStrokeWidth},set:function(e){this.__symbolStrokeWidth!=e&&(this.__symbolStrokeWidth=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"symbolStrokeDasharray",{get:function(){return this.__symbolStrokeDasharray},set:function(e){this.__symbolStrokeDasharray!=e&&(this.__symbolStrokeDasharray=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),i}(e.__Option);e._DataPointStyleOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.field=i._option().field,i}return s(i,e),Object.defineProperty(i.prototype,"field",{get:function(){return this.__field},set:function(e){this.__field!=e&&(this.__field=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),i}(e.__Option);e._EncodingOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.orientation=e._option().orientation,e.position=e._option().position,e.wrapping=e._option().wrapping,e.style=e._option().style,e.titleStyle=e._option().titleStyle,e.textStyle=e._option().textStyle,e.hidden=e._option().hidden,e}return s(n,i),Object.defineProperty(n.prototype,"orientation",{get:function(){return this.__orientation},set:function(e){this.__orientation!=e&&(this.__orientation=t.core.asEnum(e,t.Orientation,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.__position},set:function(e){null!=this.__position&&this.__position==e||(this.__position=t.core.asEnum(e,t.Position,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"wrapping",{get:function(){return this.__wrapping},set:function(e){null!=this.__position&&this.__wrapping==e||(this.__wrapping=t.core.asBoolean(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.__style},set:function(t){null!=this.__style&&this.__style==t||(this.__style=new e._StyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textStyle",{get:function(){return this.__textStyle},set:function(t){null!=this.__textStyle&&this.__textStyle==t||(this.__textStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"titleStyle",{get:function(){return this.__titleStyle},set:function(t){null!=this.__titleStyle&&this.__titleStyle==t||(this.__titleStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hidden",{get:function(){return this.__hidden},set:function(t){null!=this.__hidden&&this.__hidden==t||(this.__hidden=t)},enumerable:!0,configurable:!0}),n}(e.__Option);e._GlobalLegendOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.type=e._option().type,e.orientation=e._option().orientation,e.position=e._option().position,e.title=e._option().title,e.style=e._option().style,e.titleStyle=e._option().titleStyle,e.textStyle=e._option().textStyle,e.hidden=e._option().hidden,e}return s(n,i),Object.defineProperty(n.prototype,"type",{get:function(){return this.__type},set:function(e){this.__type!=e&&(this.__type=t.core.asEnum(e,t.LegendType,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"orientation",{get:function(){return this.__orientation},set:function(e){this.__orientation!=e&&(this.__orientation=t.core.asEnum(e,t.Orientation,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.__position},set:function(e){null!=this.__position&&this.__position==e||(this.__position=t.core.asEnum(e,t.Position,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"title",{get:function(){return this.__title},set:function(e){this.__title!=e&&(this.__title=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.__style},set:function(t){null!=this.__style&&this.__style==t||(this.__style=new e._StyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textStyle",{get:function(){return this.__textStyle},set:function(t){null!=this.__textStyle&&this.__textStyle==t||(this.__textStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"titleStyle",{get:function(){return this.__titleStyle},set:function(t){null!=this.__titleStyle&&this.__titleStyle==t||(this.__titleStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ranges",{get:function(){return this.__ranges},set:function(t){null!=this.__ranges&&this.__ranges==t||(this.__ranges=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hidden",{get:function(){return this.__hidden},set:function(t){null!=this.__hidden&&this.__hidden==t||(this.__hidden=t)},enumerable:!0,configurable:!0}),n}(e.__Option);e._LegendOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.opacity=i._option().opacity,i.stroke=i._option().stroke,i.strokeWidth=i._option().strokeWidth,i.strokeDasharray=i._option().strokeDasharray,i}return s(i,e),Object.defineProperty(i.prototype,"opacity",{get:function(){return this.__opacity},set:function(e){null!=this.__opacity&&this.__opacity==e||(this.__opacity=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stroke",{get:function(){return this.__stroke},set:function(e){this.__stroke!=e&&(this.__stroke=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"strokeWidth",{get:function(){return this.__strokeWidth},set:function(e){null!=this.__strokeWidth&&this.__strokeWidth==e||(this.__strokeWidth=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"strokeDasharray",{get:function(){return this.__strokeDasharray},set:function(e){this.__strokeDasharray!=e&&(this.__strokeDasharray=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),i}(e.__Option);e._LineStyleOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;if("string"==typeof t){var n=i._parse(t);i.left=n.left,i.top=n.top,i.right=n.right,i.bottom=n.bottom}else"number"==typeof t?i.top=i.bottom=i.left=i.right=t:(i.left=i._option().left,i.top=i._option().top,i.right=i._option().right,i.bottom=i._option().bottom);return i}return s(i,e),Object.defineProperty(i.prototype,"left",{get:function(){return this.__left},set:function(e){null!=this.__left&&this.__left==e||(this.__left=t.core.asNumber(e,!0),null==this.__left&&(this.__left=0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"top",{get:function(){return this.__top},set:function(e){null!=this.__top&&this.__top==e||(this.__top=t.core.asNumber(e,!0),null==this.__top&&(this.__top=0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"right",{get:function(){return this.__right},set:function(e){null!=this.__right&&this.__right==e||(this.__right=t.core.asNumber(e,!0),null==this.__right&&(this.__right=0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottom",{get:function(){return this.__bottom},set:function(e){null!=this.__bottom&&this.__bottom==e||(this.__bottom=t.core.asNumber(e,!0),null==this.__bottom&&(this.__bottom=0))},enumerable:!0,configurable:!0}),i.prototype._parse=function(e){var i={left:0,top:0,right:0,bottom:0},n=t.core.asString(e).split(",",4),r=NaN,o=NaN,a=NaN,s=NaN;return n&&(4==n.length?(r=parseFloat(n[0]),s=parseFloat(n[1]),o=parseFloat(n[2]),a=parseFloat(n[3])):3==n.length?(r=parseFloat(n[0]),a=s=parseFloat(n[1]),o=parseFloat(n[2])):2==n.length?(r=o=parseFloat(n[0]),a=s=parseFloat(n[1])):1==n.length&&(r=o=a=s=parseFloat(n[0])),isNaN(r)||(i.top=r),isNaN(o)||(i.bottom=o),isNaN(a)||(i.left=a),isNaN(s)||(i.right=s)),i},i}(e.__Option);e._PaddingOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(t){var e=function(t){function e(e){var i=t.call(this,e)||this;return i.columnWidths=i._option().columnWidths,i.rowHeights=i._option().rowHeights,i}return s(e,t),Object.defineProperty(e.prototype,"columnWidths",{get:function(){return this.__columnWidths},set:function(t){if((null==this.__columnWidths||this.__columnWidths!=t)&&(this.__columnWidths=[],null!=t)){Array.isArray(t)||(t=[t]);for(var e=0,i=t;e<i.length;e++){var n=i[e];"string"!=typeof n&&"number"!=typeof n||this.__columnWidths.push(n)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowHeights",{get:function(){return this.__rowHeights},set:function(t){if((null==this.__rowHeights||this.__rowHeights!=t)&&(this.__rowHeights=[],null!=t)){Array.isArray(t)||(t=[t]);for(var e=0,i=t;e<i.length;e++){var n=i[e];"string"!=typeof n&&"number"!=typeof n||this.__rowHeights.push(n)}}},enumerable:!0,configurable:!0}),e}(t.__Option);t._PlotAreaLayoutOption=e}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.row=e._option().row,e.column=e._option().column,e.axes=e._option().axes,e.legend=e._option().legend,e.legends=e._option().legends,e.borderStyle=e._option().borderStyle,e.backgroundColor=e._option().backgroundColor,e.padding=e._option().padding,e.style=e._option().style,e.textStyle=e._option().textStyle,e}return s(n,i),Object.defineProperty(n.prototype,"row",{get:function(){return this.__row},set:function(e){null!=this.__row&&this.__row==e||(this.__row=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"column",{get:function(){return this.__column},set:function(e){null!=this.__column&&this.__column==e||(this.__column=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"axes",{get:function(){return this.__axes},set:function(t){if((null==this.__axes||this.__axes!=t)&&(this.__axes=[],null!=t)){Array.isArray(t)||(t=[t]);for(var i=0,n=t;i<n.length;i++){var r=n[i];this.__axes.push(new e._AxisOption(r))}}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"legend",{get:function(){return this.__legend},set:function(t){null!=this.__legend&&this.__legend==t||(this.__legend=new e._GlobalLegendOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"legends",{get:function(){return this.__legends},set:function(t){if((null==this.__legends||this.__legends!=t)&&(this.__legends=[],null!=t)){Array.isArray(t)||(t=[t]);for(var i=0,n=t;i<n.length;i++){var r=n[i];this.__legends.push(new e._LegendOption(r))}}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"borderStyle",{get:function(){return this.__borderStyle},set:function(t){null!=this.__borderStyle&&this.__borderStyle==t||(this.__borderStyle=new e._LineStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.__backgroundColor},set:function(e){null!=this.__backgroundColor&&this.__backgroundColor==e||(this.__backgroundColor=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"padding",{get:function(){return this.__padding},set:function(t){null!=this.__padding&&this.__padding==t||(this.__padding=new e._PaddingOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.__style},set:function(t){null!=this.__style&&this.__style==t||(this.__style=new e._PlotAreaStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textStyle",{get:function(){return this.__textStyle},set:function(t){this.__textStyle!=t&&(this.__textStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),n}(e.__Option);e._PlotAreaOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.radial=e._option().radial,e.symbols=e._option().symbols,e.swapAxes=e._option().swapAxes,e.clippingMode=e._option().clippingMode,e.showNulls=e._option().showNulls,e.lineAspect=e._option().lineAspect,e.offset=e._option().offset,e.innerRadius=e._option().innerRadius,e.sweep=e._option().sweep,e.startAngle=e._option().startAngle,e.rules=e._option().rules,e.barLines=e._option().barLines,e.style=e._option().style,e.textStyle=e._option().textStyle,e.hoverStyle=e._option().hoverStyle,e.text=e._option().text,e.tooltip=e._option().tooltip,e}return s(n,i),Object.defineProperty(n.prototype,"radial",{get:function(){return this.__radial},set:function(e){null!=this.__radial&&this.__radial==e||(this.__radial=t.core.asBoolean(e,!0),null==this.__radial&&(this.__radial=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"symbols",{get:function(){return this.__symbols},set:function(e){null!=this.__symbols&&this.__symbols==e||(this.__symbols=t.core.asBoolean(e,!0),null==this.__symbols&&(this.__symbols=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"swapAxes",{get:function(){return this.__swapAxes},set:function(e){null!=this.__swapAxes&&this.__swapAxes==e||(this.__swapAxes=t.core.asBoolean(e,!0),null==this.__swapAxes&&(this.__swapAxes=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"clippingMode",{get:function(){return this.__clippingMode},set:function(e){null!=this.__clippingMode&&this.__clippingMode==e||(this.__clippingMode=t.core.asEnum(e,t.ClippingMode,!0),null==this.__clippingMode&&(this.__clippingMode=t.ClippingMode.None))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showNulls",{get:function(){return this.__showNulls},set:function(e){null!=this.__showNulls&&this.__showNulls==e||(this.__showNulls=t.core.asEnum(e,t.ShowNulls,!0),null==this.__showNulls&&(this.__showNulls=t.ShowNulls.Connected))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineAspect",{get:function(){return this.__lineAspect},set:function(e){null!=this.__lineAspect&&this.__lineAspect==e||(this.__lineAspect=t.core.asEnum(e,t.LineAspect,!0),null==this.__lineAspect&&(this.__lineAspect=t.LineAspect.Default))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"offset",{get:function(){return this.__offset},set:function(e){null!=this.__lineAspect&&this.__lineAspect==e||(this.__offset=t.core.asNumber(e,!0),null==this.__offset?this.__offset=0:this.__offset>1?this.__offset=1:this.__offset<-1&&(this.__offset=-1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"innerRadius",{get:function(){return this.__innerRadius},set:function(e){null!=this.__innerRadius&&this.__innerRadius==e||(this.__innerRadius=t.core.asNumber(e,!0),null==this.__innerRadius&&(this.__innerRadius=0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sweep",{get:function(){return this.__sweep},set:function(e){null!=this.__sweep&&this.__sweep==e||(this.__sweep=t.core.asNumber(e,!0),null==this.__sweep&&(this.__sweep=360))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"startAngle",{get:function(){return this.__startAngle},set:function(e){null!=this.__startAngle&&this.__startAngle==e||(this.__startAngle=t.core.asNumber(e,!0),null==this.__startAngle&&(this.__startAngle=0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rules",{get:function(){return this.__rules},set:function(t){if((null==this.__rules||this.__rules!=t)&&(this.__rules=[],null!=t)){Array.isArray(t)||(t=[t]);for(var i=0,n=t;i<n.length;i++){var r=n[i];this.__rules.push(new e._RuleOption(r))}}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"barLines",{get:function(){return this.__barLines},set:function(e){null!=this.__barLines&&this.__barLines==e||(this.__barLines=t.core.asBoolean(e,!0),null==this.__barLines&&(this.__barLines=!1))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.__style},set:function(t){(null==this.__style||(this.__style=t))&&(this.__style=new e._DataPointStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textStyle",{get:function(){return this.__textStyle},set:function(t){null!=this.__textStyle&&this.__textStyle==t||(this.__textStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hoverStyle",{get:function(){return this.__hoverStyle},set:function(t){(null==this.__hoverStyle||(this.__hoverStyle=t))&&(this.__hoverStyle=new e._DataPointStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.__text},set:function(t){null!=this.__text&&this.__text==t||(this.__text=new e._PlotConfigTextOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"tooltip",{get:function(){return this.__tooltip},set:function(t){null!=this.__tooltip&&this.__tooltip==t||(this.__tooltip=new e._PlotConfigTooltipOption(t))},enumerable:!0,configurable:!0}),n}(e.__Option);e._PlotConfigOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.scope=e._option().scope,e.template=e._option().template,e.position=e._option().position,e.offset=e._option().offset,e.overlappingLabels=e._option().overlappingLabels,e.connectingLine=e._option().connectingLine,e.linePosition=e._option().linePosition,e.style=e._option().style,e.textStyle=e._option().textStyle,e}return s(n,i),Object.defineProperty(n.prototype,"scope",{get:function(){return this.__scope},set:function(e){this.__scope!=e&&(this.__scope=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"template",{get:function(){return this.__template},set:function(e){this.__template!=e&&(this.__template=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.__position},set:function(e){null!=this.__position&&this.__position==e||(this.__position=t.core.asEnum(e,t.TextPosition,!0),null==this.__position&&(this.__position=t.TextPosition.Auto))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"offset",{get:function(){return this.__offset},set:function(e){null!=this.__offset&&this.__offset==e||(this.__offset=t.core.asNumber(e,!0),null==this.__offset&&(this.__offset=0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"overlappingLabels",{get:function(){return this.__overlappingLabels},set:function(e){null!=this.__overlappingLabels&&this.__overlappingLabels==e||(this.__overlappingLabels=t.core.asEnum(e,t.OverlappingLabels,!0),null==this.__overlappingLabels&&(this.__overlappingLabels=t.OverlappingLabels.Auto))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"connectingLine",{get:function(){return this.__connectingLine},set:function(t){null!=this.__connectingLine&&this.__connectingLine==t||(this.__connectingLine=new e._LineStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"linePosition",{get:function(){return this.__linePosition},set:function(e){null!=this.__linePosition&&this.__linePosition==e||(this.__linePosition=t.core.asEnum(e,t.LinePosition,!0),null==this.__linePosition&&(this.__linePosition=t.LinePosition.Auto))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.__style},set:function(t){(null==this.__style||(this.__style=t))&&(this.__style=new e._StyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textStyle",{get:function(){return this.__textStyle},set:function(t){null!=this.__textStyle&&this.__textStyle==t||(this.__textStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),n}(e.__Option);e._PlotConfigTextOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.scope=e._option().scope,e.template=e._option().template,e.style=e._option().style,e.textStyle=e._option().textStyle,e}return s(n,i),Object.defineProperty(n.prototype,"scope",{get:function(){return this.__scope},set:function(e){this.__scope!=e&&(this.__scope=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"template",{get:function(){return this.__template},set:function(e){this.__template!=e&&(this.__template=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.__style},set:function(t){(null==this.__style||(this.__style=t))&&(this.__style=new e._StyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"textStyle",{get:function(){return this.__textStyle},set:function(t){null!=this.__textStyle&&this.__textStyle==t||(this.__textStyle=new e._TextStyleOption(t))},enumerable:!0,configurable:!0}),n}(e.__Option);e._PlotConfigTooltipOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(t){var e=function(e){function i(t){var i=e.call(this,t)||this;return i.__details=[],i.__text=[],i.__tooltip=[],i.values=i._option().values,i.category=i._option().category,i.details=i._option().details,i.color=i._option().color,i.size=i._option().size,i.shape=i._option().shape,i.text=i._option().text,i.tooltip=i._option().tooltip,i}return s(i,e),Object.defineProperty(i.prototype,"values",{get:function(){return this.__values},set:function(e){if((null==this.__values||this.__values!=e)&&(this.__values=[],null!=e)){Array.isArray(e)||(e=[e]);for(var i=0,n=e;i<n.length;i++){var r=n[i],o=new t._ValueAggregateEncodingOption(r);null!=o.field&&this.__values.push(o)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"category",{get:function(){return this.__category},set:function(e){null!=this.__category&&this.__category==e||(this.__category=new t._EncodingOption(e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"details",{get:function(){return this.__details},set:function(e){if((null==this.__details||this.__details!=e)&&(this.__details=[],null!=e)){Array.isArray(e)||(e=[e]);for(var i=0,n=e;i<n.length;i++){var r=n[i],o=new t._DetailEncodingOption(r);null!=o.field&&this.__details.push(o)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"color",{get:function(){return this.__color},set:function(e){null!=this.__color&&this.__color==e||(this.__color=new t._EncodingOption(e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){return this.__size},set:function(e){null!=this.__size&&this.__size==e||(this.__size=new t._EncodingOption(e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"shape",{get:function(){return this.__shape},set:function(e){null!=this.__shape&&this.__shape==e||(this.__shape=new t._EncodingOption(e))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"text",{get:function(){return this.__text},set:function(e){if((null==this.__text||this.__text!=e)&&(this.__text=[],null!=e)){Array.isArray(e)||(e=[e]);for(var i=0,n=e;i<n.length;i++){var r=n[i],o=new t._AggregateEncodingOption(r);null!=o.field&&this.__text.push(o)}}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"tooltip",{get:function(){return this.__tooltip},set:function(e){if((null==this.__tooltip||this.__tooltip!=e)&&(this.__tooltip=[],null!=e)){Array.isArray(e)||(e=[e]);for(var i=0,n=e;i<n.length;i++){var r=n[i],o=new t._AggregateEncodingOption(r);null!=o.field&&this.__tooltip.push(o)}}},enumerable:!0,configurable:!0}),i}(t.__Option);t._PlotEncodingsOption=e}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.name=e._option().name,e.type=e._option().type,e.encodings=e._option().encodings,e.config=e._option().config,e}return s(n,i),Object.defineProperty(n.prototype,"name",{get:function(){return this.__name},set:function(e){this.__name!=e&&(this.__name=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this.__type},set:function(e){this.__type!=e&&(this.__type=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"encodings",{get:function(){return this.__encodings},set:function(t){null!=this.__encodings&&this.__encodings==t||(this.__encodings=new e._PlotEncodingsOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"config",{get:function(){return this.__config},set:function(t){null!=this.__config&&this.__config==t||(this.__config=new e._PlotConfigOption(t))},enumerable:!0,configurable:!0}),n}(e.__Option);e._PlotOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.__properties=[],e.targetElement=e._option().targetElement,e.properties=e._option().properties,e}return s(n,i),Object.defineProperty(n.prototype,"targetElement",{get:function(){return this.__targetElement},set:function(e){this.__targetElement!=e&&(this.__targetElement=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"properties",{get:function(){return this.__properties},set:function(t){if((null==this.properties||this.__properties!=t)&&(this.__properties=[],null!=t)){Array.isArray(t)||(t=[t]);for(var i=0,n=t;i<n.length;i++){var r=n[i];this.__properties.push(new e._RuleActionPropertyOption(r))}}},enumerable:!0,configurable:!0}),n}(e.__Option);e._RuleActionOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.name=i._option().name,i.value=i._option().value,i}return s(i,e),Object.defineProperty(i.prototype,"name",{get:function(){return this.__name},set:function(e){this.__name!=e&&(this.__name=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.__value},set:function(t){this.__value!=t&&(this.__value=t)},enumerable:!0,configurable:!0}),i}(e.__Option);e._RuleActionPropertyOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.__actions=[],e.condition=e._option().condition,e.type=e._option().type,e.actions=e._option().actions,e}return s(n,i),Object.defineProperty(n.prototype,"condition",{get:function(){return this.__condition},set:function(e){this.__condition!=e&&(this.__condition=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"type",{get:function(){return this.__type},set:function(e){this.__type!=e&&(this.__type=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"actions",{get:function(){return this.__actions},set:function(t){if(this.__actions!=t&&(this.__actions=[],null!=t)){Array.isArray(t)||(t=[t]);for(var i=0,n=t;i<n.length;i++){var r=n[i];this.__actions.push(new e._RuleActionOption(r))}}},enumerable:!0,configurable:!0}),n}(e.__Option);e._RuleOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(t){var e=i.call(this,t)||this;return e.borderStyle=e._option().borderStyle,e.backgroundColor=e._option().backgroundColor,e.stroke=e._option().stroke,e.strokeWidth=e._option().strokeWidth,e.strokeDasharray=e._option().strokeDasharray,e.hAlign=e._option().hAlign,e}return s(n,i),Object.defineProperty(n.prototype,"borderStyle",{get:function(){return this.__borderStyle},set:function(t){null!=this.__borderStyle&&this.__borderStyle==t||(this.__borderStyle=new e._LineStyleOption(t))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this.__backgroundColor},set:function(e){null!=this.__backgroundColor&&this.__backgroundColor==e||(this.__backgroundColor=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stroke",{get:function(){return this.__stroke},set:function(e){this.__stroke!=e&&(this.__stroke=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strokeWidth",{get:function(){return this.__strokeWidth},set:function(e){this.__strokeWidth!=e&&(this.__strokeWidth=t.core.asNumber(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"strokeDasharray",{get:function(){return this.__strokeDasharray},set:function(e){this.__strokeDasharray!=e&&(this.__strokeDasharray=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hAlign",{get:function(){return this.__hAlign},set:function(e){this.__hAlign!=e&&(this.__hAlign=t.core.asEnum(e,t.HAlign,!0))},enumerable:!0,configurable:!0}),n}(e.__Option);e._StyleOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.color=i._option().color,i.fontSize=i._option().fontSize,i.fontFamily=i._option().fontFamily,i}return s(i,e),Object.defineProperty(i.prototype,"color",{get:function(){return this.__color},set:function(e){this.__color!=e&&(this.__color=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fontSize",{get:function(){return this.__fontSize},set:function(e){this.__fontSize!=e&&(this.__fontSize="number"==typeof e?e.toString():t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fontFamily",{get:function(){return this.__fontFamily},set:function(e){this.__fontFamily!=e&&(this.__fontFamily=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),i}(e.__Option);e._TextStyleOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.type=i._option().type,i}return s(i,e),Object.defineProperty(i.prototype,"type",{get:function(){return this.__type},set:function(e){this.__type!=e&&(this.__type=t.core.asEnum(e,t.ValueScaleType,!0))},enumerable:!0,configurable:!0}),i}(e.__Option);e._ValueScaleOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.aggregate=i._option().aggregate,i}return s(i,e),Object.defineProperty(i.prototype,"aggregate",{get:function(){return this.__aggregate},set:function(e){this.__aggregate!=e&&(this.__aggregate=t.core.asEnum(e,t.Aggregate,!0))},enumerable:!0,configurable:!0}),i}(e._EncodingOption);e._AggregateEncodingOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.group=t.group,i.excludeNulls=t.excludeNulls,i}return s(i,e),Object.defineProperty(i.prototype,"group",{get:function(){return this.__group},set:function(e){this.__group!=e&&(this.__group=t.core.asEnum(e,t.Group,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"excludeNulls",{get:function(){return this.__excludeNulls},set:function(e){null!=this.__excludeNulls&&this.__excludeNulls==e||(this.__excludeNulls=t.core.asBoolean(e,!0),null==this.__excludeNulls&&(this.__excludeNulls=!1))},enumerable:!0,configurable:!0}),i}(e._EncodingOption);e._DetailEncodingOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.field=i._option().field,i.aggregate=i._option().aggregate,i}return s(i,e),Object.defineProperty(i.prototype,"aggregate",{get:function(){return this.__aggregate},set:function(e){this.__aggregate!=e&&(this.__aggregate=t.core.asEnum(e,t.Aggregate,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"field",{get:function(){return this.__field},set:function(e){this.__field!=e&&("string"==typeof e?this.__field=t.core.asString(e,!0):null!=e.lower&&null!=e.upper?this.__field={lower:t.core.asString(e.lower,!0),upper:t.core.asString(e.upper,!0)}:this.__field=e)},enumerable:!0,configurable:!0}),i}(e.__Option);e._ValueAggregateEncodingOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){!function(t){var e=function(e){function i(t){var i=e.call(this,t)||this;return i.padding=i._option().padding,i}return s(i,e),Object.defineProperty(i.prototype,"padding",{get:function(){return this.__padding},set:function(e){null!=this.__padding&&this.__padding==e||(this.__padding=new t._PaddingOption(e))},enumerable:!0,configurable:!0}),i}(t._TextStyleOption);t._LabelStyleOption=e}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.fill=i._option().fill,i}return s(i,e),Object.defineProperty(i.prototype,"fill",{get:function(){return this.__fill},set:function(e){this.__fill!=e&&(this.__fill=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),i}(e._StyleOption);e._PlotAreaStyleOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this,t)||this;return i.adorners=i._option().adorners,i}return s(i,e),Object.defineProperty(i.prototype,"adorners",{get:function(){return this.__adorners},set:function(e){this.__adorners!=e&&(this.__adorners=t.core.asBoolean(e,!0))},enumerable:!0,configurable:!0}),i}(e._DataPointStyleOption);e._SelectionStyleOption=i}(t.options||(t.options={}))}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){t.options||(t.options={})}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._DataContentProvider},e}();e._DataContentProviderPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._DateParser},e}();e._DateParserPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._StringFormatting},e}();e._StringFormattingPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._DotAdornerRender},e}();e._BoxAdornerRenderPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._DotAdornerRender},e}();e._DotAdornerRenderPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(e){return"DataPoint"==e.type?new t.models._DataPointConditionalFormattingRule(e):null},e}();e._DataPointConditionalFormattingRulePlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(e){return"Group"==e.type?new t.models._GroupConditionalFormattingRule(e):null},e}();e._GroupConditionalFormattingRulePlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){var e=function(){function e(){}return e.prototype.create=function(e,i){return null!=i&&null!=e&&e instanceof t._PlotAreaView?new t._AreaGraph(e,i):null},e}();t._AreaGraphPlugin=e}(r||(r={})),function(t){var e=function(){function e(){}return e.prototype.create=function(e,i){return null!=i&&null!=e&&e instanceof t._PlotAreaView?1==i.config.radial&&null!=i.encodings.details&&i.encodings.details.length>0&&null!=i.encodings.details[0].field&&-1!=i.encodings.details[0].field.indexOf(">")?new t._SunburstGraph(e,i):new t._BarGraph(e,i):null},e}();t._BarGraphPlugin=e}(r||(r={})),function(t){var e=function(){function e(){}return e.prototype.create=function(e,i){return null!=i&&null!=e&&e instanceof t._PlotAreaView?new t._LineGraph(e,i):null},e}();t._LineGraphPlugin=e}(r||(r={})),function(t){var e=function(){function e(){}return e.prototype.create=function(e,i){return null!=i&&null!=e&&e instanceof t._PlotAreaView?new t._ScatterGraph(e,i):null},e}();t._ScatterGraphPlugin=e}(r||(r={})),function(t){var e=function(){function e(){}return e.prototype.create=function(e,i){return null!=i&&null!=e&&e instanceof t._PlotAreaView?new t._SunburstGraph(e,i):null},e}();t._SunburstPlugin=e}(r||(r={})),function(t){var e=function(){function e(){}return e.prototype.create=function(e,i){return null!=i&&null!=e&&e instanceof t._PlotAreaView?new t._TreemapGraph(e,i):null},e}();t._TreeMapPlugin=e}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(e){return new t.models._CanvasRenderEngine(e)},e}();e._CanvasRenderEnginePlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(e){return new t.models._SvgRenderEngine(e)},e}();e._SvgRenderEnginePlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(e){return new t.models._PureCanvasRenderEngine(e)},e}();e.PureCanvasRenderEnginePlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._BoxSymbol},e}();e._BoxSymbolPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._DashSymbol},e}();e._DashSymbolPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._DiamondSymbol},e}();e._DiamondSymbolPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._DotSymbol},e}();e._DotSymbolPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._PlusSymbol},e}();e._PlusSymbolPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._TriangleSymbol},e}();e._TriangleSymbolPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(){}return e.prototype.create=function(){return new t.models._XSymbol},e}();e._XSymbolPlugin=i}(t.plugins||(t.plugins={}))}(r||(r={})),r||(r={}),function(t){var e={};t._registerDataGraph=function(i,n){null!=i&&"string"==typeof i||t._throwException(t.Exception.DataGraph_InvalidTypeName),null==n&&t._throwException(t.Exception.DataGraph_InvalidPlugin),null==e[i]?e[i]=n:t._throwException(t.Exception.DataGraph_IsRegistered)},t._unregisterDataGraph=function(i){null!=i&&"string"==typeof i||t._throwException(t.Exception.DataGraph_InvalidTypeName),null!=e[i]&&(e[i]=null)},t._hasRegisteredDataGraph=function(i){return null!=i&&"string"==typeof i||t._throwException(t.Exception.DataGraph_InvalidTypeName),null!=e[i]},t._dataGraphPlugin=function(t){return null==t||"string"!=typeof t?null:null!=e[t]?e[t]:null}}(r||(r={})),function(t){!function(e){var i={};e.registerAdornerRender=function(e,n){null!=e&&"string"==typeof e||t._throwException(t.Exception.AdornerRender_InvalidTypeName),null==n&&t._throwException(t.Exception.AdornerRender_InvalidPlugin),null==i[e]?i[e]=n:t._throwException(t.Exception.AdornerRender_IsRegistered)},e.unregisterAdorner=function(e){null!=e&&"string"==typeof e||t._throwException(t.Exception.AdornerRender_InvalidTypeName),null!=i[e]&&(i[e]=null)},e.hasRegisteredAdornerRender=function(e){return null!=e&&"string"==typeof e||t._throwException(t.Exception.AdornerRender_InvalidTypeName),null!=i[e]},e._adornerRenderPlugin=function(t){return null==t||"string"!=typeof t?null:null!=i[t]?i[t]:null}}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i={};e.registerConditionalFormattingRule=function(e,n){null!=e&&"string"==typeof e||t._throwException(t.Exception.ConditionalFormattingRule_InvalidTypeName),null==n&&t._throwException(t.Exception.ConditionalFormattingRule_InvalidPlugin),null==i[e]?i[e]=n:t._throwException(t.Exception.ConditionalFormattingRule_IsRegistered)},e.unregisterConditionalFormattingRule=function(e){null!=e&&"string"==typeof e||t._throwException(t.Exception.ConditionalFormattingRule_InvalidTypeName),null!=i[e]&&(i[e]=null)},e.hasRegisteredConditionalFormattingRule=function(e){return null!=e&&"string"==typeof e||t._throwException(t.Exception.ConditionalFormattingRule_InvalidTypeName),null!=i[e]},e._conditionalFormattingRulePlugin=function(t){return null==t||"string"!=typeof t?null:null!=i[t]?i[t]:null}}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i={};e.registerDataContentProvider=function(e,n){null!=e&&"string"==typeof e||t._throwException(t.Exception.DataContentProvider_InvalidTypeName),null==n&&t._throwException(t.Exception.DataContentProvider_InvalidPlugin),null==i[e]?i[e]=n:t._throwException(t.Exception.DataContentProvider_IsRegistered)},e.unregisterDataContentProvider=function(e){null!=e&&"string"==typeof e||t._throwException(t.Exception.DataContentProvider_InvalidTypeName),null!=i[e]&&(i[e]=null)},e.hasRegisteredDataContentProvider=function(e){return null!=e&&"string"==typeof e||t._throwException(t.Exception.DataContentProvider_InvalidTypeName),null!=i[e]},e._dataContentProviderPlugin=function(t){return null==t||"string"!=typeof t?null:null!=i[t]?i[t]:null}}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i={};e.registerDateParser=function(e,n){null!=e&&"string"==typeof e||t._throwException(t.Exception.DateParser_InvalidTypeName),null==n&&t._throwException(t.Exception.DateParser_InvalidPlugin),null==i[e]?i[e]=n:t._throwException(t.Exception.DateParser_IsRegistered)},e.unregisterDateParser=function(e){null!=e&&"string"==typeof e||t._throwException(t.Exception.DateParser_InvalidTypeName),null!=i[e]&&(i[e]=null)},e.hasRegisteredDateParser=function(e){return null!=e&&"string"==typeof e||t._throwException(t.Exception.DateParser_InvalidTypeName),null!=i[e]},e._dateParserPlugin=function(t){return null==t||"string"!=typeof t?null:null!=i[t]?i[t]:null}}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i={};e.registerRenderEngine=function(e,n){null!=e&&"string"==typeof e||t._throwException(t.Exception.RenderEngine_InvalidTypeName),null==n&&t._throwException(t.Exception.RenderEngine_InvalidPlugin),null==i[e]?i[e]=n:t._throwException(t.Exception.RenderEngine_IsRegistered)},e.unregisterRenderEngine=function(e){null!=e&&"string"==typeof e||t._throwException(t.Exception.RenderEngine_InvalidTypeName),null!=i[e]&&(i[e]=null)},e.hasRegisteredRenderEngine=function(e){return null!=e&&"string"==typeof e||t._throwException(t.Exception.RenderEngine_InvalidTypeName),null!=i[e]},e._renderEnginePlugin=function(t){return null==t||"string"!=typeof t?null:null!=i[t]?i[t]:null}}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i={};e.registerStringFormatting=function(e,n){null!=e&&"string"==typeof e||t._throwException(t.Exception.StringFormatting_InvalidTypeName),null==n&&t._throwException(t.Exception.StringFormatting_InvalidPlugin),null==i[e]?i[e]=n:t._throwException(t.Exception.StringFormatting_IsRegistered)},e.unregisterStringFormatting=function(e){null!=e&&"string"==typeof e||t._throwException(t.Exception.StringFormatting_InvalidTypeName),null!=i[e]&&(i[e]=null)},e.hasRegisteredStringFormatting=function(e){return null!=e&&"string"==typeof e||t._throwException(t.Exception.StringFormatting_InvalidTypeName),null!=i[e]},e._stringFormattingPlugin=function(t){return null==t||"string"!=typeof t?null:null!=i[t]?i[t]:null}}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){!function(e){var i={},n=[];e.registerSymbol=function(e,r){null!=e&&"string"==typeof e||t._throwException(t.Exception.Symbol_InvalidTypeName),null==r&&t._throwException(t.Exception.Symbol_InvalidPlugin),null==i[e]?(i[e]=r,n.push(e)):t._throwException(t.Exception.Symbol_IsRegistered)},e.unregisterSymbol=function(e){if(null!=e&&"string"==typeof e||t._throwException(t.Exception.Symbol_InvalidTypeName),null!=i[e]){i[e]=null;for(var r=0;r<n.length;r++)if(n[r]==e){n.splice(r,1);break}}},e.hasRegisteredSymbol=function(e){return null!=e&&"string"==typeof e||t._throwException(t.Exception.Symbol_InvalidTypeName),null!=i[e]},e._symbolPlugin=function(t){return null==t||"string"!=typeof t?null:null!=i[t]?i[t]:null},e._symbolNames=function(){return n}}(t.plugins||(t.plugins={}))}(r||(r={})),function(t){var e=function(){function e(e,i){t._assertDebug(function(){return null!=e}),this.__element=e,this.__renderEngine=i,this.__stringRender=new t._StringRender(this),this.__transformRender=new t._TransformRender(this)}return e._renderFromType=function(i,n){var r=null,o=t.plugins._renderEnginePlugin(n);return null!=o&&(r=o.create(i)),new e(i,r)},Object.defineProperty(e.prototype,"element",{get:function(){return null!=this.__renderEngine?this.__renderEngine.element:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"opacity",{get:function(){return null!=this.__renderEngine?this.__renderEngine.opacity:null},set:function(t){null!=this.__renderEngine&&(this.__renderEngine.opacity=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return null!=this.__renderEngine?this.__renderEngine.fill:null},set:function(t){null!=this.__renderEngine&&(this.__renderEngine.fill=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stroke",{get:function(){return null!=this.__renderEngine?this.__renderEngine.stroke:null},set:function(t){null!=this.__renderEngine&&(this.__renderEngine.stroke=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeWidth",{get:function(){return null!=this.__renderEngine?this.__renderEngine.strokeWidth:null},set:function(t){null!=this.__renderEngine&&(this.__renderEngine.strokeWidth=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strokeDasharray",{get:function(){return null!=this.__renderEngine?this.__renderEngine.strokeDasharray:null},set:function(t){null!=this.__renderEngine&&(this.__renderEngine.strokeDasharray=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textFill",{get:function(){return null!=this.__renderEngine?this.__renderEngine.textFill:null},set:function(t){null!=this.__renderEngine&&(this.__renderEngine.textFill=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return null!=this.__renderEngine?this.__renderEngine.fontSize:null},set:function(t){null!=this.__renderEngine&&(this.__renderEngine.fontSize=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontFamily",{get:function(){return null!=this.__renderEngine?this.__renderEngine.fontFamily:null},set:function(t){null!=this.__renderEngine&&(this.__renderEngine.fontFamily=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"devicePixelRatio",{get:function(){return null!=this.__renderEngine?this.__renderEngine.devicePixelRatio:null},set:function(t){null!=this.__renderEngine&&(this.__renderEngine.devicePixelRatio=t)},enumerable:!0,configurable:!0}),e.prototype.beginRender=function(){null!=this.__renderEngine&&this.__renderEngine.beginRender()},e.prototype.endRender=function(){null!=this.__renderEngine&&this.__renderEngine.endRender()},e.prototype.setViewportSize=function(t,e){null!=this.__renderEngine&&this.__renderEngine.setViewportSize(t,e)},e.prototype.beginTransform=function(){this.__transformRender.begin()},e.prototype.restoreTransform=function(){this.__transformRender.restore()},e.prototype.drawMultipleStrings=function(t,e,i,n,r,o,a){void 0===i&&(i="Left"),void 0===n&&(n="None"),void 0===r&&(r=null),void 0===o&&(o=null),void 0===a&&(a=null),this.__stringRender._draw(t,e,i,n,r,o,a)},e.prototype.measureMultipleStrings=function(t,e,i,n,r,o){return void 0===i&&(i="None"),void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null),this.__stringRender._measure(t,e,i,n,r,o)},e.prototype.startGroup=function(t,e,i){null!=this.__renderEngine&&this.__renderEngine.startGroup(t,e,i)},e.prototype.endGroup=function(){null!=this.__renderEngine&&this.__renderEngine.endGroup()},e.prototype.drawEllipse=function(t,e,i,n,r,o){null!=this.__renderEngine&&this.__renderEngine.drawEllipse(t,e,i,n,r,o)},e.prototype.drawRect=function(t,e,i,n,r,o,a){null!=this.__renderEngine&&this.__renderEngine.drawRect(t,e,i,n,r,o,a)},e.prototype.drawLine=function(t,e,i,n,r,o){null!=this.__renderEngine&&this.__renderEngine.drawLine(t,e,i,n,r,o)},e.prototype.drawLines=function(t,e,i,n,r){null!=this.__renderEngine&&this.__renderEngine.drawLines(t,e,i,n,r)},e.prototype.drawSplines=function(t,e,i,n,r){null!=this.__renderEngine&&this.__renderEngine.drawSplines(t,e,i,n,r)},e.prototype.drawPolygon=function(t,e,i,n,r){null!=this.__renderEngine&&this.__renderEngine.drawPolygon(t,e,i,n,r)},e.prototype.drawPieSegment=function(t,e,i,n,r,o,a,s){null!=this.__renderEngine&&this.__renderEngine.drawPieSegment(t,e,i,n,r,o,a,s)},e.prototype.drawDonutSegment=function(t,e,i,n,r,o,a,s,l){null!=this.__renderEngine&&this.__renderEngine.drawDonutSegment(t,e,i,n,r,o,a,s,l)},e.prototype.drawString=function(t,e,i,n){null!=this.__renderEngine&&this.__renderEngine.drawString(t,e,i,n)},e.prototype.drawStringRotated=function(t,e,i,n,r,o){null!=this.__renderEngine&&this.__renderEngine.drawStringRotated(t,e,i,n,r,o)},e.prototype.drawImage=function(t,e,i,n,r){null!=this.__renderEngine&&this.__renderEngine.drawImage(t,e,i,n,r)},e.prototype.measureString=function(t,e,i,n){return null!=this.__renderEngine?this.__renderEngine.measureString(t,e,i,n):null},e.prototype.addClipRect=function(t,e){null!=this.__renderEngine&&this.__renderEngine.addClipRect(t,e)},e}();t._Render=e}(r||(r={})),function(t){t._applyStyle=function(t,e){null!=e&&(null!=e.opacity&&(t.opacity=e.opacity),null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeDasharray&&(t.strokeDasharray=e.strokeDasharray),null!=e.color&&(t.textFill=e.color),null!=e.fontSize&&(t.fontSize=e.fontSize),null!=e.fontFamily&&(t.fontFamily=e.fontFamily))}}(r||(r={})),function(t){t._fillRectangle=function(t,e){e.width<=0||e.height<=0||(null!=t.fill&&"transparent"!=t.fill&&"none"!=t.fill||null!=t.strokeWidth&&t.strokeWidth>0)&&t.drawRect(e.left+t.strokeWidth/2,e.top+t.strokeWidth/2,e.width-t.strokeWidth,e.height-t.strokeWidth)}}(r||(r={})),function(t){var e=function(){function e(){}return e.renderText=function(e,i,n,r,o,a,s,l,u){var h=e.measureString(i,a,s,l),c=n.x,p=n.y;switch(r){case 1:c-=.5*h.width;break;case 2:c-=h.width}switch(o){case 1:p+=.5*h.height;break;case 0:p+=h.height}var f=new t.core.Rect(c,p-h.height,h.width,h.height);return u?u(f)?(e.drawString(i,new t.core.Point(c,p),a,l),f):null:(e.drawString(i,new t.core.Point(c,p),a,l),f)},e.renderRotatedText=function(e,i,n,r,o,a,s,l,u,h){var c=e.measureString(i,l,u,h),p=n.x,f=n.y;switch(r){case 1:p-=.5*c.width;break;case 2:p-=c.width}switch(o){case 1:f+=.5*c.height;break;case 0:f+=c.height}e.drawStringRotated(i,new t.core.Point(p,f),a,s,l,h)},e}();t._RenderUtils=e}(r||(r={})),function(t){var e=function(){function e(e,i){this.k=.002,this._a=[],this._b=[],this._c=[],this._d=[],this.m=[[-.5,1.5,-1.5,.5],[1,-2.5,2,-.5],[-.5,0,.5,0],[0,1,0,0]],this._x=e,this._y=i;var n=this._len=Math.min(e.length,i.length);if(n>3)for(var r=0;r<n-1;r++){var o=0==r?new t.core.Point(e[r],i[r]):new t.core.Point(e[r-1],i[r-1]),a=new t.core.Point(e[r],i[r]),s=new t.core.Point(e[r+1],i[r+1]),l=r==n-2?new t.core.Point(e[r+1],i[r+1]):new t.core.Point(e[r+2],i[r+2]),u=new t.core.Point,h=new t.core.Point,c=new t.core.Point,p=new t.core.Point;u.x=o.x*this.m[0][0]+a.x*this.m[0][1]+s.x*this.m[0][2]+l.x*this.m[0][3],h.x=o.x*this.m[1][0]+a.x*this.m[1][1]+s.x*this.m[1][2]+l.x*this.m[1][3],c.x=o.x*this.m[2][0]+a.x*this.m[2][1]+s.x*this.m[2][2]+l.x*this.m[2][3],p.x=o.x*this.m[3][0]+a.x*this.m[3][1]+s.x*this.m[3][2]+l.x*this.m[3][3],u.y=o.y*this.m[0][0]+a.y*this.m[0][1]+s.y*this.m[0][2]+l.y*this.m[0][3],h.y=o.y*this.m[1][0]+a.y*this.m[1][1]+s.y*this.m[1][2]+l.y*this.m[1][3],c.y=o.y*this.m[2][0]+a.y*this.m[2][1]+s.y*this.m[2][2]+l.y*this.m[2][3],p.y=o.y*this.m[3][0]+a.y*this.m[3][1]+s.y*this.m[3][2]+l.y*this.m[3][3],this._a.push(u),this._b.push(h),this._c.push(c),this._d.push(p)}}return e.prototype.calculatePoint=function(t){var e=Math.floor(t);e<0&&(e=0),e>this._len-2&&(e=this._len-2);var i=t-e;return{x:((this._a[e].x*i+this._b[e].x)*i+this._c[e].x)*i+this._d[e].x,y:((this._a[e].y*i+this._b[e].y)*i+this._c[e].y)*i+this._d[e].y}},e.prototype.calculate=function(t,e){if(void 0===t&&(t=1),void 0===e&&(e=1),this._len<=3)return{xs:this._x,ys:this._y};var i=[],n=[],r=this.calculatePoint(0);i.push(r.x),n.push(r.y);for(var o=this._len*this.k,a=3*t,s=3*e,l=o;l<=this._len-1;l+=o){var u=this.calculatePoint(l);(Math.abs(r.x-u.x)>=a||Math.abs(r.y-u.y)>=s)&&(i.push(u.x),n.push(u.y),r=u)}return i[i.length-1].x==u.x&&n[n.length-1].y==u.y||(i.push(u.x),n.push(u.y)),{xs:i,ys:n}},e}();t._Spline=e}(r||(r={})),function(t){var e=function(){function e(t){this.__engine=t}return e.prototype._draw=function(e,i,n,r,o,a,s){if(void 0===n&&(n="Left"),void 0===r&&(r="None"),void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=null),"None"==r){if("Left"==n)this.__engine.drawString(e,new t.core.Point(i.left,i.bottom),o,s);else if("Center"==n){var l=this.__engine.measureString(e,o,a,s);this.__engine.drawString(e,new t.core.Point(i.left+(i.width-l.width)/2,i.bottom),o,s)}else if("Right"==n){l=this.__engine.measureString(e,o,a,s);this.__engine.drawString(e,new t.core.Point(i.left+i.width-l.width,i.bottom),o,s)}}else if("Wrap"==r)for(var u=this._measureMultipleLines(e,i.width,o,a,s),h=i.top,c=0,p=u;c<p.length;c++){var f=p[c];if("Left"==n)this.__engine.drawString(f.text,new t.core.Point(i.left,h+f.size.height),o,s);else if("Center"==n)this.__engine.drawString(f.text,new t.core.Point(i.left+(i.width-f.size.width)/2,h+f.size.height),o,s);else if("Right"==n){l=this.__engine.measureString(e,o,a,s);this.__engine.drawString(f.text,new t.core.Point(i.left+i.width-f.size.width,h+f.size.height),o,s)}h+=f.size.height}},e.prototype._measure=function(e,i,n,r,o,a){if(void 0===n&&(n="None"),void 0===r&&(r=null),void 0===o&&(o=null),void 0===a&&(a=null),"None"==n)return this.__engine.measureString(e,r,o,a);if("Wrap"==n){for(var s=this._measureMultipleLines(e,i.width,r,o,a),l=new t.core.Size(0,0),u=a?a.lineCount:null,h=u&&u<=s.length?u:s.length,c=0,p=s;c<h;c++){var f=p[c];l.height+=f.size.height,l.width=Math.max(l.width,f.size.width)}return l}},e.prototype._measureMultipleLines=function(t,e,i,n,r){if(void 0===i&&(i=null),void 0===n&&(n=null),void 0===r&&(r=null),t.length<=0)return[];for(var o=[];t.length>0;){var a=this._measureFirstLine(t,e,i,n,r);o.push({text:t.substring(0,a.position),size:a.size}),t=t.substring(a.position)}if(r&&"number"==typeof r.lineCount&&o.length>r.lineCount){var s=o[r.lineCount-1];s.text=s.text.substring(0,s.text.length-2)+"...",o.length=r.lineCount}return o},e.prototype._measureFirstLine=function(e,i,n,r,o){void 0===n&&(n=null),void 0===r&&(r=null),void 0===o&&(o=null);var a={position:0,size:new t.core.Size(0,0)},s=e.length;do{var l=e.substring(0,a.position+s),u=this.__engine.measureString(l,n,r,o);if(u.width<=i)a.position=a.position+s,a.size=u,s=e.length-a.position;else{if(1==s)break;s>0&&(s=Math.floor(s/2))<1&&(s=1)}}while(s>0);return a.position<=0&&(a.position=1,a.size=this.__engine.measureString(e.substring(0,a.position),n,r,o)),a},e}();t._StringRender=e}(r||(r={})),function(t){var e=function(){function e(t){this.__transforms=[],this.__engine=t}return e.prototype.begin=function(){this.__transforms.push({opacity:this.__engine.opacity,fill:this.__engine.fill,stroke:this.__engine.stroke,strokeWidth:this.__engine.strokeWidth,strokeDasharray:this.__engine.strokeDasharray,textFill:this.__engine.textFill,fontSize:this.__engine.fontSize,fontFamily:this.__engine.fontFamily})},e.prototype.restore=function(){var e=this;if(t._assertDebug(function(){return e.__transforms.length>0}),this.__transforms.length>0){var i=this.__transforms.pop();this.__engine.opacity=i.opacity,this.__engine.fill=i.fill,this.__engine.stroke=i.stroke,this.__engine.strokeWidth=i.strokeWidth,this.__engine.strokeDasharray=i.strokeDasharray,this.__engine.textFill=i.textFill,this.__engine.fontSize=i.fontSize,this.__engine.fontFamily=i.fontFamily}},e}();t._TransformRender=e}(r||(r={})),r||(r={}),function(t){var e=function(){function t(){}return t.gradientColor=function(e,i,n){for(var r=t.colorRgb(e),o=r[0],a=r[1],s=r[2],l=t.colorRgb(i),u=(l[0]-o)/n,h=(l[1]-a)/n,c=(l[2]-s)/n,p=[],f=0;f<n;f++){var _=t.colorHex("rgb("+parseInt(u*f+o)+","+parseInt(h*f+a)+","+parseInt(c*f+s)+")");p.push(_)}return p},t.colorRgb=function(t){if((t=t.toLowerCase())&&/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(t)){if(4===t.length){for(var e="#",i=1;i<4;i+=1)e+=t.slice(i,i+1).concat(t.slice(i,i+1));t=e}var n=[];for(i=1;i<7;i+=2)n.push(parseInt("0x"+t.slice(i,i+2)));return n}return t},t.colorHex=function(t){var e=t;if(/^(rgb|RGB)/.test(e)){for(var i=e.replace(/(?:(|)|rgb|RGB)*/g,"").split(","),n="#",r=0;r<i.length;r++){var o=Number(i[r]).toString(16);"0"===(o=o<10?"0"+o:o)&&(o+=o),n+=o}return 7!==n.length&&(n=e),n}if(!/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(e))return e;var a=e.replace(/#/,"").split("");if(6===a.length)return e;if(3===a.length){var s="#";for(r=0;r<a.length;r+=1)s+=a[r]+a[r];return s}},t}();t.ColorUtils=e}(r||(r={})),function(t){var e=function(){function e(t,e){this._swapAxes=t,this._lineAspect=e}return e.prototype.convert=function(e){if(e.length>1){if(this._swapAxes&&this._lineAspect==t.LineAspect.StepLeft||!this._swapAxes&&this._lineAspect==t.LineAspect.StepRight){(r=[]).push(e[0]);for(var i=1;i<e.length;i++)r.push(new t.core.Point(e[i].x,e[i-1].y)),r.push(new t.core.Point(e[i].x,e[i].y));return r}if(this._swapAxes&&this._lineAspect==t.LineAspect.StepRight||!this._swapAxes&&this._lineAspect==t.LineAspect.StepLeft){(r=[]).push(e[0]);for(i=1;i<e.length;i++)r.push(new t.core.Point(e[i-1].x,e[i].y)),r.push(new t.core.Point(e[i].x,e[i].y));return r}if(this._swapAxes&&this._lineAspect==t.LineAspect.StepCenter){(r=[]).push(e[0]);for(i=1;i<e.length;i++){var n=e[i-1].y+(e[i].y-e[i-1].y)/2;r.push(new t.core.Point(e[i-1].x,n)),r.push(new t.core.Point(e[i].x,n)),r.push(new t.core.Point(e[i].x,e[i].y))}return r}if(this._swapAxes||this._lineAspect!=t.LineAspect.StepCenter)return e;var r;(r=[]).push(e[0]);for(i=1;i<e.length;i++){var o=e[i-1].x+(e[i].x-e[i-1].x)/2;r.push(new t.core.Point(o,e[i-1].y)),r.push(new t.core.Point(o,e[i].y)),r.push(new t.core.Point(e[i].x,e[i].y))}return r}return e},e}();t._LineAspectConverter=e}(r||(r={})),function(t){var e=function(){function e(){}return e.contains=function(t,e){return e.x<=t.right&&e.x>=t.left&&e.y<=t.bottom&&e.y>=t.top},e.getRect=function(e,i){return new t.core.Rect(e.x,e.y,e.x+i.width,e.y+i.height)},e.getStyleCss=function(t){return t?{"font-size":t?t.fontSize:"",stroke:t?t.color:"",fill:t?t.color:"","font-family":t?t.fontFamily:""}:null},e.getTextByMaxLength=function(t,e,i,n,r,o){for(var a=t.measureString(e,o,r,n);a.width>i;)e=e.substr(0,e.length-1),a=t.measureString(e,o,r,n);return e},e.binarySearch=function(t,i,n,r,o){if(void 0===o&&(o=!0),t.length>0&&r)if(n-i>=2){var a,s=i,l=Math.floor((n+i)/2),u=n;o&&(r(t[s],s,NaN,NaN),r(t[u],u,NaN,NaN)),(a=r(t[l],l,s,u)).left&&e.binarySearch(t,s,l,r,!1),a.right&&e.binarySearch(t,l,u,r,!1)}else n-i==1?(r(t[i],i,NaN,NaN),r(t[n],n,NaN,NaN)):i==n&&r(t[i],0,NaN,NaN)},e.mergeRect=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var n=new t.core.Rect(0,0,0,0);return n.left=Math.min.apply(this,e.map(function(t){return t.left})),n.top=Math.min.apply(this,e.map(function(t){return t.top})),n.width=Math.max.apply(this,e.map(function(t){return t.right}))-n.left,n.height=Math.max.apply(this,e.map(function(t){return t.bottom}))-n.top,n},e.min=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=[],n=0,r=t;n<r.length;n++){var o=r[n];isNaN(o)||null==o||i.push(o)}return Math.min.apply(this,i)},e.max=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=[],n=0,r=t;n<r.length;n++){var o=r[n];isNaN(o)||null==o||i.push(o)}return Math.max.apply(this,i)},e.isMixed=function(t,e){var i=!1;return Math.abs((t.left+t.right)/2-(e.left+e.right)/2)<(t.right+e.right-t.left-e.left)/2&&Math.abs((t.top+t.bottom)/2-(e.top+e.bottom)/2)<(t.bottom+e.bottom-t.top-e.top)/2&&(i=!0),i},e.isMixedRotatedRect=function(i,n,r){var o=!1;if(null==r||isNaN(r))if(i.angle==n.angle)for(var a=0,s=i.points;a<s.length;a++){var l=s[a];if(e.IsPointInPolygon(l,n.points)){o=!0;break}}else Math.sqrt(Math.pow(i.center.x-n.center.x,2)+Math.pow(i.center.y-n.center.y,2))<=i.raidius+n.raidius&&(o=!0);else{var u=new t.RotateRect(i.centerx,i.centery,i.width+r,i.height+r,i.angle),h=new t.RotateRect(n.centerx,n.centery,n.width+r,n.height+r,n.angle);if(u.angle==h.angle)for(var c=0,p=u.points;c<p.length;c++){l=p[c];if(e.IsPointInPolygon(l,h.points)){o=!0;break}}else Math.sqrt(Math.pow(u.center.x-h.center.x,2)+Math.pow(u.center.y-h.center.y,2))<=u.raidius+h.raidius&&(o=!0)}return o},e.parseMargin=function(e){var i={};if(t.core.isNumber(e)&&!isNaN(e))i.top=i.bottom=i.left=i.right=t.core.asNumber(e);else if(t.core.isString(e)){var n=t.core.asString(e).split(" ",4),r=NaN,o=NaN,a=NaN,s=NaN;n&&(4==n.length?(r=parseFloat(n[0]),s=parseFloat(n[1]),o=parseFloat(n[2]),a=parseFloat(n[3])):2==n.length?(r=o=parseFloat(n[0]),a=s=parseFloat(n[1])):1==n.length&&(r=o=a=s=parseFloat(n[1])),isNaN(r)||(i.top=r),isNaN(o)||(i.bottom=o),isNaN(a)||(i.left=a),isNaN(s)||(i.right=s))}return i},e.resetRect=function(t,e,i,n,r){t.left=e,t.top=i,t.width=n,t.height=r},e.translateRect=function(t,e,i){t.left+=e,t.top+=i},e.translateRectX=function(t,i){e.translateRect(t,i,0)},e.translateRectY=function(t,i){e.translateRect(t,0,i)},e.isNil=function(t){return t.right-t.left<=0||t.bottom-t.top<=0},e.getPoint=function(e){return new t.core.Point(e.left,e.top)},e.IsPointInPolygon=function(t,e){for(var i=e[0].x,n=e[0].x,r=e[0].y,o=e[0].y,a=1;a<e.length;a++){var s=e[a];i=Math.min(s.x,i),n=Math.max(s.x,n),r=Math.min(s.y,r),o=Math.max(s.y,o)}if(t.x<i||t.x>n||t.y<r||t.y>o)return!1;for(var l=!1,u=(a=0,e.length-1);a<e.length;u=a++)e[a].y>t.y!=e[u].y>t.y&&t.x<(e[u].x-e[a].x)*(t.y-e[a].y)/(e[u].y-e[a].y)+e[a].x&&(l=!l);return l},e.IsPointInPolygon2=function(t,e,i){for(var n=e[0],r=e[0],o=i[0],a=i[0],s=1;s<e.length;s++)n=Math.min(e[s],n),r=Math.max(e[s],r),o=Math.min(i[s],o),a=Math.max(i[s],a);if(t.x<n||t.x>r||t.y<o||t.y>a)return!1;for(var l=!1,u=(s=0,e.length-1);s<e.length;u=s++)i[s]>t.y!=i[u]>t.y&&t.x<(e[u]-e[s])*(t.y-i[s])/(i[u]-i[s])+e[s]&&(l=!l);return l},e.sort=function(t,e){for(var i,n=0;n<t.length;++n)for(var r=0;r<t.length;++r)e(t[r],t[n])&&(i=t[r],t[r]=t[n],t[n]=i)},e.scale=function(t,e){if(e>0){var i=t.width*e,n=t.height*e;t.left-=(i-t.width)/2,t.top-=(n-t.height)/2,t.width=i,t.height=n}return t},e.pointToLine=function(t,i,n,r,o,a){var s,l,u;if(s=e._lineSpace(t,i,n,r),l=e._lineSpace(t,i,o,a),(u=e._lineSpace(n,r,o,a))+l==s)return 0;if(s<=1e-6)return l;if(u*u>=s*s+l*l)return l;if(l*l>=s*s+u*u)return u;var h=(s+l+u)/2;return 2*Math.sqrt(h*(h-s)*(h-l)*(h-u))/s},e._lineSpace=function(t,e,i,n){return Math.sqrt((t-i)*(t-i)+(e-n)*(e-n))},e}();t._Util=e}(r||(r={})),function(t){var e=function(){function e(e,i,n,r,o){this.angle=o,this.centerx=e,this.centery=i,this.width=n,this.height=r,this.points=[new t.core.Point,new t.core.Point,new t.core.Point,new t.core.Point,new t.core.Point,new t.core.Point,new t.core.Point,new t.core.Point,new t.core.Point];var a=this.points[0],s=this.points[1],l=this.points[2],u=this.points[3],h=this.points[4],c=this.points[5],p=this.points[6],f=this.points[7];f.x=this.centerx+Math.cos(this.angle)*this.width/2,f.y=this.centery+Math.sin(this.angle)*this.width/2,p.x=2*this.centerx-f.x,p.y=2*this.centery-f.y,s.x=f.x+Math.sin(this.angle)*this.height/2,s.y=f.y-Math.cos(this.angle)*this.height/2,l.x=2*f.x-s.x,l.y=2*f.y-s.y,u.x=p.x-Math.sin(this.angle)*this.height/2,u.y=p.y+Math.cos(this.angle)*this.height/2,a.x=2*p.x-u.x,a.y=2*p.y-u.y,c.x=(u.x+l.x)/2,c.y=(u.y+l.y)/2,h.x=(a.x+s.x)/2,h.y=(a.y+s.y)/2;var _=this.points[8];_.x=this.centerx,_.y=this.centery}return Object.defineProperty(e.prototype,"raidius",{get:function(){return Math.sqrt(Math.pow(this.center.x-this.leftTop.x,2)+Math.pow(this.center.y-this.leftTop.y,2))},enumerable:!0,configurable:!0}),e.prototype.offset=function(t,e,i){for(var n=0;n<this.points.length;++n){var r=this.points[n];r.x+=t*Math.cos(i),r.y+=e*Math.sin(i)}},Object.defineProperty(e.prototype,"leftTop",{get:function(){return this.points[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightTop",{get:function(){return this.points[1]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"leftBottom",{get:function(){return this.points[3]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightBottom",{get:function(){return this.points[2]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"centerTop",{get:function(){return this.points[4]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"centerBottom",{get:function(){return this.points[5]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"center",{get:function(){return this.points[8]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startPoint",{get:function(){return new t.core.Point(this.centerx,this.centery)},enumerable:!0,configurable:!0}),e}();t.RotateRect=e;var i=function(){return function(e,i,n,r,o){this._cx=e,this._cy=i,this._leftwidth=n,this._rightwidth=r,this._angle=o,this.endPoint=new t.core.Point,this.endPoint.x=e+Math.sin(this._angle)*r,this.endPoint.y=i-Math.cos(this._angle)*r,this.startPoint=new t.core.Point,this.startPoint.x=e-Math.sin(this._angle)*n,this.startPoint.y=i+Math.cos(this._angle)*n}}();t.RotateLine=i}(r||(r={})),function(t){var e=function(){function e(e,i,n,r){this.__visiable=t.ViewState.Visible,this._hovered=!1,this._children=[],this._scale=1,e=isNaN(e)?0:e,i=isNaN(i)?0:i,n=isNaN(n)?0:n,r=isNaN(r)?0:r,this.__rect=new t.core.Rect(e,i,n,r),this._selection=new t._SelectionAdorners}return e.prototype._rect=function(t){if(void 0===t)return this.__rect;this.__rect=t},e.prototype._visible=function(t){if(void 0===t)return this.__visiable;this.__visiable=t},e.prototype._selected=function(t){if(void 0===t)return!1},e.prototype._animation=function(t){if(void 0===t)return this.__animation;this.__animation=t},e.prototype._layout=function(t,e){},e.prototype._render=function(t){},e.prototype.refresh=function(){this._selection.rect=this._rect()},e.prototype.measure=function(t,e){return null},e.prototype.onHitted=function(e){return e.contains(this._rect())?(this._selection.rect=this._rect(),new t.HitInfo(new t.core.Point(e.x,e.y),this.datapoint,null,this,[t.ElementType.Shape],this._selection)):null},e}();t._View=e}(r||(r={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.prototype._defaultBorderStyle=function(){return{opacity:null,stroke:"none",strokeWidth:0,strokeDasharray:null}},i.prototype._defaultBackgroundColor=function(){return"none"},i.prototype._paddings=function(){return new t.options._PaddingOption(null)},i.prototype._rectangle=function(){return this.__rectangle},i.prototype._layout=function(e,i){this.__rectangle=i,e.beginTransform(),this._applyBorderStyle(e);var n=this.__rectangle;null!=e.strokeWidth&&(n=this._rectangle().inflate(-e.strokeWidth,-e.strokeWidth));var r=this._paddings();n=new t.core.Rect(n.left+r.left,n.top+r.top,n.width-r.left-r.right,n.height-r.top-r.bottom),e.restoreTransform(),this._layoutInnerContent(e,n)},i.prototype._render=function(t){if(!(this._rectangle().width<=0||this._rectangle().height<=0)){t.beginTransform(),this._applyBorderStyle(t),this._applyBackgroundStyle(t);var e=this.__rectangle;(null!=t.fill&&"transparent"!=t.fill&&"none"!=t.fill||null!=t.strokeWidth&&t.strokeWidth>0)&&(t.drawRect(this._rectangle().left+t.strokeWidth/2,this._rectangle().top+t.strokeWidth/2,this._rectangle().width-t.strokeWidth,this._rectangle().height-t.strokeWidth),e=this._rectangle().inflate(-t.strokeWidth,-t.strokeWidth)),t.restoreTransform(),this._renderInnerContent(t,e)}},i.prototype._measure=function(e,i){var n=new t.core.Size(0,0);e.beginTransform(),this._applyBorderStyle(e),null!=e.strokeWidth&&(n.width+=2*e.strokeWidth,n.height+=2*e.strokeWidth,null!=i&&((i=i.clone()).width-=2*e.strokeWidth,i.height-=2*e.strokeWidth));var r=this._paddings();n.width+=r.left+r.right,n.height+=r.top+r.bottom,null!=i&&((i=i.clone()).width-=r.left+r.right,i.height-=r.left+r.right),e.restoreTransform();var o=this._measureInnerContent(e,i);return n.width+=o.width,n.height+=o.height,n},i.prototype._layoutInnerContent=function(t,e){},i.prototype._measureInnerContent=function(e,i){return new t.core.Size(0,0)},i.prototype._applyBorderStyle=function(e){t._applyStyle(e,this._defaultBorderStyle())},i.prototype._applyBackgroundStyle=function(e){t._applyStyle(e,{fill:this._defaultBackgroundColor()})},i}(t._View);t._RectangleView=e}(r||(r={})),function(t){var e=function(){function t(t,e,i){this._center=t,this.setRadius(e),this._item=i}return t.prototype.setRadius=function(t){this._rad=t,this._rad2=t*t},Object.defineProperty(t.prototype,"radius",{get:function(){return this._rad},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"center",{get:function(){return this._center},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0}),t.prototype.contains=function(t){var e=this._center.x-t.x,i=this._center.y-t.y;return e*e+i*i<=this._rad2},t.prototype.distance=function(t){var e=isNaN(t.x)?0:this._center.x-t.x,i=isNaN(t.y)?0:this._center.y-t.y,n=e*e+i*i;return n<=this._rad2?0:Math.sqrt(n)-this._rad},t.prototype.getPoint=function(){return this._center},t}();t._CircleArea=e}(r||(r={})),function(t){var e=function(){return function(){}}();t._DataLabelPosition=e;var i=function(){function e(t){this.__labelRectangles=[],this.__plotArea=t}return e.prototype._defaultBorderStyle=function(){return{opacity:null,stroke:"#666",strokeWidth:0,strokeDasharray:null}},e.prototype._defaultBackgroundColor=function(){return"none"},e.prototype._defaultConnectingLineStyle=function(){return{opacity:null,stroke:"#666",strokeWidth:1,strokeDasharray:null}},e.prototype._plotArea=function(){return this.__plotArea},e.prototype._render=function(e){this.__labelRectangles=[];for(var i=0,n=this._plotArea()._plotViews();i<n.length;i++){var r=n[i],o=r.getLabelPoints(),a=null;if(r instanceof t._DataGraph&&(a=r._clipId()),null==a){if(e.beginTransform(),this._applyStyle(e,r),o)for(var s=0;s<o.length;s++)this._renderLabel(e,r,o[s]);e.restoreTransform()}else{if(e.beginTransform(),this._applyStyle(e,r),o)for(s=0;s<o.length;s++)this._renderLabel(e,r,o[s]);e.restoreTransform()}}},e.prototype._applyStyle=function(e,i){t._applyStyle(e,i.config.textStyle),t._applyStyle(e,i.config.text.style),t._applyStyle(e,i.config.text.textStyle)},e.prototype._applyBorderStyle=function(e,i){t._applyStyle(e,this._defaultBorderStyle()),t._applyStyle(e,i.plotArea.parent._option().style.borderStyle),t._applyStyle(e,i.plotArea._option().style.borderStyle),t._applyStyle(e,i.config.text.style.borderStyle)},e.prototype._applyBackgroundStyle=function(e,i){t._applyStyle(e,{fill:this._defaultBackgroundColor()}),t._applyStyle(e,{fill:i.plotArea.parent._option().style.backgroundColor}),t._applyStyle(e,{fill:i.plotArea._option().style.backgroundColor}),t._applyStyle(e,{fill:i.config.text.style.backgroundColor})},e.prototype._applyConnectingLineStyle=function(e,i){t._applyStyle(e,this._defaultConnectingLineStyle()),t._applyStyle(e,i.config.text.connectingLine)},e.prototype._isRectOverlap=function(t,e){return!(!t||!e)&&!(t.left>e.right||t.top>e.bottom||e.left>t.right||e.top>t.bottom)},e.prototype._renderLabel=function(e,i,n){var r=this._plotArea().parent._dataContentProvider().toLines(n.item.dataLabelContentSite);if(!r||0!=r.length){var o=i.getLabelPosition(e,n,r);if(o){var a=o.rect;if(i.config&&i.config.text&&i.config.text.overlappingLabels===t.OverlappingLabels.Auto){for(var s=0;s<this.__labelRectangles.length;++s)(this.__labelRectangles[s].rectangle===a||this._isRectOverlap(this.__labelRectangles[s].rectangle,a))&&(a=null);a&&this.__labelRectangles.push({rectangle:a,model:n.item,plot:i})}if(a){null!=o.pt1&&null!=o.pt2&&(e.beginTransform(),this._applyConnectingLineStyle(e,i),e.drawLine(o.pt1.x,o.pt1.y,o.pt2.x,o.pt2.y,t.__Constant_Core_Line_ClassName,{opacity:i.config.text.connectingLine.opacity,stroke:i.config.text.connectingLine.stroke,strokeWidth:i.config.text.connectingLine.strokeWidth}),e.restoreTransform()),e.startGroup(t.__Constant_Core_Label_ClassName),e.beginTransform(),this._applyBorderStyle(e,i),this._applyBackgroundStyle(e,i);var l=o.rect.inflate(2,0);l.top-=l.height,l=l.inflate(e.strokeWidth,e.strokeWidth),t._fillRectangle(e,l),e.restoreTransform();for(var u=o.rect.top-o.rect.height,h=0,c=r;h<c.length;h++){var p=c[h];u+=e.measureString(p).height,e.drawString(p,new t.core.Point(o.rect.left,u))}e.endGroup()}}}},e.prototype.onHitted=function(e){for(var i=0,n=this.__labelRectangles;i<n.length;i++){var r=n[i],o=r.rectangle.inflate(2,0);if(o.top-=o.height,e.contains(o))return new t.HitInfo(new t.core.Point(e.x,e.y),r.model,r.plot,r,[t.ElementType.Label],null)}return null},e}();t._DataLabelRenderer=i}(r||(r={})),function(t){var e=function(){function t(t,e,n,r,o,a){this._isFull=!1,this._center=t,this._radius=e,this._iradius=n,this._originAngle=r,this._originSweep=o,o>=2*Math.PI&&(this._isFull=!0),this._sweep=.5*o*180/Math.PI,this._angle=i.clampAngle(180*r/Math.PI+this._sweep),this._radius2=e*e,this._iradius2=n*n,this._item=a}return Object.defineProperty(t.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0}),t.prototype.contains=function(t){var e=t.x-this._center.x,n=t.y-this._center.y,r=e*e+n*n;if(r>=this._iradius2&&r<=this._radius2){var o=180*Math.atan2(n,e)/Math.PI,a=i.clampAngle(this._angle-o);if(this._isFull||Math.abs(a)<=this._sweep)return!0}return!1},t.prototype.distance=function(t){if(this.contains(t))return 0},t.prototype.getPoint=function(){return this._center},Object.defineProperty(t.prototype,"center",{get:function(){return this._center},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"langle",{get:function(){return this._angle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this._originAngle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sweep",{get:function(){return this._originSweep},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"innerRadius",{get:function(){return this._iradius},enumerable:!0,configurable:!0}),t}();t.DonutArea=e;var i=function(){function t(){}return t.clampAngle=function(t){var e=(t+180)%360-180;return e<-180&&(e+=360),e},t.isRectOverlap=function(t,e){return!(!t||!e)&&!(t.left>e.right||t.top>e.bottom||e.left>t.right||e.top>t.bottom)},t}()}(r||(r={})),function(t){var e=function(e){function i(t,i,n,r){var o=e.call(this)||this;o.__parent=t,o.__option=i,o.__dataOption=n,o.__headerView=o._createHeader(i),null!=o.__headerView&&o._children.push(o.__headerView),o.__footerView=o._createFooter(i),null!=o.__footerView&&o._children.push(o.__footerView),o.__plotAreaViews=o._createPlotAreaList(i.plotAreas,r);for(var a=0,s=o.__plotAreaViews;a<s.length;a++){var l=s[a];o._children.push(l)}return o}return s(i,e),Object.defineProperty(i.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"header",{get:function(){return this.__headerView},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"footer",{get:function(){return this.__footerView},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"plotAreas",{get:function(){return this.__plotAreaViews},enumerable:!0,configurable:!0}),i.prototype._option=function(){return this.__option},i.prototype._colorProvider=function(){if(null==this.__colorProvider)if(Array.isArray(this._option().palette))this.__colorProvider=new t.models._PaletteColorProvider(this._option().palette);else{var e=t.Palette[this._option().palette];this.__colorProvider=new t.models._PaletteColorProvider(t.models._Palettes[e])}return this.__colorProvider},i.prototype._symbolProvider=function(){return null==this.__symbolProvider&&(this.__symbolProvider=new t.models._SymbolProvider),this.__symbolProvider},i.prototype._stringFormatting=function(){if(null==this.__stringFormatting){var e=t.plugins._stringFormattingPlugin("Default");e&&(this.__stringFormatting=e.create())}return this.__stringFormatting},i.prototype._dataContentProvider=function(){if(null==this.__dataContentProvider){var e=t.plugins._dataContentProviderPlugin("Default");e&&(this.__dataContentProvider=e.create())}return this.__dataContentProvider},i.prototype._dateParser=function(){if(null==this.__dateParser){var e=[],i=this.__dataOption.dateFormats;e="boolean"==typeof i?i?t.__Constant_Core_Default_Date_Formats:[]:i,this.__dateParser=new t.models._DateStringParser(e)}return this.__dateParser},i.prototype._defaultStyle=function(){return{strokeWidth:0,stroke:"#666",fill:"none",color:"#666",fontFamily:"Helvetica",fontSize:14}},i.prototype._select=function(t){for(var e=0,i=this.plotAreas;e<i.length;e++){i[e]._select(t)}},i.prototype._bindData=function(t){for(var e=0,i=this.plotAreas;e<i.length;e++){i[e]._bindData(t)}},i.prototype._layoutInnerContent=function(t,e){t.beginTransform(),this._applyStyle(t),e=e.clone();var i=Math.min(Math.max(.035*e.width,10),40),r=Math.min(Math.max(.045*e.width,10),50),o=Math.min(Math.max(.05*e.height,10),40);e.left+=i,e.width-=i+r,e.top+=o,e.height-=o,null!=this.header&&(this.header._layout(t,e),e.top+=this.__headerView._rectangle().height,e.height-=this.__headerView._rectangle().height),null!=this.footer&&(this.footer._layout(t,e),e.height-=this.__footerView._rectangle().height),new n(this._option().plotAreaLayout)._layout(t,e,this.__plotAreaViews),t.restoreTransform()},i.prototype._renderInnerContent=function(t,e){t.beginTransform(),this._applyStyle(t);var i=this.__option.__option.setChartStatus;if(this.__option.__option.noData)this._renderDataEmpty(t,e),this._applyStyle(t),i("empty");else if(this.__option.__option.errorType)this._renderDataError(t,e),this._applyStyle(t),i("error");else if(this.plotAreas.length){null!=this.header&&this.header._render(t),null!=this.footer&&this.footer._render(t);for(var n=0,r=this.plotAreas;n<r.length;n++){r[n]._render(t)}i("normal")}else this._renderDataEmpty(t,e),this._applyStyle(t),i("empty");t.restoreTransform()},i.prototype._renderDataError=function(e,i){var n=this.__option.__option.errorStyle,r=e.__renderEngine.__canvasElement.getContext("2d"),o=this.__option.__option.errorType||0;a().DataMismatch[o].forEach(function(r,o){var a=e.measureString(r);t._applyStyle(e,n.desStyle),e.drawString(r,{x:(i.width-a.width)/2+3,y:(i.height+a.height/1.5+60)/2-30+22*o})}),r.drawImage(n.titleStyle.backgroundImage,0,0,80,80,(i.width-40)/2+2,(i.height-72)/2-30,40,40)},i.prototype._renderDataEmpty=function(e,i){var n=this.__option.__option.noDataStyle,r=e.__renderEngine.__canvasElement.getContext("2d"),o=a().NoData,s=e.measureString(o);t._applyStyle(e,n.desStyle),e.drawString(o,{x:(i.width-s.width)/2+3,y:(i.height+s.height/1.5+80)/2});var l=n.titleStyle.backgroundImage.width/n.titleStyle.backgroundImage.height,u=i.width/2-60*l/2,h=i.height/2-30-15;r.drawImage(n.titleStyle.backgroundImage,u,h,60*l,60)},i.prototype._applyStyle=function(e){t._applyStyle(e,this._defaultStyle()),t._applyStyle(e,this._option().style),t._applyStyle(e,this._option().textStyle)},i.prototype._applyBorderStyle=function(i){e.prototype._applyBorderStyle.call(this,i),t._applyStyle(i,this._option().style.borderStyle),t._applyStyle(i,this._option().borderStyle)},i.prototype._applyBackgroundStyle=function(i){e.prototype._applyBackgroundStyle.call(this,i),t._applyStyle(i,{fill:this._option().style.backgroundColor}),t._applyStyle(i,{fill:this._option().backgroundColor})},i.prototype._createHeader=function(e){return null!=e.header&&e.header.length>0?new t._HeaderView(this):null},i.prototype._createFooter=function(e){return null!=e.footer&&e.footer.length>0?new t._FooterView(this):null},i.prototype._createPlotAreaList=function(e,i){var n=[];if(null!=e&&e.length>0)for(var r=0,o=e;r<o.length;r++){var a=o[r];null!=(l=this._createPlotArea(a,i))&&n.push(l)}else for(var s=0;s<i.length;s++){var l;null!=(l=this._createPlotArea(new t.options._PlotAreaOption({row:s,column:0}),[i[s]]))&&n.push(l)}return n},i.prototype._createPlotArea=function(e,i){return new t._PlotAreaView(this,e,i)},i.prototype.onHitted=function(e){if(e.contains(this._rectangle())){for(var i=0,n=this._children;i<n.length;i++){var r=n[i].onHitted(e);if(null!=r)return r.elementType.push(t.ElementType.Control),r}return new t.HitInfo(new t.core.Point(e.x,e.y),this,null,this,[t.ElementType.Control],null)}return null},i}(t._RectangleView);t._DvView=e;var i,n=function(){function e(t){this.__option=t}return e.prototype._layout=function(e,i,n){for(var r=NaN,o=NaN,a=0,s=n;a<s.length;a++){var l=s[a];o=isNaN(o)?l.column:Math.max(o,l.column),r=isNaN(r)?l.row:Math.max(r,l.row)}if(!isNaN(r)&&!isNaN(o)){r++,o++;for(var u=this._calculateLengths(i.width,o,this.__option.columnWidths),h=this._calculateLengths(i.height,r,this.__option.rowHeights),c=function(n){var r=0;u.forEach(function(t,e){return r+=e<n.column?t:0});var o=0;h.forEach(function(t,e){return o+=e<n.row?t:0}),n._layout(e,new t.core.Rect(i.left+r,i.top+o,u[n.column],h[n.row]))},p=0,f=n;p<f.length;p++){c(l=f[p])}}},e.prototype._calculateLengths=function(t,e,n){for(var r=[],o=0,a=n;o<a.length;o++){var s=a[o];r.push(this._parseOption(s))}for(var l=[],u=0,h=0,c=0;c<e;c++){var p={value:1,unit:i.Auto};c>0&&c<r.length&&(p=r[c]),p.unit==i.Pixel?(l.push(p.value),u+=p.value):(l.push(NaN),h+=p.value)}var f=(t-u)/h;for(c=0;c<e;c++){p={value:1,unit:i.Auto};c>0&&c<r.length&&(p=r[c]),p.unit==i.Pixel?l[c]=p.value:l[c]=f*p.value}return l},e.prototype._parseOption=function(t){if("string"==typeof t){if(t.indexOf("*")>=0){t=t.replace("*","");var e=parseFloat(t);return isNaN(e)?{value:1,unit:i.Auto}:{value:e,unit:i.Star}}e=parseFloat(t);return isNaN(e)?{value:1,unit:i.Auto}:{value:e,unit:i.Pixel}}return"number"==typeof t?{value:t,unit:i.Pixel}:{value:1,unit:i.Auto}},e}();!function(t){t[t.Auto=0]="Auto",t[t.Pixel=1]="Pixel",t[t.Star=2]="Star"}(i||(i={}))}(r||(r={})),function(t){var e=function(e){function n(i,n,r){var o=e.call(this)||this;o.__plotViews=[],o.__legendViews=[],o._paletteOffset=0,o.__parent=i,o.__option=n,o.__plotViews=o._createPlotViewList(r),(null==o.__plotViews||o._plotViews().length<=0)&&o.__plotViews.push(new t._EmptyGraph(o)),o.__plotViews.forEach(function(t){o._initAxes(t.radial)}),o._children.push(o._axisLayer().axisX),o._children.push(o._axisLayer().axisY);for(var a=0,s=o._axisLayer().auxAxes;a<s.length;a++){var l=s[a];o._children.push(l)}for(var u=0,h=o.__plotViews;u<h.length;u++){var c=h[u];o._children.push(c)}return o}return s(n,e),Object.defineProperty(n.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"row",{get:function(){return this._option().row},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"column",{get:function(){return this._option().column},enumerable:!0,configurable:!0}),n.prototype._option=function(){return this.__option},n.prototype._plotViews=function(){return this.__plotViews},n.prototype._legendManager=function(){return null==this.__legendManager&&(this.__legendManager=new t.models._PlotAreaLegendManager(this)),this.__legendManager},n.prototype._paddings=function(){return this._option().padding},n.prototype._axisLayer=function(){return this.__axisLayer},n.prototype._dataLabelRender=function(){return null==this.__dataLabelRender&&(this.__dataLabelRender=new t._DataLabelRenderer(this)),this.__dataLabelRender},n.prototype._select=function(t){for(var e=0,i=this._plotViews();e<i.length;e++){i[e].Query(t)}},n.prototype._bindData=function(t){this._paletteOffset=0;for(var e=0,i=this._plotViews();e<i.length;e++){i[e].bindData(t)}this.__legendViews=this._createLegendViewList();for(var n=0,r=this.__legendViews;n<r.length;n++){var o=r[n];o.hidden||this._children.unshift(o)}},n.prototype._layoutInnerContent=function(t,e){t.beginTransform(),this._applyStyle(t),e=(new i)._layout(t,e,this.__legendViews);for(var n=0,r=this._plotViews();n<r.length;n++){r[n].measure(t,e)}this._axisLayer()._layout(t,e);for(var o=0,a=this._plotViews();o<a.length;o++){a[o]._layout(t,e)}t.restoreTransform()},n.prototype._renderInnerContent=function(e,i){e.startGroup(t.__Constant_Core_Plot_Area_ClassName),e.beginTransform(),this._applyStyle(e);for(var n=0,r=this.__legendViews;n<r.length;n++){r[n]._render(e)}this._axisLayer().render(e);for(var o=0,a=this._plotViews();o<a.length;o++){a[o].render(e)}this._dataLabelRender()._render(e),e.restoreTransform(),e.endGroup()},n.prototype._measureInnerContent=function(e,i){return new t.core.Size(0,0)},n.prototype._applyStyle=function(e){t._applyStyle(e,this._option().style),t._applyStyle(e,this._option().textStyle)},n.prototype._applyBackgroundStyle=function(i){e.prototype._applyBackgroundStyle.call(this,i),t._applyStyle(i,{fill:this.parent._option().style.backgroundColor}),t._applyStyle(i,{fill:this._option().style.backgroundColor}),t._applyStyle(i,{fill:this._option().backgroundColor})},n.prototype._createPlotViewList=function(e){var i=[];if(this.__option.axes.length>0){for(var n={},r=0,o=this.__option.axes;r<o.length;r++){var a=o[r];if(null!=a.plots)for(var s=function(i){null==n[i]&&(n[i]=t.core.find(e,function(t){return t.name==i}))},l=0,u=a.plots;l<u.length;l++){s(u[l])}}for(var h=0,c=e;h<c.length;h++){if(null!=(g=c[h])){var p=n[g.name];if(null!=p)null!=(d=this._createPlotView(p))&&(d.plotArea=this,i.push(d))}}}else for(var f=0,_=e;f<_.length;f++){var d,g=_[f];null!=(d=this._createPlotView(g))&&(d.plotArea=this,i.push(d))}return i},n.prototype._createPlotView=function(e){if(null!=e.type){var i=t._dataGraphPlugin(e.type);if(i)return i.create(this,e)}return null},n.prototype._createLegendViewList=function(){for(var e=[],i=0,n=this._plotViews();i<n.length;i++){var r=n[i];if(null!=r.legends)for(var o=0,a=r.legends;o<a.length;o++){var s=a[o];e.push(new t._LegendView(s))}}return this._legendManager()._valuesNameLegend&&e.push(new t._LegendView(this._legendManager()._valuesNameLegend)),e},n.prototype.onHitted=function(e){if(e.contains(this._rectangle())){var i=this._dataLabelRender().onHitted(e);if(null!=i)return i.elementType.push(t.ElementType.PlotArea),i;for(var n=0,r=this._children;n<r.length;n++){var o=r[n].onHitted(e);if(null!=o)return o.elementType.push(t.ElementType.PlotArea),o}return new t.HitInfo(new t.core.Point(e.x,e.y),null,null,this,[t.ElementType.PlotArea],null)}return null},n.prototype._initAxes=function(e){var i=this;if(this._radial=e,this._radial?this.__axisLayer=new t._RadialAxisLayer(this):this.__axisLayer=new t._LineAxisLayer(this),null!=this.__option&&null!=this.__option.axes){var n=!0,r=!0;this._axisLayer().auxAxes.length=0,this.__option.axes.forEach(function(e){if(e.type==t.AxisType.X)if(n)i._axisLayer().axisX._axisoption(e),n=!1;else if(i._radial){var o=new t._RadialAxis(i.__axisLayer,e.type,e);i._axisLayer().auxAxes.push(o)}else{o=new t._LineAxis(i.__axisLayer,e.type,e);i._axisLayer().auxAxes.push(o)}else if(e.type==t.AxisType.Y)if(r)i._axisLayer().axisY._axisoption(e),r=!1;else if(i._radial){o=new t._RadialAxis(i._axisLayer(),e.type,e);i._axisLayer().auxAxes.push(o)}else{o=new t._LineAxis(i._axisLayer(),e.type,e);i._axisLayer().auxAxes.push(o)}})}},n.prototype._getAxisX=function(e){for(var i=this._axisLayer().axisX,n=this._axisLayer().getAxes(),r=0;r<n.length;r++)n[r].axisType==t.AxisType.X&&n[r].plots&&n[r].plots.indexOf(e)>=0&&(i=n[r]);return i},n.prototype._getAxisY=function(e){for(var i=this._axisLayer().axisY,n=this._axisLayer().getAxes(),r=0;r<n.length;r++)n[r].axisType==t.AxisType.Y&&n[r].plots&&n[r].plots.indexOf(e)>=0&&(i=n[r]);return i},n}(t._RectangleView);t._PlotAreaView=e;var i=function(){function e(){}return e.prototype._layout=function(e,i,n){for(var r=[],o=[],a=[],s=[],l=0,u=n;l<u.length;l++){var h=u[l];switch(h.position){case t.Position.Left:r.push(h);break;case t.Position.Top:o.push(h);break;case t.Position.Right:a.push(h);break;case t.Position.Bottom:s.push(h);break;default:t._assertDebug(function(){return!1})}}return i=this._layoutByPosition(e,i,r,t.Position.Left),i=this._layoutByPosition(e,i,a,t.Position.Right),i=this._layoutByPosition(e,i,o,t.Position.Top),i=this._layoutByPosition(e,i,s,t.Position.Bottom)},e.prototype._layoutByPosition=function(e,i,n,r){if(n.length>0){for(var o=new t.core.Size(0,0),a=[],s=new t.core.Size(0,0),l=n[0].hidden?7:20,u=0;u<n.length;u++){var h=n[u]._measure(e,i);switch(o.width<h.width&&(o.width=h.width),o.height<h.height&&(o.height=h.height),r){case t.Position.Left:case t.Position.Right:s.height+=h.height;break;case t.Position.Top:case t.Position.Bottom:s.width+=h.width}a.push(new t.core.Rect(i.left,i.top,h.width,h.height))}var c=i.clone();switch(r){case t.Position.Left:c.width-=o.width+2*l,c.left+=o.width+2*l;break;case t.Position.Right:c.width-=o.width+2*l;break;case t.Position.Top:c.height-=o.height+2*l,c.top+=o.height+2*l;break;case t.Position.Bottom:c.height-=o.height+2*l}if(r===t.Position.Left||r===t.Position.Right){var p=(i.height-s.height-20*(n.length-1))/2;p<0&&(p=0);for(u=0;u<n.length;u++){var f=a[u];r===t.Position.Left?f.left+=l:r===t.Position.Right&&(f.left=i.right-l-o.width),f.top+=p,n[u]._layout(e,f),p+=f.height+20}}else{var _=(i.width-s.width-20*(n.length-1))/2;_<0&&(_=0);for(u=0;u<n.length;u++){var d=a[u];r===t.Position.Top?d.top+=l:r===t.Position.Bottom&&(d.top=i.bottom-30-o.height),d.left+=_,n[u]._layout(e,d),_+=d.width+20}}return c}return i},e}()}(r||(r={})),function(t){var e;!function(t){t[t.X=0]="X",t[t.Y=1]="Y",t[t.XY=2]="XY"}(e||(e={}));var i=function(){function i(t,e){this._rect=t,this._item=e}return Object.defineProperty(i.prototype,"rect",{get:function(){return this._rect},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"item",{get:function(){return this._item},enumerable:!0,configurable:!0}),i.prototype.contains=function(t){var e=this._rect;return t.x>=e.left&&t.x<=e.right&&t.y>=e.top&&t.y<=e.bottom},i.prototype.pointDistance=function(t,i,n){var r=i.x-t.x,o=i.y-t.y;return n==e.X?Math.abs(r):n==e.Y?Math.abs(o):Math.sqrt(r*r+o*o)},i.prototype.distance=function(i){var n=e.XY;null===i.x?n=e.Y:null===i.y&&(n=e.X);var r=this._rect;return i.x<r.left?i.y<r.top?this.pointDistance(i,new t.core.Point(r.left,r.top),n):i.y>r.bottom?this.pointDistance(i,new t.core.Point(r.left,r.bottom),n):n==e.Y?0:r.left-i.x:i.x>r.right?i.y<r.top?this.pointDistance(i,new t.core.Point(r.right,r.top),n):i.y>r.bottom?this.pointDistance(i,new t.core.Point(r.right,r.bottom),n):n==e.Y?0:i.x-r.right:n==e.X?0:i.y<r.top?r.top-i.y:i.y>r.bottom?i.y-r.bottom:0},i.prototype.getPoint=function(){return new t.core.Point(this.rect.left+.5*this.rect.width,this.rect.top+.5*this.rect.height)},i}();t._RectArea=i}(r||(r={})),function(t){var e=function(){function e(t,e){this._points=e,this._rect=t,this._points&&0!=this._points.length||this._createPointsFromRect()}return Object.defineProperty(e.prototype,"rect",{get:function(){return this._rect},set:function(t){this._rect=t,this._points&&0!=this._points.length||this._createPointsFromRect()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},set:function(t){this._points=t},enumerable:!0,configurable:!0}),e.prototype._createPointsFromRect=function(){this._rect&&(this._points=[],this._points.push(new t.core.Point(this._rect.left,this._rect.top)),this._points.push(new t.core.Point(this._rect.right,this._rect.top)),this._points.push(new t.core.Point(this._rect.right,this._rect.bottom)),this._points.push(new t.core.Point(this._rect.left,this._rect.bottom)))},e.prototype._render=function(e,i){if(i){var n=t.plugins._adornerRenderPlugin("dot").create();this._points&&this._points.length>0&&n.render(e,this._points)}},e}();t._SelectionAdorners=e}(r||(r={})),function(t){var e=function(e){function i(){return e.call(this)||this}return s(i,e),i.prototype._layoutInnerContent=function(t,e){},i.prototype._renderInnerContent=function(e,i){null!=this._text()&&this._text().length>0&&(e.beginTransform(),this._applyStyle(e),e.drawString(this._text(),new t.core.Point(i.left,i.bottom)),e.restoreTransform())},i.prototype._measureInnerContent=function(e,i){var n=new t.core.Size(0,0);return null!=this._text()&&this._text().length>0&&(e.beginTransform(),this._applyStyle(e),n=e.measureString(this._text()),e.restoreTransform()),n},i.prototype._applyStyle=function(t){},i}(t._RectangleView);t._TextView=e}(r||(r={})),function(t){t.__AXIS_LABLE_PADDING=2,t.__AXIS_TITLE_PADDING=4;var e=function(){function e(e,i,n){this._GRIDLINE_WIDTH=.25,this._LINE_WIDTH=1,this._TICK_WIDTH=1,this._TICK_OVERLAP=1,this._TICK_LABEL_DISTANCE=4,this._layoutList=[],this._axisLableLineheightlist=[],this._offset={left:0,top:0,right:0,bottom:0},this._axisType=t.AxisType.X,this._isTimeAxis=!1,this._axisLinePosition=NaN,this._allAxisLinePosition=[],this._customConvert=null,this._customConvertBack=null,this.rangeChanged=new t.core.Event,this.__parent=e,this._axisType=i,this.__option=n}return e.prototype._axisscale=function(t){if(void 0===t)return this.__axisscale;this.__axisscale=t},e.prototype._axisoption=function(t){null!=t&&(this.__option=t)},e.prototype._styleClassName=function(){return this.axisType===t.AxisType.X?t.__Constant_Core_Axis_X_ClassName:t.__Constant_Core_Axis_Y_ClassName},e.prototype._defaultLineStyle=function(){return{opacity:null,stroke:"#666",strokeWidth:1,strokeDasharray:null}},e.prototype._defaultMajorTickStyle=function(){return{opacity:null,stroke:"#666",strokeWidth:1,strokeDasharray:null}},e.prototype._defaultMinorTickStyle=function(){return{opacity:null,stroke:"#666",strokeWidth:1,strokeDasharray:null}},e.prototype._defaultMajorGridStyle=function(){return{opacity:null,stroke:"#666",strokeWidth:1,strokeDasharray:null}},e.prototype._defaultMinorGridStyle=function(){return{opacity:null,stroke:"#666",strokeWidth:1,strokeDasharray:null}},Object.defineProperty(e.prototype,"rect",{get:function(){return this._axrect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hostElement",{get:function(){return this._hostElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actualMin",{get:function(){return this._isTimeAxis?new Date(this._axisscale().min):this._axisscale().min},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actualMax",{get:function(){return this._isTimeAxis?new Date(this._axisscale().max):this._axisscale().max},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.__option.min},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.__option.max},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reversed",{get:function(){return this.__option.reversed},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this.__option.position},enumerable:!0,configurable:!0}),e.prototype.getPosition=function(){return this.position==t.AxisPosition.None?null:this.axisType==t.AxisType.X?this.position==t.AxisPosition.Near?t.Position.Bottom:t.Position.Top:this.axisType==t.AxisType.Y?this.position==t.AxisPosition.Near?t.Position.Left:t.Position.Right:null},Object.defineProperty(e.prototype,"majorUnit",{get:function(){return this.__option.majorUnit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorUnit",{get:function(){return this.__option.minorUnit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){e!=this._name&&(this._name=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.__option.title},set:function(e){e!==this.__option.title&&(this.__option.title=t.core.asString(e,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"format",{get:function(){return this.__option.format},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorGrid",{get:function(){return this.__option.majorGrid},set:function(e){null!=e&&e!=this.__option.majorGrid&&(this.__option.majorGrid=t.core.asBoolean(e,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorTicks",{get:function(){return this.__option.majorTicks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorGrid",{get:function(){return this.__option.minorGrid},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorTicks",{get:function(){return this.__option.minorTicks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"axisLine",{get:function(){return this.__option.axisLine},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labels",{get:function(){return this.__option.labels},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelAlign",{get:function(){return this._labelAlign},set:function(e){e!=this._labelAlign&&(this._labelAlign=t.core.asString(e,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"textStyle",{get:function(){return this.__option.textStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelStyle",{get:function(){return this.__option.labelStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelAngle",{get:function(){return this.__option.labelAngle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"origin",{get:function(){return this.__option.origin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overlappingLabels",{get:function(){return this.__option.overlappingLabels},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemFormatter",{get:function(){return this._ifmt},set:function(e){this._ifmt!=e&&(this._ifmt=t.core.asFunction(e,!0),this._invalidate())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logBase",{get:function(){return null==this.__option.logBase?10:this.__option.logBase},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scale",{get:function(){return this.__option.scale},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorTickSize",{get:function(){return this.__option.majorTickSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorTickSize",{get:function(){return this.__option.minorTickSize},enumerable:!0,configurable:!0}),e.prototype._overlapAxis=function(){},e.prototype.onRangeChanged=function(t){this.rangeChanged.raise(this,t)},e.prototype._getGrouplabelsHeight=function(e,i,n,r){for(var o=t.__Constant_Core_Label_ClassName,a=0,s=r+1,l=0;l<i.length;++l){i[l]&&i[l].children&&i[l].children.length>0&&this._getGrouplabelsHeight(e,i[l].children,n,s);var u=i[l].label,h=e.measureString(u,o,this._styleClassName()),c=h.height,p=h.width;if(n){var f=n*Math.PI/180,_=h.width,d=h.height;p=_*Math.abs(Math.cos(f))+d*Math.abs(Math.sin(f)),c=_*Math.abs(Math.sin(f))+d*Math.abs(Math.cos(f))}this.axisType==t.AxisType.X?a<c+this._TICK_LABEL_DISTANCE&&(a=c+this._TICK_LABEL_DISTANCE):a<p+this._TICK_LABEL_DISTANCE&&(a=p+this._TICK_LABEL_DISTANCE)}for(;this._axisLableLineheightlist.length<r+1;)this._axisLableLineheightlist.push(0);this._axisLableLineheightlist[r]<a&&(this._axisLableLineheightlist[r]=a)},e.prototype._getTickHeightBelowAxis=function(e,i,n){var r=0,o=n,a=this._TICK_OVERLAP,s=i;return void 0!==s&&null!==s||(s=t.TickMark.Outside),s==t.TickMark.Outside?a=1:s==t.TickMark.Inside?a=-1:s==t.TickMark.Cross&&(a=0),s!=t.TickMark.None&&(r+=.5*(1+a)*o),r},e.prototype._getTitleHeight=function(e){var i=t.__Constant_Core_Title_ClassName,n=0;if(this.title){t._applyStyle(e,this.titleStyle);var r=this.title;this._szTitle=e.measureString(r,i,this._styleClassName()),n=this._szTitle.height}return n},e.prototype._getHeightOrdinal=function(e,i){if(null!=this._site&&this._site.isOrdinal){if(this._site.groupLevels>0){t._applyStyle(e,this.style);var n=this._site.groups;this._getGrouplabelsHeight(e,n,i,0);for(var r=0,o=0;o<this._axisLableLineheightlist.length;++o)r+=this._axisLableLineheightlist[o];return r}return 0}return 0},e.prototype._measure=function(t,e){return 0},e.prototype._getformat=function(t){return this.__option.format?this.__option.format:this._isTimeAxis?null:Math.round(t)?"n0":"n"},e.prototype._updateActualLimits=function(e){this._site=e,this._isTimeAxis||(this._isTimeAxis=this._site.dataType==t.core.DataType.Date)},Object.defineProperty(e.prototype,"offset",{get:function(){return this._offset},set:function(t){this._offset=t},enumerable:!0,configurable:!0}),e.prototype._layout=function(t,e,i){},e.prototype._render=function(t){},e.prototype.convert=function(t,e,i){return this.__axisscale.getScaleValue(t)},Object.defineProperty(e.prototype,"axisType",{get:function(){return this._axisType},enumerable:!0,configurable:!0}),e.prototype._getMinNum=function(){return this._axisscale().min},e.prototype._getMaxNum=function(){return this._axisscale().max},e.prototype._invalidate=function(){},e.prototype._stringFormatting=function(){return this._axisLayer()._plotArea().parent._stringFormatting()},e.prototype._formatValue=function(t){if(this._isTimeAxis)return this.__option.format?this._stringFormatting().format(this.__option.format,new Date(t)):this._stringFormatting().format(this._tfmt,new Date(t));if(this.__option.format)return this._stringFormatting().format(this.__option.format,t);var e=t==Math.round(t)?"n0":"n";return this._stringFormatting().format(e,t)},Object.defineProperty(e.prototype,"type",{get:function(){return this.__option.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"plots",{get:function(){return this.__option.plots},enumerable:!0,configurable:!0}),e.prototype._axisLayer=function(){return this.__parent},Object.defineProperty(e.prototype,"style",{get:function(){return this.__option.style},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"titleStyle",{get:function(){return this.__option.titleStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorGridStyle",{get:function(){return this.__option.majorGridStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorGridStyle",{get:function(){return this.__option.minorGridStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"majorTickStyle",{get:function(){return this.__option.majorTickStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"minorTickStyle",{get:function(){return this.__option.minorTickStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lineStyle",{get:function(){return this.__option.lineStyle},enumerable:!0,configurable:!0}),e.prototype.onHitted=function(t){return null},e.MAX_MAJOR=1e3,e.MAX_MINOR=2e3,e._id=0,e}();t._BaseAxis=e}(r||(r={})),function(t){var e=function(){function e(t){this.__plotArea=t}return e.prototype._defaultBorderStyle=function(){return{opacity:null,stroke:"none",strokeWidth:0,strokeDasharray:null}},e.prototype._plotArea=function(){return this.__plotArea},e.prototype._applyBorderStyle=function(e){t._applyStyle(e,this._defaultBorderStyle()),t._applyStyle(e,this._plotArea().parent._option().style.borderStyle),t._applyStyle(e,this._plotArea()._option().style.borderStyle),t._applyStyle(e,this._plotArea()._option().borderStyle)},e.prototype._applyBackgroundStyle=function(e){t._applyStyle(e,{fill:this._plotArea()._option().style.fill})},e}();t._BaseAxisLayer=e}(r||(r={})),function(t){var e=function(e){function i(t,i,n){return e.call(this,t,i,n)||this}return s(i,e),i.prototype.getPosition=function(){return this.position==t.AxisPosition.None?null:this.axisType==t.AxisType.X?this.position==t.AxisPosition.Near?t.Position.Bottom:t.Position.Top:this.axisType==t.AxisType.Y?this.position==t.AxisPosition.Near?t.Position.Left:t.Position.Right:null},i.prototype._overlapAxis=function(){for(var e=0;e<this._layoutList.length;++e){var i=this._layoutList[e];if(i&&!i.hidden)for(var n=e+1;n<this._layoutList.length;++n){var r=this._layoutList[n];if(!r||!t._Util.isMixedRotatedRect(i.labelRect,r.labelRect,6))break;r.hidden=!0}}},i.prototype._isOverlapped=function(t,e,i){var n=this._axisscale().ticks;if(null!=n&&n.length>0)for(var r=n.length,o=0;o<r-1;o++){var a=n[o],s=n[o+1];if(a>=this._site.min&&a<=this._site.max){var l=this.__axisscale.getScaleValue(a),u=this.__axisscale.getScaleValue(s),h=this._site.labelFromValue(this._isTimeAxis?new Date(a):a,this._axisscale().format),c=this._site.labelFromValue(this._isTimeAxis?new Date(s):s,this.__axisscale.format),p=t.measureString(h,i,this._styleClassName()),f=t.measureString(c,i,this._styleClassName());if(o>0&&Math.abs(l-u)<(p.width+f.width)/2+6)return!0}}return!1},i.prototype._measure=function(e,i){i<0&&(i=0),e.beginTransform(),t._applyStyle(e,this.style),t._applyStyle(e,this.textStyle);t.__Constant_Core_Label_ClassName;this._actualAngle=void 0;var n=0,r=this.labelAngle;if(this._isTimeAxis?(this.min instanceof Date?this.__axisscale.min=this.min.getTime():"number"==typeof this.min&&(this.__axisscale.min=this.min),this.max instanceof Date?this.__axisscale.max=this.max.getTime():"number"==typeof this.max&&(this.__axisscale.max=this.max)):(isNaN(this.min)||(this.__axisscale.min=this.min),isNaN(this.max)||(this._axisscale().max=this.max)),null==this.majorUnit||isNaN(this.majorUnit)||(this._axisscale().unit=this.majorUnit),this.__axisscale.format=this._getformat(),this._annoSize=this.getMaxLableSize(e),this.axisType===t.AxisType.X){this._getCorrectAngle(e);var o=Math.ceil(i/this._axisscale().ticks.length);this._annoSize.width>.8*o&&(this._annoSize.height=Math.min(Math.ceil(this._annoSize.width/(.8*o)),5)*this._annoSize.height,this._annoSize.width=.8*o)}this.axisType===t.AxisType.X?this.__axisscale.range([this._annoSize.width/2,i-this._annoSize.width/2]).refresh():this.axisType===t.AxisType.Y&&this.__axisscale.range([this._annoSize.height/2,i-this._annoSize.height/2]).refresh(),isNaN(this.majorUnit)&&(this.axisType===t.AxisType.X?this.__axisscale.tickNumber=i/(this._annoSize.width+6):this.axisType===t.AxisType.Y&&(this.__axisscale.tickNumber=i/(this._annoSize.height+6))),this.__axisscale.refresh();this._axisscale().ticks;if(this.labels&&(this._axisType===t.AxisType.X?n+=this._annoSize.height:n+=this._annoSize.width),e.beginTransform(),t._applyStyle(e,this.titleStyle),n+=Math.max(this._getTickHeightBelowAxis(e,this.majorTicks,this.majorTickSize),this._getTickHeightBelowAxis(e,this.minorTicks,this.minorTickSize)),n+=this._getTitleHeight(e),this.axisType==t.AxisType.Y){var a=this.titleStyle.padding,s=this.labelStyle.padding;n+=a._isEmpty()?t.__AXIS_TITLE_PADDING:a.left+a.right,n+=s._isEmpty()?t.__AXIS_LABLE_PADDING:s.left+s.right}else if(this.axisType===t.AxisType.X){a=this.titleStyle.padding,s=this.labelStyle.padding;n+=a._isEmpty()?t.__AXIS_TITLE_PADDING:a.top+a.bottom,n+=s._isEmpty()?t.__AXIS_LABLE_PADDING:s.top+s.bottom}return this._site.isOrdinal&&(t._applyStyle(e,this.labelStyle),n+=this._getHeightOrdinal(e,r)),e.restoreTransform(),e.restoreTransform(),this.position==t.AxisPosition.None?0:n},i.prototype.getMaxLableSize=function(e){e.beginTransform(),t._applyStyle(e,this.labelStyle);for(var i=t.__Constant_Core_Label_ClassName,n=(t.__Constant_Core_Title_ClassName,this._site.isOrdinal),r=new t.core.Size(0,0),o=0;o<this._axisscale().ticks.length;++o){var a=this.__axisscale.ticks[o];this._isTimeAxis&&!this._site.isOrdinal&&(a=new Date(a));var s=this._site.labelFromValue(a,n?null:this._axisscale().format),l=e.measureString(s,i,this._styleClassName());r.width<l.width&&(r.width=l.width),r.height<l.height&&(r.height=l.height)}return e.restoreTransform(),r},i.prototype._layoutXAxis=function(e){var i=t.__Constant_Core_Label_ClassName;if(null!==this.getPosition()){this._layoutList.length=0,e.beginTransform(),t._applyStyle(e,this.textStyle),t._applyStyle(e,this.labelStyle);var n=this._getCorrectAngle(e);n<0&&(n=90+Math.abs(n));this.position,t.AxisPosition.Near,this._site.isOrdinal;for(var r=this._axisscale().ticks,o=this.position===t.AxisPosition.Far,a=this._getTickHeightBelowAxis(e,this.majorTicks,this.majorTickSize),s=this.majorTickSize,l=this.minorTickSize,u=this._getTickHeightBelowAxis(e,this.minorTicks,this.minorTickSize),h=this.__axisscale.min,c=this.labelStyle.padding,p=(this._axrect.right-this._axrect.left)/r.length,f=0;r&&f<r.length;++f){var _=new t.AxisViewModel,d=r[f],g=f>=r.length?null:r[f+1];this._isTimeAxis&&!this._site.isOrdinal&&(d=new Date(d));var y=this._site.labelFromValue(d,this._axisscale().format),m=e.measureString(y,i,this._styleClassName());if(0!==n){for(var v=n>135?this._annoSize.height/.7*.9:.9*this._annoSize.height,b=0;b<y.length;b++){var S=y.slice(0,b)+"...";if(e.measureString(S,i,this._styleClassName()).width>=v){y=y.slice(0,b)+"...";break}}m=e.measureString(y,i,this._styleClassName())}else{var C=e.__stringRender._measureMultipleLines(y,.8*p);if(C.length){C.forEach(function(t,e){e<=3&&t.size.height}),m.width=C[0].size.width,y=C[0].text,_.multipleLines=C}}this.labels||(m.width=0,m.height=0);var x=this.__axisscale.getScaleValue(d),T=c._isEmpty()?t.__AXIS_LABLE_PADDING:c.top,w=this._axrect.top+Math.max(a,u)+T,P=this._axrect.top;o&&(T=c._isEmpty()?t.__AXIS_LABLE_PADDING:c.bottom,w=this._axrect.bottom-Math.max(a,u)-this._annoSize.height-T,P=this._axrect.bottom),_.hidden=!1,_.label=y;var A=x,F=w+m.height/2;null!=n&&n>0&&(A=x+Math.cos(n*Math.PI/180)*m.width/2,F=w+m.height/2+Math.sin(n*Math.PI/180)*m.width/2),null!=n&&n<0&&(A=x-Math.cos(n*Math.PI/180)*m.width/2,F=w+m.height/2+Math.sin(n*Math.PI/180)*m.width/2),_.labelRect=new t.RotateRect(A,F,m.width,m.height,n*Math.PI/180);var O=f+1===r.length?this._axrect.right:p*(f+1)+this._axrect.left;_.majorTickLine=new t.RotateLine(O,P,a,s-a,o?Math.PI:0);this.majorTicks,this.minorTicks;var M=this._isTimeAxis?1e3*t._timeSpan.fromDays(this.minorUnit).TotalSeconds:this.minorUnit;for(Math.abs(M)<Math.abs(this.__axisscale.max-this.__axisscale.min)/100&&(M=null),(null==M||isNaN(M))&&(M=(g-d)/2);h<(f==r.length-1?this.__axisscale.max:g);){var D=this.__axisscale.getScaleValue(h),L=P;h+=M,D!=x&&_.minorTickLines.push(new t.RotateLine(D,L,u,l-u,o?Math.PI:0))}this._layoutList.push(_)}e.restoreTransform()}},i.prototype._layoutYAxis=function(e){var i=t.__Constant_Core_Label_ClassName;if(null!==this.getPosition()){var n=this._getCorrectAngle();e.beginTransform(),t._applyStyle(e,this.textStyle),t._applyStyle(e,this.labelStyle);this.position,t.AxisPosition.Near;for(var r=this._axisscale().ticks,o=this.position===t.AxisPosition.Far,a=this._getTickHeightBelowAxis(e,this.majorTicks,this.majorTickSize),s=this.majorTickSize,l=this.minorTickSize,u=this._getTickHeightBelowAxis(e,this.minorTicks,this.minorTickSize),h=this.__axisscale.min,c=this.labelStyle.padding,p=0;r&&p<r.length;++p){var f=r[p],_=p>=r.length?null:r[p+1];this._isTimeAxis&&(f=new Date(f));var d=this._site.labelFromValue(f,this._axisscale().format),g=e.measureString(d,i,this._styleClassName());this.labels||(g.width=0,g.height=0);g.width;var y=this.__axisscale.getScaleValue(f),m=c._isEmpty()?t.__AXIS_LABLE_PADDING:c.right,v=this._axrect.right-Math.max(a,u)-m,b=this._axrect.right;o&&(m=c._isEmpty()?t.__AXIS_LABLE_PADDING:c.left,v=this._axrect.left+Math.max(a,u)+m+g.width,b=this._axrect.left);var S=new t.AxisViewModel;S.hidden=!1,S.label=d;var C=v-g.width/2,x=y;null!=n&&0!=n&&(n<0?(C=v-Math.cos(n*Math.PI/180)*g.width/2,x=y-Math.sin(n*Math.PI/180)*g.width/2):(C=v-Math.sin(n*Math.PI/180)*g.width/2,x=y-Math.cos(n*Math.PI/180)*g.width/2)),S.labelRect=new t.RotateRect(C,x,g.width,g.height,n*Math.PI/180),S.majorTickLine=new t.RotateLine(b,y,a,s-a,Math.PI/2*(o?-1:1));this.majorTicks,this.minorTicks;var T=this._isTimeAxis?1e3*t._timeSpan.fromDays(this.minorUnit).TotalSeconds:this.minorUnit;for(Math.abs(T)<Math.abs(this.__axisscale.max-this.__axisscale.min)/100&&(T=null),(null==T||isNaN(T))&&(T=(_-f)/2);h<(p==r.length-1?this.__axisscale.max:_);){var w=this.__axisscale.getScaleValue(h),P=b;h+=T,w!=y&&S.minorTickLines.push(new t.RotateLine(P,w,u,l-u,Math.PI/2*(o?-1:1)))}this._layoutList.push(S)}e.restoreTransform()}},i.prototype._getformat=function(t){return this.format?this.format:this._isTimeAxis?null:Math.round(t)?"n0":"n"},i.prototype._updateActualLimits=function(e){this._site=e,this._isTimeAxis||(this._isTimeAxis=this._site.dataType==t.core.DataType.Date)},i.prototype._layout=function(e,i,n){if(null!=n){n.width<0&&(n.width=0),n.height<0&&(n.height=0);var r=this.axisType==t.AxisType.Y;this._layoutList.length=0,this._plotrect=n,this._axrect=r?new t.core.Rect(i.left,i.top,i.height,i.width):i;var o=this._axrect.left+this.offset.left,a=this._axrect.width-(this.offset.left+this.offset.right),s=this._axrect.top+this.offset.top,l=this._axrect.height-(this.offset.top+this.offset.bottom);this.__axisscale.reversed=this.reversed,this._axisscale().unit=this.majorUnit,this.axisType==t.AxisType.X?(this.__axisscale.range([o,o+a]),this._layoutXAxis(e)):this.axisType==t.AxisType.Y&&(this.__axisscale.range([s+l,s]),this._layoutYAxis(e)),this.overlappingLabels!=t.AxisOverlappingLabels.Show&&this._overlapAxis(),this._checkAxisline(e)}},i.prototype._checkAxisline=function(e){e.beginTransform(),t._applyStyle(e,this._defaultLineStyle()),t._applyStyle(e,this.lineStyle);var i=this.position==t.AxisPosition.Near,n=this.axisType==t.AxisType.Y;e.strokeWidth>0&&"transparent"!=e.stroke&&"#00000000"!=e.stroke&&"rgba(0,0,0,0)"!=e.stroke&&(this._axisLinePosition=n?i?this._axrect.right:this._axrect.left:i?this._axrect.top:this._axrect.bottom),e.restoreTransform()},i.prototype._getCorrectAngle=function(e){var i=0;if(e)try{for(var n=t.__Constant_Core_Label_ClassName,r=this._axisscale().ticks,o=(this._axrect.right-this._axrect.left)/r.length,a=0;r&&a<r.length;++a){var s=r[a],l=this._site.labelFromValue(s,this._axisscale().format),u=e.measureString(l,n,this._styleClassName());if(u.width>.8*o)e.__stringRender._measureMultipleLines(l,.8*o).length>3&&(i=135);u.width>o&&o<120&&(i=91)}}catch(t){i=0}else this.labelAngle&&((i=this.labelAngle)>90?i=90:i<-90&&(i=-90)),void 0===this.labelAngle&&void 0!==this._actualAngle&&(i=this._actualAngle);return i},i.prototype._render=function(e){if(null!=this._axrect&&!t._Util.isNil(this._axrect)&&this.position!=t.AxisPosition.None){e.beginTransform(),t._applyStyle(e,this.style),t._applyStyle(e,this.textStyle);this._GRIDLINE_WIDTH;if(null!==this.getPosition()){e.startGroup(this._styleClassName()),this._vals={};for(var i=this._getCorrectAngle(),n=this.axisType==t.AxisType.Y,r=this.position==t.AxisPosition.Near,o=0,a=this._layoutList;o<a.length;o++){var s=a[o];s&&((this.majorGrid||this.minorGrid)&&this._renderGridLines(e,s),(this.majorTicks||this.minorTicks)&&this._renderTicks(e,s),this.labels&&(this._renderLabelBg(s,i,e),this._renderLabelInAxis(e,s,i)))}if(null!=this._site&&this._site.isOrdinal&&this._site.groups&&this._site.groups.length>0){var l=this.majorTickSize,u=this._TICK_OVERLAP,h=this.majorTicks;void 0!==h&&null!==h||(h=t.TickMark.Outside),h==t.TickMark.Outside?u=1:h==t.TickMark.Inside?u=-1:h==t.TickMark.Cross&&(u=0);var c=.5*(1+u)*l;r?(this._renderGroupLbs(e,this._site.groups,1,this._axrect.right-c-this._TICK_LABEL_DISTANCE-2-this._annoSize.width,this._axrect.top+c+this._annoSize.height,i),this._site.groupLevels>=1&&this._renderGroupLines(e,this._site.groups,[],1,this._axrect.right,this._axrect.top)):(this._renderGroupLbs(e,this._site.groups,1,this._axrect.left+c+this._TICK_LABEL_DISTANCE+2+this._annoSize.width,this._axrect.bottom-c-this._annoSize.height,i),this._site.groupLevels>=1&&this._renderGroupLines(e,this._site.groups,[],1,this._axrect.left,this._axrect.bottom))}this._renderLine(e,n,r),this._renderTitle(e,n,r),e.endGroup(),e.restoreTransform()}}},i.prototype._renderLabelBg=function(e,i,n){n.beginTransform(),t._applyStyle(n,this.style),n.fill=this.style.backgroundColor||"none";for(var r=[],o=[],a=0;a<4;++a)r[a]=e.labelRect.points[a].x,o[a]=e.labelRect.points[a].y;n.drawPolygon(r,o),n.restoreTransform()},i.prototype._renderTicks=function(e,i){if(this.majorTicks!=t.TickMark.None&&i.majorTickLine&&(e.beginTransform(),t._applyStyle(e,this._defaultMajorTickStyle()),t._applyStyle(e,this.majorTickStyle),e.drawLine(i.majorTickLine.startPoint.x,i.majorTickLine.startPoint.y,i.majorTickLine.endPoint.x,i.majorTickLine.endPoint.y,t.__Constant_Core_Tick_Major_ClassName),e.restoreTransform()),this.minorTicks!=t.TickMark.None){e.beginTransform(),t._applyStyle(e,this._defaultMinorTickStyle()),t._applyStyle(e,this.minorTickStyle);for(var n=0;n<i.minorTickLines.length;++n){var r=i.minorTickLines[n];e.drawLine(r.startPoint.x,r.startPoint.y,r.endPoint.x,r.endPoint.y,t.__Constant_Core_Tick_Minor_ClassName)}e.restoreTransform()}},i.prototype._renderGridLines=function(e,i){if(this.majorGrid&&(e.beginTransform(),t._applyStyle(e,this._defaultMajorGridStyle()),t._applyStyle(e,this.majorGridStyle),this.axisType==t.AxisType.Y?-1==this._allAxisLinePosition.indexOf(i.majorTickLine.startPoint.y)&&e.drawLine(this._plotrect.left,i.majorTickLine.startPoint.y,this._plotrect.right,i.majorTickLine.startPoint.y,t.__Constant_Core_Grid_Line_Major_ClassName):-1==this._allAxisLinePosition.indexOf(i.majorTickLine.startPoint.x)&&e.drawLine(i.majorTickLine.startPoint.x,this._plotrect.top,i.majorTickLine.startPoint.x,this._plotrect.bottom,t.__Constant_Core_Grid_Line_Major_ClassName),e.restoreTransform()),this.minorGrid){e.beginTransform(),t._applyStyle(e,this._defaultMinorGridStyle()),t._applyStyle(e,this.minorGridStyle);for(var n=0,r=i.minorTickLines;n<r.length;n++){var o=r[n];this.axisType==t.AxisType.Y?-1==this._allAxisLinePosition.indexOf(o.startPoint.y)&&e.drawLine(this._plotrect.left,o.startPoint.y,this._plotrect.right,o.startPoint.y,t.__Constant_Core_Grid_Line_Minor_ClassName):-1==this._allAxisLinePosition.indexOf(o.startPoint.x)&&e.drawLine(o.startPoint.x,this._plotrect.top,o.startPoint.x,this._plotrect.bottom,t.__Constant_Core_Grid_Line_Minor_ClassName)}e.restoreTransform()}},i.prototype._renderLabelInAxis=function(e,i,n){if(null!=i.label){if(e.beginTransform(),t._applyStyle(e,this.labelStyle),e.startGroup(t.__Constant_Core_Label_ClassName),i.multipleLines){var r={x:i.labelRect.leftBottom.x,y:i.labelRect.leftBottom.y};i.multipleLines.forEach(function(t){var n=t.text,o=t.size;e.drawStringRotated(n,r,r,180*i.labelRect.angle/Math.PI),r.y+=.9*o.height})}else{e.measureString(i.label);i.labelRect.angle>Math.PI/2?e.drawStringRotated(i.label,i.labelRect.rightTop,i.labelRect.rightTop,180*i.labelRect.angle/Math.PI+180):e.drawStringRotated(i.label,i.labelRect.leftBottom,i.labelRect.leftBottom,180*i.labelRect.angle/Math.PI)}e.endGroup(),e.restoreTransform()}},i.prototype._renderGroupLines=function(e,i,n,r,o,a){e.beginTransform(),t._applyStyle(e,this._defaultMajorGridStyle()),t._applyStyle(e,this.majorGridStyle);var s=this.axisType==t.AxisType.Y,l=t.__Constant_Core_Tick_Major_ClassName,u=this.position==t.AxisPosition.Near;if(s){var h=o;if(u)for(var c=0;c<this._axisLableLineheightlist.length;++c)h-=this._axisLableLineheightlist[c]-this._annoSize.width;else for(c=0;c<this._axisLableLineheightlist.length;++c)h+=this._axisLableLineheightlist[c]+this._annoSize.width;for(c=0;c<i.length;++c){var p=(g=i[c]).children;if(n.indexOf(g.start)<0){var f=this.convert(g.start-.5);e.drawLine(h,f,o,f,l,this.majorTickStyle),n.push(g.start)}if(n.indexOf(g.end)<0){var _=this.convert(g.end+.5);e.drawLine(h,_,o,_,l,this.majorTickStyle),n.push(g.end)}p&&p.length>0&&this._renderGroupLines(e,p,n,r+1,o,a)}}else{var d=a;if(u)for(c=0;c<this._axisLableLineheightlist.length;++c)d+=this._axisLableLineheightlist[c]+this._annoSize.height;else for(c=0;c<this._axisLableLineheightlist.length;++c)d-=this._axisLableLineheightlist[c]-this._annoSize.height;for(c=0;c<i.length;++c){var g;p=(g=i[c]).children;if(n.indexOf(g.start)<0){var y=this.convert(g.start-.5);e.drawLine(y,a,y,d,l,this.majorTickStyle),n.push(g.start)}if(n.indexOf(g.end)<0){var m=this.convert(g.end+.5);e.drawLine(m,a,m,d,l,this.majorTickStyle),n.push(g.end)}p&&p.length>0&&this._renderGroupLines(e,p,n,r+1,o,a)}}e.restoreTransform()},i.prototype._renderGroupLbs=function(e,i,n,r,o,a){e.beginTransform(),t._applyStyle(e,this.labelStyle);for(var s=0;s<i.length;++s){var l=i[s],u=(l.start+l.end)/2;this._renderGroupLables(e,i[s].label,u,r,o,a,n),l.children&&l.children.length>0&&this._renderGroupLbs(e,l.children,n+1,r,o,a)}e.restoreTransform()},i.prototype._renderLine=function(e,i,n){if(this.axisLine){e.beginTransform(),t._applyStyle(e,this._defaultLineStyle()),t._applyStyle(e,this.lineStyle);var r=t.__Constant_Core_Line_ClassName;i?n?e.drawLine(this._axrect.right,this._axrect.top,this._axrect.right,this._axrect.bottom,r):e.drawLine(this._axrect.left,this._axrect.top,this._axrect.left,this._axrect.bottom,r):n?e.drawLine(this._axrect.left,this._axrect.top,this._axrect.right,this._axrect.top,r):e.drawLine(this._axrect.left,this._axrect.bottom,this._axrect.right,this._axrect.bottom,r),e.restoreTransform()}},i.prototype._renderTitle=function(e,i,n){if(this.title){e.beginTransform(),t._applyStyle(e,this.titleStyle);var r,o=t.__Constant_Core_Title_ClassName,a=2,s=this.titleStyle.padding;i?n?(a=s._isEmpty()?0:s.left,r=new t.core.Point(this._axrect.left+.5*this._szTitle.height+a,this._axrect.top+.5*this._axrect.height),t._RenderUtils.renderRotatedText(e,this.title,r,1,1,r,-90,o,this._styleClassName())):(a=s._isEmpty()?0:s.right,r=new t.core.Point(this._axrect.right-.5*this._szTitle.height-a,this._axrect.top+.5*this._axrect.height),t._RenderUtils.renderRotatedText(e,this.title,r,1,1,r,90,o,this._styleClassName())):n?(a=s._isEmpty()?0:s.bottom,t._RenderUtils.renderText(e,this.title,new t.core.Point(this._axrect.left+.5*this._axrect.width,this._axrect.bottom-a),1,2,o)):(a=s._isEmpty()?0:s.top,t._RenderUtils.renderText(e,this.title,new t.core.Point(this._axrect.left+.5*this._axrect.width,this._axrect.top+a),1,0,o)),e.restoreTransform()}},i.prototype._renderGroupLables=function(e,i,n,r,o,a,s){var l=t.__Constant_Core_Label_ClassName,u=this._axisType==t.AxisType.Y,h=this._getLabelAlign(u),c=this.position==t.AxisPosition.Near;if(u){var p=this.convert(n),f=r;if(c){for(var _=this._axisLableLineheightlist.length-1;_>s;--_)f-=this._axisLableLineheightlist[_];var d=new t.core.Point(f,p);a>0?90==a?t._RenderUtils.renderRotatedText(e,i,d,1,0,d,a,l,this._styleClassName()):t._RenderUtils.renderRotatedText(e,i,d,2,1,d,a,l,this._styleClassName()):a<0?-90==a?t._RenderUtils.renderRotatedText(e,i,d,1,2,d,a,l,this._styleClassName()):t._RenderUtils.renderRotatedText(e,i,d,2,1,d,a,l,this._styleClassName()):this._renderLabel(e,n,i,d,2,h,l)}else{for(_=this._axisLableLineheightlist.length-1;_>s;--_)f+=this._axisLableLineheightlist[_];d=new t.core.Point(f,p);a>0?90==a?t._RenderUtils.renderRotatedText(e,i,d,1,2,d,a,l,this._styleClassName()):t._RenderUtils.renderRotatedText(e,i,d,0,1,d,a,l,this._styleClassName()):a<0?-90==a?t._RenderUtils.renderRotatedText(e,i,d,1,0,d,a,l,this._styleClassName()):t._RenderUtils.renderRotatedText(e,i,d,0,1,d,a,l,this._styleClassName()):this._renderLabel(e,n,i,d,0,h,l)}}else{f=this.convert(n);if(c){for(p=o,_=this._axisLableLineheightlist.length-1;_>s;--_)p+=this._axisLableLineheightlist[_];d=new t.core.Point(f,p);0!=a?this._renderRotatedLabel(e,i,d,a,l,c):this._renderLabel(e,n,i,d,h,0,l)}else{for(p=o,_=this._axisLableLineheightlist.length-1;_>s;--_)p-=this._axisLableLineheightlist[_];d=new t.core.Point(f,p);0!=a?this._renderRotatedLabel(e,i,d,a,l,c):this._renderLabel(e,n,i,d,h,1,l)}}},i.prototype._renderLabel=function(e,i,n,r,o,a,s){if(this.itemFormatter){var l=r.clone();this.axisType==t.AxisType.X?this.getPosition()==t.Position.Top?l.y=this._plotrect.top:l.y=this._plotrect.bottom:this.getPosition()==t.Position.Right?l.x=this._plotrect.right:l.x=this._plotrect.left;var u={val:i,text:n,pos:l,cls:s};(u=this.itemFormatter(e,u))?(n=u.text,s=u.cls):n=null}if(n)t._RenderUtils.renderText(e,n,r,o,a,s,null,null,null);return!0},i.prototype._renderRotatedLabel=function(e,i,n,r,o,a){if(i){var s=e.measureString(i,o,this._styleClassName());new t.core.Rect(n.x,n.y,s.height+2,s.width),this.overlappingLabels,t.AxisOverlappingLabels.Auto;if(90!=r&&-90!=r){var l=.5*s.height*Math.abs(Math.sin(r*Math.PI/180));a?n.y+=l:n.y-=l}var u=a?r>0?0:2:r>0?2:0;return t._RenderUtils.renderRotatedText(e,i,n,u,1,n,r,o,this._styleClassName()),!0}return!1},i.prototype._getLabelAlign=function(t){var e=1;if(this.labelAlign){var i=this.labelAlign.toLowerCase();t?"top"==i?e=0:"bottom"==i&&(e=2):"left"==i?e=0:"right"==i&&(e=2)}return e},i.prototype.convert=function(t,e,i){return this.__axisscale.getScaleValue(t)},Object.defineProperty(i.prototype,"axisType",{get:function(){return this._axisType},enumerable:!0,configurable:!0}),i.prototype._getMinNum=function(){return this._axisscale().min},i.prototype._getMaxNum=function(){return this._axisscale().max},i.prototype._invalidate=function(){},i.prototype._getAnnoNumber=function(t){var e=t?this._annoSize.height:this._annoSize.width,i=t?this._axrect.height:this._axrect.width;if(e>0&&i>0){var n=Math.floor(i/(e+6));return n<=0&&(n=1),n}return 10},i.prototype.onHitted=function(e){return e.contains(this._axrect)?new t.HitInfo(new t.core.Point(e.x,e.y),this._site,null,this,[t.ElementType.Axis],null):null},i}(t._BaseAxis);t._LineAxis=e}(r||(r={})),function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n._auxAxes=[],n._ax=new t._LineAxis(n,t.AxisType.X,new t.options._AxisOption({})),n._ay=new t._LineAxis(n,t.AxisType.Y,new t.options._AxisOption({})),n}return s(i,e),i.prototype.getAxes=function(){var t=[this._ay,this._ax];return this.auxAxes.forEach(function(e){return t.push(e)}),t},Object.defineProperty(i.prototype,"axisX",{get:function(){return this._ax},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"axisY",{get:function(){return this._ay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"auxAxes",{get:function(){return this._auxAxes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"plotRect",{get:function(){return this._plotRect},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"plotMargin",{get:function(){return this._plotMargin},set:function(t){this._plotMargin=t},enumerable:!0,configurable:!0}),i.prototype.updateAxis=function(t,e){void 0===e&&(e=null),t._updateActualLimits(e)},i.prototype._layout=function(e,i){var n=i.width,r=i.height,o=new t.core.Size(n,.75*r),a=new t.core.Size(r,.75*n),s=0,l=0,u=n,h=r,c=0,p=0,f=n,_=r,d=0,g=this.getAxes();g.sort(function(e,i){return e.axisType===t.AxisType.X?1:-1});for(var y=0;y<g.length;y++){var m=g[y];if(m._axisscale()){var v=m.origin,b=m.getPosition();if(m.axisType==t.AxisType.X){x=m._measure(e,n-d),x>o.height&&(x=o.height),m._desiredSize=new t.core.Size(o.width,x);var S=m._hasOrigin=t.core.isNumber(v)&&v>this.axisY._getMinNum()&&v<this.axisY._getMaxNum();if(b==t.Position.Bottom)if(S){var C=this._convertY(v,p,_);_-=Math.max(0,C+x-_)}else _-=x;else if(b==t.Position.Top)if(S){C=this._convertY(v,p,_);p+=Math.max(0,p-(C-x))}else p+=x}else if(m.axisType==t.AxisType.Y){var x;(x=m._measure(e,r))>a.height&&(x=a.height),d+=x,m._desiredSize=new t.core.Size(a.width,x);S=m._hasOrigin=t.core.isNumber(v)&&v>this.axisX._getMinNum()&&v<this.axisX._getMaxNum();if(b==t.Position.Left)if(l=Math.max(l,.5*m._annoSize.height),h=Math.min(h,r-.5*m._annoSize.height),S){var T=this._convertX(v,c,f);c+=Math.max(0,c-(T-x))}else c+=x;else if(b==t.Position.Right)if(l=Math.max(l,.5*m._annoSize.height),h=Math.min(h,r-.5*m._annoSize.height),S){T=this._convertX(v,c,f);f-=Math.max(0,T+x-f)}else f-=x}}}var w=t._Util.parseMargin(this.plotMargin);s=c=isNaN(w.left)?Math.max(s,c)+i.left:w.left,u=f=isNaN(w.right)?Math.min(u,f)+i.left:i.width-w.right,l=p=isNaN(w.top)?Math.max(l,p)+i.top:w.top,h=_=isNaN(w.bottom)?Math.min(h,_)+i.top:i.height-w.bottom;for(var P=0;P<g.length;++P){var A=g[P];A._axisscale()&&(A.axisType==t.AxisType.Y&&A._measure(e,h-l))}n=Math.max(1,u-s),r=Math.max(1,h-l),this._plotRect=new t.core.Rect(s,l,n,r);for(var F=0;F<g.length;F++){var O=g[F];if(O._axisscale()){var M=O.origin;b=O.getPosition();if(O.axisType==t.AxisType.X){var D;if(O._hasOrigin){C=this._convertY(M,this._plotRect.top,this._plotRect.bottom);b==t.Position.Bottom?(D=new t.core.Rect(s,C,n,O._desiredSize.height),_+=Math.max(0,D.bottom-this._plotRect.bottom)):b==t.Position.Top?(D=new t.core.Rect(s,C-O._desiredSize.height,n,O._desiredSize.height),p-=Math.max(0,this._plotRect.top-D.top)):D=new t.core.Rect(s,p,n,1)}else b==t.Position.Bottom?(D=new t.core.Rect(s,_,n,O._desiredSize.height),_+=O._desiredSize.height):b==t.Position.Top?(D=new t.core.Rect(s,p-O._desiredSize.height,n,O._desiredSize.height),p-=O._desiredSize.height):D=new t.core.Rect(s,p,n,1);O._layout(e,D,this._plotRect)}else if(O.axisType==t.AxisType.Y){var L;if(O._hasOrigin){T=this._convertX(M,this._plotRect.left,this._plotRect.right);b==t.Position.Left?(L=new t.core.Rect(T-O._desiredSize.height,l,r,O._desiredSize.height),c-=O._desiredSize.height):b==t.Position.Right?(L=new t.core.Rect(T,l,r,O._desiredSize.height),f+=O._desiredSize.height):L=new t.core.Rect(s,p,r,1)}else b==t.Position.Left?(L=new t.core.Rect(c-O._desiredSize.height,l,r,O._desiredSize.height),c-=O._desiredSize.height):b==t.Position.Right?(L=new t.core.Rect(f,l,r,O._desiredSize.height),f+=O._desiredSize.height):L=new t.core.Rect(c,l,r,1);O._layout(e,L,this._plotRect)}}}},i.prototype.render=function(e){e.beginTransform(),t._applyStyle(e,{strokeWidth:0}),this._applyBackgroundStyle(e),null!=e.fill&&"transparent"!=e.fill&&"none"!=e.fill&&e.drawRect(this.plotRect.left,this.plotRect.top,this.plotRect.width,this.plotRect.height),e.restoreTransform();for(var i=this.getAxes(),n=[],r=[],o=0,a=i;o<a.length;o++){var s=a[o];s.axisType===t.AxisType.X?n.push(s._axisLinePosition):s.axisType==t.AxisType.Y&&r.push(s._axisLinePosition)}for(var l=0;l<i.length;l++){var u=i[l];u._axisscale()&&(u.axisType===t.AxisType.X?u._allAxisLinePosition=r:u.axisType===t.AxisType.Y&&(u._allAxisLinePosition=n),u._render(e))}e.beginTransform(),t._applyStyle(e,{fill:"none"}),this._applyBorderStyle(e),null!=e.strokeWidth&&e.strokeWidth>0&&e.drawRect(this.plotRect.left,this.plotRect.top,this.plotRect.width,this.plotRect.height),e.restoreTransform()},i.prototype._convertX=function(t,e,i){var n=this.axisX;return n.reversed?i-(i-e)*(t-n._getMinNum())/(n._getMaxNum()-n._getMinNum()):e+(i-e)*(t-n._getMinNum())/(n._getMaxNum()-n._getMinNum())},i.prototype._convertY=function(t,e,i){var n=this.axisY;return n.reversed?e+(i-e)*(t-n._getMinNum())/(n._getMaxNum()-n._getMinNum()):i-(i-e)*(t-n._getMinNum())/(n._getMaxNum()-n._getMinNum())},i}(t._BaseAxisLayer);t._LineAxisLayer=e}(r||(r={})),function(t){var e=function(e){function i(i,n,r){var o=e.call(this,i,n,r)||this;return o._axisPosition=0,o._axisSize=0,o.__radiusoffset=0,o._startAngle=0,o._sweep=2*Math.PI,o._innerRadius=0,o.__option.position=t.AxisPosition.Near,o}return s(i,e),Object.defineProperty(i.prototype,"cx",{get:function(){return this._cx},set:function(t){this._cx=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cy",{get:function(){return this._cy},set:function(t){this._cy=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"innerRadius",{get:function(){return this._innerRadius},set:function(t){this._innerRadius=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"startAngle",{get:function(){return this._startAngle+Math.PI},set:function(t){this._startAngle=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sweep",{get:function(){return this._sweep},set:function(t){this._sweep=t},enumerable:!0,configurable:!0}),i.prototype._radiusOffset=function(t){if(void 0===t)return this.__radiusoffset;this.__radiusoffset=t},i.prototype.getPosition=function(){return this.position==t.AxisPosition.None?null:this.axisType==t.AxisType.X?this.position==t.AxisPosition.Near?t.Position.Bottom:t.Position.Top:this.axisType==t.AxisType.Y?this.position==t.AxisPosition.Near?t.Position.Left:t.Position.Right:null},i.prototype._overlapAxis=function(){for(var e=0;e<this._layoutList.length;++e){var i=this._layoutList[e];if(i&&!i.hidden)for(var n=e+1;n<this._layoutList.length;++n){var r=this._layoutList[n];if(!r||!t._Util.isMixedRotatedRect(i.labelRect,r.labelRect))break;r.hidden=!0}}},i.prototype._measure=function(e,i){e.beginTransform(),t._applyStyle(e,this.style),t._applyStyle(e,this.textStyle);t.__Constant_Core_Label_ClassName;this._actualAngle=void 0;var n=0,r=this.labelAngle;if(this._isTimeAxis?(this.min instanceof Date&&(this.__axisscale.min=this.min.getTime()),this.max instanceof Date&&(this.__axisscale.max=this.max.getTime())):(isNaN(this.min)||(this.__axisscale.min=this.min),isNaN(this.max)||(this._axisscale().max=this.max)),this.__axisscale.format=this._getformat(),this.__axisscale.refresh(),this._annoSize=this.getMaxLableSize(e),r){var o=r*Math.PI/180,a=this._annoSize.width,s=this._annoSize.height;this._annoSize.width=a*Math.abs(Math.cos(o))+s*Math.abs(Math.sin(o)),this._annoSize.height=a*Math.abs(Math.sin(o))+s*Math.abs(Math.cos(o))}(isNaN(this.majorUnit)||this.overlappingLabels==t.AxisOverlappingLabels.Show)&&this.axisType==t.AxisType.X&&(isNaN(this.__axisscale.unit)||this.__axisscale.unit<this._annoSize.width)&&(this.__axisscale.unit=this._annoSize.width);this._axisscale().ticks;this.labels&&(n+=this._annoSize.height),e.beginTransform(),t._applyStyle(e,this.titleStyle),n+=Math.max(this._getTickHeightBelowAxis(e,this.majorTicks,this.majorTickSize),this._getTickHeightBelowAxis(e,this.minorTicks,this.minorTickSize)),n+=this._getTitleHeight(e);var l=this.titleStyle.padding,u=this.labelStyle.padding;return n+=l._isEmpty()?t.__AXIS_TITLE_PADDING:l.top+l.bottom,n+=u._isEmpty()?t.__AXIS_LABLE_PADDING:u.top+u.bottom,e.restoreTransform(),this.position==t.AxisPosition.None?0:n},i.prototype._layout=function(e,i,n){var r=this.axisType==t.AxisType.Y;if(this._layoutList.length=0,this._plotrect=n,this._axrect=r?new t.core.Rect(i.left,i.top,i.height,i.width):i,this.__axisscale.reversed=this.reversed,this._axisscale().unit=this.majorUnit,this._axisscale()instanceof t.OrdinalScale||(this._axisscale().tickNumber=this._getAnnoNumber(this.axisType==t.AxisType.Y)),this.axisType==t.AxisType.X)this.__axisscale.range([this.innerRadius*this.radius,this.radius]),this._layoutXAxis(e);else if(this.axisType==t.AxisType.Y){var o=this.startAngle,a=this.startAngle+this.sweep;this.__axisscale.range([o,a]),this._layoutYAxis(e)}this.overlappingLabels!=t.AxisOverlappingLabels.Show&&this._overlapAxis()},i.prototype.getMaxLableSize=function(e){e.beginTransform(),t._applyStyle(e,this.labelStyle);for(var i=t.__Constant_Core_Label_ClassName,n=(t.__Constant_Core_Title_ClassName,this._site.isOrdinal),r=new t.core.Size(0,0),o=0;o<this._axisscale().ticks.length;++o){var a=this.__axisscale.ticks[o],s=this._site.labelFromValue(this._isTimeAxis?new Date(a):a,n?null:this._axisscale().format),l=e.measureString(s,i,this._styleClassName());r.width<l.width&&(r.width=l.width),r.height<l.height&&(r.height=l.height)}return e.restoreTransform(),r},i.prototype._layoutXAxis=function(e){var i=t.__Constant_Core_Label_ClassName;if(null!==this.getPosition()){this._layoutList.length=0,t._applyStyle(e,this.labelStyle);for(var n=this._getCorrectAngle(),r=(this.position,t.AxisPosition.Near,this._site.isOrdinal),o=this._axisscale().ticks,a=this._getTickHeightBelowAxis(e,this.majorTicks,this.majorTickSize),s=this.majorTickSize,l=this.minorTickSize,u=this._getTickHeightBelowAxis(e,this.minorTicks,this.minorTickSize),h=(this.titleStyle.padding,this.labelStyle.padding),c=NaN,p=0;o&&p<o.length;++p){var f=o[p],_=p>=o.length?null:o[p+1],d=r?this._site.labelFromValue(this._isTimeAxis?new Date(f):f,null):this._site.labelFromValue(this._isTimeAxis?new Date(f):f,this._axisscale().format),g=e.measureString(d,i,this._styleClassName());this.labels||(g.width=0,g.height=0);var y=this.__axisscale.getScaleValue(f+this.__radiusoffset),m=Math.cos(this.startAngle)*y+this.cx,v=Math.sin(this.startAngle)*y+this.cy,b=h._isEmpty()?t.__AXIS_LABLE_PADDING:h.top,S=m+Math.sin(this.startAngle)*(Math.max(a,u)+b+g.height/2),C=v-Math.cos(this.startAngle)*(Math.max(a,u)+b+g.height/2),x=new t.RadialAxisViewModel;x.hidden=!1,x.label=d,x.labelRect=new t.RotateRect(S,C,g.width,g.height,this.startAngle-Math.PI+(isNaN(n)?0:n*Math.PI/180)+(isNaN(n)?Math.PI/2:0)),x.majorTickLine=new t.RotateLine(m,v,s-a,a,this.startAngle);var T=this.minorUnit;for(null==T&&(T=(_-f)/2),isNaN(c)&&(c=f+T);c<_;){var w=this.__axisscale.getScaleValue(c+this.__radiusoffset),P=Math.cos(this.startAngle)*w+this.cx,A=Math.sin(this.startAngle)*w+this.cy;c+=T,P==m&&A==v||x.minorTickLines.push(new t.RotateLine(P,A,l-u,u,this.startAngle))}this._layoutList.push(x)}}},i.prototype._layoutYAxis=function(e){var i=t.__Constant_Core_Label_ClassName;if(null!==this.getPosition())for(var n=this._getCorrectAngle(),r=(this.position,t.AxisPosition.Near,this._axisscale().ticks),o=(this.position,t.AxisPosition.Far,this._getTickHeightBelowAxis(e,this.majorTicks,this.majorTickSize)),a=this.majorTickSize,s=this.minorTickSize,l=this._getTickHeightBelowAxis(e,this.minorTicks,this.minorTickSize),u=NaN,h=(this.titleStyle.padding,this.labelStyle.padding),c=0;r&&c<r.length;++c){var p=r[c],f=c>=r.length?null:r[c+1];this._isTimeAxis&&(p=new Date(p));var _=this._site.labelFromValue(p,this._axisscale().format),d=e.measureString(_,i,this._styleClassName());this.labels||(d.width=0,d.height=0);var g=this.__axisscale.getScaleValue(p),y=this.cx+Math.cos(g)*this.radius,m=this.cy+Math.sin(g)*this.radius,v=h._isEmpty()?t.__AXIS_LABLE_PADDING:h.bottom,b=this.cx+Math.cos(g)*(this.radius+Math.max(o,l)+v+(n?d.width/2:d.height/2)),S=this.cy+Math.sin(g)*(this.radius+Math.max(o,l)+v+(n?d.width/2:d.height/2)),C=new t.RadialAxisViewModel;C.hidden=!1,C.label=_,C.labelRect=new t.RotateRect(b,S,d.width,d.height,g+Math.PI/2+n*Math.PI/180),C.majorTickLine=new t.RotateLine(y,m,o,a-o,g-Math.PI/2);var x=this.minorUnit;for(null==x&&(x=(f-p)/2),isNaN(u)&&(u=p+x);u<f;){var T=this.__axisscale.getScaleValue(u),w=this.cx+Math.cos(T)*this.radius,P=this.cy+Math.sin(T)*this.radius;u+=x,w==y&&P==m||C.minorTickLines.push(new t.RotateLine(w,P,l,s-l,T-Math.PI/2))}this._layoutList.push(C)}},i.prototype._getformat=function(t){return this.format?this.format:this._isTimeAxis?null:Math.round(t)?"n0":"n"},i.prototype._updateActualLimits=function(e){this._site=e,this._isTimeAxis||(this._isTimeAxis=this._site.dataType==t.core.DataType.Date)},i.prototype._getCorrectAngle=function(){var t=0;return this.labelAngle&&((t=this.labelAngle)>90?t=90:t<-90&&(t=-90)),void 0===this.labelAngle&&void 0!==this._actualAngle&&(t=this._actualAngle),t},i.prototype._render=function(e){if(this.position!=t.AxisPosition.None){e.beginTransform(),t._applyStyle(e,this.style),t._applyStyle(e,this.textStyle);t.__Constant_Core_Tick_Major_ClassName;var i=t.__Constant_Core_Label_ClassName,n=t.__Constant_Core_Grid_Line_Major_ClassName;this._GRIDLINE_WIDTH;if(null!==this.getPosition()){e.startGroup(this._styleClassName()),this._vals={};this._getCorrectAngle(),this.axisType,t.AxisType.Y,this.position,t.AxisPosition.Near;for(var r=0;r<this._layoutList.length;++r){var o=this._layoutList[r];if(o){if(this.majorGrid){if(e.beginTransform(),t._applyStyle(e,this._defaultMajorGridStyle()),t._applyStyle(e,this.majorGridStyle),this.axisType==t.AxisType.Y)e.drawLine(o.majorTickLine.startPoint.x,o.majorTickLine.startPoint.y,this.cx,this.cy,n);else if(this.axisType==t.AxisType.X){var a=isNaN(this.startAngle)?this.startAngle:0,s=isNaN(this.sweep)?this.sweep:360,l=Math.sqrt(Math.pow(o.majorTickLine.startPoint.x-this.cx,2)+Math.pow(o.majorTickLine.startPoint.y-this.cy,2));e.drawPieSegment(this.cx,this.cy,l,a*Math.PI/180,s*Math.PI/180,t.__Constant_Core_Grid_Line_Major_ClassName,{fill:"none"})}e.restoreTransform()}if(this.minorGrid){if(e.beginTransform(),t._applyStyle(e,this._defaultMinorGridStyle()),t._applyStyle(e,this.minorGridStyle),this.axisType==t.AxisType.Y)for(var u=0;u<o.minorTickLines.length;++u){var h=o.minorTickLines[u];e.drawLine(h.startPoint.x,h.startPoint.y,this.cx,this.cy,n)}else if(this.axisType==t.AxisType.X)for(u=0;u<o.minorTickLines.length;++u){h=o.minorTickLines[u],a=isNaN(this.startAngle)?this.startAngle:0,s=isNaN(this.sweep)?this.sweep:360,l=Math.sqrt(Math.pow(h.startPoint.x-this.cx,2)+Math.pow(h.startPoint.y-this.cy,2));e.drawPieSegment(this.cx,this.cy,l,a*Math.PI/180,s*Math.PI/180,t.__Constant_Core_Grid_Line_Minor_ClassName,{fill:"none"})}e.restoreTransform()}if(this.majorTicks!=t.TickMark.None&&(e.beginTransform(),t._applyStyle(e,this._defaultMajorTickStyle()),t._applyStyle(e,this.majorTickStyle),e.drawLine(o.majorTickLine.startPoint.x,o.majorTickLine.startPoint.y,o.majorTickLine.endPoint.x,o.majorTickLine.endPoint.y,t.__Constant_Core_Tick_Major_ClassName),e.restoreTransform()),this.minorTicks!=t.TickMark.None){e.beginTransform(),t._applyStyle(e,this._defaultMinorTickStyle()),t._applyStyle(e,this.minorTickStyle);for(u=0;u<o.minorTickLines.length;++u){var c=o.minorTickLines[u];e.drawLine(c.startPoint.x,c.startPoint.y,c.endPoint.x,c.endPoint.y,t.__Constant_Core_Tick_Minor_ClassName)}e.restoreTransform()}if(!o.hidden&&this.labels&&null!=o.label){e.beginTransform(),t._applyStyle(e,this.style),e.fill=this.style.backgroundColor||"none";var p=[],f=[];for(u=0;u<4;++u)p[u]=o.labelRect.points[u].x,f[u]=o.labelRect.points[u].y;e.drawPolygon(p,f),e.restoreTransform(),e.beginTransform(),e.startGroup(i),t._applyStyle(e,this.labelStyle),this.axisType,t.AxisType.Y,e.drawStringRotated(o.label,o.labelRect.leftBottom,o.labelRect.leftBottom,180*o.labelRect.angle/Math.PI),e.endGroup(),e.restoreTransform()}}}this._renderLineAndTitle(e),e.endGroup(),e.restoreTransform()}}},i.prototype._renderLineAndTitle=function(e){e.beginTransform();var i=this.titleStyle.padding;t._applyStyle(e,this.titleStyle);var n=t.__Constant_Core_Title_ClassName,r=t.__Constant_Core_Line_ClassName;if(this.axisType===t.AxisType.X){var o=this.cx+Math.cos(this.startAngle)*this.radius,a=this.cy+Math.sin(this.startAngle)*this.radius,s=this.cx+Math.cos(this.startAngle)*this.innerRadius*this.radius,l=this.cy+Math.sin(this.startAngle)*this.innerRadius*this.radius;e.beginTransform(),t._applyStyle(e,this._defaultLineStyle()),t._applyStyle(e,this.lineStyle),e.drawLine(s,l,o,a,r,this.lineStyle),e.restoreTransform();var u=Math.cos(this.startAngle)*(this.radius+this.innerRadius*this.radius)/2+this.cx,h=Math.sin(this.startAngle)*(this.radius+this.innerRadius*this.radius)/2+this.cy,c=this._getTickHeightBelowAxis(e,this.majorTicks,this.majorTickSize),p=e.measureString(this.title,n),f=i._isEmpty()?0:i.top,_=u+2*Math.sin(this.startAngle)*(c+f+p.height),d=h-2*Math.cos(this.startAngle)*(c+f+p.height);e.drawStringRotated(this.title,new t.core.Point(_,d),new t.core.Point(_,d),180*this.startAngle/Math.PI-180,n)}else{e.beginTransform(),t._applyStyle(e,this._defaultLineStyle()),t._applyStyle(e,this.lineStyle),e.drawPieSegment(this.cx,this.cy,this.radius,this.startAngle,this.sweep,r,{fill:"none"}),e.restoreTransform();p=e.measureString(this.title,n),f=i._isEmpty()?t.__AXIS_TITLE_PADDING:i.bottom;e.drawString(this.title,new t.core.Point(this._axrect.left+this._axrect.width/2-p.width/2,this._axrect.bottom-f),n)}e.restoreTransform()},i.prototype.convert=function(t,e,i){return this.__axisscale.getScaleValue(t)},Object.defineProperty(i.prototype,"axisType",{get:function(){return this._axisType},enumerable:!0,configurable:!0}),i.prototype._getMinNum=function(){return this._axisscale().min},i.prototype._getMaxNum=function(){return this._axisscale().max},i.prototype._invalidate=function(){},i.prototype._getAnnoNumber=function(t){var e=t?this._annoSize.height:this._annoSize.width,i=t?this._axrect.height:this._axrect.width;if(e>0&&i>0){var n=Math.floor(i/(e+6));return n<=0&&(n=1),n}return 10},i}(t._BaseAxis);t._RadialAxis=e}(r||(r={})),function(t){var e=function(e){function i(i){var n=e.call(this,i)||this;return n._auxAxes=[],n._ax=new t._RadialAxis(n,t.AxisType.X,new t.options._AxisOption({})),n._ay=new t._RadialAxis(n,t.AxisType.Y,new t.options._AxisOption({})),n}return s(i,e),i.prototype.getAxes=function(){var t=[this._ax,this._ay];return this.auxAxes.forEach(function(e){return t.push(e)}),t},Object.defineProperty(i.prototype,"axisX",{get:function(){return this._ax},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"axisY",{get:function(){return this._ay},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"auxAxes",{get:function(){return this._auxAxes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"plotRect",{get:function(){return this._plotRect},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"plotMargin",{get:function(){return this._plotMargin},set:function(t){this._plotMargin=t},enumerable:!0,configurable:!0}),i.prototype.updateAxis=function(t,e){void 0===e&&(e=null),t._updateActualLimits(e)},i.prototype._layout=function(e,i){var n=i.width,r=i.height,o=i.left+i.width/2,a=i.top+i.height/2,s=n<r?n/2:r/2,l=this.getAxes();l.sort(function(e,i){return e.axisType===t.AxisType.X?1:-1});for(var u=0;u<l.length;u++){if((p=l[u])._axisscale()){var h=p.origin;p.getPosition();if(p.axisType==t.AxisType.Y){var c=p._measure(e,n);s-=c,p.radius=s,p._axisSize=c;p._hasOrigin=t.core.isNumber(h)&&h>this.axisY._getMinNum()&&h<this.axisY._getMaxNum()}else if(p.axisType==t.AxisType.X){p._measure(e,r);p._hasOrigin=t.core.isNumber(h)&&h>this.axisX._getMinNum()&&h<this.axisX._getMaxNum()}}}this._plotRect=new t.core.Rect(o-s,a-s,2*s,2*s);for(u=0;u<l.length;u++){var p;if((p=l[u])._axisscale())if(p.cx=o,p.cy=a,p.axisType==t.AxisType.X){p.radius=s;var f=new t.core.Rect(o-(c+s),a-(c+s),2*(c+s),2*(c+s));p._layout(e,f,this._plotRect)}else if(p.axisType==t.AxisType.Y){var _=new t.core.Rect(o-(p._axisSize+p.radius),a-(p._axisSize+p.radius),2*(p._axisSize+p.radius),2*(p._axisSize+p.radius));p._layout(e,_,this._plotRect)}}},i.prototype.render=function(e){var i=this.plotRect;e.beginTransform();var n=i.width,r=i.height,o=i.left+i.width/2,a=i.top+i.height/2,s=n<r?n/2:r/2;t._applyStyle(e,{strokeWidth:0}),this._applyBackgroundStyle(e),null!=e.fill&&"transparent"!=e.fill&&"none"!=e.fill&&e.drawEllipse(o,a,s,s),e.restoreTransform();for(var l=this.getAxes(),u=0;u<l.length;u++){var h=l[u];h._axisscale()&&h._render(e)}e.beginTransform(),t._applyStyle(e,{fill:"none"}),this._applyBorderStyle(e),null!=e.strokeWidth&&e.strokeWidth>0&&e.drawEllipse(o,a,s,s),e.restoreTransform()},i}(t._BaseAxisLayer);t._RadialAxisLayer=e}(r||(r={})),function(t){var e=function(){return function(){}}();t._HitResult=e;var i=function(){function t(t){this._areas=[],this._plot=t}return t.prototype.add=function(t){this._areas.push(t)},t.prototype.clear=function(){this._areas=[]},t.prototype.hitTest=function(t,i){void 0===i&&(i=!1);var n=null,r=Number.MAX_VALUE,o=this._areas;if(o)for(var a=o.length-1;a>=0;a--){var s=o[a],l=s.distance(t);if(l<r&&(n=s,0==(r=l)))break}if(n){var u=new e;return u.area=n,u.distance=r,u}return null},t}();t._HitTester=i}(r||(r={})),function(t){var e=function(){function e(e,i){this.layoutInfo=new t._WrapLayoutInfo,this._item=e,this._label=i}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._item.labelPosition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipsize",{get:function(){return this._item.ellipsize},enumerable:!0,configurable:!0}),e.prototype.getDesiredSize=function(i){var n=new t.core.Size(0,0);if(t._Util.resetRect(this.layoutInfo.rect,0,0,0,0),this._ellipslabel=this.label,this.ellipsize>0&&this.ellipsize<this.label.length&&(this._ellipslabel=this.label.substr(0,this.ellipsize)+e.END),this._labelSize=i.measureString(this._ellipslabel),this._labelSize.width>=100){var r=i.__stringRender._measureMultipleLines(this._ellipslabel,100),o=r.reduce(function(t,e){return t+e.size.height},0);r.length>1?this._labelSize=new t.core.Size(100,o):this._labelSize=i.measureString(this._ellipslabel)}switch(this.position){case t.Position.Left:case t.Position.Right:this.layoutInfo.rect.width+=this._labelSize.width+e.LabelPadding,this.layoutInfo.rect.height+=this._labelSize.height;break;case t.Position.Top:case t.Position.Bottom:this.layoutInfo.rect.width+=this._labelSize.width,this.layoutInfo.rect.height+=this._labelSize.height+e.LabelPadding}return n.width=this.layoutInfo.rect.width,n.height=this.layoutInfo.rect.height,n},e.prototype.render=function(i,n){var r=this.layoutInfo.rect.clone();t._Util.translateRect(r,i.x,i.y);var o=t._Util.getPoint(r).clone();switch(this.position){case t.Position.Left:break;case t.Position.Right:o.x+=e.LabelPadding;break;case t.Position.Top:break;case t.Position.Bottom:o.y+=e.LabelPadding}this._renderLabel(n,o)},e.prototype._renderLabel=function(e,i){if(i.y+=12,this._labelSize.width>=100){var n=i.x,r=i.y;e.__stringRender._measureMultipleLines(this._ellipslabel,100).forEach(function(i){var o=i.text,a=i.size,s=(a.width,a.height),l=new t.core.Point(n,r);e.drawString(o,l),r+=s})}else{var o=new t.core.Point(i.x,i.y);e.drawString(this._ellipslabel,o)}},e.END="...",e.LabelPadding=10,e}();t._LegendItemLabel=e}(r||(r={})),function(t){var e=function(){function e(e,i){this.layoutInfo=new t._WrapLayoutInfo,this.__legend=e,this.__model=i,this.__label=new t._LegendItemLabel(this,this._model().title),this._selection=new t._SelectionAdorners}return e.prototype._model=function(){return this.__model},Object.defineProperty(e.prototype,"ItemSize",{get:function(){return this.layoutInfo.rect.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orientation",{get:function(){return this.__legend.orientation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"labelPosition",{get:function(){return this.__legend.labelPosition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemPadding",{get:function(){return this.__legend.itemPadding},enumerable:!0,configurable:!0}),e.prototype.distoryItem=function(){this.__legend=null},Object.defineProperty(e.prototype,"area",{get:function(){return this.layoutInfo.rect},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"point",{get:function(){return t._Util.getPoint(this.layoutInfo.rect)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ellipsize",{get:function(){return this.__legend.ellipsize},enumerable:!0,configurable:!0}),e.prototype.onHitted=function(e){return e.contains(this.layoutInfo.rect)?new t.HitInfo(new t.core.Point(e.x,e.y),this.__label.label,null,this,[t.ElementType.LegendItem],this._selection):null},e.prototype.getDesiredSize=function(e){t._Util.resetRect(this.layoutInfo.rect,0,0,0,0),this._lableSize=this.__label.getDesiredSize(e);var i=0;switch(this._symbolSize=new t.core.Size(12,12),this.labelPosition){case t.Position.Left:this._lableSize.height<this._symbolSize.height&&(i=(this._symbolSize.height-this._lableSize.height)/2),this.layoutInfo.rect.width+=this._lableSize.width+this._symbolSize.width,this.layoutInfo.rect.height+=this._symbolSize.height>this._lableSize.height?this._symbolSize.height:this._lableSize.height,t._Util.translateRectY(this.__label.layoutInfo.rect,i);break;case t.Position.Right:this._lableSize.height<this._symbolSize.height&&(i=(this._symbolSize.height-this._lableSize.height)/2),this.layoutInfo.rect.width+=this._lableSize.width+this._symbolSize.width,this.layoutInfo.rect.height+=this._symbolSize.height>this._lableSize.height?this._symbolSize.height:this._lableSize.height,t._Util.translateRect(this.__label.layoutInfo.rect,this._symbolSize.width,i);break;case t.Position.Top:this._lableSize.width<this._symbolSize.width&&(i=(this._symbolSize.width-this._lableSize.width)/2),this.layoutInfo.rect.width+=this._lableSize.width>this._symbolSize.width?this._lableSize.width:this._symbolSize.width,this.layoutInfo.rect.height+=this._symbolSize.height+this._lableSize.height,t._Util.translateRect(this.__label.layoutInfo.rect,i,0);break;case t.Position.Bottom:this._lableSize.width<this._symbolSize.width&&(i=(this._symbolSize.width-this._lableSize.width)/2),this.layoutInfo.rect.width+=this._lableSize.width>this._symbolSize.width?this._lableSize.width:this._symbolSize.width,this.layoutInfo.rect.height+=this._symbolSize.height+this._lableSize.height,t._Util.translateRect(this.__label.layoutInfo.rect,i,this._symbolSize.height)}return this.orientation===t.Orientation.Horizontal?this.layoutInfo.rect.width+=this.itemPadding:this.layoutInfo.rect.height+=this.itemPadding,this._currentSize=new t.core.Size(this.layoutInfo.rect.width,this.layoutInfo.rect.height),this._currentSize},e.prototype.render=function(e){e.startGroup(t.__Constant_Core_Label_ClassName);var i=t._Util.getPoint(this.layoutInfo.rect),n=this.layoutInfo.rect.clone();this.orientation===t.Orientation.Horizontal?(t._Util.translateRectX(n,this.itemPadding/2),i.x+=this.itemPadding/2):(t._Util.translateRectY(n,this.itemPadding/2),i.y+=this.itemPadding/2),this._maxSize&&(i.x+=this._maxSize.width-this._currentSize.width,t._Util.translateRectX(n,this._maxSize.width-this._currentSize.width)),this.__label.render(i,e),this._renderSymbol(e,n),this._selection.rect=n,e.endGroup()},e.prototype._renderSymbol=function(e,i){var n=this._model()._symbol();if(null!=n){n._seriesColor=this._model().seriesColor,n._color=this._model().color||"black",n._style=this._getSymbolStyle();var r=new t.core.Point(i.left,i.top);this.labelPosition===t.Position.Left||this.labelPosition===t.Position.Right?this.labelPosition===t.Position.Left?(r.x+=this._lableSize.width,n.render(e,new t.core.Rect(r.x,r.y,this._symbolSize.width,this._symbolSize.height))):this.labelPosition===t.Position.Right&&n.render(e,new t.core.Rect(r.x,r.y+0,this._symbolSize.width,0+this._symbolSize.height)):(this.labelPosition,t.Position.Top,n.render(e,new t.core.Rect(r.x,r.y,this._symbolSize.width,this._symbolSize.height)))}},e.prototype._getSymbolStyle=function(){var e=this._model().parent.parent.parent._option().style,i=new t.options._DataPointStyleOption(this._model().style);return null==i.stroke&&(i.stroke=e.stroke),null==i.strokeWidth&&(i.strokeWidth=e.strokeWidth),null==i.strokeDasharray&&(i.strokeDasharray=e.strokeDasharray),i},e.COL_ROW_PADDING=10,e.END="...",e}();t._LegendItemView=e}(r||(r={})),function(t){var e=function(){function e(e){this.layoutInfo=new t._WrapLayoutInfo,this._titlelist=[],this._prelineheihgt=0,this._legendView=e}return Object.defineProperty(e.prototype,"label",{get:function(){return this._legendView.title},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._legendView.titlePosition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.layoutInfo.rect},enumerable:!0,configurable:!0}),e.prototype.getDesiredSize=function(i,n,r){if(t._Util.resetRect(this.layoutInfo.rect,0,0,0,0),!this.label)return new t.core.Size(0,0);this._titlelist.length=0;var o=i.measureString(this.label);this._titlelist.push(this.label),this._prelineheihgt=o.height;var a=1;switch(this.position){case t.Position.Left:(o=this._measureMultipleLine(i,this.label,e.TITLE_MAX_SIZE_LEFT_RIGHT,null,!0)).width+=e.TITLE_PADDING_HORIZONTAL,this.layoutInfo.rect.left=r.x,this.layoutInfo.rect.top=r.y+(n.height-o.height)/2;break;case t.Position.Right:(o=this._measureMultipleLine(i,this.label,e.TITLE_MAX_SIZE_LEFT_RIGHT,null,!0)).width+=e.TITLE_PADDING_HORIZONTAL,this.layoutInfo.rect.left=r.x+n.width-o.width,this.layoutInfo.rect.top=r.y+(n.height-o.height)/2,t._Util.translateRectX(this.layoutInfo.rect,e.TITLE_PADDING_HORIZONTAL);break;case t.Position.Top:for(;o.width>=n.width;)a++,o=this._measureMultipleLine(i,this.label,this.label.length/a,null);o.height+=e.TITLE_PADDING_VERTICAL,this.layoutInfo.rect.left=r.x+(n.width-o.width)/2,this.layoutInfo.rect.top=r.y;break;case t.Position.Bottom:for(;o.width>=n.width;)a++,o=this._measureMultipleLine(i,this.label,this.label.length/a,null);o.height+=e.TITLE_PADDING_VERTICAL,this.layoutInfo.rect.left=r.x+(n.width-o.width)/2,this.layoutInfo.rect.top=r.y+n.height-o.height,t._Util.translateRectY(this.layoutInfo.rect,e.TITLE_PADDING_VERTICAL)}return this.layoutInfo.rect.width=o.width,this.layoutInfo.rect.height=o.height,o},e.prototype._measureMultipleLine=function(i,n,r,o,a){this._titlelist.length=0;for(var s=new t.core.Size(0,0),l=0;l<n.length;l+=r){var u=n.substr(l,r);this._titlelist.push(u);var h=i.measureString(u,null,null,o);s.width<h.width&&(s.width=h.width),this._prelineheihgt<h.height&&(this._prelineheihgt=h.height),s.height+=h.height+e.LINE_PADDING}return s},e.prototype.render=function(i,n){t._Util.translateRect(this.layoutInfo.rect,n.x,n.y);for(var r=t._Util.getPoint(this.layoutInfo.rect),o=new t.core.Point(r.x,r.y),a=0;a<this._titlelist.length;++a)o.y+=this._prelineheihgt,this._titlelist[a]&&i.drawString(this._titlelist[a],o),o.y+=e.LINE_PADDING},e.prototype.onHitted=function(e){return e.contains(this.layoutInfo.rect)?new t.HitInfo(new t.core.Point(e.x,e.y),this.label,null,this,[t.ElementType.LegendItem]):null},e.TITLE_PADDING_VERTICAL=5,e.TITLE_PADDING_HORIZONTAL=5,e.TITLE_MAX_SIZE_LEFT_RIGHT=15,e.LINE_PADDING=2,e}();t._LegendTitle=e}(r||(r={})),function(t){var e=function(){return function(e,i){this.rect=e,this.element=i,this.rect||(this.rect=new t.core.Rect(0,0,0,0))}}();t._WrapLayoutInfo=e;var i=function(){return function(t){if(this.leftPadding=this.topPadding=this.rightPadding=this.bottomPadding=0,t){var e=t.trim().split(" ");this.padding=t;for(var i=0;e&&i<e.length&&i<4;++i)if(parseInt(e[i]))switch(i){case 0:this.topPadding=this.rightPadding=this.bottomPadding=this.leftPadding=parseInt(e[i]);break;case 1:this.topPadding=parseInt(e[i]);break;case 2:this.rightPadding=parseInt(e[i]);break;case 3:this.bottomPadding=parseInt(e[i])}}}}(),n=function(e){function n(n){var r=e.call(this)||this;return r.__isRendered=!1,r.__offset=new t.core.Point(0,0),r.ranges={},r.__model=n,r._legendTitle=new t._LegendTitle(r),r._items=[],r._padding=new i("0 0 0 0"),r._children=[],r._selection=new t._SelectionAdorners,r.addLegends(n),r}return s(n,e),n.prototype._model=function(){return this.__model},Object.defineProperty(n.prototype,"orientation",{get:function(){return this._model().orientation},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this._model().position},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"titlePosition",{get:function(){return this._model().titlePosition},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"labelPosition",{get:function(){return this._model().labelPosition},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"title",{get:function(){return this._model().title},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ellipsize",{get:function(){return this._model().ellipsize},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"itemPadding",{get:function(){return this._model().itemPadding},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"wrapping",{get:function(){return this._model().wrapping},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"backgroundColor",{get:function(){return this._model().backgroundColor},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"borderStyle",{get:function(){return this._model().borderStyle},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hidden",{get:function(){return this._model().hidden},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"padding",{get:function(){return this._padding.padding},set:function(t){this._padding=new i(t)},enumerable:!0,configurable:!0}),n.prototype._measureInnerContent=function(e,i){if(this._area=new t.core.Rect(0,0,i.width,i.height),this.hidden)return new t.core.Size(0,0);e.beginTransform(),this._applyStyle(e);var n=new t.core.Size(i.width-this._getMeasuredPaddingWidth(),i.height-this._getMeasuredPaddingHeight()),r=this.getInnerDesiredSize(e,n,new t.core.Point(this.area.left,this.area.top)),o=new t.core.Size(r.width+this._getMeasuredPaddingWidth()+2*e.strokeWidth,r.height+this._getMeasuredPaddingHeight()+2*e.strokeWidth);return o.width>i.width&&(o.width=i.width),o.height>i.height&&(o.height=i.height),e.restoreTransform(),this.__isRendered=!1,o},n.prototype._layoutInnerContent=function(t,e){this.__offset.x=e.left-this._area.left,this.__offset.y=e.top-this._area.top,this._area=e.clone(),this._selection.rect=this._area;for(var i=0,n=this._items;i<n.length;i++){var r=n[i];this._children.push(r)}},n.prototype._renderInnerContent=function(e,i){if(!this.hidden){var n;e.beginTransform(),this._clipId="legendClip"+(1e5*Math.random()).toFixed(),e.addClipRect(i,this._clipId),e.startGroup(t.__Constant_Core_Legend_ClassName,this._clipId),this._applyStyle(e),this.__isRendered?n=new t.core.Point(0,0):(n=new t.core.Point(this.__offset.x+e.strokeWidth,this.__offset.y+e.strokeWidth),this.__isRendered=!0),this._renderTitle(e,n),this._renderItems(e,n),this.__offset.x=0,this.__offset.y=0,e.endGroup(),e.restoreTransform();for(var r=0,o=this._items;r<o.length;r++){var a=o[r];this._children.push(a)}}},n.prototype.onHitted=function(e){if(e.contains(this.area)){for(var i=0,n=this._children;i<n.length;i++){var r=n[i].onHitted(e);if(null!=r)return r.elementType.push(t.ElementType.Legend),r}return new t.HitInfo(new t.core.Point(e.x,e.y),null,null,this,[t.ElementType.Legend],this._selection)}return null},n.prototype._applyStyle=function(e){t._applyStyle(e,this._model().parent.parent._option().legend.style),t._applyStyle(e,this._model().parent.parent._option().legend.textStyle),t._applyStyle(e,this._model().parent._option().legend.style),t._applyStyle(e,this._model().parent._option().legend.textStyle),t._applyStyle(e,this._model()._option().style),t._applyStyle(e,this._model()._option().textStyle)},n.prototype._applyBorderStyle=function(i){e.prototype._applyBorderStyle.call(this,i),t._applyStyle(i,this._model().parent.parent._option().style.borderStyle),t._applyStyle(i,this._model().parent._option().style.borderStyle),t._applyStyle(i,this._model().parent._option().borderStyle),t._applyStyle(i,this.borderStyle)},n.prototype._applyBackgroundStyle=function(i){e.prototype._applyBackgroundStyle.call(this,i),t._applyStyle(i,{fill:this.backgroundColor})},n.prototype.addLegends=function(e){for(var i=0;i<e.items.length;++i){if(e.items[i].size)1/e.items.length*i+1;var n=new t._LegendItemView(this,e.items[i]);this._items.push(n)}},n.prototype.getInnerDesiredSize=function(e,i,n){this._size=new t.core.Size(i.width,i.height);var r=null,o=new t.core.Point(n.x,n.y);e.beginTransform(),t._applyStyle(e,this._model().parent.parent._option().legend.titleStyle),t._applyStyle(e,this._model().parent._option().legend.titleStyle),t._applyStyle(e,this._model()._option().titleStyle);var a=this._legendTitle.getDesiredSize(e,i,n);e.restoreTransform();var s=new t.core.Size(i.width,i.height);switch(this.titlePosition){case t.Position.Left:s.width-=a.width,o.x+=a.width;break;case t.Position.Right:s.width-=a.width;break;case t.Position.Top:s.height-=a.height,o.y+=a.height;break;case t.Position.Bottom:s.height-=a.height}switch(this.orientation){case t.Orientation.Horizontal:r=this._getHorizontalItemsSize(e,s,o);break;case t.Orientation.Vertical:default:r=this._getVerticalItemsSize(e,s,o)}switch(this.titlePosition){case t.Position.Left:r.width+=a.width,r.height<a.height&&(r.height=a.height),t._Util.translateRectY(this._legendTitle.layoutInfo.rect,(r.height-i.height)/2);break;case t.Position.Right:r.width+=a.width,r.height<a.height&&(r.height=a.height),t._Util.translateRectY(this._legendTitle.layoutInfo.rect,(r.height-i.height)/2),t._Util.translateRectX(this._legendTitle.layoutInfo.rect,r.width-i.width);break;case t.Position.Top:r.height+=a.height,r.width<a.width&&(r.width=a.width),t._Util.translateRectX(this._legendTitle.layoutInfo.rect,(r.width-i.width)/2);break;case t.Position.Bottom:r.height+=a.height,r.width<a.width&&(r.width=a.width),t._Util.translateRectY(this._legendTitle.layoutInfo.rect,r.height-i.height),t._Util.translateRectX(this._legendTitle.layoutInfo.rect,(r.width-i.width)/2)}return r},n.prototype._getHorizontalItemsSize=function(e,i,n){var r,o=0,a=new t.core.Size(0,0),s=(new t.core.Size(0,0),null),l=new t.core.Rect(n.x,n.y,i.width,i.height),u=0;for(o=0;o<this._items.length;++o){var h=this._items[o];r=h.getDesiredSize(e),h.layoutInfo.rect.width=r.width,h.layoutInfo.rect.height=r.height,this.wrapping?s?s.layoutInfo.rect.right+r.width>l.right?(t._Util.translateRect(h.layoutInfo.rect,l.left,s.layoutInfo.rect.top+u+t._LegendItemView.COL_ROW_PADDING),u=h.layoutInfo.rect.height):(t._Util.translateRect(h.layoutInfo.rect,s.layoutInfo.rect.right,s.layoutInfo.rect.top),h.layoutInfo.rect.height>u&&(u=h.layoutInfo.rect.height)):(t._Util.translateRect(h.layoutInfo.rect,l.left,l.top),u=h.layoutInfo.rect.height):s?t._Util.translateRect(h.layoutInfo.rect,s.layoutInfo.rect.right,s.layoutInfo.rect.top):t._Util.translateRect(h.layoutInfo.rect,l.left,l.top),a.height<h.layoutInfo.rect.bottom-l.top&&(a.height=h.layoutInfo.rect.bottom-l.top),a.width<h.layoutInfo.rect.right-l.left&&(a.width=h.layoutInfo.rect.right-l.left),s=h}return s=null,a},n.prototype._getVerticalItemsSize=function(e,i,n){var r,o,a=0,s=new t.core.Size(0,0),l=new t.core.Rect(n.x,n.y,i.width,i.height),u=0,h=new t.core.Size;for(a=0;a<this._items.length;++a){var c=this._items[a];r=c.getDesiredSize(e),c.layoutInfo.rect.width=r.width,c.layoutInfo.rect.height=r.height,this.wrapping?o?o.layoutInfo.rect.bottom+r.height>l.bottom?(t._Util.translateRect(c.layoutInfo.rect,o.layoutInfo.rect.left+u+t._LegendItemView.COL_ROW_PADDING,l.top),u=c.layoutInfo.rect.width,h=new t.core.Size):(t._Util.translateRect(c.layoutInfo.rect,o.layoutInfo.rect.left,o.layoutInfo.rect.bottom),c.layoutInfo.rect.width>u&&(u=c.layoutInfo.rect.width)):(t._Util.translateRect(c.layoutInfo.rect,l.left,l.top),u=c.layoutInfo.rect.width):o?t._Util.translateRect(c.layoutInfo.rect,o.layoutInfo.rect.left,o.layoutInfo.rect.bottom):t._Util.translateRect(c.layoutInfo.rect,l.left,l.top),s.height<c.layoutInfo.rect.bottom-l.top&&(s.height=c.layoutInfo.rect.bottom-l.top),s.width<c.layoutInfo.rect.right-l.left&&(s.width=c.layoutInfo.rect.right-l.left),o=c,this.labelPosition===t.Position.Left&&(h.width=u,c._maxSize=h)}return o=null,s},Object.defineProperty(n.prototype,"area",{get:function(){return this._area},enumerable:!0,configurable:!0}),n.prototype._renderTitle=function(e,i){e.beginTransform(),t._applyStyle(e,this._model().parent.parent._option().legend.titleStyle),t._applyStyle(e,this._model().parent._option().legend.titleStyle),t._applyStyle(e,this._model()._option().titleStyle),e.startGroup(t.__Constant_Core_Title_ClassName),this._legendTitle.render(e,i),e.endGroup(),e.restoreTransform()},n.prototype._renderItems=function(e,i){switch(this.orientation){case t.Orientation.Horizontal:this._renderHorizontalItems(e,i);break;case t.Orientation.Vertical:default:this._renderVerticalItems(e,i)}},n.prototype._renderHorizontalItems=function(e,i){for(var n=0;n<this._items.length;++n)t._Util.translateRect(this._items[n].layoutInfo.rect,i.x,i.y),this._items[n].render(e)},n.prototype._renderVerticalItems=function(e,i){for(var n=0;n<this._items.length;++n)t._Util.translateRect(this._items[n].layoutInfo.rect,i.x,i.y),this._items[n].render(e)},n.prototype._getMeasuredPaddingHeight=function(){return this._padding.topPadding+this._padding.bottomPadding},n.prototype._getMeasuredPaddingWidth=function(){return this._padding.leftPadding+this._padding.rightPadding},n}(t._RectangleView);t._LegendView=n}(r||(r={})),function(t){var e=function(){function e(t,e,i){this._x=e,this._y=i,this._action=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"action",{get:function(){return this._action},enumerable:!0,configurable:!0}),e.prototype.contains=function(e){return!(!e||isNaN(e.width)||isNaN(e.height))&&t._Util.contains(e,new t.core.Point(this.x,this.y))},e.prototype._getaction=function(){switch(this.action){case 0:return"ACTION_OUTSIDE";case 1:return"ACTION_UP";case 2:return"ACTION_MOVE";case 3:return"ACTION_CANCEL";case 4:return"ACTION_OUTSIDE";case 5:return"ACTION_MOUSE_DOWN";case 6:return"ACTION_MOUSE_MOVE";case 7:return"ACTION_MOUSE_UP";case 8:return"ACTION_MOUSE_OVER";case 9:return"ACTION_MOUSE_OUT";case 10:return"ACTION_CLICK";case 11:return"ACTION_MOUSE_ENTER";case 12:return"ACTION_MOUSE_LEAVE";case 13:return"ACTION_WHEEL";case 14:return"ACTION_DBCLICK"}},e.prototype.toString=function(){return" x = "+this._x+" , y = "+this._y+" , action = "+this._getaction()},e.ACTION_DOWN=0,e.ACTION_UP=1,e.ACTION_MOVE=2,e.ACTION_CANCEL=3,e.ACTION_OUTSIDE=4,e.ACTION_MOUSE_DOWN=5,e.ACTION_MOUSE_MOVE=6,e.ACTION_MOUSE_UP=7,e.ACTION_MOUSE_OVER=8,e.ACTION_MOUSE_OUT=9,e.ACTION_CLICK=10,e.ACTION_MOUSE_ENTER=11,e.ACTION_MOUSE_LEAVE=12,e.ACTION_WHEEL=13,e.ACTION_DBCLICK=14,e}();t.MotionEvent=e}(r||(r={})),function(t){var e=function(){function e(e,i){this.__option=i,this.__plotArea=e,this._hitTester=new t._HitTester(this),this._children=[]}return Object.defineProperty(e.prototype,"plotArea",{get:function(){return this.__plotArea},set:function(t){this.__plotArea=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._option().name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"legends",{get:function(){return this.dataModel?this.dataModel.legends:[]},enumerable:!0,configurable:!0}),e.prototype._tooltipStyle=function(){var e=this.dataModel,i=null;return this.plotArea.parent._option().style.backgroundColor&&(i=this.plotArea.parent._option().style.backgroundColor),e._option().config.tooltip.style.backgroundColor&&(i=e._option().config.tooltip.style.backgroundColor),{backgroundColor:i,borderStyle:t.core.merge(this.plotArea.parent._option().style.borderStyle,e._option().config.tooltip.style.borderStyle),textStyle:t.core.merge(this.plotArea.parent._option().textStyle,e._option().config.textStyle,e._option().config.tooltip.textStyle)}},e.prototype._rect=function(){return this.__rect},e.prototype._option=function(){return this.__option},e.prototype._globalConfig=function(){return this.plotArea.parent._option()},e.prototype.onHitted=function(e){if(e.contains(this._rect())){for(var i=0,n=this._children;i<n.length;i++){var r=n[i].onHitted(e);if(null!=r)return r.elementType.push(t.ElementType.Plot),r}return new t.HitInfo(new t.core.Point(e.x,e.y),null,null,this,[t.ElementType.Plot],null)}return null},e.prototype._getSelections=function(){for(var t=[],e=0,i=this._children;e<i.length;e++){var n=i[e];n._selected()&&t.push(n._selection)}return t},e.prototype.setHovered=function(e){for(var i=0,n=this._children;i<n.length;i++){var r=n[i];r instanceof t._View&&(r._hovered=e==r,r.refresh())}},e.prototype.setSelected=function(t,e){},e.prototype.Select=function(t,e,i){},Object.defineProperty(e.prototype,"config",{get:function(){return this.__option.config},enumerable:!0,configurable:!0}),e.prototype.measure=function(t,e){},e.prototype._layout=function(t,e){this.__rect=e},e.prototype.render=function(t){},e.prototype.getLabelPoints=function(){return this._hitTester._areas},e.prototype.getLabelPosition=function(e,i,n){for(var r=i.getPoint(),o=new t.core.Size(0,0),a=0,s=n;a<s.length;a++){var l=s[a],u=e.measureString(l);u.width>o.width&&(o.width=u.width),o.height+=u.height}var h=new t._DataLabelPosition;return h.rect=new t.core.Rect(r.x,r.y,o.width,o.height),h},e.prototype.getLineStartPoint=function(t,e){return e},e.prototype._clipId=function(){return null},e}();t._DataGraph=e}(r||(r={})),function(t){!function(t){t[t.CoordinateSystem_None=0]="CoordinateSystem_None",t[t.CoordinateSystem_Xy=1]="CoordinateSystem_Xy",t[t.CoordinateSystem_Radial=2]="CoordinateSystem_Radial",t[t.CoordinateSystemFilter=255]="CoordinateSystemFilter",t[t.Chart_Empty=256]="Chart_Empty",t[t.Chart_Bar=512]="Chart_Bar",t[t.Chart_Area=768]="Chart_Area",t[t.Chart_Line=1024]="Chart_Line",t[t.Chart_Scatter=1280]="Chart_Scatter",t[t.Chart_Treemap=1536]="Chart_Treemap",t[t.ChartFilter=16776960]="ChartFilter"}(t.DataGraphType||(t.DataGraphType={}))}(r||(r={})),function(t){var e=function(e){function i(){var i=null!==e&&e.apply(this,arguments)||this;return i.__minWidthInValues=NaN,i._conn=!1,i._group=t.Group.Cluster,i.__clipid=null,i._fitoffset={left:0,top:0,right:0,bottom:0},i}return s(i,e),Object.defineProperty(i.prototype,"radial",{get:function(){return this._option().config.radial},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"symbols",{get:function(){return this._option().config.symbols},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"swapAxes",{get:function(){return this._option().config.swapAxes},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clippingMode",{get:function(){return this._option().config.clippingMode},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showNulls",{get:function(){return this._option().config.showNulls},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"innerRadius",{get:function(){return this._option().config.innerRadius},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sweep",{get:function(){return this._option().config.sweep},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"startAngle",{get:function(){return this._option().config.startAngle},enumerable:!0,configurable:!0}),i.prototype._minWidthInValues=function(){if(isNaN(this.__minWidthInValues))for(var t=0,e=this.dataModel.dataSeriesList;t<e.length;t++)for(var i=null,n=0,r=e[t].dataPoints;n<r.length;n++){var o=r[n],a=NaN,s=this._getAxisXValue(o.xValue);null==i?s>this.dataModel.xSite.min&&(a=2*(s-this.dataModel.xSite.min)):null!=i&&(a=Math.abs(s-this._getAxisXValue(i.xValue))),!isNaN(a)&&a>0&&(isNaN(this.__minWidthInValues)||this.__minWidthInValues>a)&&(this.__minWidthInValues=a),i=o}return this.__minWidthInValues},i.prototype._getAxisXValue=function(e){return!this.dataModel.xSite.isOrdinal||this.dataModel.xSite.dataType!=t.core.DataType.Date&&this.dataModel.xSite.dataType!=t.core.DataType.Number?e:this.dataModel.xField._values.indexOf(e)},i.prototype._getAxisX=function(){return this.plotArea._getAxisX(this.name)},i.prototype._getAxisY=function(){return this.plotArea._getAxisY(this.name)},i.prototype._clipId=function(){return this.__clipid},i.prototype._cx=function(){return this._rect().left+this._rect().width/2},i.prototype._cy=function(){return this._rect().top+this._rect().height/2},i.prototype.onHitted=function(e){if(e.contains(this._rect()))for(var i=null,n=this._children.length-1;n>=0;--n){if(null!=(i=this._children[n].onHitted(e)))return i.elementType.push(t.ElementType.Plot),i.plot=this,i}return null},i.prototype.Query=function(e){for(var i=[],n=new t._SelectionConditionalFormattingRule(e,function(e,i){try{var n=new t.core.Binding(i),r=n.getValue(e.item);return null==r&&(r=n.getValue(e)),r}catch(t){}return null},function(t,e){var i=t.item;for(var n in i)if(e==n)return!0;return!1},function(t){i.push(t)}),r=0,o=this.dataModel.dataSeriesList;r<o.length;r++)for(var a=0,s=o[r].dataPoints;a<s.length;a++){var l=s[a];n.evaluate(l)}return i},i.prototype.setSelected=function(e,i){for(var n=i,r=0,o=this.dataModel.dataSeriesList;r<o.length;r++){var a=o[r];a._unselect();for(var s=0,l=a.dataPoints;s<l.length;s++){var u=l[s];if(n!=t.SelectionMode.Points&&u._unselect(),null!=e)switch(n){case t.SelectionMode.Color:null!=u.color&&u.color==e.color&&u._select();break;case t.SelectionMode.Size:null!=u.size&&u.size==e.size&&u._select();break;case t.SelectionMode.Shape:null!=u.shape&&u.shape==e.shape&&u._select()}}}if(null!=e&&null!=n&&n!=t.SelectionMode.None){if(n==t.SelectionMode.Point||n==t.SelectionMode.Points)e._select();else if(n==t.SelectionMode.Group&&e.parent&&e.parent instanceof t.models._XySeriesData)for(var h=0,c=e.parent.dataPoints;h<c.length;h++){(u=c[h])._select()}for(var p=0,f=this._children;p<f.length;p++){f[p].refresh()}}},i.prototype._getSelections=function(){for(var t=[],e=0,i=this._children;e<i.length;e++){var n=i[e];n._selected()&&(n._selection.rect=n._rect(),t.push(n._selection))}return t},i.prototype._layoutAxis=function(e,i){var n=this.dataModel,r=this.swapAxes,o=this._getAxisX(),a=this._getAxisY();if(null==o._axisscale()?null!=o.scale&&o.scale.type==t.ValueScaleType.Ordinal?(n.xSite.isOrdinal=!0,o._axisscale(new t.OrdinalScale(n.xSite.valueCount))):null!=o.scale&&o.scale.type==t.ValueScaleType.Logarithmic?o._axisscale(new t.LogScale(o.logBase)):(r?n.ySite.isOrdinal:n.xSite.isOrdinal)?o._axisscale(new t.OrdinalScale(n.xSite.valueCount)):n.xSite.dataType!=t.core.DataType.Date||this.swapAxes?o._axisscale(new t.LinearScale):o._axisscale(new t.TimeScale):null!=o.scale&&o.scale.type==t.ValueScaleType.Ordinal&&(n.xSite.isOrdinal=!0),null==a._axisscale()&&(null!=a.scale&&a.scale.type==t.ValueScaleType.Logarithmic?a._axisscale(new t.LogScale(a.logBase)):(r?n.xSite.isOrdinal:n.ySite.isOrdinal)?a._axisscale(new t.OrdinalScale(n.ySite.valueCount)):n.xSite.dataType==t.core.DataType.Date&&this.swapAxes?a._axisscale(new t.TimeScale):a._axisscale(new t.LinearScale)),this.swapAxes){if(this.radial){var s=this.innerRadius,l=i.width<i.height?i.width/2:i.height/2,u=this.startAngle*Math.PI*2/360,h=(this.sweep+this.startAngle)*Math.PI*2/360;o._axisscale().domain([n.ySite.min,n.ySite.max]).range([u,h]),a._axisscale().domain([n.xSite.min,n.xSite.max]).range([s,l]),o.startAngle=this.startAngle*Math.PI/180,o.sweep=this.sweep*Math.PI/180,o.innerRadius=this.innerRadius,a.startAngle=this.startAngle*Math.PI/180,a.sweep=this.sweep*Math.PI/180,a.innerRadius=this.innerRadius}else o._axisscale().domain([n.ySite.min,n.ySite.max]).range([i.left,i.right]),a._axisscale().domain([n.xSite.min,n.xSite.max]).range([i.bottom,i.top]);null==o.majorGrid&&(o.majorGrid=!0)}else{if(this.radial){s=this.innerRadius,l=i.width<i.height?i.width/2:i.height/2;o._axisscale().domain([n.xSite.min,n.xSite.max]).range([s,l]);u=this.startAngle*Math.PI*2/360,h=(this.sweep+this.startAngle)*Math.PI*2/360;a._axisscale().domain([n.ySite.min,n.ySite.max]).range([u,h]),o.startAngle=this.startAngle*Math.PI/180,o.sweep=this.sweep*Math.PI/180,o.innerRadius=this.innerRadius,a.startAngle=this.startAngle*Math.PI/180,a.sweep=this.sweep*Math.PI/180,a.innerRadius=this.innerRadius}else o._axisscale().domain([n.xSite.min,n.xSite.max]).range([i.left,i.right]),a._axisscale().domain([n.ySite.min,n.ySite.max]).range([i.bottom,i.top]);null==a.majorGrid&&(a.majorGrid=!0)}this.swapAxes?(void 0===a.title&&(a.title=n.xSite?n.xSite.name:null),void 0===o.title&&(n.ySite?o.title=n.ySite.name:o.title=null),this.plotArea._axisLayer().updateAxis(o,n.ySite),this.plotArea._axisLayer().updateAxis(a,n.xSite)):(void 0===o.title&&(o.title=n.xSite?n.xSite.name:null),void 0===a.title&&(null!=n.ySite?a.title=n.ySite.name:a.title=null),this.plotArea._axisLayer().updateAxis(o,n.xSite),this.plotArea._axisLayer().updateAxis(a,n.ySite)),this.clippingMode===t.ClippingMode.Fit&&((this.type&t.DataGraphType.ChartFilter)==t.DataGraphType.Chart_Scatter||(this.type&t.DataGraphType.ChartFilter)==t.DataGraphType.Chart_Line&&this.symbols)&&this.analysisFitInfo(e,i)},i.prototype.measure=function(t,e){this._hitTester.clear(),this._layoutAxis(t,e)},i.prototype.layoutSeries=function(e,i){this._globalConfig().selectedStyle,this._globalConfig().unselectedStyle;for(var n=this.dataModel,r=this._getAxisX(),o=this._getAxisY(),a=0;a<n.dataSeriesList.length;a++)for(var s=n.dataSeriesList[a],l=0;l<s.dataPoints.length;l++){var u=s.dataPoints[l],h=this._getAxisXValue(u.xValue),c=u.size;null==c&&(c=10);var p=NaN,f=NaN;if(this.swapAxes?(f=o.convert(h),u instanceof t.models._XyValuePointData?p=r.convert(u.yValue):u instanceof t.models._XyRangeValuePointData&&(p=r.convert(Math.max(u.yLowerValue,u.yUpperValue)))):(p=r.convert(h),u instanceof t.models._XyValuePointData?f=o.convert(u.yValue):u instanceof t.models._XyRangeValuePointData&&(f=o.convert(Math.max(u.yLowerValue,u.yUpperValue)))),null!=p&&!isNaN(p)&&null!=f&&!isNaN(f)){var _=null;if(u.shape){(d=t.plugins._symbolPlugin(u.shape).create())||(d=t.plugins._symbolPlugin("dot").create()),_=new t._SymbolPointView(u,d)}else{var d=t.plugins._symbolPlugin("dot").create();_=new t._SymbolPointView(u,d)}if(this.radial){var g=Math.cos(f)*p+this._cx(),y=Math.sin(f)*p+this._cy();_._rect(new t.core.Rect(g-c/2,y-c/2,c,c))}else _._rect(new t.core.Rect(p-c/2,f-c/2,c,c));this.symbols?_._visible(t.ViewState.Visible):_._visible(t.ViewState.Invisible),_.refresh(),this._children.push(_),this._hitTester.add(new t._CircleArea(new t.core.Point(p,f),.5*c,u))}}},i.prototype._layout=function(t,i){e.prototype._layout.call(this,t,i),this._children=[],this.layoutSeries(t,i)},i.prototype.render=function(e){var i=this._getAxisX(),n=this._getAxisY();if(this.clippingMode===t.ClippingMode.Clip){this.__clipid="cartesianClip"+(1e5*Math.random()).toFixed();var r=new t.core.Rect(i.rect.left,n.rect.top,i.rect.width,n.rect.height);e.addClipRect(r,this.__clipid),e.startGroup(null,this.__clipid)}if(this.plotArea){null!=this._globalConfig().selectionMode&&this._globalConfig().selectionMode!=t.SelectionMode.None&&t._Util.sort(this._children,function(t,e){return t!=e&&t.isSelected});for(var o=0;o<this._children.length;++o){this._children[o]._render(e)}}this.clippingMode===t.ClippingMode.Clip&&e.endGroup()},i.prototype.analysisFitInfo=function(e,i){for(var n=0,r=0,o=0,a=0,s=this.dataModel,l=this._getAxisX(),u=this._getAxisY(),h=0;h<s.dataSeriesList.length;++h)for(var c=s.dataSeriesList[h],p=0;p<c.dataPoints.length;p++){var f=c.dataPoints[p],_=f.size;if(null!=f){var d=l._axisscale().getScaleValue(this._getAxisXValue(f.xValue))-_,g=d+2*_,y=NaN;f instanceof t.models._XyValuePointData?y=u._axisscale().getScaleValue(f.yValue)-_:f instanceof t.models._XyRangeValuePointData&&(y=u._axisscale().getScaleValue(Math.max(f.yLowerValue,f.yUpperValue))-_);var m=y+2*_;n>d&&(n=d),r<g&&(r=g),o>y&&(o=y),a<m&&(a=m)}}var v=l._axisscale().getScaleValue(s.xSite.min),b=l._axisscale().getScaleValue(s.xSite.max),S=u._axisscale().getScaleValue(s.ySite.max),C=u._axisscale().getScaleValue(s.ySite.min);this._fitoffset={left:v-n,top:S-o,right:r-b,bottom:a-C},l.offset=this._fitoffset,u.offset=this._fitoffset},i.prototype.getLabelPosition=function(t,e,i){return this.radial?this.getLabelPositionRadial(t,e,i):this.getLabelPositionCartesian(t,e,i)},i.prototype.fittingLabels=function(t,e){t.left<e.left&&(t.top=(t.bottom-this._cy())*(e.left-this._cx())/(t.left-this._cx())+this._cy()+t.height,t.left=e.left),t.right>e.right&&(t.top=(t.bottom-this._cy())*(e.right-this._cx())/(t.right-this._cx())+this._cy()+t.height,t.left=e.right-t.width),t.top-t.height<e.top&&(t.left=(t.left-this._cx())*(e.top-this._cy())/(t.top-this._cy())+this._cx(),t.top=e.top+t.height),t.bottom>e.bottom&&(t.left=(t.left-this._cx())*(e.bottom-this._cy())/(t.bottom-this._cy())+this._cx(),t.top=e.bottom)},i.prototype.getLabelPositionRadial=function(e,i,n){for(var r=i,o=i.item,a=this._getAxisX(),s=this._getAxisY(),l=new t.core.Size(0,0),u=0,h=n;u<h.length;u++){var c=h[u],p=e.measureString(c);p.width>l.width&&(l.width=p.width),l.height+=p.height}var f,_=new t._DataLabelPosition,d=t.core.asEnum(this.dataModel._option().config.text.position,t.TextPosition),g=this.dataModel._option().config.text.style&&this.dataModel._option().config.text.style.strokeWidth?this.dataModel._option().config.text.style.strokeWidth:2,y=(this._hitTester._areas,this._rect().width<this._rect().height?this._rect().width/2:this._rect().height/2),m=this.dataModel._option().config.text.offset,v=this.dataModel._option().config.text.connectingLine,b=this._cx(),S=this._cy(),C=0,x=0,T=0,w=0;this.swapAxes?(T=s._axisscale().getScaleValue(this._getAxisXValue(o.xValue)),o instanceof t.models._XyValuePointData?w=a._axisscale().getScaleValue(o.yValue):o instanceof t.models._XyRangeValuePointData&&(w=a._axisscale().getScaleValue(o.yUpperValue))):(w=a._axisscale().getScaleValue(this._getAxisXValue(o.xValue)),o instanceof t.models._XyValuePointData?T=s._axisscale().getScaleValue(o.yValue):o instanceof t.models._XyRangeValuePointData&&(T=s._axisscale().getScaleValue(o.yUpperValue))),f=w,(d===t.TextPosition.Outside||d===t.TextPosition.Auto)&&m>=0&&v&&(w=y),d===t.TextPosition.Center&&(w+=r.radius),w+=m,C=b+Math.cos(T)*w,x=S+Math.sin(T)*w,_.rect=new t.core.Rect(C,x,l.width,l.height),_.pt1=new t.core.Point(b+Math.cos(T)*f,S+Math.sin(T)*f),_.pt1=this.getLineStartPoint(i,_.pt1),(d=t.core.asEnum(this.dataModel._option().config.text.position,t.TextPosition))===t.TextPosition.Outside?(_.rect.top>this._cy()?(_.rect.top+=_.rect.height,_.rect.top+=_.rect.height/2):_.rect.top-=_.rect.height/2,_.rect.left>this._cx()?(_.rect.left-=_.rect.width/2,_.rect.left+=_.rect.height/2):(_.rect.left+=_.rect.width/2,_.rect.left-=_.rect.width,_.rect.left-=_.rect.height/2)):d===t.TextPosition.Inside?(_.rect.top>this._cy()?(_.rect.top+=_.rect.height,_.rect.top-=_.rect.height/2):_.rect.top+=_.rect.height/2,_.rect.left>this._cx()?(_.rect.left-=_.rect.width/2,_.rect.left-=_.rect.height/2):(_.rect.left+=_.rect.width/2,_.rect.left-=_.rect.width,_.rect.left+=_.rect.height/2)):d===t.TextPosition.Center&&(C=b+Math.cos(T)*w,x=S+Math.sin(T)*w,C-=l.width/2,x+=l.height/2,_.rect=new t.core.Rect(C,x,l.width,l.height));var P=this.plotArea._rectangle();return this.fittingLabels(_.rect,new t.core.Rect(P.left+g,P.top+g,P.width-2*g,P.height-2*g)),_.pt2=new t.core.Point(_.rect.left+_.rect.width/2,_.rect.bottom),this.dataModel._option().config.text.style.strokeWidth?_.pt2.x=_.rect.left+_.rect.width/2:_.rect.left+_.rect.width/2<this._cx()?_.pt2.x=_.rect.right:_.rect.left+_.rect.width/2>=this._cx()&&(_.pt2.x=_.rect.left),_.rect.top+_.rect.height/2<this._cy()?_.pt2.y=_.rect.bottom+g:_.rect.top+_.rect.height/2>=this._cy()&&(_.pt2.y=_.rect.top-g),_.pt2.y-=_.rect.height,_},i.prototype.getLabelPositionCartesian=function(e,i,n){if(!(i instanceof t._CircleArea))return null;var r=this.dataModel._option().config.text.style.stroke&&this.dataModel._option().config.text.style.strokeWidth?this.dataModel._option().config.text.style.strokeWidth:2,o=i.radius,a=i.item,s=this._getAxisX(),l=this._getAxisY(),u=0,h=0;this.swapAxes?(h=l._axisscale().getScaleValue(this._getAxisXValue(a.xValue)),a instanceof t.models._XyValuePointData?u=s._axisscale().getScaleValue(a.yValue):a instanceof t.models._XyRangeValuePointData&&(u=s._axisscale().getScaleValue(a.yUpperValue))):(u=s._axisscale().getScaleValue(this._getAxisXValue(a.xValue)),a instanceof t.models._XyValuePointData?h=l._axisscale().getScaleValue(a.yValue):a instanceof t.models._XyRangeValuePointData&&(h=l._axisscale().getScaleValue(a.yUpperValue))),this.swapAxes?u+=o:h-=o;for(var c=new t.core.Size(0,0),p=0,f=n;p<f.length;p++){var _=f[p],d=e.measureString(_);d.width>c.width&&(c.width=d.width),c.height+=d.height}var g=new t.core.Rect(u,h,c.width,c.height),y=0,m=0,v=this.dataModel._option().config.text.offset,b=new t._DataLabelPosition;b.pt1=new t.core.Point(u,h),b.pt2=new t.core.Point(u,h);var S=t.core.asEnum(this.dataModel._option().config.text.position,t.TextPosition);S==t.TextPosition.Auto&&(S=t.TextPosition.Outside);var C=i.getPoint();switch(S){case t.TextPosition.Outside:this.swapAxes?(g.top=C.y,y+=v+r,m+=.5*c.height,b.pt2.x+=v+r,b.pt1.y=b.pt2.y=C.y):(g.left=C.x,y-=.5*c.width,m-=0+(v+r),b.pt1.x=b.pt2.x=C.x,b.pt2.y-=v+r);break;case t.TextPosition.Inside:this.swapAxes?(g.top=C.y,y-=c.width+v,m+=.5*c.height,b.pt2.x-=v,b.pt1.y=g.top,b.pt2.y=g.top):(g.left=C.x,y-=.5*c.width,m+=c.height+v,b.pt1.x=b.pt2.x=C.x,b.pt2.y+=v);break;case t.TextPosition.Center:g.left=C.x,g.top=C.y,y-=.5*c.width,m+=.5*c.height}g.left+=y,g.top+=m,b.rect=g;var x=this.plotArea._rectangle();return S===t.TextPosition.Outside?this.swapAxes?g.right+2+1>x.right&&(g.left=x.right-2-g.width-1,b.pt2.x=g.left-2):g.top-2-g.height<x.top&&(g.top=x.top+2+g.height,b.pt2.y=g.top+2):S===t.TextPosition.Inside&&(this.swapAxes?g.left-2-1<x.left&&(g.left=x.left+2+1,b.pt2.x=g.right-2):g.bottom+2>x.bottom&&(g.top=x.bottom+2-g.height,b.pt2.y=g.top-2)),b.pt1=this.getLineStartPoint(i,b.pt1),b},i.prototype.getLineStartPoint=function(e,i){if(this.dataModel._option().config.text.linePosition){if(this.dataModel._option().config.text.linePosition===t.LinePosition.Center)return i;var n=e,r=(n.center,n.radius);return i.y-=r,i}return i},i}(t._DataGraph);t._CartesianGraph=e}(r||(r={})),function(t){var e=function(e){function n(t,i){return e.call(this,t,i)||this}return s(n,e),Object.defineProperty(n.prototype,"type",{get:function(){return t.DataGraphType.CoordinateSystem_Xy|t.DataGraphType.Chart_Area},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dataModel",{get:function(){return this.__dataModel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"symbols",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineAspect",{get:function(){return this._option().config.lineAspect},enumerable:!0,configurable:!0}),n.prototype.bindData=function(e){this.__dataModel=this._createDataModel(e);var i=this._getAxisY();null!=i.scale&&i.scale.type==t.ValueScaleType.Percentage&&this.__dataModel._percentage()},n.prototype._createDataModel=function(t){return new i(this,t,this._option())},n.prototype.setSelected=function(i,n){if(null==i)e.prototype.setSelected.call(this,null,n);else if(i instanceof t.models._XyPointData)e.prototype.setSelected.call(this,i,n);else if(i instanceof t.models._XySeriesData){for(var r=0,o=this.dataModel.dataSeriesList;r<o.length;r++){var a=o[r];if(n!=t.SelectionMode.Points){a._unselect();for(var s=0,l=a.dataPoints;s<l.length;s++){l[s]._unselect()}}}if(n==t.SelectionMode.Points||n==t.SelectionMode.Group||n==t.SelectionMode.Point){i._select();for(var u=0,h=i.dataPoints;u<h.length;u++){h[u]._select()}}}},n.prototype.layoutSeries=function(i,n){if(!(null==this.dataModel.dataSeriesList||this.dataModel.dataSeriesList.length<=0)){for(var r=0,o=this.dataModel.dataSeriesList;r<o.length;r++){var a=o[r];if(null!=a&&a.dataPoints.length>0){var s=this.createPolygon(a),l=new t._AreaSeriesView(a,s.xs,s.ys);l._rect(this._rect().clone()),l.refresh(),this._children.push(l)}}e.prototype.layoutSeries.call(this,i,n)}},n.prototype.createPolygon=function(e){if(null==e.dataPoints||e.dataPoints.length<=0)return null;for(var i=this._getAxisX(),n=this._getAxisY(),r={xs:[],ys:[]},o={xs:[],ys:[]},a=0,s=e.dataPoints;a<s.length;a++){var l=s[a],u=this._getAxisXValue(l.xValue);null!=u&&(l instanceof t.models._XyValuePointData?(null!=l.yValue&&(r.xs.push(u),r.ys.push(l.yValue)),o.xs.push(u),o.ys.push(isNaN(l.yPreviousValue)?Math.max(n.actualMin,0):l.yPreviousValue)):l instanceof t.models._XyRangeValuePointData&&null!=l.yUpperValue&&null!=l.yLowerValue&&(r.xs.push(u),r.ys.push(l.yUpperValue),o.xs.push(u),o.ys.push(l.yLowerValue)))}r=this._convertByLineAspect(r),o=this._convertByLineAspect(o),this.lineAspect==t.LineAspect.Spline&&(r=this._convertBySpline(r),o=this._convertBySpline(o));var h={xs:[],ys:[]};if(this.swapAxes){for(var c=0,p=r.xs;c<p.length;c++){var f=p[c];h.ys.push(n.convert(f))}for(var _=0,d=r.ys;_<d.length;_++){var g=d[_];h.xs.push(i.convert(g))}for(var y=0,m=o.xs.reverse();y<m.length;y++){f=m[y];h.ys.push(n.convert(f))}for(var v=0,b=o.ys.reverse();v<b.length;v++){g=b[v];h.xs.push(i.convert(g))}if(this.radial)for(var S=0;h.xs.length==h.ys.length&&S<h.xs.length;++S){f=h.ys[S],g=h.xs[S];var C=Math.cos(f)*g+this._cx(),x=Math.sin(f)*g+this._cy();h.xs[S]=C,h.ys[S]=x}}else{for(var T=0,w=r.xs;T<w.length;T++){f=w[T];h.xs.push(i.convert(f))}for(var P=0,A=r.ys;P<A.length;P++){g=A[P];h.ys.push(n.convert(g))}for(var F=0,O=o.xs.reverse();F<O.length;F++){f=O[F];h.xs.push(i.convert(f))}for(var M=0,D=o.ys.reverse();M<D.length;M++){g=D[M];h.ys.push(n.convert(g))}if(this.radial)for(S=0;h.xs.length==h.ys.length&&S<h.xs.length;++S){f=h.xs[S],g=h.ys[S],C=Math.cos(g)*f+this._cx(),x=Math.sin(g)*f+this._cy();h.xs[S]=C,h.ys[S]=x}}return h},n.prototype._convertByLineAspect=function(e){for(var i=[],n=0;n<Math.min(e.xs.length,e.ys.length);n++)i.push(new t.core.Point(e.xs[n],e.ys[n]));i=new t._LineAspectConverter(!1,this.lineAspect).convert(i);var r={xs:[],ys:[]};for(n=0;n<i.length;n++)r.xs.push(i[n].x),r.ys.push(i[n].y);return r},n.prototype._convertBySpline=function(e){var i=new t._Spline(e.xs,e.ys).calculate();return{xs:i.xs,ys:i.ys}},n}(t._CartesianGraph);t._AreaGraph=e;var i=function(e){function i(t,i,n){return e.call(this,t,i,n)||this}return s(i,e),i.prototype._legendSymbol=function(){return new r},i.prototype._createXSite=function(t,i){return void 0===i&&(i=0),null!=this.categoryFields&&this.categoryFields.length>0?e.prototype._createXSite.call(this,t,i):null!=this.xField?new n(this.xField,i):e.prototype._createXSite.call(this,t,i)},i.prototype._createDataSeries=function(e,i,n,r){return i instanceof t.data._SingleAggregateValueDefinition?new t.models._XyValueSeriesData(this,e,i,n,r):i instanceof t.data._SingleValueDefinition?new t.models._XyValueSeriesData(this,e,i,n,r):i instanceof t.data._NumberRangeValueDefinition?new t.models._XyRangeValueSeriesData(this,e,i,n,r):i instanceof t.data._DateRangeValueDefinition?new t.models._XyRangeValueSeriesData(this,e,i,n,r):null},i}(t.models._XyAggregationPlotData),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.padding=function(e){if(void 0===e)return this.isOrdinal?0:t.prototype.padding.call(this);t.prototype.padding.call(this,e)},e}(t.models._XSiteModel),r=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.prototype.render=function(e,i){var n=i.width<i.height?i.width:i.height;e.drawRect((i.right+i.left)/2-n/2,i.top,n,n,null,t.core.merge({fill:this._color,strokeWidth:0},this._style))},i}(t.models._LegendSymbol)}(r||(r={})),function(t){var e=function(e){function r(t,i){var n=e.call(this,t,i)||this;return n.__barIndexInCluster=0,n}return s(r,e),Object.defineProperty(r.prototype,"type",{get:function(){return t.DataGraphType.CoordinateSystem_Xy|t.DataGraphType.Chart_Bar},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataModel",{get:function(){return this.__dataModel},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"symbols",{get:function(){return!1},enumerable:!0,configurable:!0}),r.prototype._offset=function(){return this._option().config.offset},r.prototype._barLines=function(){return this._option().config.barLines},r.prototype._barWidth=function(){var t=this._globalConfig().bar.width;return null==t?.7:(t>1&&(t=1),t<0&&(t=0),t)},r.prototype._barOverlap=function(){var t=this._globalConfig().bar.overlap;return null==t?0:(t>1&&(t=1),t<-1&&(t=-1),t)},r.prototype._clusterCount=function(){for(var e=0,i=0,n=this.dataModel.dataSeriesList;i<n.length;i++){n[i]._group==t.Group.Cluster&&e++}return e},r.prototype.bindData=function(e){this.__dataModel=this._createDataModel(e),this.__dataModel.dataSeriesList[0];var i=this._getAxisY();if(null!=i.scale&&i.scale.type==t.ValueScaleType.Percentage){this.__dataModel._percentage();var n=this.__dataModel.ySite;null!=n&&n instanceof t.models._YSiteModel&&n.min>0&&(n.__min=0)}},r.prototype._resetClusterCount=function(t){return this.__barIndexInCluster=t,t+this._clusterCount()},r.prototype.getwidth=function(t){if(null!=t&&t._resetClusterCount(),null==this.dataModel.dataSeriesList||this.dataModel.dataSeriesList.length<=0)return{width:0,radialwidth:0};var e=this._minWidthInValues()*this._barWidth()/t._clusterCount(),i=this._minWidthInValues()/t._clusterCount();return this._barOverlap()>0?(e+=e*(t._clusterCount()-1)*this._barOverlap(),i+=i*(t._clusterCount()-1)*this._barOverlap()):this._barOverlap()<0&&(e+=e*this._barOverlap()*.5,i+=i*this._barOverlap()*.5),{width:e,radialwidth:i}},r.prototype._createDataModel=function(t){return new n(this,t,this._option())},r.prototype.measure=function(t,n){e.prototype.measure.call(this,t,n);var r=i._barExtension(this.plotArea),o=this.getwidth(r),a=o.width,s=o.radialwidth;if(this.radial&&!this.swapAxes){var l=this._getAxisX();l._radiusOffset&&l._radiusOffset((a-s)/2)}},r.prototype.layoutSeries=function(e,n){this._children.length=0;for(var r=i._barExtension(this.plotArea),o=this.getwidth(r),a=o.width,s=o.radialwidth,l=this.__barIndexInCluster-1,u=0,h=this.dataModel.dataSeriesList;u<h.length;u++){var c,p=h[u],f=NaN,_=NaN;if(null!=this._globalConfig().bar.neckHeight&&this._globalConfig().bar.neckHeight<=1&&this._globalConfig().bar.neckHeight>=0&&(f=this._globalConfig().bar.neckHeight*(this.dataModel.ySite.max-(this.dataModel.ySite.min<0?p.ySite.min:0))),null!=this._globalConfig().bar.bottomWidth&&this._globalConfig().bar.bottomWidth<=1&&this._globalConfig().bar.bottomWidth>=0&&(_=this._barWidth()<=0?this._globalConfig().bar.bottomWidth:this._globalConfig().bar.bottomWidth*a/this._barWidth()),!isNaN(_))if(this.config.swapAxes&&this.dataModel.xSite.isOrdinal)_=_*((c=this._getAxisY()._axisscale()).endPosition-c.startPosition)/(c.max-c.min);else _=_*((c=this._getAxisX()._axisscale()).endPosition-c.startPosition)/(c.max-c.min);p._group==t.Group.Cluster&&l++;var d=0;if(r._clusterCount()>1){var g=(this._minWidthInValues()*this._barWidth()-a*r._clusterCount())/(r._clusterCount()-1);d=.5*(a-this._minWidthInValues()*this._barWidth())+(a+g)*l}if(null!=p&&p.dataPoints.length>0)for(var y=0,m=p.dataPoints;y<m.length;y++){var v=m[y],b=this._getAxisXValue(v.xValue),S=isNaN(this._offset())?0:this._offset();if(S=isNaN(v.offset)?S:v.offset,this.radial){var C=this.createRect(v,b+d-.5*s,b+d+.5*(a-(s-a)),!0);if(null!=C){var x=this._cx()+S*Math.cos(C.startAngle+C.sweep/2)*(C.radius-C.innerRadius),T=this._cy()+S*Math.sin(C.startAngle+C.sweep/2)*(C.radius-C.innerRadius);(D=new t._RadialBarPointView(v,new t.core.Point(x,T),C.radius,C.innerRadius,C.startAngle,C.sweep)).refresh(),this._children.push(D),this._hitTester.add(new t.DonutArea(new t.core.Point(this._cx(),this._cy()),D._radius(),D._innerRadius(),D._startAngle(),D._sweep(),v))}}else if(isNaN(_)){var w=this.createRect(v,b+d-.5*a,b+d+.5*a);if(null!=w)(D=new t._BarPointView(v))._rect(new t.core.Rect(w.left,w.top,w.width,w.height)),this.swapAxes?t._Util.translateRectY(D._rect(),S*D._rect().height):t._Util.translateRectX(D._rect(),S*D._rect().width),D.refresh(),this._children.push(D),this._hitTester.add(new t._RectArea(D._rect(),v))}else{for(var P=[],A=[],F=0,O=this.createFunnel(v,b+d-.5*a,b+d+.5*a,f,_);F<O.length;F++){var M=O[F];P.push(M.x),A.push(M.y)}var D;(D=new t._FunnelPointView(v,P,A)).refresh(),this._children.push(D);var L=new t._RectArea(new t.core.Rect(Math.min.apply(this,P),Math.min.apply(this,A),Math.max.apply(this,P)-Math.min.apply(this,P),Math.max.apply(this,A)-Math.min.apply(this,A)),v);this._hitTester.add(L)}}if(this._barLines())for(var I=0;I<this._children.length+1;++I){var k=this._children[I],R=this._children[I+1];if(k instanceof t._BarPointView&&R instanceof t._BarPointView){var N=new t._BarLineViewModel(new t.core.Point(k._rect().right,k._rect().top),new t.core.Point(R._rect().left,R._rect().top));this._children.push(N)}else if(k instanceof t._RadialBarPointView&&R instanceof t._RadialBarPointView){var E=Math.cos(k._startAngle()+k._sweep())*k._radius()+k._center().x,G=Math.sin(k._startAngle()+k._sweep())*k._radius()+k._center().y,V=Math.cos(R._startAngle()+R._sweep())*R._innerRadius()+R._center().x,j=Math.sin(R._startAngle()+R._sweep())*R._innerRadius()+R._center().y;N=new t._BarLineViewModel(new t.core.Point(E,G),new t.core.Point(V,j));this._children.push(N)}}this.radial&&this._hitTester._areas.sort(function(t,e){return t.sweep-e.sweep})}},r.prototype.createFunnel=function(e,i,n,r,o){var a=this._getAxisX(),s=this._getAxisY(),l=NaN,u=NaN,h=NaN,c=NaN;if(this.swapAxes){l=s._axisscale().getScaleValue(i),u=s._axisscale().getScaleValue(n),Math.abs(l-u)<1&&(u=l+1),e instanceof t.models._XyValuePointData?(h=isNaN(e.yPreviousValue)?a._axisscale().getScaleValue(0):a._axisscale().getScaleValue(e.yPreviousValue),c=a._axisscale().getScaleValue(e.yValue)):e instanceof t.models._XyRangeValuePointData&&(h=a._axisscale().getScaleValue(e.yLowerValue),c=a._axisscale().getScaleValue(e.yUpperValue));var p=a._axisscale().getScaleValue(r),f=Math.abs(c-h),_=u-l,d=l,g=u,y=l,m=u,v=[];if(p>Math.max(h,c))y=l+=(_-o)/2,m=u-=(_-o)/2,v.push(new t.core.Point(h,l)),v.push(new t.core.Point(c,y)),v.push(new t.core.Point(c,m)),v.push(new t.core.Point(h,u));else if(p<Math.min(h,c)){var b=(h-(S=a._axisscale().getScaleValue(this.dataModel.ySite.max)))/(p-S)*(_-o)/2;l=(x=l)+b,u=(T=u)-b,y=x+(C=(c-S)/(p-S)*(_-o)/2),m=T-C,v.push(new t.core.Point(h,u)),v.push(new t.core.Point(c,m)),v.push(new t.core.Point(c,y)),v.push(new t.core.Point(h,l))}else{var S,C,x,T;y=(x=l)+(C=(c-(S=a._axisscale().getScaleValue(this.dataModel.ySite.max)))/(p-S)*(_-o)/2),m=(T=u)-C,l=d=x+(_-o)/2,u=g=T-(_-o)/2,v.push(new t.core.Point(h,u)),v.push(new t.core.Point(p,g)),v.push(new t.core.Point(c,m)),v.push(new t.core.Point(c,y)),v.push(new t.core.Point(p,d)),v.push(new t.core.Point(h,l))}return v}h=a._axisscale().getScaleValue(i),c=a._axisscale().getScaleValue(n),Math.abs(h-c)<1&&(c=h+1),e instanceof t.models._XyValuePointData?(l=isNaN(e.yPreviousValue)?s._axisscale().getScaleValue(0):s._axisscale().getScaleValue(e.yPreviousValue),u=s._axisscale().getScaleValue(e.yValue)):e instanceof t.models._XyRangeValuePointData&&(l=s._axisscale().getScaleValue(e.yLowerValue),u=s._axisscale().getScaleValue(e.yUpperValue));p=s._axisscale().getScaleValue(r),_=Math.abs(u-l),f=c-h;var w=h,P=c,A=h,F=c;v=[];if(p<Math.min(l,u))A=h+=(f-o)/2,F=c-=(f-o)/2,v.push(new t.core.Point(A,l)),v.push(new t.core.Point(F,l)),v.push(new t.core.Point(c,u)),v.push(new t.core.Point(h,u));else if(p>Math.max(l,u)){var O=(l-(D=s._axisscale().getScaleValue(this.dataModel.ySite.max)))/(p-D)*(f-o)/2,M=(u-D)/(p-D)*(f-o)/2;isNaN(O)&&(O=0),isNaN(M)&&(M=0),h=(L=h)+M,c=(I=c)-M,A=L+O,F=I-O,v.push(new t.core.Point(h,u)),v.push(new t.core.Point(A,l)),v.push(new t.core.Point(F,l)),v.push(new t.core.Point(c,u)),v.push(new t.core.Point(h,u))}else{var D,L=h,I=c;M=(u-(D=s._axisscale().getScaleValue(this.dataModel.ySite.max)))/(p-D)*(f-o)/2;isNaN(M)&&(M=0),h=L+M,c=I-M,A=w=L+(f-o)/2,F=P=I-(f-o)/2,v.push(new t.core.Point(h,u)),v.push(new t.core.Point(w,p)),v.push(new t.core.Point(A,l)),v.push(new t.core.Point(F,l)),v.push(new t.core.Point(P,p)),v.push(new t.core.Point(c,u)),v.push(new t.core.Point(h,u))}return v},r.prototype.createRect=function(e,i,n,r){void 0===r&&(r=!1);var o=this._getAxisX(),a=this._getAxisY(),s=NaN,l=NaN;return this.swapAxes?(s=a._axisscale().getScaleValue(i),l=a._axisscale().getScaleValue(n),i=NaN,n=NaN,e instanceof t.models._XyValuePointData?(i=isNaN(e.yPreviousValue)?o._axisscale().getScaleValue(o._axisscale().min<0?0:o._axisscale().min):o._axisscale().getScaleValue(e.yPreviousValue),n=o._axisscale().getScaleValue(e.yValue)):e instanceof t.models._XyRangeValuePointData&&(i=o._axisscale().getScaleValue(e.yLowerValue),n=o._axisscale().getScaleValue(e.yUpperValue))):(i=o._axisscale().getScaleValue(i),n=o._axisscale().getScaleValue(n),Math.abs(i-n)<1&&(n=i+1),e instanceof t.models._XyValuePointData?(s=isNaN(e.yPreviousValue)?a._axisscale().getScaleValue(a._axisscale().min<0?0:a._axisscale().min):a._axisscale().getScaleValue(e.yPreviousValue),l=a._axisscale().getScaleValue(e.yValue)):e instanceof t.models._XyRangeValuePointData&&(s=a._axisscale().getScaleValue(e.yLowerValue),l=a._axisscale().getScaleValue(e.yUpperValue))),null==i||null==n||null==s||null==l||isNaN(i)||isNaN(n)||isNaN(s)||isNaN(l)?null:r?{innerRadius:Math.min(i,n),startAngle:Math.min(s,l),radius:Math.min(i,n)+Math.abs(n-i),sweep:Math.abs(l-s)}:{left:Math.min(i,n),top:Math.min(s,l),width:Math.abs(n-i),height:Math.abs(l-s)}},r.prototype.getLineStartPoint=function(e,i){if(this._option().config.text.linePosition){if(this._option().config.text.linePosition==t.LinePosition.Center){if(this.radial){var n=(o=e).angle+o.sweep/2,r=o.radius+o.innerRadius;return i=new t.core.Point(o.center.x+Math.cos(n)*r/2,o.center.y+Math.sin(n)*r/2)}var o,a=(o=e).rect;return i.x=a.left+a.width/2,i.y=a.top+a.height/2,i}return i}return i},r.prototype.getLabelPosition=function(t,e,i){return this.radial?this.getLabelPositionRadial(t,e,i):this.getLabelPositionCartesian(t,e,i)},r.prototype.getLabelPositionRadial=function(e,i,n){for(var r=i,o=(this._getAxisX(),this._getAxisY(),new t.core.Size(0,0)),a=0,s=n;a<s.length;a++){var l=s[a],u=e.measureString(l);u.width>o.width&&(o.width=u.width),o.height+=u.height}var h=new t._DataLabelPosition,c=this._option().config.text.position,p=2;null!=this._option().config.text.style.strokeWidth&&(p=this._option().config.text.style.strokeWidth);this._hitTester._areas;var f=this._rect().width<this._rect().height?this._rect().width/2:this._rect().height/2,_=0;this.config&&this.config.text&&this.config.text.offset&&(_=this.config.text.offset);var d=null;this.config&&this.config.text&&this.config.text.connectingLine&&(d=this.config.text.connectingLine);var g=this._cx(),y=this._cy(),m=0,v=0,b=r.angle+r.sweep/2,S=r.radius;(c===t.TextPosition.Outside||c===t.TextPosition.Auto)&&_>=0&&d&&(S=f),c===t.TextPosition.Center&&(S=(r.innerRadius+r.radius)/2),S+=_,m=g+Math.cos(b)*S,v=y+Math.sin(b)*S,h.rect=new t.core.Rect(m,v,o.width,o.height),h.pt1=new t.core.Point(g+Math.cos(b)*r.radius,y+Math.sin(b)*r.radius),h.pt1=this.getLineStartPoint(i,h.pt1),c===t.TextPosition.Outside?(h.rect.top>this._cy()?(h.rect.top+=h.rect.height,h.rect.top+=h.rect.height/2):h.rect.top-=h.rect.height/2,h.rect.left>this._cx()?(h.rect.left-=h.rect.width/2,h.rect.left+=h.rect.height/2):(h.rect.left+=h.rect.width/2,h.rect.left-=h.rect.width,h.rect.left-=h.rect.height/2)):c===t.TextPosition.Inside?(h.rect.top>this._cy()?(h.rect.top+=h.rect.height,h.rect.top-=h.rect.height/2):h.rect.top+=h.rect.height/2,h.rect.left>this._cx()?(h.rect.left-=h.rect.width/2,h.rect.left-=h.rect.height/2):(h.rect.left+=h.rect.width/2,h.rect.left-=h.rect.width,h.rect.left+=h.rect.height/2)):c===t.TextPosition.Center&&(m=g+Math.cos(b)*S,v=y+Math.sin(b)*S,m-=o.width/2,v+=o.height/2,h.rect=new t.core.Rect(m,v,o.width,o.height));var C=this.plotArea._rectangle();if(this.fittingLabels(h.rect,new t.core.Rect(C.left+p,C.top+p,C.width-2*p,C.height-2*p)),h.pt2=new t.core.Point(h.rect.left+h.rect.width/2,h.rect.bottom),this.config&&this.config.text&&this.config.text.style.stroke?h.pt2.x=h.rect.left+h.rect.width/2:h.rect.left+h.rect.width/2<this._cx()?h.pt2.x=h.rect.right:h.rect.left+h.rect.width/2>=this._cx()&&(h.pt2.x=h.rect.left),h.rect.top+h.rect.height/2<this._cy()?h.pt2.y=h.rect.bottom+p:h.rect.top+h.rect.height/2>=this._cy()&&(h.pt2.y=h.rect.top-p),h.pt2.y-=h.rect.height,c===t.TextPosition.Center){var x=h.rect.left+h.rect.width/2,T=h.rect.top+h.rect.height/2;if(Math.sqrt((x-this._cx())*(x-this._cx())+(T-this._cy())*(T-this._cy()))<r.radius){var w=h.rect.clone();w.left-=p,w.top-=p+w.height,w.width+=2*p,w.height+=2*p;for(var P=NaN,A=0,F=[new t.core.Point(w.left,w.top),new t.core.Point(w.left,w.bottom),new t.core.Point(w.right,w.top),new t.core.Point(w.right,w.bottom)];A<F.length;A++){var O=F[A];isNaN(P)?(P=(O.x-this._cx())*(O.x-this._cx())+(O.y-this._cy())*(O.y-this._cy()),h.pt2=O.clone()):(O.x-this._cx())*(O.x-this._cx())+(O.y-this._cy())*(O.y-this._cy())>P&&(h.pt2=O.clone(),P=(O.x-this._cx())*(O.x-this._cx())+(O.y-this._cy())*(O.y-this._cy()))}}}return h},r.prototype.getLabelPositionCartesian=function(e,i,n){var r=i.item,o=this._getAxisX(),a=this._getAxisY(),s=!1,l=0,u=0;this.swapAxes?(u=a._axisscale().getScaleValue(this._getAxisXValue(r.xValue)),r instanceof t.models._XyValuePointData?(r.yValue<0&&(s=!0),l=o._axisscale().getScaleValue(r.yValue)):r instanceof t.models._XyRangeValuePointData&&(l=o._axisscale().getScaleValue(r.yUpperValue),r.yUpperValue<0&&(s=!0))):(l=o._axisscale().getScaleValue(this._getAxisXValue(r.xValue)),r instanceof t.models._XyValuePointData?(u=a._axisscale().getScaleValue(r.yValue),r.yValue<0&&(s=!0)):r instanceof t.models._XyRangeValuePointData&&(u=a._axisscale().getScaleValue(r.yUpperValue),r.yUpperValue<0&&(s=!0)));for(var h=new t.core.Size(0,0),c=0,p=n;c<p.length;c++){var f=p[c],_=e.measureString(f);_.width>h.width&&(h.width=_.width),h.height+=_.height}var d=new t.core.Rect(l,u,h.width,h.height),g=0,y=0,m=0;this.config&&this.config.text&&this.config.text.offset&&(m=this.config.text.offset);var v=m;this.config&&this.config.text&&this.config.text.style.stroke&&(v=m-2);var b=new t._DataLabelPosition;b.pt1=new t.core.Point(l,u),b.pt2=new t.core.Point(l,u);var S=t.TextPosition.Auto;this.config&&this.config.text&&this.config.text.position&&(S=t.core.asEnum(this.config.text.position,t.TextPosition)),S==t.TextPosition.Auto&&(S=t.TextPosition.Outside);var C=i.getPoint();switch(S){case t.TextPosition.Outside:this.swapAxes?(d.top=C.y,g+=m,y+=.5*h.height,b.pt2.x+=v,b.pt1.y=b.pt2.y=C.y):(d.left=C.x,g-=.5*h.width,y-=0+m,b.pt1.x=b.pt2.x=C.x,b.pt2.y-=v);break;case t.TextPosition.Inside:this.swapAxes?(d.top=C.y,g-=h.width+m,y+=.5*h.height,b.pt2.x-=m,b.pt1.y=d.top,b.pt2.y=d.top):(d.left=C.x,g-=.5*h.width,y+=h.height+m,b.pt1.x=b.pt2.x=C.x,b.pt2.y+=v);break;case t.TextPosition.Center:d.left=C.x,d.top=C.y,g-=.5*h.width,y+=.5*h.height}d.left+=g,d.top+=y,b.rect=d,s&&(this.swapAxes?(d.left-=h.width+2*m,b.pt2.x-=2*m):(d.top+=h.height+2*m,b.pt2.y+=2*m));var x=this.plotArea._rectangle();return S===t.TextPosition.Outside?this.swapAxes?d.right+2+1>x.right?(d.left=x.right-2-d.width-1,b.pt2.x=d.left-2):d.left+2<x.left&&(d.left=x.left+2,b.pt2.x=d.right+2):d.top-2-d.height<x.top?(d.top=x.top+2+d.height,b.pt2.y=d.top+2):d.bottom+2-d.height>x.bottom&&(d.top=x.bottom-2,b.pt2.y=d.top+2-d.height):S===t.TextPosition.Inside&&(this.swapAxes?d.left-2-1<x.left&&(d.left=x.left+2+1,b.pt2.x=d.right-2):d.bottom+2>x.bottom&&(d.top=x.bottom+2-d.height,b.pt2.y=d.top-2)),b.pt1=this.getLineStartPoint(i,b.pt1),b},r}(t._CartesianGraph);t._BarGraph=e;var i=function(){function e(t){this.__clusterCount=0,this.__plotArea=t}return e._barExtension=function(t){if(null!=t){var i=t._barExtension;return null==i&&(t._barExtension=i=new e(t)),i}return null},e.prototype._clusterCount=function(){return this.__clusterCount},e.prototype._resetClusterCount=function(){this.__clusterCount=0;for(var e=0,i=this.__plotArea._plotViews();e<i.length;e++){var n=i[e];(n.type&t.DataGraphType.ChartFilter)==t.DataGraphType.Chart_Bar&&(this.__clusterCount=n._resetClusterCount(this.__clusterCount))}},e}(),n=function(e){function i(i,n,r){var o=e.call(this,i,n,r)||this;return null==o.categoryFields&&(o.xField instanceof t.data._NumberFieldInfo?o.xSite instanceof t.models._XSiteModel&&o.xSite.padding(o._getMinWidthInValues()):o.xField instanceof t.data._DateFieldInfo&&o.xSite instanceof t.models._XSiteModel&&o.xSite.padding(o._getMinWidthInValues())),o}return s(i,e),i.prototype._legendSymbol=function(){return new r},i.prototype._createDataSeries=function(e,i,n,r){return i instanceof t.data._SingleAggregateValueDefinition?new t.models._XyValueSeriesData(this,e,i,n,r):i instanceof t.data._SingleValueDefinition?new t.models._XyValueSeriesData(this,e,i,n,r):i instanceof t.data._NumberRangeValueDefinition?new t.models._XyRangeValueSeriesData(this,e,i,n,r):i instanceof t.data._DateRangeValueDefinition?new t.models._XyRangeValueSeriesData(this,e,i,n,r):null},i.prototype._createXSite=function(t){return e.prototype._createXSite.call(this,t,.5)},i.prototype._getMinWidthInValues=function(){for(var t=NaN,e=0,i=this.dataSeriesList;e<i.length;e++)for(var n=null,r=0,o=i[e].dataPoints;r<o.length;r++){var a=o[r],s=NaN;null!=n&&(s=Math.abs(a.xValue-n.xValue)),!isNaN(s)&&s>0&&(isNaN(t)||t>s)&&(t=s),n=a}return isNaN(t)?1:t},i}(t.models._XyAggregationPlotData),r=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.prototype.render=function(e,i){var n=i.width<i.height?i.width:i.height;e.drawRect((i.right+i.left)/2-n/2,i.top,n,n,null,t.core.merge({fill:this._color,strokeWidth:0},this._style))},i}(t.models._LegendSymbol)}(r||(r={})),function(t){var e=function(e){function n(i){return e.call(this,i,new t.options._PlotOption(null))||this}return s(n,e),Object.defineProperty(n.prototype,"type",{get:function(){return t.DataGraphType.CoordinateSystem_Xy|t.DataGraphType.Chart_Empty},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dataModel",{get:function(){return this.__dataModel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"symbols",{get:function(){return!1},enumerable:!0,configurable:!0}),n.prototype.bindData=function(t){this.__dataModel=this._createDataModel(t)},n.prototype._createDataModel=function(t){return new i(this,t,this._option())},n}(t._CartesianGraph);t._EmptyGraph=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype._createDataSeries=function(t,e,i,n){return null},e}(t.models._XyPlotData)}(r||(r={})),function(t){var e=function(e){function n(t,i){var n=e.call(this,t,i)||this;return n._conn=!0,n}return s(n,e),Object.defineProperty(n.prototype,"type",{get:function(){return t.DataGraphType.CoordinateSystem_Xy|t.DataGraphType.Chart_Line},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"dataModel",{get:function(){return this.__dataModel},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lineAspect",{get:function(){return this._option().config.lineAspect},enumerable:!0,configurable:!0}),n.prototype.bindData=function(e){this.__dataModel=this._createDataModel(e);var i=this._getAxisY();null!=i.scale&&i.scale.type==t.ValueScaleType.Percentage&&this.__dataModel._percentage()},n.prototype._createDataModel=function(t){return new i(this,t,this._option())},n.prototype.setSelected=function(i,n){if(null==i)e.prototype.setSelected.call(this,null,n);else if(i instanceof t.models._XyPointData)e.prototype.setSelected.call(this,i,n);else if(i instanceof t.models._XySeriesData){for(var r=0,o=this.dataModel.dataSeriesList;r<o.length;r++){var a=o[r];if(n!=t.SelectionMode.Points){a._unselect();for(var s=0,l=a.dataPoints;s<l.length;s++){l[s]._unselect()}}}if(n==t.SelectionMode.Points||n==t.SelectionMode.Group||n==t.SelectionMode.Point){i._select();for(var u=0,h=i.dataPoints;u<h.length;u++){h[u]._select()}}}},n.prototype._layout=function(t,i){e.prototype._layout.call(this,t,i)},n.prototype.layoutSeries=function(i,n){if(!(null==this.dataModel.dataSeriesList||this.dataModel.dataSeriesList.length<=0)){for(var r=0,o=this.dataModel.dataSeriesList;r<o.length;r++){var a=o[r];if(null!=a&&a.dataPoints.length>0){var s=this._createLines(a);if(null!=s)for(var l=0,u=s;l<u.length;l++){var h=u[l],c=new t._LineSeriesView(a,h.xs,h.ys);c._rect(this._rect().clone()),c.refresh(),this._children.push(c)}}}e.prototype.layoutSeries.call(this,i,n)}},n.prototype.render=function(t){e.prototype.render.call(this,t)},n.prototype._createLines=function(e){if(null==e.dataPoints||e.dataPoints.length<=0)return null;for(var i=[],n={xs:[],ys:[]},r=0,o=e.dataPoints;r<o.length;r++){var a=o[r],s=this._getAxisXValue(a.xValue);null!=s&&(a instanceof t.models._XyValuePointData&&(this.showNulls==t.ShowNulls.Gaps?null==a.yValue?(i.push(n),n={xs:[],ys:[]}):(n.xs.push(s),n.ys.push(a.yValue)):this.showNulls==t.ShowNulls.Zeros?(n.xs.push(s),n.ys.push(null==a.yValue?0:a.yValue)):null!=a.yValue&&(n.xs.push(s),n.ys.push(a.yValue))))}i.push(n);var l=this._getAxisX(),u=this._getAxisY(),h=[],c=l._axisscale(),p=u._axisscale(),f=(c.max-c.min)/(c.endPosition-c.startPosition),_=(p.max-p.min)/(p.endPosition-p.startPosition);isNaN(f)&&(f=1),isNaN(f)&&(f=1);for(var d=0,g=i;d<g.length;d++){var y=g[d];if(y.xs.length>1){var m=this._convertByLineAspect(y);this.lineAspect==t.LineAspect.Spline&&(m=this._convertBySpline(y,Math.abs(f),Math.abs(_))),h.push(m)}}for(var v=[],b=0,S=i=h;b<S.length;b++){var C=S[b],x={xs:[],ys:[]};if(this.swapAxes){for(var T=0,w=C.xs;T<w.length;T++){var P=w[T];x.ys.push(u.convert(P))}for(var A=0,F=C.ys;A<F.length;A++){var O=F[A];x.xs.push(l.convert(O))}if(this.radial)for(var M=0;x.xs.length==x.ys.length&&M<x.xs.length;++M){O=x.xs[M],P=x.ys[M];var D=Math.cos(P)*O+this._cx(),L=Math.sin(P)*O+this._cy();x.xs[M]=D,x.ys[M]=L}}else{for(var I=0,k=C.xs;I<k.length;I++){P=k[I];x.xs.push(l.convert(P))}for(var R=0,N=C.ys;R<N.length;R++){O=N[R];x.ys.push(u.convert(O))}if(this.radial)for(M=0;x.xs.length==x.ys.length&&M<x.xs.length;++M){P=x.xs[M],O=x.ys[M],D=Math.cos(O)*P+this._cx(),L=Math.sin(O)*P+this._cy();x.xs[M]=D,x.ys[M]=L}}v.push(x)}return v},n.prototype._convertByLineAspect=function(e){for(var i=[],n=0;n<Math.min(e.xs.length,e.ys.length);n++)i.push(new t.core.Point(e.xs[n],e.ys[n]));i=new t._LineAspectConverter(!1,this.lineAspect).convert(i);var r={xs:[],ys:[]};for(n=0;n<i.length;n++)r.xs.push(i[n].x),r.ys.push(i[n].y);return r},n.prototype._convertBySpline=function(e,i,n){var r=new t._Spline(e.xs,e.ys).calculate(i,n);return{xs:r.xs,ys:r.ys}},n}(t._CartesianGraph);t._LineGraph=e;var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.prototype._legendSymbol=function(){return new n(this._option().config.symbols)},i.prototype._createXSite=function(i){return null!=this.categoryFields&&this.categoryFields.length>0?e.prototype._createXSite.call(this,i,.5):this.xField instanceof t.data._StringFieldInfo||this.xField instanceof t.data._BooleanFieldInfo?e.prototype._createXSite.call(this,i,.5):e.prototype._createXSite.call(this,i)},i.prototype._createDataSeries=function(e,i,n,r){return i instanceof t.data._SingleAggregateValueDefinition?new t.models._XyValueSeriesData(this,e,i,n,r):i instanceof t.data._SingleValueDefinition?new t.models._XyValueSeriesData(this,e,i,n,r):null},i}(t.models._XyAggregationPlotData),n=function(e){function i(t){var i=e.call(this)||this;return i._symbols=t,i}return s(i,e),i.prototype.render=function(i,n){var r=this._seriesColor||this._color;i.drawLine(n.left,n.top+n.height/2,n.right,n.top+n.height/2,null,t.core.merge({stroke:r,strokeWidth:1},this._style)),this._symbols&&e.prototype.render.call(this,i,n)},i}(t.models._LegendSymbol)}(r||(r={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),Object.defineProperty(i.prototype,"type",{get:function(){return t.DataGraphType.CoordinateSystem_Xy|t.DataGraphType.Chart_Scatter},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataModel",{get:function(){return this.__dataModel},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"symbols",{get:function(){return!0},enumerable:!0,configurable:!0}),i.prototype.bindData=function(e){this.__dataModel=this._createDataModel(e);var i=this._getAxisY();null!=i.scale&&i.scale.type==t.ValueScaleType.Percentage&&this.__dataModel._percentage()},i.prototype._createDataModel=function(t){return new n(this,t,this._option())},i}(t._CartesianGraph);t._ScatterGraph=e;var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),Object.defineProperty(e.prototype,"min",{get:function(){return-.5},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._values.length-.5},enumerable:!0,configurable:!0}),e}(t.models._XCategorySiteModel),n=function(e){function n(t,i,n){return e.call(this,t,i,n)||this}return s(n,e),n.prototype._createXSite=function(t){return null!=this.categoryFields&&this.categoryFields.length>0?new i(this.categoryFields,t):e.prototype._createXSite.call(this,t)},n.prototype._createDataSeries=function(e,i,n,r){return i instanceof t.data._SingleAggregateValueDefinition?new t.models._XyValueSeriesData(this,e,i,n,r):i instanceof t.data._SingleValueDefinition?new t.models._XyValueSeriesData(this,e,i,n,r):null},n}(t.models._XyAggregationPlotData)}(r||(r={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return s(n,e),Object.defineProperty(n.prototype,"type",{get:function(){return t.DataGraphType.CoordinateSystem_None|t.DataGraphType.Chart_Treemap},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"radial",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"offset",{get:function(){return this._option().config.offset},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"innerRadius",{get:function(){return this._option().config.innerRadius},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sweep",{get:function(){return this._option().config.sweep},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"startAngle",{get:function(){return this._option().config.startAngle},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return"TreeMap"},enumerable:!0,configurable:!0}),n.prototype.onHitted=function(e){if(e.contains(this._rect()))for(var i=0,n=this._children;i<n.length;i++){var r=n[i].onHitted(e);if(null!=r)return r.plot=this,r.elementType.push(t.ElementType.Plot),r}return null},n.prototype._getSelections=function(){for(var t=[],e=0,i=this._children;e<i.length;e++){var n=i[e];n._selected()&&t.push(n._selection)}return t},n.prototype.setSelected=function(e,i){this.traversal(this.__dataModel.root,function(t){t._unselect()}),null!=e&&e instanceof t.models._HierarchicalPointData&&this.traversal(e,function(t){t._select()})},n.prototype.Query=function(e){var i=[],n=new t._SelectionConditionalFormattingRule(e,function(e,i){try{var n=new t.core.Binding(i),r=n.getValue(e.item);return null==r&&(r=n.getValue(e)),r}catch(t){}return null},function(t,e){var i=t.item;for(var n in i)if(e==n)return!0;return!1},function(t){i.push(t)});return this.traversal(this.dataModel.root,function(t){n.evaluate(t)}),i},n.prototype.traversal=function(t,e){if(t&&(e(t),t.children&&t.children.length>0))for(var i=0,n=t.children;i<n.length;i++){var r=n[i];this.traversal(r,e)}},n.prototype.measure=function(e,i){this.__layout=new r,e.beginTransform(),t._applyStyle(e,this._option().config.style),t._applyStyle(e,this._option().config.textStyle);var n=i.left+i.width/2,o=i.top+i.height/2,a=isNaN(this.startAngle)?0:this.startAngle,s=isNaN(this.sweep)?2*Math.PI:this.sweep/180*Math.PI,l=i.width<i.height?i.width/2:i.height/2,u=isNaN(this.innerRadius)?0:this.innerRadius*l,h=isNaN(this.offset)?0:this.offset;this.__layout.covert(this.dataModel.root,n,o,a,s,u,l,h,e),e.restoreTransform()},n.prototype._layout=function(i,n){e.prototype._layout.call(this,i,n),this._children=[];for(var r=0;r<this.__layout.layoutList.length;++r)var o=this.__layout.layoutList[r];this._hitTester.clear();for(this._globalConfig().selectedStyle,this._globalConfig().unselectedStyle,r=this.__layout.layoutList.length-1;r>=0;--r){(o=this.__layout.layoutList[r]).refresh(),this._children.push(o),this._hitTester.add(new t.DonutArea(o._center().clone(),o._radius(),o._innerRadius(),o._startAngle(),o._sweep(),o.datapoint))}},n.prototype.render=function(e){if(e.beginTransform(),t._applyStyle(e,this._option().config.style),t._applyStyle(e,this._option().config.textStyle),this.plotArea){t._Util.sort(this._children,function(t,e){return t!=e&&t._isHovered});for(var i=0;i<this._children.length;++i){this._children[i]._render(e)}}e.restoreTransform()},n.prototype.bindData=function(t){this.__dataModel=this._createDataModel(t)},n.prototype._createDataModel=function(t){return new i(this,t,this._option())},Object.defineProperty(n.prototype,"dataModel",{get:function(){return this.__dataModel},enumerable:!0,configurable:!0}),n.prototype.getLineStartPoint=function(e,i){if(this._option().config.text.linePosition){if(this._option().config.text.linePosition==t.LinePosition.Center){if(this.radial){var n=(o=e).angle+o.sweep/2,r=o.radius+o.innerRadius;return i=new t.core.Point(o.center.x+Math.cos(n)*r/2,o.center.y+Math.sin(n)*r/2)}var o,a=(o=e).rect;return i.x=a.left+a.width/2,i.y=a.top+a.height/2,i}return i}return i},n.prototype.getLabelPosition=function(e,i,n){for(var r=i,o=new t.core.Size(0,0),a=0,s=n;a<s.length;a++){var l=s[a],u=e.measureString(l);u.width>o.width&&(o.width=u.width),o.height+=u.height}var h=new t._DataLabelPosition,c=this._option().config.text.position,p=2;null!=this._option().config.text.style.strokeWidth&&(p=this._option().config.text.style.strokeWidth);this._hitTester._areas;var f=0;this.config&&this.config.text&&this.config.text.offset&&(f=this.config.text.offset);this.config&&this.config.text&&this.config.text.connectingLine&&this.config.text.connectingLine;var _=this.__layout._cx,d=this.__layout._cy,g=0,y=0,m=r.angle+r.sweep/2,v=r.radius;c===t.TextPosition.Center&&(v=(r.innerRadius+r.radius)/2),v+=f,g=_+Math.cos(m)*v,y=d+Math.sin(m)*v,h.rect=new t.core.Rect(g,y,o.width,o.height),h.pt1=new t.core.Point(_+Math.cos(m)*r.radius,d+Math.sin(m)*r.radius),h.pt1=this.getLineStartPoint(i,h.pt1),c===t.TextPosition.Outside?(h.rect.top>this.__layout._cy?(h.rect.top+=h.rect.height,h.rect.top+=h.rect.height/2):h.rect.top-=h.rect.height/2,h.rect.left>this.__layout._cx?(h.rect.left-=h.rect.width/2,h.rect.left+=h.rect.height/2):(h.rect.left+=h.rect.width/2,h.rect.left-=h.rect.width,h.rect.left-=h.rect.height/2)):c===t.TextPosition.Inside?(h.rect.top>this.__layout._cy?(h.rect.top+=h.rect.height,h.rect.top-=h.rect.height/2):h.rect.top+=h.rect.height/2,h.rect.left>this.__layout._cx?(h.rect.left-=h.rect.width/2,h.rect.left-=h.rect.height/2):(h.rect.left+=h.rect.width/2,h.rect.left-=h.rect.width,h.rect.left+=h.rect.height/2)):c===t.TextPosition.Center&&(g=_+Math.cos(m)*v,y=d+Math.sin(m)*v,g-=o.width/2,y+=o.height/2,h.rect=new t.core.Rect(g,y,o.width,o.height));var b=this.plotArea._rectangle();return this.fittingLabels(h.rect,new t.core.Rect(b.left+p,b.top+p,b.width-2*p,b.height-2*p)),h.pt2=new t.core.Point(h.rect.left+h.rect.width/2,h.rect.bottom),this.config&&this.config.text&&this.config.text.style.stroke?h.pt2.x=h.rect.left+h.rect.width/2:h.rect.left+h.rect.width/2<this.__layout._cx?h.pt2.x=h.rect.right:h.rect.left+h.rect.width/2>=this.__layout._cx&&(h.pt2.x=h.rect.left),h.rect.top+h.rect.height/2<this.__layout._cy?h.pt2.y=h.rect.bottom+p:h.rect.top+h.rect.height/2>=this.__layout._cy&&(h.pt2.y=h.rect.top-p),h.pt2.y-=h.rect.height,h},n.prototype.fittingLabels=function(t,e){t.left<e.left&&(t.top=(t.bottom-this.__layout._cy)*(e.left-this.__layout._cx)/(t.left-this.__layout._cx)+this.__layout._cy+t.height,t.left=e.left),t.right>e.right&&(t.top=(t.bottom-this.__layout._cy)*(e.right-this.__layout._cx)/(t.right-this.__layout._cx)+this.__layout._cy+t.height,t.left=e.right-t.width),t.top-t.height<e.top&&(t.left=(t.left-this.__layout._cx)*(e.top-this.__layout._cy)/(t.top-this.__layout._cy)+this.__layout._cx,t.top=e.top+t.height),t.bottom>e.bottom&&(t.left=(t.left-this.__layout._cx)*(e.bottom-this.__layout._cy)/(t.bottom-this.__layout._cy)+this.__layout._cx,t.top=e.bottom)},n}(t._DataGraph);t._SunburstGraph=e;var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.prototype._createPoint=function(e,i,n,r){return new t.models._HierarchicalPointData(e,i,n,r)},i.prototype._createRootPoint=function(e,i,n,r){return new t.models._HierarchicalRootPointData(e,i,n,r)},i}(t.models._HierarchicalPlotData),n=function(){function t(t,e,i,n,r,o,a,s,l){this.vs=t,this.startAngle=n,this.endAngle=r,this.innerRadius=o,this.radius=a,this.sum=s,this.depth=l,this.cx=e,this.cy=i}return Object.defineProperty(t.prototype,"sweep",{get:function(){return this.endAngle-this.startAngle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"h",{get:function(){return this.radius-this.innerRadius},enumerable:!0,configurable:!0}),t}(),r=function(){function e(){this.showtitle=!0,this._depth=0,this.offset=.1,this._cx=0,this._cy=0,this._radiusUnit=0}return e.prototype.covert=function(t,e,i,r,o,a,s,l,u){this._layoutList=[],this.calcDeep(t.children),this.offset=l*(s-a),this._radiusUnit=(s-a-this.offset)/(this._depth-1),this._cx=e,this._cy=i,this.value=t,this._innerRadius=a,this._radius=s;var h=new n(t.children,this._cx,this._cy,r,r+o,a,a+this._radiusUnit,t.value,0);this.calcSum(h),this._preangle=h.sweep/h.sum,this.layoutItems(h,u)},Object.defineProperty(e.prototype,"layoutList",{get:function(){return this._layoutList},enumerable:!0,configurable:!0}),e.prototype.calcDeep=function(t){this._depth=0,this._depth=this._calcDeep(t)+1},e.prototype._calcDeep=function(t){if(t&&t.length>0){for(var e=0,i=0;i<t.length;i++){var n=this._calcDeep(t[i].children);e<n&&(e=n)}return++e}return 0},e.prototype.layoutItems=function(e,i){for(var r=e.startAngle,o=0;o<e.vs.length;++o){var a=e.vs[o],s=a.value*this._preangle,l=e.cx,u=e.cy;0==e.depth&&(l=e.cx+this.offset*Math.cos(r+s/2),u=e.cy+this.offset*Math.sin(r+s/2));var h=new t._SunburstPointView(a,new t.core.Point(l,u),e.radius,e.innerRadius,r,s);if(this._layoutList.push(h),a.children&&a.children.length>0){var c=new n(a.children,l,u,r,r+s,e.radius,e.radius+this._radiusUnit,0,e.depth+1);this.calcSum(c),this.layoutItems(c,i)}r+=s}},e.prototype.calcSum=function(t){for(var e=0,i=0;i<t.vs.length;++i)e+=t.vs[i].value;t.sum=e},e}()}(r||(r={})),function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return s(n,e),Object.defineProperty(n.prototype,"type",{get:function(){return t.DataGraphType.CoordinateSystem_None|t.DataGraphType.Chart_Treemap},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"radial",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"name",{get:function(){return"TreeMap"},enumerable:!0,configurable:!0}),n.prototype.onHitted=function(e){if(e.contains(this._rect()))for(var i=0,n=this._children;i<n.length;i++){var r=n[i].onHitted(e);if(null!=r)return r.plot=this,r.elementType.push(t.ElementType.Plot),r}return null},n.prototype.Query=function(e){var i=[],n=new t._SelectionConditionalFormattingRule(e,function(e,i){try{var n=new t.core.Binding(i),r=n.getValue(e.item);return null==r&&(r=n.getValue(e)),r}catch(t){}return null},function(t,e){var i=t.item;for(var n in i)if(e==n)return!0;return!1},function(t){i.push(t)});return this.traversal(this.dataModel.root,function(t){n.evaluate(t)}),i},n.prototype._getSelections=function(){for(var t=[],e=0,i=this._children;e<i.length;e++){var n=i[e];n._selected()&&t.push(n._selection)}return t},n.prototype.setSelected=function(e,i){this.traversal(this.__dataModel.root,function(t){t._unselect()}),null!=e&&e instanceof t.models._HierarchicalPointData&&this.traversal(e,function(t){t._select()})},n.prototype.traversal=function(t,e){if(t&&(e(t),t.children&&t.children.length>0))for(var i=0,n=t.children;i<n.length;i++){var r=n[i];this.traversal(r,e)}},n.prototype.measure=function(e,i){e.beginTransform(),t._applyStyle(e,this._option().config.style),t._applyStyle(e,this._option().config.textStyle),this.__layout=new r,this.__layout.covert(this.dataModel.root,i,e),e.restoreTransform()},n.prototype._layout=function(i,n){e.prototype._layout.call(this,i,n),this._children=[];for(var r=0;r<this.__layout.layoutList.length;++r)var o=this.__layout.layoutList[r];this._hitTester.clear();for(this._globalConfig().selectedStyle,this._globalConfig().unselectedStyle,r=this.__layout.layoutList.length-1;r>=0;--r){(o=this.__layout.layoutList[r])._visible()==t.ViewState.Visible&&(o.refresh(),this._children.push(o))}},n.prototype.render=function(e){if(e.beginTransform(),t._applyStyle(e,this._option().config.style),t._applyStyle(e,this._option().config.textStyle),this.plotArea){t._Util.sort(this._children,function(t,e){return t!=e&&t._isHovered});for(var i=0;i<this._children.length;++i){this._children[i]._render(e)}}e.restoreTransform()},n.prototype.bindData=function(t){this.__dataModel=this._createDataModel(t)},n.prototype._createDataModel=function(t){return new i(this,t,this._option())},Object.defineProperty(n.prototype,"dataModel",{get:function(){return this.__dataModel},enumerable:!0,configurable:!0}),n}(t._DataGraph);t._TreemapGraph=e;var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.prototype._createPoint=function(e,i,n,r){return new t.models._HierarchicalPointData(e,i,n,r)},i.prototype._createRootPoint=function(e,i,n,r){return new t.models._HierarchicalRootPointData(e,i,n,r)},i}(t.models._HierarchicalPlotData),n=function(){function t(t,e,i,n,r,o,a){this.vs=t,this.l=e,this.t=i,this.r=n,this.b=r,this.sum=o,this.depth=a}return Object.defineProperty(t.prototype,"w",{get:function(){return this.r-this.l},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"h",{get:function(){return this.b-this.t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"area",{get:function(){return this.w*this.h},enumerable:!0,configurable:!0}),t}(),r=function(){function e(){this._showtitle=!0,this.__depth=0,this.__offset=2}return e.prototype.covert=function(t,e,i){this.__layoutList=[],this.calcDeep(t.children),this.__rect=e.clone(),this.__value=t;var r=new n(t.children,e.left,e.top,e.left+e.width,e.top+e.height,t.value,0);this.hideSmallNode(r),this.layoutItems(r,i)},Object.defineProperty(e.prototype,"layoutList",{get:function(){return this.__layoutList},enumerable:!0,configurable:!0}),e.prototype.calcDeep=function(t){this.__depth=0,this.__depth=this._calcDeep(t)+1},e.prototype._calcDeep=function(t){if(t&&t.length>0){for(var e=0,i=0;i<t.length;i++){var n=this._calcDeep(t[i].children);e<n&&(e=n)}return++e}return 0},e.prototype.hideSmallNode=function(t){if(t&&t.vs&&t.vs.length>0){var e=t.area/t.sum;t.vs.sort(function(t,e){return t.value-e.value});for(var i=0;i<t.vs.length;++i){var n=t.vs[i];n.hidden=!1,n.value*e<1e3&&(n.hidden=!0,t.sum-=n.value,e=t.area/t.sum)}}},e.prototype.calcSum=function(t){for(var e=0,i=0;i<t.vs.length;++i)e+=t.vs[i].value;t.sum=e},e.prototype.layoutItems=function(e,i){if(!(e.sum<=0)){var r=new t.core.Rect(e.l,e.t,e.r-e.l,e.b-e.t),o=e.area/e.sum;e.vs.sort(function(t,e){return e.value-t.value});for(var a=0;a<e.vs.length&&!t._Util.isNil(r);){var s=this.locationRects(e.vs,a,o,r),l=t._Util.mergeRect.apply(this,s);r=this.clipRect(l,r);for(var u=0;u<s.length;++u){var h=s[u],c=e.vs[a],p=new t._TreeMapPointView(c);if(p._rect(h),p._visible(t.ViewState.Visible),p.datapoint=c,p._selected(c.isSelected),c.hidden)a++;else{if(c.children&&c.children.length>0){var f=(this.__depth-e.depth)/this.__depth*this.__offset;h=new t.core.Rect(h.left+f,h.top+f,h.width-2*f,h.height-2*f);var _=new n(c.children,h.left,h.top,h.left+h.width,h.top+h.height,c.value,e.depth+1),d=new t._TreeMapPointView(c);if(d.istitle=!0,d.title=c.name,d.datapoint=c,d._selected(c.isSelected),this._showtitle&&c.name){var g=i.measureString(c.name,null,null,this._titleStyle);g.width>h.width&&(d.title=t._Util.getTextByMaxLength(i,c.name,h.width-15,this._titleStyle),g=i.measureString(d.title,null,null,this._titleStyle)),d._rect(new t.core.Rect(h.left,h.top,h.width,1.5*g.height)),d.titlerect=new t.core.Rect(h.left+(d._rect().width-g.width)/2,h.top+(d._rect().height-g.height)/2,g.width,g.height),d._rect().height>h.height||(d.titlestyle=this._titleStyle,_=new n(c.children,h.left,h.top+1.5*g.height,h.left+h.width,h.top+h.height,c.value,e.depth+1),this.__layoutList.push(d))}this.calcSum(_),this.hideSmallNode(_),_.sum>0?(p._visible(t.ViewState.Invisible),p.hidelabel=!0,this.layoutItems(_,i)):d._visible(t.ViewState.Visible)}if(!p.hidelabel){p.label=c.name;var y=i.measureString(p.label,null,null,this._textStyle);y.width>h.width&&(p.label=t._Util.getTextByMaxLength(i,p.label,h.width-15,this._textStyle),y=i.measureString(p.label,null,null,this._textStyle)),p.labelstyle=this._textStyle,p.labelrect=new t.core.Rect(h.left,h.bottom,y.width,y.height)}this.__layoutList.push(p),++a}}}}},e.prototype.locationRects=function(e,i,n,r){for(var o=[],a=0,s=0,l=i;l<e.length;++l){var u,h=e[l],c=0;if(h.value<0&&(e.splice(l,1),h=e[l]),r.height<r.width){if(u=(s+=h.value)*n/r.height,c=e[i].value*n/u,0!=a){var p=c>u?c/u:u/c;if(!(Math.abs(p-1)<Math.abs(a-1)))return o;a=p,o.length=0}else a=c>u?c/u:u/c;o.length=0;for(var f=i;f<=l;f++){var _=e[f].value*n/u;d=f===i?new t.core.Rect(r.left,r.top,u,c):new t.core.Rect(o[f-i-1].left,o[f-i-1].bottom,u,_),o.push(d)}}else{if(c=(s+=h.value)*n/r.width,u=e[i].value*n/c,0!=a){p=c>u?c/u:u/c;if(!(Math.abs(p-1)<Math.abs(a-1)))return o;a=p,o.length=0}else a=c>u?c/u:u/c;o.length=0;for(f=i;f<=l;f++){var d,g=e[f].value*n/c;d=f===i?new t.core.Rect(r.left,r.top,u,c):new t.core.Rect(o[f-i-1].right,o[f-i-1].top,g,c),o.push(d)}}u,c}return o},e.prototype.clipRect=function(e,i){return Math.abs(e.width-i.width)<=1e-4?new t.core.Rect(e.left,e.bottom,e.width,i.bottom-e.bottom):new t.core.Rect(e.right,e.top,i.right-e.right,e.height)},e}();!function(){function e(){this.showtitle=!0,this.splitRate=.5}e.prototype.covert=function(t,e,i){this._rect=e.clone(),this.value=t;var r=new n(t.children,e.left,e.top,e.left+e.width,e.top+e.height,t.value,0);this.calcSum(r),this.layoutItems(r,i)},Object.defineProperty(e.prototype,"layoutList",{get:function(){return this._layoutList},enumerable:!0,configurable:!0}),e.prototype.layoutItems=function(t,e){this.calcSum(t);var i=this.divideValues(t);if(i&&i.length>1)for(var n=0;n<i.length;++n)this.layoutItems(i[n],e);else if(i&&1==i.length)i[0]},e.prototype.calcSum=function(t){for(var e=0,i=0;i<t.vs.length;++i)e+=t.vs[i].value;t.sum=e},e.prototype.divideValues=function(e){var i=0,r=null,o=null,a=e.sum,s=e.vs,l=e.area/e.sum,u=new t.core.Rect(e.l,e.t,e.r-e.l,e.b-e.t);if(s.length<=1)return[e];for(var h=0;h<s.length;++h){var c=s[h],p=a-(i+=c.value),f=i/p;if(Math.min(this.splitRate-f)<Math.min(this.splitRate-1)){r=c.slice(0,h-1),o=s.slice(h-1);break}}var _=l*i,d=u.width<u.height,g=d?u.width:_/u.height,y=d?_/u.width:u.height,m=new n(r,u.left,u.top,g+u.left,y+u.top,i,e.depth),v=l*p,b=d?u.width:v/u.height,S=d?v/u.width:u.height,C=new n(o,d?u.left:u.left+g,d?u.top+y:u.top,0,0,p,e.depth);return C.r=C.l+b,C.b=C.t+S,[m,C]}}()}(r||(r={})),function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.__parent=t,i}return s(i,e),Object.defineProperty(i.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this.parent._option().footer},enumerable:!0,configurable:!0}),i.prototype._text=function(){return this.title},i.prototype._layout=function(i,n){var r=this._measure(i,new t.core.Size(n.width,n.height));this.parent._option().footerStyle.hAlign==t.HAlign.Left?e.prototype._layout.call(this,i,new t.core.Rect(n.left,n.bottom-r.height,r.width,r.height)):this.parent._option().footerStyle.hAlign==t.HAlign.Right?e.prototype._layout.call(this,i,new t.core.Rect(n.right-r.width,n.bottom-r.height,r.width,r.height)):e.prototype._layout.call(this,i,new t.core.Rect(n.left+(n.width-r.width)/2,n.bottom-r.height,r.width,r.height))},i.prototype._render=function(i){i.startGroup(t.__Constant_Core_Footer_ClassName),e.prototype._render.call(this,i),i.endGroup()},i.prototype._renderInnerContent=function(e,i){null!=this._text()&&this._text().length>0&&(e.beginTransform(),this._applyStyle(e),this.parent._option().headerStyle.hAlign==t.HAlign.Left?e.drawMultipleStrings(this._text(),i,"Left","Wrap"):this.parent._option().headerStyle.hAlign==t.HAlign.Right?e.drawMultipleStrings(this._text(),i,"Right","Wrap"):e.drawMultipleStrings(this._text(),i,"Center","Wrap"),e.restoreTransform())},i.prototype._measureInnerContent=function(e,i){var n=new t.core.Size(0,0);return null!=this._text()&&this._text().length>0&&(e.beginTransform(),this._applyStyle(e),n=e.measureMultipleStrings(this._text(),new t.core.Rect(0,0,i.width,i.height),"Wrap"),e.restoreTransform()),n},i.prototype._applyStyle=function(e){t._applyStyle(e,this.parent._option().footerStyle),t._applyStyle(e,this.parent._option().footerTextStyle)},i.prototype._applyBorderStyle=function(i){e.prototype._applyBorderStyle.call(this,i),t._applyStyle(i,this.parent._option().style.borderStyle),t._applyStyle(i,this.parent._option().footerStyle.borderStyle)},i.prototype._applyBackgroundStyle=function(i){e.prototype._applyBackgroundStyle.call(this,i),t._applyStyle(i,{fill:this.parent._option().style.backgroundColor}),t._applyStyle(i,{fill:this.parent._option().footerStyle.backgroundColor})},i.prototype.onHitted=function(e){return e.contains(this._rectangle())?new t.HitInfo(new t.core.Point(e.x,e.y),this,null,this,[t.ElementType.Footter],this._selection):null},i}(t._TextView);t._FooterView=e}(r||(r={})),function(t){var e=function(e){function i(t){var i=e.call(this)||this;return i.__parent=t,i}return s(i,e),Object.defineProperty(i.prototype,"parent",{get:function(){return this.__parent},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this.parent._option().header},enumerable:!0,configurable:!0}),i.prototype._selected=function(t){if(void 0===t)return!1},i.prototype._text=function(){return this.title},i.prototype._layout=function(i,n){var r=this._measure(i,new t.core.Size(n.width,n.height));this.parent._option().headerStyle.hAlign==t.HAlign.Left?e.prototype._layout.call(this,i,new t.core.Rect(n.left,n.top,r.width,r.height)):this.parent._option().headerStyle.hAlign==t.HAlign.Right?e.prototype._layout.call(this,i,new t.core.Rect(n.right-r.width,n.top,r.width,r.height)):e.prototype._layout.call(this,i,new t.core.Rect(n.left+(n.width-r.width)/2,n.top-14,r.width,r.height))},i.prototype._render=function(i){i.startGroup(t.__Constant_Core_Header_ClassName),e.prototype._render.call(this,i),i.endGroup()},i.prototype._renderInnerContent=function(e,i){null!=this._text()&&this._text().length>0&&(e.beginTransform(),this._applyStyle(e),this.parent._option().headerStyle.hAlign==t.HAlign.Left?e.drawMultipleStrings(this._text(),i,"Left","Wrap"):this.parent._option().headerStyle.hAlign==t.HAlign.Right?e.drawMultipleStrings(this._text(),i,"Right","Wrap"):e.drawMultipleStrings(this._text(),i,"Center","Wrap",null,null,{lineCount:2}),e.restoreTransform())},i.prototype._measureInnerContent=function(e,i){var n=new t.core.Size(0,0);if(null!=this._text()&&this._text().length>0){e.beginTransform(),this._applyStyle(e),n=e.measureMultipleStrings(this._text(),new t.core.Rect(0,0,i.width,i.height),"Wrap",null,null,{lineCount:2});var r=e.measureMultipleStrings(this._text(),new t.core.Rect(0,0,i.width,i.height),"Wrap");n.height>r.height?this.chartTitleOverflow=!1:this.chartTitleOverflow=!0,e.restoreTransform()}return n},i.prototype._applyStyle=function(e){t._applyStyle(e,this.parent._option().headerStyle),t._applyStyle(e,this.parent._option().headerTextStyle)},i.prototype._applyBorderStyle=function(i){e.prototype._applyBorderStyle.call(this,i),t._applyStyle(i,this.parent._option().style.borderStyle),t._applyStyle(i,this.parent._option().headerStyle.borderStyle)},i.prototype._applyBackgroundStyle=function(i){e.prototype._applyBackgroundStyle.call(this,i),t._applyStyle(i,{fill:this.parent._option().style.backgroundColor}),t._applyStyle(i,{fill:this.parent._option().headerStyle.backgroundColor})},i.prototype.onHitted=function(e){return e.contains(this._rectangle())?new t.HitInfo(new t.core.Point(e.x,e.y),this,null,this,[t.ElementType.Header],this._selection):null},i}(t._TextView);t._HeaderView=e}(r||(r={})),function(t){var e;!function(t){t[t.tickf7=-7]="tickf7",t[t.tickf6=-6]="tickf6",t[t.tickf5=-5]="tickf5",t[t.tickf4=-4]="tickf4",t[t.tickf3=-3]="tickf3",t[t.tickf2=-2]="tickf2",t[t.tickf1=-1]="tickf1",t[t.second=1]="second",t[t.minute=60]="minute",t[t.hour=3600]="hour",t[t.day=86400]="day",t[t.week=604800]="week",t[t.month=2678400]="month",t[t.year=31536e3]="year",t[t.maxtime=Number.MAX_VALUE]="maxtime"}(e=t.tmInc||(t.tmInc={}));var i=function(){function t(t){this.ticks=t}return Object.defineProperty(t.prototype,"Ticks",{get:function(){return this.ticks},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalSeconds",{get:function(){return this.ticks/1e7},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TotalDays",{get:function(){return this.ticks/1e7/86400},enumerable:!0,configurable:!0}),t.fromSeconds=function(e){return new t(1e7*e)},t.fromDays=function(e){return new t(1e7*e*24*60*60)},t.TicksPerSecond=1e7,t}();t._timeSpan=i;var n=function(){function n(e){t.core.isDate(e)?this.init(e):t.core.isNumber(e)&&this.init(new Date(e))}return n.prototype.init=function(t){this.year=t.getFullYear(),this.month=t.getMonth(),this.day=t.getDate(),this.hour=t.getHours(),this.minute=t.getMinutes(),this.second=t.getSeconds()},n.prototype.getTimeAsDateTime=function(){this.hour>=24&&(this.hour-=24,this.day+=1),this.month<0?(-1-this.day,this.month=1):this.month>11&&(this.month-12,this.month=12),this.day<1?(-1-this.day,this.day=1):this.day>28&&2==this.month?(this.day-28,this.day=28):this.day>30&&(4==this.month||4==this.month||6==this.month||9==this.month||11==this.month)?(this.day-30,this.day=30):this.day>31&&(this.day-31,this.day=31),this.second>59&&(this.second-59,this.second=59);return this.minute>59&&(this.minute-59,this.minute=59),new Date(this.year,this.month,this.day,this.hour,this.minute,this.second)},n.prototype.getTimeAsDouble=function(){return this.getTimeAsDateTime().valueOf()},n.tround=function(t,e,i){var n=t/e*e;return n-=n%1,i&&n!=t&&(n+=e-=e%1),n},n.RoundTime=function(t,i,r){var o=24*i*60*60;if(o>0){var a=new n(t);return o<e.minute?(a.second=this.tround(a.second,o,r),a.getTimeAsDouble()):(a.second=0,o<e.hour?(o/=e.minute,a.minute=this.tround(a.minute,o,r),a.getTimeAsDouble()):(a.minute=0,o<e.day?(o/=e.hour,a.hour=this.tround(a.hour,o,r),a.getTimeAsDouble()):(a.hour=0,o<e.month?(o/=e.day,a.day=this.tround(a.day,o,r),a.getTimeAsDouble()):(a.day=1,o<e.year?(o/=e.month,1!=a.month&&(a.month=this.tround(a.month,o,r)),a.getTimeAsDouble()):(a.month=1,o/=e.year,a.year=this.tround(a.year,o,r),a.getTimeAsDouble())))))}var s=t,l=s-o,u=l/i*i;return r&&u!=l&&(u+=i),s=o+u},n.TimeSpanFromTmInc=function(t){var n=i.fromSeconds(1);if(t!=e.maxtime)if(t>e.tickf1)n=i.fromSeconds(t);else{var r=t,o=1;for(r+=7;r>0;)o*=10,r--;n=new i(o)}return n},n.manualTimeInc=function(t){var i=e.second;if(null==t||0==t.length)return i;var n=t.indexOf("f");if(n>=0){var r=-1;if(n>0&&"%"==t.substr(n-1,1))r=-1;else for(var o=1;o<6&&!(n+o>=t.length);o++){if("f"!=t.substr(n+o,1))break;r--}i=r}else t.indexOf("s")>=0?i=e.second:t.indexOf("m")>=0?i=e.minute:t.indexOf("h")>=0||t.indexOf("H")?i=e.hour:t.indexOf("d")>=0?i=e.day:t.indexOf("M")>=0?i=e.month:t.indexOf("y")>=0&&(i=e.year);return i},n.getNiceInc=function(t,e,i){for(var n=0;n<t.length;n++){var r=t[n]*i;if(e<=r)return r}return 0},n.NiceTimeSpan=function(t,r){var o=e.second;null!=r&&r.length>0&&(o=n.manualTimeInc(r));var a=0,s=0;if(o<e.second&&t.TotalSeconds<10){for(a=t.Ticks,s=n.TimeSpanFromTmInc(o).Ticks;a>10*s;)s*=10;var l=s;return a>l&&(l*=2),a>l&&(l=5*s),a>l&&(l=10*s),new i(l)}if(0==(a=Math.ceil(t.TotalSeconds)))return n.TimeSpanFromTmInc(o);if(s=1,o<e.minute){if(a<e.minute&&0!=(s=n.getNiceInc([1,2,5,10,15,30],a,o)))return i.fromSeconds(s);o=e.minute}if(o<e.hour){if(a<e.hour&&0!=(s=n.getNiceInc([1,2,5,10,15,30],a,o)))return i.fromSeconds(s);o=e.hour}if(o<e.day){if(a<e.day&&0!=(s=n.getNiceInc([1,3,6,12],a,o)))return i.fromSeconds(s);o=e.day}if(o<e.month){if(a<e.month&&0!=(s=n.getNiceInc([1,2,7,14],a,o)))return i.fromSeconds(s);o=e.month}if(o<e.year){if(a<e.year&&0!=(s=n.getNiceInc([1,2,3,4,6],a,o)))return i.fromSeconds(s);o=e.year}return a<(s=100*e.year)&&0==(s=n.getNiceInc([1,2,5,10,20,50],a,o))&&(s=100*e.year),i.fromSeconds(s)},n.NiceTimeUnit=function(t,e){var r=i.fromDays(t);return(r=n.NiceTimeSpan(r,e)).TotalDays},n.GetTimeDefaultFormat=function(t,n){if(isNaN(t)||isNaN(n))return"";var r="s",o=i.fromSeconds(.001*(t-n)),a=o.TotalSeconds;if(a>=e.year)r="yyyy";else if(a>=e.month)r="MMM yyyy";else if(a>=e.day)r="MMM d";else if(a>=e.hour)r="ddd H:mm";else if(a>=.5*e.hour)r="H:mm";else if(a>=1)r="H:mm:ss";else if(a>0){var s=o.Ticks;for(r="s.";s<i.TicksPerSecond;)s*=10,r+="f"}return r},n.secInYear=86400,n}();t._timeHelper=n}(r||(r={})),function(t){var e=function(){function t(){}return t.prototype.ease=function(t){return t},t}();t.AnimationEase=e;var i=function(){return function(){}}();t.Animation=i,function(t){t[t.Visible=0]="Visible",t[t.Gone=1]="Gone",t[t.Invisible=2]="Invisible"}(t.ViewState||(t.ViewState={}))}(r||(r={})),function(t){var e=function(e){function i(t,i,n){var r=e.call(this)||this;return r.__model=t,r.__xs=i,r.__ys=n,r.datapoint=t,r}return s(i,e),i.prototype._selected=function(t){if(void 0===t)return this._model().isSelected;1==t?this._model()._select():this._model()._unselect()},i.prototype._model=function(){return this.__model},i.prototype._xs=function(){return this.__xs},i.prototype._ys=function(){return this.__ys},i.prototype._render=function(e){this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible&&(e.beginTransform(),null!=this._model().color&&(e.fill=this._model().color),this._applyStyle(e,this._model().style),null!=e.fill&&"none"!=e.fill||t._applyStyle(e,{fill:this._model().parent.parent.parent._colorProvider().getColor(0)}),this._model().isSelected?this._applyStyle(e,this._model().parent.parent.parent._option().selectedStyle):this._applyStyle(e,this._model().parent.parent.parent._option().unselectedStyle),this._hovered&&this._applyStyle(e,this._model().parent._option().config.hoverStyle),e.drawPolygon(this._xs(),this._ys()),e.restoreTransform())},i.prototype._applyStyle=function(t,e){null!=e&&(null!=e.opacity&&(t.opacity=e.opacity),null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeDasharray&&(t.strokeDasharray=e.strokeDasharray))},i.prototype.onHitted=function(e){return e.contains(this._rect())?(this._selection.rect=this._rect(),t._Util.IsPointInPolygon2(new t.core.Point(e.x,e.y),this._xs(),this._ys())?new t.HitInfo(new t.core.Point(e.x,e.y),this.datapoint,this,this,[t.ElementType.Series],this._selection):null):null},i.prototype.refresh=function(){e.prototype.refresh.call(this),this._selection.points=[],this._xs().length>=4&&this._ys().length>=4&&(this._selection.points.push(new t.core.Point(this._xs()[0],this._ys()[0])),this._selection.points.push(new t.core.Point(this._xs()[Math.floor(.33*(this._xs().length-1))],this._ys()[Math.floor(.33*(this._ys().length-1))])),this._selection.points.push(new t.core.Point(this._xs()[Math.floor(.66*(this._xs().length-1))],this._ys()[Math.floor(.66*(this._ys().length-1))])),this._selection.points.push(new t.core.Point(this._xs()[this._xs().length-1],this._ys()[this._ys().length-1])))},i}(t._View);t._AreaSeriesView=e}(r||(r={})),function(t){var e=function(e){function i(t,i){var n=e.call(this)||this;return n.__start=t,n.__end=i,n}return s(i,e),i.prototype._start=function(){return this.__start},i.prototype._end=function(){return this.__end},i.prototype._render=function(e){e.drawLine(this._start().x,this._start().y,this._end().x,this._end().y,null,{stroke:t.__Constant_Core_Bar_Lines_Color,strokeWidth:1})},i}(t._View);t._BarLineViewModel=e}(r||(r={})),function(t){var e=function(t){function e(e){var i=t.call(this)||this;return i.__model=e,i.datapoint=e,i}return s(e,t),e.prototype._selected=function(t){if(void 0===t)return this._model().isSelected;1==t?this._model()._select():this._model()._unselect()},e.prototype._model=function(){return this.__model},e}(t._View);t._DataPointView=e}(r||(r={})),function(t){var e=function(e){function i(t,i,n){var r=e.call(this)||this;return r.__model=t,r.__xs=i,r.__ys=n,r.datapoint=t,r}return s(i,e),i.prototype._selected=function(t){if(void 0===t)return this._model().isSelected;1==t?this._model()._select():this._model()._unselect()},i.prototype._model=function(){return this.__model},i.prototype._xs=function(){return this.__xs},i.prototype._ys=function(){return this.__ys},i.prototype._defaultStyle=function(){return{opacity:null,stroke:null,strokeWidth:1,strokeDasharray:null}},i.prototype._render=function(e){this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible&&(e.beginTransform(),t._applyStyle(e,this._defaultStyle()),null!=this._model().color&&(e.stroke=this._model().color),this._applyStyle(e,this._model().style),null!=e.stroke&&"none"!=e.stroke||t._applyStyle(e,{stroke:this._model().parent.parent.parent._colorProvider().getColor(0)}),this._model().isSelected?this._applyStyle(e,this._model().parent.parent.parent._option().selectedStyle):this._applyStyle(e,this._model().parent.parent.parent._option().unselectedStyle),this._hovered&&this._applyStyle(e,this._model().parent._option().config.hoverStyle),e.drawLines(this._xs(),this._ys()),e.restoreTransform())},i.prototype._applyStyle=function(t,e){null!=e&&(null!=e.opacity&&(t.opacity=e.opacity),null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeDasharray&&(t.strokeDasharray=e.strokeDasharray))},i.prototype.onHitted=function(e){if(e.contains(this._rect())){this._selection.rect=this._rect();for(var i=0;i<Math.min(this._xs().length,this._ys().length)-1;++i)if(t._Util.pointToLine(this.__xs[i],this.__ys[i],this.__xs[i+1],this.__ys[i+1],e.x,e.y)<10)return new t.HitInfo(new t.core.Point(e.x,e.y),this.datapoint,this.item,this,[t.ElementType.Series],this._selection);return null}return null},i.prototype.refresh=function(){this._selection.points=[],this._xs().length>=4&&this._ys().length>=4&&(this._selection.points.push(new t.core.Point(this._xs()[0],this._ys()[0])),this._selection.points.push(new t.core.Point(this._xs()[Math.floor(.33*(this._xs().length-1))],this._ys()[Math.floor(.33*(this._ys().length-1))])),this._selection.points.push(new t.core.Point(this._xs()[Math.floor(.66*(this._xs().length-1))],this._ys()[Math.floor(.66*(this._ys().length-1))])),this._selection.points.push(new t.core.Point(this._xs()[this._xs().length-1],this._ys()[this._ys().length-1])))},i}(t._View);t._LineSeriesView=e}(r||(r={})),function(t){var e=function(){function t(){}return t.clampAngle=function(t){var e=(t+180)%360-180;return e<-180&&(e+=360),e},t.isRectOverlap=function(t,e){return!(!t||!e)&&!(t.left>e.right||t.top>e.bottom||e.left>t.right||e.top>t.bottom)},t}(),i=function(i){function n(t,e,n,r,o,a){var s=i.call(this)||this;return s.__model=t,s.__center=e,s.__radius=n,s.__innerRadius=r,s.__startAngle=o,s.__sweep=a,s.datapoint=t,s}return s(n,i),n.prototype._selected=function(t){if(void 0===t)return this._model().isSelected;1==t?this._model()._select():this._model()._unselect()},n.prototype._center=function(){return this.__center},n.prototype._radius=function(){return this.__radius},n.prototype._innerRadius=function(){return this.__innerRadius},n.prototype._startAngle=function(){return this.__startAngle},n.prototype._sweep=function(){return this.__sweep},n.prototype._model=function(){return this.__model},n.prototype._render=function(e){if(this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible){var i=this._model()._root();if(null!=i){if(e.beginTransform(),this._applyStyle(e,this._model().style),null==e.fill||"none"==e.fill){var n=this._model();n instanceof t.models._HierarchicalPointData&&t._applyStyle(e,{fill:n._top().color})}null==e.fill&&t._applyStyle(e,{fill:i.parent.parent.parent._colorProvider().getColor(0)}),this._model().isSelected?this._applyStyle(e,i.parent.parent.parent._option().selectedStyle):this._applyStyle(e,i.parent.parent.parent._option().unselectedStyle),this._hovered?(this._scale=1.05,this._applyStyle(e,i.parent._option().config.hoverStyle)):this._scale=1,e.drawDonutSegment(this._center().x,this._center().y,this._radius()*((this._scale-1)/2+1),this._innerRadius()*(1-(this._scale-1)/2),this._startAngle(),this._sweep()),e.restoreTransform()}}},n.prototype._applyStyle=function(t,e){null!=e&&(null!=e.opacity&&(t.opacity=e.opacity),null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeDasharray&&(t.strokeDasharray=e.strokeDasharray))},n.prototype.refresh=function(){i.prototype.refresh.call(this),this._selection.points=[];for(var e=this._sweep()/4,n=this._startAngle();n<this._startAngle()+this._sweep();n+=e){var r=new t.core.Point;r.x=this._center().x+Math.cos(n)*this._radius(),r.y=this._center().y+Math.sin(n)*this._radius(),this._selection.points.push(r)}},n.prototype.onHitted=function(i){var n=i.x-this._center().x,r=i.y-this._center().y,o=n*n+r*r,a=this._innerRadius()*this._innerRadius(),s=this._radius()*this._radius();if(o>=a&&o<=s){var l=90*this._sweep()/Math.PI,u=e.clampAngle(180*this._startAngle()/Math.PI+l),h=180*Math.atan2(r,n)/Math.PI,c=e.clampAngle(u-h);if(Math.abs(c)<=l){var p=new t.core.Point;return p.x=this._center().x+Math.cos(this._startAngle()+this._sweep())*this._radius(),p.y=this._center().y+Math.sin(this._startAngle()+this._sweep())*this._radius(),this._selection.points.push(p),this._selection.points.push(this._center()),new t.HitInfo(new t.core.Point(i.x,i.y),this.datapoint,null,this,[t.ElementType.Shape],this._selection)}}return null},n}(t._View);t._SunburstPointView=i}(r||(r={})),function(t){var e=function(e){function i(i){var n=e.call(this)||this;return n.__model=i,n.datapoint=i,n.label="",n.labelrect=new t.core.Rect(0,0,0,0),n.hidelabel=!1,n.title="",n.istitle=!1,n.titlerect=new t.core.Rect(0,0,0,0),n.titlestyle=new t.options._StyleOption({}),n}return s(i,e),i.prototype._selected=function(t){if(void 0===t)return this._model().isSelected;1==t?this._model()._select():this._model()._unselect()},i.prototype._model=function(){return this.__model},i.prototype._render=function(e){if(this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible){var i=this._model()._root();if(null!=i){if(e.beginTransform(),this._applyStyle(e,this._model().style),null==e.fill||"none"==e.fill){var n=this._model();n instanceof t.models._HierarchicalPointData&&t._applyStyle(e,{fill:n._top().color})}null==e.fill&&t._applyStyle(e,{fill:i.parent.parent.parent._colorProvider().getColor(0)}),this._model().isSelected?this._applyStyle(e,i.parent.parent.parent._option().selectedStyle):this._applyStyle(e,i.parent.parent.parent._option().unselectedStyle),this._hovered?(this._scale=1.05,this._applyStyle(e,i.parent._option().config.hoverStyle)):this._scale=1;var r=t._Util.scale(t.core.cloneDeep(this._rect()),this._scale);e.drawRect(r.left,r.top,r.width,r.height),!this.hidelabel&&this.label&&(e.beginTransform(),t._applyStyle(e,i.parent._option().config.textStyle),t._applyStyle(e,i.parent._option().config.text.style),t._applyStyle(e,i.parent._option().config.text.textStyle),e.drawString(this.label,new t.core.Point(this.labelrect.left,this.labelrect.top),t.__Constant_Core_Label_ClassName),e.restoreTransform()),this.title&&(e.beginTransform(),t._applyStyle(e,i.parent._option().config.textStyle),t._applyStyle(e,i.parent._option().config.text.style),t._applyStyle(e,i.parent._option().config.text.textStyle),e.drawString(this.title,new t.core.Point(this.titlerect.left,this.titlerect.top+this.titlerect.height),t.__Constant_Core_Label_ClassName),e.restoreTransform()),e.restoreTransform()}}},i.prototype._applyStyle=function(t,e){null!=e&&(null!=e.opacity&&(t.opacity=e.opacity),null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeDasharray&&(t.strokeDasharray=e.strokeDasharray))},i}(t._View);t._TreeMapPointView=e}(r||(r={})),function(t){var e=function(){return function(){this.minorTickLines=[],this.hidden=!1}}();t.AxisViewModel=e}(r||(r={})),function(t){var e=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return s(i,e),i.prototype._render=function(e){this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible&&(e.beginTransform(),null!=this._model().parent.color&&(e.fill=this._model().parent.color,e.stroke=this._model().parent.color),null!=this._model().color&&(e.fill=this._model().color,e.stroke=this._model().color),this._applyStyle(e,this._model().parent.style),this._applyStyle(e,this._model().style),null!=e.fill&&"none"!=e.fill||t._applyStyle(e,{fill:this._model().parent.parent.parent.parent._colorProvider().getColor(0)}),this._model().isSelected?this._applyStyle(e,this._model().parent.parent.parent.parent._option().selectedStyle):this._applyStyle(e,this._model().parent.parent.parent.parent._option().unselectedStyle),this._hovered&&this._applyStyle(e,this._model().parent.parent._option().config.hoverStyle),e.drawRect(this._rect().left,this._rect().top,this._rect().width,this._rect().height),e.restoreTransform())},i.prototype._applyStyle=function(t,e){null!=e&&(null!=e.opacity&&(t.opacity=e.opacity),null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeDasharray&&(t.strokeDasharray=e.strokeDasharray))},i}(t._DataPointView);t._BarPointView=e}(r||(r={})),function(t){var e=function(e){function i(t,i,n){var r=e.call(this,t)||this;return r.__xs=i,r.__ys=n,r}return s(i,e),i.prototype._xs=function(){return this.__xs},i.prototype._ys=function(){return this.__ys},i.prototype._render=function(e){this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible&&(e.beginTransform(),null!=this._model().parent.color&&(e.fill=this._model().parent.color),null!=this._model().color&&(e.fill=this._model().color),this._applyStyle(e,this._model().style),null!=e.fill&&"none"!=e.fill||(null!=this._model().parent.style.fill?t._applyStyle(e,{fill:this._model().parent.style.fill}):t._applyStyle(e,{fill:this._model().parent.parent.parent.parent._colorProvider().getColor(0)})),this._model().isSelected?this._applyStyle(e,this._model().parent.parent.parent.parent._option().selectedStyle):this._applyStyle(e,this._model().parent.parent.parent.parent._option().unselectedStyle),this._hovered&&this._applyStyle(e,this._model().parent.parent._option().config.hoverStyle),e.drawPolygon(this.__xs,this.__ys),e.restoreTransform())},i.prototype._applyStyle=function(t,e){null!=e&&(null!=e.opacity&&(t.opacity=e.opacity),null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeDasharray&&(t.strokeDasharray=e.strokeDasharray))},i.prototype.onHitted=function(e){return t._Util.IsPointInPolygon2(new t.core.Point(e.x,e.y),this._xs(),this._ys())?new t.HitInfo(new t.core.Point(e.x,e.y),this.datapoint,null,this,[t.ElementType.Shape],this._selection):null},i.prototype.refresh=function(){e.prototype.refresh.call(this),this._selection.points=[],this._xs().length>=4&&this._ys().length>=4&&(this._selection.points.push(new t.core.Point(this._xs()[0],this._ys()[0])),this._selection.points.push(new t.core.Point(this._xs()[Math.floor(.33*(this._xs().length-1))],this._ys()[Math.floor(.33*(this._ys().length-1))])),this._selection.points.push(new t.core.Point(this._xs()[Math.floor(.66*(this._xs().length-1))],this._ys()[Math.floor(.66*(this._ys().length-1))])),this._selection.points.push(new t.core.Point(this._xs()[this._xs().length-1],this._ys()[this._ys().length-1])))},i}(t._DataPointView);t._FunnelPointView=e}(r||(r={})),function(t){var e=function(){function t(){}return t.clampAngle=function(t){var e=(t+180)%360-180;return e<-180&&(e+=360),e},t.isRectOverlap=function(t,e){return!(!t||!e)&&!(t.left>e.right||t.top>e.bottom||e.left>t.right||e.top>t.bottom)},t}(),i=function(i){function n(t,e,n,r,o,a){var s=i.call(this,t)||this;return s.__center=e,s.__radius=n,s.__innerRadius=r,s.__startAngle=o,s.__sweep=a,s}return s(n,i),n.prototype._center=function(){return this.__center},n.prototype._radius=function(){return this.__radius},n.prototype._innerRadius=function(){return this.__innerRadius},n.prototype._startAngle=function(){return this.__startAngle},n.prototype._sweep=function(){return this.__sweep},n.prototype._render=function(e){this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible&&(e.beginTransform(),null!=this._model().parent.color&&(e.fill=this._model().parent.color,e.stroke=this._model().parent.color),null!=this._model().color&&(e.fill=this._model().color,e.stroke=this._model().color),this._applyStyle(e,this._model().style),null!=e.fill&&"none"!=e.fill||(null!=this._model().parent.style.fill?t._applyStyle(e,{fill:this._model().parent.style.fill}):t._applyStyle(e,{fill:this._model().parent.parent.parent.parent._colorProvider().getColor(0)})),this._model().isSelected?this._applyStyle(e,this._model().parent.parent.parent.parent._option().selectedStyle):this._applyStyle(e,this._model().parent.parent.parent.parent._option().unselectedStyle),this._hovered&&this._applyStyle(e,this._model().parent.parent._option().config.hoverStyle),e.drawDonutSegment(this._center().x,this._center().y,this._radius()*((this._scale-1)/2+1),this._innerRadius()*(1-(this._scale-1)/2),this._startAngle(),this._sweep()),e.restoreTransform())},n.prototype._applyStyle=function(t,e){null!=e&&(null!=e.opacity&&(t.opacity=e.opacity),null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeDasharray&&(t.strokeDasharray=e.strokeDasharray))},n.prototype.refresh=function(){i.prototype.refresh.call(this),this._selection.points=[];var e=this._sweep();0==e&&(e=1);for(var n=this._startAngle();n<=this._startAngle()+this._sweep();n+=e){var r;(r=new t.core.Point).x=this._center().x+Math.cos(n)*this._radius(),r.y=this._center().y+Math.sin(n)*this._radius(),this._selection.points.push(r)}0===this.__innerRadius&&((r=new t.core.Point).x=this.__center.x,r.y=this.__center.y,this._selection.points.push(r))},n.prototype.onHitted=function(i){var n=i.x-this._center().x,r=i.y-this._center().y,o=n*n+r*r,a=this._innerRadius()*this._innerRadius(),s=this._radius()*this._radius();if(o>=a&&o<=s){var l=90*this._sweep()/Math.PI,u=e.clampAngle(180*this._startAngle()/Math.PI+l),h=180*Math.atan2(r,n)/Math.PI,c=e.clampAngle(u-h);if(Math.abs(c)<=l){var p=new t.core.Point;return p.x=this._center().x+Math.cos(this._startAngle()+this._sweep())*this._radius(),p.y=this._center().y+Math.sin(this._startAngle()+this._sweep())*this._radius(),this._selection.points.push(p),this._selection.points.push(this._center()),new t.HitInfo(new t.core.Point(i.x,i.y),this.datapoint,null,this,[t.ElementType.Shape],this._selection)}}return null},n}(t._DataPointView);t._RadialBarPointView=i}(r||(r={})),function(t){var e=function(e){function i(i,n){var r=e.call(this,i)||this;return r.label="",r.labelrect=new t.core.Rect(0,0,0,0),r.hidelabel=!0,r.symbol=n,r}return s(i,e),i.prototype._render=function(e){if(this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible){e.beginTransform(),null!=this._model().parent.color&&(e.fill=this._model().parent.color),null!=this._model().color&&(e.fill=this._model().color),this._applyStyle(e,this._model().parent.style),this._applyStyle(e,this._model().style),null!=e.fill&&"none"!=e.fill||t._applyStyle(e,{fill:this._model().parent.parent.parent.parent._colorProvider().getColor(0)}),this._model().isSelected?this._applyStyle(e,this._model().parent.parent.parent.parent._option().selectedStyle):this._applyStyle(e,this._model().parent.parent.parent.parent._option().unselectedStyle),this._scale=1;var i=this._rect();this._hovered&&(this._applyStyle(e,this._model().parent.parent._option().config.hoverStyle),i=t._Util.scale(t.core.cloneDeep(this._rect()),this._scale)),this.symbol.render(e,i,{fill:e.fill,stroke:e.stroke,strokeWidth:e.strokeWidth,strokeDasharray:e.strokeDasharray}),!this.hidelabel&&this.label&&e.drawString(this.label,new t.core.Point(this.labelrect.left,this.labelrect.top),t.__Constant_Core_Label_ClassName,this.labelstyle),e.restoreTransform()}},i.prototype._applyStyle=function(t,e){null!=e&&(null!=e.symbolOpacity&&(t.opacity=e.symbolOpacity),null!=e.symbolFill&&(t.fill=e.symbolFill),null!=e.symbolStroke&&(t.stroke=e.symbolStroke),null!=e.symbolStrokeWidth&&(t.strokeWidth=e.symbolStrokeWidth),null!=e.symbolStrokeDasharray&&(t.strokeDasharray=e.symbolStrokeDasharray))},i}(t._DataPointView);t._SymbolPointView=e}(r||(r={})),function(t){var e=function(){return function(){this.minorTickLines=[],this.hidden=!1}}();t.RadialAxisViewModel=e}(r||(r={})),function(t){!function(e){e.registerAdornerRender("dot",new e._DotAdornerRenderPlugin),e.registerConditionalFormattingRule("DataPoint",new e._DataPointConditionalFormattingRulePlugin),e.registerConditionalFormattingRule("Group",new e._GroupConditionalFormattingRulePlugin),e.registerDataContentProvider("Default",new e._DataContentProviderPlugin),e.registerDateParser("Default",new e._DateParserPlugin),e.registerRenderEngine("SVG",new e._SvgRenderEnginePlugin),e.registerRenderEngine("Canvas",new e._CanvasRenderEnginePlugin),e.registerStringFormatting("Default",new e._StringFormattingPlugin),e.registerSymbol("dot",new e._DotSymbolPlugin),e.registerSymbol("box",new e._BoxSymbolPlugin),e.registerSymbol("diamond",new e._DiamondSymbolPlugin),e.registerSymbol("triangle",new e._TriangleSymbolPlugin),e.registerSymbol("x",new e._XSymbolPlugin),e.registerSymbol("dash",new e._DashSymbolPlugin),e.registerSymbol("plus",new e._PlusSymbolPlugin),t._registerDataGraph("Bar",new t._BarGraphPlugin),t._registerDataGraph("TreeMap",new t._TreeMapPlugin),t._registerDataGraph("Sunburst",new t._SunburstPlugin),t._registerDataGraph("Line",new t._LineGraphPlugin),t._registerDataGraph("Area",new t._AreaGraphPlugin),t._registerDataGraph("Scatter",new t._ScatterGraphPlugin)}(t.plugins||(t.plugins={}))}(r||(r={})),e.exports=r},function(t,e,i){"use strict";!function(){var e=i(0);e.ST_TextStrikeType={noStrike:0,sngStrike:1,dblStrike:2},e.ST_LineCap={rnd:0,sq:1,flat:2},e.ST_BlipCompression={email:0,screen:1,print:2,hqprint:3,none:4},e.ST_PathShadeType={shape:0,circle:1,rect:2},e.ST_PresetMaterialType={legacyMatte:0,legacyPlastic:1,legacyMetal:2,legacyWireframe:3,matte:4,plastic:5,metal:6,warmMatte:7,translucentPowder:8,powder:9,dkEdge:10,softEdge:11,clear:12,flat:13,softmetal:14},e.ST_Orientation={maxMin:0,minMax:1},e.ST_CrossBetween={between:0,midCat:1},e.AnchorType={TwoCellAnchor:0,OneCellAnchor:1,AbsoluteAnchor:2,RelSizeAnchor:3,AbsSizeAnchor:4},e.ColorFillType={SolidColorFillProperties:0,PatternFillProperties:1,GradientFillProperties:2,BlipFillProperties:3,GroupFillProperties:4,NoFillProperties:5},e.CT_ChartType={CT_StockChart:0,CT_ScatterChart:1,CT_RadarChart:2,CT_BubbleChart:3,CT_AreaChart:4,CT_Area3DChart:5,CT_BarChart:6,CT_Bar3DChart:7,CT_LineChart:8,CT_Line3DChart:9,CT_PieChart:10,CT_Pie3DChart:11,CT_DoughnutChart:12,CT_OfPieChart:13,CT_SurfaceChart:14,CT_Surface3DChart:15},e.CT_AxisType={CT_CatAx:0,CT_DateAx:1,CT_SerAx:2,CT_ValAx:3},e.CT_HiddenExtensionType={CT_HiddenScene3dExtension:0,CT_HiddenFillPropertiesExtension:1,CT_HiddenLinePropertiesBaseExtension:2,CT_HiddenShape3dExtension:3,CT_OfficeArtExtension:4},e.CT_ShapeType={CT_AlternateContent:0,CT_Picture:1,CT_GraphicalObjectFrame:2,CT_GroupShape:3,CT_Connector:4,CT_Shape:5},e.ST_FontCollectionIndex={major:0,minor:1,none:2},e.ST_PresetColorVal={aliceBlue:0,antiqueWhite:1,aqua:2,aquamarine:3,azure:4,beige:5,bisque:6,black:7,blanchedAlmond:8,blue:9,blueViolet:10,brown:11,burlyWood:12,cadetBlue:13,chartreuse:14,chocolate:15,coral:16,cornflowerBlue:17,cornsilk:18,crimson:19,cyan:20,dkBlue:21,dkCyan:22,dkGoldenrod:23,dkGray:24,dkGreen:25,dkKhaki:26,dkMagenta:27,dkOliveGreen:28,dkOrange:29,dkOrchid:30,dkRed:31,dkSalmon:32,dkSeaGreen:33,dkSlateBlue:34,dkSlateGray:35,dkTurquoise:36,dkViolet:37,deepPink:38,deepSkyBlue:39,dimGray:40,dodgerBlue:41,firebrick:42,floralWhite:43,forestGreen:44,fuchsia:45,gainsboro:46,ghostWhite:47,gold:48,goldenrod:49,gray:50,green:51,greenYellow:52,honeydew:53,hotPink:54,indianRed:55,indigo:56,ivory:57,khaki:58,lavender:59,lavenderBlush:60,lawnGreen:61,lemonChiffon:62,ltBlue:63,ltCoral:64,ltCyan:65,ltGoldenrodYellow:66,ltGray:67,ltGreen:68,ltPink:69,ltSalmon:70,ltSeaGreen:71,ltSkyBlue:72,ltSlateGray:73,ltSteelBlue:74,ltYellow:75,lime:76,limeGreen:77,linen:78,magenta:79,maroon:80,medAquamarine:81,medBlue:82,medOrchid:83,medPurple:84,medSeaGreen:85,medSlateBlue:86,medSpringGreen:87,medTurquoise:88,medVioletRed:89,midnightBlue:90,mintCream:91,mistyRose:92,moccasin:93,navajoWhite:94,navy:95,oldLace:96,olive:97,oliveDrab:98,orange:99,orangeRed:100,orchid:101,paleGoldenrod:102,paleGreen:103,paleTurquoise:104,paleVioletRed:105,papayaWhip:106,peachPuff:107,peru:108,pink:109,plum:110,powderBlue:111,purple:112,red:113,rosyBrown:114,royalBlue:115,saddleBrown:116,salmon:117,sandyBrown:118,seaGreen:119,seaShell:120,sienna:121,silver:122,skyBlue:123,slateBlue:124,slateGray:125,snow:126,springGreen:127,steelBlue:128,tan:129,teal:130,thistle:131,tomato:132,turquoise:133,violet:134,wheat:135,white:136,whiteSmoke:137,yellow:138,yellowGreen:139},e.ST_Grouping={percentStacked:0,standard:1,stacked:2},e.ST_ScatterStyle={none:0,line:1,lineMarker:2,marker:3,smooth:4,smoothMarker:5},e.ST_RadarStyle={standard:0,marker:1,filled:2},e.ST_BarGrouping={percentStacked:0,clustered:1,standard:2,stacked:3},e.ST_BarDir={bar:0,col:1},e.ST_OfPieType={pie:0,bar:1},e.ST_AxPos={b:0,l:1,r:2,t:3},e.ShadowEffectType={OuterShadowEffect:0,InnerShadowEffect:1,PresetShadowEffect:2},e.SeriesType={BarSer:0,AreaSer:1,LineSer:2,PieSer:3,RadarSer:4,ScatterSer:5,BubbleSer:6,SurfaceSer:7},e.ExtDataType={InvertSolidFillFmt:0,SeriesDataLabelsRange:1},e.TextParagraphElementType={RegularTextRun:0,TextLineBreak:1,TextField:2},e.StyleDataFlag={None:0,Font:1,Fill:2,Border:4,Alignment:8,Protection:16,FormatCode:32,All:63},e.ColorSchemeIndex={None:-4142,LT1:0,DK1:1,LT2:2,DK2:3,Accent1:4,Accent2:5,Accent3:6,Accent4:7,Accent5:8,Accent6:9,Accent7:10,Accent8:11,Accent9:12,Accent10:13,Accent11:14,Accent12:15,Hlink:16,FolHlink:17},e.ThemeFont={None:0,Major:1,Minor:2},e.DisplayBlanksAs={Interpolated:0,NotPlotted:1,Zero:2},e.ReferenceKind={Empty:0,Row:1,Column:2,RowIsRelative:4,ColumnIsRelative:8,LastRowIsRelative:16,LastColumnIsRelative:32,Range:64,Error:128},e.DrawingType={Shape:0,Chart:1,Picture:2,Connector:3,GroupShape:4},e.TextureAlignment={TextureTopLeft:0,TextureTop:1,TextureTopRight:2,TextureLeft:3,TextureCenter:4,TextureRight:5,TextureBottomLeft:6,TextureBottom:7,TextureBottomRight:8},e.TextureType={TextureTypeNone:0,TexturePreset:1,TextureUserDefined:2},e.FillType={FillSolid:0,FillPatterned:1,FillGradient:2,FillTextured:3,FillBackground:4,FillPicture:5,FillGroup:6},e.PresetGradientType={GradientEarlySunset:0,GradientLateSunset:1,GradientNightfall:2,GradientDaybreak:3,GradientHorizon:4,GradientDesert:5,GradientOcean:6,GradientCalmWater:7,GradientFire:8,GradientFog:9,GradientMoss:10,GradientPeacock:11,GradientWheat:12,GradientParchment:13,GradientMahogany:14,GradientRainbow:15,GradientRainbowII:16,GradientGold:17,GradientGoldII:18,GradientBrass:19,GradientChrome:20,GradientChromeII:21,GradientSilver:22,GradientSapphire:23},e.PresetTexture={TexturePapyrus:0,TextureCanvas:1,TextureDenim:2,TextureWovenMat:3,TextureWaterDroplets:4,TexturePaperBag:5,TextureFishFossil:6,TextureSand:7,TextureGreenMarble:8,TextureWhiteMarble:9,TextureBrownMarble:10,TextureGranite:11,TextureNewsprint:12,TextureRecycledPaper:13,TextureParchment:14,TextureStationery:15,TextureBlueTissuePaper:16,TexturePinkTissuePaper:17,TexturePurpleMesh:18,TextureBouquet:19,TextureCork:20,TextureWalnut:21,TextureOak:22,TextureMediumWood:23},e.GradientColorType={GradientColorNone:0,GradientOneColor:1,GradientTwoColors:2,GradientPresetColors:3,GradientMultiColor:4},e.PatternType={PatternNone:0,Pattern5Percent:1,Pattern10Percent:2,Pattern20Percent:3,Pattern25Percent:4,Pattern30Percent:5,Pattern40Percent:6,Pattern50Percent:7,Pattern60Percent:8,Pattern70Percent:9,Pattern75Percent:10,Pattern80Percent:11,Pattern90Percent:12,PatternDarkHorizontal:13,PatternDarkVertical:14,PatternDarkDownwardDiagonal:15,PatternDarkUpwardDiagonal:16,PatternSmallCheckerBoard:17,PatternTrellis:18,PatternLightHorizontal:19,PatternLightVertical:20,PatternLightDownwardDiagonal:21,PatternLightUpwardDiagonal:22,PatternSmallGrid:23,PatternDottedDiamond:24,PatternWideDownwardDiagonal:25,PatternWideUpwardDiagonal:26,PatternDashedUpwardDiagonal:27,PatternDashedDownwardDiagonal:28,PatternNarrowVertical:29,PatternNarrowHorizontal:30,PatternDashedVertical:31,PatternDashedHorizontal:32,PatternLargeConfetti:33,PatternLargeGrid:34,PatternHorizontalBrick:35,PatternLargeCheckerBoard:36,PatternSmallConfetti:37,PatternZigZag:38,PatternSolidDiamond:39,PatternDiagonalBrick:40,PatternOutlinedDiamond:41,PatternPlaid:42,PatternSphere:43,PatternWeave:44,PatternDottedGrid:45,PatternDivot:46,PatternShingle:47,PatternWave:48,PatternHorizontal:49,PatternVertical:50,PatternCross:51,PatternDownwardDiagonal:52,PatternUpwardDiagonal:53,PatternDiagonalCross:54},e.GradientStyle={GradientHorizontal:0,GradientVertical:1,GradientDiagonalUp:2,GradientDiagonalDown:3,GradientFromCorner:4,GradientFromTitle:5,GradientFromCenter:6},e.AutoShapeType={ShapeNone:0,ShapeRectangle:1,ShapeParallelogram:2,ShapeTrapezoid:3,ShapeDiamond:4,ShapeRoundedRectangle:5,ShapeOctagon:6,ShapeIsoscelesTriangle:7,ShapeRightTriangle:8,ShapeOval:9,ShapeHexagon:10,ShapeCross:11,ShapeRegularPentagon:12,ShapeCan:13,ShapeCube:14,ShapeBevel:15,ShapeFoldedCorner:16,ShapeSmileyFace:17,ShapeDonut:18,ShapeNoSymbol:19,ShapeBlockArc:20,ShapeHeart:21,ShapeLightningBolt:22,ShapeSun:23,ShapeMoon:24,ShapeArc:25,ShapeDoubleBracket:26,ShapeDoubleBrace:27,ShapePlaque:28,ShapeLeftBracket:29,ShapeRightBracket:30,ShapeLeftBrace:31,ShapeRightBrace:32,ShapeRightArrow:33,ShapeLeftArrow:34,ShapeUpArrow:35,ShapeDownArrow:36,ShapeLeftRightArrow:37,ShapeUpDownArrow:38,ShapeQuadArrow:39,ShapeLeftRightUpArrow:40,ShapeBentArrow:41,ShapeUTurnArrow:42,ShapeLeftUpArrow:43,ShapeBentUpArrow:44,ShapeCurvedRightArrow:45,ShapeCurvedLeftArrow:46,ShapeCurvedUpArrow:47,ShapeCurvedDownArrow:48,ShapeStripedRightArrow:49,ShapeNotchedRightArrow:50,ShapePentagon:51,ShapeChevron:52,ShapeRightArrowCallout:53,ShapeLeftArrowCallout:54,ShapeUpArrowCallout:55,ShapeDownArrowCallout:56,ShapeLeftRightArrowCallout:57,ShapeUpDownArrowCallout:58,ShapeQuadArrowCallout:59,ShapeCircularArrow:60,ShapeFlowchartProcess:61,ShapeFlowchartAlternateProcess:62,ShapeFlowchartDecision:63,ShapeFlowchartData:64,ShapeFlowchartPredefinedProcess:65,ShapeFlowchartInternalStorage:66,ShapeFlowchartDocument:67,ShapeFlowchartMultidocument:68,ShapeFlowchartTerminator:69,ShapeFlowchartPreparation:70,ShapeFlowchartManualInput:71,ShapeFlowchartManualOperation:72,ShapeFlowchartConnector:73,ShapeFlowchartOffpageConnector:74,ShapeFlowchartCard:75,ShapeFlowchartPunchedTape:76,ShapeFlowchartSummingJunction:77,ShapeFlowchartOr:78,ShapeFlowchartCollate:79,ShapeFlowchartSort:80,ShapeFlowchartExtract:81,ShapeFlowchartMerge:82,ShapeFlowchartStoredData:83,ShapeFlowchartDelay:84,ShapeFlowchartSequentialAccessStorage:85,ShapeFlowchartMagneticDisk:86,ShapeFlowchartDirectAccessStorage:87,ShapeFlowchartDisplay:88,ShapeExplosion1:89,ShapeExplosion2:90,Shape4pointStar:91,Shape5pointStar:92,Shape8pointStar:93,Shape16pointStar:94,Shape24pointStar:95,Shape32pointStar:96,ShapeUpRibbon:97,ShapeDownRibbon:98,ShapeCurvedUpRibbon:99,ShapeCurvedDownRibbon:100,ShapeVerticalScroll:101,ShapeHorizontalScroll:102,ShapeWave:103,ShapeDoubleWave:104,ShapeRectangularCallout:105,ShapeRoundedRectangularCallout:106,ShapeOvalCallout:107,ShapeCloudCallout:108,ShapeLineCallout1:109,ShapeLineCallout2:110,ShapeLineCallout3:111,ShapeLineCallout4:112,ShapeLineCallout1AccentBar:113,ShapeLineCallout2AccentBar:114,ShapeLineCallout3AccentBar:115,ShapeLineCallout4AccentBar:116,ShapeLineCallout1NoBorder:117,ShapeLineCallout2NoBorder:118,ShapeLineCallout3NoBorder:119,ShapeLineCallout4NoBorder:120,ShapeLineCallout1BorderandAccentBar:121,ShapeLineCallout2BorderandAccentBar:122,ShapeLineCallout3BorderandAccentBar:123,ShapeLineCallout4BorderandAccentBar:124,ShapeActionButtonCustom:125,ShapeActionButtonHome:126,ShapeActionButtonHelp:127,ShapeActionButtonInformation:128,ShapeActionButtonBackorPrevious:129,ShapeActionButtonForwardorNext:130,ShapeActionButtonBeginning:131,ShapeActionButtonEnd:132,ShapeActionButtonReturn:133,ShapeActionButtonDocument:134,ShapeActionButtonSound:135,ShapeActionButtonMovie:136,ShapeBalloon:137,ShapeFlowchartOfflineStorage:138,ShapeLeftRightRibbon:139,ShapeDiagonalStripe:140,ShapePie:141,ShapeNonIsoscelesTrapezoid:142,ShapeDecagon:143,ShapeHeptagon:144,ShapeDodecagon:145,Shape6pointStar:146,Shape7pointStar:147,Shape10pointStar:148,Shape12pointStar:149,ShapeRound1Rectangle:150,ShapeRound2SameRectangle:151,ShapeRound2DiagRectangle:152,ShapeSnipRoundRectangle:153,ShapeSnip1Rectangle:154,ShapeSnip2SameRectangle:155,ShapeSnip2DiagRectangle:156,ShapeFrame:157,ShapeHalfFrame:158,ShapeTear:159,ShapeChord:160,ShapeCorner:161,ShapeMathPlus:162,ShapeMathMinus:163,ShapeMathMultiply:164,ShapeMathDivide:165,ShapeMathEqual:166,ShapeMathNotEqual:167,ShapeCornerTabs:168,ShapeSquareTabs:169,ShapePlaqueTabs:170,ShapeGear6:171,ShapeGear9:172,ShapeFunnel:173,ShapePieWedge:174,ShapeLeftCircularArrow:175,ShapeLeftRightCircularArrow:176,ShapeSwooshArrow:177,ShapeCloud:178,ShapeChartX:179,ShapeChartStar:180,ShapeChartPlus:181,ShapeLineInverse:182},e.ArrowheadLength={ArrowheadShort:0,ArrowheadLengthMedium:1,ArrowheadLong:2},e.ArrowheadStyle={ArrowheadNone:0,ArrowheadTriangle:1,ArrowheadStealth:2,ArrowheadDiamond:3,ArrowheadOval:4,ArrowheadOpen:5},e.ArrowheadWidth={ArrowheadNarrow:0,ArrowheadWidthMedium:1,ArrowheadWide:2},e.LineDashStyle={LineSolid:0,LineSquareDot:1,LineDash:2,LineLongDash:3,LineDashDot:4,LineLongDashDot:5,LineLongDashDotDot:6,LineSysDash:7,LineSysDot:8,LineSysDashDot:9,LineDashDotDot:10,LineRoundDot:11},e.LineStyle={LineSingle:0,LineThinThin:1,LineThinThick:2,LineThickThin:3,LineThickBetweenThin:4},e.PictureColorType={PictureAutomatic:0,PictureGrayscale:1,PictureBlackAndWhite:2,PictureWatermark:3},e.ShadowType={Shadow1:0,Shadow2:1,Shadow3:2,Shadow4:3,Shadow5:4,Shadow6:5,Shadow7:6,Shadow8:7,Shadow9:8,Shadow10:9,Shadow11:10,Shadow12:11,Shadow13:12,Shadow14:13,Shadow15:14,Shadow16:15,Shadow17:16,Shadow18:17,Shadow19:18,Shadow20:19,Shadow21:20,Shadow22:21,Shadow23:22,Shadow24:23,Shadow25:24,Shadow26:25,Shadow27:26,Shadow28:27,Shadow29:28,Shadow30:29,Shadow31:30,Shadow32:31,Shadow33:32,Shadow34:33,Shadow35:34,Shadow36:35,Shadow37:36,Shadow38:37,Shadow39:38,Shadow40:39,Shadow41:40,Shadow42:41,Shadow43:42},e.ShadowStyle={ShadowStyleInnerShadow:0,ShadowStyleOuterShadow:1},e.SoftEdgeType={SoftEdgeTypeNone:0,SoftEdgeType1:1,SoftEdgeType2:2,SoftEdgeType3:3,SoftEdgeType4:4,SoftEdgeType5:5,SoftEdgeType6:6},e.PresetCamera={CameraLegacyObliqueTopLeft:0,CameraLegacyObliqueTop:1,CameraLegacyObliqueTopRight:2,CameraLegacyObliqueLeft:3,CameraLegacyObliqueFront:4,CameraLegacyObliqueRight:5,CameraLegacyObliqueBottomLeft:6,CameraLegacyObliqueBottom:7,CameraLegacyObliqueBottomRight:8,CameraLegacyPerspectiveTopLeft:9,CameraLegacyPerspectiveTop:10,CameraLegacyPerspectiveTopRight:11,CameraLegacyPerspectiveLeft:12,CameraLegacyPerspectiveFront:13,CameraLegacyPerspectiveRight:14,CameraLegacyPerspectiveBottomLeft:15,CameraLegacyPerspectiveBottom:16,CameraLegacyPerspectiveBottomRight:17,CameraOrthographicFront:18,CameraIsometricTopUp:19,CameraIsometricTopDown:20,CameraIsometricBottomUp:21,CameraIsometricBottomDown:22,CameraIsometricLeftUp:23,CameraIsometricLeftDown:24,CameraIsometricRightUp:25,CameraIsometricRightDown:26,CameraIsometricOffAxis1Left:27,CameraIsometricOffAxis1Right:28,CameraIsometricOffAxis1Top:29,CameraIsometricOffAxis2Left:30,CameraIsometricOffAxis2Right:31,CameraIsometricOffAxis2Top:32,CameraIsometricOffAxis3Left:33,CameraIsometricOffAxis3Right:34,CameraIsometricOffAxis3Bottom:35,CameraIsometricOffAxis4Left:36,CameraIsometricOffAxis4Right:37,CameraIsometricOffAxis4Bottom:38,CameraObliqueTopLeft:39,CameraObliqueTop:40,CameraObliqueTopRight:41,CameraObliqueLeft:42,CameraObliqueRight:43,CameraObliqueBottomLeft:44,CameraObliqueBottom:45,CameraObliqueBottomRight:46,CameraPerspectiveFront:47,CameraPerspectiveLeft:48,CameraPerspectiveRight:49,CameraPerspectiveAbove:50,CameraPerspectiveBelow:51,CameraPerspectiveAboveLeftFacing:52,CameraPerspectiveAboveRightFacing:53,CameraPerspectiveContrastingLeftFacing:54,CameraPerspectiveContrastingRightFacing:55,CameraPerspectiveHeroicLeftFacing:56,CameraPerspectiveHeroicRightFacing:57,CameraPerspectiveHeroicExtremeLeftFacing:58,CameraPerspectiveHeroicExtremeRightFacing:59,CameraPerspectiveRelaxed:60,CameraPerspectiveRelaxedModerately:61,PresetCameraNone:62},e.PresetLightingDirection={LightingTopLeft:0,LightingTop:1,LightingTopRight:2,LightingLeft:3,LightingNone:4,LightingRight:5,LightingBottomLeft:6,LightingBottom:7,LightingBottomRight:8},e.LightRigType={LightRigLegacyFlat1:0,LightRigLegacyFlat2:1,LightRigLegacyFlat3:2,LightRigLegacyFlat4:3,LightRigLegacyNormal1:4,LightRigLegacyNormal2:5,LightRigLegacyNormal3:6,LightRigLegacyNormal4:7,LightRigLegacyHarsh1:8,LightRigLegacyHarsh2:9,LightRigLegacyHarsh3:10,LightRigLegacyHarsh4:11,LightRigThreePoint:12,LightRigBalanced:13,LightRigSoft:14,LightRigHarsh:15,LightRigFlood:16,LightRigContrasting:17,LightRigMorning:18,LightRigSunrise:19,LightRigSunset:20,LightRigChilly:21,LightRigFreezing:22,LightRigFlat:23,LightRigTwoPoint:24,LightRigGlow:25,LightRigBrightRoom:26},e.AxisType={Category:0,Value:1,SeriesAxis:2},e.TickLabelPosition={high:0,low:1,nextToAxis:2,none:3},e.ScaleType={ScaleLogarithmic:0,ScaleLinear:1},e.TimeUnit={Days:0,Months:1,Years:2},e.TickMark={cross:0,inside:1,none:2,outside:3},e.DisplayUnit={Hundreds:0,Thousands:1,TenThousands:2,HundredThousands:3,Millions:4,TenMillions:5,HundredMillions:6,ThousandMillions:7,MillionMillions:8,None:9,Custom:10},e.AxisCrosses={AxisCrossesCustom:0,AxisCrossesAutomatic:1,AxisCrossesMaximum:2,AxisCrossesMinimum:3},e.CategoryType={AutomaticScale:0,CategoryScale:1,TimeScale:2,ValueScale:3},e.AxisGroup={primary:0,secondary:1},e.BarShape={ConeToPoint:0,ConeToMax:1,Box:2,Cylinder:3,PyramidToPoint:4,PyramidToMax:5},e.ChartType={combo:0,xyScatter:1,radar:2,doughnut:3,pie3D:4,line3D:5,column3D:6,area3D:7,area:8,line:9,pie:10,bubble:11,columnClustered:12,columnStacked:13,columnStacked100:14,columnClustered3D:15,columnStacked3D:16,columnStacked1003D:17,barClustered:18,barStacked:19,barStacked100:20,barClustered3D:21,barStacked3D:22,barStacked1003D:23,lineStacked:24,lineStacked100:25,lineMarkers:26,lineMarkersStacked:27,lineMarkersStacked100:28,pieOfPie:29,pieExploded:30,pieExploded3D:31,barOfPie:32,xyScatterSmooth:33,xyScatterSmoothNoMarkers:34,xyScatterLines:35,xyScatterLinesNoMarkers:36,areaStacked:37,areaStacked100:38,areaStacked3D:39,areaStacked1003D:40,doughnutExploded:41,radarMarkers:42,radarFilled:43,surface:44,surfaceWireframe:45,surfaceTopView:46,surfaceTopViewWireframe:47,bubble3DEffect:48,stockHLC:49,stockOHLC:50,stockVHLC:51,stockVOHLC:52},e.TrendlineType={Exponential:0,Linear:1,Logarithmic:2,MovingAvg:3,Polynomial:4,Power:5},e.DataLabelPosition={bestFit:0,below:1,center:2,insideBase:3,insideEnd:4,left:5,outsideEnd:6,right:7,above:8},e.MarkerStyle={MarkerStyleCircle:0,MarkerStyleDash:1,MarkerStyleDiamond:2,MarkerStyleDot:3,MarkerStyleNone:4,MarkerStylePicture:5,MarkerStylePlus:6,MarkerStyleSquare:7,MarkerStyleStar:8,MarkerStyleTriangle:9,MarkerStyleX:10,MarkerStyleAutomatic:11},e.DrawingPictureType={Stretch:0,Stack:1,StackScale:2},e.SizeRepresents={SizeIsArea:0,SizeIsWidth:1},e.ChartSplitType={SplitByPosition:0,SplitByValue:1,SplitByPercentValue:2,SplitByCustomSplit:3},e.LegendPosition={custom:0,top:1,right:2,left:3,bottom:4,corner:5},e.RowCol={rows:0,columns:1},e.ShapeType={AutoShape:0,Chart:1,Comment:2,Group:3,Picture:4,Slicer:5},e.Placement={MoveAndSize:0,Move:1,FreeFloating:2},e.ChartElements={All:0,Chart:1,PlotArea:2,Series:3,SeriesCollection:4,Point:5,DataLabel:6,DataMarker:7,CategoryAxis:8,ValueAxis:9,SeriesAxis:10,Lengend:11,FloorWall:12,SideWall:13,BackWall:14,ChartTitle:15,AxisTitle:16,ChartGroup:17},e.ImageType={PNG:0,JPG:1,JPEG:2,EMF:3},e.SolidColorType={None:0,Automatic:1,RGB:2,Theme:3},e.TextUnderlineType={None:0,Words:1,Single:2,Double:3,Heavy:4,Dotted:5,DottedHeavy:6,Dash:7,DashHeavy:8,DashLong:9,DashLongHeavy:10,DotDash:11,DotDashHeavy:12,DotDotDash:13,DotDotDashHeavy:14,Wavy:15,WavyHeavy:16,WavyDouble:17},e.ReflectionType={ReflectionTypeNone:0,ReflectionType1:1,ReflectionType2:2,ReflectionType3:3,ReflectionType4:4,ReflectionType5:5,ReflectionType6:6,ReflectionType7:7,ReflectionType8:8,ReflectionType9:9},t.exports=e}()},function(t,e,i){"use strict";!function(){var e=i(2)._Types._inherit,n=i(0),r=i(4).StatefullBase,o=i(1),a=o.ShapeConstants,s=a.PositiveFixedPercentageConvert,l=a.PositiveFixedAngleConvert,u=a.PositionConver,h=o.ShapeUtility,c=o.ChartUtility.defineProperty,p=o.UnitHelper.isNullOrUndefined,f=i(7).ColorFormat,_=i(21).GradientStops,d=null,g=Math.floor,y=function(t){function i(e,i,r,o){t.call(this,i);return this._gradientScale=!0,this._pathShapeType=2,this._pattern=0,this._rotateWithObject=!0,this._visible=!0,this._ooFill=d,this._context=e,this._type=0,this._parent=i,this._autoColorFormat=r,this._container=o,this._pictureFormat=new n.PictureFormat(1,i&&i.PictureFormat),this._pictureFormat.Container=o,this._textureHorizontalScale=1,this._textureVerticalScale=1,this._gradientStops=new _(this._context),this}e(i,t);var r=i.prototype;return c(r,"Parent",{get:function(){return this._parent}}),c(r,"PictureFormat",{get:function(){return this._pictureFormat},set:function(t){p(this._pictureFormat)||this._pictureFormat.SetParentForChildren(t);var e=this._pictureFormat;this._pictureFormat=t,p(e)||(this._pictureFormat.ParentStateful=e.ParentStateful)}}),c(r,"PatternColor",{get:function(){return this.PatternColorInternal}}),c(r,"Color",{get:function(){return this.ColorInternal}}),c(r,"GradientAngle",{get:function(){if(!this.IsDirty(2097152)&&!p(this._parent))return this._parent.GradientAngle;if(6===this.GradientStyle||4===this.GradientStyle)throw new Error;return this._gradientAngle},set:function(t){this._gradientAngle=t,this.Dirty(2097152)}}),c(r,"GradientColorType",{get:function(){return this.GetGradientColorType()}}),r.GetGradientColorType=function(){for(var t=[],e=0,i=this._gradientStops.GradientStopList;e<i.length;e++){var n=i[e];this.FindInColorStops(n.Color,t)||t.push(n.Color)}var r=t.length;return 0===r?0:1===r?1:2===r?2:4},r.FindInColorStops=function(t,e){for(var i=0,n=e;i<n.length;i++){var r=n[i],o=r.ColorType;if(o===t.ColorType)if(3===o){if(r.ObjectThemeColor===t.ObjectThemeColor&&r.TintAndShade===t.TintAndShade)return!0}else if(2===o&&r.RGB.Equals(t.RGB)&&r.TintAndShade===t.TintAndShade)return!0}return!1},c(r,"GradientDegree",{get:function(){return this.IsDirty(1048576)||p(this._parent)?this._gradientDegree:this._parent.GradientDegree}}),r._SetGradientDegree=function(t){this._gradientDegree=t,this.Dirty(1048576)},c(r,"GradientStops",{get:function(){return this.IsDirty(1)||p(this._parent)?this._gradientStops:this._parent.GradientStops}}),r._SetGradientStops=function(t){this._gradientStops=t,this.Dirty(1)},c(r,"GradientStyle",{get:function(){return this.IsDirty(2)||p(this._parent)?this._gradientStyle:this._parent.GradientStyle}}),r._SetGradientStyle=function(t){this._gradientStyle=t,this.Dirty(2)},c(r,"GradientVariant",{get:function(){return this.IsDirty(4194304)||p(this._parent)?this._gradientVariant:this._parent.GradientVariant}}),r._SetGradientVariant=function(t){this._gradientVariant=t,this.Dirty(4194304)},c(r,"Pattern",{get:function(){return this.IsDirty(8)||p(this._parent)?this._pattern:this._parent.Pattern}}),r._SetPattern=function(t){if(0===t)throw new Error("The specified value is out of range");0===this.Pattern&&this._SetType(1),this._pattern=t,this.Dirty(8)},c(r,"PresetGradientType",{get:function(){return this.IsDirty(8388608)||p(this._parent)?this._presetGradientType:this._parent.PresetGradientType}}),r._SetPresetGradientType=function(t){this._presetGradientType=t,this.Dirty(8388608)},c(r,"RotateWithObject",{get:function(){return this.IsDirty(32)||p(this._parent)?this._rotateWithObject:this._parent.RotateWithObject},set:function(t){this._rotateWithObject=t,this.Dirty(32)}}),c(r,"TextureAlignment",{get:function(){return this.IsDirty(64)||p(this._parent)?this._textureAlignment:this._parent.TextureAlignment},set:function(t){this._textureAlignment=t,this.Dirty(64)}}),c(r,"TextureHorizontalScale",{get:function(){return this.IsDirty(128)||p(this._parent)?this._textureHorizontalScale:this._parent.TextureHorizontalScale},set:function(t){this._textureHorizontalScale=t,this.Dirty(128)}}),c(r,"TextureOffsetX",{get:function(){return this.IsDirty(512)||p(this._parent)?this._textureOffsetX:this._parent.TextureOffsetX},set:function(t){this._textureOffsetX=t,this.Dirty(512)}}),c(r,"TextureOffsetY",{get:function(){return this.IsDirty(1024)||p(this._parent)?this._textureOffsetY:this._parent.TextureOffsetY},set:function(t){this._textureOffsetY=t,this.Dirty(1024)}}),c(r,"TextureVerticalScale",{get:function(){return this.IsDirty(8192)||p(this._parent)?this._textureVerticalScale:this._parent.TextureVerticalScale},set:function(t){this._textureVerticalScale=t,this.Dirty(8192)}}),c(r,"Transparency",{get:function(){return this.IsDirty(16384)||p(this._parent)?this.ColorInternal.Transparency:this._parent.Transparency},set:function(t){this.ColorInternal.Transparency=t,this.Dirty(16384)}}),c(r,"Type",{get:function(){return this.IsDirty(32768)||p(this._parent)?this._type:this._parent.Type}}),r._SetType=function(t){this._type=t,this.Dirty(32768)},c(r,"Visible",{get:function(){return this.IsDirty(65536)||p(this._parent)?this._visible:this._parent.Visible},set:function(t){this._visible=t,this.Dirty(65536)}}),r.InitGradientInfo=function(t,e,i){if(5===t)throw new Error("The specified value is out of range");this._SetGradientStyle(t),this._SetGradientVariant(e),this._SetType(2),this._SetPresetGradientType(i)},r.OneColorGradient=function(t,e,i){if(i<0||i>1)throw new Error("The specified value is out of range");this.InitGradientInfo(t,e,0),this._SetGradientDegree(i),h.InitGradientStops(this._context,this,1)},r.TwoColorGradient=function(t,e){this.InitGradientInfo(t,e,0),h.InitGradientStops(this._context,this,2)},r.PresetGradient=function(t,e,i){this.InitGradientInfo(t,e,i),h.InitGradientStops(this._context,this,3)},r.Patterned=function(t){this.SetPatternColor(),this._SetType(1),this._SetPattern(t)},r.SetPatternColor=function(){this.Color.ObjectThemeColor=0,this.PatternColor.ObjectThemeColor=4,this.Color.ClearModel(),this.PatternColor.ClearModel()},r.Solid=function(){this._SetType(0),p(this._color)||this._color.ClearModel()},c(r,"ColorInternal",{get:function(){return p(this._color)&&(this._color=new f(this._context,p(this._parent)?d:this._parent.Color),this._color.AutoColorFormat=this._autoColorFormat),this._color}}),c(r,"PatternColorInternal",{get:function(){return p(this._patternColor)&&(this._patternColor=new f(this._context,p(this._parent)?d:this._parent.PatternColor)),this._patternColor}}),c(r,"PresetTexture",{get:function(){return this.IsDirty(16)||p(this._parent)?this._presetTexture:this._parent.PresetTexture},set:function(t){this._presetTexture=t,this.Dirty(16)}}),r.ClearColor=function(){this._color=d},r.GetState=function(e,i){return void 0===i&&(i=!1),131072!==e||p(this._color)?262144!==e||p(this._patternColor)?t.prototype.GetState.call(this,e,i):this._patternColor.IsDirtyIncludingParent(i):this._color.IsDirtyIncludingParent(i)},r.IsDirtyIncludingParent=function(e){return void 0===e&&(e=!1),!(p(this._patternColor)||!this._patternColor.IsDirtyIncludingParent())||(!(p(this._color)||!this._color.IsDirtyIncludingParent())||(!p(this._gradientStops)&&this._gradientStops.Count>0||(!(p(this._pictureFormat)||!this._pictureFormat.IsDirtyIncludingParent())||t.prototype.IsDirtyIncludingParent.call(this,e))))},r.OnParentChanged=function(t){this._parent=t,p(this._parent)?(p(this._color)||(this._color.ParentStateful=d),p(this._patternColor)||(this._patternColor.ParentStateful=d)):(p(this._color)||(this._color.ParentStateful=this._parent.Color),p(this._patternColor)||(this._patternColor.ParentStateful=this._parent.PatternColor))},r.FromOOModel=function(t,e){if(p(e))throw new Error("colorFillType not provided!");this._ooFill=t,0===e?(this.ColorInternal.FromOOModel(this._ooFill),this._type=0,this.SetState(32768,!0)):1===e?(this.FromCT_PatternFillProperties(t),this._type=1,this.SetState(32768,!0)):2===e?(this.FromCT_GradientFillProperties(t),this._type=2,this.SetState(32768,!0)):3===e?(this._pictureFormat.FromOOModel(t),this._type=5,this.SetState(32768,!0)):4===e?(this._type=6,this.SetState(32768,!0)):5===e&&(this._type=0,this.SetState(32768,!0))},r.ToOOModel=function(){var t;if(this.Visible)switch(this.Type){case 0:t=this.ToCT_SolidColorFillProperties();break;case 1:t=this.ToCT_PatternFillProperties();break;case 2:t=this.ToCT_GradientFillProperties();break;case 3:t=this.ToCT_TileFillProperties();break;case 4:break;case 5:t=this.ToCT_PictureFillProperties();break;case 6:t={colorFillType:4}}else t={colorFillType:5};return t},r.FromCT_PatternFillProperties=function(t){this._SetPattern(t.prst),this.ColorInternal.FromOOModel(t.bgClr),this.PatternColorInternal.FromOOModel(t.fgClr)},r.ToCT_PatternFillProperties=function(){if(4===this._context.DrawingType)return d;var t={colorFillType:1};return t.prst=this.Pattern,0!==this.PatternColorInternal.ColorType&&(t.fgClr=this.PatternColorInternal.Color_ToOOModel()),0!==this.Color.ColorType&&(t.bgClr=this.Color.Color_ToOOModel()),t},r.FromCT_GradientFillProperties=function(t){this._SetGradientStops(new _(this._context)),this._gradientStops.FromOOModel(t.gsLst),this.RotateWithObject=t.rotWithShape,p(t.path)?p(t.lin)||(this.FromCT_LinearShadeProperties(t.lin),this.FromTitleCT_RelativeRect(t.tileRect)):this.FromCT_PathShadeProperties(t.path)},r.ToCT_GradientFillProperties=function(){var t={colorFillType:2};return t.rotWithShape=this.RotateWithObject,!p(this.GradientStops)&&this.GradientStops.Count>0&&(t.gsLst=this.GradientStops.ToOOModel()),6===this.GradientStyle||4===this.GradientStyle?t.path=this.ToCT_PathShadeProperties():t.lin=this.ToCT_LinearShadeProperties(),t.tileRect=this.ToTitleCT_RelativeRect(),t},r.ToCT_PictureFillProperties=function(){return 4===this._context.DrawingType?d:this._pictureFormat.ToOOModel()},r.FromTitleCT_RelativeRect=function(t){p(t)||(t.l===-s&&t.t===-s?this._SetGradientVariant(1):t.t===-s&&t.r===-s?this._SetGradientVariant(2):t.l===-s&&t.b===-s?this._SetGradientVariant(3):t.r===-s&&t.b===-s&&this._SetGradientVariant(4))},r.ToTitleCT_RelativeRect=function(){var t={l:0,r:0,t:0,b:0},e=this.GradientVariant;return 4===this.GradientStyle&&(1===e?(t.l=-s,t.t=-s):2===e?(t.t=-s,t.r=-s):3===e?(t.l=-s,t.b=-s):4===e&&(t.r=-s,t.b=-s)),t},r.FromCT_LinearShadeProperties=function(t){this.GradientAngle=t.ang/l,this._gradientScale=t.scaled},r.ToCT_LinearShadeProperties=function(){return{ang:g(this.GradientAngle*l),scaled:this._gradientScale}},r.FromCT_PathShadeProperties=function(t){p(t)||(this._pathShapeType=t.path,this.FromCT_RelativeRect(t.fillToRect))},r.ToCT_PathShadeProperties=function(){return{path:this._pathShapeType,fillToRect:this.ToCT_RelativeRect()}},r.FromCT_RelativeRect=function(t){if(!p(t)){var e=.5*s;t.l===e&&t.t===e&&t.r===e&&t.b===e?this._SetGradientStyle(6):t.r===s&&t.b===s?(this._SetGradientStyle(4),this._SetGradientVariant(1)):t.l===s&&t.b===s?(this._SetGradientStyle(4),this._SetGradientVariant(2)):t.r===s&&t.t===s?(this._SetGradientStyle(4),this._SetGradientVariant(3)):t.l===s&&t.t===s&&(this._SetGradientStyle(4),this._SetGradientVariant(4))}},r.ToCT_RelativeRect=function(){var t={l:0,r:0,t:0,b:0},e=.5*s;if(6===this.GradientStyle)t.l=e,t.t=e,t.r=e,t.b=e;else if(4===this.GradientStyle){var i=this.GradientVariant;1===i?(t.r=s,t.b=s):2===i?(t.l=s,t.b=s):3===i?(t.t=s,t.r=s):4===i&&(t.l=s,t.t=s)}return t},r.ToCT_SolidColorFillProperties=function(){return this.ColorInternal.ToOOModel()},r.ToCT_TileFillProperties=function(){var t=this._pictureFormat.ToOOModel();return t.tile=this.ToCT_TileInfoProperties(),t},r.ToCT_TileInfoProperties=function(){return{algn:this.TextureAlignment,tx:this.TextureOffsetX,ty:this.TextureOffsetY,sx:g(this.TextureHorizontalScale*u),sy:g(this.TextureVerticalScale*u)}},r.Clone=function(){var t=new i(this._context,this._parent,this._autoColorFormat,this._container);return p(this._patternColor)||(t._patternColor=this._patternColor.Clone()),p(this._color)||(t._color=this._color.Clone()),t._gradientDegree=this._gradientDegree,t._gradientScale=this._gradientScale,t._gradientStops=this._gradientStops,t._gradientVariant=this._gradientVariant,t._pattern=this._pattern,t._presetGradientType=this._presetGradientType,t._presetTexture=this._presetTexture,t._textureName=this._textureName,t._textureType=this._textureType,t._type=this._type,t._gradientAngle=this._gradientAngle,t._rotateWithObject=this._rotateWithObject,t._textureAlignment=this._textureAlignment,t._textureHorizontalScale=this._textureHorizontalScale,t._textureOffsetX=this._textureOffsetX,t._textureOffsetY=this._textureOffsetY,t._textureTile=this._textureTile,t._textureVerticalScale=this._textureVerticalScale,t._transparency=this._transparency,t._visible=this._visible,t._states=this._states,t._parent=this._parent,t},i}(r);n.FillFormat=y,t.exports=n}()},function(t,e,i){"use strict";!function(){var e=i(0),n=function(){function t(){}t.ConvertHexStringToInt=function(t){return parseInt(t,16)};var e=t.prototype;return e.Equals=function(t){return this.ColorType===t.ColorType&&this.Value===t.Value&&this.Tint===t.Tint},e.Clone=function(){return this},e.Compose=function(t,e){void 0===e&&(e=!0),0!==t.Flag&&(e?this.ConflictCompose(t):this.NonConflictCompose(t))},e.ConflictCompose=function(t){1==(1&t.Flag)&&this.ColorType!==t.ColorType&&(this.ColorType=t.ColorType,this.Value=0,this.Tint=0),2==(2&t.Flag)&&(this.Value=t.Value),4==(4&t.Flag)&&(this.Tint=t.Tint),this.Flag|=t.Flag},e.NonConflictCompose=function(t){1!=(1&this.Flag)&&1==(1&t.Flag)&&(this.ColorType=t.ColorType,this.Value=t.Value,this.Tint=t.Tint,this.Flag=t.Flag)},e.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},e.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},e.Compare=function(t,e){var i=!1;if(1==(1&this.Flag)){var n=1!=(1&t.Flag)||this.ColorType!==t.ColorType;if(e)if(n)this.Flag=0,i=!0;else{if(2==(2&this.Flag)){var r=2!=(2&t.Flag)||this.Value!==t.Value;r&&(this.Flag=0,i=!0)}if(4==(4&this.Flag)){var o=4!=(4&t.Flag)||this.Tint!==t.Tint;o&&(this.Flag=0,i=!0)}}else n||(2==(2&this.Flag)&&((r=2!=(2&t.Flag)||this.Value!==t.Value)||(this.Flag&=-3,i=!0)),4==(4&this.Flag)&&((o=4!=(4&t.Flag)||this.Tint!==t.Tint)||(this.Flag&=-5,i=!0)),1===this.Flag&&(this.Flag=0,i=!0))}return i},e.UpdateDefaultValueFlag=function(){0===this.ColorType?this.Flag=0:this.Flag=7},e.UpdateFlagFromBottom=function(){},e.ClearFlag=function(){this.Flag=0},e.SetFullFlag=function(){this.Flag=7},e.IsFullFlag=function(){return 7===this.Flag},t}();e.ColorData=n,e.ColorType={None:0,Auto:1,RGB:2,Index:3,Theme:4},e.ColorDataFlag={None:0,ColorType:1,Value:2,Tint:4,All:7},t.exports=e}()},function(e,i){e.exports=t.Spread.Formatter},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SR=e.sR=void 0;var n=a(i(2)),r=a(i(19)),o=a(i(20));function a(t){return t&&t.__esModule?t:{default:t}}var s={};s.en=r.default,s.zh=o.default;var l=function(){return n.default._getResource(s)()};e.sR=l,e.SR=s,e.default=l},function(t,e,i){"use strict";!function(){var e=i(0),n=i(3).GC$.inherit,r=i(1),o=r.UnitHelper,a=o.isNullOrUndefined,s=r.ChartUtility,l=r.ChartConstants,u=r.AxisUtility,h=r.DateTimeExtension,c=r.ChartElementBase,p=s.defineProperty,f=i(5).ChartFormat,_=i(7).ColorFormat,d=i(6),g=d.DrawingText,y=d.ChartTitleBase,m=null,v=Math.abs,b=Math.ceil,S=function(t){function e(e,i,n){var r=t.call(this,e)||this;return r._axisGroup=i,r._type=n,r}n(e,t);var i=e.prototype;return p(i,"DefaultText",{get:function(){return"Axis Title"}}),p(i,"DefaultFontSize",{get:function(){return o.pointToPixel(10)}}),i.Delete=function(){this._chart.Axes.Item(this._type,this._axisGroup).HasTitle=!1},e}(y);e.AxisTitle=S;var C=function(t){function e(e){var i=t.call(this)||this;return i._ooDisplUnits=m,i._axis=e,i._chartText=i.GetDefaultChartText(),i}n(e,t);var i=e.prototype;return i.GetDefaultChartText=function(){var t=this._axis.Parent.Parent;return new g(t.Parent,t.ChartArea.Font)},p(i,"Parent",{get:function(){return this._axis}}),p(i,"Font",{get:function(){return this._chartText.Font}}),p(i,"Format",{get:function(){return this.ChartFormat}}),p(i,"Text",{get:function(){return this._chartText.Text?this._chartText.Text:this.GetAutoText()},set:function(t){this._chartText.Text=t}}),i.Delete=function(){this._axis.HasDisplayUnitLabel=!1},i.GetAutoText=function(){var t=this._axis,e=t.DisplayUnit;return{8:"Trillions",7:"Billions",4:"Millions",1:"Thousands",0:"Hundreds"}[e]||"x"+t.GetValuesFromDispUnit(e)},i.FromOOModel=function(t){this._ooDisplUnits=t,t&&(a(t.builtInUnit)?a(t.custUnit)||(this._axis.DisplayUnitCustom=t.custUnit):this._axis.DisplayUnit=t.builtInUnit,this.FromCT_DispUnitsLbl(t.dispUnitsLbl))},i.ToOOModel=function(){var t=this._ooDisplUnits||{};return 10===this._axis.DisplayUnit?t.custUnit=this._axis.DisplayUnitCustom:t.builtInUnit=this._axis.DisplayUnit,t.dispUnitsLbl=this.ToCT_DispUnitsLbl(),t},i.ToCT_DispUnitsLbl=function(){if(this._axis.HasDisplayUnitLabel){var t=this._ooDisplUnits,e=t&&t.dispUnitsLbl||{};e.spPr=this.ToShapeProperties();var i=this._chartText.ToOOModel();return this._chartText.Text?(a(this._chartText.TextRefer)?e.tx=i:e.tx={strRef:i.strRef},e.txPr=m):(e.txPr=i.rich,e.tx=m),e}return m},i.FromCT_DispUnitsLbl=function(t){if(a(t))return this._axis.HasDisplayUnitLabel=!1,void this.FromShapeProperties(m);this.FromShapeProperties(t.spPr),this._axis.HasDisplayUnitLabel=!0;var e=t.tx;e||(e={rich:t.txPr}),this._chartText.FromOOModel(e)},i.CreateFormat=function(){return new f(this._axis.Parent.Parent)},e}(c);e.DisplayUnitLabel=C;var x=function(t){function e(e){var i=t.call(this)||this;return i._axis=e,i}n(e,t);var i=e.prototype;return p(i,"Parent",{get:function(){return this._axis}}),p(i,"Format",{get:function(){return this.ChartFormat}}),i.FromOOModel=function(t){this._ooGridlines=t,t&&this.FromShapeProperties(t.spPr)},i.ToOOModel=function(){var t=this._ooGridlines||{};return t.spPr=this.ToShapeProperties(),t},i.CreateFormat=function(){return new f(this._axis.Parent.Parent)},e}(c);e.Gridlines=x;var T=function(){function t(t){this._numberFormatLinked=!0,this._orientation=0,this._axis=t;var e=this._axis.Parent.Parent;this._chartText=new g(e.Parent,e.ChartArea.Font),this._chartText.Font.Size=o.pointToPixel(9),this._offset=0}var e=t.prototype;return p(e,"Font",{get:function(){return this._chartText.Font}}),p(e,"NumberFormat",{get:function(){return this.GetNumberFormat()},set:function(t){this._numberFormat=t,this._numberFormatLinked=!1}}),p(e,"NumberFormatLinked",{get:function(){return this._numberFormatLinked},set:function(t){this._numberFormat=t?m:this.GetNumberFormat(),this._numberFormatLinked=t}}),p(e,"Offset",{get:function(){return this._offset},set:function(t){this._offset=t}}),p(e,"Parent",{get:function(){return this._axis}}),e.GetNumberFormat=function(){var t=this._axis,e=t.Type,i=t.Parent.Parent,n=this._numberFormat;if(this.NumberFormatLinked){var r=m,o=i.SeriesCollection;if(o.Count>0&&(r=o.Get(0)),a(r))return m;var s=m;if(0===e?s=r.XValuesRefers:1===e&&(s=r.ValuesRefers),s&&s.length>0){var l={sheet:m,row:-1,col:-1};r.GetRowColIndex(s,0,l);var u=l.sheet,h=l.row,c=l.col;if(u&&-1!==h&&-1!==c){var p=u._GetCellStyle(h,c);p&&p.FormatCode&&(n=p.FormatCode)}}}return n||this._getDefaultNumberFormat(i.ChartType,e,t)},e._getDefaultNumberFormat=function(t,e,i){var n="General";return s.IsStockChart(t)&&0===e||i.IsTimeScale()?n="mm/dd/yyyy":s.IsStacked100Chart(t)&&1===e&&(n="0%"),n},e.FromOOModel=function(t){var e={rich:t.CT_TextBody};this._chartText.FromOOModel(e),t.CT_NumFmt?(this._numberFormat=t.CT_NumFmt.formatCode,this._numberFormatLinked=!1!==t.CT_NumFmt.sourceLinked):(this._numberFormat=m,this._numberFormatLinked=!0)},e.ToOOModel=function(){var t=this._chartText.ToOOModel().rich,e={};e.formatCode=this.GetNumberFormat(),!1===this.NumberFormatLinked&&(e.sourceLinked=!1);var i={};return i.CT_TextBody=t,i.CT_NumFmt=e,i},t}();e.TickLabels=T;var w=function(t){function e(e,i,n){var r=t.call(this)||this;return r._majorTickMark=2,r._minorTickMark=2,r._axisBetweenCategories=!0,r._logBase=10,r._reversePlotOrder=!1,r._displayUnit=9,r._displayUnitCustom=1,r._hasDisplayUnitLabel=m,r._displayUnitLabel=m,r._tickLabelSpacing=1,r._tickLabelSpacingIsAuto=!0,r._tickLabelPos=2,r._tickMarkSpacing=1,r._hasTitle=!1,r._title=m,r._noMultiLvlLbl=!0,r._ooAx=m,r._axisId=m,r._axes=e,r._type=i,r._axisGroup=n,r._title=new S(r._axes.Parent,r._axisGroup,r._type),r._tickLabels=r.GetDefaultTickLabels(),r.InitProps(),r.InitRulers(),r}n(e,t);var i=e.prototype;return i.InitRulers=function(){this._minimumScale=0,this._maximumScale=1.2,this._minimumScaleIsAuto=!0,this._maxmumScaleIsAuto=!0,this._majorUnit=.2,this._minorUnit=.04,this._majorUnitIsAuto=!0,this._minorUnitIsAuto=!0,this._baseUnit=0,this._baseUnitIsAuto=!0,this._minorUnitScale=0,this._majorUnitScale=0,this._scaleType=1},i.InitProps=function(){this._categoryType=0,this._actualCategoryType=0,this.IsValueScaleAxis()&&0===this._axisGroup&&(this._hasMajorGridlines=!0,this._majorGridlines=this.GetDefaultGridlines()),this.IsValueOrDateScaleAxis()?(this._crosses=1,this.IsLogarithmic?this._crossesAt=1:this._crossesAt=0,this._tickLabelSpacing=10):0===this._type?(1===this._axisGroup?this._crosses=2:this._crosses=1,1===this._actualCategoryType?this._tickLabelSpacing=1:this._tickLabelSpacing=10):2===this._type&&(this._crosses=1),this._deleted=0===this._type&&0!==this._axisGroup,this._axisBetweenCategories=!s.IsSurfaceChart(this.Chart.ChartType),this._displayUnitLabel=new C(this),this._format=this.GetDefaultFormat()},p(i,"AxisBetweenCategories",{get:function(){return this._axisBetweenCategories},set:function(t){this._axisBetweenCategories=t}}),p(i,"AxisGroup",{get:function(){return this._axisGroup}}),p(i,"Type",{get:function(){return this._type}}),p(i,"CategoryType",{get:function(){return this._categoryType},set:function(t){t!==this._categoryType&&(this.EnsureAxisType(0),this.EnsureNotAxisCatType(3),this.UpdateCategoryType(t),this.Chart.HandleElementChanged(8,this,l.CategoryType))}}),p(i,"ActualCategoryType",{get:function(){return this._actualCategoryType},set:function(t){t!==this._actualCategoryType&&(this._actualCategoryType=t,this.UpdateAxisRulers())}}),p(i,"CategoryNames",{get:function(){return this.EnsureAxisType(0),this.EnsureNotAxisCatType(3),this.GetCategoryNames()},set:function(t){this.EnsureAxisType(0),this.EnsureNotAxisCatType(3),this.Chart.HandleElementChanged(8,this,l.CategoryNames,t)}}),p(i,"ScaleType",{get:function(){return this._scaleType},set:function(t){t!==this._scaleType&&(this._scaleType=t,this.UpdateAxisRulers())}}),p(i,"MaximumScale",{get:function(){return this._maximumScale},set:function(t){this._maxmumScaleIsAuto=!1,t!==this._maximumScale&&(this._maximumScale=t,this.IsValueOrDateScaleAxis()&&(this._maximumScale<this._minimumScale&&(this._minimumScaleIsAuto=!0),v(this._maximumScale-this._minimumScale)<this._majorUnit&&(this._majorUnitIsAuto=!0,this._minorUnitIsAuto=!0)),this.UpdateAxisRulers())}}),p(i,"MaximumScaleIsAuto",{get:function(){return this._maxmumScaleIsAuto},set:function(t){t!==this._maxmumScaleIsAuto&&(this._maxmumScaleIsAuto=t,this.UpdateAxisRulers())}}),p(i,"MinimumScale",{get:function(){return this._minimumScale},set:function(t){this._minimumScaleIsAuto=!1,t!==this._minimumScale&&(this._minimumScale=t,this.IsValueOrDateScaleAxis()&&(this._maximumScale<this._minimumScale&&(this._maxmumScaleIsAuto=!0),v(this._maximumScale-this._minimumScale)<this._majorUnit&&(this._majorUnitIsAuto=!0,this._minorUnitIsAuto=!0)),this.UpdateAxisRulers())}}),p(i,"MinimumScaleIsAuto",{get:function(){return this._minimumScaleIsAuto},set:function(t){t!==this._minimumScaleIsAuto&&(this._minimumScaleIsAuto=t,this.UpdateAxisRulers())}}),p(i,"MajorUnit",{get:function(){return this._majorUnit},set:function(t){this._canSetUnit()&&(2===this._actualCategoryType&&(t=b(t)),this._majorUnitIsAuto=!1,t!==this._majorUnit&&(this._majorUnit=t,(this.IsValueScaleAxis()||this.IsTimeScale()&&this._majorUnitScale===this._minorUnitScale)&&this._majorUnit<this._minorUnit&&(this._minorUnitIsAuto=!0),this.UpdateAxisRulers()))}}),p(i,"MajorUnitIsAuto",{get:function(){return this._majorUnitIsAuto},set:function(t){t!==this._majorUnitIsAuto&&(this._majorUnitIsAuto=t,this.UpdateAxisRulers())}}),p(i,"MinorUnit",{get:function(){return this._minorUnit},set:function(t){this._canSetUnit()&&(2===this._actualCategoryType&&(t=b(t)),this._minorUnitIsAuto=!1,t!==this._minorUnit&&(this._minorUnit=t,(this.IsValueScaleAxis()||this.IsTimeScale()&&this._majorUnitScale===this._minorUnitScale)&&this._minorUnit>this._majorUnit&&(this._majorUnitIsAuto=!0),this.UpdateAxisRulers()))}}),p(i,"MinorUnitIsAuto",{get:function(){return this._minorUnitIsAuto},set:function(t){t!==this._minorUnitIsAuto&&(this._minorUnitIsAuto=t,this.UpdateAxisRulers())}}),p(i,"BaseUnit",{get:function(){return this._baseUnit},set:function(t){this._baseUnitIsAuto=!1,t!==this._baseUnit&&(this._baseUnit=t,this.MinorUnitIsAuto&&(this._minorUnitScale=t),this.MajorUnitIsAuto&&(this._majorUnitScale=t)),this.UpdateAxisRulers()}}),p(i,"BaseUnitIsAuto",{get:function(){return this._baseUnitIsAuto},set:function(t){t!==this._baseUnitIsAuto&&(this._baseUnitIsAuto=t,this.UpdateAxisRulers())}}),p(i,"MinorUnitScale",{get:function(){return this._minorUnitIsAuto?this._baseUnit:this._minorUnitScale},set:function(t){this._minorUnitIsAuto=!1,t!==this._minorUnitScale&&(this._minorUnitScale=t,this.UpdateAxisRulers())}}),p(i,"MajorUnitScale",{get:function(){return this._majorUnitIsAuto?this._baseUnit:this._majorUnitScale},set:function(t){this._majorUnitIsAuto=!1,t!==this._majorUnitScale&&(this._majorUnitScale=t,this.UpdateAxisRulers())}}),p(i,"AxisTitle",{get:function(){return this._hasTitle?this._title:m},set:function(t){this._title=t}}),p(i,"Crosses",{get:function(){return this.GetCrosses()},set:function(t){t!==this._crosses&&(0===t&&(this._crossesAt=this.GetCrossesAt()),this._crosses=t)}}),p(i,"CrossesAt",{get:function(){return this.GetCrossesAt()},set:function(t){t!==this._crossesAt&&(this._crossesAt=t,this._crosses=0)}}),p(i,"Format",{get:function(){return a(this._format)&&(this._format=this.GetDefaultFormat()),this._format}}),p(i,"DisplayUnit",{get:function(){return this._displayUnit},set:function(t){t!==this._displayUnit&&(this._displayUnit=t,10===t&&(this._displayUnitCustom=this.GetValuesFromDispUnit(t))),9!==t&&a(this._hasDisplayUnitLabel)&&(this._hasDisplayUnitLabel=!0)}}),p(i,"DisplayUnitCustom",{get:function(){return this._displayUnitCustom},set:function(t){this._displayUnitCustom=t,this._displayUnit=10,a(this._hasDisplayUnitLabel)&&(this._hasDisplayUnitLabel=!0)}}),p(i,"DisplayUnitLabel",{get:function(){return this.HasDisplayUnitLabel?this._displayUnitLabel:m}}),p(i,"HasDisplayUnitLabel",{get:function(){return!a(this._hasDisplayUnitLabel)&&this._hasDisplayUnitLabel},set:function(t){this._hasDisplayUnitLabel=t}}),p(i,"HasMajorGridlines",{get:function(){return this._hasMajorGridlines},set:function(t){t!==this._hasMajorGridlines&&(this._hasMajorGridlines=t,t&&a(this._majorGridlines)&&(this._majorGridlines=this.GetDefaultGridlines()))}}),p(i,"HasMinorGridlines",{get:function(){return this._hasMinorGridlines},set:function(t){t!==this._hasMinorGridlines&&(this._hasMinorGridlines=t,t&&a(this._minorGridlines)&&(this._minorGridlines=this.GetDefaultGridlines()))}}),p(i,"HasTitle",{get:function(){return this._hasTitle},set:function(t){this._hasTitle=t}}),p(i,"LogBase",{get:function(){return this._logBase},set:function(t){if(t!==this._logBase){if(t<2||t>1e3)throw new Error("The LogBase must be in range of 2 and 1000!");this._logBase=t,this.UpdateAxisRulers()}}}),p(i,"MajorGridlines",{get:function(){return this._hasMajorGridlines?this._majorGridlines:m}}),p(i,"MinorGridlines",{get:function(){return this._hasMinorGridlines?this._minorGridlines:m}}),p(i,"Parent",{get:function(){return this._axes}}),p(i,"ReversePlotOrder",{get:function(){return this._reversePlotOrder},set:function(t){this._reversePlotOrder=t}}),p(i,"TickLabelPosition",{get:function(){return this._tickLabelPos},set:function(t){this._tickLabelPos=t}}),p(i,"TickLabels",{get:function(){return this._tickLabels}}),p(i,"TickLabelSpacing",{get:function(){return this._tickLabelSpacingIsAuto?1:this._tickLabelSpacing},set:function(t){if(t<1)throw new Error("The value must be equal to or greater than 1");this._tickLabelSpacing=t,this._tickLabelSpacingIsAuto=!1}}),p(i,"TickLabelSpacingIsAuto",{get:function(){return this._tickLabelSpacingIsAuto},set:function(t){this._tickLabelSpacingIsAuto=t}}),p(i,"MajorTickMark",{get:function(){return this._majorTickMark},set:function(t){this._majorTickMark=t}}),p(i,"MinorTickMark",{get:function(){return this._minorTickMark},set:function(t){this._minorTickMark=t}}),p(i,"TickMarkSpacing",{get:function(){return this._tickMarkSpacing},set:function(t){this._tickMarkSpacing=t}}),p(i,"Visible",{get:function(){return!this._deleted},set:function(t){this._deleted=!t}}),p(i,"NoMultiLvlLbl",{get:function(){return this._noMultiLvlLbl},set:function(t){t!==this.NoMultiLvlLbl&&(this._noMultiLvlLbl=t,0!==this.TickLabels.Offset||t||(this.TickLabels.Offset=100))}}),p(i,"Chart",{get:function(){return this.Parent.Parent}}),i.GetDefaultGridlines=function(){var t=new x(this),e=t.Format.Line;return e.Color.ObjectThemeColor=1,e.Weight=1,e.Color.Brightness=l.DefaultLineColorBrightness,t},i.GetDefaultTickLabels=function(){return new T(this)},p(i,"SeriesCollection",{get:function(){return this._axes.Parent.SeriesCollection}}),p(i,"IsLogarithmic",{get:function(){return 0===this._scaleType}}),i.GetCategoryNames=function(){var t=this.SeriesCollection;if(t.Count>0){if(2===this._type){for(var e=[],i=0;i<t.Count;i++)e.push(t.Get(i).Name);return e}return this.GetFirstRightSer().GetXValuesText(t.GetMaxPointsCount(this._axisGroup),this.TickLabels.NumberFormatLinked?m:this.TickLabels.NumberFormat)}return[]},i.UpdateAxisRulers=function(){1===this._type?this.UpdateValueAxis():0===this._type&&(2===this._actualCategoryType?this.UpdateCatAxisTimeScale():3===this._actualCategoryType&&this.UpdateCatAxisValueScale())},i.UpdateValueScaleAxis=function(){this.UpdateValueAxisMinMax(),this.UpdateValueAxisMajorMinor()},i.UpdateValueAxis=function(){this.UpdateValueScaleAxis()},i.UpdateAxisForCatScale=function(){},i.UpdateCatAxisValueScale=function(){this.UpdateValueScaleAxis()},i.UpdateCatAxisTimeScale=function(){this.UpdateDateTimeAxisMinMax(),this.UpdateDateTimeAxisMajorMinorUnit()},i.UpdateDateTimeAxisMinMax=function(){if(this.MinimumScaleIsAuto||this.MaximumScaleIsAuto){var t=this.GetInitialMinMax();this.MinimumScaleIsAuto&&(this._minimumScale=t.initMin),this.MaximumScaleIsAuto&&(this._maximumScale=t.initMax)}},i.UpdateValueAxisMinMax=function(){if(this.MinimumScaleIsAuto||this.MaximumScaleIsAuto){var t={majorUnit:0},e=this.CalcualteValueAxisMinMax(t),i=t.majorUnit;this.MinimumScaleIsAuto&&(this._minimumScale=e.Min),this.MaximumScaleIsAuto&&(this._maximumScale=e.Max,s.allSeriesIsScatterOrBubble(this.Chart)&&(this._maximumScale+=i))}},i.UpdateValueAxisMajorMinor=function(){if(this.MajorUnitIsAuto||this.MinorUnitIsAuto){var t=this.CalculateValueAxisMajorMinorUnit();this.MinorUnitIsAuto&&(this._minorUnit=t.Min),this.MajorUnitIsAuto&&(this._majorUnit=t.Max)}},i.CalcualteValueAxisTempMinMax=function(t,e){var i=this.GetInitialMinMax(t,e),n=i.initMin,r=i.initMax,o=u.CalculateValidMinimum(n,r,this.IsLogarithmic,this.LogBase,this.MinimumScaleIsAuto||t,this.MaximumScaleIsAuto||e),a=u.CalculateValidMaximum(n,r,this.IsLogarithmic,this.LogBase);return u.calcMinMax(o,a,this.IsLogarithmic,this._axes._chart)},i.GetInitialMinMax=function(t,e){var i=this.SeriesCollection;return{initMin:this._minimumScaleIsAuto||t?0===this._type?0===this._axisGroup?i.PrimaryXValuesMinMax.Min:i.SecondaryXValuesMinMax.Min:0===this._axisGroup?i.PrimaryValuesMinMax.Min:i.SecondaryValuesMinMax.Min:this._minimumScale,initMax:this._maxmumScaleIsAuto||e?0===this._type?0===this._axisGroup?i.PrimaryXValuesMinMax.Max:i.SecondaryXValuesMinMax.Max:0===this._axisGroup?i.PrimaryValuesMinMax.Max:i.SecondaryValuesMinMax.Max:this._maximumScale}},i.CalcualteValueAxisMinMax=function(t,e,i){var n=this.CalcualteValueAxisTempMinMax(e,i),r=t.majorUnit=this._majorUnitIsAuto?this.CalculateValueAxisMajorMinorUnit(n).Max:this._majorUnit;return{Min:u.CalculateMinimum2(n.Min,n.Max,r,this.IsLogarithmic,this.LogBase),Max:u.CalculateMaximum2(n.Min,n.Max,r,this.IsLogarithmic,this.LogBase)}},i.CalculateValueAxisMajorMinorUnit=function(t){a(t)&&(t=this.CalcualteValueAxisTempMinMax());var e=u.CalculateMajorUnit(t.Min,t.Max,this.MinorUnitIsAuto,this.MinorUnit,this.IsLogarithmic,this.LogBase);return{Min:u.CalculateMinorUnit(t.Min,t.Max,e,this.IsLogarithmic),Max:e}},i.UpdateDateTimeAxisMajorMinorUnit=function(){var t=h.FromOADate(this.MinimumScale),e=h.FromOADate(this.MaximumScale);if(this._baseUnitIsAuto||this._majorUnitIsAuto){var i=this.SeriesCollection.GetMaxPointsCount(this._axisGroup),n={unitValue:0},r=this.CalculateTimeUnit(t,e,i,n),o=n.unitValue;this._baseUnitIsAuto&&(this._baseUnit=r),this._majorUnitIsAuto&&(this._majorUnit=o,this._majorUnitScale=r)}if(this._minorUnitIsAuto){var a=this._majorUnitScale;0===a?(this._minorUnitScale=0,this._minorUnit=1):1===a?1===this._majorUnit?(this._minorUnitScale=0,this._minorUnit=7):(this._minorUnitScale=1,this._minorUnit=1):2===a&&(this._minorUnitScale=2,this._minorUnit=1)}},i.CalculateTimeUnit=function(t,e,i,n){var r,o;t.getFullYear()!==e.getFullYear()?(o=2,r=1):t.getMonth()!==e.getMonth()?(o=1,r=12):(o=0,r=7);for(var a=this.GetDateItemsCount(t,e,o,r);a<i&&0!==o;){if(2===o)o=1,r=12;else if(1===o){if(1===r)o=0,r=(e.valueOf()-t.valueOf())/864e5>=28?7:1;else r--}a=this.GetDateItemsCount(t,e,o,r)}return n.unitValue=r,o},i.GetDateItemsCount=function(t,e,i,n){n=Math.floor(n);for(var r=new Date(t),o=e,a=[];r<=o;)a.push(r),0===i?r.setDate(r.getDate()+n):1===i?r.setMonth(r.getMonth()+n):2===i&&r.setFullYear(r.getFullYear()+n);return a.length},i.GetFirstRightSer=function(){for(var t=this.SeriesCollection,e=0;e<t.Count;e++){var i=t.Get(e),n=s.GetDimensioin(i.InnerChartType);if(i.AxisGroup===this._axisGroup&&1===n)return i}return m},i.IsValueOrDateScaleAxis=function(){return this.IsValueScaleAxis()||this.IsTimeScale()},i.IsValueScaleAxis=function(){return 1===this._type||0===this._type&&3===this._actualCategoryType},i.IsTimeScale=function(){return 0===this._type&&2===this._actualCategoryType},i.GetCrosses=function(){return a(this._crosses)?1:this._crosses},i.GetCustomCrossesAt=function(){if(0===this.Crosses)return this._crossesAt||0},i.GetCrossesAt=function(){var t=0,e=this.Crosses;return 0===e?t=a(this._crossesAt)?0:this._crossesAt:1===e?t=this.GetAutoCrossesAt():2===e?t=this.GetMaxCrossesAt():3===e&&(t=this.GetMinCrossesAt()),t},i.GetAutoCrossesAt=function(){return 0===this._type?1===this._actualCategoryType?1:0===this._axisGroup?this.MinimumScale:this.MaximumScale:this.IsValueOrDateScaleAxis()&&this.IsLogarithmic?1:0},i.GetMinCrossesAt=function(){return this.IsValueOrDateScaleAxis()?this.MinimumScale:0===this._type?1===this._actualCategoryType?1:this.MinimumScale:0},i.GetMaxCrossesAt=function(){return this.IsValueOrDateScaleAxis()?this.MaximumScale:0===this._type?1===this._actualCategoryType?this.CategoryNames.length:this.MaximumScale:0},i.GetValuesFromDispUnit=function(t){return{8:1e12,7:1e9,6:1e8,5:1e7,4:1e6,3:1e5,2:1e4,1:1e3,0:100,9:1,10:this._displayUnitCustom}[t]},i.HasTwoDimensionSers=function(){for(var t=this.SeriesCollection.GetSers(!1,this._axisGroup),e=0;e<t.length;e++)if(s.GetDimensioin(t[e].InnerChartType)>1)return!0;return!1},i.ResetOnChartTypeChanged=function(){this._ooAx=m},i.CreateFormat=function(){return new f(this._axes.Parent,m,m,this.AutoLineColorFormat.bind(this))},i.GetDefaultFormat=function(){var e=t.prototype.GetDefaultFormat.call(this),i=this._axes.Parent.ChartType;return(s.IsSurfaceChart(i)||5===i)&&(e.Line.Weight=1),this.InitAutoLineColor(i,e.Line.Color),e},i.InitAutoLineColor=function(t,e){var i=l.DefaultLineColorBrightness;e.ObjectThemeColor=1,e.Brightness=i},i.AutoLineColorFormat=function(){var t=this._axes.Parent.ChartType,e=new _(this._axes.Parent);return this.InitAutoLineColor(t,e),e},i.EnsureAxisType=function(t){if(this._type!==t)throw new Error},i.EnsureAxisCatType=function(t){if(this._actualCategoryType!==t)throw new Error},i.EnsureNotAxisType=function(t){if(this._type===t)throw new Error},i.EnsureNotAxisCatType=function(t){if(this._actualCategoryType===t)throw new Error},i.UpdateCategoryType=function(t){this._categoryType=t,this._actualCategoryType=t},i.FromOOModel=function(t){this.Chart.SuspendElementChanged(),this._ooAx=t;var e=this._type;if(0===e){var i=t.axisType;0===i?this.FromCT_CatAx(t):1===i?this.FromCT_DateAx(t):3===i&&this.FromCT_ValAx(t)}else 1===e?this.FromCT_ValAx(t):2===e&&this.FromCT_SerAx(t);this.Chart.ResumeElementChanged()},i.ToOOModel=function(){var t=m,e=this._type;if(0===e){var i=this._actualCategoryType;1===i?t=this.ToCT_CatAx():2===i?t=this.ToCT_DateAx():3===i&&(t=this.ToCT_ValAx())}else 1===e?t=this.ToCT_ValAx():2===e&&(t=this.ToCT_SerAx());return t.AxisGroup=this._axisGroup,t.AxisType=e,t},i.ToCT_CatAx=function(){var t=this._ooAx,e=t&&0===t.axisType?t:{axisType:0};return this.ToCT_AxBase(e),e.auto=0===this.CategoryType,this.TickLabelSpacingIsAuto?e.tickLblSkip=m:e.tickLblSkip=this.TickLabelSpacing,e.lblOffset=this.TickLabels.Offset,e.tickMarkSkip=this.TickMarkSpacing,e.noMultiLvlLbl=this.NoMultiLvlLbl,e},i.FromCT_CatAx=function(t){(a(t.auto)||1!==this.ActualCategoryType)&&this.UpdateCategoryType(1),this.FromCT_AxBase(t),a(t.tickLblSkip)?this._tickLabelSpacingIsAuto=!0:(this._tickLabelSpacing=t.tickLblSkip,this._tickLabelSpacingIsAuto=!1),a(t.lblOffset)||(this._tickLabels.Offset=t.lblOffset),a(t.tickMarkSkip)||(this._tickMarkSpacing=t.tickMarkSkip)},i.ToCT_ValAx=function(){var t=this._ooAx,e=t&&3===t.axisType?t:{axisType:3};return this.ToCT_AxBase(e),this.MajorUnitIsAuto||(e.majorUnit=this.MajorUnit),this.MinorUnitIsAuto||(e.minorUnit=this.MinorUnit),9!==this._displayUnit&&(e.dispUnits=this._displayUnitLabel.ToOOModel()),e},i.FromCT_ValAx=function(t){this.FromCT_AxBase(t),a(t.majorUnit)?this._majorUnitIsAuto=!0:(this._majorUnit=t.majorUnit,this._majorUnitIsAuto=!1),a(t.minorUnit)?this._minorUnitIsAuto=!0:(this._minorUnit=t.minorUnit,this._minorUnitIsAuto=!1),this._displayUnitLabel.FromOOModel(t.dispUnits)},i.ToCT_DateAx=function(){var t=this._ooAx,e=t&&1===t.axisType?t:{axisType:1};return this.ToCT_AxBase(e),e.auto=0===this.CategoryType,e.lblOffset=this.TickLabels.Offset,this.MajorUnitIsAuto||(e.majorUnit=this.MajorUnit,e.majorTimeUnit=this.MajorUnitScale),this.MinorUnitIsAuto||(e.minorUnit=this.MinorUnit,e.minorTimeUnit=this.MinorUnitScale),this.BaseUnitIsAuto||(e.baseTimeUnit=this.BaseUnit),e},i.FromCT_DateAx=function(t){(a(t.auto)||2!==this.ActualCategoryType)&&this.UpdateCategoryType(2),this.FromCT_AxBase(t),a(t.majorUnit)?this._majorUnitIsAuto=!0:(this._majorUnit=t.majorUnit,this._majorUnitIsAuto=!1),a(t.minorUnit)?this._minorUnitIsAuto=!0:(this._minorUnit=t.minorUnit,this._minorUnitIsAuto=!1),a(t.baseTimeUnit)?this._baseUnitIsAuto=!0:(this._baseUnit=t.baseTimeUnit,this._baseUnitIsAuto=!1),a(t.majorTimeUnit)||(this._majorUnitScale=t.majorTimeUnit),a(t.minorTimeUnit)||(this._minorUnitScale=t.minorTimeUnit),a(t.lblOffset)||(this._tickLabels.Offset=t.lblOffset)},i.ToCT_SerAx=function(){var t=this._ooAx||{axisType:2};return this.ToCT_AxBase(t),this.TickLabelSpacingIsAuto?t.tickLblSkip=m:t.tickLblSkip=this.TickLabelSpacing,t.tickMarkSkip=this.TickMarkSpacing,t},i.FromCT_SerAx=function(t){this.FromCT_AxBase(t),a(t.tickLblSkip)?this._tickLabelSpacingIsAuto=!0:(this._tickLabelSpacing=t.tickLblSkip,this._tickLabelSpacingIsAuto=!1),a(t.tickMarkSkip)||(this._tickMarkSpacing=t.tickMarkSkip)},i.ToCT_AxBase=function(e){if(e.axId=this.GetAxisId(),e.delete=this._deleted,e.majorTickMark=this.MajorTickMark,e.minorTickMark=this.MinorTickMark,e.tickLblPos=this.TickLabelPosition,e.axPos=this.GetAxPos(),e.scaling=this.ToCT_Scaling(),e.spPr=t.prototype.ToShapeProperties.call(this),!a(this.TickLabels)){var i=this._tickLabels.ToOOModel();0===this.Chart.SeriesCollection.Count?e.numFmt=m:e.numFmt=i.CT_NumFmt,e.txPr=i.CT_TextBody}this.HasMajorGridlines&&!a(this._majorGridlines)&&(e.majorGridlines=this._majorGridlines.ToOOModel()),this.HasMinorGridlines&&!a(this._minorGridlines)&&(e.minorGridlines=this._minorGridlines.ToOOModel()),this._hasTitle&&(e.title=this._title.ToOOModel())},i.FromCT_AxBase=function(t){a(t.delete)?1===this._axisGroup&&(this._deleted=!1):this._deleted=t.delete,a(t.majorTickMark)?this.MajorTickMark=3:this.MajorTickMark=t.majorTickMark,a(t.minorTickMark)||(this.MinorTickMark=t.minorTickMark),a(t.tickLblPos)||(this.TickLabelPosition=t.tickLblPos),this.FromCT_Scaling(t.scaling),this.FromShapeProperties(t.spPr);var e={};e.CT_TextBody=t.txPr,e.CT_NumFmt=t.numFmt,this._tickLabels.FromOOModel(e),a(t.majorGridlines)?this.HasMajorGridlines=!1:(this.HasMajorGridlines=!0,this._majorGridlines.FromOOModel(t.majorGridlines)),a(t.minorGridlines)?this.HasMinorGridlines=!1:(this.HasMinorGridlines=!0,this._minorGridlines.FromOOModel(t.minorGridlines)),a(t.title)||(this._title.FromOOModel(t.title),this._hasTitle=!0)},i.GetAxisPostion=function(){return{0:"bottom",3:"top",1:"left",2:"right"}[this.GetAxPos()]},i.GetAxPos=function(){return this._ooAx&&!a(this._ooAx.axPos)?this._ooAx.axPos:0===this.Type?s.IsBarChart(this.Chart.ChartType)?0===this.AxisGroup?1:2:0===this.AxisGroup?0:3:1===this.Type?0===this.AxisGroup?1:2:0},i.ToCT_Scaling=function(){var t=this._ooAx,e=t&&!a(t.scaling)?t.scaling:{};return e.orientation=this.ReversePlotOrder?0:1,this.IsValueOrDateScaleAxis()&&(this.MinimumScaleIsAuto||(e.min=this.MinimumScale),this.MaximumScaleIsAuto||(e.max=this.MaximumScale),0===this.ScaleType&&(e.logBase=this.LogBase)),e},i.FromCT_Scaling=function(t){if(t){a(t.orientation)||(this.ReversePlotOrder=0===t.orientation),a(t.min)?this._minimumScaleIsAuto=!0:(this._minimumScale=t.min,this._minimumScaleIsAuto=!1),a(t.max)?this._maxmumScaleIsAuto=!0:(this._maximumScale=t.max,this._maxmumScaleIsAuto=!1),a(t.logBase)?this._scaleType=1:(this._logBase=t.logBase,this._scaleType=0)}},i.GetCrossAtAx=function(){return 0===this._type?this._axes.Item(1,this._axisGroup):this._axes.Item(0,this._axisGroup)},i.GetAxisId=function(){return a(this._axisId)&&(this._axisId=u.GenerateAxisId()),this._axisId},i._getMajorGridlines=function(t){return t&&a(this._majorGridlines)&&(this._majorGridlines=this.GetDefaultGridlines()),this._majorGridlines},i._getMinorGridlines=function(t){return t&&a(this._minorGridlines)&&(this._minorGridlines=this.GetDefaultGridlines()),this._minorGridlines},i._canSetUnit=function(){var t=this._actualCategoryType;return 0!==this._type||2===t||3===t},e}(c);e.Axis=w;var P=function(){function t(t){this._axes=[],this._chart=t}var e=t.prototype;function i(t,e,i,n){return t.filter(function(t){return t.axisType===n&&e.indexOf(t.axId)>=0&&i.indexOf(t.axId)>=0})[0]}function n(t,e){return t.filter(function(t){return 3===t.axisType&&t.axId===e.crossAx})[0]}return p(e,"Parent",{get:function(){return this._chart}}),p(e,"Count",{get:function(){return this._axes.length}}),e.Item=function(t,e){return void 0===e&&(e=0),this.GetAxis(t,e)},e.GetAxis=function(t,e){for(var i=this._axes,n=0;n<i.length;n++){var r=i[n];if(r.Type===t&&r.AxisGroup===e)return r}return m},e.Add=function(t,e){void 0===e&&(e=0);for(var i=this._axes,n=0;n<i.length;n++){var r=i[n];if(t===r.Type&&e===r.AxisGroup)throw new Error("Can not add same type of axis many times!")}var o=new w(this,t,e);return this._axes.push(o),o},e.Remove=function(t,e){void 0===e&&(e=0);for(var i=m,n=this._axes,r=0;r<n.length;r++){var o=n[r];if(o.Type===t&&o.AxisGroup===e){i=o;break}}if(!a(i)){var s=this._axes.indexOf(i);return this._axes.splice(s,1),i}return m},e.RestoreAxes=function(t){this.RestoreGroupAxes(t,0),this.RestoreGroupAxes(t,1);var e=s.GetAxes(t,2);if(e&&e.length>0){var i=this.GetAxis(2,0);i&&i.FromOOModel(e[0])}},e.RestoreGroupAxes=function(t,e){var r=s.GetAxises(t,e),o=s.GetCategoryAxises(t),l=t.axes,u=i(l,r,o,0),h=i(l,r,o,3),c=i(l,r,o,1),p=m,f=this.GetAxis(0,e);if(u&&(f&&f.FromOOModel(u),p=n(l,u)),h&&(f&&3===f.ActualCategoryType&&f.FromOOModel(h),p=n(l,h)),c&&(f&&f.FromOOModel(c),p=n(l,c)),p){f&&(a(p.crosses)?a(p.crossesAt)||(f.CrossesAt=p.crossesAt):f.Crosses=p.crosses,a(p.crossBetween)||(f.AxisBetweenCategories=0===p.crossBetween));var _=this.GetAxis(1,e);if(_){_.FromOOModel(p);var d=m,g=m;u?(d=u.crosses,g=u.crossesAt):c?(d=c.crosses,g=c.crossesAt):h&&(d=h.crosses,g=h.crossesAt),a(d)?a(g)||(_.CrossesAt=g):_.Crosses=d}}},e.ResetOnChartTypeChanged=function(){for(var t=this._axes,e=0;e<t.length;e++)t[e].ResetOnChartTypeChanged()},t}();e.Axes=P,t.exports=e}()},function(e,i,n){"use strict";e.exports=t.Spread.Sheets.FloatingObjects},function(e,i,n){"use strict";e.exports=t.Spread.CalcEngine},function(t,e,i){"use strict";!function(){var e=i(0),n=i(3),r=i(13).GeneralFormatter,o=i(1),a=o.DateTimeExtension,s=o.UnitHelper.isNullOrUndefined,l=o.ChartUtility,u=l.colorFormatToString,h=n.CalcEngine.formulaToRanges,c=n.CalcEngine.parseSeriesFormula,p=l.IsStockChart,f="x",_="value",d="color",g="bubbleSizeField",y="name",m="Candlestick",v="HighLowOpenClose",b=null,S="Bar",C="Line",x="Area",T="Scatter",w="Stack",P="Spline",A="yyyy-MM-dd",F=i(14).sR,O=new Image,M=new Image;function D(t,e){if(t.length>1)for(var i,n=0;n<t.length;n++){var r=t[n][0];i?gt(i,r.XValues)||e.push(t[n][1]):r.XValuesIsAuto()||(i=r.XValues)}}function L(t){var e=t.SeriesCollection.AllSers;return l.IsPieChart(t.ChartType)&&e.length>0?e=[function(t){for(var e=0,i=t.length;e<i;e++)if(!t[e].IsHidden)return t[e]}(e)||e[0]]:0===t.ChartType&&(e=function(t){for(var e=[],i=[],n=0,r=t.length;n<r;n++){var o=t[n];0===o.AxisGroup?e.push([o,n]):i.push([o,n])}var a=[];D(e,a),D(i,a);var s=[];for(n=0,r=t.length;n<r;n++)a.indexOf(n)<0&&s.push(t[n]);return s}(e)),e}function I(t,e){var i=t.Name,n=i;if(i){if(e){var r=e[i];if(r>0){for(var o=0;o<r;o++)n+=" ";e[i]++}else e[i]=1}}else{var a=t.SeriesCollection.IndexOfSource(t);n=l.IsPieOrDoughnutChart(t.ChartType)?""+(a+1):F().series+(a+1)}return n}function k(t,e){if(4!==t.MarkerStyle){var i={},n=t.MarkerFormat;i.symbolFill=u(n.Fill,e),i.symbolStroke=u(n.Line,e);var r=n.Line.Weight;return r>=0&&(i.symbolStrokeWidth=r),i}return b}function R(t,e){return l.IsPieOrDoughnutChart(t.ChartType)?N(t.Points.Get(0),e):N(t,e)}function N(t,e){var i=t&&t.Format&&t.Format.Line;if(i){var n=i.Weight,r={};n>=0&&(r.width=n);var o=u(i,e);return o&&(r.color=o),r}return b}function E(t,e,i){var n,r=t.ChartType;switch(r){case 12:case 6:case 15:n={type:S};break;case 13:case 16:case 14:case 17:n={type:S,group:w};break;case 19:case 22:case 20:case 23:n={type:S,swapAxes:!0,group:w};break;case 18:case 21:n={type:S,swapAxes:!0};break;case 9:case 5:case 36:n={type:C};break;case 26:case 35:n={type:C,symbols:!0};break;case 24:case 25:n={type:C,group:w};break;case 27:case 28:n={type:C,group:w,symbols:!0};break;case 8:case 7:n={type:x};break;case 37:case 39:case 38:case 40:n={type:x,group:w};break;case 1:n={type:T};break;case 33:n={type:C,symbols:!0,lineAspect:P};break;case 34:n={type:C,lineAspect:P};break;case 11:case 48:n={type:T,size:!0};break;case 10:case 4:case 30:case 31:case 29:case 32:n={type:S,radial:!0,group:w};break;case 3:case 41:n={type:S,radial:!0,group:w,doughnut:!0};break;default:n={type:S}}52===e?i?n.stock=!0:9===r&&(n={type:m}):51===e?i?n.stock=!0:9===r&&(n={type:v}):50===e?n={type:m}:49===e&&(n={type:v});var o=t.XValuesIsAuto();return(l.IsScatterChart(r)||l.IsBubbleChart(r))&&(n.scatter=!0,o&&(n.needXNames=!0)),n}function G(t,e){return t instanceof Date?e?new r(A).format(t):a.ToOADate(t):t}function V(t,e){return G(t?t[e]:e+1)}function j(t,e,i,n,r,o,a,l,u,h){var c,p={},f=n[r];if(t&&s(f)&&(f=0,c=!0),p[a]=G(f),!0===t){p[o]=e;var _=V(i,r);if(c&&s(_))return b;p[l]="number"==typeof _?""+_:_}else{var d=V(i,r);if(s(f)&&s(d))return b;if(p[o]=d,p[l]=e,h&&(p.xFormat=h),u){var g=u.names;p[y]=(g&&g[r]||d)+""}}return p}O.src=F().dataEmptyImg,M.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAMAAAC5zwKfAAAAflBMVEUAAAD83t783t7/4eH/5OT//f373t783t783t783t7939//5eX83d383t783t773d373d3939/84OD73d3839/93t773t7/39//5eX83t783t783d3/4eH/39/83t7/////3t783t783t783t7739/83t783t773t7839/73d2bqhdaAAAAKXRSTlMA8U0dCQbS39uSaBX5u7LGj21S1Z1zRT8R7eXiMCeUBD2tqqiGf/fBV/xYON4AAAJFSURBVFjDpNRZcsIwEATQlvGKdwwYMIRUyNb3v2DKWJUq4qAZ2+97PkbqliBI93WSh9Exy45RmCf1PsV8vleFHAkrz8cc7dbwCbNtMVGwjukUrwPo+bsTRaedDyUvokrkQWNVUK1YQbQxnMBspDASTpQ4wzmUnKw8OK6v4QzNCk9cOs7SXZ7s13Gm7t8dDw1naw4YCUouUI6zTrhIMuozF9r8CcRwIfMYTCGNx58UFA//izB7BtDmdPPwy4/o8nVF73qjU+QD1o5OawzOdNvBCk66AFO6nQIM1tRuqByM6fYuRmfFuGspuGFQU9Kit6WgxKCiZHvvjKHAyO23jG9vRpDirqHIUx2Er+hdM4oqACGpq8OKshBIKavQ21MhVY0Vtv8Ke9SUxbY1CjVeqODb1shekFPhbF+oLEdIhW8AATVCRFT4AHChRoQjFd4AeNQ4IqNCY791WfbTnNmtIAgEUXj6M2tdSjBNMNPo5rz/CwYhdbkfLAOe62UHGcY95xt2YfU0a+CFvYgeZhf4yUfqC3rYlEKszUFIhUURzdYJKbLRU2k1dGH04L0RUm2tkCboR1sLsDL0e8FgmyNsMvtvcl3Z0HNtl4ceCj30aOpfUxjeSqthZkknGhQ6ZueqJSfF5DxBw1kw5yydgSWmhRdLDEvvWHq70Vih+XsqbECsgO45Dod9W6LgQ81pBRyVQ3h0jLf5AdwZEeRDDF/Mkg+CfFFVPkxzxX35QNIVmeZDXXfs7A/GObpfw3Lht/4Y/+uPMb3++ABU/Pk6Mzj87QAAAABJRU5ErkJggg==";var B={2:"None",3:"Outside",1:"Inside",0:"Cross"};function U(t){return B[t]}function z(t,e,i,n){var r=t.AxisTitle;if(r){var o=r.Font.Size*n;return e&&(o+=""),{color:u(r.Font,i),fontFamily:r.Font.Name,fontSize:o}}}var H={bottom:"Near",top:"Far",left:"Near",right:"Far"};function W(t){if(t){var e=t.width,i=t.color;if(e||i){var n={};return e&&(n.strokeWidth=e),i&&(n.stroke=i),n}}}function X(t){if(!t.MinimumScaleIsAuto&&!t.MaximumScaleIsAuto)return{min:t.MinimumScale,max:t.MaximumScale};var e=0,i=1,n=t.CalcualteValueAxisMinMax({},!0,!0),r=n.Max,o=n.Min;return t.MaximumScaleIsAuto?r<=0&&(i=0):i=t.MaximumScale,t.MinimumScaleIsAuto?o<0&&(e=Math.abs(o)>r?-1:Math.floor(5*o/r)/5):e=t.MinimumScale,{min:e,max:i}}var Y={0:1,1:31,2:365};function q(t){return Y[t]}function K(t,e,i,n,r,o){var l=function(t){var e;if(!0===t.Visible){var i=t.GetAxisPostion();e=H[i]}return e||"None"}(t),h=function(t){var e={majorGrid:!!t.MajorGridlines,minorGrid:!!t.MinorGridlines},i=W(N(t.MajorGridlines,!1));return i&&(e.majorGridStyle=i),(i=W(N(t.MinorGridlines,!1)))&&(e.minorGridStyle=i),e}(t),c={};"X"===e?(c.bottom=5,c.top=5):(c.left=5,c.right=5);var f={plots:i,type:e,format:t.TickLabels.NumberFormat,majorTicks:U(t.MajorTickMark),minorTicks:U(t.MinorTickMark),majorGrid:h.majorGrid,minorGrid:h.minorGrid,title:t.AxisTitle?t.AxisTitle.Text:"",titleStyle:z(t,!0,!1,o),position:l,labelStyle:{padding:c}};3===t.TickLabelPosition&&(f.labels=!1);var _=t.IsTimeScale(),d=t.MajorUnitIsAuto?t.BaseUnit:t.MajorUnitScale,g=t.MinorUnitIsAuto?t.BaseUnit:t.MinorUnitScale,y=_?q(d):1,m=_?q(g):1;t.MajorUnitIsAuto||(f.majorUnit=t.MajorUnit*y);var v=t.MinorUnit*m;t.MinorUnitIsAuto||(f.minorUnit=v);var b=t.Chart.ChartType,S="Y"===e,C=p(b);if(S&&C)f.max=t.MaximumScale,f.min=t.MinimumScale;else{var x=r&&!n;if(!t.MaximumScaleIsAuto||x){var T=t.MaximumScale;_&&(C?T=a.FromOADate(T).valueOf():T+=v/2),f.max=T}if(!t.MinimumScaleIsAuto||x){var w=t.MinimumScale;_&&(C?w=a.FromOADate(w).valueOf():w-=v/2),f.min=w}}if(S&&(n?f.scale={type:"Percentage"}:0===t.ScaleType&&(f.scale={type:"Logarithmic"},f.logBase=t.LogBase)),n&&r){var P=X(t);f.min=P.min,f.max=P.max,f.format&&!t.TickLabels.NumberFormatLinked||(f.format="0%")}var A=h.majorGridStyle;A&&(f.majorGridStyle=A),(A=h.minorGridStyle)&&(f.minorGridStyle=A);var F=t.TickLabels.Font;F&&(f.textStyle={color:u(F,!1),fontFamily:F.Name},F.Size&&(f.textStyle.fontSize=F.Size*o+""));var O=N(t,!1);O&&(f.lineStyle={stroke:O.color||"transparent",strokeWidth:s(O.width)?1:O.width});var M=t.TickLabels&&t.TickLabels._chartText&&t.TickLabels._chartText.TextBody&&t.TickLabels._chartText.TextBody.Rotation;return M&&(f.labelAngle=M),f}function Q(t,e,i){var n,r,o;for(i||(i=L(t)),n=0;n<i.length;n++)if(o=(r=i[n]).ChartType,r.AxisGroup===e&&l.IsStacked100Chart(o))return!0;return!1}function Z(t,e,i){var n={},r=t.ChartFormat;r&&(n.style={backgroundColor:u(r.Fill,e)});var o=t.Font;if(o){var a=n.textStyle={};a.color=u(o,e),a.fontFamily=o.Name;var s=o.Size;s>0&&(a.fontSize=s*i+"")}return n}function J(t,e,i,n,r,o){var a={},l=t.Position;if("number"==typeof l&&l>=0&&l<=8){var h={0:"Auto",1:"Inside",2:"Center",3:"Inside",4:"Inside",5:"Center",6:"Outside",7:"Center",8:"Outside"}[l];h&&(a.position=h)}if(t.ShowLeaderLines&&"Outside"===a.position){var c=N(t.LeaderLines,!1);c&&(a.connectingLine={stroke:c.color||"transparent",strokeWidth:s(c.width)?1:c.width})}else a.connectingLine={stroke:"transparent"};var p=a.style={},f=N(t,!1);f&&(p.borderStyle={strokeWidth:s(f.width)?1:f.width,stroke:f.color||"transparent"});var _=t.Format&&t.Format.Fill,d=u(_,!1);p.backgroundColor=d||"transparent";var g=t.Font,y=u(g,!1),m=g.Name,v=g.Size;if(y||m||v>0){var S=a.textStyle={};y&&(S.color=y),m&&(S.fontFamily=m),v>0&&(S.fontSize=v*o+"")}var C=function(t,e,i,n,r){var o=t.ShowValue,a=t.ShowCategoryName,s=t.ShowSeriesName,l=t.ShowPercentage,u=[],h=r.radial;if(s&&u.push("{"+(h?i:e)+".value}"),a&&u.push("{"+(h?e:i)+".value}"),o){var c="",p=t.NumberFormat;p&&(c=": "+p),u.push("{"+n+".value"+c+"}")}return l&&u.push("{PercentageCategory:0%}"),u.length>0?u.join(t.Separator):b}(t,n,e,i,r);return C&&(a.template=C),a}function $(t,e,i,n,r,o){var a={};a.values=function(t,e,i){var n=t.type,r=t.stock;return[{field:n===m?{x:"date",high:"high",low:"low",open:"open",close:"close"}:n===v?{x:"date",high:"high",low:"low",close:"close"}:r?"date, volume":i+", "+e}]}(t,i,o),a.details=function(t,e){var i={field:e,excludeNulls:!0};return t.group&&(i.group=t.group),[i]}(t,n),a.color={field:n},t.size&&(a.size={field:g});var s=function(t,e,i,n,r){if(!t)return b;var o=t.ShowValue,a=t.ShowCategoryName,s=t.ShowSeriesName,l=t.ShowPercentage,u=r.radial,h=[];return(o||l)&&h.push({field:n}),a&&h.push({field:u?e:i}),s&&h.push({field:u?i:e}),h.length>0?h:b}(r.GetDataLabels(),n,o,i,t);return s&&(a.text=s),a.tooltip=function(t,e,i,n){var r,o=t.type,a=t.stock;o===m?r=["date","high","low","open","close"]:o===v?r=["date","high","low","close"]:a?r=["date","volume"]:(r=[n,i,e],t.size&&r.push(g),t.needXNames&&r.push(y));var s=[];return r.forEach(function(t){s.push({field:t})}),s}(t,n,o,i),a}function tt(t,e,i,n,r,o,a){var u=i[0],h={};t.radial||(h.clippingMode="Clip");var c=u.GetDataLabels();if(c&&(h.text=J(c,n,r,o,t,a)),h.tooltip={style:{borderStyle:{stroke:"#767676"},backgroundColor:"white"},textStyle:{color:"#575757",fontFamily:"Calibri",fontSize:14*a},template:function(t,e,i,n,r){var o,a=t.type,s=t.stock,l=t.radial,u=t.scatter;if(a===m)o="{date.name}:{date.value}\n{high.name}:{high.value}\n{low.name}:{low.value}\n{open.name}:{open.value}\n{close.name}:{close.value}";else if(a===v)o="{date.name}:{date.value}\n{high.name}:{high.value}\n{low.name}:{low.value}\n{close.name}:{close.value}";else if(u){var h=t.needXNames?y:i;o=F().series+' "{'+e+'.value}" '+F().point+' "{'+h+'.value}" \n({'+i+".value}, {"+n+".value})",t.size&&(o+=" "+F().size+": {"+g+".value}")}else o=s?"{date.name}:{date.value}\n{volume.name}:{volume.value}":l?F().series+' "{'+i+'.value}" '+F().point+' "{'+e+'.value}" \n'+F().value+": {"+n+".value: "+(r||"#,##0")+"} ({PercentageCategory:0%})":F().series+' "{'+e+'.value}" '+F().point+' "{'+i+'.value}" \n'+F().value+": {"+n+".value: "+(r||"#,##0")+"}";return o}(t,o,n,r,c&&c.NumberFormat)},t.swapAxes&&(h.swapAxes=!0),t.symbols&&(h.symbols=!0),t.lineAspect&&(h.lineAspect=t.lineAspect),t.radial&&(h.radial=!0,h.startAngle=function(t){return t.Parent.FirstSliceAngle+90}(u),t.doughnut&&(h.innerRadius=u.Parent.DoughnutHoleSize/100),h.sweep=360),!p(e)){var f=function(t){for(var e=[],i=[],n=0;n<t.length;n++)e.push(R(t[n],!1)),i.push(k(t[n],!1));var r=!0;if(e.length>0){var o=e[0],a=o&&o.color,s=o&&o.width,l=i[0],u=l&&l.symbolFill,h=l&&l.symbolStroke,c=l&&l.symbolStrokeWidth;for(n=1;n<e.length;n++){var p=e[n],f=p&&p.color,_=p&&p.width;if(a!==f||s!==_){r=!1;break}var d=i[n],g=d&&d.symbolFill,y=d&&d.symbolStroke,m=d&&d.symbolStrokeWidth;if(u!==g||h!==y||c!==m){r=!1;break}}}return r}(i);if(i.length<=1||f){h.style||(h.style={});var _=R(u,!1),d=_&&_.width,b=_&&_.color;(d>=0||b)&&(d>=0&&(h.style.strokeWidth=d),b&&!l.IsLineChart(u.ChartType)&&(h.style.stroke=b));var S=k(u,!1);S&&(h.style.symbolFill=S.symbolFill,h.style.symbolStroke=S.symbolStroke,s(S.symbolStrokeWidth)||(h.style.symbolStrokeWidth=S.symbolStrokeWidth))}var T=[];i.length>1&&!f&&(T=T.concat(function(t,e,i){for(var n=[],r={},o=0;o<t.length;o++){var a=t[o],l=R(a,!1),u=l&&l.color,h=l&&l.width,c=[];u&&c.push({name:"style.stroke",value:u}),h&&c.push({name:"style.strokeWidth",value:h});var p=k(a,!1);p&&(c.push({name:"style.symbolFill",value:p.symbolFill}),c.push({name:"style.symbolStroke",value:p.symbolStroke}),s(p.symbolStrokeWidth)||c.push({name:"style.symbolStrokeWidth",value:p.symbolStrokeWidth}));var f=I(a,r);if(c.length>0&&f){var _=i?"Group":"DataPoint";n.push({condition:"current.items[0]."+e+' = "'+f+'"',type:_,actions:[{targetElement:_,properties:c}]})}}return n}(i,o,t.type===C||t.type===x))),T.length>0&&(h.rules=T)}return h}function et(t,e,i,n,r,o,a,s){var l={name:i,type:t.type};return l.encodings=$(t,0,o,a,n[0],r),l.config=tt(t,e,n,r,o,a,s),l}function it(t,e){for(var i=t.Points,n=i.Count,r=[],o=0;o<n;o++){var a=i.Get(o).getFillColor(e);a&&r.push(a)}return r}function nt(t,e,i){var n,r;i.type===C?(n=e.getLineColor(!1))&&t.push(n):i.type===S||i.type===x?!0===i.radial?function(t,e){var i=it(e,!1),n=i.length;t.length=0;for(var r=0;r<n;r++)t.push(i[r])}(t,e):(r=e.getFillColor(!1))&&t.push(r):i.type===T&&(i.size?(r=e.getFillColor(!1))&&t.push(r):("transparent"===(n=e.getLineColor(!1))&&(n=e.getMarkerLineColor(!1)),n&&t.push(n)))}var rt={0:"",1:"2"};function ot(t){return f+rt[t.AxisGroup]}var at={secondaryLine:1,primaryLine:2,secondaryOther:11,primaryOther:12,secondaryArea:21,primaryArea:22};function st(t,e){var i=0;return 0===t?i=e===C?at.primaryLine:e===x?at.primaryArea:at.primaryOther:1===t&&(i=e===C?at.secondaryLine:e===x?at.secondaryArea:at.secondaryOther),i}function lt(t,e){var i,n={},r=[];for(i=0;i<t.length;i++){var o=t[i],a=o.Values;if(a&&a.length>0){var s=o._getUniqueName();if(n[s])n[s].push(o);else{n[s]=[o];var l=E(o,e,0===i),u=st(o.AxisGroup,l.type);r.push({type:s,value:u,chartInfo:l})}}}return r.length>1&&r.sort(function(t,e){return e.value-t.value}),{serGroupsOrder:r,serGroups:n}}var ut,ht={49:["high","low","close"],50:["open","high","low","close"],51:["volume","high","low","close"],52:["volume","open","high","low","close"]};function ct(t,e){for(var i=0;i<t.length;i++){var n=t[i];if(n.AxisGroup===e&&!n.XValuesIsAuto())return n.XValues}}function pt(t){for(var e="",i=""+this,n=0;n<t;n++)e+=i;return e}function ft(t){for(var e=t.slice(),i={},n=!1,r=0,o=t.length;r<o;r++){var a=t[r],l=i[a]||0;if(a||0===a||(n=!0),l){var u=h(i,a,l);i[u]=1,e[r]=u,n=!0}else i[a]=1}return n&&(e=e.map(function(t){return s(t)?"":t+""})),e;function h(t,e,i){var n=function(t,e){return ut||(ut="".repeat||pt),ut.call(t,e)}(" ",i),r=s(e)?n:e+n;return t[r]?h(t,e,++i):r}}function _t(t,e,i){var n,r,o,a,s,u=t.ChartType;if(p(u)){var h=ht[u],c={};for(n=0;n<e.length;n++){r=e[n];var f=h[n];if(a=r.XValues,s=r.Values,!c.date){if(!l.AreAllDate(a))return;c.date=a}c[f]=s}var y=c.date&&c.date.length;for(n=0;n<y;n++){var m={date:G(c.date&&c.date[n],!0),high:c.high&&c.high[n],low:c.low&&c.low[n],close:c.close&&c.close[n]};if(c.open&&(m.open=c.open[n]),c.volume&&(m.volume=c.volume[n]),i(m))return}}else{var v=ct(e,0),b=ct(e,1),S={};for(n=0;n<e.length;n++){var C,x,T=(r=e[n])._getUniqueName();o=E(r),a=r.XValuesIsAuto()?0===r.AxisGroup?v:b:r.XValues,o.needXNames&&(C={names:r._xValues}),s=r.Values,o.size&&(x=r.GetBubbleSizes());var w=t.Axes.GetAxis(0,r.AxisGroup);a&&w&&!w.IsValueOrDateScaleAxis()&&(a=ft(a=a.map(function(t){return t instanceof Date?parseInt(l.toOADate(t)):t})));for(var P=I(r,S),A=s&&s.length,F=0;F<A;F++){var O=j(o.radial,P,a,s,F,ot(r),_+T,d+T,C,w&&w.TickLabels.NumberFormat);if(O&&(x&&x.length>0&&(O[g]=x[F]),i(O,r)))return}}}}function dt(t,e){var i=[];if(_t(t,e,function(t){(function(t){if(t){for(var e in t)if(!s(t[e]))return!1;return!0}return!1})(t)||i.push(t)}),i.length>0){var n=t.ChartType,r=t.Axes.Item(0,0);(l.IsLineChart(n)||l.IsAreaChart(n))&&r&&r.IsValueOrDateScaleAxis()&&i.sort(function(t,e){return t[f]-e[f]})}return{values:i}}function gt(t,e){return JSON.stringify(t)===JSON.stringify(e)}function yt(t,e,i,n){if(!t)return b;var r={text:t.Text||function(t,e){if(e||(e=L(t)),1===e.length)return e[0].Name}(t.Parent,i)||t.DefaultText},o=t.GetChartTextInternal();if(o){var a=o.Font;r.color=u(a,e),r.fontFamily=a.Name,r.fontSize=(a.Size||t.DefaultFontSize)*n}return r}function mt(t,e){var i;return{legend:i=t?{position:function(t){return{1:"Top",4:"Bottom",3:"Left"}[t]||"Right"}(t.Position),orientation:function(t){var e="Vertical";return 1!==t&&4!==t||(e="Horizontal"),e}(t.Position),textStyle:function(t,e){var i={},n=u(t,!1),r=t.Name,o=t.Size;return(n||r||o>0)&&(n&&(i.color=n),r&&(i.fontFamily=r),o>0&&(i.fontSize=o*e+"")),i}(t.Font,e)}:{hidden:!0},legends:[{title:"",type:"Color",position:i.position}]}}function vt(t,e){if(l.IsBarChart(t.ChartType))return!0;if(0===t.ChartType){for(var i=t.SeriesCollection.GetValidSers(e),n=!0,r=0;r<i.length;r++)if(!l.IsBarChart(i[r].ChartType)){n=!1;break}return n}return!1}function bt(t,e){var i=!0;try{for(var n=function(t){for(var e=[],i=t.SeriesCollection._series,n=0;n<i.length;n++){var r=i[n],o=c(r.Formula);if(!o.length)break;for(var a=0;a<o.length;a++){var s=o[a];s&&"string"==typeof s&&-1===e.indexOf(s)&&e.push(s)}}return e}(t),r=0;r<n.length;r++){var o=n[r],a=h(e,o)[0],s=a.ranges;e=a.sheet;for(var l=0,u=s.length;l<u;l++)for(var p=s[l],f=p.row,_=p.row+p.rowCount-1;f<=_;f++)if(e.getRowVisible(f))for(var d=p.col,g=p.col+p.colCount-1;d<=g;d++)if(e.getColumnVisible(d)){var y=e.getValue(f,d);if(y||0===y)return!1}}}catch(t){i=!1}return i}function St(t,e,i,n,r,o,a){var h=Z(t.ChartArea,!1,a),c=i._canSelectFloatingObject(t.Parent),f={style:h.style,textStyle:h.textStyle,selectionMode:p(t.ChartType)?"Custom":"Group",selectedStyle:{adorners:c},noDataStyle:function(t){return{titleStyle:{backgroundImage:O},desStyle:{fontSize:14*t+"",color:"#7d7d7d"}}}(a),errorType:t.errorType,errorStyle:function(t){return{titleStyle:{backgroundImage:M},desStyle:{fontSize:14*t+"",color:"#7d7d7d"}}}(a),noData:bt(t,i),setChartStatus:function(e){t.status=e}};o.length>0&&(f.palette=o);var _=function(t,e){var i=t.Format.Line;if(i.Color&&0===i.Color.ColorType)return b;var n={},r=u(i,!0);r&&(n.stroke=e.currentTheme().getColor(r));var o,a=i.Weight>0?i.Weight:1;switch(n.strokeWidth=a,i.DashStyle){case 1:o=a+","+3*a;break;case 2:o=4*a+","+3*a;break;case 3:o=8*a+","+3*a;break;case 4:o=4*a+","+3*a+","+a+","+3*a;break;case 5:o=8*a+","+3*a+","+a+","+3*a;break;case 6:o=8*a+","+3*a+","+a+","+3*a+","+a+","+3*a;break;case 7:o=3*a+","+a;break;case 8:o=a+","+a;break;case 9:o=3*a+","+a+","+a+","+a;break;case 10:o=3*a+","+a+","+a+","+a+","+a+","+a}return o&&(n.strokeDasharray=o),n}(t.ChartArea,i);_&&(f.borderStyle=_);var d=function(t,e,i){var n=yt(t,!1,e,i);if(!n)return b;var r={header:n.text};if(t.GetChartTextInternal()){r.headerTextStyle={color:n.color,fontFamily:n.fontFamily},n.fontSize&&(r.headerTextStyle.fontSize=n.fontSize*i+""),r.headerStyle={backgroundColor:u(t.Format.Fill,!1)};var o=N(t,!1);o&&(r.headerStyle.borderStyle={strokeWidth:s(o.width)?1:o.width,stroke:o.color||"transparent"})}return r}(t.ChartTitle,e,a);d&&(d.header&&(f.header=d.header),d.headerTextStyle&&(f.headerTextStyle=d.headerTextStyle),d.headerStyle&&(f.headerStyle=d.headerStyle));var g=function(t,e,i,n,r){var o=t.Axes,a=[],u=t.ChartType,h=vt(t,0),c=vt(t,1),f=l.IsPieOrDoughnutChart(u),_=Q(t,0,e);if(o){var d,g,y,m=o.Item(0,0),v=o.Item(1,0),b=o.Item(0,1),S=o.Item(1,1);if(m){var C=K(m,h?"Y":"X",i,_,m.IsValueScaleAxis(),r);if(!h&&!m.IsValueOrDateScaleAxis()&&!p(u)){C.scale={type:"Ordinal"};var x=t.SeriesCollection.GetValidSers(0);C.min=-.5;var T=x.map(function(t){return t?t.XValues.length:0}).sort(function(t,e){return e-t})[0];C.max=T-.5}y=v&&v.GetCustomCrossesAt(),s(y)||(C.origin=y),a.push(C)}else f&&a.push({plots:i,type:"X",position:"None"});if(v){var w=K(v,h?"X":"Y",i,_,!0,r);a.push(w),y=m&&m.GetCustomCrossesAt(),s(y)||(w.origin=y),C&&!s(w.min)&&w.min<0&&w.max>=0&&(C.origin=0),v.ReversePlotOrder&&(w.reversed=!0)}else f&&a.push({plots:i,type:"Y",position:"None",scale:{type:"Percentage"}});if(_=Q(t,1,e),b){if(d=K(b,c?"Y":"X",n,_,b.IsValueScaleAxis(),r),!c&&!b.IsValueOrDateScaleAxis()&&!p(u)){d.scale={type:"Ordinal"};var P=t.SeriesCollection.GetValidSers(1)[0];d.min=-.5,d.max=(P?P.XValues.length:0)-.5}y=S&&S.GetCustomCrossesAt(),s(y)||(d.origin=y),C&&d.position===C.position?C.plots=C.plots.concat(d.plots):a.push(d)}S&&(g=K(S,c?"X":"Y",n,_,!0,r),y=b&&b.GetCustomCrossesAt(),s(y)||(g.origin=y),w&&g.position===w.position?w.plots=w.plots.concat(g.plots):a.push(g),S.ReversePlotOrder&&(g.reversed=!0))}return a}(t,e,n,r,a);if(g.length>0){var y={axes:g,style:{fill:u(t.PlotArea.Format.Fill,!1)}},m=N(t.PlotArea,!1);m&&(y.borderStyle={strokeWidth:s(m.width)?1:m.width,stroke:m.color||"transparent"});var v=mt(t.Legend,a);v&&(y.legend=v.legend,m&&(y.legend.style={borderStyle:{strokeWidth:1,stroke:"transparent"}}),y.legends=v.legends,l.IsBubbleChart(t.ChartType)&&y.legends.push({type:"Size",hidden:!0}));var S=v&&v.legend&&"Bottom"===v.legend.position;g[0].titleStyle={padding:{bottom:S?10:20}},f.plotAreas=[y]}var C=function(t){var e,i=t.ColumnGroups;if(i&&i.Count>0)e=i.Get(0);else{var n=t.BarGroups;n&&n.Count>0&&(e=n.Get(0))}if(e){var r=e.GetSers(),o=r&&r.length;if(o>0){var a=e.Overlap,u=e.GapWidth,h={},c=l.IsStackedChart(r[0].ChartType)?1:o;return s(a)||(h.overlap=a/100),s(u)||(h.width=c/(c+u/100)),h}}return b}(t);return C&&(f.bar=C),f}function Ct(t){for(var e=t.serGroupsOrder,i=t.serGroups,n=[],r=0,o=e.length;r<o;r++)for(var a=i[e[r].type],s=0,l=a.length;s<l;s++)n.push(a[s]);return n}var xt=i(9);if(xt){var Tt={format:function(t,e){return t&&-1!==t.indexOf("General")&&"number"==typeof e&&Math.abs(e-parseFloat(e.toFixed(2)))<1e-10&&(e=e.toFixed(2)),new r(t).format(e)},defaultFormat:function(t,e){return 4===t?"mm/dd/yyyy":"General"}},wt={create:function(){return Tt}},Pt=xt.plugins;Pt.unregisterStringFormatting("Default"),Pt.registerStringFormatting("Default",wt),Pt.unregisterRenderEngine("Canvas"),Pt.registerRenderEngine("Canvas",new Pt.PureCanvasRenderEnginePlugin);var At=xt.FlexDV.prototype,Ft=At.load;At.load=function(){try{Ft.apply(this,arguments)}catch(t){}};var Ot=At.refresh;At.refresh=function(){try{Ot.apply(this,arguments)}catch(t){throw t}};var Mt=At.Select;At.Select=function(){try{Mt.apply(this,arguments)}catch(t){}}}e.ChartHelper={getChartModelData:function(t,e){var i=e.zoom(),n=[],r=[],o={},a=L(t),s=t.ChartType,l=lt(a,s),u=Ct(l),h=function(t){for(var e=t.serGroupsOrder,i=t.serGroups,n=[],r=0,o=e.length;r<o;r++)for(var a=e[r].type,s=e[r].chartInfo,l=i[a],u=0,h=l.length;u<h;u++)nt(n,l[u],s);return n}(l);o.plots=function(t,e,i,n,r){for(var o=[],a=t.serGroupsOrder,s=t.serGroups,l=0;l<a.length;l++){var u=a[l].type,h=a[l].chartInfo,c=s[u],p=c[0],f=et(h,e,"plot"+(l+1),c,ot(p),_+u,d+u,r);o.push(f);var g=p.AxisGroup;0===g?i.push(f.name):1===g&&n.push(f.name)}return o}(l,s,n,r,i);var c=0===(o.data=dt(t,u)).values.length;return o.config=St(t,a,e,n,r,h,i),c?(o.config.header="",o.plots=[],delete o.config.plotAreas):p(s)||(o.data.dateFormats=!1),o},getSeries:function(t,e,i){var n,r=t.ChartType;if(p(r)){var o=ht[r].indexOf(i);if(o>=0)return t.SeriesCollection.Get(o)}else _t(t,Ct(lt(L(t),t.ChartType)),function(t,i){if(gt(t,e))return n=i,!0});return n},getChartAreaStyle:Z,colorFormatToString:u,getChartTitleProperties:yt,getSeriesProperties:function(t,e){var i,n=t.ChartType,r=E(t,t.SeriesCollection.Parent.ChartType,e),o={chartType:n,axisGroup:t.AxisGroup};if(r.radial)i=it(t,!0).join(",");else{var a=t.getFillColor(!0);a&&(i=a)}o.backColor=i;var l,u=o.border={};if(r.radial){var h=t.Points;if(h.Count>0){var c=h.Get(0),p=c.getLineColor(!0);p&&(u.color=p),l=c.Format.Line.Weight}}else{l=t.LineWidth;var f=t.getLineColor(!0);f&&(u.color=f)}!s(l)&&l>=0&&(u.width=l),r.radial&&(o.startAngle=t.Parent.FirstSliceAngle);var _=t.GetNameFormula();o.name=_||'"'+I(t)+'"';var d=t.GetXValuesFormula();d&&(o.xValues=d);var g=t.GetValuesFormula();g&&(o.yValues=g);var y=t.GetBubbleSizesFormula();return y&&(o.bubbleSizes=y),o},getAxisProperties:function(t){var e={visible:t.Visible,tickLabelPosition:3===t.TickLabelPosition?3:2,format:t.TickLabels.NumberFormat,majorTickPosition:t.MajorTickMark,minorTickPosition:t.MinorTickMark},i=t.MajorGridlines,n=N(i,!0)||{};n.visible=!!i,e.majorGridLine=n;var r=t.MinorGridlines,o=N(r,!0)||{};o.visible=!!r,e.minorGridLine=o;var l=z(t,!1,!0,1)||{};if(l.text=t.AxisTitle?t.AxisTitle.Text:"",e.title=l,t.MajorUnitIsAuto||(e.majorUnit=t.MajorUnit),t.MinorUnitIsAuto||(e.minorUnit=t.MinorUnit),t.IsValueOrDateScaleAxis()){var h=t.MinimumScale,c=t.MaximumScale;if(t.IsTimeScale())h=a.FromOADate(h),c=a.FromOADate(c);else if(Q(t.Chart,t.AxisGroup)){var p=X(t);h=p.min,c=p.max,e.format&&!t.TickLabels.NumberFormatLinked||(e.format="0%")}t.MinimumScaleIsAuto||(e.min=h),t.MaximumScaleIsAuto||(e.max=c)}var f=t.TickLabels.Font;f&&(e.style={color:u(f,!0),fontFamily:f.Name,fontSize:f.Size});var _=N(t,!0);return _&&(e.lineStyle={color:_.color||"transparent",width:s(_.width)?1:_.width}),0===t.Type&&(e.categoryType=t.ActualCategoryType),e},isPercentageScaleType:Q},t.exports=e}()},function(t,e,i){"use strict";t.exports={DataMismatch:{0:["Data mismatch!"],1:["Data mismatch! Horizontal axis must be date"],2:["Data mismatch!","Select 4 columns and order by: opening price, high price, low price, closing price."],3:["Data mismatch!","Horizontal axis must be of date, and 4 columns need to be selected as vertical axis","in the order of opening price, high price, low price, closing price"]},NoData:"No Data",series:"Series",point:"Point",value:"Value",size:"Size",date:"date",high:"high",low:"low",open:"open",close:"close",dataEmptyImg:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIyNzBweCIgaGVpZ2h0PSI5M3B4IiB2aWV3Qm94PSIwIDAgMjcwIDkzIiB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPiAgICAgICAgPHRpdGxlPmVtcHR5PC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPiAgICAgICAgPGcgaWQ9ImVtcHR5IiBmaWxsPSIjRTVFNUU1IiBmaWxsLXJ1bGU9Im5vbnplcm8iPiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLjc1MjkyOTY4Nyw3MyBMMC43NTI5Mjk2ODcsMC43MzQzNzUgTDQxLjEzMzc4OTEsMC43MzQzNzUgTDQxLjEzMzc4OTEsOC40MDAzOTA2MiBMMTEuMDA2ODM1OSw4LjQwMDM5MDYyIEwxMS4wMDY4MzU5LDMxLjU5Mzc1IEwzNi4yNTA5NzY2LDMxLjU5Mzc1IEwzNi4yNTA5NzY2LDM5LjE2MjEwOTQgTDExLjAwNjgzNTksMzkuMTYyMTA5NCBMMTEuMDA2ODM1OSw2NS4zMzM5ODQ0IEw0My4yMzMzOTg0LDY1LjMzMzk4NDQgTDQzLjIzMzM5ODQsNzMgTDAuNzUyOTI5Njg3LDczIFogTTUwLjI0NTExNzIsNzMgTDUwLjI0NTExNzIsMTkuOTcyNjU2MyBMNTkuODY0MjU3OCwxOS45NzI2NTYzIEw1OS44NjQyNTc4LDI5LjkzMzU5MzcgQzY0LjU1MTc4MTMsMjIuNTExNjgxNiA3MC41NzM4NTY0LDE4LjgwMDc4MTMgNzcuOTMwNjY0MSwxOC44MDA3ODEzIEM4NS4wMjcwNTM3LDE4LjgwMDc4MTMgODkuODYwOTg5NywyMi41MTE2ODE2IDkyLjQzMjYxNzIsMjkuOTMzNTkzNyBDOTYuOTg5OTMxNiwyMi40NzkxMjk0IDEwMi45MTQzNTIsMTguNzUxOTUzMSAxMTAuMjA2MDU1LDE4Ljc1MTk1MzEgQzExNC44OTM1NzgsMTguNzUxOTUzMSAxMTguNTIzMDk5LDIwLjEyNzI2NDkgMTIxLjA5NDcyNywyMi44Nzc5Mjk3IEMxMjMuNjY2MzU0LDI1LjYyODU5NDUgMTI0Ljk1MjE0OCwyOS40Nzc4Mzk4IDEyNC45NTIxNDgsMzQuNDI1NzgxMiBMMTI0Ljk1MjE0OCw3MyBMMTE1LjI4NDE4LDczIEwxMTUuMjg0MTgsMzUuOTM5NDUzMSBDMTE1LjI4NDE4LDI5Ljg4NDczNTQgMTEyLjg5MTYyNSwyNi44NTc0MjE5IDEwOC4xMDY0NDUsMjYuODU3NDIxOSBDMTAzLjEyNTk1MiwyNi44NTc0MjE5IDk3LjkwMTM5NDUsMzAuMzg5Mjg3NiA5Mi40MzI2MTcyLDM3LjQ1MzEyNSBMOTIuNDMyNjE3Miw3MyBMODIuNzY0NjQ4NCw3MyBMODIuNzY0NjQ4NCwzNS45Mzk0NTMxIEM4Mi43NjQ2NDg0LDI5Ljg1MjE4MzEgODAuMzIzMjY2NiwyNi44MDg1OTM4IDc1LjQ0MDQyOTcsMjYuODA4NTkzOCBDNzAuNTkwMTQ1LDI2LjgwODU5MzggNjUuMzk4MTM5NiwzMC4zNTY3MzU0IDU5Ljg2NDI1NzgsMzcuNDUzMTI1IEw1OS44NjQyNTc4LDczIEw1MC4yNDUxMTcyLDczIFogTTEzMy42MDQ0OTIsOTIuMjg3MTA5NCBMMTMzLjYwNDQ5MiwxOS45NzI2NTYyIEwxNDMuMjIzNjMzLDE5Ljk3MjY1NjIgTDE0My4yMjM2MzMsMjkuOTMzNTkzNyBDMTQ3LjE2MjQ1NSwyMi41MTE2ODE2IDE1My4wNzA1OTksMTguODAwNzgxMiAxNjAuOTQ4MjQyLDE4LjgwMDc4MTIgQzE2Ny4zMjg0ODIsMTguODAwNzgxMiAxNzIuMzQ5NTkxLDIxLjEyODIzMTkgMTc2LjAxMTcxOSwyNS43ODMyMDMxIEMxNzkuNjczODQ2LDMwLjQzODE3NDMgMTgxLjUwNDg4MywzNi44MDIwNDMgMTgxLjUwNDg4Myw0NC44NzUgQzE4MS41MDQ4ODMsNTMuNjY0MTA2NCAxNzkuNDI5NzA4LDYwLjc1MjI1MTcgMTc1LjI3OTI5Nyw2Ni4xMzk2NDg0IEMxNzEuMTI4ODg1LDcxLjUyNzA0NTIgMTY1LjY2ODMyOCw3NC4yMjA3MDMxIDE1OC44OTc0NjEsNzQuMjIwNzAzMSBDMTUyLjYxNDg3Nyw3NC4yMjA3MDMxIDE0Ny4zOTAzMiw3MS44MTE4NzMgMTQzLjIyMzYzMyw2Ni45OTQxNDA2IEwxNDMuMjIzNjMzLDkyLjI4NzEwOTQgTDEzMy42MDQ0OTIsOTIuMjg3MTA5NCBaIE0xNDMuMjIzNjMzLDYwLjM1MzUxNTYgQzE0OC4xNzE1NzQsNjQuNzgwNjIxMSAxNTIuODkxNTc5LDY2Ljk5NDE0MDYgMTU3LjM4Mzc4OSw2Ni45OTQxNDA2IEMxNjYuNjI4NjI3LDY2Ljk5NDE0MDYgMTcxLjI1MDk3Nyw1OS45NDY2ODUxIDE3MS4yNTA5NzcsNDUuODUxNTYyNSBDMTcxLjI1MDk3NywzMy40MTY2MDQ1IDE2Ny4xNDk0NTUsMjcuMTk5MjE4OCAxNTguOTQ2Mjg5LDI3LjE5OTIxODggQzE1My41NzUxNjgsMjcuMTk5MjE4OCAxNDguMzM0MzM1LDMwLjExMjYwMTEgMTQzLjIyMzYzMywzNS45Mzk0NTMxIEwxNDMuMjIzNjMzLDYwLjM1MzUxNTYgWiBNMjA3LjQ2MTkxNCw3NC4yMjA3MDMxIEMyMDIuNTc5MDc3LDc0LjIyMDcwMzEgMTk4Ljc3MDUyMSw3Mi44MjA5Nzc1IDE5Ni4wMzYxMzMsNzAuMDIxNDg0NCBDMTkzLjMwMTc0NCw2Ny4yMjE5OTEyIDE5MS45MzQ1Nyw2My4zMzIwNTYyIDE5MS45MzQ1Nyw1OC4zNTE1NjI1IEwxOTEuOTM0NTcsMjcuMTk5MjE4NyBMMTg1LjI5Mzk0NSwyNy4xOTkyMTg3IEwxODUuMjkzOTQ1LDE5Ljk3MjY1NjMgTDE5MS45MzQ1NywxOS45NzI2NTYzIEwxOTEuOTM0NTcsMTAuMzUzNTE1NiBMMjAxLjU1MzcxMSw5LjQyNTc4MTI1IEwyMDEuNTUzNzExLDE5Ljk3MjY1NjMgTDIxNS40MjA4OTgsMTkuOTcyNjU2MyBMMjE1LjQyMDg5OCwyNy4xOTkyMTg3IEwyMDEuNTUzNzExLDI3LjE5OTIxODcgTDIwMS41NTM3MTEsNTYuNTkzNzUgQzIwMS41NTM3MTEsNjMuNTI3Mzc4NCAyMDQuNTQ4NDczLDY2Ljk5NDE0MDYgMjEwLjUzODA4Niw2Ni45OTQxNDA2IEMyMTEuODA3NjI0LDY2Ljk5NDE0MDYgMjEzLjM1MzgzMiw2Ni43ODI1NTQyIDIxNS4xNzY3NTgsNjYuMzU5Mzc1IEwyMTUuMTc2NzU4LDczIEMyMTIuMjE0NTAzLDczLjgxMzgwNjIgMjA5LjY0MjkxNSw3NC4yMjA3MDMxIDIwNy40NjE5MTQsNzQuMjIwNzAzMSBaIE0yMzEuMDIyNDYxLDkyLjI4NzEwOTQgTDIzOS42MTYyMTEsNzMgTDIxOS4xMDgzOTgsMTkuOTcyNjU2MiBMMjI5LjUwODc4OSwxOS45NzI2NTYyIEwyNDQuNjk0MzM2LDU5LjkxNDA2MjUgTDI2MC45MDUyNzMsMTkuOTcyNjU2MiBMMjY5Ljk4NzMwNSwxOS45NzI2NTYyIEwyNDEuMDMyMjI3LDkyLjI4NzEwOTQgTDIzMS4wMjI0NjEsOTIuMjg3MTA5NCBaIiBpZD0iRW1wdHkiPjwvcGF0aD4gICAgICAgIDwvZz4gICAgPC9nPjwvc3ZnPg=="}},function(t,e,i){"use strict";t.exports={DataMismatch:{0:[""],1:[""],2:[""," 4 "],3:[""," 4 "," "]},NoData:"",series:"",point:"",value:"",size:"",date:"",high:"",low:"",open:"",close:"",dataEmptyImg:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIHdpZHRoPSIxMDhweCIgaGVpZ2h0PSIxMTJweCIgdmlld0JveD0iMCAwIDEwOCAxMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+ICAgICAgICA8dGl0bGU+54ShPC90aXRsZT4gICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+ICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPiAgICAgICAgPHBhdGggZD0iTTE3LjY0LDIwLjg4IEMxNC4yOCwyNS40NCAxMC4yLDI5LjUyIDUuNTIsMzMuMjQgTDAuMjQsMjYuNCBDOS4zNiwxOS4zMiAxNS42LDEwLjggMTguOTYsMC43MiBMMjcuMzYsMS44IEMyNi4xNiw1LjUyIDI0LjcyLDkgMjMuMDQsMTIuMzYgTDEwMi4yNCwxMi4zNiBMMTAyLjI0LDIwLjUyIEw5Mi42NCwyMC41MiBMOTIuNjQsNDEuNjQgTDEwNC43Niw0MS42NCBMMTA0Ljc2LDQ5LjU2IEw5Mi42NCw0OS41NiBMOTIuNjQsNjkuNiBMMTA2LjU2LDY5LjYgTDEwNi41Niw3Ny42NCBMMS40NCw3Ny42NCBMMS40NCw2OS42IEwxNy42NCw2OS42IEwxNy42NCw0OS41NiBMMy4zNiw0OS41NiBMMy4zNiw0MS42NCBMMTcuNjQsNDEuNjQgTDE3LjY0LDIwLjg4IFogTTI1LjkyLDY5LjYgTDM5LjcyLDY5LjYgTDM5LjcyLDQ5LjU2IEwyNS45Miw0OS41NiBMMjUuOTIsNjkuNiBaIE00OC4xMiw2OS42IEw2Mi4xNiw2OS42IEw2Mi4xNiw0OS41NiBMNDguMTIsNDkuNTYgTDQ4LjEyLDY5LjYgWiBNNzAuNDQsNjkuNiBMODQuMjQsNjkuNiBMODQuMjQsNDkuNTYgTDcwLjQ0LDQ5LjU2IEw3MC40NCw2OS42IFogTTg0LjI0LDQxLjY0IEw4NC4yNCwyMC41MiBMNzAuNDQsMjAuNTIgTDcwLjQ0LDQxLjY0IEw4NC4yNCw0MS42NCBaIE02Mi4xNiw0MS42NCBMNjIuMTYsMjAuNTIgTDQ4LjEyLDIwLjUyIEw0OC4xMiw0MS42NCBMNjIuMTYsNDEuNjQgWiBNMzkuNzIsNDEuNjQgTDM5LjcyLDIwLjUyIEwyNS45MiwyMC41MiBMMjUuOTIsNDEuNjQgTDM5LjcyLDQxLjY0IFogTTE2LjgsODIuOCBMMjQuMTIsODYuMjggQzIwLjE2LDk2IDE1LjQ4LDEwNC40IDEwLjIsMTExLjQ4IEwzLjEyLDEwNi4zMiBDOC40LDk5LjcyIDEyLjk2LDkxLjkyIDE2LjgsODIuOCBaIE00Mi45Niw4NS4zMiBDNDUuMzYsOTIuNTIgNDcuNTIsMTAwLjQ0IDQ5LjQ0LDEwOC44NCBMNDAuNjgsMTEwLjc2IEMzOS4xMiwxMDEuODggMzcuMiw5My45NiAzNS4wNCw4Ny4xMiBMNDIuOTYsODUuMzIgWiBNNjguNzYsODQuNiBDNzIsOTEuOTIgNzQuODgsOTkuODQgNzcuMjgsMTA4LjM2IEw2OC42NCwxMTAuMjggQzY2LjQ4LDEwMS4yOCA2My44NCw5My4zNiA2MC43Miw4Ni40IEw2OC43Niw4NC42IFogTTkxLjQ0LDgyLjIgQzk4LjQsOTEuMzIgMTAzLjY4LDk5LjM2IDEwNy40LDEwNi4wOCBMMTAwLjIsMTExLjEyIEM5Ni4zNiwxMDMuNjggOTEuMiw5NS40IDg0LjcyLDg2LjQgTDkxLjQ0LDgyLjIgWiIgaWQ9IueEoSIgZmlsbD0iI0U1RTVFNSI+PC9wYXRoPiAgICA8L2c+PC9zdmc+"}},function(t,e,i){"use strict";!function(){var e=i(0),n=i(1),r=n.ChartUtility.defineProperty,o=n.ShapeConstants.PositionConver,a=i(8).ARGBColor,s=i(7).ColorFormat,l=function(){function t(t){this._drawingContexxt=t,this._color=new s(this._drawingContexxt)}var e=t.prototype;return r(e,"Color",{get:function(){return this._color},set:function(t){this._color=t}}),r(e,"Position",{get:function(){return this._position},set:function(t){this._position=t}}),r(e,"Transparency",{get:function(){return this._color.Transparency},set:function(t){this._color.Transparency=t}}),e.FromOOModel=function(t){this.Position=t.pos/o,this._color.FromOOModel(t)},e.ToOOModel=function(){var t=this._color.ToOOModel();return t.pos=Math.round(this.Position*o),t},t}();e.GradientStop=l;var u=function(){function t(t){this._drawingStyleContext=t,this._gradientStopList=[]}var e=t.prototype;return e.Item=function(t){return this._gradientStopList[t]},r(e,"Count",{get:function(){return this._gradientStopList.length}}),r(e,"GradientStopList",{get:function(){return this._gradientStopList}}),e.Delete=function(t){-1===t&&(t=this.Count-1),this._gradientStopList.splice(t,1)},e.Insert=function(t,e,i,n,r){void 0===i&&(i=0),void 0===n&&(n=-1),void 0===r&&(r=0);var o=new l(this._drawingStyleContext);o.Color.RGB=a.FromArgb(t),o.Position=e,o.Transparency=i,o.Color.Brightness=r,n<0?this._gradientStopList.push(o):this._gradientStopList.splice(n,0,o)},e.FromOOModel=function(t){for(var e=0,i=t.gs;e<i.length;e++){var n=i[e],r=new l(this._drawingStyleContext);r.FromOOModel(n),this.GradientStopList.push(r)}},e.ToOOModel=function(){for(var t={gs:[]},e=0,i=this._gradientStopList;e<i.length;e++){var n=i[e];t.gs.push(n.ToOOModel())}return t},t}();e.GradientStops=u,t.exports=e}()},function(t,e,i){"use strict";!function(){var e=i(2)._Types._inherit,n=i(0),r=i(4).StatefullBase,o=i(1),a=o.ChartUtility.defineProperty,s=o.UnitHelper.isNullOrUndefined,l=i(11).FillFormat,u=null,h=function(t){function i(e,i,n){t.call(this,i);return this._beginArrowheadLength=1,this._beginArrowheadStyle=0,this._beginArrowheadWidth=1,this._dashStyle=0,this._endArrowheadLength=1,this._endArrowheadStyle=0,this._endArrowheadWidth=1,this._style=0,this._visible=!0,this._weight=-1,this._ooLineProps=u,this._context=e,this._parent=i,this._autoColorFormat=n,this._fill=new l(e,i&&i.FillInternal,n),this}e(i,t);var n=i.prototype;return a(n,"PatternColor",{get:function(){return this.FillInternal.PatternColorInternal}}),a(n,"Color",{get:function(){return this.FillInternal.ColorInternal}}),a(n,"BeginArrowheadLength",{get:function(){return this.IsDirty(4)||s(this._parent)?this._beginArrowheadLength:this._parent.BeginArrowheadLength},set:function(t){this._beginArrowheadLength=t,this.Dirty(4)}}),a(n,"BeginArrowheadStyle",{get:function(){return this.IsDirty(8)||s(this._parent)?this._beginArrowheadStyle:this._parent.BeginArrowheadStyle},set:function(t){this._beginArrowheadStyle=t,this.Dirty(8)}}),a(n,"BeginArrowheadWidth",{get:function(){return this.IsDirty(16)||s(this._parent)?this._beginArrowheadWidth:this._parent.BeginArrowheadWidth},set:function(t){this._beginArrowheadWidth=t,this.Dirty(16)}}),a(n,"DashStyle",{get:function(){return this.IsDirty(32)||s(this._parent)?this._dashStyle:this._parent.DashStyle},set:function(t){this._dashStyle=t,this.Dirty(32)}}),a(n,"EndArrowheadLength",{get:function(){return this.IsDirty(64)||s(this._parent)?this._endArrowheadLength:this._parent.EndArrowheadLength},set:function(t){this._endArrowheadLength=t,this.Dirty(64)}}),a(n,"EndArrowheadStyle",{get:function(){return this.IsDirty(128)||s(this._parent)?this._endArrowheadStyle:this._parent.EndArrowheadStyle},set:function(t){this._endArrowheadStyle=t,this.Dirty(128)}}),a(n,"EndArrowheadWidth",{get:function(){return this.IsDirty(256)||s(this._parent)?this._endArrowheadWidth:this._parent.EndArrowheadWidth},set:function(t){this._endArrowheadWidth=t,this.Dirty(256)}}),a(n,"InsetPen",{get:function(){return this.IsDirty(512)||s(this._parent)?this._insetPen:this._parent.InsetPen},set:function(t){this._insetPen=t,this.Dirty(512)}}),a(n,"Pattern",{get:function(){return this.FillInternal.Pattern},set:function(t){this.FillInternal._SetPattern(t)}}),a(n,"PresetGradientType",{get:function(){return this.FillInternal.PresetGradientType}}),n._SetPresetGradientType=function(t){this.FillInternal._SetPresetGradientType(t)},a(n,"GradientAngle",{get:function(){return this.FillInternal.GradientAngle},set:function(t){this.FillInternal.GradientAngle=t}}),a(n,"GradientColorType",{get:function(){return this.FillInternal.GradientColorType}}),a(n,"GradientDegree",{get:function(){return this.FillInternal.GradientDegree}}),n._SetGradientDegree=function(t){this.FillInternal._SetGradientDegree(t)},a(n,"GradientStops",{get:function(){return this.FillInternal.GradientStops}}),a(n,"GradientStyle",{get:function(){return this.FillInternal.GradientStyle}}),n._SetGradientStyle=function(t){this.FillInternal._SetGradientStyle(t)},a(n,"GradientVariant",{get:function(){return this.FillInternal.GradientVariant}}),n._SetGradientVariant=function(t){this.FillInternal._SetGradientVariant(t)},a(n,"Style",{get:function(){return this.IsDirty(2048)||s(this._parent)?this._style:this._parent.Style},set:function(t){this._style=t,this.Dirty(2048)}}),a(n,"Transparency",{get:function(){return this.FillInternal.Transparency},set:function(t){this.FillInternal.Transparency=t}}),a(n,"Visible",{get:function(){return this.IsDirty(8192)||s(this._parent)?this._visible:this._parent.Visible},set:function(t){this._visible=t,this.Dirty(8192)}}),a(n,"Weight",{get:function(){return this.IsDirty(16384)||s(this._parent)?this._weight:this._parent.Weight},set:function(t){this._weight=t,this.Dirty(16384)}}),n.OneColorGradient=function(t,e,i){this.FillInternal.OneColorGradient(t,e,i)},n.TwoColorGradient=function(t,e){this.FillInternal.TwoColorGradient(t,e)},n.PresetGradient=function(t,e,i){this.FillInternal.PresetGradient(t,e,i)},n.Solid=function(){this.FillInternal.Solid()},n.Patterned=function(t){this.FillInternal.Patterned(t)},a(n,"FillInternal",{get:function(){return this._fill||(this._fill=new l(this._context,this._parent&&this._parent.FillInternal,this._autoColorFormat)),this._fill}}),a(n,"Type",{get:function(){return this.FillInternal.Type}}),n.GetState=function(e,i){var n=this._fill;if(n){if(1===e&&n.Color)return n.Color.IsDirtyIncludingParent(i);if(2===e&&n.PatternColor)return n.PatternColor.IsDirtyIncludingParent(i)}return t.prototype.GetState.call(this,e,i)},n.IsDirtyIncludingParent=function(e){var i=this._fill;return!(!i||!i.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e)},n.OnParentChanged=function(t){this._parent=t;var e=this._fill;e&&t&&(e.ParentStateful=t.FillInternal)},n.FromOOModel=function(t){this._ooLineProps=t,this.FromCT_LineProperties(t)},n.ToOOModel=function(){return this.ToCT_LineProperties()},n.FromCT_LineProperties=function(t){s(t.solidFill)?s(t.pattFill)?s(t.gradFill)?s(t.noFill)||(this.FillInternal.ColorInternal.ColorType=0):this.FillInternal.FromOOModel(t.gradFill,2):this.FillInternal.FromOOModel(t.pattFill,1):this.FillInternal.FromOOModel(t.solidFill,0),s(t.headEnd)||this.FromCT_LineEndProperties(t.headEnd),s(t.tailEnd)||this.FromCT_TailLineEndProperties(t.tailEnd),!s(t.w)&&t.w>=0?this.Weight=t.w:(this._weight=-1,this.UnDirty(16384)),s(t.cmpd)||(this.Style=t.cmpd),this.Round=!!t.round,s(t.prstDash)?this.UnDirty(32):this.DashStyle=t.prstDash},n.ToCT_LineProperties=function(){var t=this._ooLineProps;if(!this.IsDirtyIncludingParent()&&!s(t))return t;var e,i=t||{};if(delete i.gradFill,delete i.noFill,delete i.pattFill,delete i.solidFill,this._visible){if(!s(this._fill)){var n=this._fill.ToOOModel();0===n.colorFillType?i.solidFill=n:1===n.colorFillType?i.pattFill=n:2===n.colorFillType?i.gradFill=n:5===n.colorFillType&&(i.noFill=!0),delete n.colorFillType}}else i.noFill=!0;return(e=this.ToCT_HeadLineEndProperties())&&(i.headEnd=e),(e=this.ToCT_TailLineEndProperties())&&(i.tailEnd=e),this.Weight>=0&&(i.w=this.Weight),this.GetState(2048,!0)&&(i.cmpd=this.Style),this.GetState(32,!0)&&(i.prstDash=this.DashStyle),this.Round&&(i.round=!0),i},n.FromCT_LineEndProperties=function(t){this._beginArrowheadStyle=t.type,this._beginArrowheadWidth=t.w,this._beginArrowheadLength=t.len,this.SetState(8,!0),this.SetState(16,!0),this.SetState(4,!0)},n.ToCT_HeadLineEndProperties=function(){var t={w:1,len:1},e=!1;return this.GetState(8,!0)&&(t.type=this.BeginArrowheadStyle,e=!0),this.GetState(16,!0)&&(t.w=this.BeginArrowheadWidth,e=!0),this.GetState(4,!0)&&(t.len=this.BeginArrowheadLength,e=!0),e?t:u},n.FromCT_TailLineEndProperties=function(t){if(!s(t)){this._endArrowheadStyle=t.type,this._endArrowheadWidth=t.w,this._endArrowheadLength=t.len,this.SetState(128,!0),this.SetState(256,!0),this.SetState(64,!0)}},n.ToCT_TailLineEndProperties=function(){var t={w:1,len:1},e=!1;return this.GetState(128,!0)&&(t.type=this.EndArrowheadStyle,e=!0),this.GetState(256,!0)&&(t.w=this.EndArrowheadWidth,e=!0),this.GetState(64,!0)&&(t.len=this.EndArrowheadLength,e=!0),e?t:u},n.Clone=function(){var t=new i(this._context);return t._fill=this._fill&&this._fill.Clone(),t._beginArrowheadLength=this._beginArrowheadLength,t._beginArrowheadStyle=this._beginArrowheadStyle,t._beginArrowheadWidth=this._beginArrowheadWidth,t._dashStyle=this._dashStyle,t._endArrowheadLength=this._endArrowheadLength,t._endArrowheadStyle=this._endArrowheadStyle,t._endArrowheadWidth=this._endArrowheadWidth,t._insetPen=this._insetPen,t._visible=this._visible,t._weight=this._weight,t._states=this._states,t._parent=this._parent,t},i}(r);n.LineFormat=h,t.exports=n}()},function(t,e,i){"use strict";!function(){var e=i(2)._Types,n=e._extend,r=e._inherit,o=i(0),a=i(1),s=a.ChartUtility.defineProperty,l=i(4).StatefullBase,u=a.ShapeConstants.PositiveFixedAngleConvert,h=a.UnitHelper.isNullOrUndefined;o.ThreeDFormatStates={BevelBottomDepth:1,BevelBottomInset:2,BevelBottomType:4,BevelTopDepth:8,BevelTopInset:16,BevelTopType:32,ContourColor:64,ContourWidth:128,Depth:256,ExtrusionColor:512,ExtrusionColorType:1024,FieldOfView:2048,LightAngle:4096,Perspective:8192,PresetCamera:16384,PresetExtrusionDirection:32768,PresetLighting:65536,PresetLightingDirection:131072,PresetLightingSoftness:262144,PresetMaterial:524288,PresetThreeDFormat:1048576,ProjectText:2097152,RotationX:4194304,RotationY:8388608,RotationZ:16777216,Visible:33554432,Z:67108864,AutoScale:134217728,DepthPercent:268435456,HeightPercent:536870912,RightAngleAxes:1073741824};var c=null,p=function(t){function e(e,i){t.call(this,i);this._bevelBottomType=0,this._bevelTopType=0,this._extrusionColorType=0,this._fieldOfView=45,this._visible=!0,this._dicCameraType=c,this._autoScale=!0,this._depthPercent=100,this._heightPercent=100,this._rightAngleAxes=!0,this._context=e,this._perspective=30,this._parent=i,this._SetPresetCamera(62)}r(e,t);var i=e.prototype;return s(i,"Perspective",{get:function(){return this.Dirty(32768)||h(this._parent)?this._perspective:this._parent.Perspective},set:function(t){this._perspective=t,this.Dirty(32768)}}),s(i,"PresetCamera",{get:function(){return this.Dirty(16384)||h(this._parent)?this._presetCamera:this._parent.PresetCamera}}),s(i,"RotationX",{get:function(){return this.Dirty(4194304)||h(this._parent)?this.Visible?this._rotationX:0:this._parent.RotationX},set:function(t){t!==this._rotationX&&(this._rotationX=t,this.Dirty(4194304),this.UpdatePresetCamera())}}),s(i,"RotationY",{get:function(){return this.Dirty(8388608)||h(this._parent)?this.Visible?this._rotationY:0:this._parent.RotationY},set:function(t){if(1===this._context.DrawingType){if(t<-90&&t>=180)return}else if(t<0&&t>=360)return;this._rotationY=t,this.Dirty(8388608),this.UpdatePresetCamera()}}),s(i,"RotationZ",{get:function(){return this.Dirty(16777216)||h(this._parent)?this.Visible?this._rotationZ:0:this._parent.RotationZ},set:function(t){t!==this._rotationZ&&(this._rotationZ=t,this.Dirty(16777216),this.UpdatePresetCamera())}}),s(i,"Visible",{get:function(){return this.Dirty(33554432)||h(this._parent)?this._visible:this._parent.Visible},set:function(t){this._visible=t,this.Dirty(33554432)}}),s(i,"Z",{get:function(){return this.Dirty(67108864)||h(this._parent)?this.Visible?this._z:0:this._parent.Z},set:function(t){this._z=t,this.Dirty(67108864),this.UpdatePresetCamera()}}),s(i,"Depth",{get:function(){return this.Dirty(256)||h(this._parent)?this.Visible?this._depth:0:this._parent.Depth},set:function(t){this._depth=t,this.Dirty(256),this.UpdatePresetCamera()}}),s(i,"DicCameraType",{get:function(){return h(this._dicCameraType)&&this.InitDicCameraType(),this._dicCameraType}}),s(i,"_InternalVisible",{get:function(){return this._visible},set:function(t){this._visible=t}}),s(i,"_AutoScale",{get:function(){return this._autoScale},set:function(t){this._autoScale=t,this.Dirty(134217728)}}),s(i,"_DepthPercent",{get:function(){return this._depthPercent},set:function(t){t>=20&&t<=2e3&&(this._depthPercent=t,this.Dirty(268435456))}}),s(i,"_HeightPercent",{get:function(){return this._heightPercent},set:function(t){t>=5&&t<=500&&(this._heightPercent=t,this.Dirty(536870912))}}),s(i,"_RightAngleAxes",{get:function(){return this._rightAngleAxes},set:function(t){this._rightAngleAxes=t,this.Dirty(1073741824)}}),n(i,{_SetPresetCamera:function(t){this._presetCamera=t,this.Dirty(16384)},InitDicCameraType:function(){var t=this._dicCameraType={};t[0]=[0,0,0],t[1]=[0,0,0],t[2]=[0,0,0],t[3]=[0,0,0],t[4]=[0,0,0],t[5]=[0,0,0],t[6]=[0,0,0],t[7]=[0,0,0],t[8]=[0,0,0],t[9]=[0,0,0],t[10]=[0,0,0],t[11]=[0,0,0],t[12]=[0,0,0],t[13]=[0,0,0],t[14]=[0,0,0],t[15]=[0,0,0],t[16]=[0,0,0],t[17]=[0,0,0],t[18]=[0,0,0],t[19]=[314.7191,324.6037,60.16242],t[20]=[45.28088,324.6037,299.8376],t[21]=[45.28088,35.39627,60.16242],t[22]=[314.7191,35.39627,299.8376],t[23]=[45,325,0],t[24]=[45,35,0],t[25]=[315,35,0],t[26]=[315,325,0],t[27]=[64,18,0],t[28]=[334,18,0],t[29]=[306.5457,301.2619,57.6425],t[30]=[26,18,0],t[31]=[296,18,0],t[32]=[53.45424,301.2619,302.3575],t[33]=[64,342,0],t[34]=[334,342,0],t[35]=[306.5457,58.73808,302.3575],t[36]=[26,342,0],t[37]=[296,342,0],t[38]=[53.45424,58.73808,57.64252],t[39]=[0,0,0],t[40]=[0,0,0],t[41]=[0,0,0],t[42]=[0,0,0],t[43]=[0,0,0],t[44]=[0,0,0],t[45]=[0,0,0],t[46]=[0,0,0],t[47]=[0,0,0],t[48]=[20,0,0],t[49]=[340,0,0],t[50]=[0,340,0],t[51]=[0,20,0],t[52]=[14.33758,39.30647,341.1238],t[53]=[345.6624,39.30647,18.87615],t[54]=[43.93887,10.39642,356.4465],t[55]=[316.0611,10.39642,3.553517],t[56]=[14.29302,348.9837,2.626817],t[57]=[345.7069,348.9837,357.3732],t[58]=[34.46068,8.12245,357.0914],t[59]=[325.5393,8.12245,2.9086],t[60]=[0,309.5601,0],t[61]=[0,324.844,0]},SetPresetCamera:function(t){this._presetCamera=t,this.Dirty(16384)},UpdatePresetCamera:function(){62===this._presetCamera&&this.SetPresetCamera(18)},IncrementRotationX:function(t){this.RotationX+=t},IncrementRotationY:function(t){this.RotationY+=t},IncrementRotationZ:function(t){this.RotationZ+=t},ResetRotation:function(){this.RotationX=0,this.RotationY=0,this.RotationZ=0},Clone:function(){var t=new e(this._context);return t._bevelBottomDepth=this._bevelBottomDepth,t._bevelBottomInset=this._bevelBottomInset,t._bevelBottomType=this._bevelBottomType,t._bevelTopDepth=this._bevelTopDepth,t._bevelTopInset=this._bevelTopInset,t._bevelTopType=this._bevelTopType,h(this._contourColor)||(t._contourColor=this._contourColor.Clone()),t._contourWidth=this._contourWidth,t._depth=this._depth,h(this._extrusionColor)||(t._extrusionColor=this._extrusionColor.Clone()),t._extrusionColorType=this._extrusionColorType,t._fieldOfView=this._fieldOfView,t._lightAngle=this._lightAngle,t._perspective=this._perspective,t._presetCamera=this._presetCamera,t._presetExtrusionDirection=this._presetExtrusionDirection,t._presetLighting=this._presetLighting,t._presetLightingDirection=this._presetLightingDirection,t._presetLightingSoftness=this._presetLightingSoftness,t._presetMaterial=this._presetMaterial,t._presetThreeDFormat=this._presetThreeDFormat,t._projectText=this._projectText,t._rotationX=this._rotationX,t._rotationY=this._rotationY,t._rotationZ=this._rotationZ,t._visible=this._visible,t._z=this._z,t._states=this._states,t._parent=this._parent,t},IsDirtyIncludingParent:function(e){return!(!this._contourColor||!this._contourColor.IsDirtyIncludingParent(e))||(!(!this._extrusionColor||!this._extrusionColor.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e))},OnParentChanged:function(t){this._parent=t,h(this._parent)&&(this._contourColor&&(this._contourColor.ParentStateful=c),this._extrusionColor&&(this._extrusionColor.ParentStateful=c))},FromOOModel:function(t){this._ooModel=t,this.FromCT_Scene3D(this._ooModel.Scene3D),this.FromCT_View3D(this._ooModel.View3D),this.FromCT_Shape3D(this._ooModel.Shape3D)},ToOOModel:function(){var t=this._ooModel||{};return t.View3D=this.ToCT_View3D(),62!==this.PresetCamera&&(t.Scene3D=this.ToCT_Scene3D()),(this.IsPropDirtyIncludingParent(256,!0)||this.IsPropDirtyIncludingParent(67108864,!0))&&(t.Shape3D=this.ToCT_Shape3D()),t},FromCT_View3D:function(t){h(t)||(h(t.hPercent)||(this._HeightPercent=t.hPercent),h(t.depthPercent)||(this._DepthPercent=t.depthPercent),h(t.rotX)||(this.RotationY=t.rotX),h(t.rotY)||(this.RotationX=t.rotY),h(t.rAngAx)?this._RightAngleAxes=!1:this._RightAngleAxes=t.rAngAx,h(t.perspective)||(this.Perspective=t.perspective/2))},ToCT_View3D:function(){var t=this._ooModel&&this._ooModel.View3D||{};return!this._AutoScale&&this.IsDirty(536870912)&&(t.hPercent=this._HeightPercent),this.IsDirty(268435456)&&(t.depthPercent=this._DepthPercent),this.IsDirty(8388608)&&(t.rotX=this.RotationY),this.IsDirty(4194304)&&(t.rotY=this.RotationX),this.IsDirty(1073741824)&&(t.rAngAx=this._RightAngleAxes),!this._RightAngleAxes&&this.IsDirty(32768)&&(t.perspective=2*this.Perspective),t},FromCT_Scene3D:function(t){h(t)||this.FromCT_Camera(t.camera)},ToCT_Scene3D:function(){var t=this._ooModel,e=t&&t.Scene3D||{};return e.camera=this.ToCT_Camera(),!h(e.camera)&&h(e.lightRig)&&(e.lightRig=this.ToDefaultCT_LightRig()),h(e.camera)&&h(e.backdrop)&&h(e.lightRig)?c:e},GetActualCT_Scene3D:function(){return h(this._ooModel)||h(this._ooModel.Scene3D)?h(this._parent)?c:this.GetActualCT_Scene3D():this._ooModel.Scene3D},FromCT_Shape3D:function(t){h(t)||(0!==t.extrusionH&&(this.Depth=t.extrusionH,this.Dirty(256)),0!==t.z&&(this.Z=t.z,this.Dirty(67108864)))},ToCT_Shape3D:function(){var t=this._ooModel,e=t&&t.Shape3D||{z:0,extrusionH:0,contourW:0,prstMaterial:7};return e.extrusionH=this.Depth,e.z=this.Z,e},ToDefaultCT_LightRig:function(){return{rig:12,dir:0}},FromCT_Camera:function(t){h(t)||(this._SetPresetCamera(t.prst),h(t.rot)||this.FromCameraCT_SphereCoords(t.rot))},ToCT_Camera:function(){if(0===this._context.DrawingType||4===this._context.DrawingType){var t={zoom:1e5};return t.prst=this.PresetCamera,t.rot=this.ToCameraCT_SphereCoords(),t}var e=this._ooModel;return e&&e.Scene3D&&e.Scene3D.camera||c},FromCameraCT_SphereCoords:function(t){h(t)||(this.RotationX=t.lon/u,this.RotationY=t.lat/u,this.RotationZ=t.rev/u)},ToCameraCT_SphereCoords:function(){if(0===this.RotationX&&0===this.RotationY&&0===this.RotationZ)return c;var t={},e=this.RotationX,i=this.RotationY,n=this.RotationZ;return t.lon=e*u,t.lat=i*u,t.rev=n*u,t}}),e}(l);o.ThreeDFormat=p,t.exports=o}()},function(t,e,i){"use strict";!function(){var e=i(2)._Types._inherit,n=i(0),r=i(4).StatefullBase,o=i(1),a=o.ShapeConstants,s=o.ChartUtility.defineProperty,l=o.NumberExtension,u=o.UnitHelper.isNullOrUndefined,h=Math.floor,c=Math.sqrt,p=function(t){function i(e,i){t.call(this);this._blur=5,this._obscured=!1,this._offsetX=a.DefaultOffset,this._offsetY=a.DefaultOffset,this._rotateWithShape=!1,this._size=100,this._transparency=0,this._visible=!1,this.presetShadowOffset=-6,this._context=e,this._parent=i}e(i,t);var r=i.prototype;return r.OnStyleChange=function(){this._blur=0,this._offsetX=0,this._offsetY=0,this._size=100,this._transparency=0,this.UnDirty(256),0===this.Style?this._rotateWithShape=!1:1===this.Style&&(this._rotateWithShape=!0)},r.OnTypeChange=function(){this._blur=5,this._offsetX=this.presetShadowOffset,this._offsetY=this.presetShadowOffset,this._size=100,this._transparency=.5,this.UnDirty(64)},r.GetDefaultColor=function(){var t=new n.ColorFormat(this._context,this._parent&&this._parent._foreColor);return t.ColorType=0,t},s(r,"ForeColor",{get:function(){return u(this._foreColor)&&(this._foreColor=this.GetDefaultColor()),this._foreColor}}),s(r,"Obscured",{get:function(){return this.GetState(2)||u(this._parent)?this._obscured:this._parent.Obscured},set:function(t){this._obscured=t,this.SetState(2,!0)}}),s(r,"Blur",{get:function(){return this.GetState(1)||u(this._parent)?this._blur:this._parent.Blur},set:function(t){this._blur=t,this.SetState(1,!0)}}),s(r,"OffsetX",{get:function(){return this.GetState(4)||u(this._parent)?this._offsetX:this._parent.OffsetX},set:function(t){this._offsetX=t,this.SetState(4,!0)}}),s(r,"OffsetY",{get:function(){return this.GetState(8)||u(this._parent)?this._offsetY:this._parent.OffsetY},set:function(t){this._offsetY=t,this.SetState(8,!0)}}),s(r,"RotateWithShape",{get:function(){return this.GetState(16)||u(this._parent)?this._rotateWithShape:this._parent.RotateWithShape},set:function(t){0===this.Style||this.GetState(256)||(this._rotateWithShape=t,this.SetState(16,!0))}}),s(r,"Size",{get:function(){return this.GetState(32)||u(this._parent)?this._size:this._parent.Size},set:function(t){this._size=t,this.SetState(32,!0)}}),s(r,"Style",{get:function(){return this.GetState(64)||u(this._parent)?this._style:this._parent.Style},set:function(t){this.Style!==t&&this.OnStyleChange(),this._style=t,this.SetState(64,!0)}}),s(r,"Transparency",{get:function(){return this.GetState(128)||u(this._parent)?this._transparency:this._parent.Transparency},set:function(t){this._transparency=t,this.SetState(128,!0)}}),s(r,"Type",{get:function(){return this.GetState(256)||u(this._parent)?this._type:this._parent.Type},set:function(t){this._type=t,this.SetState(256,!0),this.OnTypeChange()}}),s(r,"Visible",{get:function(){return this.GetState(512)||u(this._parent)?this._visible:this._parent.Visible},set:function(t){this._visible=t,this.SetState(512,!0),!1===t||this.GetState(64)||(this._style=1)}}),r.IncrementOffsetX=function(t){this.OffsetX+=t},r.IncrementOffsetY=function(t){this.OffsetY+=t},r.FromOOModel=function(t){this._ooModel=t},r.ToOOModel=function(){return this._ooModel},r.ToCT_PresetShadowEffect=function(){var t=this.OffsetX,e=this.OffsetY,i=c(t*t+e*e),n={dist:0,dir:0};return n.dist=i,n.dir=h(l.GetTriangleAngle(t,e,i)*a.PositiveFixedAngleConvert),n.prst=this.Type,this.ToCT_Color(n),n},r.ToCT_InnerShadowEffect=function(){var t=this.OffsetX,e=this.OffsetY,i=c(t*t+e*e),n={blurRad:0,dist:0,dir:0};return n.blurRad=this.Blur,n.dist=i,0===t&&0===e||(n.dir=h(l.GetTriangleAngle(t,e,i)*a.PositiveFixedAngleConvert)),n.scrgbClr=this.ToCT_ScRgbColor(),n},r.ToCT_OuterShadowEffect=function(){var t=this.OffsetX,e=this.OffsetY,i=c(t*t+e*e),n={blurRad:0,dist:0,dir:0,sx:1e5,sy:1e5,kx:0,ky:0,algn:7,rotWithShape:!0};return n.blurRad=this.Blur,n.dist=i,0===t&&0===e||(n.dir=h(l.GetTriangleAngle(t,e,i)*a.PositiveFixedAngleConvert)),n.rotWithShape=!0===this.RotateWithShape,n.sx=h(this.Size*a.RelativeRectConver),n.sy=h(this.Size*a.RelativeRectConver),n.scrgbClr=this.ToCT_ScRgbColor(),n},r.ToCT_Color=function(t){if(!u(this._foreColor))if(3===this._foreColor.ColorType){var e={};if(e.val=this._foreColor.ObjectThemeColor,0!==this._foreColor.Brightness){var i=h(1e5*this._foreColor.Brightness);e.lumMod=[i];var n=h(1e5*(1-this._foreColor.Brightness));e.lumOff=[n]}if(this._foreColor.TintAndShade>0&&this._foreColor.TintAndShade<1){var r=h(this._foreColor.TintAndShade*a.ShadeConver);e.shade=[r]}t.schemeClr=e}else if(2===this._foreColor.ColorType){var o={};o.val=[this._foreColor.RGB.R,this._foreColor.RGB.G,this._foreColor.RGB.B],0!==this._foreColor.Brightness&&(i=h(1e5*this._foreColor.Brightness),o.lumMod=[i],n=h(1e5*(1-this._foreColor.Brightness)),o.lumOff=[n]),0!==this.Transparency&&(r=h(this.Transparency*a.PositiveFixedPercentageConvert),o.alpha=[r]),t.srgbClr=o}},r.ToCT_ScRgbColor=function(){var t={};if(0!==this.Transparency){var e=h(this.Transparency*a.PositiveFixedPercentageConvert);t.alpha=[e]}return t},r.SetState=function(e,i){t.prototype.SetState.call(this,e,i),1!==e&&4!==e&&8!==e&&16!==e&&32!==e&&128!==e||this.GetState(64)||(this._style=1)},i}(r);n.ShadowFormat=p;var f=function(t){function i(e){return t.call(this,e),this}e(i,t);var n=i.prototype;return n.FromOOModel=function(t){this._ooModel=t},n.ToOOModel=function(){return this._ooModel},i}(r);n.SoftEdgeFormat=f;var _=function(t){function i(e,i){t.call(this);return this._size=100,this._type=1,this.presetShadowOffset=-6,this._context=e,this._parent=i,this}e(i,t);var n=i.prototype;return s(n,"Blur",{get:function(){return this.GetState(1)||u(this._parent)?this._blur:this._parent.Blur},set:function(t){this._blur=t,this.SetState(1,!0)}}),s(n,"Offset",{get:function(){return this.GetState(2)||u(this._parent)?this._offset:this._parent.Offset},set:function(t){this._offset=t,this.SetState(2,!0)}}),s(n,"Size",{get:function(){return this.GetState(4)||u(this._parent)?this._size:this._parent.Size},set:function(t){this._size=t,this.SetState(4,!0)}}),s(n,"Transparency",{get:function(){return this.GetState(8)||u(this._parent)?this._transparency:this._parent.Transparency},set:function(t){this._transparency=t,this.SetState(8,!0)}}),n.FromOOModel=function(t){this._ooModel=t},n.ToOOModel=function(){return this._ooModel},n.OnTypeChange=function(){this._blur=5,this._offset=this.presetShadowOffset,this._size=100,this._transparency=.5},i}(r);n.ReflectionFormat=_;var d=function(t){function i(e,i){t.call(this),this._context=e,this._parent=i}e(i,t);var r=i.prototype;return s(r,"Color",{get:function(){return u(this._color)&&(this._color=this.GetDefaultColor()),this._color}}),s(r,"Radius",{get:function(){return this.GetState(2)||u(this._parent)?this.radius:this._parent.Radius},set:function(t){this.radius=t,this.Dirty(2)}}),s(r,"Transparency",{get:function(){return this.GetState(4)||u(this._parent)?this._transparency:this._parent.Transparency},set:function(t){this._transparency=t,this.Dirty(4)}}),r.FromOOModel=function(t){this._ooModel=t},r.ToOOModel=function(){return this._ooModel},r.GetDefaultColor=function(){var t=new n.ColorFormat(this._context,this._parent&&this._parent.Color);return t.ColorType=0,t},r.SetState=function(e,i){t.prototype.SetState.call(this,e,i),2!==e&&4!==e||this._color&&0===this._color.ColorType&&(this._color.ColorType=2)},r.ToCT_Color=function(t){var e=this._color;if(!u(e)){var i=e.colorType,n=e.Brightness;if(3===i){var r={};if(r.val=e.ObjectThemeColor,0!==n){var o=h(1e5*n);r.lumMod=[o];var s=h(1e5*(1-n));r.lumOff=[s]}if(e.TintAndShade>0&&e.TintAndShade<1){var l=h(e.TintAndShade*a.ShadeConver);r.shade=[l]}t.schemeClr=r}else if(2===i){var c={};c.val=[e.RGB.R,e.RGB.G,e.RGB.B],0!==n&&(o=h(1e5*n),c.lumMod=[o],s=h(1e5*(1-n)),c.lumOff=[s]),0!==this.Transparency&&(l=h(this.Transparency*a.PositiveFixedPercentageConvert),c.alpha=[l]),t.srgbClr=c}}},i}(r);n.GlowFormat=d,t.exports=n}()},function(t,e,i){"use strict";!function(){var e=i(2)._Types._inherit,n=i(0),r=i(4).StatefullBase,o=i(1),a=o.ChartUtility,s=a.defineProperty,l=o.ChartConstants,u=o.UnitHelper.isNullOrUndefined,h=i(11).FillFormat,c=i(26).FontData,p=i(6),f=null,_=void 0,d={Bold:1,Color:2,Italic:4,Name:8,OutlineFont:16,Shadow:32,Size:64,Strikethrough:128,Subscript:256,Superscript:512,ThemeFont:1024,Underline:2048};n.TextFieldType={CellRange:0,SeriesName:1,CategoryName:2,Value:3,XValue:4,YValue:5,BubbleSize:6,Percentage:7,TxLink:8};var g=function(t){function i(e,i,n){i===_&&(i=f),n===_&&(n=f),t.call(this,i);return this._themeFont=0,this._eaFontName=f,this._latinFontName=f,this._csFontName=f,this._context=e,this._fill=new h(e,i&&i.FillInternal),this._parent=i,n&&(u(n.Size)||(this._size=n.Size),u(n.Bold)||(this._bold=n.Bold)),this}e(i,t);var n=i.prototype;return s(n,"Bold",{get:function(){var t=this._parent;return t&&!this.GetState(1)?t.Bold:this._bold},set:function(t){this._bold=t,this.SetState(1,!0)}}),s(n,"Color",{get:function(){return this.FillInternal.Color}}),s(n,"Italic",{get:function(){var t=this._parent;return t&&!this.GetState(4)?t.Italic:this._italic},set:function(t){this._italic=t,this.SetState(4,!0)}}),s(n,"Name",{get:function(){var t=this._parent;return t&&!this.HasOwnFont()?t.Name:this.GetOwnFont()},set:function(t){this.SetFont(t),this.ClearOOFontNames()}}),s(n,"Size",{get:function(){var t=this._parent;return t&&!this.GetState(64)?t.Size:this._size},set:function(t){this._size=t,this.SetState(64,!0)}}),s(n,"Strikethrough",{get:function(){var t=this._parent;return t&&!this.GetState(128)?t.Strikethrough:this._strikethrough},set:function(t){this._strikethrough=t,this.SetState(128,!0)}}),s(n,"Subscript",{get:function(){var t=this._parent;return t&&!this.GetState(256)?t.Subscript:this._subscript},set:function(t){this._subscript=t,this.SetState(256,!0)}}),s(n,"Superscript",{get:function(){var t=this._parent;return t&&!this.GetState(512)?t.Superscript:this._superscript},set:function(t){this._superscript=t,this.SetState(512,!0)}}),s(n,"Underline",{get:function(){var t=this._parent;return t&&!this.GetState(2048)?t.Underline:this._underline},set:function(t){this._underline=t,this.SetState(2048,!0)}}),s(n,"ThemeFont",{get:function(){var t=this._parent;return t&&!this.GetState(1024)?t.ThemeFont:this._themeFont},set:function(t){this.SetThemeFont(t),this.ClearOOFontNames()}}),n.IsDirtyIncludingParent=function(e){return!(!this._fill||!this._fill.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e)},n.HasOwnFont=function(){return this.IsDirty(8)||this.IsDirty(1024)},n.OnParentChanged=function(t){this._parent=t,this._fill&&(this._fill.ParentStateful=t&&t.FillInternal)},n.GetOwnFont=function(){return 0===this._themeFont?this._name:this._context._ToFont(this._themeFont)},n.SetFont=function(t){t===l.CHART_CS_HEAD_FONT||t===l.CHART_EA_HEAD_FONT||t===l.CHART_LATIN_HEAD_FONT?this.SetThemeFont(1):t===l.CHART_CS_BODY_FONT||t===l.CHART_EA_BODY_FONT||t===l.CHART_LATIN_BODY_FONT?this.SetThemeFont(2):(this._name=t,this.SetState(8,!0),this._themeFont=0,this.SetState(1024,!1))},n.SetThemeFont=function(t){this._themeFont=t,this.SetState(1024,!0),this._name=f,this.SetState(8,!1)},n.ClearOOFontNames=function(){this._latinFontName=f,this._csFontName=f,this._eaFontName=f},n.GetActualFormat=function(){var t=new i(this._context);for(var e in d){var n=d[e];if(this.IsDirty(n))switch(n){case 1:t.Bold=this.Bold;break;case 4:t.Italic=this.Italic;break;case 8:t.Name=this.Name;break;case 64:t.Size=this.Size;break;case 128:t.Strikethrough=this.Strikethrough;break;case 256:t.Superscript=this.Superscript;break;case 512:t.Subscript=this.Subscript;break;case 1024:t.ThemeFont=this.ThemeFont;break;case 2048:t.Underline=this.Underline}}return t},s(n,"FillInternal",{get:function(){return this._fill||(this._fill=new h(this._context,this._parent&&this._parent.FillInternal)),this._fill}}),n.TextCharacterProperties_FromOOModel=function(t){if(this.SuspendClearChildrenState(),this._ooTextCharacterProps=t,u(t.latin)||(this._latinFontName=t.latin.typeface),u(t.ea)||(this._eaFontName=t.ea.typeface),u(t.cs)||(this._csFontName=t.cs.typeface),this._latinFontName?this.SetFont(this._latinFontName):this._eaFontName?this.SetFont(this._eaFontName):this._csFontName&&this.SetFont(this._csFontName),u(t.sz))this._size=0,this.SetState(64,!1);else{var e=t.sz;this._size!==e&&(this.Size=e)}u(t.b)||(this.Bold=t.b),u(t.i)||(this.Italic=t.i),u(t.strike)||(this.Strikethrough=1===t.strike||2===t.strike),u(t.u)||(this.Underline=t.u),u(t.baseline)||0===t.baseline?this.Subscript=!1:this.Subscript=!0,u(t.solidFill)?u(t.noFill)?u(t.blipFill)?u(t.gradFill)?u(t.pattFill)?this.SetFillField(f):this.FillInternal.FromOOModel(t.pattFill,1):this.FillInternal.FromOOModel(t.gradFill,2):this.FillInternal.FromOOModel(t.blipFill,3):this.FillInternal.Color.ColorType=0:this.FillInternal.FromOOModel(t.solidFill,0),this.ResumeClearChilrenState()},n.AdjustStateful=function(t,e){u(t)||(t.SetParentForChildren(e),u(e)||(e.ParentStateful=t.ParentStateful),t.ParentStateful=f)},n.SetFillField=function(t){this.AdjustStateful(this._fill,t),this._fill=t},n.TextCharacterProperties_ToOOModel=function(){if(!this.IsDirtyIncludingParent(!0))return{};var t=this._ooTextCharacterProps||{};if(this.IsPropDirtyIncludingParent(8,!0)){var e=this.Name;u(t.latin)&&(t.latin={}),t.latin.typeface=e}else this.IsPropDirtyIncludingParent(1024,!0)&&0!==this.ThemeFont?(u(t.latin)&&(t.latin={}),t.latin.typeface=1===this.ThemeFont?l.CHART_LATIN_HEAD_FONT:l.CHART_LATIN_BODY_FONT):(this._latinFontName||this._eaFontName||this._csFontName)&&(this._latinFontName&&(u(t.latin)&&(t.latin={}),t.latin.typeface=this._latinFontName),this._eaFontName&&(u(t.ea)&&(t.ea={}),t.ea.typeface=this._eaFontName),this._csFontName&&(u(t.cs)&&(t.cs={}),t.cs.typeface=this._csFontName));if(this.IsPropDirtyIncludingParent(64,!0)&&this.Size>1?t.sz=this.Size:delete t.sz,this.IsPropDirtyIncludingParent(1,!0)&&(t.b=this.Bold),this.IsPropDirtyIncludingParent(4,!0)&&(t.i=this.Italic),this.IsPropDirtyIncludingParent(128,!0)&&(t.strike=this.Strikethrough?1:0),this.IsPropDirtyIncludingParent(2048,!0)&&(t.u=this.Underline),this.Subscript&&u(t.baseline)?t.baseline=-25e3:this.Superscript&&u(t.baseline)?t.baseline=3e4:this.Subscript||this.Superscript||delete t.baseline,delete t.solidFill,delete t.blipFill,delete t.gradFill,delete t.grpFill,delete t.noFill,delete t.pattFill,delete t.uFill,delete t.uFillTx,!u(this._fill)&&this._fill.IsDirtyIncludingParent(!0)){var i=this._fill.ToOOModel(),n=i.colorFillType;0===n?t.solidFill=i:1===n?t.pattFill=i:2===n?t.gradFill=i:3===n?t.blipFill=i:5===n&&(t.noFill=!0),delete i.colorFillType}return t},n.FromOOModel=function(t){this.Bold=t.Bold,this.Italic=t.Italic,this.Name=t.Name,0!==t.Scheme&&(this.ThemeFont=t.Scheme),this.Size=t.Size,this.Underline=a.ConvertToTextUnderlineType(t.Underline),this.Strikethrough=t.Strike,this.Subscript=2==(2&t.VertAlign),this.Superscript=1==(1&t.VertAlign),this.FillInternal.ColorInternal.ColorData_FromOOModel(t.Color)},n.ToOOModel=function(){var t=new c;t.Bold=this.Bold,t.Italic=this.Italic,t.Name=this.Name,t.Scheme=this.ThemeFont,t.Size=this.Size,t.Underline=a.ToUnderlineType(this.Underline),t.Strike=this.Strikethrough,this.Subscript?t.VertAlign=2:this.Superscript&&(t.VertAlign=1);var e=this._fill;return e&&e.ColorInternal.IsDirtyIncludingParent(!0)&&0!==e.ColorInternal.ColorType&&(t.Color=e.ColorInternal.ColorData_ToOOModel()),t},i}(r);n.FontFormat=g;var y=function(){function t(t,e){this._context=t,this._textParagraph=e,this._font=new g(t),this._font.ParentStateful=e.Font}var e=t.prototype;return s(e,"Font",{get:function(){return this._font}}),s(e,"Text",{get:function(){return""}}),s(e,"IsCustomText",{get:function(){return!1}}),e.Delete=function(){this._textParagraph.DeleteElement(this),this._textParagraph=f},t}();n.DrawingTextElement=y;var m=function(t){function i(e,i,n){t.call(this,e,n);return this._ooTextRun=f,this._text=i,this._context=e,this.elementType=0,this}e(i,t);var n=i.prototype;return s(n,"Text",{get:function(){return this._text},set:function(t){this._text=t}}),n.FromOOModel=function(t){this._ooTextRun=t,this._text=t.t,u(t.rPr)?this._font=new g(this._context,this._font.ParentStateful):this._font.TextCharacterProperties_FromOOModel(t.rPr)},n.ToOOModel=function(){var t=this._ooTextRun||{elementType:0};return t.t=this.Text,t.rPr=this._font.TextCharacterProperties_ToOOModel(),t},i}(y);n.DrawingTextRun=m;var v=function(t){function i(e,i,n){t.call(this,e,n);return this._type=i,this._drawing=e,this._referenceText=new p.ReferenceText(this._drawing),this.elementType=2,this}e(i,t);var n=i.prototype;return s(n,"Type",{get:function(){return this._type},set:function(t){this._type=t}}),s(n,"Text",{get:function(){return 8===this.Type?this._referenceText.ReferingText:a.GetTextFieldTypeText(this.Type)}}),s(n,"Worksheet",{get:function(){return this._drawing&&this._drawing.Parent}}),n.FromOOModel=function(t){this._ooModel=t,this.Type=a.GetTextFieldType(t.type),u(t.rPr)?this._font=new g(this._context,this._font.ParentStateful):this._font.TextCharacterProperties_FromOOModel(t.rPr)},n.ToOOModel=function(){var t=this._ooModel||{elementType:2};if(u(t.id)){var e="{"+i.guid+"}";t.id=e,i.guid+=1}return t.type=a.GetTextFieldTypeString(this.Type),u(t.rPr)&&(t.rPr={}),t.rPr=this._font.TextCharacterProperties_ToOOModel(),t.t=this.Text,t},n.UpdateTextByFormulas=function(t,e){this._referenceText.UpdateTextByFormulas(t,e)},i}(y);v.guid=1,n.DrawingTextField=v;var b=function(t){function i(e,i){t.call(this,e,i),this.elementType=1}e(i,t);var n=i.prototype;return s(n,"Text",{get:function(){return"\r\n"}}),n.FromOOModel=function(t){this._ooModel=t},n.ToOOModel=function(){return this._ooModel||{elementType:1}},i}(y);n.DrawingLineBreak=b;var S=function(){function t(t,e){this._ooTextPara=f,this._font=f,this._context=f,this._splitSpaceFlag=" ",this._context=t,this._textBody=e,this._font=new g(t),this._font.ParentStateful=this._textBody.Font,this._elements=[]}var e=t.prototype;return s(e,"SplitSpaceFlag",{get:function(){return this._splitSpaceFlag},set:function(t){this._splitSpaceFlag=t}}),s(e,"Text",{get:function(){for(var t="",e=0,i=this._elements;e<i.length;e++){var n=i[e];""!==t&&(t+=this._splitSpaceFlag),u(n.Text)||(t+=n.Text)}return t},set:function(t){this.Clear(),this.AddRun(t)}}),e.Get=function(t){return this._elements[t]},s(e,"Count",{get:function(){return this._elements.length}}),s(e,"Font",{get:function(){return this._font}}),e.AddRun=function(t,e){return this.AddRunInternal(t,e)},e.AddField=function(t){return this.AddFieldInternal(t)},e.Clear=function(){for(var t=0,e=this._elements;t<e.length;t++){e[t].Font.ParentStateful=f}this._elements.length=0},e.FromOOModel=function(t){if(this._ooTextPara=t,t.pPr&&t.pPr.defRPr&&this._font.TextCharacterProperties_FromOOModel(t.pPr.defRPr),t.elements)for(var e=t.elements.length,i=this._elements=[],n=this._context,r=0;r<e;r++){var o,s=t.elements[r],l=s.elementType;0===l?o=new m(n,s.t,this):1===l?o=new b(n,this):2===l&&(o=new v(n,a.GetTextFieldType(s.type),this)),o&&(o.FromOOModel(s),i.push(o))}},e.AddRunInternal=function(t,e){e===_&&(e=-1);var i=new m(this._context,t,this),n=this._elements;return e<0||e>=n.length?n.push(i):n.splice(e,0,i),i},e.AddFieldInternal=function(t){var e=new v(this._context,t,this);return this._elements.push(e),e},e.ToOOModel=function(){var t=this._ooTextPara||{elements:[]};t.pPr||(t.pPr={});var e=t.pPr;u(this._font)||(e.defRPr=this._font.TextCharacterProperties_ToOOModel());for(var i=t.elements=[],n=0,r=this._elements,o=r.length;n<o;n++)i.push(r[n].ToOOModel());return(1===this._context.DrawingType||u(this._ooTextPara))&&u(t.endParaRPr)&&(t.endParaRPr={}),t},e.Delete=function(){for(var t=this._elements.length-1;t>=0;t--)this.DeleteElement(this._elements[t]);this._textBody.DeleteParagraph(this),this._textBody=f},e.DeleteElement=function(t){t.Font.ParentStateful=f;var e=this._elements.indexOf(t);e>=0&&this._elements.splice(e,1)},t}();n.DrawingTextParagraph=S;var C=function(){function t(t,e){this._paragraphs=[],this._ooTextBody=f,this._context=t,this._fontDefaultOptions=e,this._font=new g(t,f,e),this._rotation=0}var e=t.prototype;return s(e,"Text",{get:function(){for(var t="",e=0,i=this._paragraphs;e<i.length;e++){var n=i[e];""!==t&&(t+="\r\n"),t+=n.Text}return t},set:function(t){this.Clear(),this.AddParagraph(t)}}),e.Get=function(t){return this._paragraphs[t]},s(e,"Count",{get:function(){return this._paragraphs.length}}),s(e,"Font",{get:function(){return this._font}}),s(e,"Rotation",{get:function(){return this._rotation}}),e.setFontColor=function(t,e){var i=this._paragraphs.length;this._font&&this._font.Color.setColor(t,e);for(var n=0;n<i;n++)this._paragraphs[n].Font.Color.setColor(t,e)},e.AddParagraph=function(t,e){e===_&&(e=-1);var i=new S(this._context,this);u(t)||i.AddRun(t);var n=this._paragraphs;return e<0||e>=n.length?n.push(i):n.splice(e,0,i),i},e.Clear=function(){for(var t=0,e=this._paragraphs;t<e.length;t++){e[t].Font.ParentStateful=f}this._paragraphs.length=0},e.ToOOModel=function(){var t=this._ooTextBody||{p:[]},e=this._paragraphs,i=e.length;if(0===i&&!this._font.IsDirtyIncludingParent())return f;var n=t.p=[];if(i>0)for(var r=0;r<i;r++){var o=e[r];n.push(o.ToOOModel())}else{var a=new S(this._context,this).ToOOModel();a.pPr.defRPr=this._font.TextCharacterProperties_ToOOModel(),n.push(a)}return u(t.bodyPr)&&(t.bodyPr={}),u(t.lstStyle)&&(t.lstStyle={}),t},e.FromOOModel=function(t){this._ooTextBody=t;for(var e=0,i=this._paragraphs;e<i.length;e++){i[e].Clear()}this._paragraphs.length=0;var n=new g(this._context,f,this._fontDefaultOptions),r=this._font;if(r&&(r.SetParentForChildren(n),n.ParentStateful=r.ParentStateful,r.ParentStateful=f),this._font=n,t.p&&t.p.length){var o=t.p[0].pPr;o&&o.defRPr&&this._font.TextCharacterProperties_FromOOModel(o.defRPr);for(var a=0,s=t.p;a<s.length;a++){var l=s[a],u=new S(this._context,this);u.FromOOModel(l),this._paragraphs.push(u)}}var h=t.bodyPr;if(h){var c=h.rot;c&&(this._rotation=c)}},e.Delete=function(){for(var t=this._paragraphs,e=t.length-1;e>=0;e--)this.DeleteParagraph(t[e])},e.DeleteParagraph=function(t){t.Font.ParentStateful=f;var e=this._paragraphs.indexOf(t);e>=0&&this._paragraphs.splice(e,1)},t}();n.DrawingTextBody=C;var x=function(t){function i(e,i){t.call(this);return this.Format1=e,this.Format2=i,this}e(i,t);var n=i.prototype;return s(n,"Stateful1",{get:function(){return this.Format1}}),s(n,"Stateful2",{get:function(){return this.Format2}}),s(n,"Brightness",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(1,!1)?this.Format2.Brightness:this.Format1.Brightness},set:function(t){this.Format1.Brightness=t}}),s(n,"ColorType",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(16,!1)?this.Format2.ColorType:this.Format1.ColorType},set:function(t){this.Format1.ColorType=t}}),s(n,"ObjectThemeColor",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(2,!1)?this.Format2.ObjectThemeColor:this.Format1.ObjectThemeColor},set:function(t){this.Format1.ObjectThemeColor=t}}),s(n,"RGB",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(4,!1)?this.Format2.RGB:this.Format1.RGB},set:function(t){this.Format1.RGB=t}}),s(n,"TintAndShade",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(8,!1)?this.Format2.TintAndShade:this.Format1.TintAndShade},set:function(t){this.Format1.TintAndShade=t}}),n.GetState=function(){},n.SetState=function(){},n.IsDirtyIncludingParent=function(){},n.IsPropDirtyIncludingParent=function(t,e){return this.Stateful1.IsPropDirtyIncludingParent(t,e)||this.Stateful2.IsPropDirtyIncludingParent(t,e)},n.Dirty=function(){},n.UnDirty=function(){},n.SuspendClearChildrenState=function(){},n.ResumeClearChilrenState=function(){},n.AddChildInternal=function(){},n.RemoveChildInternal=function(){},i}(r);n.ComboColorFormat=x;var T=function(t){function i(e,i){t.call(this);return this.Format1=e,this.Format2=i,this}e(i,t);var n=i.prototype;return s(n,"Stateful1",{get:function(){return this.Format1}}),s(n,"Stateful2",{get:function(){return this.Format2}}),s(n,"Bold",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(1,!1)?this.Format2.Bold:this.Format1.Bold},set:function(t){this.Format1.Bold=t}}),s(n,"Color",{get:function(){return new x(this.Format1.Color,this.Format2.Color)}}),s(n,"Italic",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(4,!1)?this.Format2.Bold:this.Format1.Bold},set:function(t){this.Format1.Bold=t}}),s(n,"Name",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(8,!1)?this.Format2.Name:this.Format1.Name},set:function(t){this.Format1.Name=t}}),s(n,"Size",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(64,!1)?this.Format2.Size:this.Format1.Size},set:function(t){this.Format1.Size=t}}),s(n,"Strikethrough",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(128,!1)?this.Format2.Strikethrough:this.Format1.Strikethrough},set:function(t){this.Format1.Strikethrough=t}}),s(n,"Subscript",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(256,!1)?this.Format2.Subscript:this.Format1.Subscript},set:function(t){this.Format1.Subscript=t}}),s(n,"Superscript",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(512,!1)?this.Format2.Superscript:this.Format1.Superscript},set:function(t){this.Format1.Superscript=t}}),s(n,"ThemeFont",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(1024,!1)?this.Format2.ThemeFont:this.Format1.ThemeFont},set:function(t){this.Format1.ThemeFont=t}}),s(n,"Underline",{get:function(){return!u(this.Format2)&&this.Stateful2.IsPropDirtyIncludingParent(2048,!1)?this.Format2.Underline:this.Format1.Underline},set:function(t){this.Format1.Underline=t}}),n.GetState=function(){},n.SetState=function(){},n.IsDirtyIncludingParent=function(){},n.IsPropDirtyIncludingParent=function(t,e){return this.Stateful1.IsPropDirtyIncludingParent(t,e)||this.Stateful2.IsPropDirtyIncludingParent(t,e)},n.Dirty=function(){},n.UnDirty=function(){},n.SuspendClearChildrenState=function(){},n.ResumeClearChilrenState=function(){},n.AddChildInternal=function(){},n.RemoveChildInternal=function(){},i}(r);n.ComboFontFormat=T,t.exports=n}()},function(t,e,i){"use strict";!function(){var e=i(0),n=i(1).UnitHelper.isNullOrUndefined;e.UnderlineType={None:0,Single:1,Double:2,SingleAccounting:3,DoubleAccounting:4};var r=function(){function t(){this.Flag=0,this.Size=0,this.Family=0,this.CharSet=0,this.Scheme=0,this.Underline=0,this.VertAlign=0}var e=t.prototype;return e.Equals=function(t){if(n(t))return!1;return this.Size===t.Size&&this.Color.Equals(t.Color)&&this.Name===t.Name&&this.Family===t.Family&&this.CharSet===t.CharSet&&this.Scheme===t.Scheme&&this.Bold===t.Bold&&this.Italic===t.Italic&&this.Underline===t.Underline&&this.Strike===t.Strike&&this.VertAlign===t.VertAlign&&this.Shadow===t.Shadow&&this.Outline===t.Outline&&this.Condense===t.Condense&&this.Extend===t.Extend&&this.NotUsed===t.NotUsed},e.Clone=function(){var e=new t;return e.Color=this.Color,e.Size=this.Size,e.Name=this.Name,e.Family=this.Family,e.CharSet=this.CharSet,e.Scheme=this.Scheme,e.Bold=this.Bold,e.Italic=this.Italic,e.Underline=this.Underline,e.Strike=this.Strike,e.VertAlign=this.VertAlign,e.Shadow=this.Shadow,e.Outline=this.Outline,e.Condense=this.Condense,e.Extend=this.Extend,e.Flag=this.Flag,e.NotUsed=this.NotUsed,e},e.UpdateDefaultValueFlag=function(){var t=0;this.Color.UpdateDefaultValueFlag(),0!==this.Color.Flag&&(t|=1),0!==this.Size&&(t|=2),n(this.Name)||(t|=4),0!==this.Family&&(t|=8),0!==this.CharSet&&(t|=16),0!==this.Scheme&&(t|=32),this.Bold&&(t|=64),this.Italic&&(t|=128),0!==this.Underline&&(t|=256),this.Strike&&(t|=512),0!==this.VertAlign&&(t|=1024),this.Shadow&&(t|=2048),this.Outline&&(t|=4096),this.Condense&&(t|=8192),this.Extend&&(t|=16384),this.Flag=t},e.UpdateFlagFromBottom=function(){this.Color.UpdateFlagFromBottom(),0===this.Color.Flag?this.Flag&=-2:this.Flag|=1},e.UpdateDefaultValueFlagForDxf=function(){var t=this.Flag,e=0;64==(64&t)&&(e|=64),128==(128&t)&&(e|=128),this.Color.UpdateDefaultValueFlag(),0!==this.Color.Flag&&(e|=1),0!==this.Size&&(e|=2),n(this.Name)||(e|=4),0!==this.Family&&(e|=8),0!==this.CharSet&&(e|=16),0!==this.Scheme&&(e|=32),0!==this.Underline&&(e|=256),this.Strike&&(e|=512),0!==this.VertAlign&&(e|=1024),this.Shadow&&(e|=2048),this.Outline&&(e|=4096),this.Condense&&(e|=8192),this.Extend&&(e|=16384),this.Flag=e},e.Compose=function(t,e){void 0===e&&(e=!0),0!==t.Flag&&(e?this.ConflictCompose(t):this.NonConflictCompose(t))},e.ConflictCompose=function(t){var e=t.Flag;1==(1&e)&&this.Color.Compose(t.Color),2==(2&e)&&(this.Size=t.Size),4==(4&e)&&(this.Name=t.Name),8==(8&e)&&(this.Family=t.Family),16==(16&e)&&(this.CharSet=t.CharSet),32==(32&e)?this.Scheme=t.Scheme:4==(4&e)&&(this.Scheme=0,e&=-33),64==(64&e)&&(this.Bold=t.Bold),128==(128&e)&&(this.Italic=t.Italic),256==(256&e)&&(this.Underline=t.Underline),512==(512&e)&&(this.Strike=t.Strike),1024==(1024&e)&&(this.VertAlign=t.VertAlign),2048==(2048&e)&&(this.Shadow=t.Shadow),4096==(4096&e)&&(this.Outline=t.Outline),8192==(8192&e)&&(this.Condense=t.Condense),16384==(16384&e)&&(this.Extend=t.Extend),this.Flag|=e},e.NonConflictCompose=function(t){var e=this.Flag;this.Color.Compose(t.Color,!1),2!=(2&e)&&(this.Size=t.Size),4!=(4&e)&&(this.Name=t.Name),8!=(8&e)&&(this.Family=t.Family),16!=(16&e)&&(this.CharSet=t.CharSet),32!=(32&e)&&(this.Scheme=t.Scheme),64!=(64&e)&&(this.Bold=t.Bold),128!=(128&e)&&(this.Italic=t.Italic),256!=(256&e)&&(this.Underline=t.Underline),512!=(512&e)&&(this.Strike=t.Strike),1024!=(1024&e)&&(this.VertAlign=t.VertAlign),2048!=(2048&e)&&(this.Shadow=t.Shadow),4096!=(4096&e)&&(this.Outline=t.Outline),8192!=(8192&e)&&(this.Condense=t.Condense),16384!=(16384&e)&&(this.Extend=t.Extend),this.Flag|=t.Flag},e.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},e.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},e.Compare=function(t,e){var i,n=this.Flag,r=t.Flag,o=[],a=!1;1==(1&n)&&((i=1!=(1&r))||(e?(a=this.Color.RemoveDifferentStyle(t.Color),i=0===this.Color.Flag):(a=this.Color.RemoveDuplicateStyle(t.Color),i=0!==this.Color.Flag)),(e?i:!i)&&o.push(1)),2==(2&n)&&(i=2!=(2&r)||this.Size!==t.Size,(e?i:!i)&&o.push(2)),4==(4&n)&&(i=4!=(4&r)||this.Name!==t.Name,(e?i:!i)&&o.push(4)),8==(8&n)&&(i=8!=(8&r)||this.Family!==t.Family,(e?i:!i)&&o.push(8)),16==(16&n)&&(i=16!=(16&r)||this.CharSet!==t.CharSet,(e?i:!i)&&o.push(16)),32==(32&n)&&(i=32!=(32&r)||this.Scheme!==t.Scheme,(e?i:!i)&&o.push(32)),64==(64&n)&&(i=64!=(64&r)||this.Bold!==t.Bold,(e?i:!i)&&o.push(64)),128==(128&n)&&(i=128!=(128&r)||this.Italic!==t.Italic,(e?i:!i)&&o.push(128)),256==(256&n)&&(i=256!=(256&r)||this.Underline!==t.Underline,(e?i:!i)&&o.push(256)),512==(512&n)&&(i=512!=(512&r)||this.Strike!==t.Strike,(e?i:!i)&&o.push(512)),1024==(1024&n)&&(i=1024!=(1024&r)||this.VertAlign!==t.VertAlign,(e?i:!i)&&o.push(1024)),2048==(2048&n)&&(i=2048!=(2048&r)||this.Shadow!==t.Shadow,(e?i:!i)&&o.push(-2049)),4096==(4096&n)&&(i=4096!=(4096&r)||this.Outline!==t.Outline,(e?i:!i)&&o.push(4096)),8192==(8192&n)&&(i=8192!=(8192&r)||this.Condense!==t.Condense,(e?i:!i)&&o.push(8192)),16384==(16384&n)&&(i=16384!=(16384&r)||this.Extend!==t.Extend,(e?i:!i)&&o.push(16384));var s=o.length;if(s>0){a=!0;for(var l=0;l<s;l++)n&=~o[l]}return this.Flag=n,a},e.ClearFlag=function(){this.Color.ClearFlag(),this.Flag=0},e.SetFullFlag=function(){this.Color.SetFullFlag(),this.Flag=32767},e.IsFullFlag=function(){return 32767===this.Flag&&!!this.Color.IsFullFlag()},t}();e.FontData=r,t.exports=e}()},function(t,e,i){"use strict";!function(){var e=i(0),n=i(16),r=i(3).GC$.inherit,o=i(1),a=o.UnitHelper,s=a.isNullOrUndefined,l=a.pointToPixel,u=o.ChartUtility,h=u.defineProperty,c=o.ChartConstants,p=o.ChartElementBase,f=i(28).SeriesCollection,_=i(30),d=_.FullChartGroups,g=_.ChartGroups,y=i(15).Axes,m=i(31).Legend,v=i(6).ChartTitle,b=i(32).PlotArea,S=i(8).ARGBColor,C=i(6).DrawingText,x=i(5).ChartFormat,T=null,w=void 0,P=Math.floor,A=function(t){function e(e){var i=t.call(this)||this;i._chart=e,i._chartText=i.GetDefaultChartText();var n=i._format=i.GetDefaultFormat();return n.Fill.Color.ObjectThemeColor=0,n.Line.Color.ObjectThemeColor=1,n.Line.Color.Brightness=c.DefaultLineColorBrightness,n.Line.Weight=1,i._roundedCorners=!1,i}r(e,t);var i=e.prototype;return i.GetDefaultChartText=function(){var t=new C(this._chart.Parent,T,T,{Size:l(10)}),e=t.Font;return e.ThemeFont=2,e.Color.ObjectThemeColor=1,e.Color.Brightness=.35,e.Bold=!1,t},i.ResetChartText=function(){var t=new C(this._chart.Parent,T,T,{Size:l(10)});if(!s(this._chartText))for(var e=0,i=this._chartText.Font.Children;e<i.length;e++){i[e].ParentStateful=t.Font}this._chartText=t},h(i,"Font",{get:function(){return this._chartText.Font}}),h(i,"Format",{get:function(){return s(this._format)&&(this._format=this.GetDefaultFormat()),this._format}}),h(i,"FormatInternal",{get:function(){return s(this._format)&&(this._format=this.CreateFormat()),this._format}}),h(i,"Parent",{get:function(){return this._chart}}),h(i,"RoundedCorners",{get:function(){return this._roundedCorners},set:function(t){this._roundedCorners=t}}),i.setFontColor=function(t,e){this._chartText.TextBody.setFontColor(t,e)},i.FromOOModel=function(e){if(this._ooModel=e,!s(e)){this._roundedCorners=e.RoundedCorners,t.prototype.FromShapeProperties.call(this,e.SpPr);var i={};i.rich=e.TxPr,this.ResetChartText(),s(i.rich)?this._chartText.Font.Size=0:this._chartText.FromOOModel(i)}},i.ToOOModel=function(){var e=s(this._ooModel)?{}:this._ooModel;return e.SpPr=t.prototype.ToShapeProperties.call(this),s(this._chartText)||(e.TxPr=this._chartText.ToOOModel().rich),e},i.GetDefaultFormat=function(){return this.CreateFormat()},i.CreateFormat=function(){return new x(this._chart,T,T,T)},e}(p);e.ChartArea=A;var F=function(t){function e(e){var i=t.call(this)||this;return i._ooModel=T,i._chart=e,i}r(e,t);var i=e.prototype;return h(i,"Format",{get:function(){return this.ChartFormat}}),h(i,"Parent",{get:function(){return this._chart}}),i.GetDefaultFormat=function(){var e=t.prototype.GetDefaultFormat.call(this);return e.Line.Color.ColorType=0,e},i.CreateFormat=function(){return new x(this._chart)},i.FromOOModel=function(e){this._ooModel=e,s(e.thickness)||(this.Thickness=P(e.thickness)),t.prototype.FromShapeProperties.call(this,e.spPr)},i.ToOOModel=function(){var e=s(this._ooModel)?{}:this._ooModel;return e.thickness=this.Thickness,e.spPr=t.prototype.ToShapeProperties.call(this),e},e}(p);e.Floor=F;var O=function(t){function e(e){var i=t.call(this)||this;return i._thickness=0,i._ooModel=T,i._chart=e,i}r(e,t);var i=e.prototype;return h(i,"Format",{get:function(){return this.ChartFormat}}),h(i,"Parent",{get:function(){return this._chart}}),h(i,"Thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t}}),i.FromOOModel=function(e){this._ooModel=e,s(e.thickness)||(this.Thickness=P(e.thickness)),t.prototype.FromShapeProperties.call(this,e.spPr)},i.ToOOModel=function(){var e=s(this._ooModel)?{}:this._ooModel;return e.thickness=this.Thickness,e.spPr=t.prototype.ToShapeProperties.call(this),e},i.CreateFormat=function(){return this.CreateFormatCore()},i.CreateFormatCore=function(){return T},e}(p);e.WallBase=O;var M=function(t){function e(e){return t.call(this,e)||this}r(e,t);var i=e.prototype;return h(i,"Thickness",{get:function(){return this._thickness},set:function(t){this._thickness=t,this._chart.SideWall.Thickness=t,this._chart.BackWall.Thickness=t}}),i.CreateFormatCore=function(){return new x(this._chart)},e}(O);e.Walls=M;var D=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.CreateFormatCore=function(){return new x(this._chart,this._chart.Walls.Format)},e}(O);e.Wall=D;var L=function(){function t(t,e){e===w&&(e=12);if(this._gapDepth=150,this._plotVisibleOnly=!0,this._hasLegend=!0,this._hasTitle=!0,this._barShape=2,this._shapes=[],this._chartGroups={},this._elementChangedSuspended=0,this._chartView=t,0===e)throw new Error("Can not set combo chart type!");this._chartType=e,this._seriesCollection=new f(this),this.InitElements(),this.InitProps(),this._fullGroups=new d(this),this.UpdateFormat()}var i=t.prototype;function r(t,e,i,n){var r=t.Item(e,i);return!r&&n&&(r=t.Add(e,i)),r}return i.InitElements=function(){this._chartArea=new A(this),this._lengend=new m(this),u.IsRadarChart(this._chartType)?this._lengend.Position=1:this._lengend.Position=4,this._title=new v(this),this._plotArea=new b(this),u.Is3DChart(this._chartType)&&(this._floor=this.GetDefaultFloor(),this._walls=new M(this),this._sideWall=new D(this),this._backWall=new D(this))},i.InitProps=function(){switch(this._gapDepth=150,this._chartType){case 15:case 16:case 17:case 6:case 21:case 22:case 23:this.RightAngleAxes=!0;break;case 5:case 10:case 29:case 30:case 31:case 4:case 44:case 45:case 47:case 46:this.RightAngleAxes=!1}},h(i,"Name",{get:function(){return this._chartView.name()}}),h(i,"Parent",{get:function(){return this._chartView}}),h(i,"ChartType",{get:function(){return this._chartType},set:function(t){if(t!==this._chartType){if(0===t)throw new Error("can not set chart type to combo!");u.IsStockChart(t)&&this.GetStockChartSersCount(t)!==this._seriesCollection.Count?(this.Parent._updateStockChartErrorType(!0),this.Parent._updateChartModel()):(this.Parent._updateStockChartErrorType(),this._chartType=t,this.UpdateOnChartTypeChanged())}}}),h(i,"SeriesCollection",{get:function(){return this._seriesCollection}}),i.UpdateSeries=function(t,e){e===w&&(e=!1),this._seriesCollection.RefreshSeriesIfNeed(t,e)},h(i,"Axes",{get:function(){return this._axes||(this._axes=new y(this)),this._axes}}),h(i,"ChartArea",{get:function(){return this._chartArea}}),h(i,"ChartTitle",{get:function(){return this.HasTitle?this._title:T}}),h(i,"PlotArea",{get:function(){return this._plotArea}}),h(i,"Legend",{get:function(){return this.HasLegend?this._lengend:T}}),h(i,"Floor",{get:function(){return u.Is3DChart(this._chartType)?(s(this._floor)&&(this._floor=this.GetDefaultFloor()),this._floor):T}}),h(i,"Walls",{get:function(){return u.Is3DChart(this._chartType)?(s(this._walls)&&(this._walls=new M(this)),this._walls):T}}),h(i,"SideWall",{get:function(){return u.Is3DChart(this._chartType)?(s(this._sideWall)&&(this._sideWall=new D(this)),this._sideWall):T}}),h(i,"BackWall",{get:function(){return u.Is3DChart(this._chartType)?(s(this._backWall)&&(this._backWall=new D(this)),this._backWall):T}}),h(i,"AutoScaling",{get:function(){return this._chartArea.Format.ThreeD._AutoScale},set:function(t){this._chartArea.Format.ThreeD._AutoScale=t}}),h(i,"BarShape",{get:function(){return this._barShape},set:function(t){this._barShape=t;for(var e=0,i=this._seriesCollection.AllSers;e<i.length;e++){i[e].ClearBarShapeInternal()}}}),h(i,"PlotVisibleOnly",{get:function(){return this._plotVisibleOnly},set:function(t){t!==this._plotVisibleOnly&&this.UpdatePlotVisibleOnly(t)}}),h(i,"DepthPercent",{get:function(){return this._chartArea.Format.ThreeD._DepthPercent},set:function(t){this._chartArea.Format.ThreeD._DepthPercent=t}}),h(i,"Elevation",{get:function(){return this._chartArea.Format.ThreeD.RotationY},set:function(t){this._chartArea.Format.ThreeD.RotationY=t}}),h(i,"GapDepth",{get:function(){return this._gapDepth},set:function(t){t>=0&&t<=500&&(this._gapDepth=t)}}),h(i,"HasLegend",{get:function(){return this._hasLegend},set:function(t){t!==this._hasLegend&&(this._hasLegend=t,t&&this._lengend.LegendEntries.UpdateEntries())}}),h(i,"HasTitle",{get:function(){return this._hasTitle},set:function(t){this._hasTitle=t}}),h(i,"HeightPercent",{get:function(){return this._chartArea.Format.ThreeD._HeightPercent},set:function(t){this._chartArea.Format.ThreeD._HeightPercent=t}}),h(i,"Perspective",{get:function(){return this._chartArea.Format.ThreeD.Perspective},set:function(t){this._chartArea.Format.ThreeD.Perspective=t}}),h(i,"RightAngleAxes",{get:function(){return this._chartArea.Format.ThreeD._RightAngleAxes},set:function(t){this._chartArea.Format.ThreeD._RightAngleAxes=t}}),h(i,"Rotation",{get:function(){return this._chartArea.Format.ThreeD.RotationX},set:function(t){this._chartArea.Format.ThreeD.RotationX=t}}),i.InitChartGroups=function(){s(this._fullGroups)&&(this._fullGroups=new d(this))},h(i,"Area3DGroup",{get:function(){return this.GetFirstChartGroup(1)}}),h(i,"Bar3DGroup",{get:function(){return this.GetFirstChartGroup(2)}}),h(i,"Column3DGroup",{get:function(){return this.GetFirstChartGroup(3)}}),h(i,"Line3DGroup",{get:function(){return this.GetFirstChartGroup(4)}}),h(i,"Pie3DGroup",{get:function(){return this.GetFirstChartGroup(5)}}),h(i,"SurfaceGroup",{get:function(){return this.GetFirstChartGroup(6)}}),h(i,"AreaGroups",{get:function(){return this.GetChartGroups(7)}}),h(i,"BarGroups",{get:function(){return this.GetChartGroups(8)}}),h(i,"ColumnGroups",{get:function(){return this.GetChartGroups(9)}}),h(i,"DoughnutGroups",{get:function(){return this.GetChartGroups(10)}}),h(i,"LineGroups",{get:function(){return this.GetChartGroups(11)}}),h(i,"PieGroups",{get:function(){return this.GetChartGroups(12)}}),h(i,"RadarGroups",{get:function(){return this.GetChartGroups(13)}}),h(i,"XYGroups",{get:function(){return this.GetChartGroups(14)}}),h(i,"ChartGroups",{get:function(){return this._fullGroups.Count>0?this._fullGroups:T}}),i.SetSourceData=function(t,e){this._seriesCollection.SetSourceData(t,e)},i.Delete=function(){},i.UpdatePlotVisibleOnly=function(t){this._plotVisibleOnly=t;for(var e=0,i=this._seriesCollection.AllSers;e<i.length;e++){i[e].PlotVisibleOnly=t}},i.SuspendElementChanged=function(){this._elementChangedSuspended++},i.ResumeElementChanged=function(t,e,i){e===w&&(e=T),i===w&&(i=T),this._elementChangedSuspended--,0!==this._elementChangedSuspended||s(t)||this.HandleElementChanged(t,e,i)},h(i,"IsElementChangedSuspended",{get:function(){return this._elementChangedSuspended>0}}),i.HandleElementChanged=function(t,e,i,n,r){n===w&&(n=T),r===w&&(r=T);this.IsElementChangedSuspended||(4===t?this.HandleSeriesCollectionChanged(e,i,n,r):3===t?this.HandleSeriesChanged(e,i,n,r):8===t?this.HandleCategoryAxisChanged(e,i,n,r):17===t?this.HandleChartGroupChanged(e,i,n,r):5===t&&this.HandleDataPointChanged(e,i,n,r))},i.FindChartGroup=function(t,e){for(var i=u.MapToGroupType(t),n=this._fullGroups,r=0,o=n.Count;r<o;r++){var a=n.Get(r);if(a.GroupType===i&&a.AxisGroup===e)return a}return T},i.SetBarShapeInternal=function(t){this._barShape=t},i.HandleSeriesCollectionChanged=function(t,e,i,n){var r=!1;return e===c.PrimaryValuesMinMax?s(this._primaryValAxis)||(this._primaryValAxis.UpdateAxisRulers(),r=!0):e===c.SecondaryValuesMinMax?s(this._secondaryValAxis)||(this._secondaryValAxis.UpdateAxisRulers(),r=!0):e===c.PrimaryXValuesMinMax?s(this._primaryCatAxis)||1===this._primaryCatAxis.ActualCategoryType||(this._primaryCatAxis.UpdateAxisRulers(),r=!0):e===c.SecondaryXValuesMinMax?s(this._secondaryCatAxis)||1===this._secondaryCatAxis.ActualCategoryType||(this._secondaryCatAxis.UpdateAxisRulers(),r=!0):e===c.Collection?(this._seriesCollection._dataOrientation=T,this.UpdateChartTypeBySeries(),this.UpdateAxes(),this.UpdateSeriesCollectionMinMax(),this.HasLegend&&this._lengend.LegendEntries.UpdateEntries(),this.UpdateAxisNoMultiLvlLbl()):e===c.Restore&&(this.UpdateChartTypeBySeries(),this.UpdateAxes(),this.UpdateSeriesCollectionMinMax(),this._lengend.LegendEntries.UpdateEntries(),this.UpdateAxisNoMultiLvlLbl()),r},i.HandleSeriesChanged=function(t,e,i,n){var o=t,a=this._seriesCollection;if(e===c.ChartType)this.UpdateChartTypeBySeries()&&this.UpdateAxes();else if(e===c.AxisGroup)this.UpdateAxes(),this.UpdateSeriesCollectionMinMax();else if(e===c.AreAllXValuesDateTime)0===o.Index&&this.UpdateAxisActualCatType(o.AxisGroup);else if(e===c.ValuesMinMax)a.UpdateValuesMaxMin(o.AxisGroup);else if(e===c.XValuesMinMax)a.UpdateXValuesMaxMin(o.AxisGroup);else if(e===c.XValuesFormula)a.SyncOneDimensionSersXValuesFormula(o,i),this.UpdateAxisNoMultiLvlLbl();else if(e===c.IsMultiLevelXValues){var l=r(this.Axes,0,o.AxisGroup);s(l)||(l.NoMultiLvlLbl=!o.IsMultiLevelXValues)}else if(e===c.XValues)a.SyncOneDimensionSersXValues(o.AxisGroup,i);else if(e===c.PlotOrder)for(var u=P(n),h=P(i),p=0;p<a.Count;p++){var f=a.Get(p);f!==o&&(h>u?f.PlotOrder===h&&f.SetPlotOrderInternal(u):f.PlotOrder>=h&&f.SetPlotOrderInternal(f.PlotOrder+1))}},i.HandleCategoryAxisChanged=function(t,e,i,n){var r=t;if(e===c.CategoryNames)this._seriesCollection.SyncOneDimensionSersXValues(r.AxisGroup,i);else if(e===c.CategoryType){var o=r.CategoryType;r.ActualCategoryType=0===o?this.DetectCatAxisCategoryType(r.AxisGroup):o}},i.HandleChartGroupChanged=function(t,e,i,n){var r=t;if(e===c.SplitType||e===c.SplitValue)for(var o=0,a=r.GetSers();o<a.length;o++){a[o].UpdateSecondPlotPoints()}else e===c.AxisGroup&&(this.UpdateAxes(),this.UpdateSeriesCollectionMinMax());return!0},i.HandleDataPointChanged=function(t,e,i,n){var r=t;e===c.SecondaryPlot&&(r.Parent.Parent.SplitType=3)},i.ResetSeriesByChartType=function(){var t=this._seriesCollection;if(0!==t.Count)if(u.IsStockChart(this._chartType)){if(49===this._chartType||50===this._chartType)for(e=0;e<t.Count;e++)(i=t.Get(e)).ResetOnOwnerChartTypeChanged(9);else if(51===this._chartType||52===this._chartType)for(t.Get(0).ResetOnOwnerChartTypeChanged(12,0),e=1;e<t.Count;e++)t.Get(e).ResetOnOwnerChartTypeChanged(9,1)}else for(var e=0;e<t.Count;e++){var i=t.Get(e);i.ResetOnOwnerChartTypeChanged()}},i.UpdateSeriesCollectionMinMax=function(){var t=this._seriesCollection;t.UpdateValuesMaxMin(0),t.UpdateValuesMaxMin(1);var e=u.GetDimensioin(this.ChartType);(e>1||!s(this._primaryCatAxis)&&2===this._primaryCatAxis.ActualCategoryType)&&t.UpdateXValuesMaxMin(0),(e>1||!s(this._secondaryCatAxis)&&2===this._secondaryCatAxis.ActualCategoryType)&&t.UpdateXValuesMaxMin(1)},i.UpdateAxes=function(){this._axes||(this._axes=new y(this)),this.UpdateCatValAxes(),this.UpdateSeriesAxis(),this.UpdateAxisSettings()},i.UpdateCatValAxes=function(){var t=this._axes,e=!1,i=!1;if(u.IsAnyPieChart(this._chartType))e=!1,i=!1;else for(var n=0;n<this._seriesCollection.Count;n++){var o=this._seriesCollection.Get(n);0===o.AxisGroup&&(e=!0),1===o.AxisGroup&&(i=!0)}e?(s(this._primaryValAxis)&&(this._primaryValAxis=r(t,1,0,!0)),s(this._primaryCatAxis)&&(this._primaryCatAxis=r(t,0,0,!0))):(t.Remove(1,0),this._primaryValAxis=T,t.Remove(0,0),this._primaryCatAxis=T),i?(s(this._secondaryValAxis)&&(this._secondaryValAxis=r(t,1,1,!0)),s(this._secondaryCatAxis)&&(this._secondaryCatAxis=r(t,0,1,!0))):(t.Remove(1,1),this._secondaryValAxis=T,t.Remove(0,1),this._secondaryCatAxis=T)},i.UpdateSeriesAxis=function(){var t=this._axes;u.HasSeriesAx(this._chartType)?s(this._seriesAxis)&&(this._seriesAxis=r(t,2,0,!0)):(t.Remove(2,0),this._seriesAxis=T)},i.UpdateAxisNoMultiLvlLbl=function(){var t=this._seriesCollection,e=t.GetSers(!0,0);if(e.length>0){var i=r(this._axes,0,0);s(i)||(i.NoMultiLvlLbl=!e.some(function(t){return t.IsMultiLevelXValues}))}var n=t.GetSers(!0,1);if(n.length>0){var o=r(this._axes,0,1);s(o)||(o.NoMultiLvlLbl=!n.some(function(t){return t.IsMultiLevelXValues}))}},i.UpdateFormat=function(){var t=this._chartArea.Format.ThreeD;u.Is3DChart(this._chartType)&&(u.IsPieChart(this._chartType)?(t.RotationX=0,t.RotationY=30):46===this._chartType||47===this._chartType?(t.RotationX=0,t.RotationY=90,t.Perspective=0):(t.RotationX=20,t.RotationY=15))},i.UpdateAxisSettings=function(t){t===w&&(t=T);this.UpdateAxisActualCatType(t),s(this._primaryValAxis)||(46===this._chartType||47===this._chartType?this._primaryValAxis.TickLabelPosition=3:this._primaryValAxis.TickLabelPosition=2)},i.UpdateAxisActualCatType=function(t){t===w&&(t=T);s(this._primaryCatAxis)||0!==this._primaryCatAxis.CategoryType||!s(t)&&0!==t||(this._primaryCatAxis.ActualCategoryType=this.DetectCatAxisCategoryType(0)),s(this._secondaryCatAxis)||0!==this._secondaryCatAxis.CategoryType||!s(t)&&1!==t||(this._secondaryCatAxis.ActualCategoryType=this.DetectCatAxisCategoryType(1))},i.UpdateOnChartTypeChanged=function(){this.ResetSeriesByChartType(),this.UpdateAxes(),this._axes.ResetOnChartTypeChanged(),this.UpdateSeriesCollectionMinMax(),this.UpdateFormat();var t=u.MapToGroupType(this._chartType),e=this._chartGroups[t];e&&e.Reset()},i.UpdateChartTypeBySeries=function(){var t=this._chartType,e=this._seriesCollection,i=e.Count;if(0===i)return!1;for(var n=e.Get(0),r=n.InnerChartType,o=n.AxisGroup,a=!0,s=t,l=1;l<i;l++){var h=e.Get(l);if(h.InnerChartType!==r||h.AxisGroup!==o){a=!1,s=0;break}}return a&&r!==this._chartType&&(s=r),s!==t&&!u.IsBuiltInComboChart(t)&&(this._chartType=s,!0)},i.UpdateAxesRulers=function(){s(this._primaryCatAxis)||this._primaryCatAxis.UpdateAxisRulers(),s(this._secondaryCatAxis)||this._secondaryCatAxis.UpdateAxisRulers(),s(this._primaryValAxis)||this._primaryValAxis.UpdateAxisRulers(),s(this._secondaryValAxis)||this._secondaryValAxis.UpdateAxisRulers()},i.DetectCatAxisCategoryType=function(t){var e=u.GetDimensioin(this._chartType),i=this._seriesCollection.GetValidSers(t);if(-1===e){for(var n=[],r=0,o=i;r<o.length;r++){var a=o[r],s=u.GetDimensioin(a.InnerChartType);n.indexOf(s)<0&&n.push(s)}return 1===n.length?1===(s=n[0])?this.AreAllFirstSerXValuesDateTime(t)?2:1:3:1}return 1===e?0===this._seriesCollection.Count?1:this.AreAllFirstSerXValuesDateTime(t)?2:1:e>1?3:1},i.AreAllFirstSerXValuesDateTime=function(t){var e=this._seriesCollection.Item(0,t);return!s(e)&&(!s(e.XValuesRefers)&&u.AreValuesDateTime(this._chartView.sheet(),e.XValuesRefers,this.PlotVisibleOnly))},i.GetDefaultFloor=function(){var t=new F(this);if(u.IsAreaChart(this._chartType)&&u.Is3DChart(this._chartType)){var e=t.Format.Line;e.Weight=1,e.Color.ObjectThemeColor=1,e.Color.Brightness=c.DefaultLineColorBrightness}else t.Thickness=0;return t},i.GetStockChartSersCount=function(t){return 49===t?3:50===t||51===t?4:52===t?5:-1},i.HasChartGroups=function(t){for(var e=0,i=this._seriesCollection.AllSers;e<i.length;e++){var n=i[e];if(u.MapToGroupType(n.InnerChartType)===t)return!0}return!1},i.GetChartGroups=function(t){var e=this._chartGroups[t];return e||(e=new g(this,t),this._chartGroups[t]=e),e},i.GetFirstChartGroup=function(t){var e=this.GetChartGroups(t);return!s(e)&&e.Count>0?e.Get(0):T},i.FromOOModel=function(t){this._ooChartSpace=t,s(t)||(this.FromCT_ChartArea(t),s(this._ooChartSpace.chart)||this.FromCT_Chart(this._ooChartSpace.chart),s(this._ooChartSpace.userShapes)||this.FromCT_UserShapes(this._ooChartSpace.userShapes))},i.FromCT_ChartArea=function(t){var e={};if(e.RoundedCorners=!s(t.roundedCorners)&&t.roundedCorners,e.SpPr=t.spPr,e.TxPr=t.txPr,this._chartArea.FromOOModel(e),!s(t.chart)||!s(t.spPr)){var i={};s(t.chart)||(i.View3D=t.chart.view3D),s(t.spPr)||(i.Scene3D=t.spPr.scene3d,i.Shape3D=t.spPr.sp3d),s(i.View3D)&&s(i.Shape3D)&&s(i.Scene3D)||this._chartArea.FormatInternal.ThreeD.FromOOModel(i)}},i.ToOOModel=function(){var t=s(this._ooChartSpace)?{typeName:"chartSpace"}:this._ooChartSpace;if(s(this._chartArea)||(t.roundedCorners=this._chartArea.RoundedCorners),t.chart=this.ToCT_Chart(),!s(this._chartArea)){var e=this._chartArea.ToOOModel();t.spPr=e.SpPr,t.txPr=e.TxPr}var i=this.ToCT_UserShapes();return i&&(t.userShapes=i),t},i.ToCT_UserShapes=function(){return 0===this._shapes.length?T:this._shapes.map(function(t){return t.toJSON()})},i.FromCT_UserShapes=function(t){var i=this,r=i._chartView.sheet();t&&t.forEach(function(t){if(t){var o=T;t.chartSpace?o=new e.Chart(r):t.src&&(o=new n.Picture),o&&(o.fromJSON(t),i._shapes.push(o))}})},i.ToCT_Chart=function(){var t=s(this._ooChartSpace)||s(this._ooChartSpace.chart)?{}:this._ooChartSpace.chart;return this.HasTitle?(t.title=this._title.ToOOModel(),t.autoTitleDeleted=!1):(delete t.title,t.autoTitleDeleted=!0),this.ToCT_3DChartProps(t),t.plotArea=this._plotArea.ToOOModel(),this.HasLegend?t.legend=this._lengend.ToOOModel():delete t.legend,t.plotVisOnly=this.PlotVisibleOnly,t.dispBlanksAs=this.DisplayBlanksAs,t.showDLblsOverMax=this.ShowDataLabelsOverMaximum,t.pivotFmts&&0===t.pivotFmts.length&&delete t.pivotFmts,t},i.FromCT_Chart=function(t){if(this._chartType=u.GetChartType(t.plotArea),s(t.title)?this._hasTitle=!1:(this._hasTitle=!0,this._title=new v(this),this._title.FromOOModel(t.title)),this.UpdatePlotVisibleOnly(!!s(t.plotVisOnly)||t.plotVisOnly),!s(t.plotArea)){this._plotArea.FromOOModel(t.plotArea);for(var e=0;e<this._fullGroups.Count;e++)this._fullGroups.Get(e).Restore(t.plotArea)}s(t.legend)?this.HasLegend=!1:(this.HasLegend=!0,this._lengend.FromOOModel(t.legend)),s(t.dispBlanksAs)||(this.DisplayBlanksAs=t.dispBlanksAs),s(t.showDLblsOverMax)||(this.ShowDataLabelsOverMaximum=t.showDLblsOverMax),s(t.floor)?this._floor=T:(this._floor=new F(this),this._floor.FromOOModel(t.floor)),s(t.sideWall)?this._sideWall=T:(this._sideWall=new D(this),this._sideWall.FromOOModel(t.sideWall)),s(t.backWall)?this._backWall=T:(this._backWall=new D(this),this._backWall.FromOOModel(t.backWall))},i.ToCT_3DChartProps=function(t){if(u.Is3DChart(this._chartType)){var e=this._chartArea.Format.ThreeD.ToOOModel();t.view3D=e.View3D,s(this._floor)?delete t.floor:t.floor=this._floor.ToOOModel(),s(this._sideWall)?delete t.sideWall:t.sideWall=this._sideWall.ToOOModel(),s(this._backWall)?delete t.backWall:t.backWall=this._backWall.ToOOModel();var i=T;s(this._walls)||(i=this._walls.ToOOModel()),s(i)||(s(t.sideWall)?t.sideWall=i:s(t.sideWall.spPr)&&(t.sideWall.spPr=i.spPr),s(t.backWall)?t.backWall=i:s(t.backWall.spPr)&&(t.backWall.spPr=i.spPr))}else delete t.view3D,delete t.floor,delete t.sideWall,delete t.backWall},i._ToARGBColor=function(t){if(2===t.ColorType)return S.FromArgb(t.Value);var e=this._chartView.sheet();return s(e)?new S:e._ToARGBColor(t)},i._ToFont=function(t){var e=this._chartView.sheet();return s(e)?"":e._ToFont(t)},h(i,"DrawingType",{get:function(){return 1}}),t}();e.ChartModel=L,t.exports=e}()},function(t,e,i){"use strict";!function(){var e=i(2),n=i(17).CalcError,r=i(3).CalcEngine,o=e._Types,a=o._extend,s=o._inherit,l=i(13).GeneralFormatter,u=i(0),h=i(10).ColorSchemeIndex,c=i(1),p=c.NumberExtension.INT32_MAX_VALUE,f=c.ChartUtility,_=f.defineProperty,d=f.TryToDouble,g=f.colorFormatToString,y=f.IsStockChart,m=c.ChartConstants,v=c.StatefulChartElementBase,b=c.CellRect,S=c.UnitHelper,C=S.isNullOrUndefined,x=S.IsNullOrEmpty,T=i(7).ColorFormat,w=i(29),P=w.Points,A=w.DataLabels,F=i(5).ChartFormat,O=i(8).ARGBColor,M=i(18).ChartHelper,D=null;function L(t,e,i){if(t&&e){C(e.chartType)||(t.ChartType=e.chartType),C(e.axisGroup)||(t.AxisGroup=e.axisGroup);var n=f.IsPieOrDoughnutChart(t.ChartType);if(e.backColor)if(n)for(var r=t.Points,o=r.Count,a=function(t,e){for(var i=[],n=!1,r=0,o=0;o<t.length;o++){var a=t[o];"("===a?n=!0:")"===a&&(n=!1),n||a!==e||(i.push(t.substring(r,o)),r=o+1)}return r<t.length&&i.push(t.substring(r,t.length)),i}(e.backColor,","),s=0;s<o;s++){var l=r.Get(s),u=a[s];u&&l.Format.Fill.Color.setColor(i,u)}else t.SetFillColor(i,e.backColor);var h=e.border;if(h)if(n)for(var c=t.Points,p=c.Count,_=0;_<p;_++){var d=c.Get(_).Format.Line;h.color&&d.Color.setColor(i,h.color),C(h.width)||(d.Weight=h.width)}else h.color&&t.SetLineColor(i,h.color),C(h.width)||(t.LineWidth=h.width);C(e.startAngle)||(t.Parent.FirstSliceAngle=e.startAngle),C(e.name)||t.UpdateNameFormula(e.name),C(e.xValues)||t.UpdateXValuesFormula(e.xValues),C(e.yValues)||t.UpdateValuesFormula(e.yValues),C(e.bubbleSizes)||t.UpdateBubbleFormula(e.bubbleSizes)}}var I=function(){function t(){}return t.getValueForMinMax=function(t,e){return isNaN(t)||t===1/0?e:t},t.getMinValue=function(t){return Math.min.apply(D,t)},t.getMaxValue=function(t){return Math.max.apply(D,t)},t.getMinMaxValues=function(e,i,n){var r,o;return void 0===i&&(i=0),void 0===n&&(n=1),e&&e.length&&(r=t.getMinValue(e),o=t.getMaxValue(e)),{Min:t.getValueForMinMax(r,i),Max:t.getValueForMinMax(o,n)}},t}();var k=function(){return function(){this.Label=D,this.Categories=[],this.Data=[]}}();u.SeriesStructure=k;var R=function(t){function e(e){var i=t.call(this,D);return i._series=e,i._type=1,i._period=2,i._order=2,i}s(e,t);var i=e.prototype;return _(i,"Index",{get:function(){return this._series.Trendlines.IndexOf(this)}}),_(i,"Backward",{get:function(){return this._backward},set:function(t){this._backward=t,this.SetState(1,!0)}}),_(i,"DisplayEquation",{get:function(){return this._displayEquation},set:function(t){this._displayEquation=t,this.SetState(2,!0)}}),_(i,"DisplayRSquared",{get:function(){return this._displayRSquared},set:function(t){this._displayRSquared=t,this.SetState(4,!0)}}),_(i,"Format",{get:function(){return this.ChartFormat}}),_(i,"Forward",{get:function(){return this._forward},set:function(t){this._forward=t,this.SetState(8,!0)}}),_(i,"Intercept",{get:function(){return this._intercept},set:function(t){this._intercept=t,this.SetState(16,!0)}}),_(i,"Order",{get:function(){return this._order},set:function(t){this._order=t,this.SetState(256,!0)}}),_(i,"Parent",{get:function(){return this._series}}),_(i,"Period",{get:function(){return this._period},set:function(t){this._period=t,this.SetState(512,!0)}}),_(i,"Type",{get:function(){return this._type},set:function(t){this._type=t,this.SetState(1024,!0)}}),i.ClearFormats=function(){this.ChartFormat=this.GetDefaultFormat()},i.Delete=function(){this._series.Trendlines.Delete(this)},i.CreateFormat=function(){return new F(this._series.Chart,D,this.AutoLineColor.bind(this))},i.GetDefaultFormat=function(){var e=t.prototype.GetDefaultFormat.call(this);return e.Line.Weight=2,e.Line.DashStyle=8,e},i.AutoLineColor=function(){var t=new T(this._series.Parent.Parent);return t.ObjectThemeColor=h["Accent"+(this._series.AutoColorIndex%12+1)],t},i.FromOOModel=function(t){this._ooLine=t,C(t.backward)||(this.Backward=t.backward),C(t.forward)||(this.Forward=t.forward),C(t.intercept)||(this.Intercept=t.intercept),C(t.order)||(this.Order=t.order),C(t.trendlineType)||(this.Type=t.trendlineType),3!==this.Type||C(t.period)||(this.Period=t.period),C(t.dispEq)||(this.DisplayEquation=t.dispEq),C(t.dispRSqr)||(this.DisplayRSquared=t.dispRSqr),C(t.spPr)?this._format=D:(C(this._format)&&(this._format=new F(this._series.Chart)),this._format.FromOOModel(t.spPr))},i.ToOOModel=function(){var t=this._ooLine||{};return this.GetState(1)&&(t.backward=this.Backward),this.GetState(8)&&(t.forward=this.Forward),this.GetState(16)&&(t.intercept=this.Intercept),4===this.Type&&(t.order=this.Order),3===this.Type&&(t.period=this.Period),t.trendlineType=this.Type,t.dispEq=this.DisplayEquation,t.dispRSqr=this.DisplayRSquared,C(this._format)||(t.spPr=this._format.ToOOModel()),t},e}(v);u.Trendline=R;var N=function(){function t(t){this._lines=[],this._series=t}var e=t.prototype;return _(e,"Count",{get:function(){return this._lines.length}}),_(e,"Parent",{get:function(){return this._series}}),e.Add=function(){var t=new R(this._series);return this._lines.push(t),t},e.Get=function(t){return this._lines[t]},e.GetLines=function(){return this._lines},e.Delete=function(t){var e=t;t instanceof R&&(e=this.IndexOf(t)),e>=0&&this._lines.splice(e,1)},e.IndexOf=function(t){return this._lines.indexOf(t)},e.RestoreTrendlines=function(t){this._lines=[];for(var e=0,i=t;e<i.length;e++){var n=i[e];this.Add().FromOOModel(n)}},t}();u.Trendlines=N;var E=function(t){function e(e,i,n){var r=t.call(this,D);return r._serCollection=D,r._nameRefer=D,r._xValuesRefers=[],r._valuesRefers=[],r._bubbleSizesRefers=[],r._markerFormat=D,r._invertColor=D,r._dataLabels=D,r._plotVisibleOnly=!0,r._isMultiLevelXValues=!1,r._idx=-1,r._plotOrder=-1,r._valuesMinMax={Min:0,Max:1},r._xValuesMinMax={Min:0,Max:1},r._ooSeries=D,r._serCollection=e,r._innerChartType=C(i)?r._serCollection.Parent.ChartType:i,r._axisGroup=C(n)?0:n,r._cachedChartGroup=D,r.Init(),r}s(e,t);var i=e.prototype;return _(i,"SeriesCollection",{get:function(){return this._serCollection}}),_(i,"Index",{get:function(){return C(this._serCollection)?-1:this._serCollection.IndexOf(this)}}),_(i,"AxisGroup",{get:function(){return this._axisGroup},set:function(t){t!==this._axisGroup&&(this._axisGroup=t,this._cachedChartGroup=D,this.Chart.HandleElementChanged(3,this,m.AxisGroup))}}),_(i,"BarShape",{get:function(){return C(this._barShape)?this.Chart.BarShape:this._barShape},set:function(t){this._barShape=t}}),_(i,"ChartType",{get:function(){return this._innerChartType},set:function(t){if(t!==this._innerChartType){if(0===t||f.IsSurfaceChart(t))throw new Error("Invalid chart type!");if(f.Is3DChart(this._innerChartType)!==f.Is3DChart(t))throw new Error("Can not change 3D of series!");this._innerChartType=t,this._cachedChartGroup=D,this._ooSeries=D,this.UpdateSettingsByChartType(),this.Chart.HandleElementChanged(3,this,m.ChartType)}}}),_(i,"Explosion",{get:function(){return this._explosion},set:function(t){var e=this._explosion;t!==e&&((e=t)>400&&(e=400),e<0&&(e=0),this._explosion=e,this.Dirty(1))}}),_(i,"Format",{get:function(){return this.ChartFormat}}),i.getFillColor=function(t){return g(this.Format.Fill,t)},i.getLineColor=function(t){return g(this.Format.Line,t)},i.getMarkerLineColor=function(t){return g(this.MarkerFormat.Line,t)},_(i,"LineWidth",{get:function(){var t=this.Format.Line.Weight;return t>0?t:0},set:function(t){C(t)||(this.Format.Line.Weight=t)}}),_(i,"Formula",{get:function(){return"="+this.GetFormulaString()},set:function(t){"="===t[0]&&(t=t.substr(1)),t!==this.GetFormulaString()&&this.UpdateFormulas(t)}}),_(i,"FormulaR1C1",{get:function(){return"="+this.GetFormulaString(!0)},set:function(t){"="===t[0]&&(t=t.substr(1)),t!==this.GetFormulaString(!0)&&this.UpdateFormulas(t)}}),_(i,"Has3DEffect",{get:function(){return this._has3DEffect},set:function(t){this._has3DEffect=t,this.Dirty(4)}}),_(i,"HasDataLabels",{get:function(){return this._hasDataLabels},set:function(t){this._hasDataLabels=t,t&&(this.DataLabels.ShowValue=!0,this.DataLabels.ShowLeaderLines=!0),C(this._dataLabels)||this._dataLabels.UpdateDeleted(!t)}}),_(i,"InvertColor",{get:function(){return C(this._invertColor)&&(this._invertColor=new T(this.Chart)),this._invertColor}}),_(i,"InvertIfNegative",{get:function(){return this._invertIfNegative},set:function(t){this._invertIfNegative=t,this.Dirty(8)}}),_(i,"MarkerFormat",{get:function(){return C(this._markerFormat)&&(this._markerFormat=this.CreateMarkerFormat()),this._markerFormat}}),_(i,"MarkerSize",{get:function(){return this._markerSize},set:function(t){this._markerSize=t,this.Dirty(32)}}),_(i,"MarkerStyle",{get:function(){return this._markerStyle},set:function(t){this._markerStyle=t,this.Dirty(64)}}),_(i,"Name",{get:function(){return this._name},set:function(t){this.SetNameInternal(t)}}),_(i,"Parent",{get:function(){return this.GetParentGroup()}}),_(i,"PictureType",{get:function(){return this._pictureType},set:function(t){this._pictureType=t,this.Dirty(128)}}),_(i,"PictureUnit",{get:function(){return this._pictureUnit},set:function(t){this._pictureUnit=t,this.Dirty(256)}}),_(i,"Smooth",{get:function(){return this._smooth},set:function(t){this._smooth=t}}),_(i,"Values",{get:function(){return f.IsOfPieChart(this._innerChartType)?this.ProcessOfPieValues():this._values},set:function(t){this.SetValuesInternal(t)}}),_(i,"XValues",{get:function(){return this.GetXValues()},set:function(t){this.SetXValuesInternal(t),this.Chart.HandleElementChanged(3,this,m.XValues,t)}}),_(i,"BubbleSizes",{get:function(){return this.GetBubbleSizes()},set:function(t){this.SetBubbleSizesInternal(t)}}),_(i,"DataLabels",{get:function(){return C(this._dataLabels)&&(this._dataLabels=new A(this)),this._dataLabels}}),_(i,"Points",{get:function(){return this._points}}),_(i,"Trendlines",{get:function(){return this._trendlines}}),_(i,"PlotOrder",{get:function(){return-1===this._plotOrder?this.Index+1:this._plotOrder},set:function(t){if(this.PlotOrder!==t&&t>0&&t<=this._serCollection.Count){var e=-1===this._plotOrder?this.Index+1:this._plotOrder;this._plotOrder=t,this.Chart.HandleElementChanged(3,this,m.PlotOrder,t,e)}}}),_(i,"FormatInternal",{get:function(){return C(this._format)&&(this._format=this.CreateFormat()),this._format}}),_(i,"AutoColorIndex",{get:function(){return-1!==this._idx?this._idx:this.SourceIndex}}),_(i,"OwnerChartType",{get:function(){return this._serCollection.Parent.ChartType}}),_(i,"PointsCount",{get:function(){return f.IsOfPieChart(this.InnerChartType)?this.ValuesCount+1:this.ValuesCount}}),_(i,"ValuesCount",{get:function(){return C(this._values)?0:this._values.length}}),_(i,"PlotVisibleOnly",{get:function(){return this._plotVisibleOnly},set:function(t){t!==this._plotVisibleOnly&&(this._plotVisibleOnly=t,this.RefreshValuesIfNeed())}}),_(i,"IsHidden",{get:function(){return!C(this._valuesRefers)&&this._valuesRefers.length>0&&this.AreAllCellsHidden(this._valuesRefers)}}),_(i,"SourceIndex",{get:function(){return this._serCollection.IndexOfSource(this)}}),_(i,"Worksheet",{get:function(){return this._serCollection.Parent.Parent.sheet()}}),_(i,"IsMultiLevelXValues",{get:function(){return this._isMultiLevelXValues},set:function(t){t!==this._isMultiLevelXValues&&(this._isMultiLevelXValues=t,this.Chart.HandleElementChanged(3,this,m.IsMultiLevelXValues))}}),_(i,"NameRefer",{get:function(){return this._nameRefer}}),_(i,"XValuesRefers",{get:function(){return this._xValuesRefers}}),_(i,"ValuesRefers",{get:function(){return this._valuesRefers}}),_(i,"BubbleSizesRefers",{get:function(){return this._bubbleSizesRefers}}),_(i,"ValuesMinMax",{get:function(){return this._valuesMinMax},set:function(t){t!==this._valuesMinMax&&(this._valuesMinMax=t,this.Chart.HandleElementChanged(3,this,m.ValuesMinMax))}}),_(i,"XValuesMinMax",{get:function(){return this._xValuesMinMax},set:function(t){t!==this._xValuesMinMax&&(this._xValuesMinMax=t,this.Chart.HandleElementChanged(3,this,m.XValuesMinMax))}}),_(i,"AreAllXValuesDateTime",{get:function(){return this._areAllXValuesDateTime},set:function(t){t!==this._areAllXValuesDateTime&&(this._areAllXValuesDateTime=t,this.Chart.HandleElementChanged(3,this,m.AreAllXValuesDateTime))}}),_(i,"InnerChartType",{get:function(){return this._innerChartType}}),_(i,"Chart",{get:function(){return this._serCollection.Parent}}),a(i,{Init:function(){this._markerFormat=this.CreateMarkerFormat(),this._barShape=D,this._invertColor=new T(this.Chart),this._invertColor.AutoColorFormat=this.AutoInvertColorFormat,this._trendlines=new N(this),this._points=new P(this),this._pictureType=0,this._pictureUnit=1,this._markerStyle=4,this._markerSize=m.DefaultMarkerSize,this._areAllXValuesDateTime=!1,this.UpdateSettingsByChartType()},_getUniqueName:function(){return this.ChartType+(this.AxisGroup?"F":"")},_removeJSONCache:function(){this._ooSeries&&this._ooSeries.dLbls&&delete this._ooSeries.dLbls},SetFillColor:function(t,e){this.Format.Fill.Color.setColor(t,e)},SetLineColor:function(t,e){this.Format.Line.Color.setColor(t,e)},UpdateFormula:function(t,e){if(void 0===e&&(e=!1),t){var i=this,n=r.parseSeriesFormula(t);n.length>5&&(n.length=4),n.forEach(function(t,n){if(t)switch(n){case 0:i.UpdateNameFormula(t,e);break;case 1:i.UpdateXValuesFormula(t,e);break;case 2:i.UpdateValuesFormula(t,e);break;case 4:i.UpdateBubbleFormula(t)}})}},GetDataLabels:function(){return this._dataLabels},ClearFormats:function(){this.ChartFormat=this.GetDefaultFormat()},Delete:function(){this._serCollection.DeleteSeries(this),this._serCollection=D},RefreshValuesIfNeed:function(t,e){if(C(t)){var i=this.Worksheet._GetHiddens(!0),n=this.Worksheet._GetHiddens(!1);(i.length>0||n.length>0)&&(t=[],[].push.apply(t,this.SegmentToRects(i,!0)),[].push.apply(t,this.SegmentToRects(n,!1)))}var r=this._nameRefer;r&&(e||this.InterectWith([r],t))&&this.UpdateNameByRefer(r);var o=this._xValuesRefers;o&&o.length>0&&(e||this.InterectWith(o,t))&&this.UpdateXValuesByRefers(o);var a=this._valuesRefers;a&&a.length>0&&(e||this.InterectWith(a,t))&&this.UpdateValuesByRefers(a);var s=this._bubbleSizesRefers;s&&s.length>0&&(e||this.InterectWith(s,t))&&this.UpdateBubbleSizesRefers(s)},ClearBarShapeInternal:function(){this._barShape=D},SegmentToRects:function(t,e){for(var i=[],n=0;n<t.length;n++){var r,o=t[n],a=o.Index,s=o.Count;r=e?new b(a,0,s,p):new b(0,a,p,s),i.push(r)}return i},InterectWith:function(t,e){return!C(t)&&!C(e)&&t.some(function(t){return e.some(function(e){return e.IntersectsWith(t.GetSourceRange(0,0))})})},GetNameFormula:function(t){return void 0===t&&(t=!1),C(this._nameRefer)?"":this.GetFormulaString2([this._nameRefer],t)},GetXValuesFormula:function(t){return void 0===t&&(t=!1),C(this._xValuesRefers)?"":this.GetFormulaString2(this._xValuesRefers,t)},GetValuesFormula:function(t){return void 0===t&&(t=!1),C(this._valuesRefers)?"":this.GetFormulaString2(this._valuesRefers,t)},GetBubbleSizesFormula:function(t){return void 0===t&&(t=!1),C(this._bubbleSizesRefers)?"":this.GetFormulaString2(this._bubbleSizesRefers,t)},GetFormulaString2:function(t,e){void 0===e&&(e=!1);for(var i=this.Worksheet.name(),n=[],r=0,o=t.length;r<o;r++){var a=t[r],s=e?a.ToR1C1Text(i):a.ToA1Text(0,0,i);n.push(s)}return n.join(",")},HasRefers:function(t){var e=!1;switch(t){case 0:e=!C(this._nameRefer);break;case 1:e=!C(this._valuesRefers)&&this._valuesRefers.length>0;break;case 2:e=!C(this._xValuesRefers)&&this._xValuesRefers.length>0;break;case 3:e=!C(this._bubbleSizesRefers)&&this._bubbleSizesRefers.length>0}return e},UpdateOrder:function(t){this._plotOrder>t&&this._plotOrder--},SetNameInternal:function(t){this._name=t,this.ClearNameFormulaInternal()},SetXValuesInternal:function(t){this.UpdateXValues(t),this.ClearXValuesFormulaInternal()},SetValuesInternal:function(t){this.UpdateNumberValues(t),this.ClearValuesFormulaInternal()},SetBubbleSizesInternal:function(t){this._bubbleSizes=t,this.ClearBubbleFormulaInternal()},SetPlotOrderInternal:function(t){this._plotOrder=t},ResetOnOwnerChartTypeChanged:function(t,e){void 0===t&&(t=D),void 0===e&&(e=D),this._innerChartType=C(t)?this._serCollection.Parent.ChartType:t,this._ooSeries=D,this._axisGroup=C(e)?0:e,this._cachedChartGroup=D,this.UpdateSettingsByChartType()},UpdateSecondPlotPoints:function(){var t=this.Parent;if(C(t)||3!==t.SplitType){var e,i,n,r;for(e=0;e<this.Points.Count;e++)this.Points.Get(e).SetSecondaryPlotInteral(!1);if(!C(t))switch(t.SplitType){case 0:var o=this._values.length-t.SplitValue;for(o<0&&(o=0),i=o;i<this._values.length;i++)this.Points.Get(i).SetSecondaryPlotInteral(!0);break;case 1:for(i=0;i<this._values.length;i++)r={value:D},d(this._values[i],r),n=r.value,!C(n)&&n<t.SplitValue&&this.Points.Get(i).SetSecondaryPlotInteral(!0);break;case 2:var a=0,s=[];e=0;for(var l=this._values,u=l.length;e<u;e++){var h=l[e];d(h,r={value:D}),n=r.value,C(n)||(s.push(n),a+=n=Math.abs(n))}for(i=0;i<s.length;i++){(n=s[i])/a*100<t.SplitValue&&this.Points.Get(i).SetSecondaryPlotInteral(!0)}}}},UpdateSettingsByChartType:function(){var t=this._innerChartType;switch(this._format=this.GetDefaultFormat(),this._smooth=f.IsSmoothLine(t),this._markerSize=m.DefaultMarkerSize,this.UnDirty(32),this._markerStyle=4,this.UnDirty(64),this._has3DEffect=!1,this.UnDirty(4),t){case 0:break;case 12:case 13:case 14:break;case 15:case 16:case 17:case 6:break;case 18:case 19:case 20:break;case 21:case 22:case 23:break;case 9:case 24:case 25:break;case 26:case 27:case 28:this._markerStyle=0;break;case 5:break;case 10:case 29:case 4:this._explosion=0;break;case 30:case 31:this._explosion=25;break;case 32:break;case 1:case 33:case 35:this._markerStyle=0;break;case 34:case 36:this._markerStyle=4;break;case 8:case 37:case 38:case 39:case 40:case 7:break;case 3:this._explosion=0;break;case 41:this._explosion=25;break;case 2:case 43:break;case 42:this._markerStyle=11;break;case 44:case 45:case 46:case 47:case 11:break;case 48:this._has3DEffect=!0;break;case 49:case 50:case 51:case 52:this._markerStyle=3,this._markerSize=3}this.HasDataLabels&&this._dataLabels.ResetByChartType(),this._updateValuesMinMax()},GetFormulaString:function(t){void 0===t&&(t=!1);var e,i,n,r=this.GetNameFormula(t),o=this.GetXValuesFormula(t),a=this.GetValuesFormula(t),s=this.GetBubbleSizesFormula(t),l=this.PlotOrder;if(r)e=r;else{var u=this.Name;e=C(u)?"":'"'+u+'"'}i=o?this._xValuesRefers.length>1?"("+o+")":o:this.ToFormulaArray(this._xValues,!0),n=a?this._valuesRefers.length>1?"("+a+")":a:this.ToFormulaArray(this._values,!1);var h=l.toString();return f.IsBubbleChart(this._innerChartType)?"SERIES("+e+","+i+","+n+","+h+","+(s?this._bubbleSizesRefers.length>1?"("+s+")":s:this.ToFormulaArray(this.BubbleSizes,!1))+")":"SERIES("+e+","+i+","+n+","+h+")"},ToFormulaArray:function(t,e){if(C(t)||0===t.length)return"";var i=e&&t.some(function(t){return"string"==typeof t}),n=[];if(n.push("{"),!C(t)&&t.length>0)for(var r=0;r<t.length;r++){r>0&&n.push(",");var o=t[r];C(o)?n.push("#N/A"):"string"==typeof o?(n.push('"'),n.push(o),n.push('"')):i?(n.push('"'),n.push(o.toString()),n.push('"')):n.push(o)}return n.push("}"),n.join("")},UpdateFormulas:function(t,e){void 0===e&&(e=!1);var i=this.Worksheet._ParseFormula(t,0,0,e).references;i&&(i[0]&&this.SetNameRefer(i[0]),i[1]&&this.SetXValuesRefers([i[1]]),i[2]&&this.SetValuesRefers([i[2]]),i[3]&&this.SetBubbleSizesRefers([i[3]]))},ClearNameFormula:function(){this.ClearNameFormulaInternal(),this._name=D},ClearNameFormulaInternal:function(){this.UpdateNameReferCore(D)},ClearXValuesFormula:function(){this.ClearXValuesFormulaInternal(),this.UpdateXValues(D)},ClearXValuesFormulaInternal:function(){this.UpdateXValuesRefersCore(D)},ClearValuesFormula:function(){this.ClearValuesFormulaInternal(),this.UpdateValues(D)},ClearValuesFormulaInternal:function(){this.UpdateValuesRefersCore(D)},ClearBubbleFormula:function(){this.ClearBubbleFormulaInternal(),this.UpdateBubbleSizes(D)},ClearBubbleFormulaInternal:function(){this.UpdateBubbleSizesRefersCore(D)},UpdateNameFormula:function(t,e){void 0===e&&(e=!1);var i=this.Worksheet._ParseFormula(t,0,0,e).references,n=i?i[0]:D;this.SetNameRefer(n)},UpdateXValuesFormula:function(t,e){void 0===e&&(e=!1);var i=this.Worksheet._ParseFormula(t,0,0,e),n=i.references;n.length>0?this.SetXValuesRefers(n):this.SetXValuesInternal(i.values)},UpdateValuesFormula:function(t,e){void 0===e&&(e=!1);var i=this.Worksheet._ParseFormula(t,0,0,e),n=i.references;n.length>0?this.SetValuesRefers(n):this.SetValuesInternal(i.values)},UpdateBubbleFormula:function(t,e){void 0===e&&(e=!1);var i=this.Worksheet._ParseFormula(t,0,0,e),n=i.references;n.length>0?this.SetBubbleSizesRefers(n):this.SetBubbleSizesInternal(i.values)},RemoveEquals:function(t){return t&&"="===t[0]&&(t=t.substr(1)),t},SetNameRefer:function(t){this.UpdateNameRefer(t)},SetXValuesRefers:function(t){this.UpdateXValuesRefers(t),this.IsMultiLevelXValues=!C(t)&&t.length>0&&t[0].RowCount>1&&t[0].ColumnCount>1},SetValuesRefers:function(t){this.CheckRefers(t),this.UpdateValuesRefers(t)},SetBubbleSizesRefers:function(t){this.CheckRefers(t),this.UpdateBubbleSizesRefers(t)},UpdateNameRefer:function(t){this.UpdateNameReferCore(t),this.UpdateNameByRefer(t)},UpdateXValuesRefers:function(t){this.UpdateXValuesRefersCore(t),this.UpdateXValuesByRefers(t)},UpdateValuesRefers:function(t){this.UpdateValuesRefersCore(t),this.UpdateValuesByRefers(t)},UpdateBubbleSizesRefers:function(t){this.UpdateBubbleSizesRefersCore(t),this.UpdateSizessByRefers(t)},UpdateNameReferCore:function(t){this._nameRefer=t},UpdateXValuesRefersCore:function(t){C(t)||0===t.length?this._xValuesRefers=[]:this._xValuesRefers=t},UpdateValuesRefersCore:function(t){C(t)||0===t.length?this._valuesRefers=[]:this._valuesRefers=t},UpdateBubbleSizesRefersCore:function(t){C(t)||0===t.length?this._bubbleSizesRefers=[]:this._bubbleSizesRefers=t},GetValuesFromRefers:function(t){for(var e=[],i=this.PlotVisibleOnly,n=0,r=f.GetValuesFromCellRefers(this.Worksheet,t,i);n<r.length;n++){var o=r[n];if(!C(o))for(var a=0,s=o;a<s.length;a++)for(var l=0,u=s[a];l<u.length;l++){var h=u[l];e.push(h)}}return e},GetMultiLevelValuesFromRefers:function(t){var e,i,n,r=[],o=f.GetValuesFromCellRefer(this.Worksheet,t[0],this.PlotVisibleOnly),a=o.length,s=o[0].length;if(1===this._serCollection.RowCol)for(e=0;e<a;e++){for(i=[],n=0;n<s;n++)i.push(o[e][n]);[].push.apply(r,i)}else for(n=0;n<s;n++){for(i=[],e=0;e<a;e++)i.push(o[e][n]);[].push.apply(r,i)}return r},GetStylesFromRefers:function(t){for(var e=[],i=0,n=f.GetStylesFromCellRefers(this.Worksheet,t,this.PlotVisibleOnly);i<n.length;i++){var r=n[i];if(!C(r))for(var o=0,a=r;o<a.length;o++)for(var s=0,l=a[o];s<l.length;s++){var u=l[s];e.push(u)}}return e},UpdateNameByRefer:function(t){if(C(t)||t.IsError)this._name=D;else{var e=this.Worksheet._GetSheet(t.WorksheetName);if(C(e))this._name=D;else{var i=t;this._name="";for(var n=i.Row;n<=i.LastRow;n++)for(var r=i.Column;r<=i.LastColumn;r++)this._name+=e._GetRange(n,r).Text}}},UpdateXValuesByRefers:function(t){var e;!C(t)&&t.length>0?(e=this.IsMultiLevelXValues?this.GetMultiLevelValuesFromRefers(t):this.GetValuesFromRefers(t),this.UpdateXValues(e)):this.UpdateXValues(D)},UpdateValuesByRefers:function(t){if(!C(t)&&t.length>0){var e=this.GetValuesFromRefers(t);this.UpdateValues(e)}else this.UpdateValues([])},UpdateSizessByRefers:function(t){if(!C(t)&&t.length>0){var e=this.GetValuesFromRefers(t);this.UpdateBubbleSizes(e)}else this.UpdateBubbleSizes([])},UpdateValues:function(t){var e=[];f.TryAllToNumbers(t,e),this.UpdateNumberValues(e)},_updateValuesMinMax:function(){var t=this._values,e=I.getMinMaxValues(t),i=this._innerChartType;if(!C(t)&&f.IsStackedChart(i)){for(var n=this._serCollection.GetValidSers(this.AxisGroup).filter(function(t){return t._innerChartType===i}).map(function(t){return t._values}),r=0,o=0,a=0;a<t.length;a++){for(var s=0,l=0,u=0;u<n.length;u++){var h=n[u][a];h>=0?l+=h:s+=h}r<l&&(r=l),o>s&&(o=s)}e.Max=r,e.Min=o}this.ValuesMinMax=e},UpdateNumberValues:function(t){this._values=t,this._updateValuesMinMax(),f.IsOfPieChart(this.InnerChartType)&&this.UpdateSecondPlotPoints()},UpdateBubbleSizes:function(t){for(var e=[],i=0,n=t;i<n.length;i++){var r=n[i],o={value:D};d(r,o)?e.push(o.value):e.push(1)}this._bubbleSizes=e},UpdateXValues:function(t){var e=[];C(t)||0===t.length?this._xValues=D:(this._xValues=t,f.TryAllToNumbers(t,e,!0)&&0!==e.length||(e=this.GetXValues()));this.XValuesMinMax=I.getMinMaxValues(e),this.AreAllXValuesDateTime=f.AreValuesDateTime(this.Worksheet,this.XValuesRefers,this.PlotVisibleOnly)},GetXValues:function(){var t=[];return 1===f.GetDimensioin(this._innerChartType)?[].push.apply(t,this.GetOneDimensionXValues()):[].push.apply(t,this.GetMultiDimensionXValues()),t},XValuesIsAuto:function(){var t=this._xValues;return 1===f.GetDimensioin(this._innerChartType)?C(t)||0===t.length:C(t)||0===t.length||!f.AreAllNumbers(t)},GetOneDimensionXValues:function(){var t=this.PointsCount,e=this.GetAdjustedOneDimensionXValues(t);return e.some(function(t){return"string"==typeof t})&&(e=this.GetXValuesText(t)),e},GetAdjustedOneDimensionXValues:function(t){var e=this._xValues;return C(e)||0===e.length?this.AutoGenerateXValues():e.length!==t?this.AdjustList(e,t):e},GetMultiDimensionXValues:function(){var t=this._xValues,e=[];if(C(t)||0===t.length)e=this.AutoGenerateXValues();else if(f.AreAllNumbers(t)){e=t;var i=this.PointsCount;e.length>i&&(e=this.AdjustList(e,i))}else e=this.AutoGenerateXValues();return e},AdjustList:function(t,e){var i=[];if([].push.apply(i,t),i.length>e)i.splice(e,i.length-e);else for(var n=0;n<=e-i.length;n++)i.push(D);return i},AutoGenerateXValues:function(){for(var t=this.PointsCount,e=[],i=0;i<t;i++)e.push(i+1);return e},GetBubbleSizes:function(){var t=this._bubbleSizes;if(C(t)||0===t.length){var e=this._values;if(C(e)||0===e.length)return D;for(var i=[],n=0,r=e.length;n<r;n++)this._values[n]!==D?i.push(1):i.push(D);return i}return this._bubbleSizes},CheckRefers:function(t){if(C(t))throw new Error("Must provide at least one range or values!");for(var e=D,i=0,n=t;i<n.length;i++){var r=n[i];if(C(e))e=r.WorksheetName;else if(e!==r.WorksheetName)throw new Error("Must be same worksheet!");if(r.RowCount>1&&r.ColumnCount>1)throw new Error("The Range must contain single row or column!")}},ProcessOfPieValues:function(){var t=this._values;if(C(t)||0===t.length)return t;for(var e=0,i=0;i<t.length;i++){var n={value:D};this.Points.Get(i).SecondaryPlot&&d(t[i],n)&&!C(n.value)&&(e+=Math.abs(n.value))}var r=t.slice(0);return r.push(e),r},CreateFormat:function(){return new F(this.Chart,D,this.AutoFillColorFormat.bind(this),this.AutoLineColorFormat.bind(this))},GetDefaultFormat:function(){var e=t.prototype.GetDefaultFormat.call(this);return f.IsRadarChart(this._innerChartType)?(e.Line.Weight=3,e.Line.Color.ColorType=1):f.IsLineSeries(this._innerChartType)?(e.Line.Weight=2,e.Line.Color.ColorType=y(this.SeriesCollection.Parent.ChartType)?0:1):f.IsScatterChart(this._innerChartType)?(e.Line.Weight=2,e.Line.Color.ColorType=0):f.IsOfPieChart(this._innerChartType)?(e.Line.Weight=2,e.Line.Color.ObjectThemeColor=0):f.IsPieOrDoughnutChart(this._innerChartType)&&(e.Line.Weight=2,e.Line.Color.RGB=O.FromArgbs(255,255,255,255)),e},AutoFillColorFormat:function(){return f.IsFillSeries(this._innerChartType)?this.GenerateAutoColor(this.AutoColorIndex):D},AutoLineColorFormat:function(){return f.IsLineSeries(this._innerChartType)?this.GenerateAutoColor(this.AutoColorIndex):D},AutoMarkerColorFormat:function(){return f.IsMarkerSeries(this._innerChartType)?this.GenerateAutoColor(this.AutoColorIndex):D},AutoInvertColorFormat:function(){var t=new T(this.Chart);return t.RGB=O.FromArgbs(255,255,255,255),t},GenerateAutoColor:function(t){if(f.IsAnyPieChart(this.InnerChartType)&&this.Parent.VaryByCategories)return D;var e=new T(this.Chart);return e.ObjectThemeColor=h["Accent"+(t%12+1)],e},CreateMarkerFormat:function(){return new F(this.Chart,D,this.AutoMarkerColorFormat.bind(this),this.AutoMarkerColorFormat.bind(this))},IsPictureFill:function(){if(!C(this._format)){var t=this._format.Fill.Type;return 5===t||3===t}return!1},IsDirtyIncludingParent:function(e){return void 0===e&&(e=!1),!(C(this._format)||!this._format.IsDirtyIncludingParent(e))||(!(C(this._markerFormat)||!this._markerFormat.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e))},AreAllCellsHidden:function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];if(!n.IsError){var r=this.Worksheet._GetSheet(n.WorksheetName);if(!C(r)){if(1===n.RowCount&&r._GetRange(n.Row,n.Column).EntireRow.Hidden)return!0;if(1===n.ColumnCount&&r._GetRange(n.Row,n.Column).EntireColumn.Hidden)return!0;for(var o=n.Column;o<n.Column+n.ColumnCount;o++)if(!r._GetRange(n.Row,o).EntireRow.Hidden)return!1;for(var a=n.Row;a<n.Row+n.RowCount;a++)if(!r._GetRange(a,n.Column).EntireColumn.Hidden)return!1}}}return!1},HasHiddenValues:function(){return this.HasHiddenCells(this._xValuesRefers)},HasHiddenCells:function(t){if(C(t)||0===t.length)return!1;for(var e=0,i=t;e<i.length;e++){var n=i[e],r=this.Worksheet._GetSheet(n.WorksheetName);if(1===n.RowCount){for(var o=n.Column;o<=n.LastColumn;o++)if(r._GetRange(n.Row,o).EntireColumn.Hidden)return!0}else if(1===n.ColumnCount)for(var a=n.Row;a<=n.LastRow;a++)if(r._GetRange(a,n.Column).EntireRow.Hidden)return!0}return!1},GetRowColIndex:function(t,e,i){i.sheet=D,i.row=-1,i.col=-1;for(var n=0,r=0,o=t;r<o.length;r++){var a=o[r];if(!a.IsError&&(i.sheet=this.Worksheet._GetSheet(a.WorksheetName),!C(i.sheet)))for(var s=a.Row;s<a.Row+a.RowCount;s++)for(var l=a.Column;l<a.Column+a.ColumnCount;l++)if(this._plotVisibleOnly){var u=i.sheet._GetRange(s,l);if(!u.EntireRow.Hidden&&!u.EntireColumn.Hidden){if(e===n)return i.row=s,void(i.col=l);n++}}else{if(e===n)return i.row=s,void(i.col=l);n++}}},GetXValueText:function(t){var e=this.GetXValuesText(this.PointsCount,D);return t>e.length?"":e[t]},GetCatText:function(t){var e=this.PointsCount;return f.IsOfPieChart(this._innerChartType)&&t===e-1?"":this.GetXValueText(t)},GetPercentageValue:function(t){for(var e=this.Values[t],i=0,n=0,r=this.Values;n<r.length;n++){var o=r[n];C(o)||(i+=Math.abs(o))}return C(e)?0:e/i},GetXValuesText:function(t,e){return void 0===e&&(e=D),this.IsMultiLevelXValues?this.GetMultiXValuesText(t,e):this.GetSingleXValuesText(t,e)},GetSingleXValuesText:function(t,e){void 0===e&&(e=D);var i=[],n=D;!C(this._xValuesRefers)&&this._xValuesRefers.length>0&&(n=this.GetStylesFromRefers(this.XValuesRefers));for(var r=this.GetAdjustedOneDimensionXValues(t),o=0;o<r.length;o++){var a=e;if(r[o]===D)i.push("");else if("string"==typeof r[o])i.push(r[o]);else if(!a&&!C(n)&&n.length>0&&o<n.length&&n[o]!==D&&(a=n[o].FormatCode),a){var s=new l(a).format(r[o]);i.push(s)}else i.push(r[o].toString())}return i},GetMultiXValuesText:function(t,e,i){void 0===e&&(e=D),void 0===i&&(i=D);for(var n=[],r=f.GetStylesFromCellRefer(this.Worksheet,this.XValuesRefers[0],this.PlotVisibleOnly),o=this.GetAdjustedOneDimensionXValues(t),a=0;a<o.length;a++){var s,u,h,c="";if(o[a]instanceof Array){var p=o[a];if(1===this._serCollection.RowCol)for(var _=0;_<p.length;_++)(C(i)||i===_)&&(c&&(c+=" "),"string"==typeof(h=p[_])?c+=h.toString():(s=e,u=r.GetValue(a,_),C(u)||s||(s=u.FormatCode),s?c+=new l(s).format(h):C(h)||(c+=h.toString())));else for(var d=0;d<p.length;d++)(C(i)||i===d)&&(c&&(c+=" "),"string"==typeof(h=p[d])?c+=h.toString():(s=e,u=r.GetValue(d,a),C(u)||s||(s=u.FormatCode),s?c+=new l(s).format(h):C(h)||(c+=h.toString())))}n.push(c)}return n},GetPointValueText:function(t,e){void 0===e&&(e=D);var i=this.PointsCount;if(f.IsOfPieChart(this.InnerChartType)&&t===i-1)return e?new l(e).format(this.Values[t]):this.Values[t].toString();if(!this.HasRefers(1))return e?new l(e).format(this.Values[t]):this.Values[t].toString();var n={sheet:D,row:-1,col:-1};this.GetRowColIndex(this.ValuesRefers,t,n);var r=n.sheet,o=n.row,a=n.col;if(!C(r)&&-1!==o&&-1!==a){if(!e)return r._GetCellText(o,a);var s=r._GetCellValue(o,a);return new l(e).format(s)}return D},FromOOModel:function(t){this._ooSeries=t,0===t.seriesType?this.FromCT_BarSer(t):1===t.seriesType?this.FromCT_AreaSer(t):2===t.seriesType?this.FromCT_LineSer(t):3===t.seriesType?this.FromCT_PieSer(t):4===t.seriesType?this.FromCT_RadarSer(t):5===t.seriesType?this.FromCT_ScatterSer(t):6===t.seriesType?this.FromCT_BubbleSer(t):7===t.seriesType&&this.FromCT_SurfaceSer(t)},ToOOModel:function(){var t=D;switch(this._innerChartType){case 0:break;case 12:case 13:case 14:case 15:case 16:case 17:case 6:case 18:case 19:case 20:case 21:case 22:case 23:t=this.ToCT_BarSer();break;case 9:case 24:case 25:case 26:case 27:case 28:case 5:t=this.ToCT_LineSer();break;case 10:case 29:case 32:case 30:case 31:case 4:t=this.ToCT_PieSer();break;case 1:case 33:case 34:case 35:case 36:t=this.ToCT_ScatterSer();break;case 8:case 37:case 38:case 39:case 40:case 7:t=this.ToCT_AreaSer();break;case 3:case 41:t=this.ToCT_PieSer();break;case 2:case 42:case 43:t=this.ToCT_RadarSer();break;case 44:case 45:case 46:case 47:t=this.ToCT_SurfaceSer();break;case 11:case 48:t=this.ToCT_BubbleSer();break;case 49:break;case 50:t=this.ToCT_LineSer()}return t&&f.removeEmptyArrayProperties(t),t},ToCT_BarSer:function(){var t=this._ooSeries,e=t&&0===t.seriesType?t:{seriesType:0};return this.ToCT_CatValSerBase(e),e.shape=this.BarShape,e.invertIfNegative=this.InvertIfNegative,e.dPt=this.ToDataPoints(),this.IsPictureFill()?e.pictureOptions=this.ToCT_PictureOptions():delete e.pictureOptions,e},FromCT_BarSer:function(t){this.FromCT_CatValSerBase(t),C(t.shape)||(this.BarShape=t.shape),C(t.invertIfNegative)||(this.InvertIfNegative=t.invertIfNegative),this._points.RestorePoints(t.dPt),this.FromCT_PictureOptions(t.pictureOptions)},ToCT_LineSer:function(){var t=this._ooSeries&&2===this._ooSeries.seriesType?this._ooSeries:{seriesType:2,dPt:[],trendline:[],errBars:[]};return this.ToCT_CatValSerBase(t),t.smooth=this.Smooth,t.marker=this.ToCT_Marker(),t.dPt=this.ToDataPoints(),t},FromCT_LineSer:function(t){this.FromCT_CatValSerBase(t),C(t.smooth)||(this.Smooth=t.smooth),this.FromCT_Marker(t.marker),this._points.RestorePoints(t.dPt)},ToCT_PieSer:function(){var t=this._ooSeries&&3===this._ooSeries.seriesType?this._ooSeries:{seriesType:3,dPt:[],trendline:[],errBars:[]};return this.ToCT_CatValSerBase(t),t.explosion=this.Explosion,t.dPt=this.ToDataPoints(),t},FromCT_PieSer:function(t){this.FromCT_CatValSerBase(t),C(t.explosion)||(this.Explosion=t.explosion),this._points.RestorePoints(t.dPt)},ToCT_AreaSer:function(){var t=this._ooSeries&&1===this._ooSeries.seriesType?this._ooSeries:{seriesType:1,dPt:[],trendline:[],errBars:[]};return this.ToCT_CatValSerBase(t),t.marker=this.ToCT_Marker(),this.IsPictureFill()?t.pictureOptions=this.ToCT_PictureOptions():t.pictureOptions=D,t},FromCT_AreaSer:function(t){this.FromCT_CatValSerBase(t),this.FromCT_Marker(t.marker),this.FromCT_PictureOptions(t.pictureOptions)},ToCT_RadarSer:function(){var t=this._ooSeries&&4===this._ooSeries.seriesType?this._ooSeries:{seriesType:4,dPt:[],trendline:[],errBars:[]};return this.ToCT_CatValSerBase(t),t.marker=this.ToCT_Marker(),t.dPt=this.ToDataPoints(),t},FromCT_RadarSer:function(t){this.FromCT_CatValSerBase(t),this.FromCT_Marker(t.marker),this._points.RestorePoints(t.dPt)},ToCT_ScatterSer:function(){var t=this._ooSeries&&5===this._ooSeries.seriesType?this._ooSeries:{seriesType:5,dPt:[],trendline:[],errBars:[]};return this.ToCT_XYSerBase(t),t.smooth=this.Smooth,t.marker=this.ToCT_Marker(),t.dPt=this.ToDataPoints(),t},FromCT_ScatterSer:function(t){this.FromCT_XYSerBase(t),C(t.smooth)||(this.Smooth=t.smooth),this.FromCT_Marker(t.marker),this._points.RestorePoints(t.dPt)},ToCT_BubbleSer:function(){var t=this._ooSeries&&5===this._ooSeries.seriesType?this._ooSeries:{seriesType:6,dPt:[],trendline:[],errBars:[]};return this.ToCT_XYSerBase(t),t.bubbleSize=this.BubbleSizesToCT_NumDataSource(),t.bubble3D=48===this._innerChartType||this.Has3DEffect,t.invertIfNegative=this.InvertIfNegative,t.extLst=this.ToCT_ExtensionList(),t.dPt=this.ToDataPoints(),t},FromCT_BubbleSer:function(t){this.FromCT_XYSerBase(t),this.BubbleFromCT_NumDataSource(t.bubbleSize),t.bubble3D&&(this.Has3DEffect=!0),this._points.RestorePoints(t.dPt)},ToCT_CatValSerBase:function(t){t.idx=-1!==this._idx?this._idx:this.SourceIndex,-1===this._plotOrder?t.order=this.SourceIndex:t.order=this._plotOrder-1,t.tx=this.ToCT_SerTx(),t.spPr=this.ToShapeProperties(),t.cat=this.XValuesToCT_AxDataSource(),t.val=this.ValuesToCT_NumDataSource(),t.dLbls=this.ToCT_DLbls(),t.trendline=this.ToCT_Trendlines(),t.extLst=this.ToCT_ExtensionList()},FromCT_CatValSerBase:function(t){C(t.idx)?this._idx=-1:this._idx=t.idx,C(t.order)?this._plotOrder=-1:this._plotOrder=t.order+1,this.FromCT_SerTx(t.tx),this.FromShapeProperties(t.spPr),this.FromCT_AxDataSource(t.cat),this.FromCT_NumDataSource(t.val),this.FromCT_DLbls(t.dLbls),this.FromCT_Trendlines(t.trendline),this.FromCT_ExtensionList(t.extLst)},ToCT_XYSerBase:function(t){t.idx=-1!==this._idx?this._idx:this.SourceIndex,t.order=this.PlotOrder-1,t.tx=this.ToCT_SerTx(),t.spPr=this.ToShapeProperties(),t.xVal=this.XValuesToCT_AxDataSource(),t.yVal=this.ValuesToCT_NumDataSource();var e=this.ToCT_DLbls();e&&(t.dLbls=e),t.trendline=this.ToCT_Trendlines(),t.extLst=this.ToCT_ExtensionList()},FromCT_XYSerBase:function(t){C(t.idx)?this._idx=-1:this._idx=t.idx,C(t.order)?this._plotOrder=-1:this._plotOrder=t.order+1,this.FromCT_SerTx(t.tx),this.FromShapeProperties(t.spPr),this.FromCT_AxDataSource(t.xVal),this.FromCT_NumDataSource(t.yVal),this.FromCT_DLbls(t.dLbls),this.FromCT_Trendlines(t.trendline),this.FromCT_ExtensionList(t.extLst)},ToCT_DLbls:function(){return!this.HasDataLabels&&!this._points.HasDataLabel||C(this._dataLabels)?D:this._dataLabels.ToOOModel()},ToCT_Trendlines:function(){var t=[];if(this._trendlines.Count>0)for(var e=0,i=this._trendlines.GetLines();e<i.length;e++){var n=i[e];t.push(n.ToOOModel())}return t},FromCT_DLbls:function(t){C(t)?this.HasDataLabels=!1:(this.HasDataLabels=!0,this._dataLabels.FromOOModel(t))},FromCT_Trendlines:function(t){C(t)?this._trendlines=new N(this):this._trendlines.RestoreTrendlines(t)},FromCT_AxDataSource:function(t){if(C(t))this.SetXValuesInternal(D);else{var e=this.GetAxDataSourceFormulaOrValues(t),i=e.formula,n=e.values;x(i)?C(n)?this.SetXValuesInternal(D):this.SetXValuesInternal(n):this.UpdateXValuesFormula(i)}},FromCT_NumDataSource:function(t){if(C(t))this.SetValuesInternal(D);else{var e=this.GetNumDataSourceFormulaOrValues(t),i=e.formula,n=e.values;x(i)?C(n)?this.SetValuesInternal(D):this.SetValuesInternal(n):this.UpdateValuesFormula(i)}},BubbleFromCT_NumDataSource:function(t){if(C(t))this.SetBubbleSizesInternal(D);else{var e=this.GetNumDataSourceFormulaOrValues(t),i=e.formula,n=e.values;x(i)?C(n)?this.SetBubbleSizesInternal(D):this.SetBubbleSizesInternal(n):this.UpdateBubbleFormula(i)}},ToCT_SurfaceSer:function(){var t={seriesType:7};return this.ToCT_CatValSerBase(t),t},FromCT_SurfaceSer:function(t){this.FromCT_CatValSerBase(t)},ToCT_PictureOptions:function(){var t={};return t.pictureFormat=this.PictureType,2===this.PictureType&&(t.pictureStackUnit=this.PictureUnit),t},FromCT_PictureOptions:function(t){if(C(t))return this._pictureType=0,this.UnDirty(128),this._pictureUnit=1,void this.UnDirty(256);C(t.pictureFormat)||(this.PictureType=t.pictureFormat),C(t.pictureStackUnit)||(this.PictureUnit=t.pictureStackUnit)},ToCT_SerTx:function(){if(x(this._name)&&C(this._nameRefer))return D;var t={};return C(this._nameRefer)?t.v=this.Name:t.strRef={f:this.GetNameFormula()},t},FromCT_SerTx:function(t){if(C(t))this.SetNameInternal(D);else{var e=D,i=D;C(t.strRef)||x(t.strRef.f)?x(t.v)||(i=t.v):e=t.strRef.f,x(e)?C(i)||this.SetNameInternal(i):this.UpdateNameFormula(e)}},ToCT_Marker:function(){var t={},e=!1;return 11!==this.MarkerStyle&&(t.symbol=this.MarkerStyle,e=!0),11!==this.MarkerStyle&&4!==this.MarkerStyle&&(t.size=this.MarkerSize,e=!0),C(this._markerFormat)||(t.spPr=this._markerFormat.ToOOModel(),e=!0),e?t:D},FromCT_Marker:function(t){if(C(t))return this.MarkerStyle=11,void this.ClearMarkerFormat();C(t.spPr)?this.ClearMarkerFormat():(C(this._markerFormat)&&(this._markerFormat=this.CreateMarkerFormat()),this._markerFormat.FromOOModel(t.spPr)),C(t.size)||(this.MarkerSize=t.size),C(t.symbol)?this.MarkerStyle=11:this.MarkerStyle=t.symbol},ClearMarkerFormat:function(){C(this._markerFormat)||(this._markerFormat.SetParentForChildren(D),this._markerFormat.ParentStateful=D,this._markerFormat=D)},XValuesToCT_AxDataSource:function(){return this.IsMultiLevelXValues?this.ToMultipleCT_AxDataSource():this.ToSingleCT_AxDataSource()},ToSingleCT_AxDataSource:function(){var t,e={},i=this.GetXValuesFormula();if(C(this._xValues)||0===this._xValues.length)return x(i)?D:((t={}).f=i,e.strRef=t,e);var n=[],r=this.XValues;if(f.TryAllToNumbers(r,n)){var o=this.ToCT_NumberData(i,this.XValuesRefers,n);x(i)?e.numLit=o:e.numRef={f:i,numCache:{formatCode:o.formatCode}}}else{var a=this.ToCT_StrData(r);x(i)?e.strLit=a:e.strRef={f:i}}return e},ToMultipleCT_AxDataSource:function(){if(C(this._xValues)||0===this._xValues.length)return D;var t={},e=this.GetXValuesFormula(),i=this.ToCT_MultiLvlStrData(),n={};return n.multiLvlStrCache=i,n.f=e,t.multiLvlStrRef=n,t},GetAxDataSourceFormulaOrValues:function(t){var e=D,i=D;if(C(t.numRef)&&C(t.numLit))if(C(t.strRef)&&C(t.strLit))C(t.multiLvlStrRef)||(e=t.multiLvlStrRef.f);else if(C(t.strRef)||x(t.strRef.f)){var n=t.strLit;C(n)||C(n.pt)||(i=n.pt.slice())}else e=t.strRef.f;else if(C(t.numRef)||x(t.numRef.f)){var r=t.numLit;if(!C(r)&&!C(r.pt)){i=[];for(var o=0,a=r.pt;o<a.length;o++){var s=a[o],l={value:D};d(s,l,!0),i.push(l.value)}}}else e=t.numRef.f;return{formula:e,values:i}},ValuesToCT_NumDataSource:function(){var t={},e=this.GetValuesFormula();if(x(e)&&(C(this._values)||0===this._values.length))return D;var i=this.ToCT_NumberData(e,this.ValuesRefers,this.Values);return x(e)?t.numLit=i:t.numRef={f:e,numCache:{formatCode:i.formatCode}},t},GetNumDataSourceFormulaOrValues:function(t){var e=D,i=D;if(!C(t.numRef)||!C(t.numLit))if(C(t.numRef)||x(t.numRef.f)){var r=t.numLit;if(!C(r)&&!C(r.pt)){i=[];for(var o=0,a=r.pt;o<a.length;o++){var s=a[o],l={value:D};d(s,l,!0)?i.push(l.value):n.parse(s)instanceof n?i.push(null):i.push(0)}}}else e=t.numRef.f;return{formula:e,values:i}},BubbleSizesToCT_NumDataSource:function(){var t={},e=this.GetBubbleSizesFormula(),i=this.ToCT_NumberData(e,this.BubbleSizesRefers,this.BubbleSizes);return x(e)?t.numLit=i:t.numRef={f:e,numCache:{formatCode:i.formatCode}},t},ToCT_NumberData:function(t,e,i){if(C(i)||0===i.length){if(!x(t)){var n={formatCode:"General",ptCount:1,pt:["1"]};return n}return D}var r={},o=[],a=[];r.formatCode="General";for(var s=r.ptCount=i.length,l=0;l<s;l++){var u;if(i[l]===D||isNaN(i[l]))u="#N/A";else{var h=i[l];u=S.IsNegativeInfinity(h)?Number.MIN_VALUE.toLocaleString():S.IsPositiveInfinity(h)?Number.MAX_VALUE.toLocaleString():h.toLocaleString()}o.push(u)}if(!C(e)&&e.length>0){for(var c=[],p=0,f=e;p<f.length;p++){var _=f[p];c.push(new b(_.Row,_.Column,_.RowCount,_.ColumnCount))}for(var d=0,g=0,y=this.GetStylesFromRefers(e);g<y.length&&d<s;g++){var m=y[g];if(!C(m)){var v=m.FormatCode;v&&"General"!==v&&(a[d]=v)}d++}}return o.length>0&&(r.pt=o,a.length>0&&(!function(t){if(t){var e=t.length;if(e>0){for(var i=t[0],n=1;n<e;n++)if(t[n]!==i)return!1;return!0}}return!1}(a)?r.formatCodes=a:r.formatCode=a[0])),r},ToCT_StrData:function(t){var e=t.map(function(t){return!C(t)&&t.toLocaleString?t.toLocaleString():t});return{ptCount:t.length,pt:e}},ToCT_MultiLvlStrData:function(){var t={lvl:[]};t.ptCount=this.PointsCount;for(var e=1===this._serCollection.RowCol?this._xValuesRefers[0].ColumnCount:this._xValuesRefers[0].RowCount,i=0;i<e;i++){var n=this.GetMultiXValuesText(this.PointsCount,D,i);t.lvl.push({pt:n})}return t},ToCT_ExtensionList:function(){var t={ext:[]};if(!C(this._invertColor)&&this._invertColor.IsDirtyIncludingParent()&&t.ext.push(this.ToCT_InvertSolidFillFmt()),this.HasDataLabels&&!C(this._dataLabels.ChartText.TextRefer)){var e={uri:"{6F2FDCE9-48DA-4B69-8628-5D25D57E5C99}",dataObject:{extDataType:1}};e.dataObject.f=this._dataLabels.ChartText.Formula,t.ext.push(e)}return t},ToCT_InvertSolidFillFmt:function(){var t={uri:"{6F2FDCE9-48DA-4B69-8628-5D25D57E5C99}"},e={extDataType:0,spPr:{}},i=this._invertColor.ToOOModel();return 0===i.colorFillType?(e.spPr.solidFill=i,delete i.colorFillType):5===i.colorFillType&&(e.spPr.noFill=!0),e.spPr.ln={},e.spPr.ln.noFill=!0,t.dataObject=e,t},FromCT_ExtensionList:function(t){if(this.HasDataLabels&&(this._dataLabels.ShowDataLabelsRange=!1),!C(t)&&!C(t.ext))for(var e=0,i=t.ext;e<i.length;e++){var n=i[e];if(n&&n.dataObject){var r=n.dataObject.extDataType;if(0===r){var o=n.dataObject;C(o.spPr)||this._invertColor.FromOOModel(o.spPr.solidFill)}else if(1===r){var a=n.dataObject;this._dataLabels.ChartText.Formula=a.f,this._dataLabels.ShowDataLabelsRange=!0}}}},ToDataPoints:function(t){void 0===t&&(t=!1);var e=[],i=this.Points.GetPoints();for(var n in i){var r=i[n];(t||this.NeedRenderPoint(r))&&e.push(r.ToOOModel())}return e},NeedRenderPoint:function(t){return t.IsDirtyIncludingParent()},GetParentGroup:function(){var t=this._cachedChartGroup;return t||(t=this._cachedChartGroup=this.Chart.FindChartGroup(this._innerChartType,this._axisGroup)),t}}),e}(v);u.Series=E,u.ReferType={Name:0,Values:1,XValues:2,BubbleSzies:3};var G=function(){function t(t){this._dataOrientation=D,this._series=[],this._primaryValuesMinMax={Min:0,Max:1},this._secondaryValuesMinMax={Min:0,Max:1},this._primaryXValuesMinMax={Min:0,Max:1},this._secondaryXValuesMinMax={Min:0,Max:1},this._chart=t}var e=t.prototype;function i(t,e,i){(e||i)&&(t.HasDataLabels=!0,e&&t.DataLabels._copyProperties(e))}return e.get=function(t){if(0===arguments.length)return this.GetSers().map(function(t,e){return M.getSeriesProperties(t,0===e)});var e=this.Get(t);return e?M.getSeriesProperties(e,0===t):D},e.set=function(t,e){var i=this.Get(t);if(i&&e){var n=this.ChartView,r=n.sheet();L(i,e,r),this._chart.HandleElementChanged(4,this,m.Collection),r._updateRegisteredFormula(n),n._updateChartModel()}},e.add=function(t){if(t){y(this._chart.ChartType),50===this._chart._chartType&&50===t.chartType&&(t.chartType=9);var e=this.ChartView,i=e.sheet(),n=t.length&&t[0]?t:[t],r=n.length;if(r>0){for(var o=0;o<r;o++){L(this.NewSeries(),n[o],i)}this._chart.HandleElementChanged(4,this,m.Collection)}i._updateRegisteredFormula(e),e._updateChartModel()}},e.remove=function(t){y(this._chart.ChartType);var e=this.Get(t);if(e){var i=this.ChartView;i.sheet()._updateRegisteredFormula(i),e.Delete(),i._updateChartModel()}},_(e,"Parent",{get:function(){return this._chart}}),_(e,"ChartView",{get:function(){return this._chart.Parent}}),_(e,"Count",{get:function(){return this.GetValidSers().length}}),e.Add=function(t,e,i,n,r,o){this.AddInteral(t,e,i,n,r,o);var a=this._chart;if(a){var s=a.Parent;if(s)s.sheet()._updateRegisteredFormula(s),s._updateChartModel(!0)}},e.Extend=function(t,e,i){var n=this.Splits(t,e);if(0!==n.length)for(var r,o=i?1:0,a=n[0],s=0,l=this._series,u=l.length;s<u;s++){var h=l[s];if(!C(h.ValuesRefers)&&h.ValuesRefers.length>0&&o<n.length){var c=h.ValuesRefers.slice(0);r=n[o++],c.push(f.CreateReference(t.Worksheet.name(),r.Row,r.Column,r.RowCount,r.ColumnCount)),h.UpdateValuesFormula(f.ReferencesToFormula(c))}if(f.IsBubbleChart(h.InnerChartType)&&!C(h.BubbleSizesRefers)&&h.BubbleSizesRefers.length>0&&o<n.length){var p=h.BubbleSizesRefers.slice(0);r=n[o++],p.push(f.CreateReference(t.Worksheet.name(),r.Row,r.Column,r.RowCount,r.ColumnCount)),h.UpdateBubbleFormula(f.ReferencesToFormula(p))}if(i&&!C(h.XValuesRefers)&&h.XValuesRefers.length>0){var _=h.XValuesRefers.slice(0);_.push(f.CreateReference(t.Worksheet.name(),a.Row,a.Column,a.RowCount,a.ColumnCount)),h.UpdateXValuesFormula(f.ReferencesToFormula(_))}}},e.Get=function(t){return this.Item(t,D)},e.NewSeries=function(){var t=new E(this);return this._series.push(t),t},_(e,"PrimaryValuesMinMax",{get:function(){return this._primaryValuesMinMax},set:function(t){t!==this._primaryValuesMinMax&&(this._primaryValuesMinMax=t,this._chart.HandleElementChanged(4,this,m.PrimaryValuesMinMax))}}),_(e,"SecondaryValuesMinMax",{get:function(){return this._secondaryValuesMinMax},set:function(t){t!==this._secondaryValuesMinMax&&(this._secondaryValuesMinMax=t,this._chart.HandleElementChanged(4,this,m.SecondaryValuesMinMax))}}),_(e,"PrimaryXValuesMinMax",{get:function(){return this._primaryXValuesMinMax},set:function(t){t!==this._primaryXValuesMinMax&&(this._primaryXValuesMinMax=t,this._chart.HandleElementChanged(4,this,m.PrimaryXValuesMinMax))}}),_(e,"SecondaryXValuesMinMax",{get:function(){return this._secondaryXValuesMinMax},set:function(t){t!==this._secondaryXValuesMinMax&&(this._secondaryXValuesMinMax=t,this._chart.HandleElementChanged(4,this,m.SecondaryXValuesMinMax))}}),_(e,"AllSers",{get:function(){return this._series}}),_(e,"RowCol",{get:function(){return C(this._dataOrientation)?1:this._dataOrientation}}),e.IndexOf=function(t){var e=t;return e.PlotVisibleOnly&&e.IsHidden?-1:this.GetValidSers().indexOf(t)},e.IndexOfSource=function(t){return this._series.indexOf(t)},e.AdjustIndex=function(t,e){var i=this.GetValidSers();if(!(t<0||t>=i.length||e<0||e>=i.length)){var n=this.MapToSourceIndex(t),r=this.MapToSourceIndex(e),o=this._series,a=o[n],s=o[r];o[n]=s,o[r]=a}},e.GetSers=function(t,e){return void 0===t&&(t=!0),t?this._series.filter(function(t){return!t.IsHidden&&(C(e)||t.AxisGroup===e)}):C(e)?this._series:this._series.filter(function(t){return t.AxisGroup===e})},e.GetValidSers=function(t){return this.GetSers(this._chart.PlotVisibleOnly,t)},e.DetectRanges2=function(t,e,i,n,r,o){var a,s=this.DetectRanges(t,e,i,n,r,o);if(f.GetDimensioin(this._chart.ChartType)>1&&C(o.category)&&!C(o.data)){var l=o.data;s?l.ColumnCount>1&&(o.category=new b(l.Row,l.Column,l.RowCount,1),o.data=new b(l.Row,l.Column+1,l.RowCount,l.ColumnCount-1),C(o.seriesName)||(a=o.seriesName,o.seriesName=new b(a.Row,a.Column+1,a.RowCount,a.ColumnCount-1))):o.data.RowCount>1&&(o.category=new b(l.Row,l.Column,1,l.ColumnCount),o.data=new b(l.Row+1,l.Column,l.RowCount-1,l.ColumnCount),C(o.seriesName)||(a=o.seriesName,o.seriesName=new b(a.Row+1,a.Column,l.RowCount-1,a.ColumnCount)))}return s},e.GenerateSeriesStructures=function(t,e,i,n){var r=this,o=r._chart.Parent.sheet()._GetSheet(t[0].WorksheetName);if((t=t.map(function(t){return r.TrimCellRect(o,t.Row,t.Column,t.RowCount,t.ColumnCount)}).filter(function(t){return!!t})).length){var a,s,l=new b(t[0].Row,t[0].Column,t[0].RowCount,t[0].ColumnCount),u=D,h=D,c=D;if(C(e))a={seriesName:D,category:D,data:D},s=r.DetectRanges2(o,l.Row,l.Column,l.RowCount,l.ColumnCount,a),u=a.seriesName,h=a.category,c=a.data,r._dataOrientation=s?1:0;else if(r._dataOrientation=e,C(i)&&C(n)){a={seriesName:D,category:D,data:D},s=r.DetectRanges2(o,l.Row,l.Column,l.RowCount,l.ColumnCount,a),u=a.seriesName,h=a.category,c=a.data;var p=s?1:0;if(r._dataOrientation!==p){var f=h;h=u,u=f}}return C(i)&&C(n)||(1===r._dataOrientation?i&&n?(u=new b(l.Row,l.Column+1,1,l.ColumnCount-1),h=new b(l.Row+1,l.Column,l.RowCount-1,1),c=new b(l.Row+1,l.Column+1,l.RowCount-1,l.ColumnCount-1)):i?(u=new b(l.Row,l.Column,1,l.ColumnCount),h=D,c=new b(l.Row+1,l.Column,l.RowCount-1,l.ColumnCount)):n?(u=D,h=new b(l.Row,l.Column,l.RowCount,1),c=new b(l.Row,l.Column+1,l.RowCount,l.ColumnCount-1)):(u=D,h=D,c=new b(l.Row,l.Column,l.RowCount,l.ColumnCount)):i&&n?(u=new b(l.Row+1,l.Column,l.RowCount-1,1),h=new b(l.Row,l.Column+1,1,l.ColumnCount-1),c=new b(l.Row+1,l.Column+1,l.RowCount-1,l.ColumnCount-1)):i?(u=new b(l.Row,l.Column,l.RowCount,1),h=D,c=new b(l.Row,l.Column+1,l.RowCount,l.ColumnCount-1)):n?(u=D,h=new b(l.Row,l.Column,1,l.ColumnCount),c=new b(l.Row+1,l.Column,l.RowCount-1,l.ColumnCount)):(u=D,h=D,c=new b(l.Row,l.Column,l.RowCount,l.ColumnCount))),r.GenerateSeriesStructures2(t,r._dataOrientation,u,h,c)}},e.GenerateSeriesStructures2=function(t,e,i,n,r){var o=[];if(C(t)||0===t.length)return o;var a,s,l,u,h,c,p=t[0].WorksheetName,_=t[0],d=C(e)?1:e;if(!C(r)){if(1===d)for(c=_.Column;c<_.Column+_.ColumnCount;c++)(C(n)||c<n.Column||c>=n.Column+n.ColumnCount)&&(l=new k,C(i)||(l.Label=f.CreateReference(p,i.Row,c,i.RowCount,1)),l.Data.push(f.CreateReference(p,r.Row,c,r.RowCount,1)),C(n)||l.Categories.push(f.CreateReference(p,n.Row,n.Column,n.RowCount,n.ColumnCount)),o.push(l));else for(h=_.Row;h<_.Row+_.RowCount;h++)(C(n)||h<n.Row||h>=n.Row+n.RowCount)&&(l=new k,C(i)||(l.Label=f.CreateReference(p,h,i.Column,1,i.ColumnCount)),l.Data.push(f.CreateReference(p,h,r.Column,1,r.ColumnCount)),C(n)||l.Categories.push(f.CreateReference(p,n.Row,n.Column,1,n.ColumnCount)),o.push(l));if(t.length>1){var g=t[0],y=g.Row,m=g.Column,v=g.RowCount,b=g.ColumnCount,S=this._chart.Parent.sheet();if(this.InSameColumnRowStrip(t))if(1===this._dataOrientation){var x=r.Column,T=r.ColumnCount;for(c=x;c<x+T;c++)if(C(n)||c!==n.Column)for(l=o[c-x],a=1;a<t.length;a++)s=t[a],l.Data.push(f.CreateReference(p,s.Row,c,s.RowCount,1)),C(n)||l.Categories.push(f.CreateReference(p,s.Row,n.Column,s.RowCount,1))}else{var w=r.Row,P=r.RowCount;for(h=w;h<w+P;h++)if(C(n)||h!==n.Row)for(l=o[h-w],a=1;a<t.length;a++)s=t[a],l.Data.push(f.CreateReference(p,h,s.Column,1,s.ColumnCount)),C(n)||l.Categories.push(f.CreateReference(p,n.Row,s.Column,1,s.ColumnCount))}else if(this.IsNumericData(S._GetCellValue(y+v-1,m+b-1)))if(1===d)for(a=1;a<t.length;a++)for(c=(s=t[a]).Column;c<s.Column+s.ColumnCount;c++)l=new k,C(i)?l.Data.push(f.CreateReference(p,s.Row,c,s.RowCount,1)):(u=i.RowCount,l.Label=f.CreateReference(p,s.Row,c,u,1),l.Data.push(f.CreateReference(p,s.Row+u,c,s.RowCount-u,1))),C(n)||l.Categories.push(o[0].Categories[0]),o.push(l);else for(a=1;a<t.length;a++)for(h=(s=t[a]).Row;h<s.Row+s.RowCount;h++)l=new k,C(i)?l.Data.push(f.CreateReference(p,h,s.Column,1,s.ColumnCount)):(u=i.ColumnCount,l.Label=f.CreateReference(p,h,s.Column,1,u),l.Data.push(f.CreateReference(p,h,s.Column+u,1,s.ColumnCount-u))),C(n)||l.Categories.push(o[0].Categories[0]),o.push(l);else if(o=[],0===d)for(a=1;a<t.length;a++)for(var A=(s=t[a]).Row;A<s.Row+s.RowCount;A++){for(var F=s.Column+s.ColumnCount-1;F>=s.Column&&this.IsNumericData(S._GetCellValue(A,F));)F--;var O=new k;F>=s.Column&&(O.Label=f.CreateReference(p,A,s.Column,1,F-s.Column+1)),O.Data.push(f.CreateReference(p,A,F+1,1,s.Column+s.ColumnCount-F-1)),O.Categories.push(f.CreateReference(p,y,m,v,b)),o.push(O)}else for(a=1;a<t.length;a++)for(var M=(s=t[a]).Column;M<s.Column+s.ColumnCount;M++){for(var D=s.Row+s.RowCount-1;D>=s.Row&&this.IsNumericData(S._GetCellValue(D,M));)D--;var L=new k;D>=s.Row&&(L.Label=f.CreateReference(p,s.Row,M,D-s.Row+1,1)),L.Data.push(f.CreateReference(p,D+1,M,s.Row+s.RowCount-D-1,1)),L.Categories.push(f.CreateReference(p,y,m,v,b)),o.push(L)}}}for(var I=0,R=o;I<R.length;I++){R[I].RowCol=d}return o},e.GenerateSeriesStructures3=function(t,e,i,n,r){var o=i?new b(i.row,i.col,i.rowCount,i.colCount):null,a=n?new b(n.row,n.col,n.rowCount,n.colCount):null,s=r?new b(r.row,r.col,r.rowCount,r.colCount):null,l=[],u=t.name(),h=C(e)?1:e,c=void 0,p=void 0,_=void 0;if(!C(s))if(1===h)for(_=s.Column;_<s.Column+s.ColumnCount;_++)(C(a)||_<a.Column||_>=a.Column+a.ColumnCount)&&(c=new k,C(o)||(c.Label=f.CreateReference(u,o.Row,_,o.RowCount,1)),c.Data.push(f.CreateReference(u,s.Row,_,s.RowCount,1)),C(a)||c.Categories.push(f.CreateReference(u,a.Row,a.Column,a.RowCount,a.ColumnCount)),l.push(c));else for(p=s.Row;p<s.Row+s.RowCount;p++)(C(a)||p<a.Row||p>=a.Row+a.RowCount)&&(c=new k,C(o)||(c.Label=f.CreateReference(u,p,o.Column,1,o.ColumnCount)),c.Data.push(f.CreateReference(u,p,s.Column,1,s.ColumnCount)),C(a)||c.Categories.push(f.CreateReference(u,a.Row,a.Column,1,a.ColumnCount)),l.push(c));for(var d=0,g=l;d<g.length;d++){g[d].RowCol=h}return l},e.InSameColumnRowStrip=function(t){var e,i,n=-1,r=-1;if(1===this._dataOrientation)for(e=0;e<t.length;e++){if(i=t[e],-1!==n&&-1!==r&&(i.Column!==n||i.LastColumn!==r))return!1;n=i.Column,r=i.LastColumn}else for(e=0;e<t.length;e++){if(i=t[e],-1!==n&&-1!==r&&(i.Row!==n||i.LastRow!==r))return!1;n=i.Row,r=i.LastRow}return!0},e.DetectRanges=function(t,e,i,n,r,o){var a=t.getRowCount(),s=t.getColumnCount();if(n<1&&-1!==e||r<1&&-1!==i)throw new Error("Cannot detect an empty cell range.");if(o.category=D,o.seriesName=D,o.data=D,n<=0||r<=0)return!1;var l,u,h=new b(e,i,n,r),c=new b(0,0,a,s);if(h.Intersect(c),e=h.Row,i=h.Column,n=h.RowCount,r=h.ColumnCount,e<0||i<0)throw new Error("The cell range is invalid.");if(1===n&&1===r)return this.IsEmptyCell(t,e,i)||(o.data=new b(e,i,n,r)),!1;if(this.IsEmptyCell(t,e,i)){var p,f;for(l=i+1,u=e+1;l<i+r&&this.IsEmptyCell(t,e,l);)l++;if(0===(f=i+r-(p=l))){for(;u<e+n&&this.IsEmptyCell(t,u,i);)u++;u===e+n?n>1?r>1?(o.category=new b(e,i+1,1,r-1),o.seriesName=new b(e+1,i,n-1,1),o.data=new b(e+1,i+1,n-1,r-1)):(o.seriesName=new b(e,i,1,1),o.data=new b(e+1,i,n-1,1)):(o.seriesName=new b(e,i,1,1),o.data=new b(e,i+1,n,r-1)):r>1?(r>1&&u-e>=1&&(o.category=new b(e,i+1,u-e,r-1)),n>1&&e+n>u&&(o.seriesName=new b(u,i,e+n-u,1)),o.data=new b(u,i+1,e+n-u,r-1)):(o.seriesName=D,n>1&&u>e&&u<e+n&&(o.category=new b(e,i,u-e,r)),o.data=u<e+n&&u>e?new b(u,i,e+n-u,r):new b(e,i,n,r))}else{for(l--;u<e+n&&this.IsEmptyCell(t,u,l);)u++;u===e+n?n>1?(r>1&&u-e>=1&&(o.category=new b(e,p,1,f)),n>1&&r>f&&(o.seriesName=new b(e+1,i,n-1,r-f)),o.data=new b(e+1,p,n-1,f)):(o.seriesName=new b(e,i,n,p-i),o.data=new b(e,p,n,f)):(r>1&&u-e>=1&&(o.category=new b(e,p,u-e,f)),n>1&&e+n>u&&r>f&&(o.seriesName=new b(u,i,e+n-u,r-f)),o.data=new b(u,p,e+n-u,f))}}else{var _=i+r-1,d=e+n-1;if(r>1&&n>1){for(l=_,f=0;l>=i&&this.IsNumericData(t._GetCellValue(d,l));)f++,l--;var g,y=0===f;if(y&&(f=1,l--),r>1){if(p=l+1,l=d-1,g=1,!y)for(;l>=e&&this.IsNumericData(t._GetCellValue(l,_));)g++,l--;f>0&&p>=i&&l+1>e&&(o.category=new b(e,p,l+1-e,f)),g>0&&p>i&&(o.seriesName=new b(l+1,i,g,p-i)),o.data=new b(l+1,p,g,f)}}else if(n>1)if(this.IsNumericData(t._GetCellValue(e,i)))o.data=new b(e,i,n,r);else{for(l=d;l>=e&&this.IsNumericData(t._GetCellValue(l,i));)l--;l!==d||this.IsNumericData(t._GetCellValue(l,i))||l--,o.data=new b(l+1,i,d-l,r),l>=e&&(o.seriesName=new b(e,i,l-e+1,r))}else if(this.IsNumericData(t._GetCellValue(e,i)))o.data=new b(e,i,n,r);else{for(l=_;l>=i&&this.IsNumericData(t._GetCellValue(e,l));)l--;l!==_||this.IsNumericData(t._GetCellValue(e,l))||l--,o.data=new b(e,l+1,n,_-l),l>=i&&(o.seriesName=new b(e,i,n,l-i+1))}}if(!C(o.data)&&o.data.RowCount>o.data.ColumnCount&&o.data.RowCount>1&&(o.data.ColumnCount>1||1===o.data.ColumnCount&&(!C(o.seriesName)||!C(o.category)))){var m=!1;if(C(o.seriesName)?C(o.category)||(m=o.category.Column===o.data.Column):m=o.seriesName.Row===o.data.Row,m){var v=o.category;o.category=o.seriesName,o.seriesName=v}return!0}if(!C(o.data)){if(!(r>1&&n>1))return n>1;if(1===o.data.RowCount)return!1;if(1===o.data.ColumnCount)return!0}return!C(o.seriesName)&&o.seriesName.Column===o.data.Column||!C(o.category)&&o.category.Row===o.data.Row},e.TrimCellRect=function(t,e,i,n,r){var o,a,s,l,u;e=-1===e?0:e,i=-1===i?0:i,o=!0;do{for(s=i,l=i+r;s<l;s++)if(!this.IsEmptyCell(t,e,s)){o=!1;break}if(o&&(e++,0===--n))return}while(o);a=e+n-1,o=!0;do{for(s=i,l=i+r;s<l;s++)if(!this.IsEmptyCell(t,a,s)){o=!1;break}if(o&&(a--,0===--n))return}while(o);o=!0;do{for(a=e,u=e+n;a<u;a++)if(!this.IsEmptyCell(t,a,i)){o=!1;break}if(o&&(i++,0===--r))return}while(o);s=i+r-1,o=!0;do{for(a=e,u=e+n;a<u;a++)if(!this.IsEmptyCell(t,a,s)){o=!1;break}if(o&&(s--,0===--r))return}while(o);return f.CreateReference(t.name(),e,i,n,r)},e.IsNumericData=function(t){return!(t instanceof Date)&&(!!C(t)||("number"==typeof t||(0===t.toString().length||!isNaN(t)&&isFinite(t))))},e.IsEmptyCell=function(t,e,i){var n=t._GetCellValue(e,i);return!(!C(n)&&n.toString().length>0)},e.UpdateValuesMaxMin=function(t){0===t?this.UpdatePrimaryValuesMaxMin():this.UpdateSecondaryValuesMaxMin()},e.UpdateXValuesMaxMin=function(t){0===t?this.UpdatePrimaryXValuesMaxMin():this.UpdateSecondaryXValuesMaxMin()},e.Item=function(t,e){var i=this.GetSers(this._chart.PlotVisibleOnly,e);if("number"==typeof t){if(t>=0&&t<i.length)return i[t]}else if("string"==typeof t)for(var n=0,r=i;n<r.length;n++){var o=r[n];if(o.Name===name)return o}return D},e.GetSerieValues=function(t,e){var i=[];return this.GetValidSers(t).forEach(function(t){var n=e(t);i.push(n.Min),i.push(n.Max)}),i},e.UpdatePrimaryValuesMaxMin=function(){var t=this.GetSerieValues(0,function(t){return t.ValuesMinMax});this.PrimaryValuesMinMax=I.getMinMaxValues(t)},e.UpdateSecondaryValuesMaxMin=function(){var t=this.GetSerieValues(1,function(t){return t.ValuesMinMax});this.SecondaryValuesMinMax=I.getMinMaxValues(t)},e.UpdatePrimaryXValuesMaxMin=function(){var t=this.GetSerieValues(0,function(t){return t.XValuesMinMax});this.PrimaryXValuesMinMax=I.getMinMaxValues(t)},e.UpdateSecondaryXValuesMaxMin=function(){var t=this.GetSerieValues(1,function(t){return t.XValuesMinMax});this.SecondaryXValuesMinMax=I.getMinMaxValues(t)},e.GetMaxPointsCount=function(t){for(var e=0,i=0,n=this.GetValidSers(t);i<n.length;i++){var r=n[i].Values;!C(r)&&r.length>e&&(e=r.length)}return e},e._applyDataLabelsSetting=function(t){if(t)for(var e=this._series,n=e.length,r=t.count,o=0;o<n;o++)i(e[o],t[o],o>=r)},e.AddSers=function(t,e,i){this._chart.SuspendElementChanged();var n=this.Parent.ChartType;if(f.IsBubbleChart(n))this.AddSersForBubble(t);else if(49===n||50===n){if(49===n&&3!==t.length)throw new Error("To create this stock chart, arrange the data on your sheet in this order: high price, low price, closing price. Use dates or stock names as labels.");50===n&&t.length,this.AddSersForStock(t)}else if(51===n||52===n){if(51===n&&4!==t.length)throw new Error("To create this stock chart, arrange the data on your sheet in this order: volume traded, high price, low price, closing price. Use dates or stock names as labels.");if(52===n&&5!==t.length)throw new Error("To create this stock chart, arrange the data on your sheet in this order: volume traded, opening price, high price, low price, closing price. Use dates or stock names as labels.");this.AddSersForVolumeStock(t)}else this.AddSersDefault(t,D,D,i);this._applyDataLabelsSetting(e),this._chart.ResumeElementChanged(4,this,m.Collection)},e.AddSersDefault=function(t,e,i,n){for(var r=n&&n.length,o=r&&n.slice(-1)[0],a=0;a<t.length;a++){var s=t[a],l=new E(this,r?n[a]||o:e,i);this._series.push(l),C(s.Label)?l.UpdateNameFormula(D):l.UpdateNameFormula(f.ReferencesToFormula([s.Label])),l.UpdateXValuesFormula(f.ReferencesToFormula(s.Categories)),l.UpdateValuesFormula(f.ReferencesToFormula(s.Data))}},e.AddSersForBubble=function(t){for(var e=0;e<t.length;e+=2){var i=t[e],n=t[e+1],r=new E(this);this._series.push(r),C(i.Label)?r.UpdateNameFormula(D):r.UpdateNameFormula(f.ReferencesToFormula([i.Label])),r.UpdateXValuesFormula(f.ReferencesToFormula(i.Categories)),r.UpdateValuesFormula(f.ReferencesToFormula(i.Data)),C(n)||r.UpdateBubbleFormula(f.ReferencesToFormula(n.Data))}},e.AddSersForStock=function(t,e){void 0===e&&(e=D);for(var i=0;i<t.length;i++){var n=t[i],r=new E(this,9,e);this._series.push(r),C(n.Label)?r.UpdateNameFormula(D):r.UpdateNameFormula(f.ReferencesToFormula([n.Label])),r.UpdateXValuesFormula(f.ReferencesToFormula(n.Categories)),r.UpdateValuesFormula(f.ReferencesToFormula(n.Data))}},e.AddSersForVolumeStock=function(t){var e=t.filter(function(t,e){return 0===e});this.AddSersDefault(e,12);var i=t.filter(function(t,e){return e>0});this.AddSersForStock(i,1)},e.DeleteSeries=function(t){this.UpdatePlotOrders(t.PlotOrder);var e=this._series.indexOf(t);e>=0&&this._series.splice(e,1),this._chart.HandleElementChanged(4,this,m.Collection)},e.UpdatePlotOrders=function(t){for(var e=0,i=this._series;e<i.length;e++){i[e].UpdateOrder(t)}},e.Splits=function(t,e){var i=[];if(1===e)for(var n=0;n<t.ColumnCount;n++)i.push(f.CreateReference(t.Worksheet.name(),t.Row,n+t.Column,t.RowCount,1));else for(var r=0;r<t.RowCount;r++)i.push(f.CreateReference(t.Worksheet.name(),r+t.Row,t.Column,1,t.ColumnCount));return i},e.MapToSourceIndex=function(t){if(!this._chart.PlotVisibleOnly||-1===t)return t;for(var e=0,i=this._series,n=0;n<i.length;n++)if(!i[n].IsHidden){if(e===t)return n;e++}return-1},e.SyncOneDimensionSersXValues=function(t,e){for(var i=0,n=this._series;i<n.length;i++){var r=n[i];if(r.AxisGroup===t)1===f.GetDimensioin(r.InnerChartType)&&r.SetXValuesInternal(e)}},e.SyncOneDimensionSersXValuesFormula=function(t,e){for(var i=0,n=this._series;i<n.length;i++){var r=n[i];if(t!==r&&r.AxisGroup===t.AxisGroup)1===f.GetDimensioin(r.InnerChartType)&&r.UpdateXValuesFormula(e)}},e.RestoreSeries=function(t){this._chart.SuspendElementChanged(),this._series=[];for(var e,i,n,r=f.GetPrimaryAxises(t),o=[],a=f.GetPieCharts(t),s=f.GetPrimaryPieChart(a),l=this._chart.PlotVisibleOnly,u=0,h=t.chartGroups;u<h.length;u++){var c=h[u],p=c.chartType;if([10,11,12,13].indexOf(p)>=0)for(var _=c,d=0,g=_.ser;d<g.length;d++){var y=g[d];i=f.GetChartTypeByPieChart(_,y),(e=new E(this,i,_===s?0:1)).PlotVisibleOnly=l,o.push(e),e.FromOOModel(y)}else if(0===p){var v=c;n=r.indexOf(v.axId[0])>=0?0:1;for(var b=0,S=v.ser;b<S.length;b++){var C=S[b];(e=new E(this,9,n)).PlotVisibleOnly=l,o.push(e),e.FromOOModel(C)}}else{var x;n=r.indexOf(c.axId[0])>=0?0:1;for(var T=0,w=c.ser;T<w.length;T++){var P=w[T];i=f.GetChartTypeByChartBase(c,P),(e=new E(this,i,n)).PlotVisibleOnly=l,o.push(e),0===T?x=P:!P.cat&&x&&x.cat&&(P.cat=x.cat),e.FromOOModel(P)}}}for(var A=0;A<o.length;A++)this._series.push(o[A]);this._chart.ResumeElementChanged(4,this,m.Restore)},e.RefreshSeriesIfNeed=function(t,e){for(var i=0,n=this._series;i<n.length;i++){n[i].RefreshValuesIfNeed(t,e)}},e.RefreshSeriesIfNeed2=function(t,e){if(1===f.GetDimensioin(this._chart.ChartType)){var i=this.GetValidSers()[0];!C(i)&&!C(i.XValuesRefers)&&i.XValuesRefers.length>0&&(i.AreAllXValuesDateTime=f.AreValuesDateTime(this.ChartView.sheet(),i.XValuesRefers,i.PlotVisibleOnly))}},e.SetSourceData=function(t,e){this._series.length=0,this.AddInteral(t,e,D,D)},e.AddInteral=function(t,e,i,n,r,o){var a=f.RangesToReferences(t);if(a.length>0){var s=this.GenerateSeriesStructures(a,e,i,n);if(!s)return;s.length&&f.IsStockChart(this.Parent.ChartType)&&f.AreValuesDateTime(this.ChartView.sheet(),s[0].Categories),this.AddSers(s,r,o)}},t}();u.SeriesCollection=G,t.exports=u}()},function(t,e,i){"use strict";!function(){var e=i(0),n=i(3).GC$.inherit,r=i(1),o=r.ChartElementBase,a=r.StatefulChartElementBase,s=r.ChartConstants,l=r.ChartUtility,u=l.defineProperty,h=l.colorFormatToString,c=r.UnitHelper.isNullOrUndefined,p=i(10).ColorSchemeIndex,f=i(5).ChartFormat,_=i(7).ColorFormat,d=i(6).DrawingText,g=i(13).GeneralFormatter,y=null;e.PointStates={Explosion:1,Format:2,Has3DEffect:4,InvertIfNegative:8,MarkerFormat:16,MarkerSize:32,MarkerStyle:64,PictureType:128,PictureUnit:256};var m=function(t){function e(e,i){var n=t.call(this,e)||this;return n._ooPoint=y,n._series=e,n._index=i,n._pictureUnit=1,n._markerSize=5,n._markerStyle=4,n}n(e,t);var i=e.prototype;return u(i,"DataLabel",{get:function(){return this._series.DataLabels.Get(this._index)}}),u(i,"Explosion",{get:function(){return this.GetState(1)?this._explosion:this._series.Explosion},set:function(t){t!==this._explosion&&t>=0&&t<=400&&(this._explosion=t,this.Dirty(1))}}),u(i,"Format",{get:function(){return this.ChartFormat}}),i.getFillColor=function(t){return h(this.Format.Fill,t)},i.getLineColor=function(t){return h(this.Format.Line,t)},u(i,"Has3DEffect",{get:function(){return this.GetState(4)?this._has3DEffect:this._series.Has3DEffect},set:function(t){this._has3DEffect=t,this.Dirty(4)}}),u(i,"HasDataLabel",{get:function(){var t=this._series.DataLabels.Get(this._index);return t&&!t.Deleted},set:function(t){this._series.DataLabels.Get(this._index).Deleted=!t}}),u(i,"InvertIfNegative",{get:function(){return this.GetState(8)?this._invertIfNegative:this._series.InvertIfNegative},set:function(t){this._invertIfNegative=t,this.Dirty(8)}}),u(i,"MarkerFormat",{get:function(){return c(this._markerFormat)&&(this._markerFormat=this.CreateMarkerFormat()),this._markerFormat}}),u(i,"MarkerSize",{get:function(){return this.GetState(32)?this._markerSize:this._series.MarkerSize},set:function(t){this._markerSize=t,this.Dirty(32)}}),u(i,"MarkerStyle",{get:function(){return this.GetState(64)?this._markerStyle:this._series.MarkerStyle},set:function(t){this._markerStyle=t,this.Dirty(64)}}),u(i,"Parent",{get:function(){return this._series}}),u(i,"PictureType",{get:function(){return this.GetState(128)?this._pictureType:this._series.PictureType},set:function(t){this._pictureType=t,this.Dirty(128)}}),u(i,"PictureUnit",{get:function(){return this.GetState(256)?this._pictureUnit:this._series.PictureUnit},set:function(t){this._pictureUnit=t,this.Dirty(256)}}),u(i,"SecondaryPlot",{get:function(){return this._secondaryPlot},set:function(t){t!==this._secondaryPlot&&(this._secondaryPlot=t,this.Chart.HandleElementChanged(5,this,s.SecondaryPlot))}}),u(i,"Chart",{get:function(){return this._series.SeriesCollection.Parent}}),u(i,"Index",{get:function(){return this._index}}),i.SetFillColor=function(t,e){this.Format.Fill.Color.setColor(t,e)},i.SetSecondaryPlotInteral=function(t){this._secondaryPlot=t},i.GetValueText=function(t){return void 0===t&&(t=y),this._series.GetPointValueText(this._index,t)},i.GetCatText=function(){return this._series.GetCatText(this._index)},i.GetPercentageValue=function(){return this._series.GetPercentageValue(this._index)},i.CreateFormat=function(){return new f(this._series.SeriesCollection.Parent,this._series.FormatInternal,this.AutoFillColorFormat.bind(this),this.AutoLineColorFormat.bind(this))},i.GetDefaultFormat=function(){return t.prototype.GetDefaultFormat.call(this)},i.CreateMarkerFormat=function(){return new f(this.Chart,this._series.MarkerFormat,this.AutoMarkerColorFormat.bind(this),this.AutoMarkerColorFormat.bind(this))},i.AutoFillColorFormat=function(){return l.IsFillSeries(this._series.InnerChartType)?this.GenerateAutoColor():y},i.AutoLineColorFormat=function(){return l.IsLineSeries(this._series.InnerChartType)?this.GenerateAutoColor():y},i.AutoMarkerColorFormat=function(){return l.IsMarkerSeries(this._series.InnerChartType)?this.GenerateAutoColor():y},i.GenerateAutoColor=function(){var t;t=this.IsRenderVaryColors()?this._index:this._series.AutoColorIndex;var e=new _(this.Chart);return e.ObjectThemeColor=p["Accent"+(t%12+1)],e},i.IsRenderVaryColors=function(){return 1===this._series.SeriesCollection.Count||l.IsAnyPieChart(this._series.InnerChartType)&&!0},i.IsDirtyIncludingParent=function(e){void 0===e&&(e=!1);return!(c(this._format)||!this._format.IsDirtyIncludingParent(e))||(!(c(this._markerFormat)||!this._markerFormat.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e))},i.OnParentChanged=function(t){this._series=t,c(this._format)||(this._format.ParentStateful=this._series.ChartFormat),c(this._markerFormat)||(this._markerFormat.ParentStateful=this._series.MarkerFormat)},i.IsNegative=function(){return this._series.Values[this._index]<0},i.MapToSourceIndex=function(t){if(!this._series.PlotVisibleOnly||!this._series.HasRefers(1)||!this._series.HasHiddenValues())return t;for(var e=0,i=0,n=0,r=this._series.ValuesRefers;n<r.length;n++){var o=r[n],a=this._series.Worksheet._GetSheet(o.WorksheetName);if(1===o.RowCount)for(var s=o.Column;s<o.Column+o.ColumnCount;s++){if(!a._GetRange(o.Row,s).EntireColumn.Hidden){if(i===t)return e;i++}e++}else if(1===o.ColumnCount)for(var l=o.Row;l<o.Row+o.RowCount;l++){if(!a._GetRange(l,o.Column).EntireRow.Hidden){if(i===t)return e;i++}e++}}return t},i.FromOOModel=function(e){this._ooPoint=e,this._index=e.idx;var i=e.bubble3D;c(i)||(this.Has3DEffect=i);var n=e.pictureOptions;c(n)||this.FromCT_PictureOptions(n);var r=e.explosion;c(r)||(this.Explosion=r);var o=e.invertIfNegative;c(o)||(this.InvertIfNegative=o),t.prototype.FromShapeProperties.call(this,e.spPr);var a=e.marker;c(a)||this.FromCT_Marker(a)},i.ToOOModel=function(){var e=c(this._ooPoint)?{}:this._ooPoint;return e.idx=this._index,this.GetState(4)&&(e.bubble3D=this.Has3DEffect),e.pictureOptions=this.ToCT_PictureOptions(),l.IsPieOrDoughnutChart(this._series.InnerChartType)&&this.GetState(1)&&(e.explosion=this.Explosion),e.invertIfNegative=this.InvertIfNegative,e.spPr=t.prototype.ToShapeProperties.call(this),e.marker=this.ToCT_Marker(),e},i.ToCT_PictureOptions=function(){var t={},e=!1;return this.GetState(128)&&(t.pictureFormat=this.PictureType,e=!0),this.GetState(256)&&(t.pictureStackUnit=this.PictureUnit,e=!0),e?t:y},i.FromCT_PictureOptions=function(t){var e=t.pictureFormat;c(e)||(this.PictureType=e);var i=t.pictureStackUnit;c(i)||(this.PictureUnit=i)},i.ToCT_Marker=function(){var t={},e=!1;return(!c(this._markerFormat)&&this._markerFormat.IsDirtyIncludingParent()||this.IsRenderVaryColors())&&(c(this._markerFormat)&&(this._markerFormat=this.CreateMarkerFormat()),t.spPr=this._markerFormat.ToOOModel(),e=!0),(this.GetState(32)||this.IsRenderVaryColors())&&(t.size=this.MarkerSize,e=!0),(this.GetState(64)||this.IsRenderVaryColors())&&(t.symbol=this.MarkerStyle,e=!0),e?t:y},i.FromCT_Marker=function(t){var e=t.spPr;c(e)?this.ClearMarkerFormat():(c(this._markerFormat)&&(this._markerFormat=this.CreateMarkerFormat()),this._markerFormat.FromOOModel(e));var i=t.size;c(i)||(this.MarkerSize=i);var n=t.symbol;c(n)||(this.MarkerStyle=n)},i.ClearMarkerFormat=function(){c(this._markerFormat)||(this._markerFormat.SetParentForChildren(y),this._markerFormat.ParentStateful=y,this._markerFormat=y)},e}(a);e.Point=m;var v=function(){function t(t){this._points={},this._series=t}var e=t.prototype;return u(e,"Count",{get:function(){return this._series.PointsCount}}),u(e,"Parent",{get:function(){return this._series}}),e.Get=function(t){return this.GetPoint(t)},u(e,"HasDataLabel",{get:function(){var t=this._points;for(var e in t){var i=t[e];if(!c(i)&&i.HasDataLabel)return!0}return!1}}),e.ItemInternal=function(t){return this._points[t]||y},e.GetPoint=function(t){if(t<0||t>=this.Count)return y;var e=this._points[t];return e||(e=new m(this._series,t),this._points[t]=e,e)},e.GetPoints=function(){return this._points},e.RestorePoints=function(t){if(this.ClearPoints(),!c(t))for(var e=0,i=t;e<i.length;e++){var n=i[e],r=this.GetPoint(n.idx);c(r)||r.FromOOModel(n)}},e.ClearPoints=function(){for(var t in this._points){var e=this._points[t];c(e)||(e.ParentStateful=y)}this._points={}},t}();e.Points=v,e.DataLableStates={Font:1,Format:2,NumberFormat:4,NumberFormatLinked:8,Position:16,Separator:32,ShowBubbleSize:64,ShowCategoryName:128,ShowLegendKey:256,ShowPercentage:512,ShowSeriesName:1024,ShowValue:2048,ShowLeaderLines:4096,Text:8192,AutoText:16384};var b=function(t){function e(e,i){var n=t.call(this,i)||this;return n._numberFormat="General",n._numberFormatLinked=!0,n._separator=",",n._showBubbleSize=!1,n._showCategoryName=!1,n._showLegendKey=!1,n._showPercentage=!1,n._showSeriesName=!1,n._showValue=!1,n._showLeaderLines=!1,n._autoText=!0,n._deleted=y,n._ooModel=y,n._series=e,n._parentLabel=i,n.UpdatePosition(),n}n(e,t);var i=e.prototype;return u(i,"AutoText",{get:function(){return this.GetState(16384)||c(this._parentLabel)?this._autoText:this._parentLabel.AutoText},set:function(t){this._autoText=t,this.Dirty(16384)}}),u(i,"Font",{get:function(){return this.ChartTextInternal.Font}}),u(i,"Format",{get:function(){return this.ChartFormat}}),u(i,"NumberFormat",{get:function(){return this.GetState(4)||c(this._parentLabel)?this._numberFormat?this._numberFormat:"General":this._parentLabel.NumberFormat},set:function(t){this.setNumberFormat(t)}}),i.setNumberFormat=function(t){this._numberFormat=t,t?this.Dirty(4):this.UnDirty(4),this._numberFormatLinked=!1,this.Dirty(8)},u(i,"NumberFormatLinked",{get:function(){return this.getNumberFormatLinked()},set:function(t){this.setNumberFormatLinked(t)}}),i.getNumberFormatLinked=function(){return this.GetState(8)||c(this._parentLabel)?this._numberFormatLinked:this._parentLabel.NumberFormatLinked},i.setNumberFormatLinked=function(t){this._numberFormatLinked=t,this.Dirty(8),t&&(this._numberFormat=y,this.UnDirty(4))},u(i,"Position",{get:function(){return this.GetState(16)||c(this._parentLabel)?this._position:this._parentLabel.Position},set:function(t){this.IsPositionValid(t)&&(this._position=t,this.Dirty(16))}}),u(i,"Separator",{get:function(){return this.GetState(32)||c(this._parentLabel)?this._separator:this._parentLabel.Separator},set:function(t){this._separator=t,this.Dirty(32)}}),u(i,"ShowBubbleSize",{get:function(){return this.GetState(64)||c(this._parentLabel)?this._showBubbleSize:this._parentLabel.ShowBubbleSize},set:function(t){this._showBubbleSize=t,this.Dirty(64)}}),u(i,"ShowCategoryName",{get:function(){return this.GetState(128)||c(this._parentLabel)?this._showCategoryName:this._parentLabel.ShowCategoryName},set:function(t){this._showCategoryName=t,this.Dirty(128)}}),u(i,"ShowLegendKey",{get:function(){return this.GetState(256)||c(this._parentLabel)?this._showLegendKey:this._parentLabel.ShowLegendKey},set:function(t){this._showLegendKey=t,this.Dirty(256)}}),u(i,"ShowPercentage",{get:function(){return this.GetState(512)||c(this._parentLabel)?this._showPercentage:this._parentLabel.ShowPercentage},set:function(t){this._showPercentage=t,this.Dirty(512)}}),u(i,"ShowSeriesName",{get:function(){return this.GetState(1024)||c(this._parentLabel)?this._showSeriesName:this._parentLabel.ShowSeriesName},set:function(t){this._showSeriesName=t,this.Dirty(1024)}}),u(i,"ShowValue",{get:function(){return this.GetState(2048)||c(this._parentLabel)?this._showValue:this._parentLabel.ShowValue},set:function(t){this._showValue=t,this.Dirty(2048)}}),u(i,"ShowLeaderLines",{get:function(){return this.GetState(4096)||c(this._parentLabel)?this._showLeaderLines:this._parentLabel.ShowLeaderLines},set:function(t){this._showLeaderLines=t,this.Dirty(4096)}}),u(i,"LeaderLines",{get:function(){return c(this._leaderLines)&&(this._leaderLines=this.CreateLeaderLines()),this._leaderLines}}),i.IsDirtyIncludingParent=function(e){void 0===e&&(e=!1);return!(c(this._chartText)||!this._chartText.Font.IsDirtyIncludingParent(e))||(!(c(this._format)||!this._format.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e))},i.OnParentChanged=function(t){this._parentLabel=t,c(this._parentLabel)||(c(this._format)||(this._format.ParentStateful=this._parentLabel.ChartFormat),c(this._leaderLines)||(this._leaderLines.Format.ParentStateful=this._parentLabel.LeaderLines.Format))},i.GetDefaultPosition=function(){var t=this._series.InnerChartType;return l.IsColumnChart(t)||l.IsBarChart(t)?l.IsStackedChart(t)?2:6:l.IsLineChart(t)||l.IsScatterChart(t)||l.IsBubbleChart(t)?7:l.IsPieChart(t)||l.IsOfPieChart(t)?0:2},i.IsNoPosition=function(){var t=this._series.InnerChartType;return l.IsAreaChart(t)||l.IsRadarChart(t)||l.Is3DChart(t)||l.IsDoughnutChart(t)},i.FromOOModel=function(e){this._ooModel=e;var i=e.numFmt;c(i)||(this._numberFormat=i.formatCode,this.Dirty(4),this._numberFormatLinked=!1!==i.sourceLinked,this.Dirty(8)),t.prototype.FromShapeProperties.call(this,e.spPr);var n=e.txPr;if(!c(n)){var r={};r.rich=n,this.ChartTextInternal.FromOOModel(r)}var o=e.dLblPos;c(o)||(this.Position=o);var a=e.showBubbleSize;!c(a)&&l.IsBubbleChart(this._series.InnerChartType)&&(this.ShowBubbleSize=a);var s=e.showCatName;this.ShowCategoryName=!c(s)&&s;var u=e.showLegendKey;this.ShowLegendKey=!c(u)&&u;var h=e.showPercent;!c(h)&&l.IsPieOrDoughnutChart(this._series.InnerChartType)&&(this.ShowPercentage=h);var p=e.showSerName;this.ShowSeriesName=!c(p)&&p;var f=e.showVal;this.ShowValue=!c(f)&&f;var _=e.separator;_&&","!==_&&(this.Separator=_);var d=e.delete;this._deleted=c(d)?y:d},i.ToOOModel=function(){var e=this._ooModel||this.CreateCT_Dlbl();if(this.GetState(4)||this.GetState(8)){var i={formatCode:this.NumberFormat};!1===this.NumberFormatLinked&&(i.sourceLinked=!1),e.numFmt=i}return e.spPr=t.prototype.ToShapeProperties.call(this),this._chartText&&this._chartText.Font.IsDirtyIncludingParent()&&(e.txPr=this._chartText.ToOOModel().rich),this.IsNoPosition()||(e.dLblPos=this.Position),this._deleted||(e.showBubbleSize=this.ShowBubbleSize,e.showCatName=this.ShowCategoryName,e.showLegendKey=this.ShowLegendKey,e.showPercent=this.ShowPercentage,e.showSerName=this.ShowSeriesName,e.showVal=this.ShowValue),","!==this.Separator&&(e.separator=this.Separator),e},i.CreateCT_Dlbl=function(){return y},i.GetDefaultChartText=function(){return y},i.IsPositionValid=function(t){var e=!1,i=this._series.InnerChartType;return l.IsColumnChart(i)||l.IsBarChart(i)?e=l.IsStackedChart(i)?2===t||3===t||4===t:2===t||3===t||4===t||6===t:l.IsLineChart(i)||l.IsScatterChart(i)||l.IsBubbleChart(i)?e=2===t||5===t||7===t||8===t||1===t:l.IsPieChart(i)?e=2===t||4===t||6===t||0===t:(l.IsAreaChart(i)||l.IsRadarChart(i)||l.Is3DChart(i))&&(e=!1),e},i.UpdatePosition=function(){this._position=this.GetDefaultPosition()},i.ResetByChartType=function(){this.UpdatePosition()},u(i,"Chart",{get:function(){return this._series.SeriesCollection.Parent}}),u(i,"ChartText",{get:function(){return this._chartText}}),u(i,"ChartTextInternal",{get:function(){return c(this._chartText)&&(this._chartText=this.GetDefaultChartText()),this._chartText}}),i.CreateLeaderLines=function(){return y},u(i,"HasDataLabelsRange",{get:function(){return!c(this._chartText)&&!c(this._chartText.TextRefer)}}),u(i,"Series",{get:function(){return this._series}}),e}(a);e.DataLabelBase=b;var S=function(t){function e(e){var i=t.call(this,e,y)||this;return i._labels={},i._series=e,i._chartText=i.GetDefaultChartText(),i._showValue=!1,i._showLeaderLines=!1,i}n(e,t);var i=e.prototype;return i.CreateFormat=function(){var t=new f(this.Chart);return t.Fill.Color.ColorType=0,t.Line.Color.ColorType=0,t},i.GetDefaultChartText=function(){return new d(this.Chart.Parent,this.Chart.ChartArea.Font)},u(i,"Parent",{get:function(){return this._series}}),u(i,"AutoText",{get:function(){return this._autoText},set:function(t){for(var e=0,i=this.Count;e<i;e++){this.GetLabel(e).AutoText=t}this._autoText=t}}),u(i,"Count",{get:function(){return this._series.PointsCount}}),u(i,"NumberFormat",{get:function(){return this.GetNumberFormat()},set:function(e){t.prototype.setNumberFormat.call(this,e)}}),u(i,"NumberFormatLinked",{get:function(){return t.prototype.getNumberFormatLinked.call(this)},set:function(e){e||(this._numberFormat=this.GetFirstNumberFormat(),this.Dirty(4)),t.prototype.setNumberFormatLinked.call(this,e)}}),i.Get=function(t){return this.GetLabel(t)},i.IsDirtyIncludingParent=function(e){return void 0===e&&(e=!1),!(c(this._leaderLines)||!this._leaderLines.Format.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e)},i.CreateLeaderLines=function(){return new T(this)},i.GetLabel=function(t){if(t<0||t>=this.Count)return y;var e=this._labels[t];return e||(e=new C(this._series,t),this._labels[t]=e,e)},i.UpdateDeleted=function(t){var e=this._labels;for(var i in e){var n=e[i];c(n)||(n.Deleted=t)}},i.ResetByChartType=function(){t.prototype.ResetByChartType.call(this);for(var e=0,i=this.Count;e<i;e++){var n=this.GetLabel(e);n.IsDirtyIncludingParent()&&n.ResetByChartType()}},i.GetNumberFormat=function(){var t=this._numberFormat;return this.GetState(4)||(this.NumberFormatLinked&&!c(this._series.ValuesRefers)&&this._series.ValuesRefers.length>0?t=this.GetFirstNumberFormat():c(this._parentLabel)||(t=this._parentLabel.NumberFormat)),t||"General"},i.GetFirstNumberFormat=function(){var t=this._series.ValuesRefers[0],e=this._series.Worksheet._GetSheet(t.WorksheetName),i=y;if(!c(e)){var n=e._GetCellStyle(t.Row,t.Column);c(n)||(i=n.FormatCode)}return i||"General"},i.ToOOModel=function(){var e=t.prototype.ToOOModel.call(this);if(this.ShowLeaderLines){e.extLst={ext:[]};var i={uri:"{CE6537A1-D6FC-4f65-9D91-7224C49458BB}"};e.extLst.ext.push(i),i.showLeaderLines=!0,e.showLeaderLines=!0,c(this._leaderLines)?delete e.leaderLines:e.leaderLines=this._leaderLines.ToOOModel()}var n=[];for(var r in this._labels){var o=this._labels[r];c(o)||c(this._chartText.TextRefer)&&!o.Deleted&&!o.IsDirtyIncludingParent()||n.push(o.ToOOModel())}return n.length>0&&(e.dLbl=n),e},i.FromOOModel=function(e){t.prototype.FromOOModel.call(this,e),this._labels={};var i=e.dLbl;if(!c(i))for(var n=0,r=i;n<r.length;n++){var o=r[n],a=this.GetLabel(o.idx);c(a)||a.FromOOModel(o)}var s=e.showLeaderLines;c(s)||(this.ShowLeaderLines=s);var l=e.leaderLines;c(l)?this._leaderLines=y:(c(this._leaderLines)&&(this._leaderLines=this.CreateLeaderLines()),this._leaderLines.FromOOModel(l))},i.CreateCT_Dlbl=function(){return{dLbl:[]}},i._copyProperties=function(t){this.Separator=t.Separator,this.ShowBubbleSize=t.ShowBubbleSize,this.ShowCategoryName=t.ShowCategoryName,this.ShowLegendKey=t.ShowLegendKey,this.ShowPercentage=t.ShowPercentage,this.ShowSeriesName=t.ShowSeriesName,this.ShowValue=t.ShowValue,this.ShowLeaderLines=t.ShowLeaderLines,this.Position=t.Position},e}(b);e.DataLabels=S;var C=function(t){function e(e,i){var n=t.call(this,e,e.DataLabels)||this;return n._series=e,n._index=i,n}n(e,t);var i=e.prototype;return i.CreateFormat=function(){var t=new f(this.Chart,this._series.DataLabels.Format);return t.Fill.Color.ColorType=0,t.Line.Color.ColorType=0,t},i.GetDefaultChartText=function(){var t=this._series.SeriesCollection.Parent;return new d(t.Parent,this._series.DataLabels.Font)},u(i,"Parent",{get:function(){return this._series.Points.Get(this._index)}}),u(i,"AutoText",{get:function(){return this._autoText},set:function(t){this._autoText!==t&&(t||(this.ChartTextInternal.Text=this.GetAutoText(),this.Dirty(8192)),this._autoText=t)}}),u(i,"NumberFormat",{get:function(){return this.GetNumberFormat()},set:function(e){t.prototype.setNumberFormat.call(this,e)}}),u(i,"NumberFormatLinked",{get:function(){return t.prototype.getNumberFormatLinked.call(this)},set:function(e){e||(this._numberFormat=this.GetNumberFormat(),this.Dirty(4)),t.prototype.setNumberFormatLinked.call(this,e)}}),u(i,"Text",{get:function(){return this.GetText()},set:function(t){this.ChartTextInternal.Text=t,this.Dirty(8192),this._autoText=!1,this.Dirty(16384)}}),i.Delete=function(){this._deleted=!0},i.CreateLeaderLines=function(){return new w(this)},u(i,"Deleted",{get:function(){return!c(this._deleted)&&this._deleted},set:function(t){this._deleted=t,t||(this.ShowValue=!0,this.ShowLeaderLines=!0)}}),u(i,"ParentLabels",{get:function(){return this._parentLabel}}),i.GetNumberFormat=function(){var t=this._numberFormat;if(!this.GetState(4)){var e=this._series.ValuesRefers;if(this.NumberFormatLinked&&!c(e)&&e.length>0){var i={sheet:y,row:-1,col:-1};this._series.GetRowColIndex(e,this._index,i);var n=i.sheet,r=i.row,o=i.col;if(!c(n)&&-1!==r&&-1!==o){var a=n._GetCellStyle(r,o);c(a)||(t=a.FormatCode)}}else c(this._parentLabel)||(t=this._parentLabel.NumberFormat)}return t||"General"},i.GetText=function(){return this.AutoText?this.GetAutoText():this._chartText.Text},i.GetAutoText=function(){var t=[],e=!1;if(this.ShowSeriesName){var i=this._series.Name;t.push(c(i)?"":i),e=!0}return this.ShowCategoryName&&(e&&t.push(this.Separator),t.push(this._series.GetCatText(this._index)),e=!0),this.ShowValue&&(e&&t.push(this.Separator),t.push(this._series.GetPointValueText(this._index,this.NumberFormat)),e=!0),this.ShowBubbleSize&&l.IsBubbleChart(this._series.InnerChartType)&&(e&&t.push(this.Separator),t.push(this._series.BubbleSizes[this._index].toString()),e=!0),this.ShowPercentage&&l.IsPieOrDoughnutChart(this._series.InnerChartType)&&(e&&t.push(this.Separator),t.push(this.GetPercentText())),t.join("")},i.GetValueText=function(){return this.GetState(8192)?this.NumberFormatLinked?this._series.GetPointValueText(this._index):this._series.GetPointValueText(this._index,this.NumberFormat):this._chartText.Text},i.GetPercentText=function(){var t=this.GetNumberFormat(),e=new g("General"===t?"0%":t),i=this._series.GetPercentageValue(this._index);return e.format(i)},i.FromOOModel=function(e){if(t.prototype.FromOOModel.call(this,e),this._index=e.idx,c(e.tx)){if(!c(e.txPr)){var i={};i.rich=e.txPr,this.ChartTextInternal.FromOOModel(i),this._autoText=!0,this.UnDirty(16384)}}else{var n=e.tx.rich;c(e.tx.rich)&&!c(e.txPr)&&(e.tx.rich=e.txPr),this.ChartTextInternal.FromOOModel(e.tx);var r=!1,o=e.extLst;if(!c(o)&&!c(o.ext))for(var a=0,s=o.ext;a<s.length;a++){if(s[a].showDataLabelsRange){r=!0;break}}r?(this._autoText=!0,this.UnDirty(16384)):(this._autoText=!1,this.Dirty(16384),this.Dirty(8192)),e.tx.rich=n}},i.ToOOModel=function(){if(this.Deleted){var e={};return e.idx=this._index,e.delete=!0,e}var i=t.prototype.ToOOModel.call(this);i.idx=this._index;var n,r=i.extLst;if(!c(r)&&!c(r.ext)&&r.ext.length>0){for(var o,a=y,s=r.ext,l=0,u=s.length;l<u;l++){var h=s[l];if(!c(h.layout)){a=h,o=l;break}}if(!c(a)){r.ext.splice(o,1);var p=a.layout,f=i.layout;if(!c(p)){c(p.extLst)||(f.extLst=p.extLst);var _=p.manualLayout;if(!c(_))if(c(f.manualLayout))f.manualLayout=_;else{var d=f.manualLayout;c(_.x)||(d.x=_.x),c(_.y)||(d.y=_.y),c(_.w)||(d.w=_.w),c(_.h)||(d.h=_.h)}}}i.extLst=y}var g=this.ParentLabels;if(c(g)||!g.ShowDataLabelsRange||c(g.ChartText)||c(g.ChartText.TextRefer))this.AutoText&&!c(this._chartText)?(i.txPr=this._chartText.ToOOModel().rich,i.tx=y):c(this._chartText)||(n=this._chartText.ToOOModel(),c(this._chartText.TextRefer)?(i.tx=n,i.txPr=y):(i.tx={},i.tx.strRef=n.strRef,i.txPr=n.rich));else{n=this._chartText.ToOOModel(),i.tx=n,i.txPr=y,i.extLst={ext:[]};var m={uri:"{CE6537A1-D6FC-4f65-9D91-7224C49458BB}",dlblFieldTable:{dlblFTEntry:[]},showDataLabelsRange:!0};i.extLst.ext.push(m)}return i},i.CreateCT_Dlbl=function(){var t={layout:{}};return t},e}(b);e.DataLabel=C;var x=function(t){function e(e){var i=t.call(this)||this;return i._ooLines=y,i._dataLabelBase=e,i}n(e,t);var i=e.prototype;return u(i,"Format",{get:function(){return this.ChartFormat}}),i.GetDefaultFormat=function(){var e=t.prototype.GetDefaultFormat.call(this),i=e.Line,n=i.Color;return n.ObjectThemeColor=1,n.Brightness=.65,i.Weight=1,e},i.Delete=function(){this._dataLabelBase.ShowLeaderLines=!1},i.FromOOModel=function(e){this._ooLines=e,t.prototype.FromShapeProperties.call(this,e.spPr)},i.ToOOModel=function(){var e=this._ooLines||{};return e.spPr=t.prototype.ToShapeProperties.call(this),e},e}(o);e.DblsLeaderLinesBase=x;var T=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.CreateFormat=function(){return new f(this._dataLabelBase.Chart)},e}(x);e.DataLabelsLeaderLines=T;var w=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.CreateFormat=function(){return new f(this._dataLabelBase.Chart,this._dataLabelBase.Series.DataLabels.LeaderLines.Format)},e}(x);e.DataLabelLeaderLines=w,t.exports=e}()},function(t,e,i){"use strict";!function(){var e=i(0),n=i(3).GC$.inherit,r=i(1),o=r.ChartConstants,a=r.ChartUtility,s=a.defineProperty,l=r.ChartElementBase,u=r.UnitHelper.isNullOrUndefined,h=i(5).ChartFormat,c=null,p=function(t){function e(e,i){var n=t.call(this)||this;return n._ooLines=c,n._chartGroup=e,n._linesType=i,n}n(e,t);var i=e.prototype;return s(i,"Format",{get:function(){return this.ChartFormat}}),i.GetDefaultFormat=function(){switch(this._linesType){case 0:return this.GetDefaultDropLinesFormat();case 1:return this.GetDefaultHiLoLinesFormat();case 2:return this.GetOfPieDefaultSerLinesFormat();case 3:return this.GetDlblsDefaultLeaderLines()}return t.prototype.GetDefaultFormat.call(this)},i.GetOfPieDefaultSerLinesFormat=function(){var e=t.prototype.GetDefaultFormat.call(this),i=e.Line,n=i.Color;return n.ObjectThemeColor=1,n.Brightness=.65,i.Weight=1,e},i.GetDefaultHiLoLinesFormat=function(){var e=t.prototype.GetDefaultFormat.call(this),i=e.Line,n=i.Color;return n.ObjectThemeColor=1,n.Brightness=.25,i.Weight=1,e},i.GetDefaultDropLinesFormat=function(){var e=t.prototype.GetDefaultFormat.call(this),i=e.Line,n=i.Color;return n.ObjectThemeColor=1,n.Brightness=.65,i.Weight=1,e},i.GetDlblsDefaultLeaderLines=function(){var e=t.prototype.GetDefaultFormat.call(this),i=e.Line,n=i.Color;return n.ObjectThemeColor=1,n.Brightness=.65,i.Weight=1,e},i.Delete=function(){var t=this._linesType,e=this._chartGroup;0===t?e.HasDropLines=!1:1===t?e.HasHiLoLines=!1:2===t&&(e.HasSeriesLines=!1)},i.FromOOModel=function(e){this._ooLines=e,u(e)?t.prototype.ClearFormat.call(this):t.prototype.FromShapeProperties.call(this,e.spPr)},i.ToOOModel=function(){var e=this._ooLines||{};return e.spPr=t.prototype.ToShapeProperties.call(this),e},i.CreateFormat=function(){return new h(this._chartGroup.Parent)},e}(l);e.ChartLines=p,e.BarType={Up:0,Down:1};var f=function(t){function e(e,i){var n=t.call(this)||this;return n._ooBar=c,n._chartGroup=e,n._type=i,n}n(e,t);var i=e.prototype;return s(i,"Format",{get:function(){return this.ChartFormat}}),s(i,"Parent",{get:function(){return this._chartGroup}}),i.GetDefaultFormat=function(){return 0===this._type?this.GetDefaultUpBarsFormat():this.GetDefaultDownBarsFormat()},i.GetDefaultUpBarsFormat=function(){var e=t.prototype.GetDefaultFormat.call(this);e.Fill.Color.ObjectThemeColor=0;var i=e.Line,n=i.Color;return n.ObjectThemeColor=1,n.Brightness=.35,i.Weight=1,e},i.GetDefaultDownBarsFormat=function(){var e=t.prototype.GetDefaultFormat.call(this);e.Fill.Color.ObjectThemeColor=1;var i=e.Line,n=i.Color;return n.ObjectThemeColor=1,n.Brightness=.35,i.Weight=1,e},i.Delete=function(){this._chartGroup.HasUpDownBars=!1},i.FromOOModel=function(e){this._ooBar=e,u(e)?t.prototype.ClearFormat.call(this):t.prototype.FromShapeProperties.call(this,e.spPr)},i.ToOOModel=function(){var e=this._ooBar||{};return e.spPr=t.prototype.ToShapeProperties.call(this),e},i.CreateFormat=function(){return new h(this._chartGroup.Parent)},e}(l);e.ChartBars=f;var _=function(){function t(t,e,i){this._secondPlotSize=75,this._pieSplitType=0,this._splitValue=2,this._doughnutHoleSize=75,this._varyByCategories=!1,this._hasDroplines=!1,this._hasHiLoLines=!1,this._hasSeriesLines=!1,this._hasUpDownBars=!1,this._sizeRepresents=0,this._bubbleScale=100,this._firstSliceAngle=0,this._gapWidth=0,this._chart=t,this._groupType=e,this._axisGroup=i,this.Init()}var e=t.prototype;function i(t,e){return t.some(function(t){return t===e.Index})}return s(e,"AxisGroup",{get:function(){return this._axisGroup},set:function(t){if(t!==this._axisGroup){this._axisGroup=t,this._chart.SuspendElementChanged();for(var e=0,i=this.GetSers();e<i.length;e++){i[e].AxisGroup=t}this._chart.ResumeElementChanged(17,c,o.AxisGroup)}}}),s(e,"BubbleScale",{get:function(){return this._bubbleScale},set:function(t){t!==this._bubbleScale&&t>=0&&t<=300&&(this._bubbleScale=t)}}),s(e,"DoughnutHoleSize",{get:function(){return this._doughnutHoleSize},set:function(t){t!==this._doughnutHoleSize&&t>=10&&t<=90&&(this._doughnutHoleSize=t)}}),s(e,"FirstSliceAngle",{get:function(){return this._firstSliceAngle},set:function(t){t!==this._firstSliceAngle&&t>=0&&t<=360&&(this._firstSliceAngle=t)}}),s(e,"GapWidth",{get:function(){return this._gapWidth},set:function(t){t!==this._gapWidth&&t>=0&&t<=500&&(this._gapWidth=t)}}),s(e,"HasDropLines",{get:function(){return this._hasDroplines},set:function(t){t!==this._hasDroplines&&(this._hasDroplines=t,t&&u(this._dropLines)&&(this._dropLines=new p(this,0)))}}),s(e,"HasHiLoLines",{get:function(){return this._hasHiLoLines},set:function(t){t!==this._hasHiLoLines&&(this._hasHiLoLines=t,t&&u(this._hiLoLines)&&(this._hiLoLines=new p(this,1)))}}),s(e,"HasSeriesLines",{get:function(){return this._hasSeriesLines},set:function(t){t!==this._hasSeriesLines&&(this._hasSeriesLines=t,t&&u(this._serLines)&&(this._serLines=new p(this,2)))}}),s(e,"HasUpDownBars",{get:function(){return this._hasUpDownBars},set:function(t){t!==this._hasUpDownBars&&(this._hasUpDownBars=t,t&&u(this._upBars)&&(this._upBars=new f(this,0)),t&&u(this._downBars)&&(this._downBars=new f(this,1)))}}),s(e,"Overlap",{get:function(){return this._overlap},set:function(t){t!==this._overlap&&t>=-100&&t<=100&&(this._overlap=t)}}),s(e,"Parent",{get:function(){return this._chart}}),s(e,"SecondPlotSize",{get:function(){return this._secondPlotSize},set:function(t){t!==this._secondPlotSize&&t>=5&&t<=200&&(this._secondPlotSize=t)}}),s(e,"SeriesLines",{get:function(){return this.HasSeriesLines?this._serLines:c}}),s(e,"HiLoLines",{get:function(){return this.HasHiLoLines?this._hiLoLines:c}}),s(e,"DropLines",{get:function(){return this.HasDropLines?this._dropLines:c}}),s(e,"SizeRepresents",{get:function(){return this._sizeRepresents},set:function(t){this._sizeRepresents=t}}),s(e,"SplitType",{get:function(){return this._pieSplitType},set:function(t){if(t!==this._pieSplitType){this._pieSplitType=t;this._splitValue={0:2,1:50,2:10}[this._pieSplitType]||this._splitValue,this._chart.HandleElementChanged(17,this,o.SplitType)}}}),s(e,"SplitValue",{get:function(){return this._splitValue},set:function(t){t!==this._splitValue&&(this._splitValue=t,this._chart.HandleElementChanged(17,this,o.SplitValue))}}),s(e,"UpBars",{get:function(){return this.HasUpDownBars?this._upBars:c}}),s(e,"DownBars",{get:function(){return this.HasUpDownBars?this._downBars:c}}),s(e,"VaryByCategories",{get:function(){return this._varyByCategories},set:function(t){if(t!==this._varyByCategories&&(this._varyByCategories=t,t))for(var e=0,i=this.GetSers();e<i.length;e++){var n,r=i[e],o=r.InnerChartType;a.IsFillSeries(o)?1!==(n=r.Format.Fill.Color).ColorType&&(n.ColorType=1):a.IsLineSeries(o)&&!a.IsStockChart(this._chart.ChartType)&&1!==(n=r.Format.Line.Color).ColorType&&(n.ColorType=1)}}}),s(e,"SeriesCollection",{get:function(){return this.GetSers()}}),e.Equals=function(t){return!u(t)&&t.AxisGroup===this._axisGroup&&t._groupType===this._groupType},s(e,"Marker",{get:function(){return this._marker},set:function(t){this._marker=t}}),s(e,"Count",{get:function(){return this.GetSers().length}}),s(e,"GroupType",{get:function(){return this._groupType}}),e.IsStacked=function(){for(var t=0,e=this.GetSers();t<e.length;t++){var i=e[t];if(a.IsStackedChart(i.InnerChartType))return!0}return!1},e.GetSers=function(){for(var t=this._chart.SeriesCollection,e=[],i=0,n=t.Count;i<n;i++){var r=t.Get(i);this._axisGroup===r.AxisGroup&&a.MapToGroupType(r.InnerChartType)===this._groupType&&e.push(r)}return e},e.Init=function(){var t=this._chart.ChartType,e=this._groupType;if(8===e?a.IsStackedChart(t)||this.IsStacked()?(this._gapWidth=150,this._overlap=100):(this._gapWidth=182,this._overlap=0):9===e||3===e||2===e?a.IsStackedChart(t)||this.IsStacked()?(this._gapWidth=150,this._overlap=100):(this._gapWidth=150,this._overlap=-27):11===e?this._gapWidth=150:12===e&&(a.IsOfPieChart(t)?(this._gapWidth=100,this._hasSeriesLines=!0):this._hasSeriesLines=!1),a.IsDoughnutChart(t)&&a.IsExplodedChart(t)?this._doughnutHoleSize=50:this._doughnutHoleSize=75,a.IsLineMarkerChart(t))this._marker=!0;else if(11===e){this.GetSers().some(function(t){return 4!==t.MarkerStyle})&&(this._marker=!0)}this._hasSeriesLines=a.HasSeriesLines(t),this._serLines=this._hasSeriesLines?new p(this,2):c,this._hasHiLoLines=a.HasHiLoLines(t),this._hiLoLines=this._hasHiLoLines?new p(this,1):c,this._hasUpDownBars=a.HasUpDownBars(t),this._upBars=this._hasUpDownBars?new f(this,0):c,this._downBars=this._hasUpDownBars?new f(this,1):c,this._varyByCategories=12===this._groupType||5===this._groupType||10===this._groupType},e.Restore=function(t){switch(this._groupType){case 1:this.RestoreArea3DGroup(t);break;case 2:case 3:this.RestoreBar3DGroup(t);break;case 4:this.RestoreLine3DGroup(t);break;case 5:this.RestorePie3DGroup(t);break;case 7:this.RestoreAreaGroup(t);break;case 8:this.RestoreBarGroup(t,!0);break;case 9:this.RestoreBarGroup(t,!1);break;case 10:this.RestoreDoughnutGroup(t);break;case 11:a.IsStockChart(this._chart.ChartType)?(this.RestoreStockGroup(t),this.RestoreBarGroup(t,!1)):this.RestoreLineGroup(t);break;case 12:this.RestorePieGroup(t),this.RestoreOfPieGroup(t);break;case 13:this.RestoreRadarGroup(t);break;case 14:this.RestoreXYGroup(t),this.RestoreBubbleGroup(t)}},e.RestoreBarGroup=function(t,e){var i=this.GetBarCharts(t,this._axisGroup,e);if(i.length>0){var n=i[0];this.RestoreBarBaseGroup(n),u(n.overlap)?this.Overlap=0:this.Overlap=n.overlap,n.serLines&&n.serLines.length>0?(this.HasSeriesLines=!0,this._serLines.FromOOModel(n.serLines[0])):this.HasSeriesLines=!1}},e.RestoreBarBaseGroup=function(t){u(t.gapWidth)||(this.GapWidth=t.gapWidth),u(t.varyColors)||(this._varyByCategories=t.varyColors)},e.GetBarCharts=function(t,e,i){for(var n=[],r=0,o=this.GetCharts(6,t,e);r<o.length;r++){var a=o[r],s=a.barDir;i?0===s&&n.push(a):(u(s)||1===s)&&n.push(a)}return n},e.RestoreLineGroup=function(t){var e=this.GetCharts(8,t,this._axisGroup);if(e.length>0){var i=e[0];this.RestoreLineBaseGroup(i);var n=i.hiLowLines;u(n)?this.HasHiLoLines=!1:(this.HasHiLoLines=!0,this._hiLoLines.FromOOModel(n));var r=i.upDownBars;u(r)?this.HasUpDownBars=!1:(this.HasUpDownBars=!0,this._upBars.FromOOModel(r.upBars),this._downBars.FromOOModel(r.downBars));var o=i.marker;u(o)?this.Marker=!1:this.Marker=o}},e.RestoreLineBaseGroup=function(t){var e=t.varyColors;u(e)||(this._varyByCategories=e);var i=t.dropLines;u(i)?this.HasDropLines=!1:(this.HasDropLines=!0,this._dropLines.FromOOModel(i))},e.RestoreStockGroup=function(t){var e=this.GetCharts(0,t,this._axisGroup);if(e.length>0){var i=e[0],n=i.dropLines;u(n)?this.HasDropLines=!1:(this.HasDropLines=!0,this._dropLines.FromOOModel(n));var r=i.hiLowLines;u(r)?this.HasHiLoLines=!1:(this.HasHiLoLines=!0,this._hiLoLines.FromOOModel(r));var o=i.upDownBars;u(o)?this.HasUpDownBars=!1:(this.HasUpDownBars=!0,this._upBars.FromOOModel(o.upBars),this._downBars.FromOOModel(o.downBars),u(o.gapWidth)||(this.GapWidth=o.gapWidth))}},e.RestoreXYGroup=function(t){var e=this.GetCharts(1,t,this._axisGroup);if(e.length>0){var i=e[0].varyColors;i&&(this._varyByCategories=i)}},e.RestoreBubbleGroup=function(t){var e=this.GetCharts(3,t,this._axisGroup);if(e.length>0){var i=e[0],n=i.varyColors;n&&(this._varyByCategories=n);var r=i.bubbleScale;u(r)||(this._bubbleScale=r);var o=i.showNegBubbles;u(o)||(this.ShowNegativeBubbles=o);var a=i.sizeRepresents;u(a)||(this.SizeRepresents=a)}},e.RestorePieGroup=function(t){var e=c,i=a.GetPieChart(t);if(0===this._axisGroup)i.length>0&&(e=i[0]);else{var n=a.GetPieCharts(t);10===a.GetPrimaryPieChart(n).chartType?i.length>1&&(e=i[1]):i.length>0&&(e=i[0])}u(e)||this.RestorePieBaseGroup(e)},e.RestoreOfPieGroup=function(t){var e=c,n=a.GetOfPieChart(t);if(0===this._axisGroup)n.length>0&&(e=n[0]);else{var r=a.GetPieCharts(t);13===a.GetPrimaryPieChart(r).chartType?n.length>1&&(e=n[1]):n.length>0&&(e=n[0])}if(e){this.RestorePieBaseGroup(e);var o=e.serLines;!u(o)&&o.length>0?(this.HasSeriesLines=!0,this._serLines.FromOOModel(o[0])):this.HasSeriesLines=!1;var s=e.secondPieSize;u(s)||(this.SecondPlotSize=s);var l=e.gapWidth;u(l)||(this.GapWidth=l);var h=e.splitType;u(h)||(this._pieSplitType=h);var p=e.splitPos;if(u(p)||(this._splitValue=p),3===this._pieSplitType){var f=e.custSplit,_=f&&f.secondPiePt;if(_&&_.length>0)for(var d=0,g=this.GetSers();d<g.length;d++)for(var y=g[d],m=y.Points,v=0,b=m.Count;v<b;v++){var S=m.Get(v);S.SetSecondaryPlotInteral(i(_,S))}}else for(var C=0,x=this.GetSers();C<x.length;C++)(y=x[C]).UpdateSecondPlotPoints()}},e.RestoreDoughnutGroup=function(t){var e=c,i=a.GetDoughnutChart(t);if(0===this._axisGroup)i.length>0&&(e=i[0]);else{var n=a.GetPieCharts(t);12===a.GetPrimaryPieChart(n).chartType?i.length>1&&(e=i[1]):i.length>0&&(e=i[0])}if(e){this.RestorePieBaseGroup(e);var r=e.holeSize;u(r)||(this.DoughnutHoleSize=r)}},e.RestorePieBaseGroup=function(t){var e=t.varyColors;u(e)||(this._varyByCategories=e);var i=t.firstSliceAng;u(i)||(this._firstSliceAngle=i)},e.RestoreRadarGroup=function(t){var e=this.GetCharts(2,t,this._axisGroup);if(e.length>0){var i=e[0].varyColors;u(i)||(this._varyByCategories=i)}},e.RestoreAreaGroup=function(t){var e=this.GetCharts(4,t,this._axisGroup);e.length>0&&this.RestoreAreaBaseGroup(e[0])},e.RestoreAreaBaseGroup=function(t){var e=t.varyColors;u(e)||(this._varyByCategories=e);var i=t.dropLines;u(i)?this.HasDropLines=!1:(this.HasDropLines=!0,this._dropLines.FromOOModel(i))},e.RestoreArea3DGroup=function(t){var e=a.GetArea3DChart(t);if(!u(e)){var i=e;this.RestoreAreaBaseGroup(i);var n=i.gapDepth;u(n)||(this._chart.GapDepth=n)}},e.RestoreBar3DGroup=function(t){var e=a.GetBar3DChart(t);if(!u(e)){var i=e;this.RestoreBarBaseGroup(i);var n=i.gapDepth;u(n)||(this._chart.GapDepth=n);var r=i.shape;u(r)||this._chart.SetBarShapeInternal(r)}},e.RestoreLine3DGroup=function(t){var e=a.GetLine3DChart(t);if(!u(e)){this.RestoreLineBaseGroup(e);var i=e.gapDepth;u(i)||(this._chart.GapDepth=i)}},e.RestorePie3DGroup=function(t){var e=a.GetPie3DChart(t);u(e)||this.RestorePieBaseGroup(e)},e.GetCharts=function(t,e,i){for(var n=a.GetPrimaryAxises(e),r=[],o=[],s=0,l=e.chartGroups;s<l.length;s++){var u=l[s];if(u.chartType===t)for(var h=u,c=0,p=h.axId;c<p.length;c++){var f=p[c];-1===n.indexOf(f)&&-1===o.indexOf(h)?o.push(h):-1===r.indexOf(h)&&r.push(h)}}return 0===i?r:o},t}();e.ChartGroup=_;var d=function(){function t(t,e){this._cachedChartGroups=[],this._chart=t,this._groupType=e}var e=t.prototype;return s(e,"Count",{get:function(){return this.GetChartGroups().length}}),s(e,"Parent",{get:function(){return this._chart}}),e.Get=function(t){var e=this.GetChartGroups();return t>=0&&t<e.length?e[t]:c},e.GetChartGroups=function(){var t=this.GetValidChartGroups();if(0===t.length&&a.MapToGroupType(this._chart.ChartType)===this._groupType){var e=this.TryGetCachedGroup(0);t.push(e)}return t},e.TryGetCachedGroup=function(t){for(var e=0,i=this._cachedChartGroups;e<i.length;e++){var n=i[e];if(n.GroupType===this._groupType&&n.AxisGroup===t)return n}var r=new _(this._chart,this._groupType,t);return this._cachedChartGroups.push(r),r},e.GetValidChartGroups=function(){var t=[],e=this.TryGetCachedGroup(0);!u(e)&&e.Count>0&&t.push(e);var i=this.TryGetCachedGroup(1);return!u(i)&&i.Count>0&&t.push(i),t},e.Reset=function(){for(var t=0,e=this._cachedChartGroups;t<e.length;t++){e[t].Init()}},t}();e.ChartGroups=d;var g=function(){function t(t){this._chart=t}var e=t.prototype;return s(e,"Count",{get:function(){return this.GetAllChartGroups().length}}),s(e,"Parent",{get:function(){return this._chart}}),e.Get=function(t){var e=this.GetAllChartGroups();return t>=0&&t<e.length?e[t]:c},e.GetAllChartGroups=function(){var t=[],e=this._chart.AreaGroups;u(e)||this._pushChartGroups(t,e);var i=this._chart.BarGroups;u(i)||this._pushChartGroups(t,i);var n=this._chart.ColumnGroups;u(n)||this._pushChartGroups(t,n);var r=this._chart.DoughnutGroups;u(r)||this._pushChartGroups(t,r);var o=this._chart.LineGroups;u(o)||this._pushChartGroups(t,o);var a=this._chart.PieGroups;u(a)||this._pushChartGroups(t,a);var s=this._chart.RadarGroups;u(s)||this._pushChartGroups(t,s);var l=this._chart.XYGroups;return u(l)||this._pushChartGroups(t,l),t},e._pushChartGroups=function(t,e){for(var i=0,n=e.Count;i<n;i++)t.push(e.Get(i))},e.Reset=function(){for(var t=0,e=this.GetAllChartGroups();t<e.length;t++){e[t].Init()}},t}();e.FullChartGroups=g,e.ChartGroupType={UnKnown:0,Area3DGroup:1,Bar3DGroup:2,Column3DGroup:3,Line3DGroup:4,Pie3DGroup:5,SurfaceGroup:6,AreaGroup:7,BarGroup:8,ColumnGroup:9,DoughnutGroup:10,LineGroup:11,PieGroup:12,RadarGroup:13,XYGroup:14},e.ChartLinesType={DropLines:0,HiLoLines:1,SeriesLines:2,DlblsLeaderLines:3},t.exports=e}()},function(t,e,i){"use strict";!function(){var e=i(2)._Types._inherit,n=i(0),r=i(1),o=r.ChartElementBase,a=r.ChartUtility,s=a.defineProperty,l=r.UnitHelper,u=l.isNullOrUndefined,h=i(6).DrawingText,c=i(5).ChartFormat,p=null,f=void 0,_=function(t){function i(e,i,n){n===f&&(n=-1),t.call(this);return this._legendEntry=e,this._ser=i,this._point=n,this}e(i,t);var n=i.prototype;return n.Equals=function(t){return t&&this._ser===t._ser&&this._point===t._point||!1},s(n,"Format",{get:function(){var t=this._point;return-1===t?this._ser.Format:t>=0&&t<this._ser.PointsCount?this._ser.Points.Get(t).Format:p}}),s(n,"Parent",{get:function(){return this._legendEntry}}),n.ClearFormats=function(){},n.Delete=function(){},s(n,"Series",{get:function(){return this._ser}}),s(n,"Point",{get:function(){return this._point}}),n.CreateFormat=function(){return new c(this._legendEntry.Parent.Parent,this._legendEntry.Parent.Format)},i}(o);n.LegendKey=_;var d=function(){function t(t,e,i){i===f&&(i=-1);this._deleted=p,this._legendKey=p,this._drawingText=p,this._ooEntry=p,this._legend=t,this._legendKey=new _(this,e,i)}var e=t.prototype;return s(e,"Font",{get:function(){return this._drawingText||(this._drawingText=new h(this._legend.Parent.Parent,this._legend.Font)),this._drawingText.Font}}),s(e,"Format",{get:function(){return this._legendKey.Format}}),s(e,"Parent",{get:function(){return this._legend}}),s(e,"Deleted",{get:function(){return this._deleted||!1}}),s(e,"SourceIndex",{get:function(){return this._legend.LegendEntries.IndexOfSource(this)}}),s(e,"LegendKey",{get:function(){return this._legendKey}}),e.Delete=function(){this._deleted=!0},e.FromOOModel=function(t){if(u(t))return this._deleted=!1,void(this._drawingText=p);if(u(t.delete)||(this._deleted=t.delete),!this.Deleted)if(u(t.txPr))this._drawingText=p;else{this._drawingText=new h(this._legend.Parent.Parent,this._legend.Font);var e={};e.rich=t.txPr,this._drawingText.FromOOModel(e)}},e.ToOOModel=function(){var t=this._ooEntry;return(u(t)&&!u(this._drawingText)&&this._drawingText.Font.IsDirtyIncludingParent(!1)||!u(this._deleted))&&(t={}),u(t)?p:(u(this._deleted)||(t.delete=this._deleted),t.idx=this.SourceIndex,this.Deleted||u(this._drawingText)||(t.txPr=this._drawingText.ToOOModel().rich),t)},t}();n.LegendEntry=d;var g=function(){function t(t){this._entries=[],this._legend=t,this._sers=t.Parent.SeriesCollection}var e=t.prototype;return e.FindEntryByKey=function(t,e){for(var i=0,n=this._entries;i<n.length;i++){var r=n[i],o=r.LegendKey.Series,a=r.LegendKey.Point;if(!u(o)&&-1!==this._sers.IndexOf(o)&&e===a)return r}return p},e.UpdateEntries=function(t){var e=[],i=this._sers,n=this._legend;if(i.Count>0){var r=i.Get(0);if(a.IsAnyPieChart(r.InnerChartType))for(var o=r.PointsCount,s=0;s<o;s++)t?e.push(new d(n,r,s)):e.push(this.GetEntry(r,s));else{s=0;for(var l=i.Count;s<l;s++){var u=i.Get(s);t?e.push(new d(n,u)):e.push(this.GetEntry(u,-1))}}}this._entries=e},e.GetEntry=function(t,e){return this.FindEntryByKey(t,e)||new d(this._legend,t,e)},s(t.prototype,"Count",{get:function(){for(var t=0,e=0,i=this._entries;e<i.length;e++){t+=i[e].Deleted?0:1}return t}}),s(t.prototype,"Parent",{get:function(){return this._legend}}),e.Get=function(t){return this.GetItem(t)},e.GetAllExistingEntries=function(){return this._entries},e.IndexOfSource=function(t){return this._entries.indexOf(t)},e.GetItem=function(t){for(var e=0,i=0,n=this._entries;i<n.length;i++){var r=n[i];if(!r.Deleted&&e===t)return r;r.Deleted||e++}return p},e.RestorEntries=function(t){if(u(t)||0===t.length)this.UpdateEntries(!0);else for(var e=this._entries,i=e.length,n=0,r=t;n<r.length;n++){var o=r[n];if(!u(o.idx)){var a,s=o.idx;s<i&&(a=e[s],u(a)||a.FromOOModel(o))}}},t}();n.LegendEntries=g;var y=function(t){function i(e){t.call(this);return this.DefaultFontSize=l.pointToPixel(9),this._position=2,this._ooModel=p,this._chart=e,this._chartText=new h(e.Parent,e.ChartArea.Font),this._chartText.Font.Size=l.pointToPixel(9),this._entries=new g(this),this.Position=4,this}e(i,t);var n=i.prototype;return s(n,"Font",{get:function(){return this._chartText||(this._chartText=new h(this._chart.Parent,this._chart.ChartArea.Font)),this._chartText.Font}}),s(n,"Format",{get:function(){return this.ChartFormat}}),s(n,"LegendEntries",{get:function(){return this._entries}}),s(n,"Parent",{get:function(){return this._chart}}),s(n,"Position",{get:function(){return this._position},set:function(t){this._position=t,this._ooModel&&0!==t&&(this._ooModel.layout=p)}}),n.Delete=function(){this._chart.HasLegend=!1},n.FromOOModel=function(e){if(this._ooModel=e,u(e.legendPos)||(this._position=e.legendPos),u(e.overlay)||(this.IncludeInLayout=e.overlay),t.prototype.FromShapeProperties.call(this,e.spPr),u(e.txPr))this._chartText=p;else{var i={rich:e.txPr};this._chartText.FromOOModel(i)}this._entries.RestorEntries(e.legendEntry)},n.ToOOModel=function(){var e=this._ooModel||{};if(e.legendPos=this.Position,e.overlay=this.IncludeInLayout,e.spPr=t.prototype.ToShapeProperties.call(this),!u(this._chartText)){var i=this._chartText.ToOOModel();u(i)?e.txPr=p:e.txPr=i.rich}for(var n=[],r=0,o=this._entries.GetAllExistingEntries();r<o.length;r++){var a=o[r].ToOOModel();u(a)||n.push(a)}return n.length>0&&(e.legendEntry=n),e},n.CreateFormat=function(){return new c(this._chart)},i}(o);n.Legend=y,t.exports=n}()},function(t,e,i){"use strict";!function(){var e=i(2)._Types._inherit,n=i(0),r=i(10).ColorSchemeIndex,o=i(1),a=o.ChartElementBase,s=o.ChartUtility,l=s.defineProperty,u=o.UnitHelper.isNullOrUndefined,h=i(5).ChartFormat,c=null,p=function(t){function i(e){t.call(this);return this._ooPlotArea=c,this._chart=e,this._format=this.GetDefaultFormat(),this}e(i,t);var n=i.prototype;return n.GetDefaultFormat=function(){var e=t.prototype.GetDefaultFormat.call(this);return e.Fill.Color.ColorType=0,e.Line.Color.ColorType=0,e},n.CreateFormat=function(){return new h(this._chart)},l(n,"Format",{get:function(){return this.ChartFormat}}),l(n,"Parent",{get:function(){return this._chart}}),l(n,"PrimaryCatAxis",{get:function(){return this._chart.Axes.Item(0,0)}}),l(n,"PrimaryValAxis",{get:function(){return this._chart.Axes.Item(1,0)}}),l(n,"SecondaryCatAxis",{get:function(){return this._chart.Axes.Item(0,1)}}),l(n,"SecondaryValAxis",{get:function(){return this._chart.Axes.Item(1,1)}}),l(n,"SerAxis",{get:function(){return this._chart.Axes.Item(2,0)}}),l(n,"SeriesCollection",{get:function(){return this._chart.SeriesCollection}}),n.FromOOModel=function(t){this._ooPlotArea=t,t.axes||(t.axes=[]),this.FromShapeProperties(t.spPr),this._chart.SeriesCollection.RestoreSeries(t),this._chart.Axes.RestoreAxes(t)},n.ToOOModel=function(){var t=this._chart.ChartType,e=this._ooPlotArea||{},i=this.ToCT_ChartPlotArea(t);return u(i)||(this.SyncPlotAreaCharts(i,e),e.spPr=this.ToShapeProperties()),e},n.ToCT_ChartPlotArea=function(t,e,i){void 0===e&&(e=c),void 0===i&&(i=!0);var n={chartGroups:[],axes:[]},r=u(e)||0===e,o=!0;o=s.IsStockChart(t)?this.HasSecondarySeries(9):(u(e)||1===e)&&this.HasSecondarySeries(t)&&!s.Is3DChart(t)&&!s.IsSurfaceChart(t),s.IsAnyPieChart(t)&&(i=!1);var a=c,l=c;switch(t){case 0:n=this.ToComboChartPlotArea();break;case 12:case 13:case 14:case 18:case 19:case 20:case 15:case 16:case 17:case 6:case 21:case 22:case 23:r&&(a=this.ToCT_BarChart(t,0)),o&&(l=this.ToCT_BarChart(t,1));break;case 9:case 24:case 25:case 26:case 27:case 28:case 5:r&&(a=this.ToCT_LineChart(t,0)),o&&(l=this.ToCT_LineChart(t,1));break;case 10:case 30:case 31:case 4:case 29:case 32:case 3:case 41:r&&(a=this.ToCT_PieChart(t,0)),o&&(l=this.ToCT_PieChart(t,1));break;case 8:case 37:case 38:case 39:case 40:case 7:r&&(a=this.ToCT_AreaChart(t,0)),o&&(l=this.ToCT_AreaChart(t,1));break;case 2:case 42:case 43:r&&(a=this.ToCT_RadarChart(t,0)),o&&(l=this.ToCT_RadarChart(t,1));break;case 1:case 33:case 34:case 35:case 36:r&&(a=this.ToCT_ScatterChart(t,0)),o&&(l=this.ToCT_ScatterChart(t,1));break;case 11:case 48:r&&(a=this.ToCT_BubbleChart(t,0)),o&&(l=this.ToCT_BubbleChart(t,1));break;case 44:case 45:case 46:case 47:r&&(a=this.ToCT_SurfaceChartBase(t,0));break;case 49:case 50:r&&(a=this.ToCT_StockChart(t,0)),o&&(l=this.ToCT_StockChart(t,1));break;case 51:case 52:if(r){var h=this.SeriesCollection.GetSers(!1,0);if(h.length>0){var p=h[0].InnerChartType;a=this.ToCT_ChartBase(p,0)}}o&&(l=this.ToCT_StockChart(t,1))}if(!u(a)&&(n.chartGroups.push(a),i)){var f=this.SetPlotAreaAxies(n,this.PrimaryCatAxis,this.PrimaryValAxis,this.SerAxis);a.axId=a.axId.concat(f)}return u(l)||(n.chartGroups.push(l),i&&(f=this.SetPlotAreaAxies(n,this.SecondaryCatAxis,this.SecondaryValAxis,this.SerAxis),l.axId=l.axId.concat(f))),n},n.ToCT_ChartBase=function(t,e){switch(t){case 12:case 13:case 14:return this.ToCT_BarChart(t,e);case 15:case 16:case 17:case 6:return this.ToCT_BarChart(t,e);case 18:case 19:case 20:return this.ToCT_BarChart(t,e);case 21:case 22:case 23:return this.ToCT_BarChart(t,e);case 9:case 24:case 25:case 26:case 27:case 28:case 5:return this.ToCT_LineChart(t,e);case 10:case 30:return this.ToCT_PieChart(t,e);case 31:case 4:return this.ToCT_PieChart(t,e);case 29:case 32:return this.ToCT_PieChart(t,e);case 1:case 33:case 34:case 35:case 36:return this.ToCT_ScatterChart(t,e);case 8:case 37:case 38:return this.ToCT_AreaChart(t,e);case 39:case 40:case 7:return this.ToCT_AreaChart(t,e);case 3:case 41:return this.ToCT_PieChart(t,e);case 2:case 42:case 43:return this.ToCT_RadarChart(t,e);case 44:case 45:return this.ToCT_SurfaceChartBase(t,e);case 46:case 47:return this.ToCT_SurfaceChartBase(t,e);case 11:case 48:return this.ToCT_BubbleChart(t,e)}},n.SyncPlotAreaCharts=function(t,e){e.axes=t.axes,e.chartGroups=t.chartGroups;var i=c,n=s.GetSurface3DChart(e);u(n)||u(n.bandFmts)||(i=n.bandFmts);var r=c,o=s.GetSurfaceChart(e);u(o)||u(o.bandFmts)||(r=o.bandFmts),u(n)||u(i)||(n.bandFmts=i),u(o)||u(r)||(o.bandFmts=r)},n.ToComboChartPlotArea=function(){var t=this.ConvertAxisGroupToComboChartPlotArea(0),e=this.ConvertAxisGroupToComboChartPlotArea(1);return u(t)||u(e)?u(t)?u(e)?null:e:t:this.MergePrimeSecondPlotArea(t,e)},n.ConvertAxisGroupToComboChartPlotArea=function(t){for(var e=[],i=0,n=this.SeriesCollection.GetSers(!1,t);i<n.length;i++){var r=n[i];e.indexOf(r.InnerChartType)<0&&e.push(r.InnerChartType)}for(var o=[],a=c,l=0,h=e;l<h.length;l++){var p=h[l];u(a)&&!s.IsAnyPieChart(p)?(a=this.ToCT_ChartPlotArea(p,t),o.push(a)):o.push(this.ToCT_ChartPlotArea(p,t,!1))}return o.length>0?this.ProcessComboPlotAreas(o):null},n.ProcessComboPlotAreas=function(t){for(var e=c,i=0,n=t;i<n.length;i++){var r=n[i],o=s.GetChartType(r);if(!s.IsAnyPieChart(o)){e=r;break}}if(u(e)&&t.length>0?(e=t[0],t.splice(0,1)):t.splice(t.indexOf(e),1),!u(e)&&t.length>0){var a=[];if(!u(e.axes))for(var l=0,h=e.axes;l<h.length;l++){var p=h[l];a.push(p.axId)}for(var f=0;f<t.length;f++){var _=t[f],d=s.GetArea3DChart(_);!u(d)&&u(d)&&(d.axId=a,e.chartGroups.push(d));var g=s.GetAreaChart(_);if(!u(g))for(var y=0,m=g;y<m.length;y++){var v=m[y];v.axId=a;var b=s.GetAreaChart(e);if(0===b.length||s.GetChartTypeByAreaChart(b[0])!==s.GetChartTypeByAreaChart(v))e.chartGroups.push(v);else for(var S=0,C=v.ser;S<C.length;S++){var x=C[S];b[0].ser.push(x)}}var T=s.GetBar3DChart(_),w=s.GetBar3DChart(e);!u(T)&&u(w)&&(T.axId=a,e.chartGroups.push(d));var P=s.GetBarChart(_);if(!u(P))for(var A=0,F=P;A<F.length;A++){var O=F[A];O.axId=a;var M=s.GetBarChart(e);if(0===M.length||s.GetChartTypeByBarChart(M[0])!==s.GetChartTypeByBarChart(O))e.chartGroups.push(O);else for(var D=0,L=O.ser;D<L.length;D++)x=L[D],M[0].ser.push(x)}var I=s.GetBubbleChart(_);if(!u(I))for(var k=0,R=I;k<R.length;k++){var N=R[k];N.axId=a;var E=s.GetBubbleChart(e);if(0===E.length||s.GetChartTypeByBubbleChart(E[0])!==s.GetChartTypeByBubbleChart(N))e.chartGroups.push(N);else for(var G=0,V=N.ser;G<V.length;G++)x=V[G],E[0].ser.push(x)}var j=s.GetDoughnutChart(_);if(!u(j))for(var B=0,U=j;B<U.length;B++){var z=U[B],H=s.GetDoughnutChart(e);if(0===H.length||s.GetChartTypeByPieChart(H[0],null)!==s.GetChartTypeByPieChart(z,null))e.chartGroups.push(z);else for(var W=0,X=z.ser;W<X.length;W++)x=X[W],H[0].ser.push(x)}var Y=s.GetLine3DChart(_),q=s.GetLine3DChart(e);!u(Y)&&u(q)&&(Y.axId=a,e.chartGroups.push(Y));var K=s.GetLineChart(_);if(!u(K))for(var Q=0,Z=K;Q<Z.length;Q++){var J=Z[Q];J.axId=a;var $=s.GetLineChart(e);if(0===$.length||s.GetChartTypeByLineChart($[0],null)!==s.GetChartTypeByLineChart(J,null))e.chartGroups.push(J);else for(var tt=0,et=J.ser;tt<et.length;tt++)x=et[tt],$[0].ser.push(x)}var it=s.GetOfPieChart(_);if(!u(it))for(var nt=0,rt=it;nt<rt.length;nt++){var ot=rt[nt],at=s.GetOfPieChart(e);if(0===at.length||s.GetChartTypeByPieChart(at[0],null)!==s.GetChartTypeByPieChart(ot,null))e.chartGroups.push(ot);else for(var st=0,lt=ot.ser;st<lt.length;st++)x=lt[st],at[0].ser.push(x)}var ut=s.GetPie3DChart(_),ht=s.GetPie3DChart(e);!u(ut)&&u(ht)&&e.chartGroups.push(ut);var ct=s.GetPieChart(_);if(!u(ct))for(var pt=0,ft=ct;pt<ft.length;pt++){var _t=ft[pt],dt=s.GetPieChart(e);if(0===dt.length||s.GetChartTypeByPieChart(dt[0],null)!==s.GetChartTypeByPieChart(_t,null))e.chartGroups.push(_t);else for(var gt=0,yt=_t.ser;gt<yt.length;gt++)x=yt[gt],dt[0].ser.push(x)}var mt=s.GetRadarChart(_);if(!u(mt))for(var vt=0,bt=mt;vt<bt.length;vt++){var St=bt[vt];St.axId=a;var Ct=s.GetRadarChart(e);if(0===Ct.length||s.GetChartTypeByRadarChart(Ct[0],null)!==s.GetChartTypeByRadarChart(St,null))e.chartGroups.push(St);else for(var xt=0,Tt=St.ser;xt<Tt.length;xt++)x=Tt[xt],Ct[0].ser.push(x)}var wt=s.GetScatterChart(_);if(!u(wt))for(var Pt=0,At=wt;Pt<At.length;Pt++){var Ft=At[Pt];Ft.axId=a;var Ot=s.GetScatterChart(e);if(0===Ot.length||s.GetChartTypeByScatterChart(Ot[0])!==s.GetChartTypeByScatterChart(Ft))e.chartGroups.push(Ft);else for(var Mt=0,Dt=Ft.ser;Mt<Dt.length;Mt++)x=Dt[Mt],Ot[0].ser.push(x)}}}return e},n.MergePrimeSecondPlotArea=function(t,e){u(e.axes)||(t.axes=t.axes.concat(e.axes));var i=s.GetArea3DChart(e),n=s.GetArea3DChart(t);!u(i)&&u(n)&&t.chartGroups.push(i);var r=s.GetAreaChart(e);t.chartGroups=t.chartGroups.concat(r);var o=s.GetBar3DChart(e),a=s.GetBar3DChart(t);!u(o)&&u(a)&&t.chartGroups.push(o);var l=s.GetBarChart(e);t.chartGroups=t.chartGroups.concat(l);var h=s.GetBubbleChart(e);t.chartGroups=t.chartGroups.concat(h);var c=s.GetDoughnutChart(e);t.chartGroups=t.chartGroups.concat(c);var p=s.GetLine3DChart(t),f=s.GetLine3DChart(e);!u(f)&&u(p)&&t.chartGroups.push(f);var _=s.GetLineChart(e);t.chartGroups=t.chartGroups.concat(_);var d=s.GetOfPieChart(e);t.chartGroups=t.chartGroups.concat(d);var g=s.GetPie3DChart(t),y=s.GetPie3DChart(e);!u(y)&&u(g)&&t.chartGroups.push(y);var m=s.GetPieChart(e);t.chartGroups=t.chartGroups.concat(m);var v=s.GetRadarChart(e);t.chartGroups=t.chartGroups.concat(v);var b=s.GetScatterChart(e);return t.chartGroups=t.chartGroups.concat(b),t},n.SetPlotAreaAxies=function(t,e,i,n){void 0===n&&(n=c);var r,o=c,a=c,l=[];return u(e)||(o=e.ToOOModel(),u(o)||(l.push(o.axId),t.axes.push(o))),u(i)||u(e)||(a=i.ToOOModel(),l.push(a.axId),t.axes.push(a),0===i.Crosses?o.crossesAt=i.CrossesAt:o.crosses=i.Crosses,0===e.Crosses?a.crossesAt=e.CrossesAt:a.crosses=e.Crosses,e.ReversePlotOrder&&(s.IsBarChart(this._chart.ChartType)?a.axPos=0:a.axPos=2),a.crossBetween=e.AxisBetweenCategories?0:1),u(o)||u(a)||(o.crossAx=a.axId,a.crossAx=o.axId),u(n)?s.Is3DChart(this._chart.ChartType)&&l.push(0):(r=n.ToOOModel(),t.axes.push(r),l.push(r.axId),u(a)||(r.crossAx=a.axId),r.crosses=1),l},n.ToCT_BarChart=function(t,e){if(s.Is3DChart(t)){var i=this.ToCT_BarChartBase(t,e);return u(i)||(i.gapDepth=this._chart.GapDepth),i}var n=this.ToCT_BarChartBase(t,e);if(!u(n)){var r=this._chart.FindChartGroup(t,e);u(r)||(n.overlap=r.Overlap,r.HasSeriesLines&&(n.serLines=[],n.serLines.push(r.SeriesLines.ToOOModel())))}return n},n.ToCT_BarChartBase=function(t,e){var i,n=s.IsBarChart(t);(i=s.Is3DChart(t)?{chartType:7,ser:[],axId:[]}:{chartType:6,ser:[],serLines:[],axId:[]}).barDir=n?0:1;for(var r=0,o=this.SeriesCollection.GetSers(!1,e);r<o.length;r++){var a=o[r];if(a.InnerChartType===t){var l=a.ToOOModel();u(l)||i.ser.push(l)}}switch(t){case 19:case 13:case 16:case 22:i.grouping=3;break;case 20:case 14:case 17:case 23:i.grouping=0;break;case 6:i.grouping=2;break;case 18:case 12:case 21:case 15:default:i.grouping=1}var h=this._chart.FindChartGroup(t,e);return u(h)||(i.gapWidth=h.GapWidth,i.varyColors=h.VaryByCategories),i},n.ToCT_LineChart=function(t,e){if(s.Is3DChart(t)){var i=this.ToCT_LineChartBase(t,e);return u(i)||(i.gapDepth=this._chart.GapDepth),i}var n=this.ToCT_LineChartBase(t,e);if(!u(n)){n.smooth=s.IsSmoothLine(t);var r=this._chart.FindChartGroup(t,e);u(r)||(r.HasHiLoLines&&(n.hiLowLines=r.HiLoLines.ToOOModel()),r.HasUpDownBars&&(n.upDownBars=this.ToCT_UpDownBars(r)),n.marker=r.Marker)}return n},n.ToCT_LineChartBase=function(t,e){var i;i=s.Is3DChart(t)?{chartType:9,ser:[],axId:[]}:{chartType:8,ser:[],axId:[]};for(var n=0,r=this.SeriesCollection.GetSers(!1,e);n<r.length;n++){var o=r[n];if(o.InnerChartType===t){var a=o.ToOOModel();u(a)||i.ser.push(a)}}switch(t){case 27:case 24:i.grouping=2;break;case 28:case 25:i.grouping=0;break;default:i.grouping=1}var l=this._chart.FindChartGroup(t,e);return u(l)||(i.varyColors=l.VaryByCategories,l.HasDropLines&&(i.dropLines=l.DropLines.ToOOModel())),i},n.ToCT_PieChart=function(t,e){var i=this._chart.FindChartGroup(t,e);if(s.Is3DChart(t))return this.ToCT_PieChartBase(t,e);if(s.IsOfPieChart(t)){var n=this.ToCT_PieChartBase(t,e);if(!u(n)&&(n.ofPieType=32===t?1:0,!u(i)))if(i.HasSeriesLines&&n.serLines.push(i.SeriesLines.ToOOModel()),n.secondPieSize=i.SecondPlotSize,n.gapWidth=i.GapWidth,n.splitType=i.SplitType,3===i.SplitType){n.custSplit={secondPiePt:[]};var r=i.SeriesCollection[0];if(r){var o=r.Points.GetPoints();for(var a in o){var l=o[a];l.SecondaryPlot&&n.custSplit.secondPiePt.push(l.Index)}}}else n.splitPos=i.SplitValue;return n}if(s.IsDoughnutChart(t)){var h=this.ToCT_PieChartBase(t,e);return u(h)||u(i)||(h.holeSize=i.DoughnutHoleSize),h}return this.ToCT_PieChartBase(t,e)},n.ToCT_PieChartBase=function(t,e){var i;(i=s.Is3DChart(t)?{chartType:11,ser:[],axId:[]}:s.IsOfPieChart(t)?{chartType:13,ser:[],serLines:[],axId:[]}:s.IsDoughnutChart(t)?{chartType:12,ser:[],axId:[]}:{chartType:10,ser:[],axId:[]}).varyColors=!0;for(var n=0,r=this.SeriesCollection.GetSers(!1,e);n<r.length;n++){var o=r[n];if(o.InnerChartType===t){var a=o.ToOOModel();u(a)||i.ser.push(a)}}var l=this._chart.FindChartGroup(t,e);return u(l)||(i.varyColors=l.VaryByCategories,i.firstSliceAng=l.FirstSliceAngle),i},n.ToCT_AreaChart=function(t,e){if(s.Is3DChart(t)){var i=this.ToCT_AreaChartBase(t,e);return u(i)||(i.gapDepth=this._chart.GapDepth),i}return this.ToCT_AreaChartBase(t,e)},n.ToCT_AreaChartBase=function(t,e){var i;(i=s.Is3DChart(t)?{chartType:5,ser:[],axId:[]}:{chartType:4,ser:[],axId:[]}).varyColors=!1;for(var n=0,r=this.SeriesCollection.GetSers(!1,e);n<r.length;n++){var o=r[n];if(o.InnerChartType===t){var a=o.ToOOModel();u(a)||i.ser.push(a)}}switch(t){case 39:case 37:i.grouping=2;break;case 40:case 38:i.grouping=0;break;default:i.grouping=1}var l=this._chart.FindChartGroup(t,e);return u(l)||(i.varyColors=l.VaryByCategories,l.HasDropLines&&(i.dropLines=l.DropLines.ToOOModel())),i},n.ToCT_RadarChart=function(t,e){for(var i={chartType:2,ser:[],axId:[]},n=0,r=this.SeriesCollection.GetSers(!1,e);n<r.length;n++){var o=r[n];if(o.InnerChartType===t){var a=o.ToOOModel();u(a)||i.ser.push(a)}}2===t?i.radarStyle=1:43===t?i.radarStyle=2:42===t&&(i.radarStyle=1);var s=this._chart.FindChartGroup(t,e);return u(s)||(i.varyColors=s.VaryByCategories),i},n.ToCT_ScatterChart=function(t,e){var i={chartType:1,ser:[],axId:[]};switch(t){case 1:case 35:i.scatterStyle=2;break;case 36:i.scatterStyle=1;break;case 33:i.scatterStyle=5;break;case 34:i.scatterStyle=4;break;default:i.scatterStyle=2}for(var n=0,r=this.SeriesCollection.GetSers(!1,e);n<r.length;n++){var o=r[n];if(o.InnerChartType===t){var a=o.ToOOModel();u(a)||i.ser.push(a)}}var s=this._chart.FindChartGroup(t,e);return u(s)||(i.varyColors=s.VaryByCategories),i},n.ToCT_BubbleChart=function(t,e){for(var i={chartType:3,ser:[],axId:[]},n=0,r=this.SeriesCollection.GetSers(!1,e);n<r.length;n++){var o=r[n];if(o.InnerChartType===t){var a=o.ToOOModel();u(a)||i.ser.push(a)}}var s=this._chart.FindChartGroup(t,e);return u(s)||(i.varyColors=s.VaryByCategories,i.bubbleScale=s.BubbleScale,i.showNegBubbles=s.ShowNegativeBubbles,i.sizeRepresents=s.SizeRepresents),i},n.ToCT_StockChart=function(t,e){for(var i={chartType:0,ser:[],axId:[]},n=0,r=this.SeriesCollection.GetSers(!1,e);n<r.length;n++){var o=r[n];if(9===o.InnerChartType){var a=o.ToOOModel();u(a)||i.ser.push(a)}}var s=this._chart.FindChartGroup(t,e);return u(s)||(s.HasHiLoLines&&(i.hiLowLines=s.HiLoLines.ToOOModel()),s.HasDropLines&&(i.dropLines=s.DropLines.ToOOModel()),s.HasUpDownBars&&(i.upDownBars=this.ToCT_UpDownBars(s))),i},n.ToCT_UpDownBars=function(t){var e={};return e.upBars=t.UpBars.ToOOModel(),e.downBars=t.DownBars.ToOOModel(),e.gapWidth=t.GapWidth,e},n.ToCT_SurfaceChartBase=function(t,e){var i;i=s.IsSurface3DChart(t)?{chartType:15,ser:[],axId:[]}:{chartType:14,ser:[],axId:[]};for(var n=0,r=this.SeriesCollection.GetSers(!1,e);n<r.length;n++){var o=r[n];if(o.InnerChartType===t){var a=o.ToOOModel();u(a)||i.ser.push(a)}}var l=47===t||45===t;return i.wireframe=l,i.bandFmts={bandFmt:this.GenerateBands(l)},i},n.GenerateBands=function(t){for(var e,i=[],n=0;n<6;n++){var o={};o.idx=n,o.spPr={};var a={};(e=a.schemeClr={}).val=r["Accent"+(n%12+1)],t?o.spPr.ln={solidFill:a,cap:0,w:1}:o.spPr.solidFill=a,i.push(o)}for(n=6;n<12;n++)(o={}).idx=n,o.spPr={},o.spPr.solidFill={},(e=o.spPr.solidFill.schemeClr={}).val=r["Accent"+(n%12+1)],e.lumMod=[6e4],i.push(o);for(n=12;n<15;n++)(o={}).idx=n,o.spPr={},o.spPr.solidFill={},(e=o.spPr.solidFill.schemeClr={}).val=r["Accent"+(n%12+1)],e.lumMod=[8e4],e.lumOff=[2e4],i.push(o);return i},n.HasSecondarySeries=function(t){return this._chart.SeriesCollection.AllSers.some(function(e){return 1===e.AxisGroup&&e.InnerChartType===t})},i}(a);n.PlotArea=p,t.exports=n}()},function(t,e,i){"use strict";!function(){var e=i(0),n=i(3),r=i(37),o=n.CalcEngine.parseSeriesFormula,a=i(16),s=i(38),l=i(1),u=l.DateTimeExtension,h=i(15).AxisTitle,c=i(27).ChartModel,p=i(18).ChartHelper,f=i(12).ARGBColor,_=n.GC$,d=p.getChartModelData,g=p.colorFormatToString,y=r._createRange,m=n.CalcEngine.formulaToRanges,v=l.Reference,b=l.UnitHelper.isNullOrUndefined,S=l.ChartUtility,C=null,x=void 0;function T(t,e,i){b(e.width)||(t.Weight=e.width),e.color&&t.Color.setColor(i,e.color)}function w(t,e,i,n,r,o){if(e){if(t||(t=n.Add(r,o)),0===r){var a=e.categoryType;3===t.ActualCategoryType||!t.IsValueOrDateScaleAxis()&&!function(t,e){var i=t.SeriesCollection.GetValidSers(e)[0];if(i)return S.TryAllToNumbers(i._xValues,[],!0);return!1}(t,o)||2!==a&&1!==a||(t.ActualCategoryType=a)}b(e.visible)||(t.Visible=!!e.visible),b(e.tickLabelPosition)||(t.TickLabelPosition=e.tickLabelPosition);var s=t.Format.Line,l=e.lineStyle;l&&(b(l.width)||(s.Weight=l.width),l.color&&s.Color.setColor(i,l.color));var c=t.TickLabels.Font,f=e.style;if(f&&(f.color&&c.Color.setColor(i,f.color),f.fontFamily&&(c.Name=f.fontFamily),b(f.fontSize)||(c.Size=f.fontSize)),b(e.majorTickPosition)||(t.MajorTickMark=e.majorTickPosition),b(e.minorTickPosition)||(t.MinorTickMark=e.minorTickPosition),b(e.majorUnit)?t.MajorUnitIsAuto=!0:t.MajorUnit=e.majorUnit,b(e.minorUnit)?t.MinorUnitIsAuto=!0:t.MinorUnit=e.minorUnit,t.IsValueOrDateScaleAxis()&&!p.isPercentageScaleType(t.Chart,t.AxisGroup)){var _=e.min,d=e.max,g=t.IsTimeScale();b(_)?t.MinimumScaleIsAuto=!0:(g&&(_=u.ToOADate(_)),t.MinimumScale=_),b(d)?t.MaximumScaleIsAuto=!0:(g&&(d=u.ToOADate(d)),t.MaximumScale=d)}e.format&&(t.TickLabels.NumberFormat=e.format);var y=e.title;if(y){var m=t.AxisTitle;m||(m=t.AxisTitle=new h(t._axes.Parent,t._axisGroup,t._type));var v=y.text;b(v)||(m.Text=v,t.HasTitle=v.length>0);var C=m.Font;y.fontFamily&&(C.Name=y.fontFamily),b(y.fontSize)||(C.Size=y.fontSize),y.color&&C.Color.setColor(i,y.color)}var x=e.majorGridLine;x&&(b(x.visible)||(t.HasMajorGridlines=x.visible),T(t._getMajorGridlines(!0).Format.Line,x,i));var w=e.minorGridLine;w&&(b(w.visible)||(t.HasMinorGridlines=w.visible),T(t._getMinorGridlines(!0).Format.Line,w,i))}}function P(t,e){var i=t._formulaTextBoxForChart,n=i.series,r=i.chartView,o=r.getDataOrientation();if(n){var a=m(t,i.text(),t._activeRowIndex,t._activeColIndex);if(a[0]){var s=a[0].ranges;2!==s.length||n.NameRefer||(s[2]=s[1],s[1]=null);var u=s[0],h=new l.Reference(t._name,u.row,u.col,u.row+u.rowCount-1,u.col+u.colCount-1);if(n.SetValuesRefers([h]),(u=s[1])&&(h=new l.Reference(t._name,u.row,u.col,u.row+u.rowCount-1,u.col+u.colCount-1),n.SetNameRefer(h)),u=s[2]){h=new l.Reference(t._name,u.row,u.col,u.row+u.rowCount-1,u.col+u.colCount-1);var c=i.chartView.series().AllSers,p=n.GetXValuesFormula();c.forEach(function(t){t&&t.GetXValuesFormula()===p&&t.SetXValuesRefers([h])})}(u=s[3])&&(h=new l.Reference(t._name,u.row,u.col,u.row+u.rowCount-1,u.col+u.colCount-1),n.SetBubbleSizesRefers([h])),t._updateRegisteredFormula(i.chartView),i.chartView._updateChartModel(!0)}}else if(e){var f=r._getAlinedChartRanges(),_=e.fromRange,d=e.toRange;_.equals(f.valuesRange)?(o&&f.nameRange?(f.nameRange.col=d.col,f.nameRange.colCount=d.colCount):!o&&f.nameRange&&(f.nameRange.row=d.row,f.nameRange.rowCount=d.rowCount),o&&f.xValuesRange?(f.xValuesRange.row=d.row,f.xValuesRange.rowCount=d.rowCount):!o&&f.xValuesRange&&(f.xValuesRange.col=d.col,f.xValuesRange.colCount=d.colCount),f.valuesRange=d):f.valuesRange&&_.equals(f.nameRange)?(o?(f.valuesRange.col=d.col,f.valuesRange.colCount=d.colCount):o||(f.valuesRange.row=d.row,f.valuesRange.rowCount=d.rowCount),f.nameRange=d):f.valuesRange&&_.equals(f.xValuesRange)&&(o?(f.valuesRange.row=d.row,f.valuesRange.rowCount=d.rowCount):o||(f.valuesRange.col=d.col,f.valuesRange.colCount=d.colCount),f.xValuesRange=d),r._setDataRange("");var g=r.series(),y=g.GenerateSeriesStructures3(t,o,f.nameRange,f.xValuesRange,f.valuesRange);g.AddSers(y),t._updateRegisteredFormula(r),r._updateChartModel(!0)}}function A(t){for(var e=[[8,0],[0,0],[4,1],[1,4],[2,3],[3,3],[7,5],[6,5],[5,0],[9,7],[10,8]],i=0;i<e.length;i++){var n=e[i];if(t.indexOf(n[0])>=0)return n[1]}return 8}function F(t,e){var i=A(e.elementType);return{chart:t,elementType:i,options:function(t,e,i){var n={};switch(t){case 0:n=function(t,e){var i=e.model.items[0],n=t._getSelectedSeries(i,e.field);return n?{index:n.Index}:{}}(e,i);break;case 1:n=function(t,e){var i=e.element;return i?{axisType:1===i.axisType?"y":"x"}:{}}(0,i);break;case 3:n=function(t,e){var i=t.series().AllSers.map(function(t){return t.Name}),n=e.model;return n?{index:i.indexOf(n)}:{}}(e,i)}for(var r=e.series().AllSers,o=[],a=0;a<r.length;a++)o.push(r[a].Name||O(r[a]));return{category:o,info:n}}(i,t,e)}}function O(t){if(!t.Name)return t.SeriesCollection.IndexOfSource(t)+1}function M(t,e){if(e){var i=m(t,e,0,0)[0];if(i){var n=t.parent.getSheetFromName(i.sheetName);if(n)return{sheet:n,range:i.ranges&&i.ranges[0],ranges:i.ranges}}}return{range:{},ranges:[]}}e.ElementType={series:0,axis:1,legend:3,label:4,chartTitle:5,plotArea:7,chartArea:8};var D=function(t){function e(e,i,n,r,o,a,s,l,u,h,p){var f=i||function(t,e){var i,n=1;if(!t)return e+n;do{i=e+n++}while(t.charts.get(i));return i}(e,"Chart ");t.call(this,f,r,o,a,s),this.typeName="2",this._kind="2",this.sheet(e),this._chart=new c(this,n),this._flexDVs=[],l&&this._setDataRange(l,u,null,h,p),this._initDom()}_.inherit(e,t);var r=e.prototype;function a(t,e,i,n){var r=e.GetBubbleSizesFormula(),o=r&&M(t,r),a=o&&o.range;return!!a&&(n?a.row===i.row+i.rowCount:a.col===i.col+i.colCount)}function l(t,e){for(var i=e.row,n=e.col,r=e.rowCount,o=e.colCount,a=i,s=i+r;a<s;a++)for(var l=n,u=n+o;l<u;l++){for(var h=!1,c=0,p=t.length;c<p;c++)t[c].contains(a,l,1,1)&&(h=!0);if(!h)return!1}return!0}function u(t){var e=t._chart.SeriesCollection,i=e._dataOrientation;if(b(i)){var n=t.sheet(),r=e.get(0)||e._series&&e._series[0];if(r){var o=M(n,r.yValues).range;i=1===o.rowCount?o.colCount>1?0:function(t,e,i,n){var r,o,a=[i.xVlues,i.name];e.Count>1&&a.push(e.get(1).yValues);for(var s=0,l=a.length;s<l;s++){var u=1===s;if((r=a[s])&&r.match(/^('?(.+?)'?!)?([\w\$]+)(:?)([\w\$]+)?/)){if(o=M(t,r).range,n.row===o.row)return u?0:1;if(n.col===o.col)return u?1:0}}return 0}(n,e,r,o):1}}return i}return r.chartType=function(t){var e=this._chart;if(0===arguments.length)return e.ChartType;var i=S.IsScatterChart(t)&&this._getDataRange();return i?(e._chartType=t,this.dataRange(i)):e.ChartType=t,this._updateChartModel(),this},r.title=function(t){var e=this._chart;if(0===arguments.length)return p.getChartTitleProperties(e.ChartTitle,!0,x,1);if(t){if(""===t.text)e.HasTitle=!1;else{e.HasTitle=!0;var i=e.ChartTitle,n=i.Font;t.text&&(i.Text=t.text),t.fontFamily&&(n.Name=t.fontFamily),t.fontSize&&(n.Size=t.fontSize),t.color&&n.Color.setColor(this.sheet(),t.color)}this._updateChartModel()}return this},r.legend=function(t){var e=this._chart,i=S.IsStockChart(e.ChartType);return 0===arguments.length?i?x:{visible:e.HasLegend,position:e.Legend?e.Legend.Position:2}:(i||(b(t.visible)||(e.HasLegend=t.visible),!b(t.position)&&e.Legend&&(e.Legend.Position=t.position),this._updateChartModel()),this)},r.chartArea=function(t){var e,i,n,r=this._chart.ChartArea;if(0===arguments.length){var o=p.getChartAreaStyle(r,!0,1),a=o.textStyle,s={};return(e=o.style.backgroundColor)&&(s.backColor=e),(i=a.color)&&(s.color=i,s.fontFamily=a.fontFamily),n=parseFloat(a.fontSize),isNaN(n)||(s.fontSize=n),s}if(t){var l=r.GetFormatInternal();(e=t.backColor)&&l&&l.Fill.Color.setColor(this.sheet(),e);var u=r.Font;if(u){(i=t.color)&&r.setFontColor(this.sheet(),i);var h=t.fontFamily;h&&(u.Name=h),n=parseFloat(t.fontSize),isNaN(n)||(u.Size=n)}this._updateChartModel()}return this},r.dataLabels=function(t){var e=this._chart,i=S.IsStockChart(e.ChartType);if(0===arguments.length){if(i)return x;var n,r=e.SeriesCollection.AllSers[0],o=r&&r.GetDataLabels();if(o){n={showValue:o.ShowValue,showSeriesName:o.ShowSeriesName,showCategoryName:o.ShowCategoryName,showPercentage:o.ShowPercentage,position:o.Position,format:o.NumberFormat};var a=g(o.Font,!0);a&&(n.color=a)}else n={showValue:!1,showSeriesName:!1,showCategoryName:!1,showPercentage:!1};return r&&!S.IsPieOrDoughnutChart(r.InnerChartType)&&delete n.showPercentage,n}return t&&!i&&(!function(t,e,i){if(t&&e){var n=e.showValue,r=e.showSeriesName,o=e.showCategoryName,a=e.showPercentage,s=e.position,l=e.format,u=e.color;t.SeriesCollection.AllSers.forEach(function(t){var e=t.DataLabels;if(e){n!==x&&(e.ShowValue=n),r!==x&&(e.ShowSeriesName=r),o!==x&&(e.ShowCategoryName=o),a!==x&&(e.ShowPercentage=a);var h=e.ShowValue||e.ShowSeriesName||e.ShowCategoryName||e.ShowPercentage;!t.HasDataLabels&&h?t.HasDataLabels=!0:t.HasDataLabels&&!h&&(t.HasDataLabels=!1),b(s)||(e.Position=s),l&&(e.NumberFormat=l),u&&e.Font.Color.setColor(i,u),t._removeJSONCache()}})}}(e,t,this.sheet()),this._updateChartModel()),this},r.axes=function(t){var e=this._chart.Axes,i=e.Item(0,0),n=e.Item(1,0),r=e.Item(0,1),o=e.Item(1,1);if(0===arguments.length){var a={};return i&&(a.primaryCategory=p.getAxisProperties(i)),n&&(a.primaryValue=p.getAxisProperties(n)),r&&(a.secondaryCategory=p.getAxisProperties(r)),o&&(a.secondaryValue=p.getAxisProperties(o)),a}var s=this.sheet();return w(i,t.primaryCategory,s,e,0,0),w(n,t.primaryValue,s,e,1,0),w(r,t.secondaryCategory,s,e,0,1),w(o,t.secondaryValue,s,e,1,1),this._updateChartModel(),this},r.series=function(){return this._chart.SeriesCollection},r.dataRange=function(t,e,i){return 0===arguments.length?this._getDataRange():(t&&(this._dataRange=t,this._setDataRange(t,this.getDataOrientation(),null,e,i)),this)},r.dataRangeForDisplay=function(){return this._getDataRange2()},r._getDataRange=function(){var t=this._chart.SeriesCollection.AllSers,e=t.length,i=0===u(this);if(e>0){var n,r,s,l=this.sheet(),h=t[0],c=h.GetXValuesFormula(),p=h.GetValuesFormula(),f=[],_=M(l,p),d=_.sheet,g=_.range,m=g.rowCount,b=g.colCount,S=g.row,C=g.col,x=y(S,C,m,b),T=!!c,w=0,P=0,A=[];if(f.push(h.GetNameFormula()),!d)return;if(a(l,h,x,i)?(P++,i?x.rowCount++:x.colCount++,A.push(1)):A.push(0),"string"==typeof p&&o(p).length>1)return;for(r=1;r<e;r++){if(h=t[r],T&&c!==h.GetXValuesFormula())return;if(p=h.GetValuesFormula()){if("string"==typeof p&&o(p).length>1)return;if(n=(s=M(l,p)).range,s.sheet!==d||n.rowCount!==m||n.colCount!==b)return;if(i){if(n.row!==S+r+w+P)return;x.rowCount+=1}else{if(n.col!==C+r+w+P)return;x.colCount+=1}f.push(h.GetNameFormula()),a(l,h,x,i)?(P++,i?x.rowCount++:x.colCount++,A.push(1)):A.push(0)}else w--}T&&(n=(s=M(l,c)).range,s.sheet===d&&(i?n.row===S-1&&n.col===C&&n.colCount===b&&(x.row--,x.rowCount++):n.col===C-1&&n.row===S&&n.rowCount===m&&(x.col--,x.colCount++))),function(t,e,i,n,r,o,a){for(var s=t.length,l=0,u=0;u<s;u++){var h=t[u];if(!h)return!1;var c=M(i,h),p=c.range;if(c.sheet!==a)return!1;if(l+=0===u?0:e[u-1]||0,1!==p.rowCount||1!==p.colCount)return!1;if(o){if(p.row!==n+u+l||p.col!==r-1)return!1}else if(p.col!==r+u+l||p.row!==n-1)return!1}return!0}(f,A,l,S,C,i,d)&&(i?(x.col--,x.colCount++):(x.row--,x.rowCount++));var F=new v(d.name(),x.row,x.col,x.row+x.rowCount-1,x.col+x.colCount-1);return 1===l.parent.options.referenceStyle?F.ToR1C1Text():F.ToA1Text(0,0)}},r._getDataRange2=function(){var t=this._chart.SeriesCollection.AllSers,e=t.length,i=0===u(this);if(e>0){var n,r,o,s=this.sheet(),h=t[0],c=h.GetXValuesFormula(),p=h.GetValuesFormula(),f=[],_=M(s,c),d=_.range,g=_.ranges,m=M(s,p),b=m.sheet,S=m.range,C=S.rowCount,x=S.colCount,T=S.row,w=S.col,P=y(T,w,C,x),A=!!c,F=[],O=[];if(f.push(h.GetNameFormula()),!b)return;for(a(s,h,P,i)?(0,i?P.rowCount++:P.colCount++,F.push(1)):F.push(0),r=1;r<e;r++){if(h=t[r],A&&c!==h.GetXValuesFormula())return;if(p=h.GetValuesFormula()){if(n=(o=M(s,p)).range,o.sheet!==b||n.rowCount!==C||n.colCount!==x)return;if(i){if(n.col!==w||n.colCount!==x)return;if(n.row!==P.row+P.rowCount){var D=f.map(function(t){return t?M(s,t).range:null}),L=D.reduce(function(t,e){return t?t.union(e):null});if(L&&!l(D,L))return;var I=y(P.row,P.col,P.rowCount,P.colCount);f=[],A&&!O.length&&(d.row+d.rowCount===I.row?I=I.union(d):O.push(d)),L?L.col+L.colCount===I.col?O.push(I.union(L)):(O.push(L),O.push(I)):O.push(I),P.row=n.row,P.rowCount=1}else P.rowCount+=1}else{if(n.row!==T||n.rowCount!==C)return;if(n.col!==P.col+P.colCount){var k=f.map(function(t){return t?M(s,t).range:null}),R=k.reduce(function(t,e){return t?t.union(e):null});if(R&&!l(k,R))return;var N=y(P.row,P.col,P.rowCount,P.colCount);f=[],A&&!O.length&&(d.col+d.colCount===N.col?N=N.union(d):O.push(d)),R?R.row+R.rowCount===N.row?O.push(N.union(R)):(O.push(R),O.push(N)):O.push(N),P.col=n.col,P.colCount=1}else P.colCount+=1}f.push(h.GetNameFormula()),a(s,h,P,i)?(0,i?P.rowCount++:P.colCount++,F.push(1)):F.push(0)}else 0}if(r--,1===e||r===e-1){var E=f.map(function(t){return t?M(s,t).range:null}),G=E.reduce(function(t,e){return t?t.union(e):null});if(G&&!l(E,G))return;f=[],i?(A&&!O.length&&(d.row+d.rowCount===P.row?P=P.union(d):O.push(d)),G?G.col+G.colCount===P.col?O.push(P.union(G)):(O.push(G),O.push(P)):O.push(P)):(A&&!O.length&&(d.col+d.colCount===P.col?P=P.union(d):O.push(d)),G?G.row+G.rowCount===P.row?O.push(P.union(G)):(O.push(G),O.push(P)):O.push(P))}var V=m.ranges.length;if(V>1)for(var j=1;j<V;j++){d=g[j];for(var B=[],U=0;U<e;U++){p=(h=t[U]).GetValuesFormula();var z=M(s,p).ranges;if(!z||!z[j])return;B.push(z[j])}P=B[0],i?d.row+d.rowCount===B[0].row?P=P.union(d):O.push(d):d.col+d.colCount===B[0].col?P=P.union(d):O.push(d);for(var H=1;H<B.length;H++)i?B[H].row!==P.row+P.rowCount?(O.push(P),P=B[H]):P=P.union(B[H]):B[H].col!==P.col+P.colCount?(O.push(P),P=B[H]):P=P.union(B[H]);O.push(P)}var W=[];return O.forEach(function(t){var e=new v(b.name(),t.row,t.col,t.row+t.rowCount-1,t.col+t.colCount-1);W.push(1===s.parent.options.referenceStyle?e.ToR1C1Text():e.ToA1Text(0,0))}),W.join(",")}},r._setDataRange=function(t,e,i,n,r){var o=this.sheet(),a=M(o,t);if(a){var s=this._chart.SeriesCollection,l=s._series,u=function(t){for(var e={},i=!1,n=t.length,r=0;r<n;r++){var o=t[r];o.HasDataLabels&&(e[r]=o.DataLabels,i=!0)}return i?e.count=n:e=C,e}(l);l.length=0;var h=a.ranges.map(function(t){return o._GetRange(t.row,t.col,t.rowCount,t.colCount,a.sheet)});s.Add(h,e,n,r,u,i)}},r._initDom=function(){var t=document.createElement("div"),e=t.style;e.boxSizing="border-box",e.border="1px none gray",e.width=this.width()+"px",e.height=this.height()+"px",e.outline="none",this.content(t,!1)},r._needSaveJsonToFloatingObjects=function(){return!1},r._updateStockChartErrorType=function(t){if(this._chart.errorType=null,t||50===this.chartType()){var e=this.series().Count,i=this.series()._series[0],n=null;i&&!S.AreAllDate(i.XValues)&&(n=1),4!==e&&(n=1===n?3:2),this._chart.errorType=n}},r._updateChartModel=function(t,e){t===x&&(t=!1);var i=this.sheet(),n=this._chart;if(n&&"empty"===n.status&&n.UpdateAxes(),t&&this.updateSeries(e,!0),this._updateStockChartErrorType(),i.isPaintSuspended())this._isDirty=!0;else{var r=this._flexDVs;if(r.length>0)for(var o=d(n,i),a=0,s=r.length;a<s;a++){var l=r[a];l.load(o),l.refresh()}this._isDirty=!1}this._dirtyType=t},r._updateChartFormula=function(t,e,i){var n=this._chart.SeriesCollection.Get(t);n&&n.UpdateFormula(e,i)},r.updateSeries=function(t,e){void 0===e&&(e=!1);var i=this._chart;i&&i.UpdateSeries(t,e)},r.getDataOrientation=function(){return u(this)},r.switchDataOrientation=function(){var t=this._getDataRange();if(t){var e,i=this._chart.SeriesCollection,n=1^u(this);return 0===this.chartType()&&(e=i.AllSers.map(function(t){return t.ChartType})),this._setDataRange(t,n,e),!0}return!1},r.getFormulas=function(){var t=this._chart;if(t)return t.SeriesCollection.AllSers.map(function(t){return t.Formula})},r.clone=function(t){var i,n=(t=t||this.sheet())&&t.parent&&t.parent.options.genChartByJson,r=this.toJSON(!0);return n?i=n(t,r):((i=new e(t)).fromJSON(r),i._updateChartModel(!0)),i},r._getSelectedSeries=function(t,e){return p.getSeries(this._chart,t,e)},r._getAlinedChartRanges=function(){for(var t,e,i,n,r={ranges:[]},o=this.sheet().name(),a=this.series().AllSers,s=[],u=[],h=[],c=0;c<a.length;c++){var p=a[c],f=p.ValuesRefers[0];f&&f.WorksheetName===o&&(n=y(f.Row,f.Column,f.RowCount,f.ColumnCount),s.push(n),t=t?t.union(n):n);var _=p.NameRefer;_&&_.WorksheetName===o&&(n=y(_.Row,_.Column,_.RowCount,_.ColumnCount),u.push(n),e=e?e.union(n):n);var d=p.XValuesRefers[0];d&&d.WorksheetName===o&&(n=y(d.Row,d.Column,d.RowCount,d.ColumnCount),h.push(n),i=i?i.union(n):n)}var g=this.getDataOrientation();if(t){if(!l(s,t))return;r.valuesRange=t,r.ranges.push(t)}if(e){if(!l(u,e))return;if(t){if(g&&(e.col!==t.col||e.colCount!==t.colCount))return;if(!g&&(e.row!==t.row||e.rowCount!==t.rowCount))return}r.nameRange=e,r.ranges.push(e)}if(i){if(!l(h,i))return;if(i){if(g&&(i.row!==t.row||i.rowCount!==t.rowCount))return;if(!g&&(i.col!==t.col||i.colCount!==t.colCount))return}r.xValuesRange=i,r.ranges.push(i)}return r},r._selectAllSeries=function(){var t=this._getAlinedChartRanges();t&&this._setSelectedRanges(t.ranges)},r._selectSeries=function(t,e){var i=[],n=this.sheet().name(),r=this._getSelectedSeries(t,e);if(r){var o=r.ValuesRefers[0];o&&o.WorksheetName===n&&i.push(y(o.Row,o.Column,o.RowCount,o.ColumnCount));var a=r.NameRefer;a&&a.WorksheetName===n&&i.push(y(a.Row,a.Column,a.RowCount,a.ColumnCount));var s=r.XValuesRefers[0];s&&s.WorksheetName===n&&i.push(y(s.Row,s.Column,s.RowCount,s.ColumnCount));var l=r.BubbleSizesRefers[0];l&&l.WorksheetName===n&&i.push(y(l.Row,l.Column,l.RowCount,l.ColumnCount))}this._setSelectedRanges(i,r)},r._setSelectedRanges=function(t,e){var i=this.sheet(),r=i._formulaTextBoxForChart;if(t&&t.length>0){var o=n.CalcEngine.rangesToFormula(t,i._activeRowIndex,i._activeColIndex,0,!1);r.text("=SERIES("+o+")")}else r.text("");r._allowMoveResize=!!e,r.series=e,r.chartView=this,i._render._paintFormulaTextBox()},r.toJSON=function(e){var i=t.prototype.toJSON.call(this),n=this._ps&&this._ps.sheet,r=n&&n.parent&&n.parent.options.genChartJson;if(r){var o=r(this,e);for(var a in o)i[a]=o[a]}delete i.content,i.chartSpace=this._chart.ToOOModel();return S.simpleJSONObject(i,["hiLowLines","p"]),i},r.fromJSON=function(e,i){t.prototype.fromJSON.call(this,e,i),this._chart=new c(this),this._chart.FromOOModel(e.chartSpace)},r._dispose=function(t){if(!1!==t){for(var e=this._flexDVs,i=0,n=e.length;i<n;i++)e[i].dispose();this._flexDVs=[],this._unbindEvents()}},S.defineProperty(r,"DrawingType",{get:function(){return 1}}),r._ToARGBColor=function(t){if(2===t.ColorType)return f.FromArgb(t.Value);var e=this.sheet();return e?e._ToARGBColor(t):new f},r._ToFont=function(t){var e=this.sheet();return e?e._ToFont(t):""},r._bindEvents=function(t){var e=this._eventsCache;e||(e=this._eventsCache=[]);var i=this.sheet(),n=function(){if(i.isEditing()&&!i.endEdit())return;if(!i._formulaTextBoxForChart){var t=i.parent,e=s._createEditorElement(t._host),n=i._formulaTextBoxForChart=new s.FormulaTextBox(e,{rangeSelectMode:!0,absoluteReference:!0},t);n._bind("TextChanged",function(){i._render._paintFormulaTextBox()}),n.onRangeMoved=function(t){P(i,t)},n.onRangeResized=function(t){P(i,t)}}};t.addEventListener("mousedown",n,!0),e.push([t,"mousedown",n])},r._unbindEvents=function(){var t=this._eventsCache;if(t)for(var e=0,i=t.length;e<i;e++){var n=t[e];n[0].removeEventListener(n[1],n[2])}this._eventsCache=C},r._initFlexDV=function(t,e,r){var o=this,a=o.sheet(),s=d(o._chart,a),l=i(9);if(l){var u=new l.FlexDV(t);u.renderMethod=l.RenderMethod.Canvas,b(e)||(u.devicePixelRatio=e),u.load(s),u.refresh(),!r&&u.event.addHandler(function(t,e){var i=e.event.action===l.MotionEvent.ACTION_CLICK,r=e.event.action===l.MotionEvent.ACTION_DBCLICK;if((i||r)&&a._canSelectFloatingObject(o)){var s,h=e.elementType;h&&h.indexOf(l.ElementType.Plot)>=0?s=e.model.items[0]:u.Select(C);var c=e.field;if(S.IsStockChart(o._chart.ChartType)){!c&&s&&(c="volume");var p="["+c+"]",f=u.Query(p);u.Select(f,{adorners:!0},p)}var _=A(h);7===_||8===_?o._selectAllSeries():o._selectSeries(s,c),a._trigger(i?n.Events.ChartClicked:n.Events.ChartDoubleClicked,F(o,e))}o.getHost()[0].style.cursor="default"}),o._flexDVs=[u]}},r.onNameChanged=function(t,e){this.sheet()._updateRegisteredFormula(this,{action:"rename",oldName:t,newName:e})},r._onSheetNameChanged=function(t,e){this.series().AllSers.forEach(function(i){var n=i.NameRefer;n&&n.WorksheetName===t&&(n.WorksheetName=e);var r=i.XValuesRefers;r&&r.forEach(function(i){i.WorksheetName===t&&(i.WorksheetName=e)});var o=i.ValuesRefers;o&&o.forEach(function(i){i.WorksheetName===t&&(i.WorksheetName=e)});var a=i.BubbleSizesRefers;a&&a.forEach(function(i){i.WorksheetName===t&&(i.WorksheetName=e)})})},r.hitTest=function(t,e){var n=i(9);if(n){var r=this._flexDVs;if(r&&r.length>0){var o=r[0],a=this.sheet().parent,s=_(a.getHost()).offset(),l=s.left,u=s.top,h=_(this._host[0]).offset(),c=h.left,p=h.top,f=o.hitTest(new n.core.Point(t+l-c,e+u-p));if(f)return F(this,f)}}return C},r.refreshContent=function(){var t=this.sheet().parent;if(t&&t._isResizing){var e=this._flexDVs;if(e&&e.length>0)for(var i=0,n=e.length;i<n;i++){e[i].refresh()}}},e}(a.FloatingObject);e.Chart=D,t.exports=e}()},function(t,e,i){"use strict";i(9),i(35);var n=i(0);i(10),i(4),i(1),i(6),i(15),i(27),i(5),i(30),i(8),i(12),i(7),i(29),i(24),i(11),i(26),i(25),i(21),i(31),i(22),i(36),i(32),i(28),i(23),i(33),i(39),i(18),i(40),n.SR={},n.SR.en=i(19),n.SR.zh=i(20),t.exports=n},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=i(9),o=i(14).sR,a=function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(t){!function(t){t.__Constant_Financial_DataGraphType_CandleStack=65536,t.__Constant_Financial_DataGraphType_HighLowOpenClose=327680,t.__Constant_Financial_DefaultStroke="#666"}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(t){!function(t){var e=function(){return function(){}}();t._StockValueDefinition=e}(t.data||(t.data={}))}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){!function(e){var i=function(){function e(t,e,i,n){this.name="",this._highField=t,this._lowField=e,this._openField=i,this._closeField=n}return e.prototype.toItem=function(e){for(var i=NaN,n=NaN,r=NaN,o=NaN,a=0,s=e;a<s.length;a++){var l=s[a];if(null!=this._openField){var u=t.core.asNumber(l[this._openField._name],!0);isNaN(r)&&null!=u&&(r=u)}if(null!=this._closeField)null!=(u=t.core.asNumber(l[this._closeField._name],!0))&&(o=u);if(null!=this._highField)null!=(u=t.core.asNumber(l[this._highField._name],!0))&&(isNaN(i)||i<u)&&(i=u);if(null!=this._lowField)null!=(u=t.core.asNumber(l[this._lowField._name],!0))&&(isNaN(n)||n>u)&&(n=u)}return{high:i,low:n,open:r,close:o}},e.prototype.toValue=function(t){var e=this.toItem(t);return isNaN(e.high)||isNaN(e.low)?null:e.high-e.low},e.prototype.equals=function(t){return t instanceof e&&(this._highField==t._highField&&this._lowField==t._lowField&&this._openField==t._openField&&this._closeField==t._closeField)},e.prototype._max=function(){var t=NaN;return null!=this._highField&&(isNaN(t)||t<this._highField._maximum())&&(t=this._highField._maximum()),null!=this._lowField&&(isNaN(t)||t<this._lowField._maximum())&&(t=this._lowField._maximum()),null!=this._openField&&(isNaN(t)||t<this._openField._maximum())&&(t=this._openField._maximum()),null!=this._closeField&&(isNaN(t)||t<this._closeField._maximum())&&(t=this._closeField._maximum()),t},e.prototype._min=function(){var t=NaN;return null!=this._highField&&(isNaN(t)||t>this._highField._minimum())&&(t=this._highField._minimum()),null!=this._lowField&&(isNaN(t)||t>this._lowField._minimum())&&(t=this._lowField._minimum()),null!=this._openField&&(isNaN(t)||t>this._openField._minimum())&&(t=this._openField._minimum()),null!=this._closeField&&(isNaN(t)||t>this._closeField._minimum())&&(t=this._closeField._minimum()),t},e}();e._HlocStockValueDefinition=i}(e.data||(e.data={}))}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){!function(e){var i=function(){function e(t){this.name="",this.__transactionField=t}return e.prototype.toItem=function(e){for(var i=NaN,n=NaN,r=NaN,o=NaN,a=0,s=e;a<s.length;a++){var l=s[a];if(null!=this.__transactionField){var u=t.core.asNumber(l[this.__transactionField._name],null);isNaN(r)&&null!=u&&(r=u),null!=u&&(o=u),null!=u&&(isNaN(i)||i<u)&&(i=u),null!=u&&(isNaN(n)||n>u)&&(n=u)}}return{high:i,low:n,open:r,close:o}},e.prototype.toValue=function(t){var e=this.toItem(t);return isNaN(e.high)||isNaN(e.low)?null:e.high-e.low},e.prototype.equals=function(t){return t instanceof e&&this.__transactionField==t.__transactionField},e.prototype._max=function(){return this.__transactionField._maximum()},e.prototype._min=function(){return this.__transactionField._minimum()},e}();e._TransactionStockValueDefinition=i}(e.data||(e.data={}))}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(i){function r(){return null!==i&&i.apply(this,arguments)||this}return a(r,i),Object.defineProperty(r.prototype,"legends",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dateField",{get:function(){return this.xField},enumerable:!0,configurable:!0}),r.prototype._analyseEncodings=function(){this.__categoryField=this._createCategoryField(this._option().encodings.category),i.prototype._analyseEncodings.call(this)},r.prototype._createCategoryField=function(e){if(null==e||null==e.field)return null;var i=this.fields[e.field];return i&&i._type==t.core.DataType.Date?i:null},r.prototype._createDetailFields=function(t){return null},r.prototype._createColorField=function(t){return null},r.prototype._createSizeField=function(t){return null},r.prototype._createShapeField=function(t){return null},r.prototype._createTextFieldList=function(t){return null},r.prototype._createTooltipFieldList=function(t){return null},r.prototype._createXSite=function(t,i){return void 0===i&&(i=0),new e._XStockSiteModel(this.dataSeriesList)},r.prototype._createYSite=function(e){return null==e||e.length<=0?new t.models._EmptySiteModel(0):e[0].ySite},r.prototype._createDataSeries=function(t,i,n,r){if(null!=i&&null!=this.dateField){if(i instanceof e.data._HlocStockValueDefinition)return new e._StockSeriesData(this,t,i,n,"Day");if(i instanceof e.data._TransactionStockValueDefinition)return new e._StockSeriesData(this,t,i,n,"Day")}return null},r.prototype._createValueDefinitionList=function(i,r){void 0===r&&(r=null);var o=[];if(null==i)return o;var a=i;Array.isArray(i)||(a=[i]);for(var s=[],l=0,u=a;l<u.length;l++){var h=u[l],c=this._createStockValueFields(h);if(null!=c)if(Array.isArray(c)&&c.length>0)for(var p=0,f=c;p<f.length;p++){for(var _=f[p],d=!1,g=0,y=s;g<y.length;g++){if(y[g]._equals(_)){d=!0;break}}d||s.push(_)}else if("object"==(void 0===c?"undefined":n(c))){var m=c;if(null!=this.xField)return o.push(new e.data._HlocStockValueDefinition(m.highField,m.lowField,m.openField,m.closeField)),o;if(null!=m.xField)return o.push(new t.data._SingleValueDefinition(m.xField)),o.push(new e.data._HlocStockValueDefinition(m.highField,m.lowField,m.openField,m.closeField)),o}}if(null==this.xField)for(var v=0,b=s;v<b.length;v++){if((T=b[v])._type==t.core.DataType.Date){o.push(new t.data._SingleValueDefinition(T));break}}for(var S=[],C=0,x=s;C<x.length;C++){var T;(T=x[C])._type==t.core.DataType.Number&&S.push(T)}var w=this._analyseNumberFields(S);if(w){if(null!=w.transactionField)return o.push(new e.data._TransactionStockValueDefinition(w.transactionField)),o;if(this._isValidValueFields({highField:w.highField,lowField:w.lowField,openField:w.openField,closeField:w.closeField}))return o.push(new e.data._HlocStockValueDefinition(w.highField,w.lowField,w.openField,w.closeField)),o}return o},r.prototype._createStockValueFields=function(e){var i=[];if(null==e)return i;if(null!=e.field){if("object"==n(e.field)){var r=null;null!=e.field.high&&"string"==typeof e.field.high&&null!=this.fields[e.field.high]&&this.fields[e.field.high]._type==t.core.DataType.Number&&(r=this.fields[e.field.high]);var o=null;null!=e.field.low&&"string"==typeof e.field.low&&null!=this.fields[e.field.low]&&this.fields[e.field.low]._type==t.core.DataType.Number&&(o=this.fields[e.field.low]);var a=null;null!=e.field.open&&"string"==typeof e.field.open&&null!=this.fields[e.field.open]&&this.fields[e.field.open]._type==t.core.DataType.Number&&(a=this.fields[e.field.open]);var s=null;null!=e.field.close&&"string"==typeof e.field.close&&null!=this.fields[e.field.close]&&this.fields[e.field.close]._type==t.core.DataType.Number&&(s=this.fields[e.field.close]);var l=null;return null!=e.field.x&&"string"==typeof e.field.x&&null!=this.fields[e.field.x]&&this.fields[e.field.x]._type==t.core.DataType.Date&&(l=this.fields[e.field.x]),this._isValidValueFields({highField:r,lowField:o,openField:a,closeField:s})?{highField:r,lowField:o,openField:a,closeField:s,xField:l}:null}if("string"==typeof e.field)for(var u=0,h=e.field.split(",");u<h.length;u++){var c=h[u],p=this.fields[c.trim()];null!=p&&i.push(p)}}return i},r.prototype._getLegendModel=function(t){return null},r}(t.models._XyPlotData);e._StockPlotData=i}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(t){function e(e,i,n){var r=t.call(this,e,i,n.valueOf())||this;return r.__date=n,r._assign(e.valueDefinition.toItem(r.items)),r.open<r.close&&(r.style.fill="none"),r}return a(e,t),Object.defineProperty(e.prototype,"date",{get:function(){return this.__date},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"high",{get:function(){return this.item.high},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"low",{get:function(){return this.item.low},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"open",{get:function(){return this.item.open},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"close",{get:function(){return this.item.close},enumerable:!0,configurable:!0}),e.prototype._stack=function(t){return t},Object.defineProperty(e.prototype,"xValue",{get:function(){return this.date.valueOf()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tooltipContentSite",{get:function(){return new n(this)},enumerable:!0,configurable:!0}),e.prototype._onColorChanged=function(){this.style.fill=this.color},e}(t.models._XyPointData);e._StockPointData=i;var n=function(){function e(e){t._assertDebug(function(){return null!=e}),this.__point=e;var i=this.__point.parent.parent._option().config.tooltip.template;if(null==i||i.length<=0)this.__tokens=["date","high","low","open","close"];else{this.__tokens=[];var n=this.__point.parent.parent._option().encodings.tooltip;if(n.length>0)for(var r=0,o=n;r<o.length;r++){var a=o[r];-1==this.__tokens.indexOf(a.field)&&this.__tokens.push(a.field)}}}return Object.defineProperty(e.prototype,"stringFormatting",{get:function(){return this.__point.parent.parent.parent.parent._stringFormatting()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"template",{get:function(){var t=this.__point.parent.parent._option().encodings.tooltip;if(null==t||t.length<=0)return null;var e=this.__point.parent.parent._option().config.tooltip.template;return null==e||e.length<=0?this._defaultTemplate():e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultProperty",{get:function(){return"value"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"literalTokens",{get:function(){return[{name:"date"},{name:"high"},{name:"low"},{name:"open"},{name:"close"}]},enumerable:!0,configurable:!0}),e.prototype.fromToken=function(t,e){if(-1!=this.__tokens.indexOf(t)){if("date"==t)return{name:o().date,value:this.__point.date.toLocaleDateString()};if("high"==t)return{name:o().high,value:this.__point.high};if("low"==t)return{name:o().low,value:this.__point.low};if("open"==t)return{name:o().open,value:this.__point.open};if("close"==t)return{name:o().close,value:this.__point.close}}return{name:"",value:""}},e.prototype._defaultTemplate=function(){var t=this.__point.parent.parent._option().encodings.tooltip,e=["date"];if(t.length>0)for(var i=0,n=t;i<n.length;i++){var r=n[i];-1==e.indexOf(r.field)&&e.push(r.field)}return e.map(function(t){return"{"+t+".name}:{"+t+".value}"}).join("\n")},e}()}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(i){function r(e,n,r,o,a){var s=i.call(this,e,n,r,o,t.Group.Cluster)||this;return s.__dateUnit=a,s}return a(r,i),Object.defineProperty(r.prototype,"ySite",{get:function(){return null==this.__ySite&&(this.__ySite=new n(this.valueDefinition)),this.__ySite},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dataModel",{get:function(){return this.parent},enumerable:!0,configurable:!0}),r.prototype._createDataPointList=function(){for(var e=[],i=0,n=this.items;i<n.length;i++){var r=n[i],o=r[this.dataModel.dateField._name],a=this.parent.xField._parse(o);a&&"Day"==this.__dateUnit&&e.push({date:new Date(a.getFullYear(),a.getMonth(),a.getDate()),item:r})}var s=new t.core.collections.CollectionView(e),l=new t.core.collections.PropertyGroupDescription("date");s.groupDescriptions.push(l);for(var u=[],h=function(t){var e=t.items[0].date,i=[];t.items.forEach(function(t){i.push(t.item)}),u.push(c._createDataPoint(i,e.valueOf()))},c=this,p=0,f=s.groups;p<f.length;p++){h(f[p])}return u},r.prototype._createDataPoint=function(t,i){return new e._StockPointData(this,t,new Date(i))},r.prototype._applyDataPointConditionFormattingRules=function(t){null!=this.dataPoints&&this.dataPoints.forEach(function(e){t.forEach(function(t){t.evaluate(e)})})},r}(t.models._XySeriesData);e._StockSeriesData=i;var n=function(){function e(t){this.valueCount=NaN,this.groups=null,this.groupLevels=0,this.__valueFields=t}return Object.defineProperty(e.prototype,"name",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.__valueFields._min()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.__valueFields._max()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return t.core.DataType.Number},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOrdinal",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.labelFromValue=function(e,i){var n=t.plugins._stringFormattingPlugin("Default");if(null!=n){var r=n.create();if(null!=r)return r.format(i,e)}return null},e}()}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(){function e(t){this.__isOrdinal=!1,this.__dates=null,this.__min=NaN,this.__max=NaN,this.groupLevels=0,this.groups=[],this.__min=NaN,this.__max=NaN;var e=NaN;this.__dates=[];for(var i=0,n=t;i<n.length;i++)for(var r=NaN,o=0,a=n[i].dataPoints;o<a.length;o++){var s=a[o].date.valueOf();-1==this.__dates.indexOf(s)&&((isNaN(this.__min)||this.__min>s)&&(this.__min=s),(isNaN(this.__max)||this.__max<s)&&(this.__max=s),this.__dates.push(s)),isNaN(r)||(isNaN(e)||e>s-r)&&(e=s-r),r=s}isNaN(e)||(this.__min-=.5*e,this.__max+=.5*e)}return Object.defineProperty(e.prototype,"name",{get:function(){return"date"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.__min},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.__max},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dataType",{get:function(){return t.core.DataType.Date},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isOrdinal",{get:function(){return this.__isOrdinal},set:function(t){this.__isOrdinal!=t&&(this.__isOrdinal=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){return this.__dates.length},enumerable:!0,configurable:!0}),e.prototype.labelFromValue=function(e,i){var n=new Date(e);return null==i?this._stringFormatting().format(this._stringFormatting().defaultFormat(t.core.DataType.Date,!1),n):this._stringFormatting().format(i,n)},e.prototype._stringFormatting=function(){if(null==this.__stringFormatting){var e=t.plugins._stringFormattingPlugin("Default");e&&(this.__stringFormatting=e.create())}return this.__stringFormatting},e}();e._XStockSiteModel=i}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype._analyseNumberFields=function(t){return t.length<=0?{highField:null,lowField:null,openField:null,closeField:null,transactionField:null}:t.length<=3?{highField:null,lowField:null,openField:null,closeField:null,transactionField:t[0]}:{highField:t[0],lowField:t[1],openField:t[2],closeField:t[3],transactionField:null}},e.prototype._isValidValueFields=function(t){return null!=t},e}(t._StockPlotData);t._CandleStickPlotData=e}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype._analyseNumberFields=function(t){return t.length<=0?{highField:null,lowField:null,openField:null,closeField:null,transactionField:null}:1==t.length?{highField:null,lowField:null,openField:null,closeField:null,transactionField:t[0]}:2==t.length?{highField:t[0],lowField:t[1],openField:null,closeField:null,transactionField:null}:3==t.length?{highField:t[0],lowField:t[1],openField:t[2],closeField:null,transactionField:null}:{highField:t[0],lowField:t[1],openField:t[2],closeField:t[3],transactionField:null}},e.prototype._isValidValueFields=function(t){return null!=t},e}(t._StockPlotData);t._HlocPlotData=e}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(){function i(){}return i.prototype.create=function(i,n){return null!=n&&null!=i&&i instanceof t._PlotAreaView?new e._CandleStickGraph(i,n):null},i}();e._CandleStickGraphPlugin=i}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(){function i(){}return i.prototype.create=function(i,n){return null!=n&&null!=i&&i instanceof t._PlotAreaView?new e._HlocGraph(i,n):null},i}();e._HlocGraphPlugin=i}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return a(i,e),Object.defineProperty(i.prototype,"radial",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"dataModel",{get:function(){return this.__dataModel},enumerable:!0,configurable:!0}),i.prototype.bindData=function(t){this.__dataModel=this._createDataModel(t)},i.prototype._barWidth=function(){var t=this._globalConfig().bar.width;return null==t?.7:(t>1&&(t=1),t<0&&(t=0),t)},i.prototype.Query=function(e){for(var i=[],n=new t._SelectionConditionalFormattingRule(e,function(e,i){try{var n=new t.core.Binding(i),r=n.getValue(e.item);return null==r&&(r=n.getValue(e)),r}catch(t){}return null},function(t,e){var i=t.item;for(var n in i)if(e==n)return!0;return!1},function(t){i.push(t)}),r=0,o=this.dataModel.dataSeriesList;r<o.length;r++)for(var a=0,s=o[r].dataPoints;a<s.length;a++){var l=s[a];n.evaluate(l)}return i},i}(t._CartesianGraph);e._StockGraph=i}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return a(n,i),Object.defineProperty(n.prototype,"type",{get:function(){return t.DataGraphType.CoordinateSystem_Xy|e.__Constant_Financial_DataGraphType_CandleStack},enumerable:!0,configurable:!0}),n.prototype._createDataModel=function(t){return new e._CandleStickPlotData(this,t,this._option())},n.prototype.layoutSeries=function(t,e){for(var i=0,n=this.dataModel.dataSeriesList;i<n.length;i++)for(var r=0,o=n[i].dataPoints;r<o.length;r++){var a=o[r];this.layoutCandlestick(t,a)}},n.prototype.layoutCandlestick=function(i,n){this._globalConfig().selectedStyle,this._globalConfig().unselectedStyle;var r=this.plotArea._getAxisX(this.name),o=this.plotArea._getAxisY(this.name),a=n.xValue-.5*this._minWidthInValues()*this._barWidth(),s=a+this._minWidthInValues()*this._barWidth(),l=((a=r._axisscale().getScaleValue(a))+(s=r._axisscale().getScaleValue(s)))/2,u=o._axisscale().getScaleValue(n.high),h=o._axisscale().getScaleValue(n.low),c=o._axisscale().getScaleValue(n.open),p=o._axisscale().getScaleValue(n.close),f=new e._CandleStickPointView(n);f.datapoint=n;var _=a<s?a:s,d=n.open>n.close?c:p;f.topLineStart=new t.core.Point(l,u),f.topLineEnd=new t.core.Point(l,d),f.bottomLineStart=new t.core.Point(l,h),f.bottomLineEnd=new t.core.Point(l,d+Math.abs(p-c)),f._rect(new t.core.Rect(_,d,Math.abs(s-a),Math.abs(p-c)));var g=new t.core.Rect(_,d,Math.abs(s-a),Math.abs(u-h));f.refresh(),this._hitTester.add(new t._RectArea(g,n)),this._children.push(f)},n}(e._StockGraph);e._CandleStickGraph=i}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.__model=t,i.datapoint=t,i.__hittestRects=[],i}return a(i,e),i.prototype._selected=function(t){if(void 0===t)return this._model().isSelected;1==t?this._model()._select():this._model()._unselect()},i.prototype._model=function(){return this.__model},i.prototype._defaultStyle=function(){return{opacity:null,fill:"#666",stroke:"#666",strokeWidth:1,strokeDasharray:null,symbolOpacity:null,symbolFill:null,symbolStroke:null,symbolStrokeWidth:null,symbolStrokeDasharray:null}},i.prototype._render=function(e){this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible&&(e.beginTransform(),this._applyStyle(e,this._defaultStyle()),this._applyStyle(e,this._model().style),this._model().isSelected?t._applyStyle(e,this._model().parent.parent.parent.parent._option().selectedStyle):t._applyStyle(e,this._model().parent.parent.parent.parent._option().unselectedStyle),this._hovered&&t._applyStyle(e,this._model().parent.parent._option().config.hoverStyle),null!=this._topLineStartPt&&null!=this._topLineEndPt&&(this._topLineStartPt.equals(this._topLineEndPt)||e.drawLine(this._topLineStartPt.x,this._topLineStartPt.y,this._topLineEndPt.x,this._topLineEndPt.y)),null!=this._bottomLineStartPt&&null!=this._bottomLineEndPt&&(this._bottomLineStartPt.equals(this._bottomLineEndPt)||e.drawLine(this._bottomLineStartPt.x,this._bottomLineStartPt.y,this._bottomLineEndPt.x,this._bottomLineEndPt.y)),e.drawRect(this._rect().left,this._rect().top,this._rect().width,this._rect().height),e.restoreTransform())},i.prototype._applyStyle=function(t,e){null!=e&&(null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeWidth&&(t.strokeDasharray=e.strokeDasharray))},Object.defineProperty(i.prototype,"topLineStart",{set:function(t){this._topLineStartPt=t.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"topLineEnd",{set:function(t){this._topLineEndPt=t.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottomLineStart",{set:function(t){this._bottomLineStartPt=t.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"bottomLineEnd",{set:function(t){this._bottomLineEndPt=t.clone()},enumerable:!0,configurable:!0}),i.prototype.onHitted=function(e){for(var i=0;i<this.__hittestRects.length;++i){var n=this.__hittestRects[i];if(e.contains(n)){var r=this.datapoint.item.open>this.datapoint.item.close,o=void 0;switch(i){case 0:o="high";break;case 1:o=r?"open":"close";break;case 2:o=r?"close":"open";break;case 3:o="low"}return new t.HitInfo(new t.core.Point(e.x,e.y),this.datapoint,null,this,[t.ElementType.Shape],this._selection,o)}}return null},i.prototype.refresh=function(){this.__hittestRects=[this._rect().clone(),this._rect().clone(),this._rect().clone(),this._rect().clone()],this.__adorner=[];var t=this._rect().top,e=this._rect().bottom,i=t,n=this._rect().top+this._rect().height/2,r=this._rect().bottom;if(null!=this._topLineStartPt&&null!=this._topLineEndPt&&(this.__adorner.push(this._topLineStartPt.clone()),this.__adorner.push(this._topLineEndPt.clone()),t=this._topLineStartPt.y-10,i=this._topLineEndPt.y-(this._topLineEndPt.y-this._topLineStartPt.y)/2),null!=this._bottomLineStartPt&&null!=this._bottomLineEndPt&&(this.__adorner.push(this._bottomLineEndPt.clone()),this.__adorner.push(this._bottomLineStartPt.clone()),r=this._rect().bottom+Math.abs(this._bottomLineEndPt.y-this._bottomLineStartPt.y)/2,e=this._rect().bottom+Math.abs(this._bottomLineEndPt.y-this._bottomLineStartPt.y)+10),this.__hittestRects[0].top=t,this.__hittestRects[0].height=i-t,this.__hittestRects[1].top=i,this.__hittestRects[1].height=n-i,this.__hittestRects[2].top=n,this.__hittestRects[2].height=r-n,this.__hittestRects[3].top=r,this.__hittestRects[3].height=e-r,this._selection.points=[],this._model().isSelected){var o=this._model().field;if(null!=o){var a=(o=o.replace("[","").replace("]","")).split(".");a.indexOf("high")>-1&&(this._selection.points=this._selection.points.concat([this.__adorner[0]])),a.indexOf("open")>-1&&(this._model().open>this._model().close?this._selection.points=this._selection.points.concat([this.__adorner[1]]):this._selection.points=this._selection.points.concat([this.__adorner[2]])),a.indexOf("close")>-1&&(this._model().open>this._model().close?this._selection.points=this._selection.points.concat([this.__adorner[2]]):this._selection.points=this._selection.points.concat([this.__adorner[1]])),a.indexOf("low")>-1&&(this._selection.points=this._selection.points.concat([this.__adorner[3]]))}else this._selection.rect=this._rect().clone(),this._selection.points=this._selection.points.concat(this.__adorner)}},i}(t._View);e._CandleStickPointView=i}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(i){function n(){return null!==i&&i.apply(this,arguments)||this}return a(n,i),Object.defineProperty(n.prototype,"type",{get:function(){return t.DataGraphType.CoordinateSystem_Xy|e.__Constant_Financial_DataGraphType_HighLowOpenClose},enumerable:!0,configurable:!0}),n.prototype._createDataModel=function(t){return new e._HlocPlotData(this,t,this._option())},n.prototype.layoutSeries=function(t,e){for(var i=0,n=this.dataModel.dataSeriesList;i<n.length;i++)for(var r=0,o=n[i].dataPoints;r<o.length;r++){var a=o[r];this.layoutHloc(t,a)}},n.prototype.layoutHloc=function(i,n){this._globalConfig().selectedStyle,this._globalConfig().unselectedStyle;var r=n.high,o=n.low,a=n.open,s=n.close,l=this.plotArea._getAxisX(this.name),u=this.plotArea._getAxisY(this.name),h=n.xValue-.5*this._minWidthInValues()*this._barWidth(),c=h+this._minWidthInValues()*this._barWidth(),p=((h=l._axisscale().getScaleValue(h))+(c=l._axisscale().getScaleValue(c)))/2,f=u._axisscale().getScaleValue(r),_=u._axisscale().getScaleValue(o),d=u._axisscale().getScaleValue(a),g=u._axisscale().getScaleValue(s),y=new e._HlocPointView(n);y.datapoint=n,isNaN(p)||isNaN(f)||isNaN(_)||(y.hlLineStart=new t.core.Point(p,f),y.hlLineEnd=new t.core.Point(p,_));isNaN(p-Math.abs(c-h)/2)||isNaN(d)||isNaN(d)||(y.openLineStart=new t.core.Point(p-Math.abs(c-h)/2,d),y.openLineEnd=new t.core.Point(p,d)),isNaN(p)||isNaN(g)||isNaN(c)||isNaN(h)||(y.closeLineStart=new t.core.Point(p,g),y.closeLineEnd=new t.core.Point(p+Math.abs(c-h)/2,g)),y.refresh();var m=y._rect().clone();this._children.push(y),this._hitTester.add(new t._RectArea(m,r))},n}(e._StockGraph);e._HlocGraph=i}(t.financial||(t.financial={}))}(r||(r={})),function(t){!function(e){var i=function(e){function i(t){var i=e.call(this)||this;return i.__model=t,i.datapoint=t,i}return a(i,e),i.prototype._selected=function(t){if(void 0===t)return this._model().isSelected;1==t?this._model()._select():this._model()._unselect()},i.prototype._model=function(){return this.__model},i.prototype._defaultStyle=function(){return{opacity:null,fill:null,stroke:"green",strokeWidth:1,strokeDasharray:null,symbolOpacity:null,symbolFill:null,symbolStroke:null,symbolStrokeWidth:null,symbolStrokeDasharray:null}},i.prototype._render=function(e){this._visible()!==t.ViewState.Gone&&this._visible()!==t.ViewState.Invisible&&(e.beginTransform(),this._applyStyle(e,this._defaultStyle()),this._applyStyle(e,this._model().style),this._model().isSelected?t._applyStyle(e,this._model().parent.parent.parent.parent._option().selectedStyle):t._applyStyle(e,this._model().parent.parent.parent.parent._option().unselectedStyle),this._hovered&&t._applyStyle(e,this._model().parent.parent._option().config.hoverStyle),null!=this._hlStartPt&&null!=this._hlEndPt&&e.drawLine(this._hlStartPt.x,this._hlStartPt.y,this._hlEndPt.x,this._hlEndPt.y),null!=this._openStartPt&&null!=this._openEndPt&&(this._openStartPt.equals(this._openEndPt)||e.drawLine(this._openStartPt.x,this._openStartPt.y,this._openEndPt.x,this._openEndPt.y)),null!=this._closeStartPt&&null!=this._closeEndPt&&(this._closeStartPt.equals(this._closeEndPt)||e.drawLine(this._closeStartPt.x,this._closeStartPt.y,this._closeEndPt.x,this._closeEndPt.y)),e.restoreTransform())},i.prototype._applyStyle=function(t,e){null!=e&&(null!=e.fill&&(t.fill=e.fill),null!=e.stroke&&(t.stroke=e.stroke),null!=e.strokeWidth&&(t.strokeWidth=e.strokeWidth),null!=e.strokeWidth&&(t.strokeDasharray=e.strokeDasharray))},Object.defineProperty(i.prototype,"hlLineStart",{set:function(t){this._hlStartPt=t.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hlLineEnd",{set:function(t){this._hlEndPt=t.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"openLineStart",{set:function(t){this._openStartPt=t.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"openLineEnd",{set:function(t){this._openEndPt=t.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"closeLineStart",{set:function(t){this._closeStartPt=t.clone()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"closeLineEnd",{set:function(t){this._closeEndPt=t.clone()},enumerable:!0,configurable:!0}),i.prototype.onHitted=function(e){for(var i=0;i<this.__hittestRects.length;++i){var n=this.__hittestRects[i];if(e.contains(n)){var r=void 0;switch(i){case 0:r="high";break;case 1:r="open";break;case 2:r="close";break;case 3:r="low"}return new t.HitInfo(new t.core.Point(e.x,e.y),this.datapoint,null,this,[t.ElementType.Shape],this._selection,r)}}return null},i.prototype.refresh=function(){e.prototype.refresh.call(this);var i=t._Util.min(null!=this._hlStartPt?this._hlStartPt.x:null,null!=this._hlEndPt?this._hlEndPt.x:null,null!=this._openEndPt?this._openEndPt.x:null,null!=this._openStartPt?this._openStartPt.x:null,null!=this._closeEndPt?this._closeEndPt.x:null,null!=this._closeStartPt?this._closeStartPt.x:null),n=t._Util.min(null!=this._hlStartPt?this._hlStartPt.y:null,null!=this._hlEndPt?this._hlEndPt.y:null,null!=this._openEndPt?this._openEndPt.y:null,null!=this._openStartPt?this._openStartPt.y:null,null!=this._closeEndPt?this._closeEndPt.y:null,null!=this._closeStartPt?this._closeStartPt.y:null),r=t._Util.max(null!=this._hlStartPt?this._hlStartPt.x:null,null!=this._hlEndPt?this._hlEndPt.x:null,null!=this._openEndPt?this._openEndPt.x:null,null!=this._openStartPt?this._openStartPt.x:null,null!=this._closeEndPt?this._closeEndPt.x:null,null!=this._closeStartPt?this._closeStartPt.x:null),o=t._Util.max(null!=this._hlStartPt?this._hlStartPt.y:null,null!=this._hlEndPt?this._hlEndPt.y:null,null!=this._openEndPt?this._openEndPt.y:null,null!=this._openStartPt?this._openStartPt.y:null,null!=this._closeEndPt?this._closeEndPt.y:null,null!=this._closeStartPt?this._closeStartPt.y:null);if(this._rect(new t.core.Rect(i,n,r-i,o-n)),this.__hittestRects=[],this.__adorner=[],null!=this._hlStartPt&&(this.__hittestRects[0]=new t.core.Rect(this._hlStartPt.x-10,this._hlStartPt.y-10,20,20),this.__adorner[0]=this._hlStartPt.clone()),null!=this._openStartPt&&(this.__hittestRects[1]=new t.core.Rect(this._openStartPt.x,this._openStartPt.y-10,this._rect().width/2,20),this.__adorner[1]=this._openStartPt.clone()),null!=this._closeEndPt&&(this.__hittestRects[2]=new t.core.Rect(this._closeEndPt.x-this._rect().width/2,this._closeEndPt.y-10,this._rect().width/2,20),this.__adorner[2]=this._closeEndPt.clone()),null!=this._hlEndPt&&(this.__hittestRects[3]=new t.core.Rect(this._hlEndPt.x-10,this._hlEndPt.y-10,20,20),this.__adorner[3]=this._hlEndPt.clone()),this._selection.points=[],this._model().isSelected){var a=this._model().field;if(null!=a){var s=(a=a.replace("[","").replace("]","")).split(".");s.indexOf("high")>-1&&(this._selection.points=this._selection.points.concat([this.__adorner[0]])),s.indexOf("open")>-1&&(this._selection.points=this._selection.points.concat([this.__adorner[1]])),s.indexOf("close")>-1&&(this._selection.points=this._selection.points.concat([this.__adorner[2]])),s.indexOf("low")>-1&&(this._selection.points=this._selection.points.concat([this.__adorner[3]]))}else this._selection.rect=this._rect().clone()}},i}(t._View);e._HlocPointView=i}(t.financial||(t.financial={}))}(r||(r={})),function(t){t._registerDataGraph("Candlestick",new t.financial._CandleStickGraphPlugin),t._registerDataGraph("HighLowOpenClose",new t.financial._HlocGraphPlugin)}(r||(r={})),t.exports=r},function(t,e,i){"use strict";!function(){var e=i(2)._Types._inherit,n=i(0),r=i(4).StatefullBase,o=i(1),a=o.ShapeConstants,s=a.PositionConver,l=o.ChartUtility.defineProperty,u=o.ShapeUtility,h=u.FromLum,c=u.ToLum,p=o.UnitHelper.isNullOrUndefined,f=null,_=void 0;n.PictureFormatType={PictureShape:0,PictureFill:1,TextureFill:2};var d=function(){function t(t){this._pictureOffsetX=0,this._pictureOffsetY=0,this._pictureWidth=0,this._pictureHeight=0,this._container=t}var e=t.prototype;return l(e,"PictureHeight",{get:function(){return this._pictureHeight},set:function(t){this._pictureHeight=t}}),l(e,"PictureOffsetX",{get:function(){return this._pictureOffsetX},set:function(t){this._pictureOffsetX=t}}),l(e,"PictureOffsetY",{get:function(){return this._pictureOffsetY},set:function(t){this._pictureOffsetY=t}}),l(e,"PictureWidth",{get:function(){return this._pictureWidth},set:function(t){this._pictureWidth=t}}),l(e,"ShapeHeight",{get:function(){return this._container.Height},set:function(t){this._container.Height=t}}),l(e,"ShapeLeft",{get:function(){return this._container.Left},set:function(t){this._container.Left=t}}),l(e,"ShapeTop",{get:function(){return this._container.Top},set:function(t){this._container.Top=t}}),l(e,"ShapeWidth",{get:function(){return this._container.Width},set:function(t){this._container.Width=t}}),e.Clone=function(){var e=new t(this._container);return e._pictureHeight=this._pictureHeight,e._pictureOffsetX=this._pictureOffsetX,e._pictureOffsetY=this._pictureOffsetY,e._pictureWidth=this._pictureWidth,e},t}();n.Crop=d;var g=function(t){function i(e,i){e===_&&(e=0),i===_&&(i=f),t.call(this,i);return this._brightness=a.DefaultBrightness,this._colorType=0,this._contrast=a.DefaultBrightness,this._transparencyColor=a.DefaultTransparent,this._pictureFormatType=e,this._parent=i,this._transparentBackground=0===this._pictureFormatType,this}e(i,t);var n=i.prototype;return l(n,"Brightness",{get:function(){return this.IsDirty(1)||p(this._parent)?this._brightness:this._parent.Brightness},set:function(t){if(t<0||t>1)throw new Error;this._brightness=t,this.Dirty(1)}}),l(n,"ColorType",{get:function(){return this.IsDirty(2)||p(this._parent)?this._colorType:this._parent.ColorType},set:function(t){0===t?(this._brightness=a.DefaultBrightness,this._contrast=a.DefaultBrightness):3===t&&(this._brightness=.85,this._contrast=.15),this._colorType=t,this.Dirty(2)}}),l(n,"Contrast",{get:function(){return this.IsDirty(4)||p(this._parent)?this._contrast:this._parent.Contrast},set:function(t){if(t<0||t>1)throw new Error;this._contrast=t,this.Dirty(4)}}),l(n,"Crop",{get:function(){return this._crop||(this._crop=new d(this._shapeBase)),this._crop}}),l(n,"CropBottom",{get:function(){return this.Crop.ShapeTop+this.Crop.ShapeHeight},set:function(t){this.Crop.ShapeHeight=t-this.Crop.ShapeTop}}),l(n,"CropLeft",{get:function(){return this.Crop.ShapeLeft},set:function(t){this.Crop.ShapeLeft=t}}),l(n,"CropRight",{get:function(){return this.Crop.ShapeLeft+this.Crop.ShapeWidth},set:function(t){this.Crop.ShapeWidth=t-this.Crop.ShapeLeft}}),l(n,"CropTop",{get:function(){return this.Crop.ShapeTop},set:function(t){this.Crop.ShapeTop=t}}),l(n,"TransparencyColor",{get:function(){return this.IsDirty(8)||p(this._parent)?this._transparencyColor:this._parent.TransparencyColor},set:function(t){this._transparencyColor=t,this.Dirty(8)}}),l(n,"TransparentBackground",{get:function(){return this.IsDirty(16)||p(this._parent)?this._transparentBackground:this._parent.TransparentBackground},set:function(t){this._transparentBackground=t;var e=this._shapeBase.Fill;t&&(e.Transparency=1),e.Solid(),this.Dirty(16)}}),l(n,"Container",{get:function(){return this._shapeBase},set:function(t){if(this._shapeBase=t,t){var e=this.Crop;e.PictureWidth=t.Width,e.PictureHeight=t.Height}}}),l(n,"PicFill",{get:function(){return this.IsDirty(32)||p(this._parent)?this._picFill:this._parent.PicFill},set:function(t){this._picFill=t,this.Dirty(32)}}),l(n,"PicType",{get:function(){return this.IsDirty(64)||p(this._parent)?this._picType:this._parent.PicType},set:function(t){this._picType=t,this.Dirty(64)}}),n.ClearModel=function(){this._oomodel=f;for(var t=0,e=this.Children;t<e.length;t++){e[t].ClearModel()}},l(n,"PictureFormatType",{get:function(){return this._pictureFormatType},set:function(t){this._pictureFormatType=t}}),n.HasOwnPicture=function(){return this.IsDirty(1)||this.IsDirty(2)||this.IsDirty(4)||this.IsDirty(8)||this.IsDirty(16)},n.SetPictureInfo=function(t,e,i){this.PicFill=t,this.PicType=e,this.PictureFormatType=i},n.IncrementBrightness=function(t){this.Brightness+=t},n.IncrementContrast=function(t){this.Contrast+=t},n.FromOOModel=function(t){if(this._oomodel=t,!p(t)){this.FromCT_Blip(t.blip);var e=this._shapeBase;p(e)||(p(t.tile)||(this.PictureFormatType=2),this.Crop.PictureWidth=e.Width,this.Crop.PictureHeight=e.Height,0===this.PictureFormatType?this.FromCT_RelativeRect(t.srcRect):1===this.PictureFormatType&&this.FromCT_RelativeRect(t.stretch.fillRect))}},n.ToOOModel=function(){var t=this._oomodel||{};t.colorFillType=3,t.blip=this.ToCT_Blip();var e=this._shapeBase;if(p(e))return t;var i=this.PictureFormatType;return 0===i?(t.srcRect=this.ToCT_RelativeRect(),t.stretch={},t.stretch.fillRect={l:0,r:0,t:0,b:0}):1===i?(t.stretch={},t.stretch.fillRect=this.ToCT_RelativeRect(),t.srcRect={l:0,r:0,t:0,b:0}):2===i&&(t.stretch=f,t.srcRect=f),t},n.FromCT_Blip=function(t){if(!p(t)){this.FromCT_ColorChangeEffect(t.clrChange),this.FromCT_LuminanceEffect(t.lum),p(t.grayscl)?p(t.biLevel)||(this.ColorType=2):this.ColorType=1,this.FromCT_BlipBlob(t.blipBlob)}},n.ToCT_Blip=function(){var t=this._oomodel&&this._oomodel.blip||{cstate:4};return this.TransparencyColor!==a.DefaultTransparent&&(t.clrChange=this.ToCT_ColorChangeEffect()),this.Brightness===a.DefaultBrightness&&this.Contrast===a.DefaultBrightness||(t.lum=this.ToCT_LuminanceEffect()),1===this.ColorType?t.grayscl={}:2===this.ColorType&&(t.biLevel={thresh:5e4}),t.blipBlob=this.ToCT_BlipBlob(),t},n.FromCT_ColorChangeEffect=function(t){t&&t.clrFrom&&t.clrFrom.srgbClr&&this.FromColorByteArr(t.val)},n.ToCT_ColorChangeEffect=function(){var t=this.ToColorByteArr(this._transparencyColor);return{useA:!0,clrFrom:{srgbClr:{val:t}},clrTo:{srgbClr:{val:t,alpha:[0]}}}},n.FromColorByteArr=function(t){this._transparencyColor=0|t[2]<<16|t[1]<<8|t[0]},n.ToColorByteArr=function(t){var e=[];return e[3]=Math.floor(t/(1<<24)),t%=1<<24,e[2]=Math.floor(t/65536),t%=65536,e[1]=Math.floor(t/256),t%=256,e[0]=Math.floor(t),e},n.FromCT_LuminanceEffect=function(t){t&&(this.Brightness=h(t.bright),this.Contrast=h(t.contrast))},n.ToCT_LuminanceEffect=function(){return{bright:c(this.Brightness),contrast:c(this.Contrast)}},n.FromCT_BlipBlob=function(t){if(t){this._picFill=t.blob,this.Dirty(32),this._picType=t.type,this.Dirty(64)}},n.ToCT_BlipBlob=function(){var t=this._oomodel&&this._oomodel.blip&&this._oomodel.blip.blipBlob||{type:0};return t.blob=this.PicFill,t.type=this.PicType,t},n.FromCT_RelativeRect=function(t){var e=this._shapeBase;if(!p(t)&&!p(e)){var i=t.l/s,n=t.r/s,r=t.t/s,o=t.b/s,a=this.Crop,l=a.PictureWidth=e.Width/(1-i-n),u=a.PictureHeight=e.Height/(1-r-o);a.PictureOffsetX=(l-e.Width)/2-i*l,a.PictureOffsetY=(u-e.Height)/2-r*u}},n.ToCT_RelativeRect=function(){var t=this._shapeBase,e=this.Crop,i=e.ShapeHeight,n=e.ShapeWidth;if(p(t)||0===i||0===n)return{l:0,r:0,t:0,b:0};var r=e.PictureWidth,o=e.PictureHeight,a=e.PictureOffsetX,l=e.PictureOffsetY;return{l:((r-n)/2-a)/r*s,r:((r-n)/2+a)/r*s,t:((o-i)/2-l)/o*s,b:((o-i)/2+l)/o*s}},n.Clone=function(){var t=new i;return t._brightness=this._brightness,t._contrast=this._contrast,t._colorType=this._colorType,this._crop&&(t._crop=this._crop.Clone()),t._picFill=this._picFill,t._pictureFormatType=this._pictureFormatType,t._picType=this._picType,t._shapeBase=this._shapeBase,t._transparencyColor=this._transparencyColor,t._transparentBackground=this._transparentBackground,t},n.OnParentChanged=function(t){this._parent=t},i}(r);n.PictureFormat=g,t.exports=n}()},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._createRange=function(t,e,i,r){return new n.Range(t,e,i,r)};var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e}(i(3))},function(e,i,n){"use strict";e.exports=t.Spread.Sheets.FormulaTextBox},function(t,e,i){"use strict";!function(){var t=i(3),e=i(17),n=i(2),r=t.CalcEngine,o=n._Types,a=o._extend,s=o._inherit;function l(t){if(t){var e=t.lastIndexOf(",");if(e>0)return{index:+t.substr(e+1),name:t.substr(0,e)}}}function u(t,e,i,n,r,o){if(t&&i&&n){var a=l(i);if(a){var s=e[a.name];if(s){var u=t.get(s);if(u){o&&o.push(u);var h=n.formula;h&&u._updateChartFormula(a.index,h,r),n.dataChanged&&u._updateChartModel(!0)}}}}}function h(t,e,i,n,r){var o=e.getFormulas();t._chartViews[n]=r,o&&o.length&&o.forEach(function(t,e){i.setFormulaByName(n+","+e,t)})}function c(t,e){for(var i=0;t.getExpressionByName(e+","+i);)t.setFormulaByName(e+","+i,null),i++}a((r.ChartSource=function(t){function e(e){t.call(this,null),this._sheet=e,this._chartViews={},this._updatedChartViews={}}return s(e,t),e}(e.CalcSource)).prototype,{getValueByName:function(t){},setFormulaByName:function(t,e){var i=this._updatedChartViews,n=i[t];n||(n=i[t]={}),n.formula=e},setValueByName:function(t,e){var i=this._updatedChartViews,n=i[t];n||(n=i[t]={}),n.dataChanged=!0},_addChart:function(t){this._updateFormulaForChart(t,0)},_removeChart:function(t){this._updateFormulaForChart(t,1)},_updateChart:function(t,e){this._updateFormulaForChart(t,2,e)},_updateFormulaForChart:function(t,e,i){var n=this._sheet.getCalcService(),r=n.getSourceModel(this);if(t){n.suspend(!0);var o=t.name(),a=o.toUpperCase();0===e?h(this,t,r,a,o):1===e?c(r,a):i&&"rename"===i.action?(c(r,i.oldName.toUpperCase()),h(this,t,r,i.newName.toUpperCase(),o)):(c(r,a),h(this,t,r,a,o)),n.resume(!1)}},startCalculation:function(){},endCalculation:function(){var t=this._sheet.charts,e=this.getCalcService()&&this.getCalcService().useR1C1;if(t){var i=this._chartViews,n=this._updatedChartViews,r=[];for(var o in n)n[o].formula&&u(t,i,o,n[o],e,r);var a={};for(o in n)if(n[o].dataChanged){var s=l(o);if(s){var h=i[s.name];a[h]||(u(t,i,o,n[o],e),a[h]=!0)}}this._updatedChartViews={}}}})}()},function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(){var e=i(0),r=i(13),o=i(3),a=i(16),s=i(17),l=o.Events,u=o.GC$,h=o.Worksheet,c=o.Workbook,p=s.Functions,f=i(2)._ColorHelper,_=i(33).Chart,d=o.CalcEngine.ChartSource,g=i(1),y=g.DateTimeExtension,m=g.ChartUtility,v=g.Range,b=g.CellRect,S=i(12).ARGBColor,C=null,x=void 0,T=Math.floor;function w(t){a.FloatingObjectCollection.call(this,t,"2")}function P(t,e,i,n){var r=t.zoom();n&&!n.width||(i.style.width=T(e.width()*r)+"px"),n&&!n.height||(i.style.height=T(e.height()*r)+"px")}function A(t){var e=t._formulaTextBoxForChart;e&&(e.series=x,e.chartView=x,e._unbind("TextChanged"),e.destroy(),t._formulaTextBoxForChart=C)}u.extend(h.prototype,{_GetSheet:function(t){return this.parent.getSheetFromName(t)},_GetVisibleCellStyles:function(t,e,i,n){for(var r=[],o=0;o<i;o++)if(this.getRowVisible(t+o)){for(var a=[],s=0;s<n;s++)this.getColumnVisible(e+s)&&a.push(this._GetCellStyle(t+o,e+s));r.push(a)}return r},_GetCellStyles:function(t,e,i,n){for(var r=[],o=0;o<i;o++){for(var a=[],s=0;s<n;s++)a.push(this._GetCellStyle(t+o,e+s));r.push(a)}return r},_GetCellStyle:function(t,e){return{FormatCode:function(t){var e="General";return t&&(e=t.formatter||t._autoFormatter)&&"object"===(void 0===e?"undefined":n(e))?e.formatString():e}(this.getStyle(t,e)),Flag:C}},_GetCellValues:function(t,e,i,n,r){r===x&&(r=!1);for(var o=[],a=0;a<i;a++){for(var s=[],l=0;l<n;l++)s.push(this._GetCellValue(t+a,e+l,r));o.push(s)}return o},_GetVisibleCellValues:function(t,e,i,n,r){r===x&&(r=!1);for(var o=[],a=0;a<i;a++)if(this.getRowVisible(t+a)){for(var s=[],l=0;l<n;l++)this.getColumnVisible(e+l)&&s.push(this._GetCellValue(t+a,e+l,r));o.push(s)}return o},_GetCellValue:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getValue(t,e),o=this.getFormatter(t,e),a=this.getCellType(t,e),s="8"===a.typeName;if(i&&"number"==typeof n&&n>=0&&n<y.OADateMaxAsDouble&&r.isDateOrTimeFormatter(o))return y.FromOADate(n);if(s){var l=parseInt(a.getText());NaN!==l&&(n=l)}return n},_GetCellText:function(t,e,i,n){var r=this.getText(t,e);if(!r)return"";if(i>1||n>1)for(var o=0;o<i;o++)for(var a=0;a<n;a++)if(r!==this.getText(t+o,e+a))return"";return r},_expressionToReferenceValues:function(t,e,i,n,r){var o=new s.Evaluator,a=(t.source||this._getSheetSource()).getEvaluatorContext(s._createCellIdentity(n,r)),l=s._mappingArray(a,t,!1,0,0,!0,!0),u=o.evaluate(l||t,a,!0,!0);if(u instanceof s.CalcReference)for(var h=u.getSource().getName(),c=0;c<u.getRangeCount();c++){var p=m.CreateReference(h,u.getRow(c),u.getColumn(c),u.getRowCount(c),u.getColumnCount(c));e.push(p)}else if(u instanceof s.CalcArray)for(var f=0;f<u.getRowCount();f++)for(var _=0;_<u.getColumnCount();_++)i.push(u.getValue(f,_))},_ParseFormula:function(t,e,i,n){var r=[],o=[],a=this.getCalcService();if(t&&a){"("===t[0]&&")"===t[t.length-1]&&(t=t.substring(1,t.length-1));var s=a.parse(this._getSheetSource(),t,e,i,void 0,void 0,!n);this._expressionToReferenceValues(s,r,o,e,i)}return{references:r,values:o}},_GetRange:function(t,e,i,n,r){var o=1,a=1;return t<0&&(o=-1),e<0&&(a=-1),new v(r||this,[new b(t,e,i||o,n||a)])},_GetHiddens:function(t){for(var e=[],i=t?this.getRowCount():this.getColumnCount(),n=t?this.getRowVisible:this.getColumnVisible,r=-1,o=0,a=0;a<i;a++)n.call(this,a)?-1!==r&&0!==o&&(e.push({Index:r,Count:o}),r=-1,o=0):-1===r?(r=a,o=1):o++;return-1!==r&&0!==o&&e.push({Index:r,Count:o}),e},_ToARGBColor:function(t){var e=t.ColorType;if(3===e)return S.FromIndexedColor(t.Value,t.Tint);if(4===e){var i=this.currentTheme(),n=m.toThemeColorString(t.Value,t.Tint),r=f._fromString(i.getColor(n));return S.FromArgbs(r.a,r.r,r.g,r.b)}return 1===e?S.FromKnownColor(26):0===e?new S:S.FromArgb(t.Value).GetTintColor(t.Tint)},_ToFont:function(t){var e=this.currentTheme();return 1===t?e.getFont("Body"):2===t?e.getFont("Headings"):""},_IsHidden:function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];if(n.IsFullRow){for(var r=0,o=n.RowCount;r<o;r++)if(this.getRowVisible(n.Row+r))return!1}else if(n.IsFullColumn)for(var a=0,s=n.ColumnCount;a<s;a++)if(this.getColumnVisible(n.Column+a))return!1}return!0},_updateRegisteredFormula:function(t,e){var i=this._chartSource;i&&i._updateChart(t,e)},_updateAllChartInSheet:function(){for(var t=this.charts&&this.charts.all(),e=t&&t.length,i=0;i<e;i++)t[i]._updateChartModel()}}),w.prototype=new a.FloatingObjectCollection,w.prototype.add=function(t,e,i,n,r,o,a,s,l,u,h){var c=this._sheet,p=new _(c,t,e,i,n,r,o,a,s,l,u);return h&&p.dropdownMenu(h),c._floatingObjectModel._add(p),p},w.prototype._add=function(t){return this._sheet._floatingObjectModel._add(t),t},w.prototype.remove=function(t){var e=this.get(t);this._sheet._floatingObjectModel._remove(t)&&e._dispose()},w.prototype.clear=function(){var t=this.all();this._sheet._floatingObjectModel._clear(this._kind);for(var e=0;e<t.length;e++)t[e]._dispose()},e.ChartCollection=w,h._registerFeature("chart",{priority:4998,init:function(){var t=this,e=t._chartSource=new d(t);function i(e){for(var i=0,n=t.charts.all();i<n.length;i++){n[i]._updateChartModel(!0,e)}}t.charts=new w(t),t._floatingObjectListeners.push({_onAddItem:function(t){"2"===t.typeName&&e._addChart(t)}}),t._bind(l.RowChanged+".chart",function(e,n){"isVisible"===n.propertyName&&i([new b(n.row,0,1,t.getColumnCount())])}),t._bind(l.ColumnChanged+".chart",function(e,n){"isVisible"===n.propertyName&&i([new b(0,n.col,t.getRowCount(),1)])}),t._bind(l.FloatingObjectLoaded+".chart",function(e,i){var n=i.floatingObject._chart,r=i.floatingObject;if(n){var o=i.element;r._bindEvents(o),P(t,r,o),r._initFlexDV(o)}}),t._bind(l.FloatingObjectChanged+".chart",function(e,i){var n,r=i.floatingObject,o=i.propertyName,a=r._flexDVs;if(r.getHost().length>0&&a&&a.length>0)for(var s=r.isSelected(),l=0,u=a.length;l<u;l++){var h=a[l];if(n=h.hostElement,"width"===o||"height"===o){var c={};c[o]=!0,P(t,r,n,c),r.width()>0&&r.height()>0&&h.refresh()}else"isSelected"!==o||s||h.Select(C)}}),t._bind(l.FloatingObjectRemoved+".chart",function(e,i){var n=i.floatingObject;n._flexDVs&&(n._dispose(),A(t))})},dispose:function(t){if(!1!==t){this._unbind(".chart"),A(this)}},processMouseDown:function(t){t.hitInfo.formulaRangeHitInfo||(A(this),this._render._paintFormulaTextBox())},toJson:function(t,e){if(!(e&&e.ignoreStyle)){var i=this.charts.all();i.length>0&&(t.charts=i.map(function(t){return t.toJSON()}))}},fromJsonAfterFormula:function(t,e,i){if(!(i&&i.ignoreStyle)){var n=t.charts;if(n)for(var r=0,o=n;r<o.length;r++){var a,s=o[r],l=this&&this.parent&&this.parent.options.genChartByJson;l?a=l(this,s):(a=new _(this)).fromJSON(s),this.charts._add(a)}}},onLayoutChanged:function(t){var e=this;"zoomSheet"===t.changeType&&e.charts.all().forEach(function(t){var i=t._flexDVs;if(i&&i.length>0){for(var n=0,r=i.length;n<r;n++){var o=i[n];P(e,t,o.hostElement)}t._updateChartModel()}})},onPaintSuspend:function(t){this.charts.all().forEach(function(e){!t.suspend&&e._isDirty&&e._updateChartModel(e._dirtyType)})},setName:function(t){for(var e=t.oldName,i=t.newName,n=this.getParent(),r=n.getSheetCount(),o=0;o<r;o++){n.getSheet(o).charts.all().forEach(function(t){t._onSheetNameChanged(e,i)})}},onProtectChanged:function(){this._updateAllChartInSheet()}}),c._registerFeature("chart",{init:function(){if(!p.findGlobalFunction("SERIES")){var t=new p.Function("SERIES",4,5);t.evaluate=function(t){return 0},t.acceptsReference=function(t){return!0},t.acceptsArray=function(t){return!0},p._customFunctions.SERIES=t}},fromJson:function(t,e,i){i&&i.ignoreStyle||this.sheets.forEach(function(t){t.charts.all().forEach(function(t){t.updateSeries(C,!0)})})}}),t.exports=e}()}])}},1165:function(t,e,i){"use strict";i.d(e,"b",function(){return n});var n,r=i(2),o=i.n(r),a=i(0),s=i.n(a),l=i(22),u=i.n(l),h=i(147),c=i.n(h),p=i(127),f=i.n(p),_=i(1),d=(i.n(_),i(1166)),g=i(1168),y=i(629),m=i(543),v=i(542),b=(i.n(v),this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),S=_.sheets.track,C=_.sheets.Events;!function(t){t[t.basic=0]="basic",t[t.advanced=1]="advanced"}(n||(n={}));var x=function(t){function e(e){var i=t.call(this,e)||this;return i.componentWillUnmount=function(){i.props.editor.off(C.SheetSwitched,i.afterSheetSwitched)},i.afterSheetSwitched=function(){i.state.isRangeSelecting||i.close()},i.show=function(t,e){var n=t.name,r=t.options,o=i.props.editor.spread.gcSpread.getActiveSheet();i.setState({isShow:!0,chartName:n,chart:c()({},v.defaultChart,r),floatingObject:o.charts.get(n),activeTab:e})},i.close=function(){i.state.isShow&&(i.setState({isShow:!1}),i.setSpreadFocus(!0))},i.updateSidebarChartConfig=function(){var t=i.state,e=t.isShow,n=t.chartName;if(e){var r=i.props.editor.spread.getActiveSheet().gcSheet.charts.get(n);if(r){var o=Object(m.i)(r);o&&i.setState({chart:c()({},v.defaultChart,o)})}else i.close()}},i.setSpreadFocus=function(t){var e=i.props.editor.spread.gcSpread,n=e.getActiveSheet();n.suspendFloatingObjects=!0,e.focus(t),n.suspendFloatingObjects=!1},i.updateChartConfig=function(t,e){void 0===t&&(t={});var n=c()({},i.state.chart,t);i.setState({chart:n}),!e&&i.updateChart(n)},i.updateRangeSelecting=function(t){i.setState({isRangeSelecting:t})},i.updateChartByDataRange=function(t){var e=i.state.chart,n=i.props.editor.spread.getActiveSheet(),r=c()({},v.defaultChart,e,t),o=y.b(n.gcSheet,"temp-chart",c()({},r,{position:[0,0,500,300]}));i.updateChartConfig({series:Object(m.k)(o)})},i.updateChart=function(t){var e=i.state.chartName,n=i.props.editor.spread.getActiveSheet().gcSheet;f()(t.chartTitle)&&(t.chartTitle=""),i.props.applyChart({gcSheet:n,chart:{chartName:e,config:t}})},i.changeActiveTab=function(t){t!==i.state.activeTab&&i.setState({activeTab:t}),S(2,t===n.basic?"0077":"0078")},i.renderBasicTab=function(){var t=i.props.editor,e=i.state,n=e.chart,r=e.floatingObject,o=t.spread.getActiveSheet().gcSheet;return s.a.createElement(d.a,{chart:n,editor:t,gcSheet:o,floatingObject:r,updateChartConfig:i.updateChartConfig,updateChartByDataRange:i.updateChartByDataRange,updateRangeSelecting:i.updateRangeSelecting})},i.renderAdvancedTab=function(){var t=i.state,e=t.chart,n=t.floatingObject,r=i.props.editor.spread.getActiveSheet().gcSheet;return s.a.createElement(g.a,{chart:e,gcSheet:r,floatingObject:n,updateChartConfig:i.updateChartConfig})},i.state={isShow:!1,activeTab:n.basic,chart:v.defaultChart,chartName:"",floatingObject:null,isRangeSelecting:!1},i.sidebar=s.a.createRef(),i.props.editor.on(C.SheetSwitched,i.afterSheetSwitched),i}return b(e,t),e.prototype.render=function(){var t=this,e=this.state,i=e.isShow,r=e.activeTab,a=e.floatingObject,l=e.isRangeSelecting;if(!a||!i)return null;var h=r===n.basic;return s.a.createElement("div",{ref:this.sidebar,className:u()({"sheet-editor-chart-sidebar":!0,show:i&&!l})},s.a.createElement("div",{className:"chart-sidebar-head-wrap"},s.a.createElement("div",{className:"f-row f-m-between chart-sidebar-title"},s.a.createElement("span",null,o()("")),s.a.createElement("span",{className:"icon-close hicon",onClick:this.close})),s.a.createElement("div",{className:"chart-sidebar-toggle-tabs"},[n.basic,n.advanced].map(function(e){return s.a.createElement("div",{key:e,className:"tab",onClick:function(){return t.changeActiveTab(e)}},s.a.createElement("span",{className:u()({"tab-active":e===r})},e===n.basic?o()(""):o()("")))}))),s.a.createElement("div",{className:"chart-sidebar-scroll-wrap"},h?this.renderBasicTab():this.renderAdvancedTab()))},e}(a.Component);e.a=x},1166:function(t,e,i){"use strict";var n,r,o,a,s=i(2),l=i.n(s),u=i(0),h=i.n(u),c=i(603),p=i.n(c),f=i(207),_=i.n(f),d=i(542),g=(i.n(d),i(543)),y=i(761),m=i(1),v=(i.n(m),this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),b=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},S=m.sheets.Core,C=m.sheets,x=C.column,T=C.formula,w=C.range.RangeInput,P=C.track,A=x.getColName,F=T.parseFormulaToRangeText,O=T.parseFormulaToRanges,M=function(t){function e(e){var i=t.call(this,e)||this;i.componentWillReceiveProps=function(t){var e=t.floatingObject,n=t.gcSheet;i.setState({labels:Object(g.j)(e),dataOrientation:!!e.getDataOrientation(),rangeText:i.getRangeText(n,e)})},i.onChartTypeChange=function(t){var e=+t.currentTarget.getAttribute("data-type"),n=i.props.chart.chartType;e!==n&&(i.props.updateChartConfig({chartType:e}),P(2,"0076",{"":Object(d.charts)().find(function(t){return t.type===e}).name}))},i.getRangeText=function(t,e){return e?(i.dataRange=e.dataRange(),i.dataRangeForDisplay=e.dataRangeForDisplay(),i.dataRange||i.dataRangeForDisplay?F(t,i.dataRange?i.dataRange:i.dataRangeForDisplay):l()("")):""},i.isSwitchDisabled=function(){return!i.dataRange||p()(i.dataRangeForDisplay,",")},i.switchOrientation=function(){var t=i.props.floatingObject;t.switchDataOrientation(),i.setState({dataOrientation:!!t.getDataOrientation()}),i.props.updateChartConfig({series:Object(g.k)(t)}),P(2,"0088")},i.onSeriesLabelClick=function(){P(2,"0080"),i.disableLabels[0]||i.onLabelClick(0)},i.onCategoryLabelClick=function(){P(2,"0081"),i.disableLabels[1]||i.onLabelClick(1)},i.onLabelClick=function(t){if(!i.isSwitchDisabled()){var e=i.props.floatingObject,n=_()(i.state.labels);n[t]=!n[t],i.setState({labels:n}),e.dataRange(i.dataRange,n[0],n[1]),i.props.updateChartConfig({series:Object(g.k)(e)})}},i.getLabelInfo=function(){var t=i.props,e=t.gcSheet,o=t.floatingObject,a=o?o.getDataOrientation():null,s=S.Spread.Sheets.CalcEngine.formulaToRanges(e,i.dataRange),u={text:["",""],disable:[!0,!0]},h=s&&s[0]&&s[0].ranges[0];if(h){var c=s[0].sheetName,p=h.row,f=h.col,_=h.rowCount,d=h.colCount,g=c!==e.name()?c:"",y=l()(n||(n=b([""," "," "],[""," "," "])),g,A(f)),m=l()(r||(r=b([""," "," "],[""," "," "])),g,p+1);u.text=a?[m,y]:[y,m];var v=0===a,C=v&&1===d||!v&&1===_,x=v&&1===_||!v&&1===d;u.disable=[C,x]}return u},i.validateDataRange=function(t){var e=t.textValue,n=i.props.editor.spread.getActiveSheet(),r=!0,o=!0;try{var a=O(n.gcSheet,e),s=[];if(a.length){s=a.reduce(function(t,e){return t.concat(e.range)},[]);var l=n.getRowCount(),u=n.getColumnCount();s.forEach(function(t){var e=t.row,i=t.col,n=t.rowCount,o=t.colCount;(e<0||i<0||n>l||o>u)&&(r=!1)})}else r=!1;r&&(o=n.gcSheet.isRangeReadable(s))}catch(t){r=!1}return{validRange:r,rangeReadable:o}},i.onRangeInputChange=function(t){var e=t.textValue,n=t.isChangeFromSelect;i.setState({rangeText:e});var r=i.validateDataRange({textValue:e}).rangeReadable;r!==i.state.rangeReadable&&i.setState({rangeReadable:r}),n&&(i.applyDataRange({textValue:e}),i.setState({rangeText:e}))},i.applyDataRange=function(t){var e=t.textValue,n=i.validateDataRange({textValue:e}),r=n.validRange,o=n.rangeReadable;r&&o?i.props.updateChartByDataRange({rangeFormula:e}):r||i.setState({rangeText:i.getRangeText(i.props.gcSheet,i.props.floatingObject)})},i.activeChartType=h.a.createRef(),i.dataRange=null,i.dataRangeForDisplay=null,i.disableLabels=[!1,!1];var o=i.props,a=o.gcSheet,s=o.floatingObject;return i.state={labels:Object(g.j)(s),dataOrientation:!!s.getDataOrientation(),rangeReadable:!0,rangeText:i.getRangeText(a,s)},i}return v(e,t),e.prototype.componentDidMount=function(){this.activeChartType&&this.activeChartType.current&&this.activeChartType.current.scrollIntoViewIfNeeded&&this.activeChartType.current.scrollIntoViewIfNeeded()},e.prototype.render=function(){var t=this,e=this.props,i=e.chart,n=e.editor,r=i.chartType,s=this.state,u=s.labels,c=s.dataOrientation,p=s.rangeReadable,f=s.rangeText,_=u[0],g=u[1],m=this.getLabelInfo(),v=m.text,S=v[0],C=v[1],x=this.disableLabels=m.disable,T=x[0],P=x[1],A=this.isSwitchDisabled(),F=Object(d.charts)().filter(function(t){return t.type===r})[0]||{},O=F.tag,M=void 0===O?null:O,D=F.name,L=void 0===D?null:D;return h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:"charteditor-section chart-type"},h.a.createElement("div",{className:"charteditor-control-label"},l()("")),M&&h.a.createElement("div",{className:"f-row f-c-center current-chart-type"},h.a.createElement("span",{className:"chart-type-img","data-type":M}),h.a.createElement("span",{className:"chart-type-name"},l()(L))),h.a.createElement("span",{className:"chart-sidebar-divider"}),h.a.createElement("div",{className:"sheet-chart-type-list f-row f-wrap f-m-between f-cl-between"},Object(d.charts)().map(function(e){var i=e.tag,n=e.name,o=e.type;return h.a.createElement("li",{title:n,key:n,ref:o===r?t.activeChartType:null,className:"f-col f-c-center sheet-chart-type-item"+(o===r?" active":""),onClick:t.onChartTypeChange,"data-type":o},h.a.createElement("div",{className:"sheet-chart-img","data-type":i}),h.a.createElement("div",{className:"sheet-chart-name"},n))}).concat(h.a.createElement("li",{key:"empty",className:"f-col f-c-center sheet-chart-type-item sheet-chart-type-item-empty"})))),h.a.createElement("div",{className:"charteditor-section chart-data-range"},h.a.createElement("div",{className:"charteditor-control-label"},l()("")),h.a.createElement(w,{textValue:f,appendToValueAfterSelect:"no",className:"chart-data-range-input",editor:n,invalid:!p,onEnter:this.applyDataRange,onBlur:this.applyDataRange,onChange:this.onRangeInputChange,onStartSelect:function(){return t.props.updateRangeSelecting(!0)},onQuitSelect:function(){return t.props.updateRangeSelecting(!1)}}),!p&&h.a.createElement("div",{className:"chart-data-range-invalide"},l()("")),h.a.createElement("div",{className:"chart-data-range-checkboxes"},h.a.createElement(y.a,{text:l()(" / "),checked:!c,disable:A,onClick:this.switchOrientation}),h.a.createElement(y.a,{text:l()(o||(o=b(["",""],["",""])),S),checked:_,disable:T,onClick:this.onSeriesLabelClick}),h.a.createElement(y.a,{text:l()(a||(a=b(["",""],["",""])),C),checked:g,disable:P,onClick:this.onCategoryLabelClick}))))},e}(u.Component);e.a=M},1167:function(t,e,i){var n,r,o;!function(i,a){r=[],void 0===(o="function"==typeof(n=a)?n.apply(e,r):n)||(t.exports=o)}(0,function(){return function t(e,i,n){var r,o,a=window,s="application/octet-stream",l=n||s,u=e,h=!i&&!n&&u,c=document.createElement("a"),p=function(t){return String(t)},f=a.Blob||a.MozBlob||a.WebKitBlob||p,_=i||"download";if(f=f.call?f.bind(a):Blob,"true"===String(this)&&(l=(u=[u,l])[0],u=u[1]),h&&h.length<2048&&(_=h.split("/").pop().split("?")[0],c.href=h,-1!==c.href.indexOf(h))){var d=new XMLHttpRequest;return d.open("GET",h,!0),d.responseType="blob",d.onload=function(e){t(e.target.response,_,s)},setTimeout(function(){d.send()},0),d}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(u)){if(!(u.length>2096103.424&&f!==p))return navigator.msSaveBlob?navigator.msSaveBlob(v(u),_):b(u);l=(u=v(u)).type||s}else if(/([\x80-\xff])/.test(u)){for(var g=0,y=new Uint8Array(u.length),m=y.length;g<m;++g)y[g]=u.charCodeAt(g);u=new f([y],{type:l})}function v(t){for(var e=t.split(/[:;,]/),i=e[1],n=("base64"==e[2]?atob:decodeURIComponent)(e.pop()),r=n.length,o=0,a=new Uint8Array(r);o<r;++o)a[o]=n.charCodeAt(o);return new f([a],{type:i})}function b(t,e){if("download"in c)return c.href=t,c.setAttribute("download",_),c.className="download-js-link",c.innerHTML="downloading...",c.style.display="none",document.body.appendChild(c),setTimeout(function(){c.click(),document.body.removeChild(c),!0===e&&setTimeout(function(){a.URL.revokeObjectURL(c.href)},250)},66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,s)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var i=document.createElement("iframe");document.body.appendChild(i),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,s)),i.src=t,setTimeout(function(){document.body.removeChild(i)},333)}if(r=u instanceof f?u:new f([u],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(r,_);if(a.URL)b(a.URL.createObjectURL(r),!0);else{if("string"==typeof r||r.constructor===p)try{return b("data:"+l+";base64,"+a.btoa(r))}catch(t){return b("data:"+l+","+encodeURIComponent(r))}(o=new FileReader).onload=function(t){b(this.result)},o.readAsDataURL(r)}return!0}})},1168:function(t,e,i){"use strict";var n=i(2),r=i.n(n),o=i(0),a=i.n(o),s=i(630),l=i.n(s),u=i(144),h=i.n(u),c=i(207),p=i.n(c),f=i(313),_=i.n(f),d=i(543),g=i(761),y=i(1),m=(i.n(y),this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}()),v=y.sheets.Core,b=y.sheets.track,S=function(t){function e(e){var i=t.call(this,e)||this;i.componentWillReceiveProps=function(t){var e=t.chart.axes.primaryValue,n=e.min,r=e.max;i.setState({max:r,min:n})},i.onLegendChange=function(t,e,n){var r=n.value;i.props.updateChartConfig(r);var o=v.Spread.Sheets.Charts.LegendPosition,a=o.top,s=o.right,l=o.left,u=o.bottom,h="0094";if(r.legendPosition)switch(r.legendPosition){case a:h="0095";break;case s:h="0096";break;case l:h="0097";break;case u:h="0098"}b(2,h)},i.onChartTitleChange=function(t){i.props.updateChartConfig({chartTitle:Object(d.d)(t.target.value,200)},!0),i.updateChartConfig("0089")},i.onAxesTitleChange=function(t,e){var n=i.props.chart.axes,r=p()(n);e?r.primaryCategory.title.text=Object(d.d)(t.target.value,100):r.primaryValue.title.text=Object(d.d)(t.target.value,100),i.props.updateChartConfig({axes:r},!0),i.updateChartConfig(e?"0090":"0091")},i.onAxisRangeChange=function(t,e){e?i.setState({min:t.target.value}):i.setState({max:t.target.value})},i.changeAxisRange=function(t,e){var n=parseFloat(t.target.value),r=isNaN(n)?null:n,o=i.props.chart.axes,a=p()(o);e&&(a.primaryValue.min=r),!e&&(a.primaryValue.max=r),i.props.updateChartConfig({axes:a},!0),i.updateChartConfig(e?"0092":"0093")},i.onAxisRangeReset=function(){var t=i.props.chart.axes,e=p()(t);e.primaryValue.min=null,e.primaryValue.max=null,i.props.updateChartConfig({axes:e})},i.switchDataLabels=function(){i.props.updateChartConfig({dataLabels:!i.props.chart.dataLabels}),b(2,"0099")},i.switchMajorGridLine=function(t){var e=i.props.chart.axes,n=p()(e);t?(n.primaryCategory.majorGridLine.visible=!e.primaryCategory.majorGridLine.visible,b(2,"0086")):(n.primaryValue.majorGridLine.visible=!e.primaryValue.majorGridLine.visible,b(2,"0087")),i.props.updateChartConfig({axes:n})};var n=i.props.chart.axes.primaryValue,r=n.min,o=n.max;return i.state={max:o,min:r},i.updateChartConfig=h()(function(t){i.props.updateChartConfig(),b(2,t)},800),i}return m(e,t),e.prototype.renderLegendMenu=function(){var t=v.Spread.Sheets.Charts.LegendPosition,e=t.top,i=t.right,n=t.left,o=t.bottom,s=[{display:r()(""),value:{legendPosition:i,legendVisible:!0}},{display:r()(""),value:{legendPosition:n,legendVisible:!0}},{display:r()(""),value:{legendPosition:e,legendVisible:!0}},{display:r()(""),value:{legendPosition:o,legendVisible:!0}},{display:r()(""),value:{legendVisible:!1}}],u=this.props.chart,h=u.legendPosition,c=void 0===h?o:h,p=u.legendVisible,f=void 0!==p&&p,d=l()(s,function(t){var e=t.value;return f===e.legendVisible&&c===e.legendPosition||!1===f&&f===e.legendVisible});return a.a.createElement("div",{className:"charteditor-section chart-legend"},a.a.createElement("div",{className:"charteditor-control-label"},r()("")),a.a.createElement("div",{className:"f-row f-c-center legend-dropdown"},a.a.createElement(_.a,{wrapClassName:"legend-dropdown",menuItems:s,displayKey:"display",valKey:"value",selectedIndex:d,onMenuChange:this.onLegendChange,itemTpl:function(t,e,i,n){var r=e[n];return a.a.createElement("div",null,a.a.createElement("span",{className:"menu-item-text"},r))},selectedTpl:function(t,e,i){var n=e[i];return a.a.createElement("div",null,a.a.createElement("span",{className:"menu-item-text"},n),a.a.createElement("span",{className:"menu-item-selected-icon"}))}})),a.a.createElement("span",{className:"chart-sidebar-divider"}))},e.prototype.render=function(){var t=this,e=this.state,i=e.min,n=e.max,o=this.props.chart,s=o.chartTitle,l=o.axes,u=o.dataLabels,h=50===o.chartType,c=l.primaryCategory,p=l.primaryValue;return a.a.createElement("div",null,a.a.createElement("div",{className:"charteditor-section chart-title-axis"},a.a.createElement("div",{className:"charteditor-control-label"},r()("")),a.a.createElement("div",{className:"charteditor-control-label sub chart-title"},r()("")),a.a.createElement(g.b,{value:s,placeholder:r()("200"),onChange:this.onChartTitleChange}),a.a.createElement("div",{className:"charteditor-control-label sub haxis-title"},r()("()")),a.a.createElement(g.b,{value:c.title.text,placeholder:r()("100"),onChange:function(e){return t.onAxesTitleChange(e,!0)}}),a.a.createElement("div",{className:"charteditor-control-label sub vaxis-title"},r()("()")),a.a.createElement(g.b,{value:p.title.text,placeholder:r()("100"),onChange:function(e){return t.onAxesTitleChange(e,!1)}}),a.a.createElement("div",{className:"charteditor-control-label sub custom-axis-range"},r()("")),a.a.createElement("div",{className:"f-row f-nowrap custom-axis-range-input-wrap"},a.a.createElement(g.b,{value:i||"",customClass:"custom-axis-range-input",placeholder:r()(""),onChange:function(e){return t.onAxisRangeChange(e,!0)},onBlur:function(e){return t.changeAxisRange(e,!0)}}),a.a.createElement(g.b,{value:n||"",customClass:"custom-axis-range-input",placeholder:r()(""),onChange:function(e){return t.onAxisRangeChange(e,!1)},onBlur:function(e){return t.changeAxisRange(e,!1)}}),a.a.createElement("div",{className:"f-row f-c-center custom-axis-range-reset",onClick:this.onAxisRangeReset},r()(""))),a.a.createElement("span",{className:"chart-sidebar-divider"})),h?null:this.renderLegendMenu(),a.a.createElement("div",{className:"charteditor-section chart-line"},a.a.createElement("div",{className:"charteditor-control-label"},r()("")),a.a.createElement(g.a,{text:r()(""),checked:u,onClick:this.switchDataLabels}),a.a.createElement(g.a,{text:r()(""),checked:p.majorGridLine.visible,onClick:function(){return t.switchMajorGridLine(!1)}}),a.a.createElement(g.a,{text:r()(""),checked:c.majorGridLine.visible,onClick:function(){return t.switchMajorGridLine(!0)}})))},e}(o.Component);e.a=S},1169:function(t,e,i){"use strict";var n,r=i(2),o=i.n(r),a=i(0),s=i.n(a),l=i(210),u=i(38),h=function(t){return!(t.permission.canReadRange&&t.permission.canEditSheet)};function c(t){return s.a.createElement(u.j,{disabled:h(t)},s.a.createElement(u.b,{icon:"chart",tooltip:o()(""),onTap:n.showChartDialogFromMenu}))}function p(t){return s.a.createElement(u.e,{icon:"chart",disabled:h(t),text:o()(""),onTap:n.showChartDialogFromMenu})}function f(t){return s.a.createElement(u.i,{disabled:h(t)},s.a.createElement(u.b,{icon:"chart",tooltip:o()(""),onTap:n.showChartDialogFromMenu}),s.a.createElement("br",null),s.a.createElement("span",null,o()("")))}e.a=function(t){var e;return n=t,{singleTool:c,doubleTool:f,tabList:(e={},e[l.a.insert]=p,e)}}},117:function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},1170:function(t,e,i){"use strict";var n=i(1171),r=i.n(n);e.a={"en-US":r.a}},1171:function(t,e){t.exports={"":"Column","":"Stacked Column","% ":"100% Stacked Column","":"Bar","":"Stacked Bar","% ":"100% Stacked Bar","":"Line","":"Stacked Line","% ":"100% Stacked Line","":"Area","":"Stacked Area","% ":"100% Stacked Area","":"Pie","":"Doughnut","":"Scatter","":"Bubble","":"Stock","":"Gauge","":"Data and Chart","":"Chart property","":"Edit Chart","":"Save as Image","":"Delete Chart","":"Insert Chart","":"Edit Chart","":"Confirm","":"Cancel","%1 %2 ":"Use sheet %1 column %2 as","%1 %2 ":"Use sheet %1 row %2 as","":"Range is too complex to display","":"Data range","/":"Switch row/column","":"Chart type"," ()":"Chart title (Optional)","32":"32 characters at most","":"legend","%s":"%s serial name","%s":"%s category name","":"Shimo Chart","":"Chart","":"Line with Markers","":"Stacked Line with Markers"," % ":"100% Stacked Line with Markers","":"Right","":"Left","":"Top","":"Bottom","":"None","":"Title and axis","":"Chart title","100":"Enter up to 100 characters","":"Horizontal axis title","50":"Enter up to 50 characters","":"Vertical axis title","":"Custom vertical axis range","":"Max","":"Min","":"Reset","":"Reference line","":"Data labels","":"Value axis gridline","":"Category axis gridline","":"Data range contains locked invisible cells"," / ":"Switch rows / columns"}},118:function(t,e,i){var n=i(19);t.exports=function(t){return n(this,t).get(t)}},119:function(t,e,i){var n=i(19);t.exports=function(t){return n(this,t).has(t)}},12:function(t,e){var i=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}},120:function(t,e,i){var n=i(19);t.exports=function(t,e){return n(this,t).set(t,e),this}},121:function(t,e,i){var n=i(43),r=i(50),o=i(124),a=i(125),s=i(37),l=i(3),u=i(36),h=i(126),c=2,p="[object Arguments]",f="[object Array]",_="[object Object]",d=Object.prototype.hasOwnProperty;t.exports=function(t,e,i,g,y,m){var v=l(t),b=l(e),S=f,C=f;v||(S=(S=s(t))==p?_:S),b||(C=(C=s(e))==p?_:C);var x=S==_&&!u(t),T=C==_&&!u(e),w=S==C;if(w&&!x)return m||(m=new n),v||h(t)?r(t,e,i,g,y,m):o(t,e,S,i,g,y,m);if(!(y&c)){var P=x&&d.call(t,"__wrapped__"),A=T&&d.call(e,"__wrapped__");if(P||A){var F=P?t.value():t,O=A?e.value():e;return m||(m=new n),i(F,O,g,y,m)}}return!!w&&(m||(m=new n),a(t,e,i,g,y,m))}},122:function(t,e){var i="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,i),this}},123:function(t,e){t.exports=function(t){return this.__data__.has(t)}},124:function(t,e,i){var n=i(45),r=i(70),o=i(50),a=i(46),s=i(56),l=1,u=2,h="[object Boolean]",c="[object Date]",p="[object Error]",f="[object Map]",_="[object Number]",d="[object RegExp]",g="[object Set]",y="[object String]",m="[object Symbol]",v="[object ArrayBuffer]",b="[object DataView]",S=n?n.prototype:void 0,C=S?S.valueOf:void 0;t.exports=function(t,e,i,n,S,x,T){switch(i){case b:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case v:return!(t.byteLength!=e.byteLength||!n(new r(t),new r(e)));case h:case c:return+t==+e;case p:return t.name==e.name&&t.message==e.message;case _:return t!=+t?e!=+e:t==+e;case d:case y:return t==e+"";case f:var w=a;case g:var P=x&u;if(w||(w=s),t.size!=e.size&&!P)return!1;var A=T.get(t);return A?A==e:(x|=l,T.set(t,e),o(w(t),w(e),n,S,x,T));case m:if(C)return C.call(t)==C.call(e)}return!1}},125:function(t,e,i){var n=i(39),r=i(10),o=2;t.exports=function(t,e,i,a,s,l){var u=s&o,h=r(t),c=h.length;if(c!=r(e).length&&!u)return!1;for(var p=c;p--;){var f=h[p];if(!(u?f in e:n(e,f)))return!1}var _=l.get(t);if(_)return _==e;var d=!0;l.set(t,e);for(var g=u;++p<c;){var y=t[f=h[p]],m=e[f];if(a)var v=u?a(m,y,f,e,t,l):a(y,m,f,t,e,l);if(!(void 0===v?y===m||i(y,m,a,s,l):v)){d=!1;break}g||(g="constructor"==f)}if(d&&!g){var b=t.constructor,S=e.constructor;b!=S&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof S&&S instanceof S)&&(d=!1)}return l.delete(t),d}},126:function(t,e,i){var n=i(12),r=i(9),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var a=Object.prototype.toString;t.exports=function(t){return r(t)&&n(t.length)&&!!o[a.call(t)]}},127:function(t,e){t.exports=function(t){return null==t}},13:function(t,e,i){"use strict";e.e=function(t){var e=document.createEvent("Event");e.initEvent("click",!0,!0),t.dispatchEvent(e)},e.c=function(t){return/^http:\/\//.test(t)},i.d(e,"b",function(){return n}),i.d(e,"a",function(){return r}),i.d(e,"d",function(){return o});var n="ActiveXObject"in window,r=window.navigator.userAgent.indexOf("Edge")>-1,o=window.navigator.userAgent.indexOf("Windows")>-1},130:function(t,e){t.exports=function(t,e,i,n){var r=-1,o=t.length;for(n&&o&&(i=t[++r]);++r<o;)i=e(i,t[r],r,t);return i}},132:function(t,e){t.exports=function(t,e,i){switch(i.length){case 0:return t.call(e);case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2])}return t.apply(e,i)}},138:function(t,e,i){var n=i(70);t.exports=function(t){var e=new t.constructor(t.byteLength);return new n(e).set(new n(t)),e}},14:function(t,e,i){var n=i(6),r="[object Function]",o="[object GeneratorFunction]",a=Object.prototype.toString;t.exports=function(t){var e=n(t)?a.call(t):"";return e==r||e==o}},143:function(t,e,i){var n=i(164);t.exports=function(t){return null==t?"":n(t)}},144:function(t,e,i){var n=i(6),r=i(185),o=i(48),a="Expected a function",s=Math.max,l=Math.min;t.exports=function(t,e,i){var u,h,c,p,f,_=0,d=0,g=!1,y=!1,m=!0;if("function"!=typeof t)throw new TypeError(a);function v(e){var i=u,n=h;return u=h=void 0,d=e,p=t.apply(n,i)}function b(t){var i=t-_;return!_||i>=e||i<0||y&&t-d>=c}function S(){var t=r();if(b(t))return C(t);f=setTimeout(S,function(t){var i=e-(t-_);return y?l(i,c-(t-d)):i}(t))}function C(t){return clearTimeout(f),f=void 0,m&&u?v(t):(u=h=void 0,p)}function x(){var t=r(),i=b(t);if(u=arguments,h=this,_=t,i){if(void 0===f)return function(t){return d=t,f=setTimeout(S,e),g?v(t):p}(_);if(y)return clearTimeout(f),f=setTimeout(S,e),v(_)}return void 0===f&&(f=setTimeout(S,e)),p}return e=o(e)||0,n(i)&&(g=!!i.leading,c=(y="maxWait"in i)?s(o(i.maxWait)||0,e):c,m="trailing"in i?!!i.trailing:m),x.cancel=function(){void 0!==f&&clearTimeout(f),_=d=0,u=h=f=void 0},x.flush=function(){return void 0===f?p:C(r())},x}},145:function(t,e,i){var n=i(186)();t.exports=n},146:function(t,e){t.exports=function(t){return t}},147:function(t,e,i){var n=i(51),r=i(63),o=i(166),a=i(11),s=i(28),l=i(10),u=Object.prototype,h=u.hasOwnProperty,c=!u.propertyIsEnumerable.call({valueOf:1},"valueOf"),p=o(function(t,e){if(c||s(e)||a(e))r(e,l(e),t);else for(var i in e)h.call(e,i)&&n(t,i,e[i])});t.exports=p},148:function(t,e,i){var n=i(29),r=i(11),o=i(23),a=i(6);t.exports=function(t,e,i){if(!a(i))return!1;var s=typeof e;return!!("number"==s?r(i)&&o(e,i.length):"string"==s&&e in i)&&n(i[e],t)}},149:function(t,e,i){"use strict";var n=i(150),r=i(151),o=i(152);t.exports=function(){function t(t,e,i,n,a,s){s!==o&&r(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function e(){return t}t.isRequired=t;var i={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return i.checkPropTypes=n,i.PropTypes=i,i}},15:function(t,e,i){var n=i(9),r="[object Symbol]",o=Object.prototype.toString;t.exports=function(t){return"symbol"==typeof t||n(t)&&o.call(t)==r}},150:function(t,e,i){"use strict";function n(t){return function(){return t}}var r=function(){};r.thatReturns=n,r.thatReturnsFalse=n(!1),r.thatReturnsTrue=n(!0),r.thatReturnsNull=n(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(t){return t},t.exports=r},151:function(t,e,i){"use strict";var n=function(t){};t.exports=function(t,e,i,r,o,a,s,l){if(n(e),!t){var u;if(void 0===e)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var h=[i,r,o,a,s,l],c=0;(u=new Error(e.replace(/%s/g,function(){return h[c++]}))).name="Invariant Violation"}throw u.framesToPop=1,u}}},152:function(t,e,i){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},153:function(t,e,i){"use strict";var n=i(0),r=i.n(n),o=i(72),a=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onOpen=function(t){e.props.onOpen&&e.props.onOpen(),t&&(t.markAsOld(),e.forceUpdate())},e}return a(e,t),e.prototype.render=function(){var t=function(t){return t?(t instanceof Array?t:[t]).find(function(t){return t.visible}):void 0}(this.props.feature),e=t&&t.tooltip;return r.a.createElement(o.a,{head:r.a.createElement("span",{className:"tabMenuHead"},this.props.tabName(),e),customClass:"tabMenu",disabled:this.props.disabled,onOpen:this.onOpen.bind(this,t)},this.props.children)},e}(r.a.Component);e.a=s},154:function(t,e,i){"use strict";e.a=function(t){return r.a.createElement(o.a,{head:r.a.cloneElement(t.head,{className:"dropMenuHead indicator "+(t.head.props.className||"")}),disabled:t.disabled,customClass:t.customClass,onClose:t.onClose,onOpen:t.onOpen},t.children)};var n=i(0),r=i.n(n),o=i(72)},155:function(t,e,i){"use strict";var n=i(0),r=i.n(n),o=i(13),a=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),s=function(t){function e(e){var i=t.call(this,e)||this;return i.showSubMenu=function(){i.setState({showSubMenu:!0})},i.hideSubMenu=function(t){i.notReallyLeaveMe(t)||i.setState({showSubMenu:!1,style:null})},i.adjustStyle=function(){var t=window.innerHeight,e=window.innerWidth,n=i.refs.itemDom,r=i.refs.contentDom.getBoundingClientRect(),o=r.right,a=r.height,s=n.getBoundingClientRect(),l=s.bottom,u=s.left,h=s.right,c=s.top,p=i.getRefPosition(),f=p.left,_=p.top,d={position:"fixed",transform:"translateX(0)",left:h-1-f,top:c-_},g=l-78,y=t-l-30;a>y&&(a<g||y/t<.25?(d.maxHeight=g,d.top=l-Math.min(a,g)-_,a>g&&(d.overflowY="auto")):(d.maxHeight=y,d.overflowY="auto")),e-o<50&&(d.left=u-f,d.transform="translateX(-100%)"),i.setState({style:d})},i.state={showSubMenu:!1,style:null},i}return a(e,t),e.prototype.componentDidUpdate=function(t,e){this.state.showSubMenu&&!e.showSubMenu&&this.adjustStyle()},e.prototype.render=function(){return r.a.createElement("div",{ref:"containerDom",className:"menu--submenu",onMouseLeave:this.hideSubMenu},r.a.createElement("div",{ref:"itemDom",className:"menuItem "+(this.props.disabled?"disabled":""),onMouseEnter:this.showSubMenu},void 0!==this.props.icon&&r.a.createElement("span",{className:"menuItem--icon "+(this.props.icon?"icon--"+this.props.icon:"")}),r.a.createElement("span",{className:"menuItem--text"},this.props.text),r.a.createElement("span",{className:"menuItem--placer"}),r.a.createElement("span",{className:"menuItem--arrow"})),this.state.showSubMenu&&r.a.createElement("div",{ref:"contentDom",className:"menu--content menu--content__submenu",style:this.state.style},this.props.children))},e.prototype.getRefPosition=function(){if(o.b)return{left:0,top:0};for(var t=this.refs.containerDom;t.parentElement;){var e=getComputedStyle(t);if("static"!==e.position&&"none"!==e.transform)break;t=t.parentElement}var i=t.getBoundingClientRect(),n=i.left;return{top:i.top,left:n}},e.prototype.notReallyLeaveMe=function(t){var e=t.pageX,i=t.pageY,n=this.refs.itemDom.getBoundingClientRect(),r=n.left,o=n.top,a=n.right,s=n.bottom;return e>r&&e<a&&i>o&&i<s},e}(r.a.Component);e.a=s},156:function(t,e,i){"use strict";var n=i(0),r=i.n(n),o=i(73),a=i(74),s=i(13),l=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.render=function(){var t=this,e="fake"===this.props.disabled?"fakeDisabled":this.props.disabled?"disabled":"",i=this.props.customClass||"";return r.a.createElement(o.a.Consumer,null,function(n){return r.a.createElement("div",{className:"menuItem tooltip--docker "+e+" "+i+" "+t.props.className,onClick:function(){return t.onClick(n)}},void 0!==t.props.checked&&r.a.createElement("span",{className:"menuItem--check "+(t.props.checked?"menuItem--check__checked":"")}),void 0!==t.props.icon&&t.getIcon(t.props.icon),t.props.text&&r.a.createElement("span",{className:"menuItem--text"},t.props.text),t.props.text&&r.a.createElement("span",{className:"menuItem--placer"}),t.props.children)})},e.prototype.onClick=function(t){!this.props.disabled&&this.props.onTap&&this.props.onTap(),setTimeout(function(){return t.closeMenu()})},e.prototype.getIcon=function(t){return Object(s.c)(t)?r.a.createElement("span",{className:"menuItem--icon",style:Object(a.a)(t)}):r.a.createElement("span",{className:"menuItem--icon "+(t?"icon--"+t:"")})},e}(r.a.Component);e.a=u},157:function(t,e,i){"use strict";e.a=function(){return r.a.createElement("div",{className:"menu--divider"})};var n=i(0),r=i.n(n)},158:function(t,e,i){"use strict";var n=i(0),r=i.n(n),o=i(13),a=i(74),s=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.onTap=function(){e.props.onTap&&e.props.onTap()},e}return s(e,t),e.prototype.render=function(){var t="toolBar--iconBtn "+(this.props.disabled?"disabled":"")+" "+(this.props.selected?"selected":"")+" indicator";return this.props.children?r.a.createElement("span",{className:t+" tooltip--docker",onClick:this.onTap},this.getIcon(this.props.icon)):this.props.tooltip?r.a.createElement("span",{className:t,"data-tooltip":this.props.tooltip,onClick:this.onTap},this.getIcon(this.props.icon)):r.a.createElement("span",{className:t,onClick:this.onTap},this.getIcon(this.props.icon))},e.prototype.getIcon=function(t){return Object(o.c)(t)?r.a.createElement("span",{style:Object(a.a)(t)},this.props.children):r.a.createElement("span",{className:"toolBar--icon icon--"+t},this.props.children)},e}(r.a.Component);e.a=l},159:function(t,e,i){"use strict";e.a=function(t){return t.option?r.a.createElement("span",{className:"tooltip tooltip__"+(t.direction||"down")},r.a.createElement("span",null,t.option),t.detail&&r.a.createElement("br",null),t.detail&&r.a.createElement("span",null,t.detail)):null};var n=i(0),r=i.n(n)},16:function(t,e,i){var n=i(99),r=i(100),o=i(101),a=i(102),s=i(103);function l(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,t.exports=l},160:function(t,e,i){"use strict";e.d=function(t){return r.a.createElement("span",{className:u(t,"toolBar--tool")},t.children)},i.d(e,"c",function(){return h}),e.a=function(t){return r.a.createElement("span",{className:u(t,"toolBar--iconDropTool indicator "+(t.selected?"fakeIndicator":""))},t.children)},e.b=function(t){return r.a.createElement("span",{className:u(t,"toolBar--tool toolBar--tool__oneline")},t.children)},e.e=function(t){return r.a.createElement("span",{className:u(t,"toolBar--tool toolBar--tool__twolines")},t.children)};var n=i(0),r=i.n(n),o=i(13),a=i(22),s=i.n(a),l=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();function u(t,e){var i,n=t.disabled,r=t.customClass;return s()(((i={})[e]=!0,i[r||""]=r,i.disabled=n,i))}var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delegateClick=function(t){var i=e.refs.textTool,n=i.lastElementChild;if(t.target===i||t.target===n){var r=i.querySelector(".toolBar--icon");setTimeout(function(){return Object(o.e)(r)})}},e}return l(e,t),e.prototype.render=function(){return r.a.createElement("span",{ref:"textTool",className:u(this.props,"toolBar--tool toolBar--textTool"),onClick:this.delegateClick},this.props.children)},e}(r.a.Component)},163:function(t,e,i){var n=i(172)(i(10));t.exports=n},164:function(t,e,i){var n=i(45),r=i(15),o=1/0,a=n?n.prototype:void 0,s=a?a.toString:void 0;t.exports=function(t){if("string"==typeof t)return t;if(r(t))return s?s.call(t):"";var e=t+"";return"0"==e&&1/t==-o?"-0":e}},165:function(t,e){t.exports=function(t,e){for(var i=-1,n=t.length;++i<n&&!1!==e(t[i],i,t););return t}},166:function(t,e,i){var n=i(148),r=i(71);t.exports=function(t){return r(function(e,i){var r=-1,o=i.length,a=o>1?i[o-1]:void 0,s=o>2?i[2]:void 0;for(a=t.length>3&&"function"==typeof a?(o--,a):void 0,s&&n(i[0],i[1],s)&&(a=o<3?void 0:a,o=1),e=Object(e);++r<o;){var l=i[r];l&&t(e,l,r,a)}return e})}},169:function(t,e,i){var n=i(170),r=i(171),o=i(93);t.exports=function(t){var e=r(t);return 1==e.length&&e[0][2]?o(e[0][0],e[0][1]):function(i){return i===t||n(i,t,e)}}},17:function(t,e,i){var n=i(29);t.exports=function(t,e){for(var i=t.length;i--;)if(n(t[i][0],e))return i;return-1}},170:function(t,e,i){var n=i(43),r=i(52),o=1,a=2;t.exports=function(t,e,i,s){var l=i.length,u=l,h=!s;if(null==t)return!u;for(t=Object(t);l--;){var c=i[l];if(h&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++l<u;){var p=(c=i[l])[0],f=t[p],_=c[1];if(h&&c[2]){if(void 0===f&&!(p in t))return!1}else{var d=new n;if(s)var g=s(f,_,p,t,e,d);if(!(void 0===g?r(_,f,s,o|a,d):g))return!1}}return!0}},171:function(t,e,i){var n=i(92),r=i(163);t.exports=function(t){for(var e=r(t),i=e.length;i--;)e[i][2]=n(e[i][1]);return e}},172:function(t,e,i){var n=i(173),r=i(37),o=i(46),a=i(174),s="[object Map]",l="[object Set]";t.exports=function(t){return function(e){var i=r(e);return i==s?o(e):i==l?a(e):n(e,t(e))}}},173:function(t,e,i){var n=i(59);t.exports=function(t,e){return n(e,function(e){return[e,t[e]]})}},174:function(t,e){t.exports=function(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=[t,t]}),i}},175:function(t,e,i){var n=i(52),r=i(176),o=i(179),a=i(31),s=i(92),l=i(93),u=i(24),h=1,c=2;t.exports=function(t,e){return a(t)&&s(e)?l(u(t),e):function(i){var a=r(i,t);return void 0===a&&a===e?o(i,t):n(e,a,void 0,h|c)}}},176:function(t,e,i){var n=i(81);t.exports=function(t,e,i){var r=null==t?void 0:n(t,e);return void 0===r?i:r}},177:function(t,e,i){var n=i(178),r=i(143),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,a=/\\(\\)?/g,s=n(function(t){var e=[];return r(t).replace(o,function(t,i,n,r){e.push(n?r.replace(a,"$1"):i||t)}),e});t.exports=s},178:function(t,e,i){var n=i(32),r="Expected a function";function o(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(r);var i=function(){var n=arguments,r=e?e.apply(this,n):n[0],o=i.cache;if(o.has(r))return o.get(r);var a=t.apply(this,n);return i.cache=o.set(r,a),a};return i.cache=new(o.Cache||n),i}o.Cache=n,t.exports=o},179:function(t,e,i){var n=i(180),r=i(181);t.exports=function(t,e){return null!=t&&r(t,e,n)}},18:function(t,e,i){var n=i(8)(Object,"create");t.exports=n},180:function(t,e){t.exports=function(t,e){return e in Object(t)}},181:function(t,e,i){var n=i(82),r=i(33),o=i(3),a=i(23),s=i(31),l=i(12),u=i(34),h=i(24);t.exports=function(t,e,i){for(var c,p=-1,f=(e=s(e,t)?[e]:n(e)).length;++p<f;){var _=h(e[p]);if(!(c=null!=t&&i(t,_)))break;t=t[_]}return c||!!(f=t?t.length:0)&&l(f)&&a(_,f)&&(o(t)||u(t)||r(t))}},182:function(t,e,i){var n=i(47),r=i(183),o=i(31),a=i(24);t.exports=function(t){return o(t)?n(a(t)):r(t)}},183:function(t,e,i){var n=i(81);t.exports=function(t){return function(e){return n(e,t)}}},184:function(t,e){t.exports=function(t,e){for(var i=-1,n=e.length,r=t.length;++i<n;)t[r+i]=e[i];return t}},185:function(t,e){var i=Date.now;t.exports=i},186:function(t,e){t.exports=function(t){return function(e,i,n){for(var r=-1,o=Object(e),a=n(e),s=a.length;s--;){var l=a[t?s:++r];if(!1===i(o[l],l,o))break}return e}}},19:function(t,e,i){var n=i(117);t.exports=function(t,e){var i=t.__data__;return n(e)?i["string"==typeof e?"string":"hash"]:i.map}},2:function(module,exports,__webpack_require__){"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},__assign=function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},__awaiter=function(t,e,i,n){return new(i||(i=Promise))(function(r,o){function a(t){try{l(n.next(t))}catch(t){o(t)}}function s(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(a,s)}l((n=n.apply(t,e||[])).next())})},__generator=function(t,e){var i,n,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},_this=void 0;Object.defineProperty(exports,"__esModule",{value:!0});var locale_1=__webpack_require__(66),interweave=function(t,e){return t.map(function(i,n){return n===t.length-1?i:""+i+e[n]}).join("")},currentLocale="zh-CN",fallbackLocale="zh-CN",localeCache={},fetchLocaleSync,fetchLocale=function(t){throw new Error("'fetchLocale' is not provided, see: 's18n.configure()'")},getLocale=function(){return currentLocale},configure=function(t){if(t.fetchLocale){if("function"!=typeof t.fetchLocale)throw new Error("fetchLocale should be an async function resolving with locale resource");fetchLocale=t.fetchLocale}else{if(!t.fetchLocaleSync)throw new Error("Requiring at least one parameter: fetchLocale or fetchLocaleSync");fetchLocaleSync=t.fetchLocaleSync}},addLocaleResource=function(t,e){if(!locale_1.isValidLocaleResource(e))throw new Error("fetched locale resource is invalid");localeCache[t]=__assign({},localeCache[t]||{},e)},updateLocaleResource=function(t,e){return __awaiter(_this,void 0,void 0,function(){var i;return __generator(this,function(n){switch(n.label){case 0:if(!e&&localeCache[t])return[3,2];if(!fetchLocale)throw new Error("'fetchLocale' is not provided, see: 's18n.configure()'");return[4,fetchLocale(t)];case 1:i=n.sent(),addLocaleResource(t,i),n.label=2;case 2:return[2]}})})},setLocaleSync=function(t){if("string"!=typeof t)throw new Error("'locale' is required");if(!fetchLocaleSync)throw new Error("'fetchLocaleSync' is not provided, see: 's18n.configure()'");var e=fetchLocaleSync(t);addLocaleResource(t,e),currentLocale=t},setLocaleAsync=function(t,e){return __awaiter(_this,void 0,void 0,function(){return __generator(this,function(i){switch(i.label){case 0:if("string"!=typeof t)throw new Error("'locale' is required");return[4,updateLocaleResource(t)];case 1:return i.sent(),currentLocale=t,"string"==typeof e&&(updateLocaleResource(e),fallbackLocale=e),[2]}})})},getTextResult=function(t,e){return e&&e[t]},PLACEHOLDER_RE=/%(s|\d)/g,getInterpolateResult=function getInterpolateResult(parts,values,resource){try{if(!resource)return;var key=locale_1.rawTextToKey({type:"interpolated",textParts:parts}),translation=resource[key];if(!translation)return;var valueMap_1={},i_1=0;key.replace(PLACEHOLDER_RE,function(t){return valueMap_1[t]=values[i_1],i_1+=1,t});var interpolate=function(t,e){return t.replace(PLACEHOLDER_RE,function(i){return null!==e[i]?String(e[i]):(console.warn("[s18n] interpolation failed:",{str:t,valueMap:e}),i)})};if("string"==typeof translation)return interpolate(translation,valueMap_1);if("object"===(void 0===translation?"undefined":_typeof(translation))){for(var conditions=Object.keys(translation),index=0;index<conditions.length;index++){var conditionTemplate=conditions[index],conditionInterpolated=interpolate(conditionTemplate,valueMap_1),passed=eval(conditionInterpolated);if(passed)return interpolate(translation[conditionTemplate],valueMap_1)}return}return void console.warn("[s18n] Unexpected value: "+JSON.stringify(translation))}catch(t){var args={parts:parts,values:values,resource:resource};return console.error("[s18n] error when translating: ",args),void console.error(t)}},s18n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){var i=t[0],n=getTextResult(i,localeCache[currentLocale]);if("string"==typeof n)return n;var r=getTextResult(i,localeCache[fallbackLocale]);return"string"==typeof r?r:i}var o=t[0],a=t.slice(1);return getInterpolateResult(o,a,localeCache[currentLocale])||getInterpolateResult(o,a,localeCache[fallbackLocale])||interweave(o,a)};s18n.configure=configure,s18n.addLocaleResource=addLocaleResource,s18n.setLocaleAsync=setLocaleAsync,s18n.setLocaleSync=setLocaleSync,s18n.getLocale=getLocale,module.exports=s18n,exports.default=s18n},20:function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},207:function(t,e,i){var n=i(272);t.exports=function(t){return n(t,!0,!0)}},208:function(t,e){var i=Object.getOwnPropertySymbols;function n(t){return i(Object(t))}i||(n=function(){return[]}),t.exports=n},210:function(t,e,i){"use strict";e.a={edit:"edit",insert:"insert",format:"format",data:"data",view:"view",help:"help"}},211:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.genGuid=function(t){var e=17,i=[];for(;e-=1;)i.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[parseInt(62*Math.random())]);var n=i.join("");if(t)return t+"-"+n;return n},e.nodeText=function(t){return t.innerText||t.textContent||t.nodeValue||""},e.getCookie=function(t){var e=("; "+document.cookie).split("; "+t+"=");if(2===e.length)return e.pop().split(";").shift()},e.isNumeric=r,e.getFractionLen=function(t){var e=String(t),i=0;!isNaN(Number(t))&&e.indexOf(".")>-1&&(i=e.split(".")[1].length);return i},e.isBigNumber=function(t){if(r(t)&&t.toString().trim().split(".")[0].length>15)return!0;return!1},e.isValidNumber=function(t){if(r(t)&&t.toString().length<=16)return!0;return!1},e.strToNum=function(t){if(r(t)&&t.toString().length<=16)return Number(t,10);return t},e.translateNumber=function(t){var e,i,r,o,a,s,l,u,h,c,p,f,_,d;if(o=(0,n.default)(""),e=["",(0,n.default)(""),(0,n.default)(""),(0,n.default)(""),(0,n.default)(""),(0,n.default)(""),(0,n.default)(""),(0,n.default)(""),(0,n.default)(""),(0,n.default)("")],r=["",(0,n.default)(""),(0,n.default)(""),(0,n.default)("")],i=["",(0,n.default)(""),(0,n.default)(""),(0,n.default)("")],""===t)return"";if(""===(t=t.replace(/^0+/g,"")))return o;for(_="",l=!0,c=!1,u=h=0,f=t.length;f>=0?h<f:h>f;u=f>=0?++h:--h)p=t.length-1-u,a=parseInt(t[u]),s=(p-(d=p%r.length))/r.length,0!==a&&(c&&(_+=o),(1!==a||1!==d||!l||0===s&&c)&&(_+=e[a]),_+=r[d]),l=l&&0===a,0!==d||l||(_+=i[s]),c=0===a&&(0!==d||l),0===d&&(l=!0);return _};var n=function(t){return t&&t.__esModule?t:{default:t}}(i(2));function r(t){var e=t&&t.toString();return!/^0+\d+$/.test(e)&&e-parseFloat(e)+1>=0}},217:function(t,e,i){(function(t){var n=i(233),r=i(5),o={function:!0,object:!0},a=o[typeof e]&&e&&!e.nodeType?e:void 0,s=o[typeof t]&&t&&!t.nodeType?t:void 0,l=(s&&s.exports===a?a:void 0)?r.Buffer:void 0,u=l?function(t){return t instanceof l}:n(!1);t.exports=u}).call(e,i(30)(t))},218:function(t,e,i){var n=i(165),r=i(97),o=i(49),a=i(3);t.exports=function(t,e){return(a(t)?n:r)(t,o(e,3))}},219:function(t,e,i){var n=i(145),r=i(10);t.exports=function(t,e){return t&&n(t,e,r)}},22:function(t,e,i){var n;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var i={}.hasOwnProperty;function r(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(n){var o=typeof n;if("string"===o||"number"===o)t.push(n);else if(Array.isArray(n)&&n.length){var a=r.apply(null,n);a&&t.push(a)}else if("object"===o)for(var s in n)i.call(n,s)&&n[s]&&t.push(s)}}return t.join(" ")}void 0!==t&&t.exports?(r.default=r,t.exports=r):void 0===(n=function(){return r}.apply(e,[]))||(t.exports=n)}()},220:function(t,e,i){var n=i(11);t.exports=function(t,e){return function(i,r){if(null==i)return i;if(!n(i))return t(i,r);for(var o=i.length,a=e?o:-1,s=Object(i);(e?a--:++a<o)&&!1!==r(s[a],a,s););return i}}},221:function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.isRetina=function(){return window.devicePixelRatio>=2},e.isDingTalk=function(){return/dingtalk/i.test(i)},e.isDingtalk=function(){return!!i.match(/mobile.*dingtalk/i)},e.isDingtalkPc=function(){return/dingTalk\([^\\)]+\)/i.test(window.navigator.userAgent)},e.isWechatPc=n,e.isWechat=function(){return!!/micromessenger/.test(i)&&!n()},e.isMobile=function(){return!n()&&!!i.match(/(iphone|ipod|ipad|android|windows phone|micromessenger)/)},e.isDingtalkPcSidebar=function(){return!!document.getElementById("dingtalk-operation-wrap")},e.isIOS=r,e.isAndroid=function(){return!!/(android)/g.test(i)},e.isAndroidApp=function(){return!!/shimo-android-app/g.test(i)},e.isIE=function(){return/MSIE|Trident/.test(window.navigator.userAgent)},e.isFireFox=function(){return!!navigator.userAgent.match(/firefox/i)},e.isSafari=function(){return-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")},e.isMac=function(){return/Mac|iPod|iPhone|iPad/.test(navigator.platform)},e.isWebIOS=function(){if(!window.cow.iOS&&r())return!0;return!1},e.isIphone6=function(){var t=!1;r()&&screen.height>568&&(t=!0);return t};var i=window.navigator.userAgent.toLowerCase();function n(){return!!/micromessenger.*?windowswechat/.test(i)}function r(){return!!/(ipad|iphone|ipod)/g.test(i)}},226:function(t,e,i){"use strict";i.d(e,"a",function(){return n}),e.e=function(t){return t===n},e.f=function(t){return t&&"_$Option$_$Some$_"===t._tag},e.b=r,e.d=function(t,e){switch(t.kind){case"Some":return t.value;case"None":return e}},e.c=function(t){return t};var n={kind:"None"};function r(t){return{_tag:"_$Option$_$Some$_",kind:"Some",value:t}}},229:function(t,e,i){var n=i(243);t.exports=function(t,e,i){if(e!=e)return n(t,i);for(var r=i-1,o=t.length;++r<o;)if(t[r]===e)return r;return-1}},23:function(t,e){var i=9007199254740991,n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){return!!(e=null==e?i:e)&&("number"==typeof t||n.test(t))&&t>-1&&t%1==0&&t<e}},233:function(t,e){t.exports=function(t){return function(){return t}}},24:function(t,e,i){var n=i(15),r=1/0;t.exports=function(t){if("string"==typeof t||n(t))return t;var e=t+"";return"0"==e&&1/t==-r?"-0":e}},243:function(t,e){t.exports=function(t,e,i){for(var n=t.length,r=e+(i?0:-1);i?r--:++r<n;){var o=t[r];if(o!=o)return r}return-1}},244:function(t,e,i){var n=i(52);t.exports=function(t,e){return n(t,e)}},267:function(t,e,i){var n=i(292),r=i(58),o=i(23),a=i(28),s=Object.prototype.hasOwnProperty;t.exports=function(t){for(var e=-1,i=a(t),l=n(t),u=l.length,h=r(t),c=!!h,p=h||[],f=p.length;++e<u;){var _=l[e];c&&("length"==_||o(_,f))||"constructor"==_&&(i||!s.call(t,_))||p.push(_)}return p}},272:function(t,e,i){var n=i(43),r=i(165),o=i(51),a=i(273),s=i(274),l=i(275),u=i(276),h=i(277),c=i(37),p=i(279),f=i(280),_=i(289),d=i(3),g=i(217),y=i(36),m=i(6),v=i(10),b="[object Arguments]",S="[object Function]",C="[object GeneratorFunction]",x="[object Object]",T={};T[b]=T["[object Array]"]=T["[object ArrayBuffer]"]=T["[object DataView]"]=T["[object Boolean]"]=T["[object Date]"]=T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Map]"]=T["[object Number]"]=T[x]=T["[object RegExp]"]=T["[object Set]"]=T["[object String]"]=T["[object Symbol]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T["[object Error]"]=T[S]=T["[object WeakMap]"]=!1,t.exports=function t(e,i,w,P,A,F,O){var M;if(P&&(M=F?P(e,A,F,O):P(e)),void 0!==M)return M;if(!m(e))return e;var D=d(e);if(D){if(M=p(e),!i)return l(e,M)}else{var L=c(e),I=L==S||L==C;if(g(e))return s(e,i);if(L==x||L==b||I&&!F){if(y(e))return F?e:{};if(M=_(I?{}:e),!i)return u(e,a(M,e))}else{if(!T[L])return F?e:{};M=f(e,L,t,i)}}O||(O=new n);var k=O.get(e);if(k)return k;if(O.set(e,M),!D)var R=w?h(e):v(e);return r(R||e,function(n,r){R&&(n=e[r=n]),o(M,r,t(n,i,w,P,r,e,O))}),M}},273:function(t,e,i){var n=i(63),r=i(10);t.exports=function(t,e){return t&&n(e,r(e),t)}},274:function(t,e){t.exports=function(t,e){if(e)return t.slice();var i=new t.constructor(t.length);return t.copy(i),i}},275:function(t,e){t.exports=function(t,e){var i=-1,n=t.length;for(e||(e=Array(n));++i<n;)e[i]=t[i];return e}},276:function(t,e,i){var n=i(63),r=i(208);t.exports=function(t,e){return n(t,r(t),e)}},277:function(t,e,i){var n=i(278),r=i(208),o=i(10);t.exports=function(t){return n(t,o,r)}},278:function(t,e,i){var n=i(184),r=i(3);t.exports=function(t,e,i){var o=e(t);return r(t)?o:n(o,i(t))}},279:function(t,e){var i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,n=t.constructor(e);return e&&"string"==typeof t[0]&&i.call(t,"index")&&(n.index=t.index,n.input=t.input),n}},28:function(t,e){var i=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||i)}},280:function(t,e,i){var n=i(138),r=i(281),o=i(282),a=i(284),s=i(285),l=i(287),u=i(288),h="[object Boolean]",c="[object Date]",p="[object Map]",f="[object Number]",_="[object RegExp]",d="[object Set]",g="[object String]",y="[object Symbol]",m="[object ArrayBuffer]",v="[object DataView]",b="[object Float32Array]",S="[object Float64Array]",C="[object Int8Array]",x="[object Int16Array]",T="[object Int32Array]",w="[object Uint8Array]",P="[object Uint8ClampedArray]",A="[object Uint16Array]",F="[object Uint32Array]";t.exports=function(t,e,i,O){var M=t.constructor;switch(e){case m:return n(t);case h:case c:return new M(+t);case v:return r(t,O);case b:case S:case C:case x:case T:case w:case P:case A:case F:return u(t,O);case p:return o(t,O,i);case f:case g:return new M(t);case _:return a(t);case d:return s(t,O,i);case y:return l(t)}}},281:function(t,e,i){var n=i(138);t.exports=function(t,e){var i=e?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.byteLength)}},282:function(t,e,i){var n=i(283),r=i(130),o=i(46);t.exports=function(t,e,i){var a=e?i(o(t),!0):o(t);return r(a,n,new t.constructor)}},283:function(t,e){t.exports=function(t,e){return t.set(e[0],e[1]),t}},284:function(t,e){var i=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,i.exec(t));return e.lastIndex=t.lastIndex,e}},285:function(t,e,i){var n=i(286),r=i(130),o=i(56);t.exports=function(t,e,i){var a=e?i(o(t),!0):o(t);return r(a,n,new t.constructor)}},286:function(t,e){t.exports=function(t,e){return t.add(e),t}},287:function(t,e,i){var n=i(45),r=n?n.prototype:void 0,o=r?r.valueOf:void 0;t.exports=function(t){return o?Object(o.call(t)):{}}},288:function(t,e,i){var n=i(138);t.exports=function(t,e){var i=e?n(t.buffer):t.buffer;return new t.constructor(i,t.byteOffset,t.length)}},289:function(t,e,i){var n=i(290),r=i(57),o=i(28);t.exports=function(t){return"function"!=typeof t.constructor||o(t)?{}:n(r(t))}},29:function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},290:function(t,e,i){var n=i(6),r=Object.create;t.exports=function(t){return n(t)?r(t):{}}},291:function(t,e,i){var n=i(145),r=i(49),o=i(267);t.exports=function(t,e){return null==t?t:n(t,r(e,3),o)}},292:function(t,e,i){var n=i(293),r=i(294),o=Object.prototype,a=n?n.enumerate:void 0,s=o.propertyIsEnumerable;function l(t){t=null==t?t:Object(t);var e=[];for(var i in t)e.push(i);return e}a&&!s.call({valueOf:1},"valueOf")&&(l=function(t){return r(a(t))}),t.exports=l},293:function(t,e,i){var n=i(5).Reflect;t.exports=n},294:function(t,e){t.exports=function(t){for(var e,i=[];!(e=t.next()).done;)i.push(e.value);return i}},3:function(t,e){var i=Array.isArray;t.exports=i},30:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},307:function(t,e){t.exports=function(t,e,i){for(var n=t.length,r=i?n:-1;i?r--:++r<n;)if(e(t[r],r,t))return r;return-1}},31:function(t,e,i){var n=i(3),r=i(15),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var i=typeof t;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=t&&!r(t))||a.test(t)||!o.test(t)||null!=e&&t in Object(e)}},311:function(t,e,i){var n=i(37),r=i(33),o=i(3),a=i(11),s=i(217),l=i(14),u=i(9),h=i(34),c=i(10),p="[object Map]",f="[object Set]",_=Object.prototype,d=_.hasOwnProperty,g=!_.propertyIsEnumerable.call({valueOf:1},"valueOf");t.exports=function(t){if(a(t)&&(o(t)||h(t)||l(t.splice)||r(t)||s(t)))return!t.length;if(u(t)){var e=n(t);if(e==p||e==f)return!t.size}for(var i in t)if(d.call(t,i))return!1;return!(g&&c(t).length)}},313:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(0),o=p(r),a=p(i(4)),s=p(i(7)),l=p(i(364)),u=p(i(367)),h=p(i(368)),c=p(i(369));function p(t){return t&&t.__esModule?t:{default:t}}var f=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return _.call(i),i.state={open:!1,selectedIndex:i.props.selectedIndex||0,isShowTip:!1,hovered:!1},i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Component),n(e,null,[{key:"propTypes",get:function(){return{menuItems:a.default.array.isRequired,className:a.default.string,wrapClassName:a.default.string,itemTpl:a.default.func,selectedTpl:a.default.func,selectedIndex:a.default.number,onTap:a.default.func,onMenuChange:a.default.func,forceTap:a.default.bool,tooltip:a.default.oneOfType([a.default.string,a.default.element]),tipClass:a.default.string,isScroll:a.default.bool,autoWidth:a.default.bool,autoHeight:a.default.bool,forceShowMenu:a.default.bool}}}]),n(e,[{key:"componentDidMount",value:function(){this._bindClick(),this.menuWrap=this.refs.menuWrap,this.menuWrapDom=s.default.findDOMNode(this.menuWrap),this.props.autoWidth&&this._setWidth(),this.props.hasOwnProperty("selectedIndex")&&this._setSelectedIndex(this.props.selectedIndex),window.addEventListener("resize",this._handleWindowResize)}},{key:"componentDidUpdate",value:function(t,e){e.open&&!this.state.open&&this.props.onClose&&this.props.onClose()}},{key:"componentWillReceiveProps",value:function(t){this.props.autoWidth&&this._setWidth(),t.hasOwnProperty("selectedIndex")&&this._setSelectedIndex(t.selectedIndex)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._handleWindowResize),this._unbindClick()}},{key:"render",value:function(){var t=this.props,e=this.state.open?"":"unactive",i=(t.wrapClassName||"")+" "+t.className+" "+e,n=!!t.forceShowMenu||this.state.open,r=void 0;return t.tooltip&&(r=o.default.createElement(u.default,{ref:"tooltip",tip:t.tooltip,isShow:this.state.isShowTip,customClass:t.tipClass})),o.default.createElement("div",{className:i,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave},o.default.createElement("div",{className:"d-menu-display-wrap",onClick:this._onToggleMenu},t.selectedTpl(this.state.selectedIndex,t.menuItems[this.state.selectedIndex],t.displayKey,t.valKey),this.state.isShowTip&&r),o.default.createElement("div",{className:"menu-wrap",ref:"menuWrap"},n&&o.default.createElement(l.default,{menuItems:t.menuItems,displayKey:t.displayKey,valKey:t.valKey,selectedIndex:this.state.selectedIndex,itemTpl:t.itemTpl,onItemTap:this._onItemTap})),n&&t.hasMask&&o.default.createElement("div",{className:"d-menu-mask",onClick:this._onMenuMaskTap}))}},{key:"handlerResize",value:function(){this._setSubmenuHeight()}},{key:"componentClick",value:function(){this.close()}},{key:"close",value:function(){this.state.open&&this.setState({open:!1})}},{key:"_setWidth",value:function(){s.default.findDOMNode(this).style.width=this.menuWrapDom.offsetWidth+"px"}},{key:"_setSubmenuHeight",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.props.autoHeight,n=this.state.open;if(i&&n){var r=function(){var e=window.innerHeight-t.menuWrapDom.getBoundingClientRect().top-20,i="none";t.menuWrapDom.scrollHeight>e&&(i=e+"px"),t.menuWrapDom.style.maxHeight=i};this.timer&&clearTimeout(this.timer),e?r():this.timer=setTimeout(r,200)}}},{key:"_setSelectedIndex",value:function(t){this.setState({selectedIndex:t})}},{key:"_bindClick",value:function(){h.default.on(document,"mouseup",this._checkClick),h.default.on(document,"touchend",this._checkClick)}},{key:"_unbindClick",value:function(){h.default.off(document,"mouseup",this._checkClick),h.default.off(document,"touchend",this._checkClick)}}]),e}(),_=function(){var t=this;this._onToggleMenu=function(){t.setState({open:!t.state.open,isShowTip:t.state.open},function(){return t._setSubmenuHeight(!0)}),t.props.onTap&&t.props.onTap()},this._onItemTap=function(e,i,n){var r=t.props;r.onMenuChange&&(t.state.selectedIndex!==i||r.forceTap)&&r.onMenuChange(e,i,n),t.setState({selectedIndex:i,open:!!r.keepOpen})},this._onMenuMaskTap=function(){t.setState({open:!1})},this.timer=null,this._handleWindowResize=function(){t._setSubmenuHeight()},this._handleMouseEnter=function(){t.setState({isShowTip:!t.state.open,hovered:!0})},this._handleMouseLeave=function(){t.setState({isShowTip:!1,hovered:!1})},this._checkClick=function(e){var i=s.default.findDOMNode(t),n=e.target;n!=i&&!c.default.isDescendant(i,n)&&document.documentElement.contains(n)&&t.componentClick&&t.componentClick(e,i)}};e.default=f,f.defaultProps={className:"d-menu-wrap",hasMask:!1,autoWidth:!1,autoHeight:!1,tooltip:"",tipClass:"",displayKey:"text",valKey:"value",itemTpl:function(t,e,i,n,r){var a=e[n],s=e[r];return o.default.createElement("div",{"data-val":s},a)},selectedTpl:function(t,e,i,n){var r=e[i];return o.default.createElement("div",null,e[r])}},t.exports=e.default},32:function(t,e,i){var n=i(109),r=i(116),o=i(118),a=i(119),s=i(120);function l(t){var e=-1,i=t?t.length:0;for(this.clear();++e<i;){var n=t[e];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=r,l.prototype.get=o,l.prototype.has=a,l.prototype.set=s,t.exports=l},33:function(t,e,i){var n=i(61),r="[object Arguments]",o=Object.prototype,a=o.hasOwnProperty,s=o.toString,l=o.propertyIsEnumerable;t.exports=function(t){return n(t)&&a.call(t,"callee")&&(!l.call(t,"callee")||s.call(t)==r)}},34:function(t,e,i){var n=i(3),r=i(9),o="[object String]",a=Object.prototype.toString;t.exports=function(t){return"string"==typeof t||!n(t)&&r(t)&&a.call(t)==o}},36:function(t,e){t.exports=function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}},364:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(0),o=u(r),a=u(i(4)),s=u(i(365)),l=u(i(366));function u(t){return t&&t.__esModule?t:{default:t}}var h=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return i._onItemTap=function(t,e,n){i.setState({selectedIndex:e}),i.props.onItemTap&&i.props.onItemTap(t,e,n)},i.state={selectedIndex:i.props.selectedIndex||i._getSelectedIndexByVal(),style:null},i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Component),n(e,null,[{key:"propTypes",get:function(){return{menuItems:a.default.array.isRequired,selectedIndex:a.default.number,selectedVal:a.default.string,onItemTap:a.default.func,itemTpl:a.default.func,isScroll:a.default.bool}}}]),n(e,[{key:"componentDidMount",value:function(){this.props.hasOwnProperty("selectedIndex")&&this._setSelectedIndex(this.props.selectedIndex)}},{key:"componentWillReceiveProps",value:function(t){t.hasOwnProperty("selectedIndex")&&this._setSelectedIndex(t.selectedIndex)}},{key:"render",value:function(){return o.default.createElement("div",{className:"menu-wrap-inner",style:this.state.style},this._renderChilden())}},{key:"_renderChilden",value:function(){for(var t,e,i=[],n=this.props,r=0,a=n.menuItems.length;r<a;r++)t=n.menuItems[r],e=o.default.createElement(s.default,{selected:this.state.selectedIndex===r,key:r,index:r,data:t,itemTpl:n.itemTpl,displayKey:n.displayKey,valKey:n.valKey,onTap:this._onItemTap}),i.push(e),"divider"===t.type&&i.push(o.default.createElement(l.default,{key:"divider"+r}));return i}},{key:"_getSelectedIndexByVal",value:function(){var t=this.props;if(t.selectedVal)for(var e=0,i=t.menuItems.length;e<i;e++)if(t.menuItems[e][t.valKey]==t.selectedVal)return e;return 0}},{key:"_setSelectedIndex",value:function(t){this.setState({selectedIndex:t})}},{key:"setHeight",value:function(t){var e=null;"auto"!==t&&(e={overflowY:"auto",overflowX:"hidden",height:t=Math.max(t,30)}),this.setState({style:e})}},{key:"removeStyle",value:function(){this.setState({style:null})}}]),e}();e.default=h,t.exports=e.default},365:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(0),o=s(r),a=s(i(4));function s(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return u.call(i),i.state={hovered:!1},i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Component),n(e,null,[{key:"propTypes",get:function(){return{index:a.default.number.isRequired,selected:a.default.bool,data:a.default.oneOfType([a.default.object,a.default.string,a.default.number]),onTap:a.default.func,itemTpl:a.default.func}}}]),n(e,[{key:"render",value:function(){var t=this.props,e="menu-item",i=this.state.hovered?"hovered":"";return i&&(e+=" "+i),t.selected&&(e+=" menu-item-selected"),t.data.class&&(e+=" "+t.data.class),o.default.createElement("div",{className:e,onMouseEnter:this._handleMouseEnter,onMouseLeave:this._handleMouseLeave,onClick:this._onTap},t.itemTpl(t.index,t.data,t.selected,t.displayKey,t.valKey))}}]),e}(),u=function(){var t=this;this._onTap=function(e){var i=t.props;i.onTap&&i.onTap(e,i.index,i.data)},this._handleMouseEnter=function(e){t.setState({hovered:!0})},this._handleMouseLeave=function(e){t.setState({hovered:!1})}};e.default=l,l.defaultProps={itemTpl:function(t,e,i,n,r){var a=e[n],s=e[r];return o.default.createElement("div",{"data-val":s},a)}},t.exports=e.default},366:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){return n.default.createElement("div",{className:"menu-divider"})};var n=function(t){return t&&t.__esModule?t:{default:t}}(i(0));t.exports=e.default},367:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(0),o=s(r),a=s(i(4));function s(t){return t&&t.__esModule?t:{default:t}}var l=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,r.Component),n(e,[{key:"render",value:function(){var t=this.props,e=t.isShow?"":"hide",i=t.customClass||"";return o.default.createElement("div",{className:"tooltip "+e+" "+i},t.tip)}}],[{key:"propTypes",get:function(){return{tip:a.default.oneOfType([a.default.element,a.default.string]),isShow:a.default.bool,customClass:a.default.string}}}]),e}();e.default=l,t.exports=e.default},368:function(t,e){t.exports={on:function(t,e,i){window.addEventListener?t.addEventListener(e,i,!1):t.attachEvent("on"+e,i)},off:function(t,e,i){window.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent("on"+e,i)}}},369:function(t,e){t.exports={isDescendant:function(t,e){for(var i=e.parentNode;null!=i;){if(i===t)return!0;i=i.parentNode}return!1}}},37:function(t,e,i){var n=i(89),r=i(44),o=i(90),a=i(80),s=i(91),l=i(41),u=Object.prototype.toString,h=l(n),c=l(r),p=l(o),f=l(a),_=l(s);function d(t){return u.call(t)}(n&&"[object DataView]"!=d(new n(new ArrayBuffer(1)))||r&&"[object Map]"!=d(new r)||o&&"[object Promise]"!=d(o.resolve())||a&&"[object Set]"!=d(new a)||s&&"[object WeakMap]"!=d(new s))&&(d=function(t){var e=u.call(t),i="[object Object]"==e?t.constructor:void 0,n=i?l(i):void 0;if(n)switch(n){case h:return"[object DataView]";case c:return"[object Map]";case p:return"[object Promise]";case f:return"[object Set]";case _:return"[object WeakMap]"}return e}),t.exports=d},38:function(t,e,i){"use strict";var n=i(153),r=i(154),o=i(155),a=i(156),s=i(157),l=i(158),u=i(159);i.d(e,"h",function(){return n.a}),i.d(e,"a",function(){return r.a}),i.d(e,"g",function(){return o.a}),i.d(e,"e",function(){return a.a}),i.d(e,"d",function(){return s.a}),i.d(e,"b",function(){return l.a}),i.d(e,"k",function(){return u.a});var h=i(160);i.d(e,"j",function(){return h.d}),i.d(e,"i",function(){return h.c}),i.d(e,"f",function(){return h.b}),i.d(e,"l",function(){return h.e}),i.d(e,"c",function(){return h.a})},39:function(t,e,i){var n=i(57),r=Object.prototype.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)||"object"==typeof t&&e in t&&null===n(t)}},4:function(t,e,i){t.exports=i(149)()},41:function(t,e){var i=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return i.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},43:function(t,e,i){var n=i(16),r=i(104),o=i(105),a=i(106),s=i(107),l=i(108);function u(t){this.__data__=new n(t)}u.prototype.clear=r,u.prototype.delete=o,u.prototype.get=a,u.prototype.has=s,u.prototype.set=l,t.exports=u},431:function(t,e,i){var n=i(59);t.exports=function(t,e){return n(e,function(e){return t[e]})}},44:function(t,e,i){var n=i(8)(i(5),"Map");t.exports=n},449:function(t,e,i){var n=i(97),r=i(450),o=i(307),a=i(49),s=i(3);t.exports=function(t,e){if(e=a(e,3),s(t)){var i=o(t,e);return i>-1?t[i]:void 0}return r(t,e,n)}},45:function(t,e,i){var n=i(5).Symbol;t.exports=n},450:function(t,e){t.exports=function(t,e,i,n){var r;return i(t,function(t,i,o){if(e(t,i,o))return r=n?i:t,!1}),r}},454:function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};window._SHIMO_BRAODCAST_=window._SHIMO_BRAODCAST_||{};var n=window._SHIMO_BRAODCAST_.attachFunctionList=window._SHIMO_BRAODCAST_.attachFunctionList||{},r=window._SHIMO_BRAODCAST_.notifyCache=window._SHIMO_BRAODCAST_.notifyCache||{},o=function(t,e,r){if("string"==typeof t)if("function"==typeof e){for(var o=(n[t]||[]).length;o--;)if(n[t][o].fun===e){if(!0!==r)return n[t][o];n[t].splice(o,1)}}else if("object"===(void 0===e?"undefined":i(e))&&r)for(var a=(n[t]||[]).length;a--;)n[t][a].scope===e&&n[t].splice(a,1);else{if(!0!==!!e)return n[t];delete n[t]}return null},a=function(t,e,i){var a=i||{};if("string"==typeof t&&"function"==typeof e){o(t)||(n[t]=[]);var s={fun:e,scope:a.scope,isAsync:a.isAsync};o(t).push(s);var u=r[t];delete r[t],Array.isArray(u)&&!0===a.invoke&&setTimeout(function(){l(s,u)})}},s=function(t,e){if("string"==typeof t){var n=void 0===e?"undefined":i(e);"function"===n||"object"===n?o(t,e,!0):o(t,!0)}};function l(t,e){if(t.isAsync)!function(t){setTimeout(function(){t.fun.apply(t.scope,e)},0)}(t);else try{t.fun.apply(t.scope,e)}catch(t){console.error(t.stack)}}e.default={destory:function(){n=window._SHIMO_BRAODCAST_={}},on:a,off:s,attach:a,detach:s,notify:function(t){var e=o(t)||[];if(0!==e.length){var i=Array.prototype.slice.call(arguments,1);r[t]=i;for(var n=0;n<e.length;n++)l(e[n],i)}},attachOne:function(t,e,i){s(t),a(t,e,i)},BCBundle:function(t){var e=t,i=Object.keys(t);return i.forEach(function(t){return a(t,e[t])}),{detach:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t?s(t,e[t]):i.forEach(function(t){return s(t,e[t])})}}}},t.exports=e.default},46:function(t,e){t.exports=function(t){var e=-1,i=Array(t.size);return t.forEach(function(t,n){i[++e]=[n,t]}),i}},47:function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},48:function(t,e,i){var n=i(14),r=i(6),o=i(15),a=NaN,s=/^\s+|\s+$/g,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,h=/^0o[0-7]+$/i,c=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(o(t))return a;if(r(t)){var e=n(t.valueOf)?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var i=u.test(t);return i||h.test(t)?c(t.slice(2),i?2:8):l.test(t)?a:+t}},49:function(t,e,i){var n=i(169),r=i(175),o=i(146),a=i(3),s=i(182);t.exports=function(t){return"function"==typeof t?t:null==t?o:"object"==typeof t?a(t)?r(t[0],t[1]):n(t):s(t)}},490:function(t,e,i){var n=i(431),r=i(10);t.exports=function(t){return t?n(t,r(t)):[]}},5:function(t,e,i){(function(t,n){var r=i(88),o={function:!0,object:!0},a=o[typeof e]&&e&&!e.nodeType?e:void 0,s=o[typeof t]&&t&&!t.nodeType?t:void 0,l=r(a&&s&&"object"==typeof n&&n),u=r(o[typeof self]&&self),h=r(o[typeof window]&&window),c=r(o[typeof this]&&this),p=l||h!==(c&&c.window)&&h||u||c||Function("return this")();t.exports=p}).call(e,i(30)(t),i(20))},50:function(t,e,i){var n=i(76),r=i(96),o=1,a=2;t.exports=function(t,e,i,s,l,u){var h=l&a,c=t.length,p=e.length;if(c!=p&&!(h&&p>c))return!1;var f=u.get(t);if(f)return f==e;var _=-1,d=!0,g=l&o?new n:void 0;for(u.set(t,e);++_<c;){var y=t[_],m=e[_];if(s)var v=h?s(m,y,_,e,t,u):s(y,m,_,t,e,u);if(void 0!==v){if(v)continue;d=!1;break}if(g){if(!r(e,function(t,e){if(!g.has(e)&&(y===t||i(y,t,s,l,u)))return g.add(e)})){d=!1;break}}else if(y!==m&&!i(y,m,s,l,u)){d=!1;break}}return u.delete(t),d}},51:function(t,e,i){var n=i(29),r=Object.prototype.hasOwnProperty;t.exports=function(t,e,i){var o=t[e];r.call(t,e)&&n(o,i)&&(void 0!==i||e in t)||(t[e]=i)}},52:function(t,e,i){var n=i(121),r=i(6),o=i(9);t.exports=function t(e,i,a,s,l){return e===i||(null==e||null==i||!r(e)&&!o(i)?e!=e&&i!=i:n(e,i,t,a,s,l))}},542:function(t,e,i){Object.defineProperty(e,"__esModule",{value:!0}),e.defaultChart=e.chartDropDownMenu=e.tabs=e.charts=void 0;var n=function(t){return t&&t.__esModule?t:{default:t}}(i(2));e.charts=function(){return[{tag:"001",name:(0,n.default)(""),type:12,des:"columnClustered"},{tag:"002",name:(0,n.default)(""),type:13,des:"columnStacked"},{tag:"003",name:(0,n.default)("% "),type:14,des:"columnStacked100"},{tag:"004",name:(0,n.default)(""),type:18,des:"barClustered"},{tag:"005",name:(0,n.default)(""),type:19,des:"barStacked"},{tag:"006",name:(0,n.default)("% "),type:20,des:"barStacked100"},{tag:"007",name:(0,n.default)(""),type:9,des:"line"},{tag:"008",name:(0,n.default)(""),type:24,des:"lineStacked"},{tag:"009",name:(0,n.default)("% "),type:25,des:"lineStacked100"},{tag:"018",name:(0,n.default)(""),type:26,des:"lineMarkers"},{tag:"019",name:(0,n.default)(""),type:27,des:"lineStackedMarkers"},{tag:"020",name:(0,n.default)(" % "),type:28,des:"lineStacked100Markers"},{tag:"010",name:(0,n.default)(""),type:8,des:"area"},{tag:"011",name:(0,n.default)(""),type:37,des:"areaStacked"},{tag:"012",name:(0,n.default)("% "),type:38,des:"areaStacked100"},{tag:"013",name:(0,n.default)(""),type:10,des:"pie"},{tag:"014",name:(0,n.default)(""),type:3,des:"doughnut"},{tag:"015",name:(0,n.default)(""),type:1,des:"xyScatter"},{tag:"016",name:(0,n.default)(""),type:11,des:"bubble"},{tag:"017",name:(0,n.default)(""),type:50,des:"stockOHLC"}]},e.tabs=function(){return[{type:"data",label:(0,n.default)("")},{type:"attrs",label:(0,n.default)("")}]},e.chartDropDownMenu=function(){return[{type:"chart:edit",text:(0,n.default)("")},{customClass:"chart-dropdown-divide",type:"chart:save-as-picture",text:(0,n.default)("")},{customClass:"chart-dropdown-delete",type:"chart:delete",text:(0,n.default)("")}]},e.defaultChart={chartType:12,chartTitle:"",legendVisible:!0,legendPosition:4,dataLabels:!0}},543:function(t,e,i){"use strict";(function(t){e.i=N,e.g=function(t,e){var i=e.width,n=e.height,r=M(t,e),o=r.x,a=r.y,s=r.startRow,l=r.startCol,u=r.rowOffset,h=r.colOffset;return{position:[o,a,i,n],relativePosition:[s,l,u,h,i,n]}},e.k=G,e.j=function(t){var e=t.series().AllSers[0],i=e?k(e.Formula):[],n=i[0],r=i[1];return[!!n,!!r]},e.l=function(t){var e={};return g()(t.sheets,function(t){var n=t.guid();g()(t.charts.all(),function(r){var o=r.name(),a=O(t,o);if(function(t,e,n){if(!e)return!0;var r=t.name(),o=i(e.series,r,""),a=i(G(n),r,"");return!_()(o,a)}(t,a,r)){var s=e[n]||(e[n]={}),l=N(r);s[o]=JSON.stringify(l),D(t,o,l)}})}),e;function i(t,e,i){return void 0===t&&(t=[]),B(t,e,i).map(function(t){return t.map(function(t){return t||null})})}},e.m=function(e){if(!e)return;var i=t(e._host).find("canvas")[0],n=i&&i.toDataURL("image/png"),o=E(e).text||r()("");S()(n,o+".png","image/png")},e.e=function(t,e){var i=e.name,n=e._chartConfig;return x.c(t,i,n)},e.f=function(t,e){var i=N(t),n=t.sheet(),r=n&&n.name();return{name:"chart-"+Object(v.genGuid)(),_chartConfig:e?U(i,"",r):U(i,r,"")}},e.p=function(t,e){var i=e.getIter();for(;i.hasNext();){var n=i.next(),r=n.getAttributes(),o=L(t,r.id);V(o,r)}},e.o=V,e.n=function(t,e,i,n){var r=e.getIter(),o=[];for(;r.hasNext();){var s=r.next(),l=s.getAttributes(),u=j(l,i,n);o.push(p()(u)?{}:a()({id:l.id},u))}return o},e.c=function(t,e){var i=e.args,n=i.propertyName,r=i.floatingObject,o=t.spread,a=t.spread.getActiveSheet().gcSheet,s={},l=a.guid(),u=r.name(),h=o.getCsIndexBySheetId(l);if(["location","position","width","height"].indexOf(n)>-1){var c=N(r);return D(a,u,c),s[u]=JSON.stringify(c),Object(C.b)({fnName:"tableAttrs2Cs",params:[{sheetId:l,sheetIndex:h},z(a,s)]})}return C.a},e.b=function(t){var e=t.permissions.query.canEditFile(),i=t.csApplier.isApplingChange;return e&&!i},e.h=function(t){var e=function(t){return t&&t.charts?t.charts.all():[]}(t),i=[];return g()(e,function(t){t.isSelected()&&i.push(t)}),i},e.q=z,e.a=function(t,e){g()(e,function(e){var i=e.name();D(t,i,null)})},e.d=function(t,e){if(!t)return t;for(var i=e||32,n=/[^\x00-\xff]/,r=t.split(""),o=r.length,a=0,s=0,l=0;l<o;l++){var u=n.test(r[l])?2:1;if(a+u>i)break;s=l+1,a+=u}return t.substr(0,s)};var n=i(2),r=i.n(n),o=i(147),a=i.n(o),s=i(207),l=i.n(s),u=i(291),h=i.n(u),c=i(311),p=i.n(c),f=i(244),_=i.n(f),d=i(218),g=i.n(d),y=i(127),m=i.n(y),v=i(211),b=(i.n(v),i(1167)),S=i.n(b),C=i(226),x=i(629),T=i(1),w=(i.n(T),T.sheets.Core),P=T.sheets,A=P.spread,F=P.sheet,O=F.getSheetAttrs,M=F.getViewMiddlePosition,D=F.setSheetAttrs,L=A.getSheetById,I=w.Spread.Sheets.CalcEngine,k=I.parseSeriesFormula,R=I.parseSeriesFormulaItem;function N(t){var e=t._ps,i=e.startRow,n=e.startColumn,r=e.startRowOffset,o=e.startColumnOffset,a=e.x,s=e.y,l=e.width,u=e.height,h=t.chartType(),c=t.legend(),p=t.axes(),f=p.primaryCategory,_=p.primaryValue,d=(t.dataLabels()||{showValue:!1}).showValue;return{chartTitle:E(t).text,chartType:h,legendVisible:c&&c.visible,legendPosition:c&&c.position,position:[a||0,s||0,l,u],relativePosition:[i||0,n||0,r||0,o||0,l,u],series:G(t),dataLabels:d,axes:{primaryCategory:{majorGridLine:{visible:!!f&&f.majorGridLine.visible},title:{text:f?f.title.text:""}},primaryValue:{majorGridLine:{visible:!!_&&_.majorGridLine.visible},title:{text:_?_.title.text:""},max:_?_.max:null,min:_?_.min:null}}}}function E(t){var e=t.title()||{};return m()(e.text)&&(e.text=""),e}function G(t){return t.series().AllSers.map(function(t){var e=k(t.Formula);return[e[0],e[1],e[2],e[4],t.ChartType,t.AxisGroup]})}function V(t,e){h()(e,function(e,i){i.match(/chart-/)&&e&&D(t,i,JSON.parse(e))})}function j(t,e,i){var n={};return h()(t,function(t,r){if(r.match(/chart-/)&&t){var o=U(t=JSON.parse(t),e,i);_()(t,o)||(n[r]=JSON.stringify(o))}}),n}function B(t,e,i){return void 0===t&&(t=[]),t.map(function(t){return t.map(function(t){return function(t,e,i){if(void 0===i&&(i=""),"string"!=typeof t||-1===t.indexOf("$"))return t;var n=(t.match(/^\((.+)\)$/)?k(t):[t]).map(function(n){var r=R(n),o=r.sheetName,a=r.range;return o===e?"'"+i.replace(/'/g,"''")+"'!"+a:t});return n.length?n[0]:"("+n.join(",")+")"}(t,e,i)})})}function U(t,e,i){var n=l()(t),r=n.series;return n.series=B(r,e,i),n}function z(t,e){var i=t.guid();return i&&(e.id=i),e}}).call(e,i(84))},56:function(t,e){t.exports=function(t){var e=-1,i=Array(t.size);return t.forEach(function(t){i[++e]=t}),i}},57:function(t,e){var i=Object.getPrototypeOf;t.exports=function(t){return i(Object(t))}},58:function(t,e,i){var n=i(78),r=i(33),o=i(3),a=i(12),s=i(34);t.exports=function(t){var e=t?t.length:void 0;return a(e)&&(o(t)||s(t)||r(t))?n(e,String):null}},59:function(t,e){t.exports=function(t,e){for(var i=-1,n=t.length,r=Array(n);++i<n;)r[i]=e(t[i],i,t);return r}},6:function(t,e){t.exports=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}},603:function(t,e,i){var n=i(229),r=i(11),o=i(34),a=i(83),s=i(490),l=Math.max;t.exports=function(t,e,i,u){t=r(t)?t:s(t),i=i&&!u?a(i):0;var h=t.length;return i<0&&(i=l(h+i,0)),o(t)?i<=h&&t.indexOf(e,i)>-1:!!h&&n(t,e,i)>-1}},61:function(t,e,i){var n=i(11),r=i(9);t.exports=function(t){return r(t)&&n(t)}},629:function(t,e,i){"use strict";e.a=function(t,e){if(o()(e))return;var i=t.charts;u()(e,function(e,n){n.match(/chart-/)&&(e?(e=JSON.parse(e),i&&i.get(n)?function(t,e,i,n){var r=i.chartType,o=i.chartTitle,a=i.position,l=i.relativePosition,u=i.legendVisible,h=i.legendPosition,c=i.series,f=i.axes,_=i.dataLabels,d=t.charts.get(e),y=d.title()||{},m=d.legend();if(y.text=o,n.chartType!==r){var v=50===n.chartType,b=c.reduce(function(t,e){return!t.includes(e[4])&&t.push(e[4]),t},[]);(v||1===b.length)&&d.chartType(r)}if(d._setDataRange(""),g(d,c,r),d.title(y),l){var S=l[0],C=l[1],x=l[2],T=l[3],w=l[4],P=l[5];d.startRow(S),d.startColumn(C),d.startRowOffset(x),d.startColumnOffset(T),d.width(w),d.height(P)}else{var A=a[0],F=a[1],w=a[2],P=a[3];d.x(A),d.y(F),d.width(w),d.height(P)}var O=10===r,M=3===r;O||M||!f||d.axes(s()(d.axes(),f));if("boolean"==typeof _){var D=p.Spread.Sheets.Charts.DataLabelPosition;O||M?d.dataLabels(s()(d.dataLabels(),{showValue:_,position:D.center})):d.dataLabels(s()(d.dataLabels(),{showValue:_}))}m&&(m.visible=u,m.position="number"==typeof h?h:4,d.legend(m))}(t,n,e,_(t,n)):function(t,e,i){t._floatingObjectModel._add(y(t,e,i))}(t,n,e),d(t,n,e)):i.get(n)&&i.remove(n))})},e.c=y,e.b=function(t,e,i){var n,r=i.chartType,o=i.position,a=i.rangeFormula,s=i.series,l=o[0],u=o[1],h=o[2],c=o[3],f=p.Spread.Sheets.Charts.Chart,_=0===r;a&&!_?n=new f(t,e,r,l,u,h,c,a):g(n=new f(t,e,_?12:r,l,u,h,c,""),s,r);return n};var n=i(221),r=(i.n(n),i(311)),o=i.n(r),a=i(147),s=i.n(a),l=i(291),u=i.n(l),h=i(542),c=(i.n(h),i(1)),p=(i.n(c),c.sheets.Core),f=c.sheets.sheet,_=f.getSheetAttrs,d=f.setSheetAttrs;function g(t,e,i){var n=!1;i=0===i?null:i,e&&e.forEach(function(e){var r=e[0],o=e[1],a=e[2],s=e[3],l=e[4],u=e[5],h={},c=i||l||12,p=11===c;h.chartType=c,h.name=r,h.xValues=o,h.yValues=a,h.axisGroup=u,p&&(h.bubbleSizes=s),t.series().add(h),[1,11,33,34,35,36].indexOf(c)>-1&&(n=!0)}),n&&t._updateChartModel(!0)}function y(t,e,i){var r=i.chartTitle,o=i.legendVisible,a=i.legendPosition,l=i.axes,u=i.dataLabels,c=i.chartType,f=function(t,e,i){var n,r,o,a,s=i.chartType,l=i.position,u=i.relativePosition,h=i.series;u?(o=0,a=0,n=u[4],r=u[5]):(o=l[0],a=l[1],n=l[2],r=l[3],function(t,e){for(var i=t.getRowCount(),n=0,r=0;r<i&&!((n+=t.getRowHeight(r,void 0,!0))>e);r++);}(t,a));var c=new(0,p.Spread.Sheets.Charts.Chart)(t,e,0===s?12:s,o,a,n,r,"");if(t.suspendEvent(),u){var f=u[0],_=u[1],d=u[2],y=u[3];c.startRow(f),c.startColumn(_),c.startRowOffset(d),c.startColumnOffset(y)}return t.resumeEvent(),g(c,h,s),c}(t,e,i),_=f.title()||{},d=f.legend();_.text=r,f.title(_),f.dynamicSize(!1),Object(n.isMobile)()||f.dropdownMenu(Object(h.chartDropDownMenu)());var y=10===c,m=3===c;if(y||m||!l||f.axes(s()(f.axes(),l)),"boolean"==typeof u){var v=p.Spread.Sheets.Charts.DataLabelPosition;y||m?f.dataLabels(s()(f.dataLabels(),{showValue:u,position:v.center})):f.dataLabels(s()(f.dataLabels(),{showValue:u}))}return d&&(d.visible=o,d.position="number"==typeof a?a:4,f.legend(d)),f}},63:function(t,e,i){var n=i(51);t.exports=function(t,e,i,r){i||(i={});for(var o=-1,a=e.length;++o<a;){var s=e[o],l=r?r(i[s],t[s],s,i,t):t[s];n(i,s,l)}return i}},630:function(t,e,i){var n=i(307),r=i(49);t.exports=function(t,e){return t&&t.length?n(t,r(e,3)):-1}},66:function(t,e,i){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var r=i(67);e.DEFAULT_LOCALES=["af","ar","az","be","bg","bn","bs","ca","cs","cy","da","de","de-AT","de-CH","de-DE","el","el-CY","en","en-AU","en-CA","en-GB","en-IE","en-IN","en-NZ","en-US","en-ZA","en-CY,eo","es","es-419","es-AR","es-CL","es-CO","es-CR","es-EC","es-ES","es-MX","es-NI","es-PA","es-PE","es-US","es-VE","et","eu","fa","fi","fr","fr-CA","fr-CH","fr-FR","gl","he","hi","hi-IN","hr","hu","id","is","it","it-CH","ja","ka","km","kn","ko","lb","lo","lt","lv","mk","ml","mn","mr-IN","ms","nb","ne","nl","nn","oc","or","pa","pl","pt","pt-BR","rm","ro","ru","sk","sl","sq","sr","sw","ta","te","th","tl","tr","tt","ug","ur","uz","vi","wo","zh-CN","zh-HK","zh-TW","zh-YUE"],e.isValidLocaleResource=function(t){return!!t&&(!Array.isArray(t)&&("object"===(void 0===t?"undefined":n(t))&&Object.keys(t).every(function(e){var i=t[e];return null==i||"string"==typeof i||"object"===(void 0===i?"undefined":n(i))})))},e.rawTextToKey=function(t){switch(t.type){case"string":return t.text;case"interpolated":var e=t.textParts.length;return 1===e?t.textParts[0]:2===e?t.textParts[0]+"%s"+t.textParts[1]:t.textParts.map(function(e,i){return i===t.textParts.length-1?e:e+"%"+(i+1)}).join("");default:return r.assertNever(t)}}},67:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertNever=function(t){throw new Error("unexpected type: "+JSON.stringify(t))}},7:function(t,e){t.exports=ReactDOM},70:function(t,e,i){var n=i(5).Uint8Array;t.exports=n},71:function(t,e,i){var n=i(132),r=i(83),o="Expected a function",a=Math.max;t.exports=function(t,e){if("function"!=typeof t)throw new TypeError(o);return e=a(void 0===e?t.length-1:r(e),0),function(){for(var i=arguments,r=-1,o=a(i.length-e,0),s=Array(o);++r<o;)s[r]=i[e+r];switch(e){case 0:return t.call(this,s);case 1:return t.call(this,i[0],s);case 2:return t.call(this,i[0],i[1],s)}var l=Array(e+1);for(r=-1;++r<e;)l[r]=i[r];return l[e]=s,n(t,this,l)}}},72:function(t,e,i){"use strict";var n=i(0),r=i.n(n),o=i(7),a=i.n(o),s=i(73),l=i(13),u=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),h=function(t){function e(e){var i=t.call(this,e)||this;return i.toggleOpen=function(){i.setState({open:!i.state.open,style:null})},i.close=function(){i.setState({open:!1,style:null})},i.checkClick=function(t){var e=a.a.findDOMNode(i),n=t.target;!e.contains(n)&&i.state.open&&i.close()},i.adjustStyle=function(){var t=a.a.findDOMNode(i);if(!l.b&&!l.a||!t.querySelector(".menu--submenu")){var e=t.lastElementChild.getBoundingClientRect(),n=e.top,r=e.bottom,o={},s=window.innerHeight-50;r>s&&(o.maxHeight=s-n,o.overflowY="auto"),i.setState({style:o})}},i.state={open:!1,style:null},i}return u(e,t),e.prototype.componentDidMount=function(){this.bindClick()},e.prototype.componentDidUpdate=function(t,e){this.state.open&&!e.open?(this.props.onOpen&&this.props.onOpen(),this.adjustStyle()):!this.state.open&&e.open&&this.props.onClose&&this.props.onClose()},e.prototype.componentWillUnmount=function(){this.unbindClick()},e.prototype.render=function(){var t=this,e="menu "+(this.props.customClass?this.props.customClass:"")+" "+(this.state.open?"menu__open":"")+" "+(this.props.disabled?"disabled":"");return r.a.createElement(s.a.Provider,{value:{closeMenu:this.close}},r.a.createElement("div",{className:e},r.a.cloneElement(this.props.head,{onClick:function(e){var i=t.props.head.props.onClick;i&&i(e),t.toggleOpen()}}),this.state.open&&r.a.createElement("div",{className:"menu--body"},r.a.createElement("div",{className:"menu--content",style:this.state.style},this.renderChildren()))))},e.prototype.bindClick=function(){document.addEventListener("click",this.checkClick,!1)},e.prototype.unbindClick=function(){document.removeEventListener("click",this.checkClick,!1)},e.prototype.renderChildren=function(){var t=this.props.children;if("function"==typeof t){if(t.cache)return t.cache;var e=t();return t.cache=e,e}return t},e}(r.a.Component);e.a=h},73:function(t,e,i){"use strict";i.d(e,"a",function(){return r});var n=i(0),r=i.n(n).a.createContext({closeMenu:function(){}})},74:function(t,e,i){"use strict";e.a=function(t){return{background:'url("'+t+'") center no-repeat'}}},76:function(t,e,i){var n=i(32),r=i(122),o=i(123);function a(t){var e=-1,i=t?t.length:0;for(this.__data__=new n;++e<i;)this.add(t[e])}a.prototype.add=a.prototype.push=r,a.prototype.has=o,t.exports=a},761:function(t,e,i){"use strict";i.d(e,"b",function(){return s}),i.d(e,"a",function(){return l});var n=i(0),r=i.n(n),o=i(22),a=i.n(o),s=function(t){var e=t.customClass,i=t.onChange,n=t.onBlur,o=t.value,a=t.placeholder,s=t.disabled;return r.a.createElement("div",{className:"f-row f-c-center chart-input-border "+e},r.a.createElement("input",{type:"text",spellCheck:!1,value:o,placeholder:a,disabled:s,onChange:i,onBlur:n}))},l=function(t){var e=t.text,i=t.checked,n=t.disable,o=t.onClick;return r.a.createElement("div",{className:a()({"f-row f-c-center chart-checkbox-container":!0,checked:i,disable:n}),onClick:o},r.a.createElement("span",{id:"chart-checkbox"}),r.a.createElement("label",{htmlFor:"chart-checkbox"},e))}},77:function(t,e){var i=Object.keys;t.exports=function(t){return i(Object(t))}},78:function(t,e){t.exports=function(t,e){for(var i=-1,n=Array(t);++i<t;)n[i]=e(i);return n}},79:function(t,e,i){var n=i(47)("length");t.exports=n},8:function(t,e,i){var n=i(87);t.exports=function(t,e){var i=t[e];return n(i)?i:void 0}},80:function(t,e,i){var n=i(8)(i(5),"Set");t.exports=n},81:function(t,e,i){var n=i(82),r=i(31),o=i(24);t.exports=function(t,e){for(var i=0,a=(e=r(e,t)?[e]:n(e)).length;null!=t&&i<a;)t=t[o(e[i++])];return i&&i==a?t:void 0}},82:function(t,e,i){var n=i(3),r=i(177);t.exports=function(t){return n(t)?t:r(t)}},83:function(t,e,i){var n=i(94);t.exports=function(t){var e=n(t),i=e%1;return e==e?i?e-i:e:0}},84:function(t,e){t.exports=Zepto},87:function(t,e,i){var n=i(14),r=i(36),o=i(6),a=i(41),s=/^\[object .+?Constructor\]$/,l=Object.prototype,u=Function.prototype.toString,h=l.hasOwnProperty,c=RegExp("^"+u.call(h).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!!o(t)&&(n(t)||r(t)?c:s).test(a(t))}},88:function(t,e){t.exports=function(t){return t&&t.Object===Object?t:null}},89:function(t,e,i){var n=i(8)(i(5),"DataView");t.exports=n},9:function(t,e){t.exports=function(t){return!!t&&"object"==typeof t}},90:function(t,e,i){var n=i(8)(i(5),"Promise");t.exports=n},91:function(t,e,i){var n=i(8)(i(5),"WeakMap");t.exports=n},92:function(t,e,i){var n=i(6);t.exports=function(t){return t==t&&!n(t)}},93:function(t,e){t.exports=function(t,e){return function(i){return null!=i&&i[t]===e&&(void 0!==e||t in Object(i))}}},94:function(t,e,i){var n=i(48),r=1/0,o=1.7976931348623157e308;t.exports=function(t){return t?(t=n(t))===r||t===-r?(t<0?-1:1)*o:t==t?t:0:0===t?t:0}},96:function(t,e){t.exports=function(t,e){for(var i=-1,n=t.length;++i<n;)if(e(t[i],i,t))return!0;return!1}},97:function(t,e,i){var n=i(219),r=i(220)(n);t.exports=r},99:function(t,e){t.exports=function(){this.__data__=[]}}})});