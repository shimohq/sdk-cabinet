!function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=43)}([function(t,e,r){"use strict";var n=r(25),o=r(61),i=Object.prototype.toString;function a(t){return"[object Array]"===i.call(t)}function s(t){return null!==t&&"object"==typeof t}function u(t){return"[object Function]"===i.call(t)}function c(t,e){if(null!==t&&void 0!==t)if("object"!=typeof t&&(t=[t]),a(t))for(var r=0,n=t.length;r<n;r++)e.call(null,t[r],r,t);else for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.call(null,t[o],o,t)}t.exports={isArray:a,isArrayBuffer:function(t){return"[object ArrayBuffer]"===i.call(t)},isBuffer:o,isFormData:function(t){return"undefined"!=typeof FormData&&t instanceof FormData},isArrayBufferView:function(t){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer&&t.buffer instanceof ArrayBuffer},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isObject:s,isUndefined:function(t){return void 0===t},isDate:function(t){return"[object Date]"===i.call(t)},isFile:function(t){return"[object File]"===i.call(t)},isBlob:function(t){return"[object Blob]"===i.call(t)},isFunction:u,isStream:function(t){return s(t)&&u(t.pipe)},isURLSearchParams:function(t){return"undefined"!=typeof URLSearchParams&&t instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function t(){var e={};function r(r,n){"object"==typeof e[n]&&"object"==typeof r?e[n]=t(e[n],r):e[n]=r}for(var n=0,o=arguments.length;n<o;n++)c(arguments[n],r);return e},deepMerge:function t(){var e={};function r(r,n){"object"==typeof e[n]&&"object"==typeof r?e[n]=t(e[n],r):e[n]="object"==typeof r?t({},r):r}for(var n=0,o=arguments.length;n<o;n++)c(arguments[n],r);return e},extend:function(t,e,r){return c(e,function(e,o){t[o]=r&&"function"==typeof e?n(e,r):e}),t},trim:function(t){return t.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(13),o=r(48);e.delay=o.delay,e.uuid=function(){return n.v4().replace(/-/g,"")},e.version="0.25.1",function(t){t.NEW_CHANGE="newEditorChange",t.NEW_TRACKER_CHANGE="newTrackerChange",t.NEW_CHANGE_SAVED_TO_STORAGE="newEditorChangeSavedToStorage",t.NEW_CHANGE_SAVE_TO_STORAGE_FAILED="newEditorChangeSaveToStorageFailed",t.SERVER_CHANGE_APPLIED="serverChangeApplied",t.SERVER_CHANGE_PROCESSED="serverChangeProcessed",t.ACCEPT="accept",t.ACCEPT_COMMIT="acceptCommit",t.ACCEPT_FAILED="acceptFailed",t.WAITING_FOR_CAN_HANDLE_SERVER_CHANGES="waitingForCanHandleServerChanges",t.BEFORE_SEND_REQUEST="beforeSendRequest",t.SEND_REQUEST_DONE="sendRequestDone",t.SEND_REQUEST_FAILED="sendRequestFailed",t.BEFORE_APPLY_CHANGE="beforeApplyChange",t.CHANGE="change",t.CHANGES="changes",t.SAVE_STATUS_CHANGE="saveStatusChange",t.COLLABORATOR="collaborator",t.EXTERNAL_CHANGES="external",t.SHIMO_SCRIPTS="shimoScripts",t.CHANGES_PENDING="delta_pending",t.ENTER="enter",t.LEAVE="leave",t.SELECT="select",t.FILE_META="fileMeta",t.BROADCAST="broadcast",t.ERROR="error",t.WARNING="warning",t.NETWORK_CHANGE="networkChange",t.TRACK="track",t.OPEN="open",t.ON_VISIBLE="onVisible"}(e.Event||(e.Event={})),function(t){t.NETWORK_STATUS_OFFLINE="networkStatusOffline",t.SAVE_STATUS_INIT_OFFLINE="saveStatusInitOffline",t.SAVE_STATUS_REQ_TIMEDOUT="saveStatusRequestTimedout",t.SAVE_STATUS_NETWORK_OFFLINE="saveSatstusNetworkChangeOffline"}(e.STATUS_CHANGE||(e.STATUS_CHANGE={})),e.debounce=function(t,e,r){var n;return function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];return new Promise(function(i){var a=r&&!n;clearTimeout(n),n=setTimeout(function(){n=null,r||i(t.apply(void 0,o))},e),a&&i(t.apply(void 0,o))})}},e.colors=["#A69ACA","#EC6E79","#F39801","#00A496","#FFD900","#674599","#83D4E7","#AF7C4F","#B8D200","#9D5B8B","#F15B1C","#41464B","#CD9F00","#47885E","#D7003B","#436EC9","#F897C7","#9C4109","#6E7A56","#83D4E7","#83609C","#F8DCDB","#E7C39C","#87B151","#9E0038","#B09FC9","#7DCFC8","#BEE7F0","#CD9F00","#CBAAC2","#F5C5C9","#CD8C28","#1A5A52","#9EB4E1","#406619","#CAB738","#F6C751","#8D699D","#613A14","#189DEC"],e.last=function(t){if(0!==t.length)return t[t.length-1]},e.ERROR={ERR_UNKNOWN:"ERR_UNKNOWN",ERR_CHANGE_NOT_CONTINUOUS:"ERR_CHANGE_NOT_CONTINUOUS",ERR_ASSERTION:"ERR_ASSERTION",ERR_FN_INVOKE:"ERR_FN_INVOKE",ERR_PULL:"ERR_PULL",ERR_FILE_TOO_LARGE:"ERR_FILE_TOO_LARGE",ERR_APPLY_CHANGE:"ERR_APPLY_CHANGE",ERR_STORAGE_SET:"ERR_STORAGE_SET",ERR_ACCEPT_FAILED:"ERR_ACCEPT_FAILED",ERR_DISCONTINUOUS:"ERR_DISCONTINUOUS",ERR_NO_AUTH:"ERR_NO_AUTH",ERR_NO_PERMISSION:"ERR_NO_PERMISSION",ERR_BAD_REQUEST:"ERR_BAD_REQUEST",ERR_FILE_DELETED:"ERR_FILE_DELETED"};var i=function(){return function(t,r,n){this.message="Unknown error",this.code=e.ERROR.ERR_UNKNOWN,this.version=e.version,this.message=t,this.code=r,n&&(this.origin=n,this.originStatus=n.status?String(n.status):"UnknownStatus",this.stack=n.message+n.stack)}}();e.CollaborationError=i,e.getErrorCodeByHttpStatus=function(t){switch("string"==typeof t&&(t=parseInt(t,10)),t){case 400:return e.ERROR.ERR_BAD_REQUEST;case 401:return e.ERROR.ERR_NO_AUTH;case 403:return e.ERROR.ERR_NO_PERMISSION;case 404:return e.ERROR.ERR_FILE_DELETED;default:return e.ERROR.ERR_UNKNOWN}},e.noop=function(){},e.setReadonly=function(t){"function"==typeof t.disable&&t.disable(),"function"==typeof t.updateOptions&&t.updateOptions({editable:!1})},e.setEditable=function(t){"function"==typeof t.enable&&t.enable(),"function"==typeof t.updateOptions&&t.updateOptions({editable:!0})};var a=30;e.shorten=function(t){return t.length<a?t:t.slice(0,a)+"…(length="+t.length+")"};var s="undefined"!=typeof location;function u(t){0===t.indexOf("blob:")&&(t=t.slice(5));var e=t.indexOf("//"),r=t.slice(e+2).indexOf("/");return-1===r?t:t.slice(0,e+2+r)}e.modifyUrl=function(t){return 0===t.indexOf("http://")||0===t.indexOf("https://")?t:s?location.origin&&"blob://"!==location.origin?location.origin+t:u(location.href.slice(5))+t:t},e.getOriginFromHref=u},function(t,e,r){(function(n){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;e.splice(1,0,r,"color: inherit");let n=0,o=0;e[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&"%c"===t&&(o=++n)}),e.splice(o,0,r)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==n&&"env"in n&&(t=n.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=r(50)(e);const{formatters:o}=t.exports;o.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}).call(this,r(23))},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o=r(92);e.clone=function(t){return"object"!=typeof t||null===t?t:o(t,function(t){if("object"==typeof t&&t&&"function"==typeof t.clone)return t.clone()})},e.freeze=function(t){return t},e.isFrozen=function(t){return!1};var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ops=e,this.index=0,this.offset=0}return n(t,[{key:"hasNext",value:function(){return this.peekLength()<1/0}},{key:"next",value:function(t){t||(t=1/0);var e=this.ops[this.index];if(!e)return null;var r=this.offset,n=e.length;if(0===r&&n===t)return this.index+=1,e;t>=n-r?(t=n-r,this.index+=1,this.offset=0):this.offset+=t;var o={action:e.action,attributes:e.attributes};switch(e.action){case"remove":o.data=t;break;case"retain":if("number"==typeof e.data)o.data=t;else{if("string"==typeof e.data)throw new Error("retain with a string is not allowed");o.data=e.data}break;case"insert":"string"==typeof e.data?o.data=e.data.substr(r,t):"number"==typeof e.data?o.data=t:o.data=e.data}return e.createInstance(o)}},{key:"peekLength",value:function(){var t=this.ops[this.index];return t?t.length-this.offset:1/0}},{key:"peekAction",value:function(){var t=this.ops[this.index];return t?t.action:"retain"}}]),t}();e.OperatorIterator=i,e.parsePosition=function(t){for(var e=0,r=0,n=0;n<t.length;n++){var o=t[n].charCodeAt(0);if(o>=65&&o<=90)r=26*r+o-64;else{if(!(o>=48&&o<=57))throw new Error("Invalid cell position "+t);e=10*e+o-48}}return{row:e-1,col:r-1}},e.stringifyPosition=function(t,e){if(!(t>=0&&e>=0))throw new Error("Invalid cell position "+t+":"+e);for(var r=e+1,n="";r>0;){var o=(r-1)%26;n=String.fromCharCode(65+o)+n,r=Math.floor((r-o)/26)}return n+(t+1)}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())})},a=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},s=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};Object.defineProperty(e,"__esModule",{value:!0});var u=r(8),c=r(1),l=r(22),f=[].slice,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.delayRunTimeouts={},e}return n(e,t),e.prototype.delayRun=function(t,e){var r=this,n=t.toString(),o=this.delayRunTimeouts[n],i=f.call(arguments).slice(2);o&&clearTimeout(o),this.delayRunTimeouts[n]=setTimeout(function(){delete r.delayRunTimeouts[n],t.apply(r,i)},e)},e.prototype.cancelDelayRun=function(t){var e=t.toString(),r=this.delayRunTimeouts[e];return!!r&&(clearTimeout(r),delete this.delayRunTimeouts[e],!0)},e.prototype.assert=function(t,e){if(!t)throw new c.CollaborationError("Assertion error",c.ERROR.ERR_ASSERTION,e)},e.prototype.superDestroy=function(){for(var t in this.delayRunTimeouts)this.delayRunTimeouts[t]&&clearTimeout(this.delayRunTimeouts[t])},e.prototype.wrapAsyncTryCatch=function(t,e){var r=this;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return i(r,void 0,void 0,function(){var r;return a(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.apply(e,n)];case 1:return o.sent(),[3,3];case 2:return r=o.sent(),this.emitError("Try catch wrapper invoke error",c.ERROR.ERR_FN_INVOKE,r),[3,3];case 3:return[2]}})})}},e.prototype.track=function(t,e){void 0===e&&(e={});var r={message:t};e instanceof Error&&(e=o(o({},e),{message:e.message,stack:e.stack})),r.data=e,this.emit(c.Event.TRACK,r)},e.prototype.proxyEvent=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];r.forEach(function(r){t.on(r,function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e.emit.apply(e,s([r],t))})})},e.prototype.emitError=function(t,e,r){this.emit(c.Event.ERROR,new c.CollaborationError(t,e,r)),l.trackSensor("error",t,e)},e.prototype.emitWarning=function(t,e,r){this.emitWarning(t,e,r),l.trackSensor("warning",t,e)},e}(u.EventEmitter);e.Base=h},function(t,e){var r=9007199254740991,n="[object Arguments]",o="[object Function]",i="[object GeneratorFunction]",a=/^(?:0|[1-9]\d*)$/;var s=Object.prototype,u=s.hasOwnProperty,c=s.toString,l=s.propertyIsEnumerable,f=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),h=Math.max,p=!l.call({valueOf:1},"valueOf");function d(t,e){var r=b(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&_(t)}(t)&&u.call(t,"callee")&&(!l.call(t,"callee")||c.call(t)==n)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],o=r.length,i=!!o;for(var a in t)!e&&!u.call(t,a)||i&&("length"==a||y(a,o))||r.push(a);return r}function v(t,e,r){var n=t[e];u.call(t,e)&&m(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function y(t,e){return!!(e=null==e?r:e)&&("number"==typeof t||a.test(t))&&t>-1&&t%1==0&&t<e}function g(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||s)}function m(t,e){return t===e||t!=t&&e!=e}var b=Array.isArray;function _(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=r}(t.length)&&!function(t){var e=E(t)?c.call(t):"";return e==o||e==i}(t)}function E(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var w=function(t){return function(t,e){return e=h(void 0===e?t.length-1:e,0),function(){for(var r=arguments,n=-1,o=h(r.length-e,0),i=Array(o);++n<o;)i[n]=r[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=r[n];return a[e]=i,function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,a)}}(function(e,r){var n=-1,o=r.length,i=o>1?r[o-1]:void 0,a=o>2?r[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,a&&function(t,e,r){if(!E(r))return!1;var n=typeof e;return!!("number"==n?_(r)&&y(e,r.length):"string"==n&&e in r)&&m(r[e],t)}(r[0],r[1],a)&&(i=o<3?void 0:i,o=1),e=Object(e);++n<o;){var s=r[n];s&&t(e,s,n,i)}return e})}(function(t,e){if(p||g(e)||_(e))!function(t,e,r,n){r||(r={});for(var o=-1,i=e.length;++o<i;){var a=e[o],s=n?n(r[a],t[a],a,r,t):void 0;v(r,a,void 0===s?t[a]:s)}}(e,function(t){return _(t)?d(t):function(t){if(!g(t))return f(t);var e=[];for(var r in Object(t))u.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}(e),t);else for(var r in e)u.call(e,r)&&v(t,r,e[r])});t.exports=w},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){this.deltaConstructor=t,this.operatorConstructor=e}return t.prototype.compose=function(t,e,r){throw new Error("#compose() is not implemented")},t.prototype.transform=function(t,e,r){throw new Error("#transform() is not implemented")},t.prototype.invert=function(t,e){throw new Error("#invert() is not implemented")},t.prototype.parse=function(t){throw new Error("#parse() is not implemented")},t.prototype.pack=function(t,e){throw new Error("#pack() is not implemented")},t.prototype.toJSON=function(t){throw new Error("#toJSON() is not implemented")},t.prototype.explain=function(t,e){return""+t+e},t}();e.default=n},function(t,e,r){"use strict";var n=Object.prototype.hasOwnProperty,o="~";function i(){}function a(t,e,r,n,i){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new function(t,e,r){this.fn=t,this.context=e,this.once=r||!1}(r,n||t,i),s=o?o+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],a]:t._events[s].push(a):(t._events[s]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new i:delete t._events[e]}function u(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(o=!1)),u.prototype.eventNames=function(){var t,e,r=[];if(0===this._eventsCount)return r;for(e in t=this._events)n.call(t,e)&&r.push(o?e.slice(1):e);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(t)):r},u.prototype.listeners=function(t){var e=o?o+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,i=r.length,a=new Array(i);n<i;n++)a[n]=r[n].fn;return a},u.prototype.listenerCount=function(t){var e=o?o+t:t,r=this._events[e];return r?r.fn?1:r.length:0},u.prototype.emit=function(t,e,r,n,i,a){var s=o?o+t:t;if(!this._events[s])return!1;var u,c,l=this._events[s],f=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),f){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,r),!0;case 4:return l.fn.call(l.context,e,r,n),!0;case 5:return l.fn.call(l.context,e,r,n,i),!0;case 6:return l.fn.call(l.context,e,r,n,i,a),!0}for(c=1,u=new Array(f-1);c<f;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var h,p=l.length;for(c=0;c<p;c++)switch(l[c].once&&this.removeListener(t,l[c].fn,void 0,!0),f){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,e);break;case 3:l[c].fn.call(l[c].context,e,r);break;case 4:l[c].fn.call(l[c].context,e,r,n);break;default:if(!u)for(h=1,u=new Array(f-1);h<f;h++)u[h-1]=arguments[h];l[c].fn.apply(l[c].context,u)}}return!0},u.prototype.on=function(t,e,r){return a(this,t,e,r,!1)},u.prototype.once=function(t,e,r){return a(this,t,e,r,!0)},u.prototype.removeListener=function(t,e,r,n){var i=o?o+t:t;if(!this._events[i])return this;if(!e)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||n&&!a.once||r&&a.context!==r||s(this,i);else{for(var u=0,c=[],l=a.length;u<l;u++)(a[u].fn!==e||n&&!a[u].once||r&&a[u].context!==r)&&c.push(a[u]);c.length?this._events[i]=1===c.length?c[0]:c:s(this,i)}return this},u.prototype.removeAllListeners=function(t){var e;return t?(e=o?o+t:t,this._events[e]&&s(this,e)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=o,u.EventEmitter=u,t.exports=u},function(t,e,r){"use strict";var n;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.PUSHED=0]="PUSHED",t[t.MERGED=1]="MERGED",t[t.REORDERED=2]="REORDERED"}(n=e.PushResult||(e.PushResult={}));var o=function(){function t(t){void 0===t&&(t=[]),this.stringified=!1,this.ops=t}return t.prototype.push=function(t){if(this.stringified)throw new Error("Cannot push new operators to a stringified operatorList");var e=this.ops.length;if(0===e)return this.ops.push(t),n.PUSHED;var r=n.PUSHED,o=this.ops[e-1];if("remove"===o.action&&"insert"===t.action&&(e-=1,o=this.ops[e-1],r=n.REORDERED,void 0===o))return this.ops.unshift(t),r;var i=o.merge(t);return i?(this.ops[e-1]=i,r=n.MERGED):e===this.ops.length?this.ops.push(t):this.ops.splice(e,0,t),r},t.prototype.stringify=function(t){void 0===t&&(t=!1),this.stringified=!0;for(var e=this.ops.length,r="",n=0;n<e;n++){var o=this.ops[n];(!t||n<e-1||!o.isEmpty())&&(r+=o.stringify())}return r},t}();e.default=o},function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=[{name:"color"},{name:"background"},{name:"font-size"},{name:"width"},{name:"height"},{name:"rowspan"},{name:"colspan"},{name:"align",values:["left","center","right","justify"]},{name:"bold",values:[!1,!0]},{name:"italic",values:[!1,!0]},{name:"underline",values:[!1,!0]},{name:"vertical",values:["top","middle","bottom"]},{name:"strike",values:[!1,!0]},{name:"wrap",values:["text-wrap","text-no-wrap","text-linebreak-overflow"]},{name:"fixedRowsTop"},{name:"fixedColumnsLeft"},{name:"link"},{name:"format",values:["normal","0,0","0,0.00","0%","0.00%","0.00E+00","(0,0)","(0,0.00)","¥0,0","¥0,0.00","$0,0","$0,0.00","YYYY/MM/DD","YYYY-MM-DD","HH:mm:ss","YYYY/MM/DD HH:mm:ss","¥ (#,##0)","¥ (#,##0.00)","@","#,##0.0_);[Red](#,##0.0)","#,##0.0_);(#,##0.0)","#,##0.0;[Red]#,##0.0","#,##0.0_ ","#,##0.0_ ;[Red]-#,##0.0 ","#,##0_);[Red](#,##0)","#,##0_);(#,##0)","#,##0;[Red]#,##0","#,##0_ ","#,##0_ ;[Red]-#,##0 ","0.0_);[Red](0.0)","0.0_);(0.0)","0.0;[Red]0.0","0.0_ ","0.0_ ;[Red]-0.0 ","0_);[Red](0)","0_);(0)","0;[Red]0","0_ ","0_ ;[Red]-0 ","0.0%",'"$"#,##0.0_);[Red]("$"#,##0.0)','"¥"#,##0.0_);[Red]("¥"#,##0.0)','"$"#,##0.0_);("$"#,##0.0)','"¥"#,##0.0_);("¥"#,##0.0)','"$"#,##0.0;[Red]"$"#,##0.0','"¥"#,##0.0;[Red]"¥"#,##0.0','"$"#,##0.0','"¥"#,##0.0','"$"#,##0.0;[Red]-"$"#,##0.0','"¥"#,##0.0;[Red]-"¥"#,##0.0','"$"#,##0_);[Red]("$"#,##0)','"¥"#,##0_);[Red]("¥"#,##0)','"$"#,##0_);("$"#,##0)','"¥"#,##0_);("¥"#,##0)','"$"#,##0;[Red]"$"#,##0','"¥"#,##0;[Red]"¥"#,##0','"$"#,##0','"¥"#,##0','"$"#,##0;[Red]-"$"#,##0','"¥"#,##0;[Red]-"¥"#,##0','_("$"* #,##0.0_);_("$"* (#,##0.0);_("$"* "-"??_);_(@_)','_("¥"* #,##0.0_);_("¥"* (#,##0.0);_("¥"* "-"??_);_(@_)','_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)','_("¥"* #,##0_);_("¥"* (#,##0);_("¥"* "-"_);_(@_)',"yyyy/m/d","yyyy/mm/dd;@","yyyy-mm-dd;@","yy/mm/dd;@","yy-mm-dd;@","mm/dd;@","mm-dd;@","yyyy-m-d;@","yy/m/d;@","yy-m-d;@","m/d;@","m-d;@","m/d/yy;@","mm/dd/yy;@","d;@","dd;@",'yyyy"年"m"月"d"日" aaaa','yyyy"年"m"月"d"日";@','yyyy"年"m"月";@','m"月"d"日";@','[$-804]yyyy"年"mm"月"dd"日" aaaa;@','yyyy"年"mm"月"dd"日";@','yyyy"年"mm"月";@','mm"月"dd"日";@','m"月";@','mm"月";@','[DBNum1][$-804]m"月";@',"[$-804]aaaa;@","[$-804]aaa;@",'[DBNum1][$-804]yyyy"年"m"月"d"日";@','[DBNum1][$-804]yyyy"年"m"月";@','[DBNum1][$-804]m"月"d"日";@',"[$-409]d-mmm;@","[$-409]d-mmm-yy;@","[$-409]dd-mmm-yy;@","[$-409]mmm-yy;@","[$-409]mmmm-yy;@","[$-409]mmmmm;@","[$-409]mmmmm-yy;@","[$-409]yyyy/mm/dd h:mm AM/PM;@","yyyy/mm/dd hh:mm;@","[$-409]yyyy/m/d h:mm AM/PM;@","yyyy/m/d h:mm;@","[$-409]yyyy/mm/dd h:mm:ss AM/PM;@","yyyy/mm/dd hh:mm:ss;@","[$-409]yyyy/m/d h:mm:ss AM/PM;@","yyyy/m/d h:mm:ss;@","h:mm:ss;@","h:mm;@","AM/PM h:mm:ss",'上午/下午h"时"mm"分"ss"秒";@','上午/下午h"时"mm"分";@','[DBNum1][$-804]h"时"mm"分";@','[DBNum1][$-804]上午/下午h"时"mm"分";@',"[$-409]h:mm AM/PM;@","[$-409]h:mm:ss AM/PM;@",'h"时"mm"分";@','h"时"mm"分"ss"秒";@',"# ?/?","# ??/??","# ???/???","# ?/2","# ?/4","# ?/8","# ??/16","# ?/10","# ??/100","0.0E+00","0E+00","000000","[DBNum1][$-804]General","[DBNum2][$-804]General"]},{name:"formula"},{name:"filter"},{name:"border-top"},{name:"border-right"},{name:"border-bottom"},{name:"border-left"},{name:"line"},{name:"guid"},{name:"author"},{name:"size"},{name:"list"},{name:"layout",values:["embed","block"]},{name:"margin",values:["none","small","medium","large"]},{name:"font",values:["serif","monospace","microsoftyahei","simsun","kaiti","simhei","fangsong","droid","source","arial","notosans","notoserif","timesnewroman","fzcchk","fzfsk","fzhtk","fzktk","fzlsk","fzssk","fzxbsk"]},{name:"header"},{name:"indent"},{name:"comment"},{name:"comment-block"},{name:"code-block",values:[!0].concat(["1c","accesslog","actionscript","ada","apache","applescript","arduino","armasm","asciidoc","aspectj","abnf","autohotkey","autoit","avrasm","awk","bnf","bash","basic","brainfuck","cal","cs","cpp","cos","capnproto","ceylon","clean","clojure","clojure-repl","cmake","coffeescript","coq","crmsh","crystal","csp","css","d","dart","delphi","dts","diff","django","dns","dockerfile","dos","dsconfig","dust","elixir","elm","erb","erlang","erlang-repl","excel","ebnf","fsharp","fix","flix","fortran","gcode","gams","gauss","gherkin","glsl","go","golo","gradle","groovy","haml","handlebars","haskell","haxe","hsp","xml","htmlbars","http","hy","inform7","x86asm","irpf90","java","javascript","jboss-cli","json","julia","julia-repl","kotlin","lasso","ldif","leaf","less","lisp","livecodeserver","livescript","llvm","lsl","lua","makefile","markdown","mathematica","matlab","maxima","mel","mercury","axapta","routeros","mipsasm","mizar","mojolicious","monkey","moonscript","n1ql","nginx","nimrod","nix","nsis","objectivec","ocaml","openscad","ruleslanguage","oxygene","parser3","perl","pf","php","pony","powershell","processing","prolog","protobuf","puppet","purebasic","python","profile","q","qml","r","rib","rsl","roboconf","ruby","rust","scala","scheme","scilab","scss","shell","smali","smalltalk","sml","sqf","sql","stan","stata","step21","stylus","subunit","swift","taggerscript","tcl","tap","tex","thrift","ini","tp","twig","typescript","vala","vbnet","vbscript","vbscript-html","verilog","vhdl","vim","xl","xquery","yaml","zephir","plain"])},{name:"cellValue"},{name:"precision"},{name:"autoFormatter",values:["#,##0_);[Red](#,##0)","#,##0.00_);[Red](#,##0.00)",'"¥"#,##0_);[Red]("¥"#,##0)','"¥"#,##0.00_);[Red]("¥"#,##0.00)','"$"#,##0_);[Red]("$"#,##0)','"$"#,##0.00_);[Red]("$"#,##0.00)',"0%","0.00%","# ??/??","0.00E+00","yyyy/m/d",'m"月"d"日";@','yyyy"年"m"月"d"日";@','yyyy"年"m"月";@',"[$-409]yyyy/mm/dd h:mm:ss AM/PM;@","[$-409]yyyy/mm/dd h:mm AM/PM;@","yyyy/mm/dd hh:mm:ss;@","h:mm;@","[$-409]h:mm AM/PM;@","h:mm:ss;@","[$-409]h:mm:ss AM/PM;@",'h"时"mm"分";@','h"时"mm"分"ss"秒";@','[$-804]AM/PMh"时"mm"分";@','[$-804]AM/PMh"时"mm"分"ss"秒";@',"[$-409]mmm-yy;@","h:mm:ss.0;@","[$-409]h:mm:ss.0 AM/PM;@","yyyy/mm/dd hh:mm;@","yyyy/mm/dd hh:mm:ss.0;@","yyyy/m;@"]},{name:"baseContentLength"}],i=o.reduce(function(t,e,r){return e.index=r,t[e.name]=e,t},{});t.exports={BASE_CONTENT_LENGTH:"baseContentLength",pack:function(t){if("object"==typeof t&&null!==t){var e=[];for(var r in t)if(t.hasOwnProperty(r)){var n=t[r];if(void 0!==n){var o=i[r];if(o&&(r=o.index,o.values&&null!==n)){var a=o.values.indexOf(n);if(-1!==a)n=a;else if(17!==r)continue}e.push(null===n?r:r+":"+JSON.stringify("string"==typeof n?encodeURIComponent(n):n))}}return e.sort().join("|")}},unpack:function(t){if("string"!=typeof t)return{};for(var e={},r=t.split("|"),i=0;i<r.length;i++){var a=r[i].split(":"),s=n(a,2),u=s[0],c=s[1],l=o[u];if(c){var f=typeof(c=JSON.parse(c));"string"===f&&(c=decodeURIComponent(c)),l&&(u=l.name,l.values&&"number"===f&&void 0!==l.values[c]&&(c=l.values[c]))}else l&&(u=l.name),c=null;e[u]=c}return e},merge:function(t,e,r){if(r&&!t)return e;if(!e)return t;for(var n in t=this.unpack(t),e=this.unpack(e))e.hasOwnProperty(n)&&(t[n]=e[n],r||null!==t[n]||delete t[n]);return this.pack(t)},invert:function(t,e){if(e){if(!t)return e.split("|").map(function(t){var e=t.indexOf(":");return-1===e?t:t.slice(0,e)}).join("|");for(var r in t=this.unpack(t),e=this.unpack(e))e.hasOwnProperty(r)&&(void 0!==t[r]?e[r]=t[r]:e[r]=null);return this.pack(e)}},transform:function(t,e,r){if(r)return e;if(e){if(!t)return e;for(var n in t=this.unpack(t),e=this.unpack(e))e.hasOwnProperty(n)&&void 0!==t[n]&&delete e[n];return this.pack(e)}},diff:function(t,e){if(!t)return e;t=this.unpack(t),e&&(e=this.unpack(e));for(var r={},n=!0,o=e?Object.keys(t).concat(Object.keys(e)):Object.keys(t),i=0;i<o.length;i++){var a=o[i],s=e?e[a]:void 0;t[a]!==s&&(n=!1,r[a]=void 0===s?null:s)}return n?void 0:this.pack(r)}}},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o=r(3),i=r(93),a=r(94),s=String.fromCharCode(0),u=r(10),c=r(97),l=function(){function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ops=[],Array.isArray(e)){for(var n=0;n<e.length;n++)this.pushWithMutations(e[n]);r&&this.chopWithMutations()}else"function"==typeof e&&e(this);o.freeze(this)}return n(t,[{key:"freeze",value:function(){o.freeze(this.ops)}},{key:"createCleaner",value:function(){for(var e=[],r=0;r<this.ops.length;r++){var n=this.ops[r],o=n.createInstance({action:"remove",data:n.length});e.push(o)}return new t(e)}},{key:"clone",value:function(){return new t(this.ops.map(o.clone))}},{key:"toJSON",value:function(){return this.ops}},{key:"pack",value:function(){return this.ops.map(function(t){return t.pack()})}},{key:"isDocument",value:function(){for(var t=0;t<this.ops.length;t++)if("insert"!==this.ops[t].action)return!1;return!0}},{key:"isEmpty",value:function(){return 0===this.ops.length}},{key:"_genericPush",value:function(t,e){var r=t.length,n=t[r-1];if(n&&"remove"===n.action&&"insert"===e.action&&(n=t[(r-=1)-1]),!n)return t.unshift(e),t;var o=e.merge(n);return o?t[r-1]=o:r===t.length?t.push(e):t.splice(r,0,e),t}},{key:"push",value:function(e){if(!e.length)return this;var r=this.ops.slice(0);if(Array.isArray(e)){for(var n=!1,o=0;o<e.length;o++)e[o].length&&(n=!0,r=this._genericPush(r,e[o]));if(!n)return this}else r=this._genericPush(r,e);return new t(r)}},{key:"pushWithMutations",value:function(t){return t.length&&this._genericPush(this.ops,t),this}},{key:"concat",value:function(e){var r=this;return e.ops.length?this.ops.length?new t(function(t){t.ops=r.ops.slice(),t.pushWithMutations(e.ops[0]),e.ops.length>1&&(t.ops=t.ops.concat(e.ops.slice(1)))}):e:this}},{key:"_genericChop",value:function(t){for(;t.length&&t[t.length-1].isEmpty();)t.pop();return t}},{key:"chop",value:function(){return new t(this._genericChop(this.ops.slice(0)))}},{key:"chopWithMutations",value:function(){return this._genericChop(this.ops),this}},{key:"slice",value:function(e,r){e=e||0,"number"!=typeof r&&(r=1/0);for(var n=[],o=this.getIter(),i=0;i<r&&o.hasNext();){var a=void 0;i<e?a=o.next(e-i):(a=o.next(r-i),n.push(a)),i+=a.length}return new t(n)}},{key:"getIter",value:function(){return new o.OperatorIterator(this.ops)}},{key:"validate",value:function(){for(var t={},e=0;e<this.ops.length;e++){var r=this.ops[e];if(r&&"TableOperator"===r.name()){var n=r.getAttributes().name;if(!n)continue;var o="$$"+n+"$$";if(t.hasOwnProperty(o))throw new Error("Duplicated table name found: "+n);t[o]=!0}}return this}},{key:"isTableADocument",value:function(){for(var t=this,e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=function(r){var n=t.ops[r];if(n&&"TableOperator"===n.name()&&n.data.cells.some(function(t){var e=n.data.cells.get(t);return!(!e.data||"number"==typeof e.data||"function"!=typeof e.data.isDocument)&&!1===e.data.isDocument()},e))return{v:!1}},n=0;n<this.ops.length;n++){var o=r(n);if("object"==typeof o)return o.v}return!0}},{key:"compose",value:function(e){for(var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getIter(),o=e.getIter(),i=[];n.hasNext()||o.hasNext();)if("insert"===o.peekAction())i.push(o.next());else if("remove"===n.peekAction())i.push(n.next());else{var a=Math.min(n.peekLength(),o.peekLength()),s=n.next(a),u=o.next(a);u&&"retain"!==u.action?s&&"retain"!==s.action||i.push(u):s?u?i.push(s.compose(u,r)):i.push(s):i.push(u)}var c=new t(i,!0);return r||c.validate(),c}},{key:"composePosition",value:function(t){for(var e=this.getIter(),r=0;e.hasNext()&&r<=t;){var n=e.peekLength(),o=e.peekAction();switch(e.next(),o){case"remove":if(n>t-r)return null;t-=n;continue;case"insert":t+=n}r+=n}return t}},{key:"invert",value:function(e){for(var r=this.getIter(),n=e.getIter(),o=[];n.hasNext();)if("insert"===n.peekAction()){var i=n.next(),a=i.createInstance({action:"remove",data:i.length});o.push(a)}else{if(!r.hasNext())throw new Error(this.constructor.name+" should be smaller than document");var s=Math.min(r.peekLength(),n.peekLength()),u=r.next(s),c=n.next(s);if("insert"!==u.action)throw new Error("Only document can invert deltas");"retain"===c.action?o.push(u.invert(c)):o.push(u)}return new t(o,!0)}},{key:"invertPosition",value:function(t){for(var e=this.getIter(),r=0;e.hasNext()&&r<=t;){var n=e.peekLength(),o=e.peekAction();switch(e.next(),o){case"insert":if(n>t-r)return null;t-=n;continue;case"remove":t+=n}r+=n}return t}},{key:"transform",value:function(e,r){for(var n=this.getIter(),o=e.getIter(),i=[];o.hasNext();)if("insert"!==n.peekAction()||!r&&"insert"===o.peekAction())if("insert"===o.peekAction())i.push(o.next());else{var a=Math.min(n.peekLength(),o.peekLength()),s=n.next(a),u=o.next(a);if(s&&"remove"===s.action)continue;u&&"remove"===u.action?i.push(u):s?i.push(s.transform(u,r)):i.push(u)}else{var c=n.next();i.push(c.createInstance({action:"retain",data:c.length}))}return new t(i,!0)}},{key:"transformPosition",value:function(t,e){for(var r=this.getIter(),n=0;r.hasNext()&&n<=t;){var o=r.peekLength(),i=r.peekAction();switch(r.next(),i){case"remove":t-=Math.min(o,t-n);continue;case"insert":(n<t||!e)&&(t+=o)}n+=o}return t}},{key:"toString",value:function(){for(var t="",e=0;e<this.ops.length;e++){var r=this.ops[e];if("insert"!==r.action)throw new Error("toString() called on non-document");t+="string"==typeof r.data?r.data:s}return t}},{key:"diff",value:function(e,r){if(this.ops===e.ops)return new t;if(!this.ops.length){if(!e.isDocument())throw new Error("diff() called on non-document");return e}for(var n=c(this.ops[0].createInstance,this.ops[0]),o=[],s=i(this.toString(),e.toString(),r),l=this.getIter(),f=e.getIter(),h=0,p=s.length;h<p;h++)for(var d=s[h],v=d[1].length;v>0;){var y=0;switch(d[0]){case i.INSERT:y=Math.min(f.peekLength(),v),o.push(f.next(y));break;case i.DELETE:y=Math.min(v,l.peekLength()),l.next(y),o.push(n({action:"remove",data:y}));break;case i.EQUAL:y=Math.min(l.peekLength(),f.peekLength(),v);var g=l.next(y),m=f.next(y);g.skipDiff()&&m.skipDiff()&&g.name()===m.name()||a(g.data,m.data)?o.push(n({action:"retain",data:y,attributes:u.diff(g.attributes,m.attributes)})):(o.push(m),o.push(n({action:"remove",data:y})))}v-=y}return new t(o,!0)}},{key:"print",value:function(t){console[t?"group":"groupCollapsed"]("Delta["+this.length+"] with "+this.ops.length+" operators"),this.ops.forEach(function(t){return t.print()}),console.groupEnd()}},{key:"setBaseContentLengthAttr",value:function(e){if(isNaN(e))throw new Error("baseContentLength should be a number");if(this.isEmpty())return new t([]);var r=this.ops.slice(),n=r[0],o=n.getAttributes();return o[u.BASE_CONTENT_LENGTH]=e,r[0]=n.createInstance({action:n.action,data:n.data,attributes:u.pack(o)}),new t(r)}},{key:"removeBaseContentLengthAttr",value:function(){if(this.isEmpty())return new t([]);var e=this.ops.slice(),r=e[0],n=r.getAttributes();return delete n[u.BASE_CONTENT_LENGTH],e[0]=r.createInstance({action:r.action,data:r.data,attributes:u.pack(n)}),new t(e)}},{key:"length",get:function(){for(var t=0,e=0;e<this.ops.length;e++)t+=this.ops[e].length;return t}},{key:"baseContentLength",get:function(){if(this.isEmpty())return-1;var t=this.ops[0].getAttributes();return t[u.BASE_CONTENT_LENGTH]?t[u.BASE_CONTENT_LENGTH]:-1}}],[{key:"unpack",value:function(t){var e=this;return new this(t.map(function(t){return e.operatorUnpacker(t)}))}}]),t}();l.packId=5,t.exports=l},function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var i=r(11),a=r(3).clone,s=r(10),u=r(3),c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.setWithMutations(e);var r="Operator"!==this.name()&&this.isGeneric()?this.toGeneric():this;return u.freeze(r),r}return o(t,[{key:"name",value:function(){return"Operator"}},{key:"skipDiff",value:function(){return!1}},{key:"isGeneric",value:function(){var t=4===this.constructor.packId;return"number"==typeof this.data&&!t}},{key:"toGeneric",value:function(){return new t({action:this.action,data:this.data,attributes:this.attributes})}},{key:"clone",value:function(){var t=this.createInstance(this);return t.data=a(t.data),t}},{key:"_genericSet",value:function(t){var e={action:this.action,data:this.data,attributes:this.attributes},r=!1,n=t.action;if(n&&n!==e.action){if(r=!0,"insert"!==n&&"retain"!==n&&"remove"!==n)throw new Error('Action "'+n+'" is invalid');e.action=n}var o=t.data;if(null!=o&&o!==e.data){if(r=!0,"remove"===e.action&&("number"!=typeof o||o<0))throw new Error("Expect the data of remove action to be a positive number, got "+o);e.data=o}if(null==e.data)throw new Error("Expect data to have a non-empty value, got "+e.data);var i=t.attributes;if(i){var a=typeof i;if("object"===a)if(Object.keys(i).length){var u=s.pack(i);u&&e.attributes!==u&&(r=!0,e.attributes=u)}else e.attributes&&(r=!0,delete e.attributes);else"string"===a&&e.attributes!==i&&(r=!0,e.attributes=i)}return{changed:r,op:e}}},{key:"set",value:function(t){var e=this._genericSet(t),r=e.changed,n=e.op;return r?this.createInstance(n):this}},{key:"setWithMutations",value:function(t){var e=this._genericSet(t).op;return this.action=e.action,this.data=e.data,this.attributes=e.attributes,this}},{key:"createInstance",value:function(t){return new this.constructor(t)}},{key:"toJSON",value:function(){return this.pack()}},{key:"pack",value:function(){var t=void 0;switch(this.action){case"insert":t=0;break;case"remove":t=1;break;case"retain":t=2}var e="function"==typeof this.data.pack?this.data.pack():this.data,r=[Number(""+this.constructor.packId+t),e];return this.attributes&&r.push(this.attributes),r}},{key:"getEmbedObject",value:function(){throw new Error("#getEmbedObject() not implemented")}},{key:"isEmpty",value:function(){return"retain"===this.action&&!this.attributes&&"number"==typeof this.data}},{key:"getAttributes",value:function(){return s.unpack(this.attributes)}},{key:"merge",value:function(t){if(this.name()!==t.name())return!1;var e=typeof this.data;return!(this.action!==t.action||e!==typeof t.data||"number"!==e&&"string"!==e||this.attributes!==t.attributes)&&t.set({data:t.data+this.data})}},{key:"compose",value:function(t){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be composed");if(this.constructor.packId!==t.constructor.packId&&!this.isGeneric()&&!t.isGeneric())throw new Error('Failed to compose operators. Expect constructor "'+t.constructor.name+'" to equal "'+this.constructor.name+'"');var e=void 0;return e="function"==typeof this.data.compose&&t.data.constructor.packId===this.data.constructor.packId?this.data.compose(t.data):"number"==typeof this.data?t.data:this.data,(this.isGeneric()?t:this).createInstance({data:e,attributes:s.merge(this.attributes,t.attributes,"insert"!==this.action),action:this.action})}},{key:"invert",value:function(t){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.constructor.name+")");if("retain"!==t.action)throw new Error("Only retaining operator can be inverted");if(this.constructor.packId!==t.constructor.packId&&!t.isGeneric())throw new Error('Failed to invert operators. Expect constructor "'+t.constructor.name+'" to equal "'+this.constructor.name+'"');var e=void 0;return e="function"==typeof this.data.invert&&t.data.constructor.packId===this.data.constructor.packId?this.data.invert(t.data):"number"==typeof t.data?t.data:this.data,this.createInstance({data:e,attributes:s.invert(this.attributes,t.attributes),action:"retain"})}},{key:"transform",value:function(t,e){if("retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be transformd");if(this.constructor.packId!==t.constructor.packId&&!t.isGeneric()&&!this.isGeneric())throw new Error('Failed to transform operators. Expect constructor "'+t.constructor.name+'" to equal "'+this.constructor.name+'"');return(this.isGeneric()?t:this).createInstance({attributes:s.transform(this.attributes,t.attributes,e),action:"retain",data:"function"==typeof this.data.transform&&"function"==typeof t.data.transform?this.data.transform(t.data,e):t.data})}},{key:"print",value:function(){var t=[this.action+": %c"+this.name(),"color: #51c6ed"];this.attributes&&(t[0]=t[0]+"%c, %O",t.push("font-weight: normal; color: #000",this.attributes.toJS())),console.groupCollapsed.apply(console,t),function t(e){"function"==typeof e.pack?e.print():"object"==typeof e?Object.keys(e).forEach(function(r){var n=e[r];console.groupCollapsed(r),t(n),console.groupEnd()}):console.log(e)}(this.data),console.groupEnd()}},{key:"length",get:function(){switch(typeof this.data){case"number":return this.data;case"string":return this.data.length;default:return 1}}}],[{key:"unpack",value:function(t){var e=n(t,3),r=e[0],o=e[1],a=e[2];return new this({action:["insert","remove","retain"][r],data:Array.isArray(o)?i.unpack(o):o,attributes:a})}},{key:"insert",value:function(t,e){return new this({action:"insert",data:t,attributes:e})}},{key:"retain",value:function(t,e){return new this({action:"retain",data:t,attributes:e})}},{key:"remove",value:function(t){return new this({action:"remove",data:t})}}]),t}();c.packId=1,t.exports=c},function(t,e,r){var n=r(46),o=r(47),i=o;i.v1=n,i.v4=o,t.exports=i},function(t,e,r){"use strict";var n=r(52),o=r(53),i=r(54);function a(t,e){return e.encode?e.strict?n(t):encodeURIComponent(t):t}function s(t){var e=t.indexOf("?");return-1===e?"":t.slice(e+1)}function u(t,e){var r=function(t){var e;switch(t.arrayFormat){case"index":return function(t,r,n){e=/\[(\d*)\]$/.exec(t),t=t.replace(/\[\d*\]$/,""),e?(void 0===n[t]&&(n[t]={}),n[t][e[1]]=r):n[t]=r};case"bracket":return function(t,r,n){e=/(\[\])$/.exec(t),t=t.replace(/\[\]$/,""),e?void 0!==n[t]?n[t]=[].concat(n[t],r):n[t]=[r]:n[t]=r};default:return function(t,e,r){void 0!==r[t]?r[t]=[].concat(r[t],e):r[t]=e}}}(e=o({arrayFormat:"none"},e)),n=Object.create(null);return"string"!=typeof t?n:(t=t.trim().replace(/^[?#&]/,""))?(t.split("&").forEach(function(t){var e=t.replace(/\+/g," ").split("="),o=e.shift(),a=e.length>0?e.join("="):void 0;a=void 0===a?null:i(a),r(i(o),a,n)}),Object.keys(n).sort().reduce(function(t,e){var r=n[e];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?t[e]=function t(e){return Array.isArray(e)?e.sort():"object"==typeof e?t(Object.keys(e)).sort(function(t,e){return Number(t)-Number(e)}).map(function(t){return e[t]}):e}(r):t[e]=r,t},Object.create(null))):n}e.extract=s,e.parse=u,e.stringify=function(t,e){!1===(e=o({encode:!0,strict:!0,arrayFormat:"none"},e)).sort&&(e.sort=function(){});var r=function(t){switch(t.arrayFormat){case"index":return function(e,r,n){return null===r?[a(e,t),"[",n,"]"].join(""):[a(e,t),"[",a(n,t),"]=",a(r,t)].join("")};case"bracket":return function(e,r){return null===r?a(e,t):[a(e,t),"[]=",a(r,t)].join("")};default:return function(e,r){return null===r?a(e,t):[a(e,t),"=",a(r,t)].join("")}}}(e);return t?Object.keys(t).sort(e.sort).map(function(n){var o=t[n];if(void 0===o)return"";if(null===o)return a(n,e);if(Array.isArray(o)){var i=[];return o.slice().forEach(function(t){void 0!==t&&i.push(r(n,t,i.length))}),i.join("&")}return a(n,e)+"="+a(o,e)}).filter(function(t){return t.length>0}).join("&"):""},e.parseUrl=function(t,e){return{url:t.split("?")[0]||"",query:u(s(t),e)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.OFFLINE="offline",t.OFFLINE_SAVING="offlineSaving",t.OFFLINE_SAVED="offlineSaved",t.OFFLINE_SAVE_FAILED="offlineSaveFailed",t.ONLINE="online",t.ONLINE_SAVING="onlineSaving",t.ONLINE_SAVED="onlineSaved",t.ONLINE_SAVE_FAILED="onlineSaveFailed",t.SERVER_CHANGE_APPLIED="serverChangeApplied",t.SERVER_CHANGE_PENDING="serverChangePending"}(e.Status||(e.Status={}))},function(t,e,r){t.exports=r(60)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TYPE_PROPERTY="__MODOC_NAME__"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(37),o=r(38),i="0:",a=function(){function t(e,r){this.action=e.action;var n,o=e.data;if(null===o||void 0===o)throw new Error('"data" is required for an Operator');if("object"==typeof o){var a=Object.keys(o)[0],s=o[a];if("string"==typeof s)this.data=o,this.dataType=a;else{var u=t.dataHandlers[a];if(!u)throw new Error('Unsupported nested data type "'+a+'"');var c=u.pack(s,"insert"===this.action);"delta"===a&&c===i?(this.data=1,this.dataType="number"):(this.data=((n={})[a]=c,n),this.dataType=a)}}else this.data=o,this.dataType=typeof o;this.packedAttributes=e.packedAttributes,this.pool=e.pool,this.packedData=r}return t.isOperator=function(t){return"function"==typeof t.getAttributes},t.registerDataHandler=function(e,r){t.dataHandlers[e]=r},t.getUnresolvedAttributes=function(t){return"function"==typeof t.getUnresolvedAttributes?t.getUnresolvedAttributes():t.getAttributes()},Object.defineProperty(t.prototype,"length",{get:function(){return"string"==typeof this.data?this.data.length:"number"==typeof this.data?this.data:1},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return"retain"===this.action&&(""===this.packedAttributes||void 0===this.packedAttributes)&&"number"==typeof this.data},t.prototype.getParsedData=function(){var e=t.dataHandlers[this.dataType];if(void 0===e)throw new Error("Unknown handler for "+this.dataType);return e.parse(this.getCustomData())},t.prototype.hasAttributes=function(){return void 0!==this.packedAttributes&&""!==this.packedAttributes},t.prototype.getAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes):{}},t.prototype.stringify=function(){if(void 0===this.packedData){var t=this.data,e=void 0;switch(this.action){case"insert":e="!";break;case"retain":e="@";break;default:e="#"}if("number"==typeof t)e+=t.toString(36)+"#";else if("string"==typeof t)e+=t.length.toString(36)+"!"+t;else{var r=this.dataType;if(void 0===r)throw new Error("ASSERT: dataType === undefined");var o=n.objectKeyToInitial[r];if(!o)throw new Error('Unsupport object data type: "'+r+'"');var i=""+o+t[r];e+=i.length.toString(36)+"@"+i}this.packedData=e}var a=void 0===this.packedAttributes?this.packedData:this.packedData+this.packedAttributes;return a.length.toString(36)+a},t.prototype.merge=function(e){if(this.action!==e.action)return null;var r=typeof this.data;if("object"===r||r!==typeof e.data)return null;var n=this.hasAttributes();if(n!==e.hasAttributes())return null;if(n)if(this.pool===e.pool){if(this.packedAttributes!==e.packedAttributes)return null}else if(!function(t,e){if(t===e)return!0;var r=Object.keys(t),n=r.length;if(n!==Object.keys(e).length)return!1;for(var o=0;o<n;o++)if(t[r[o]]!==e[r[o]])return!1;return!0}(this.getUnresolvedAttributes(),t.getUnresolvedAttributes(e)))return null;return new t({action:this.action,data:this.data+e.data,pool:this.pool,packedAttributes:this.packedAttributes})},t.prototype.getCustomData=function(){switch(typeof this.data){case"string":case"number":throw new Error("Cannot get custom data from a simple operator");default:return this.data[this.dataType]}},t.prototype.compose=function(e,r){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==e.action)throw new Error("Only retaining operator can be composed");var n,a,s,u=!1;if(e.hasAttributes()){if(void 0===this.pool)throw new Error("this.pool is undefined when composing");var c=t.getUnresolvedAttributes(e);u=c.hasOwnProperty("cellValue");var l=o.merge(this.getUnresolvedAttributes(),c,!r);a=this.pool.packAttributes(l)}else a=this.packedAttributes;if(u)n="number"===e.dataType?e.data:1;else if("number"===this.dataType)n=e.data;else if("number"===e.dataType)n=this.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when composing '+this.data+" with "+e.data);if(this.dataType!==e.dataType)throw new Error("Expect "+e.dataType+" to equal "+this.dataType+" when composing "+this.data+" with "+e.data);var f=t.dataHandlers[this.dataType];if(void 0===f)throw new Error("Unknown handler for "+this.dataType);var h=f.compose(this.getCustomData(),e.getCustomData(),r);n="delta"===this.dataType&&h===i?1:((s={})[this.dataType]=h,s)}return new t({action:this.action,data:n,pool:this.pool,packedAttributes:a})},t.prototype.transform=function(e,r){if(void 0===r&&(r=!1),"retain"!==this.action)throw new Error("Only retaining operator can transform other operators");if("retain"!==e.action)throw new Error("Only retaining operator can be transformed");var n,a,s;if("number"===this.dataType||"number"===e.dataType)n=e.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when transforming '+this.data+" with "+e.data);if(this.dataType!==e.dataType)throw new Error("Expect "+e.dataType+" to equal "+this.dataType+" when transforming "+this.data+" with "+e.data);var u=t.dataHandlers[this.dataType];if(void 0===u)throw new Error("Unknown handler for "+this.dataType);var c=u.transform(this.getCustomData(),e.getCustomData(),r);n="delta"===this.dataType&&c===i?1:((s={})[this.dataType]=c,s)}if(e.hasAttributes()){var l=o.transform(this.getUnresolvedAttributes(),t.getUnresolvedAttributes(e),r);if(void 0===e.pool)throw new Error("ASSERT: other.pool === undefined when transforming");a=e.pool.packAttributes(l)}else a="";return new t({action:this.action,data:n,pool:e.pool,packedAttributes:a})},t.prototype.invert=function(e,r){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.dataType+")");if("retain"!==e.action)throw new Error("Only retaining operator can be inverted");var n,a,s,u=!1;if(e.hasAttributes()){var c=t.getUnresolvedAttributes(e);u=c.hasOwnProperty("cellValue");var l=o.invert(this.getUnresolvedAttributes(),c);if(void 0===e.pool)throw new Error("ASSERT: other.pool === undefined when inverting");a=e.pool.packAttributes(l)}else a="";if(u)n=this.data;else if(void 0!==r)n=r;else if("number"==typeof e.data)n=e.data;else if("number"==typeof this.data&&"delta"!==e.dataType)n=this.data;else{if(void 0===this.dataType)throw new Error('Missing "dataType" when inverting '+this.data+" with "+e.data);if("number"===this.dataType&&"delta"===e.dataType){n={delta:(f=t.dataHandlers.delta).invert(i,e.getCustomData())}}else{if(this.dataType!==e.dataType)throw new Error("Expect "+e.dataType+" to equal "+this.dataType+" when inverting "+this.data+" with "+e.data);var f;if(void 0===(f=t.dataHandlers[this.dataType]))throw new Error("Unknown handler for "+this.dataType);var h=f.invert(this.getCustomData(),e.getCustomData());n="delta"===this.dataType&&h===i?1:((s={})[this.dataType]=h,s)}}return new t({data:n,action:"retain",pool:e.pool,packedAttributes:a})},t.prototype.toJSON=function(){var e,r={action:this.action};if(this.hasAttributes()&&(r.attributes=this.getAttributes()),"number"===this.dataType||"string"===this.dataType)r.data=this.data;else{var n=t.dataHandlers[this.dataType],o=this.getCustomData();r.data=((e={})[this.dataType]=n?n.toJSON(o):o,e)}return r},t.prototype.explain=function(e){void 0===e&&(e="");var r=this.stringify().length,n=e+"["+this.dataType+"("+this.action+")] #"+(r-String(r).length)+":\n";if("number"===this.dataType||"string"===this.dataType)n+=e+this.data;else{var o=t.dataHandlers[this.dataType],i=this.getCustomData();n+=o?o.explain(e+"  ",i):i}return n+"\n"+e+"PackedAttributes:"+this.packedAttributes+"\n"},t.prototype.getUnresolvedAttributes=function(){return void 0!==this.pool&&this.hasAttributes()?this.pool.unpackAttributes(this.packedAttributes,!1):{}},t.dataHandlers={},t}();e.default=a},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){var r="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);t.exports=function(){return r(n),n}}else{var o=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0==(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},function(t,e){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);t.exports=function(t,e){var n=e||0,o=r;return o[t[n++]]+o[t[n++]]+o[t[n++]]+o[t[n++]]+"-"+o[t[n++]]+o[t[n++]]+"-"+o[t[n++]]+o[t[n++]]+"-"+o[t[n++]]+o[t[n++]]+"-"+o[t[n++]]+o[t[n++]]+o[t[n++]]+o[t[n++]]+o[t[n++]]+o[t[n++]]}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(6),o=r(1),i={},a=!1,s=!1;e.sensorContext={clientId:"",fileGuid:""};e.trackSensor=function(t,r,n){if(a)try{!function(t,r,n){i.track("edit",{module:"collab_"+t,message:r,fileguid:e.sensorContext.fileGuid,errortype:n,source_type:o.version,channel:e.sensorContext.clientId})}(t,r,n)}catch(t){console.warn("collab: sensor.track error:",t)}if(s)try{!function(t,r,n){i.trackNew("edit",{module_name:"collab_"+t,msg:r,file_id:e.sensorContext.fileGuid,ext:JSON.stringify({clientVersion:o.version,errorCode:n,clientId:e.sensorContext.clientId})})}(t,r,n)}catch(t){console.warn("collab: sensor.trackNew error:",t)}},e.initSensor=function(t,r){void 0===t&&(t={}),n(e.sensorContext,r),a="function"==typeof(i=t).track,s="function"==typeof i.trackNew,a||s||console.warn("collab: track or trackNew method not found in sensor instance")}},function(t,e){var r,n,o=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(t){n=a}}();var u,c=[],l=!1,f=-1;function h(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&p())}function p(){if(!l){var t=s(h);l=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function v(){}o.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];c.push(new d(t,e)),1!==c.length||l||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=v,o.addListener=v,o.once=v,o.off=v,o.removeListener=v,o.removeAllListeners=v,o.emit=v,o.prependListener=v,o.prependOnceListener=v,o.listeners=function(t){return[]},o.binding=function(t){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o,i=r(5),a=r(1);!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.ONLINE=1]="ONLINE",t[t.OFFLINE=2]="OFFLINE"}(o||(o={}));var s=function(t){function e(e){void 0===e&&(e={});var r=t.call(this)||this;return r.ns=o.UNKNOWN,r.offlineTimeoutInMS=5e3,r.requestFailThreshold=5,r.currentRequestFailCount=0,e.offlineTimeoutInMS&&(r.offlineTimeoutInMS=e.offlineTimeoutInMS),e.requestFailThreshold&&(r.requestFailThreshold=e.requestFailThreshold),r}return n(e,t),e.prototype.updateNetworkStatus=function(t){var e=t?o.ONLINE:o.OFFLINE;if(e===o.ONLINE)return this.currentRequestFailCount=0,this.offlineTimeout&&(clearTimeout(this.offlineTimeout),this.offlineTimeout=null),void(this.ns!==e&&(this.ns=e,this.emit(a.Event.NETWORK_CHANGE,!0)));if(e===o.OFFLINE){if(this.ns===e)return;this.currentRequestFailCount++,this.currentRequestFailCount>this.requestFailThreshold&&(this.ns=e,this.emit(a.Event.NETWORK_CHANGE,!1))}},Object.defineProperty(e.prototype,"online",{get:function(){return this.ns===o.ONLINE},enumerable:!0,configurable:!0}),e}(i.Base);e.NetworkDetectable=s},function(t,e,r){"use strict";t.exports=function(t,e){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return t.apply(e,r)}}},function(t,e,r){"use strict";var n=r(0);function o(t){return encodeURIComponent(t).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}t.exports=function(t,e,r){if(!e)return t;var i;if(r)i=r(e);else if(n.isURLSearchParams(e))i=e.toString();else{var a=[];n.forEach(e,function(t,e){null!==t&&void 0!==t&&(n.isArray(t)?e+="[]":t=[t],n.forEach(t,function(t){n.isDate(t)?t=t.toISOString():n.isObject(t)&&(t=JSON.stringify(t)),a.push(o(e)+"="+o(t))}))}),i=a.join("&")}if(i){var s=t.indexOf("#");-1!==s&&(t=t.slice(0,s)),t+=(-1===t.indexOf("?")?"?":"&")+i}return t}},function(t,e,r){"use strict";t.exports=function(t){return!(!t||!t.__CANCEL__)}},function(t,e,r){"use strict";(function(e){var n=r(0),o=r(66),i={"Content-Type":"application/x-www-form-urlencoded"};function a(t,e){!n.isUndefined(t)&&n.isUndefined(t["Content-Type"])&&(t["Content-Type"]=e)}var s={adapter:function(){var t;return void 0!==e&&"[object process]"===Object.prototype.toString.call(e)?t=r(29):"undefined"!=typeof XMLHttpRequest&&(t=r(29)),t}(),transformRequest:[function(t,e){return o(e,"Accept"),o(e,"Content-Type"),n.isFormData(t)||n.isArrayBuffer(t)||n.isBuffer(t)||n.isStream(t)||n.isFile(t)||n.isBlob(t)?t:n.isArrayBufferView(t)?t.buffer:n.isURLSearchParams(t)?(a(e,"application/x-www-form-urlencoded;charset=utf-8"),t.toString()):n.isObject(t)?(a(e,"application/json;charset=utf-8"),JSON.stringify(t)):t}],transformResponse:[function(t){if("string"==typeof t)try{t=JSON.parse(t)}catch(t){}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};n.forEach(["delete","get","head"],function(t){s.headers[t]={}}),n.forEach(["post","put","patch"],function(t){s.headers[t]=n.merge(i)}),t.exports=s}).call(this,r(23))},function(t,e,r){"use strict";var n=r(0),o=r(67),i=r(26),a=r(69),s=r(70),u=r(30);t.exports=function(t){return new Promise(function(e,c){var l=t.data,f=t.headers;n.isFormData(l)&&delete f["Content-Type"];var h=new XMLHttpRequest;if(t.auth){var p=t.auth.username||"",d=t.auth.password||"";f.Authorization="Basic "+btoa(p+":"+d)}if(h.open(t.method.toUpperCase(),i(t.url,t.params,t.paramsSerializer),!0),h.timeout=t.timeout,h.onreadystatechange=function(){if(h&&4===h.readyState&&(0!==h.status||h.responseURL&&0===h.responseURL.indexOf("file:"))){var r="getAllResponseHeaders"in h?a(h.getAllResponseHeaders()):null,n={data:t.responseType&&"text"!==t.responseType?h.response:h.responseText,status:h.status,statusText:h.statusText,headers:r,config:t,request:h};o(e,c,n),h=null}},h.onabort=function(){h&&(c(u("Request aborted",t,"ECONNABORTED",h)),h=null)},h.onerror=function(){c(u("Network Error",t,null,h)),h=null},h.ontimeout=function(){c(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",h)),h=null},n.isStandardBrowserEnv()){var v=r(71),y=(t.withCredentials||s(t.url))&&t.xsrfCookieName?v.read(t.xsrfCookieName):void 0;y&&(f[t.xsrfHeaderName]=y)}if("setRequestHeader"in h&&n.forEach(f,function(t,e){void 0===l&&"content-type"===e.toLowerCase()?delete f[e]:h.setRequestHeader(e,t)}),t.withCredentials&&(h.withCredentials=!0),t.responseType)try{h.responseType=t.responseType}catch(e){if("json"!==t.responseType)throw e}"function"==typeof t.onDownloadProgress&&h.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&h.upload&&h.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(t){h&&(h.abort(),c(t),h=null)}),void 0===l&&(l=null),h.send(l)})}},function(t,e,r){"use strict";var n=r(68);t.exports=function(t,e,r,o,i){var a=new Error(t);return n(a,e,r,o,i)}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e){e=e||{};var r={};return n.forEach(["url","method","params","data"],function(t){void 0!==e[t]&&(r[t]=e[t])}),n.forEach(["headers","auth","proxy"],function(o){n.isObject(e[o])?r[o]=n.deepMerge(t[o],e[o]):void 0!==e[o]?r[o]=e[o]:n.isObject(t[o])?r[o]=n.deepMerge(t[o]):void 0!==t[o]&&(r[o]=t[o])}),n.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],function(n){void 0!==e[n]?r[n]=e[n]:void 0!==t[n]&&(r[n]=t[n])}),r}},function(t,e,r){"use strict";function n(t){this.message=t}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(34);e.Delta=n.Delta;var o=r(36);e.Pool=o.default},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(35);e.Delta=n.default;var o=r(18);r(82).registerDataHandlers(o.default,n.default,o.default)},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(9),o=r(36),i=r(17),a=r(18),s=r(81),u=r(39),c=function(){function t(t,e){if(this[i.TYPE_PROPERTY]="Delta",Array.isArray(t)){var r=new n.default;o.default.isPool(e)&&0!==t.length||(e=new o.default);for(var s=0,u=t;s<u.length;s++){var c=u[s],l=e.packAttributes(c.attributes);r.push(new a.default({action:c.action,data:c.data,pool:e,packedAttributes:l}))}this.ops=r.stringify(!0),this.pool=e}else if(void 0===e){var f=t.indexOf(":");if(f<=0)throw new Error("Invalid delta: "+t);var h=parseInt(t.substring(0,f),36);if(isNaN(h))throw new Error("Invalid delta: "+t);var p=f+1+h;this.ops=t.substring(f+1,p),this.pool=0===h||t.length===p?new o.default:new o.default(t.substring(f+h+1))}else this.ops=t,this.pool=""===t?new o.default:e}return t.prototype.isEmpty=function(){return 0===this.ops.length},t.prototype.getIter=function(t){var e=void 0===t?{}:t,r=e.targetPool,n=e.sourcePool;return new s.default(this.ops,n||this.pool,r||this.pool,a.default)},Object.defineProperty(t.prototype,"length",{get:function(){for(var t=this.getIter(),e=0;t.hasNext();)e+=t.peekLength(),t.skip();return e},enumerable:!0,configurable:!0}),t.prototype.getPoolCopy=function(){return this.pool.clone()},t.prototype.map=function(e){for(var r=[],n=this.getIter();n.hasNext();)r.push(e(n.next()));return new t(r)},t.prototype.compose=function(e,r){var o=this.getPoolCopy(),i=new n.default([]),a=this.getIter({sourcePool:o,targetPool:o});Array.isArray(e)&&(e=new t(e,o));for(var s=e.getIter({targetPool:o});;){var u=a.hasNext(),c=s.hasNext();if(!u&&!c)break;if(!c)return new t(a.remainingStrs(i),o);if(!u&&s.isPoolCompatible())return new t(s.remainingStrs(i),o);if("insert"===s.peekAction())i.push(s.next());else if("remove"===a.peekAction())i.push(a.next());else{var l=Math.min(a.peekLength(),s.peekLength()),f=u?a.next(l):null,h=s.next(l);"retain"===h.action?i.push(f?f.compose(h,void 0===r?"insert"===f.action:r):h):f&&"retain"!==f.action||i.push(h)}}return new t(i.stringify(!0),o)},t.prototype.transform=function(e,r){void 0===r&&(r=!1),Array.isArray(e)&&(e=new t(e));for(var o=e.getPoolCopy(),i=new n.default,s=this.getIter(),u=e.getIter({sourcePool:o,targetPool:o});u.hasNext();){if(!s.hasNext())return new t(u.remainingStrs(i),o);if("insert"!==s.peekAction()||!r&&"insert"===u.peekAction())if("insert"===u.peekAction())i.push(u.next());else{var c=Math.min(s.peekLength(),u.peekLength()),l=s.next(c),f=u.next(c);if("remove"===l.action){if(l.hasAttributes()||"remove"===f.action&&f.hasAttributes())throw new Error("Cannot transform removing operations with attributes");continue}if("remove"===f.action){if(f.hasAttributes())throw new Error("Cannot transform removing operations with attributes");i.push(f)}else i.push(l.transform(f,r))}else i.push(new a.default({action:"retain",data:s.peekLength()})),s.skip()}return new t(i.stringify(!0),o)},t.prototype.invert=function(e,r){for(var i=new o.default,s=new n.default,u=this.getIter({targetPool:i}),c=(Array.isArray(e)?new t(e,new o.default):e).getIter({targetPool:i});c.hasNext();)if("insert"===c.peekAction())s.push(new a.default({action:"remove",data:c.peekLength()})),c.skip();else{if(!u.hasNext())throw new Error("Delta should be smaller than document");if("insert"!==u.peekAction())throw new Error("Only document can invert deltas");var l=Math.min(u.peekLength(),c.peekLength()),f=c.next(l),h=u.next(l);"remove"===f.action?s.push(h):s.push(r?r(h,f):h.invert(f))}return new t(s.stringify(!0),i)},t.prototype.stringify=function(){return this.isEmpty()?"0:":this.ops.length.toString(36)+":"+this.ops+this.pool.stringify()},t.prototype.toJSON=function(){for(var t=[],e=this.getIter();e.hasNext();)t.push(e.next().toJSON());return t},t.prototype.explain=function(t){void 0===t&&(t="");for(var e=t+"Delta #"+this.ops.length+":\n",r=this.getIter();r.hasNext();)e+=r.next().explain(t+"  ");return""+e+t+"Pool: "+this.pool.stringify()+"\n"},t.prototype.validateTable=function(){for(var t={},e=this.getIter();e.hasNext();){var r=e.next();if("table"===r.dataType){var n=r.getAttributes().name;if("string"!=typeof n)continue;var o="$$"+n+"$$";if(t.hasOwnProperty(o))throw new Error("Duplicated table name found: "+n);t[o]=!0}}return this},t.isDelta=u.isDelta,t}();e.default=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(17),o=r(79),i=r(80),a=function(){function t(t){void 0===t&&(t={array:[],packedData:""}),this[n.TYPE_PROPERTY]="Pool","string"==typeof t?(this.array=JSON.parse(t),this.packedData=t):(this.array=t.array,this.packedData=t.packedData)}return t.isPool=function(t){return"object"==typeof t&&null!==t&&"Pool"===t[n.TYPE_PROPERTY]},t.prototype.isSubsetOf=function(t){if(this===t)return!0;var e=this.array.length;if(0===e)return!0;if(e>t.array.length)return!1;for(var r=0;r<e;r++)if(this.array[r]!==t.array[r])return!1;return!0},t.prototype.getMap=function(){if(!this.map){this.map={};for(var t=0;t<this.array.length;t++)this.map[this.array[t]]=String(t)}return this.map},t.prototype.packAttributes=function(t){if(!t)return"";var e=Object.keys(t),r=e.length;if(0===r)return"";for(var n=[],o=[],a=0;a<r;a++){var s=e[a],u=t[s];if("object"==typeof u&&null!==u)for(var c=0,l=i.objectToKeyPaths(u,"."+s);c<l.length;c++){var f,h=l[c];" "===(f=this.getAddress(h[0],h[1]))[0]?n.push(f):o.push(f)}else" "===(f=this.getAddress(s,u))[0]?n.push(f):o.push(f)}return o.sort().join("")+n.sort().join("")},t.prototype.getAddress=function(t,e){var r=o.combinedAttributeWithValue(t,e),n=o.getGulByCombinedKeyValue(r);if("string"==typeof n)return n;var i=this.getMap();if(!i.hasOwnProperty(r)){this.packedData=void 0;var a=this.array.length;i[r]=String(a),this.array.push(r)}return" "+i[r]},t.prototype.unpackAttributes=function(t,e){void 0===e&&(e=!0);for(var r={},n=0;n<t.length&&" "!==t[n];){var a=o.getKeyValueByGul(t[n]),s=a[0],u=a[1];e&&"."===s[0]?i.keyPathToObject(r,s,u):r[s]=u,n+=1}if(n<t.length-1)for(var c=0,l=t.substring(n+1).split(" ");c<l.length;c++){var f=l[c],h=o.parseCombinedAttributeValue(this.array[f]);s=h[0],u=h[1];e&&"."===s[0]?i.keyPathToObject(r,s,u):r[s]=u}return r},t.prototype.stringify=function(){return"string"!=typeof this.packedData&&(this.packedData=this.array.length?JSON.stringify(this.array):""),this.packedData},t.prototype.clone=function(){return new t({array:this.array.slice(),packedData:this.packedData})},t}();e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initialToObjectKey={A:"attachment",C:"cell",I:"image",D:"delta",T:"table",P:"presentation",S:"slide",M:"mention",N:"inline-break",V:"divide",U:"upload-placeholder-attachment",G:"gallery",B:"gallery-block",Z:"mindmap",O:"object",F:"form"},e.objectKeyToInitial=Object.keys(e.initialToObjectKey).reduce(function(t,r){return t[e.initialToObjectKey[r]]=r,t},{})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.merge=function(t,e,r){var n=Object.keys(t);if(r&&0===n.length)return e;for(var o=0,i=Object.keys(e);o<i.length;o++){var a=i[o];t[a]=e[a],r||null!==t[a]||delete t[a]}return t},e.transform=function(t,e,r){if(r)return e;var n=Object.keys(e);if(0===n.length)return e;var o=Object.keys(t);if(0===o.length)return e;if(o.length>n.length)for(var i=0,a=n;i<a.length;i++){var s=a[i];t.hasOwnProperty(s)&&delete e[s]}else for(var u=0,c=o;u<c.length;u++)delete e[c[u]];return e},e.invert=function(t,e){var r=Object.keys(e);if(0===r.length)return e;if(0===Object.keys(t).length)for(var n=0,o=r;n<o.length;n++)e[s=o[n]]=null;else for(var i=0,a=r;i<a.length;i++){var s,u=t[s=a[i]];e[s]=void 0===u?null:u}return e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(17);e.isDelta=function(t){return"object"==typeof t&&null!==t&&"Delta"===t[n.TYPE_PROPERTY]}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.possibleDeltaInputToString=function(t,e){if(void 0===e||null===e)return"";if(Array.isArray(e)){if(0===e.length)return"";var r=new t(e);return r.isEmpty()?"":r.stringify()}return e.isEmpty()?"":e.stringify()}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(40),i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){for(var n=this.parse(t).slice(0),o=this.parse(e).slice(0),i=Math.max(n.length,o.length),a=new Array(i),s=0;s<i;s++){var u=n[s],c=o[s];a[s]=u?c?u.compose(c,r):u:c}return this.pack(a)},e.prototype.transform=function(t,e,r){for(var n=this.parse(t).slice(0),o=this.parse(e).slice(0),i=Math.max(n.length,o.length),a=new Array(i),s=0;s<i;s++){var u=n[s],c=o[s];a[s]=u?c?u.transform(c,r):void 0:c}return this.pack(a)},e.prototype.invert=function(t,e){for(var r=this.parse(t).slice(0),n=this.parse(e).slice(0),o=Math.max(r.length,n.length),i=new Array(o),a=0;a<o;a++){var s=r[a],u=n[a];i[a]=s?u?s.invert(u):void 0:u}return this.pack(i)},e.prototype.parse=function(t){for(var e=0,r=[];e<t.length;){var n=t.indexOf("$",e);if(-1===n)break;var o=parseInt(t.substring(e,n),36),i=n+1+o,a=0===o?void 0:new this.deltaConstructor(t.substring(n+1,i));e=i,r.push(a)}return r},e.prototype.pack=function(t){for(var e="",r=0,n=t;r<n.length;r++){var i=n[r],a=o.possibleDeltaInputToString(this.deltaConstructor,i);e+=a.length.toString(36)+"$"+a}return e},e.prototype.toJSON=function(t){return this.parse(t).map(function(t){return t?t.toJSON():void 0})},e.prototype.explain=function(t,e){for(var r=t+"List:\n",n=this.parse(e),o=0;o<n.length;o++){var i=n[o];r+=t+"Item #"+o+":\n",r+=i?i.explain(t):"[EMPTY]"}return r},e}(r(7).default);e.default=i},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var i=r(10),a=r(12),s=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,a),n(e,[{key:"setData",value:function(t){if(function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),"number"==typeof this.data&&1!==this.data)throw new Error('The value of data should be "1", got '+this.data);return this}},{key:"name",value:function(){return"CellOperator"}},{key:"compose",value:function(t){if("remove"===this.action)throw new Error("Removing operator cannot compose other operators");if("retain"!==t.action)throw new Error("Only retaining operator can be composed");var e=void 0;if("function"==typeof this.data.compose&&t.data.constructor.packId===this.data.constructor.packId)e=void 0!==i.unpack(t.attributes).cellValue?t.data:this.data.compose(t.data);else if("number"==typeof this.data)e=t.data;else{e=void 0!==i.unpack(t.attributes).cellValue?1:this.data}return(this.isGeneric()?t:this).createInstance({data:e,attributes:i.merge(this.attributes,t.attributes,"insert"!==this.action),action:this.action})}},{key:"invert",value:function(t){if("insert"!==this.action)throw new Error('invert should only apply to the "insert" action ('+this.constructor.name+")");if("retain"!==t.action)throw new Error("Only retaining operator can be inverted");var e=void 0;if("function"==typeof this.data.invert&&t.data.constructor.packId===this.data.constructor.packId)e=void 0!==i.unpack(t.attributes).cellValue?this.data:this.data.invert(t.data);else if("number"==typeof t.data){e=void 0!==i.unpack(t.attributes).cellValue?this.data:t.data}else e=this.data;return this.createInstance({data:e,attributes:i.invert(this.attributes,t.attributes),action:"retain"})}}]),e}();s.packId=4,t.exports=s},function(t,e,r){(function(e){e.shimo||(e.shimo={}),e.shimo.sdk||(e.shimo.sdk={}),e.shimo.sdk.common||(e.shimo.sdk.common={}),t.exports=e.shimo.sdk.common.Collaboration=r(44)}).call(this,r(4))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(45);t.exports=n.Collaboration,t.exports.Types=n.Types},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};Object.defineProperty(e,"__esModule",{value:!0});var a,s=r(13),u=r(5),c=r(1),l=r(49),f=r(58),h=r(59),p=r(76),d=r(102),v=r(15),y=r(103),g=r(104),m=r(105),b=r(6),_=r(22),E=r(106);!function(t){t.MODOC="modoc",t.RICHDOC="richdoc"}(e.Types||(e.Types={})),function(t){t.MODOC="modoc",t.RICHDOC="richdoc"}(a=e.DeltaType||(e.DeltaType={}));var w=function(t){function e(e){var r=t.call(this)||this;r.events=c.Event,r.apiAdaptor=E.noopAdaptor,r.type=a.MODOC,r.pullInterval=55e3,r.storage={set:c.noop},r.readonly=!1,r.assert(e.editor,"options.editor required"),r.assert(e.rev,"options.rev required"),r.assert(e.composeUrl,"options.composeUrl required"),r.assert(e.pullUrl,"options.pullUrl required"),r.assert(e.guid,"options.guid required"),e.pullUrl=c.modifyUrl(e.pullUrl),e.composeUrl=c.modifyUrl(e.composeUrl),e.selectUrl&&(e.selectUrl=c.modifyUrl(e.selectUrl)),r.editor=e.editor;var n=r.clientId=e.clientId||s.v4().replace(/-/g,""),i=r.guid=e.guid;e.pullInterval&&(r.pullInterval=e.pullInterval),e.storage&&(r.storage=e.storage),e.type&&(r.type=e.type),e.readonly&&(r.readonly=e.readonly),e.sensorInstance&&_.initSensor(e.sensorInstance,{clientId:n,fileGuid:i}),e.apiAdaptor&&(r.apiAdaptor=e.apiAdaptor);var u=r.tracker=new p.Tracker({committingChange:e.committingChange,rev:e.rev,editor:e.editor,storage:{set:function(t){void 0===t&&(t={}),b(t,{clientId:r.clientId,guid:r.guid}),r.storage.set(t)}},type:r.type,userChange:e.userChange,adaptors:e.adaptors,modocUserSelectFeat:!!e.modocUserSelectFeat});if(r.reporter=new m.Reporter(o({env:{guid:r.guid,clientId:n}},e.reporter)),r.puller=new l.Puller({clientId:n,guid:r.guid,pullInterval:r.pullInterval,interceptRequest:r.apiAdaptor,tracker:u,url:e.pullUrl.replace("{guid}",String(r.guid)),handleServerChangeThrottleDelay:e.handleServerChangeThrottleDelay,delayMin:e.pullDelayMin,delayMax:e.pullDelayMax,delayRandomizationFactor:e.pullDelayRandomizationFactor,forceXhr:e.forceXhr,readonly:e.readonly}),r.externalDatasource=new y.ExternalDatasource({puller:r.puller,editor:e.editor}),r.shimoScriptsHandler=new g.ShimoScriptsHandler({puller:r.puller,editor:e.editor}),r.proxyEvent(r.puller,c.Event.CHANGES,c.Event.BROADCAST,c.Event.ON_VISIBLE),r.sender=new h.Sender({clientId:n,guid:i,tracker:u,url:e.composeUrl.replace("{guid}",String(r.guid)),interceptRequest:r.apiAdaptor}),e.selectUrl||e.enableFileMeta){var w=e.collaborators||e.editor.collaborators;if(!w)throw new Error("Missing `collaborators` option");r.collaborator=new d.Collaborator({tracker:r.tracker,puller:r.puller,url:e.selectUrl||"",editor:w,clientId:n,modocUserSelectFeat:!!e.modocUserSelectFeat,interceptRequest:r.apiAdaptor}),r.tracker.setCollaborator(r.collaborator),r.proxyEvent(r.collaborator,c.Event.WARNING,c.Event.ENTER,c.Event.LEAVE,c.Event.SELECT)}return r.sender.on(c.Event.SEND_REQUEST_DONE,function(){r.puller.immediatelyPull()}),r.saveStatus=new f.SaveStatus({timeoutThreshold:12e4}),[r.sender,r.puller,r.saveStatus,r.tracker].forEach(function(t){t.on(c.Event.ERROR,function(t){r.emit(c.Event.ERROR,t),r.stop(),c.setReadonly(e.editor),r.reporter.report({type:"error",error:t})}),t.on(c.Event.WARNING,function(t){r.emit(c.Event.WARNING,t),r.reporter.report({type:"warning",body:t})}),t.on(c.Event.TRACK,function(t){r.reporter.report(t)})}),r.tracker.on(c.Event.SERVER_CHANGE_APPLIED,function(t){r.emit(r.events.BEFORE_APPLY_CHANGE,t)}),r.proxyEvent(r.tracker,c.Event.SERVER_CHANGE_PROCESSED),r.saveStatus.on(c.Event.CHANGE,function(t,e){r.emit(r.events.SAVE_STATUS_CHANGE,t,e)}),r.initializeSaveStatus(),!1===e.offlineEditable&&r.saveStatus.on(f.SaveStatus.events.CHANGE,function(t){t!==v.Status.ONLINE||r.readonly||c.setEditable(e.editor),t===v.Status.OFFLINE&&c.setReadonly(e.editor)}),r}return n(e,t),e.prototype.start=function(){this.sender.start(),this.puller.start(),this.reporter.start(),this.notifyReady()},e.prototype.stop=function(){this.sender.stop(),this.puller.stop(),this.reporter.stop()},e.prototype.getCollaborators=function(){return this.collaborator?this.collaborator.users:[]},e.prototype.haveUnsavedChange=function(){return this.tracker.haveUnsavedChange()},e.prototype.destroy=function(){this.stop(),this.puller.destroy(),this.sender.destroy(),this.saveStatus.destroy(),this.tracker.destroy(),this.removeAllListeners(),this.collaborator&&this.collaborator.destroy(),this.externalDatasource&&this.externalDatasource.destroy(),this.shimoScriptsHandler&&this.shimoScriptsHandler.destroy()},Object.defineProperty(e.prototype,"rev",{get:function(){return this.tracker.rev},set:function(t){console.warn("Setting rev operation may cause the save to fail, so please use it with caution!"),this.tracker.rev=t},enumerable:!0,configurable:!0}),e.prototype.initializeSaveStatus=function(){var t=this;Object.keys(c.Event).forEach(function(e){var r=c.Event[e];[t.puller,t.sender,t.tracker].forEach(function(e){e.on(r,function(){for(var e,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];(e=t.saveStatus).onEvent.apply(e,i([r],n))})})})},e.prototype.notifyReady=function(){this.editor.emit&&this.editor.emit("ReceiveChangeReady")},e.events=c.Event,e}(u.Base);e.Collaboration=w},function(t,e,r){var n,o,i=r(20),a=r(21),s=0,u=0;t.exports=function(t,e,r){var c=e&&r||0,l=e||[],f=(t=t||{}).node||n,h=void 0!==t.clockseq?t.clockseq:o;if(null==f||null==h){var p=i();null==f&&(f=n=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==h&&(h=o=16383&(p[6]<<8|p[7]))}var d=void 0!==t.msecs?t.msecs:(new Date).getTime(),v=void 0!==t.nsecs?t.nsecs:u+1,y=d-s+(v-u)/1e4;if(y<0&&void 0===t.clockseq&&(h=h+1&16383),(y<0||d>s)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=d,u=v,o=h;var g=(1e4*(268435455&(d+=122192928e5))+v)%4294967296;l[c++]=g>>>24&255,l[c++]=g>>>16&255,l[c++]=g>>>8&255,l[c++]=255&g;var m=d/4294967296*1e4&268435455;l[c++]=m>>>8&255,l[c++]=255&m,l[c++]=m>>>24&15|16,l[c++]=m>>>16&255,l[c++]=h>>>8|128,l[c++]=255&h;for(var b=0;b<6;++b)l[c+b]=f[b];return e||a(l)}},function(t,e,r){var n=r(20),o=r(21);t.exports=function(t,e,r){var i=e&&r||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null);var a=(t=t||{}).random||(t.rng||n)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,e)for(var s=0;s<16;++s)e[i+s]=a[s];return e||o(a)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.delay=function(t){return new Promise(function(e){setTimeout(e,t)})}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var a,s=r(2),u=r(6),c=r(14),l=r(55),f=r(56),h=r(13),p=r(1),d=r(57),v=r(24);!function(t){t.NEW="new",t.ACCEPT="accept"}(a=e.ServerChangeType||(e.ServerChangeType={}));var y=p.version.replace(/\./g,"_"),g=s("collab:puller"),m=function(t){function e(e){var r=t.call(this,e.tracker.editor)||this;return r.stopped=!1,r.changes=[],r.isHandling=!1,r.lastHandleServerChangeTime=0,r.handleServerChangeThrottleDelay=0,r.forceXhr=!1,r.lastPullChangesNotContinuousTime=0,r.isPulling=!1,r.lastPullStartTime=0,r.visible=!0,r.readonly=!1,r.lastEventId={},r.uuid=h.v4().replace(/-/g,""),r.guid=e.guid,r.url=e.url.replace("{guid}",String(r.guid)),r.clientId=e.clientId,r.tracker=e.tracker,r.currentPullRev=r.tracker.rev,r.pullInterval=r.tempPullInterval=e.pullInterval,r.interceptRequest=e.interceptRequest,r.handleServerChanges=r.wrapAsyncTryCatch(r.handleServerChanges,r),e.handleServerChangeThrottleDelay&&(r.handleServerChangeThrottleDelay=e.handleServerChangeThrottleDelay),e.forceXhr&&(r.forceXhr=e.forceXhr),e.readonly&&(r.readonly=e.readonly),r.tracker.on("readyToHandleChanges",function(){r.handleServerChanges()}),r.backoff=new f({min:e.delayMin||200,max:e.delayMax||5e3,jitter:e.delayRandomizationFactor||.5}),r.network=new v.NetworkDetectable,r.network.on(p.Event.NETWORK_CHANGE,function(t){r.emit(p.Event.NETWORK_CHANGE,t)}),r.initialVisibility(),r}return n(e,t),e.prototype.getLastPullStartTime=function(){return this.lastPullStartTime},e.prototype.immediatelyPull=function(){!this.network.online&&this.cancelDelayRun(this.pull)&&this.resetAndPull()},e.prototype.resetAndPull=function(){this.backoff.reset();var t=Date.now()-this.lastPullStartTime;this.tempPullInterval>5e3&&this.tempPullInterval-t>5e3?this.tempPullInterval=5001+Math.round(Math.random()*(this.pullInterval-5e3)):this.tempPullInterval=this.pullInterval,this.pull()},e.prototype.start=function(){this.stopped=!1,this.pull()},e.prototype.stop=function(){this.stopped||(this.eventSource&&this.eventSource.close(),this.pullTimeout&&clearTimeout(this.pullTimeout),this.off("visible"),this.stopped=!0,this.isPulling=!1)},e.prototype.destroy=function(){this.stop(),this.superDestroy()},e.prototype.pull=function(t){var e=this;if(void 0===t&&(t={}),!this.stopped&&!this.isPulling&&(this.visible||this.tracker.haveUnsavedChange())){this.lastPullStartTime=Date.now();var r=this.assembleEventSourceUrl(),n=this.eventSource=new l(r,{forceXhr:this.forceXhr,withCredentials:!0});this.isPulling=!0,n.addEventListener(p.Event.CHANGES,function(r){var n;e.onMessage(r);var o=JSON.parse(r.data).filter(function(t){return t.rev>e.currentPullRev}).sort(function(t,e){return t.rev-e.rev}).filter(function(t,e,r){return 0===e||t.rev!==r[e-1].rev});if(0!==o.length){if(!e.isRevContinuous(o,e.currentPullRev)){var i=Date.now();return e.emit(p.Event.WARNING,{message:"Changes are not continuous"}),i-e.lastPullChangesNotContinuousTime<5e3?void e.emitError("Pull discontinuous",p.ERROR.ERR_DISCONTINUOUS,r.data):(e.lastPullChangesNotContinuousTime=i,void e.onEventSourceErrorOrClose({status:e.eventSource&&e.eventSource.status||0}))}if((n=e.changes).push.apply(n,o),e.currentPullRev=o[o.length-1].rev,t.toVisible){var a=e.changes.filter(function(t){return t.rev>e.tracker.rev}).length;e.emit(p.Event.ON_VISIBLE,{changesCount:a})}e.handleServerChanges()}}),n.addEventListener(p.Event.EXTERNAL_CHANGES,function(t){e.onMessage(t);var r=JSON.parse(t.data);null!=r&&r.length>0&&e.emit(p.Event.EXTERNAL_CHANGES,JSON.parse(t.data))}),n.addEventListener(p.Event.SHIMO_SCRIPTS,function(t){e.onMessage(t),e.emit(p.Event.SHIMO_SCRIPTS,JSON.parse(t.data))}),n.addEventListener(p.Event.CHANGES_PENDING,function(t){e.onMessage(t),g("get changes pending message:",t.data),e.emit(p.Event.CHANGES_PENDING,JSON.parse(t.data))}),n.addEventListener(p.Event.OPEN,function(t){t&&200===t.status&&e.network.updateNetworkStatus(!0)}),n.addEventListener(p.Event.COLLABORATOR,function(t){e.onMessage(t),e.emit(p.Event.COLLABORATOR,JSON.parse(t.data))}),n.addEventListener("pull_error",function(t){e.onMessage(t),e.track("pull_error message "+t.data);try{var r=JSON.parse(t.data);e.emitError(r.message,r.code,t.data)}catch(t){e.emitError("Pull error",p.ERROR.ERR_PULL,t.data)}}),n.addEventListener(p.Event.BROADCAST,function(t){e.onMessage(t),e.emit(p.Event.BROADCAST,JSON.parse(t.data))}),this.pullTimeout=setTimeout(function(){e.closeEventSource()},this.tempPullInterval),n.onerror=function(t){return e.onEventSourceErrorOrClose(t)},n.addEventListener("close",function(t){e.onEventSourceErrorOrClose(t)})}},e.prototype.onMessage=function(t){this.network.updateNetworkStatus(!0);try{this.lastEventId=JSON.parse(t.lastEventId)}catch(t){this.lastEventId={}}},e.prototype.closeEventSource=function(){this.onEventSourceErrorOrClose({status:this.eventSource&&this.eventSource.status||0})},e.prototype.onEventSourceErrorOrClose=function(t){if(this.pullTimeout&&clearTimeout(this.pullTimeout),this.eventSource)try{this.eventSource.close(),this.eventSource.removeEventListener(p.Event.CHANGES),this.eventSource.removeEventListener(p.Event.COLLABORATOR),this.eventSource.removeEventListener(p.Event.BROADCAST),this.eventSource.removeEventListener(p.Event.SHIMO_SCRIPTS),this.eventSource.removeEventListener(p.Event.CHANGES_PENDING),this.eventSource.removeEventListener(p.Event.EXTERNAL_CHANGES),this.eventSource.removeEventListener(p.Event.OPEN),this.eventSource.removeEventListener("pull_error"),this.eventSource.removeEventListener("close")}catch(t){this.track("event source closed error",t)}this.isPulling=!1;var e=String(t.status);if(t.errorMessage&&(e="",this.emit(p.Event.WARNING,{message:t.errorMessage})),""!==e&&"0"!==e||this.network.updateNetworkStatus(!1),"4"!==e[0]||"429"===e)if("2"!==e[0]){var r=this.backoff.duration();this.track("pull with status "+e+", delay "+r+"ms to run"),this.delayRun(this.pull,r)}else this.resetAndPull();else this.emitError("Puller encountered failure with status "+e,p.getErrorCodeByHttpStatus(e),t)},e.prototype.assembleEventSourceUrl=function(){var t=this.url.split("?"),e=t[0],r=t[1],n=c.parse(r);u(n,{clientId:this.clientId,rev:this.currentPullRev,timeout:this.tempPullInterval,visible:this.visible?1:0,version:y,uuid:this.uuid,readonly:this.readonly},this.lastEventId);var o=this.interceptRequest({url:e,method:"GET",query:n,headers:{}});return o.url+"?"+c.stringify(o.query||{})},e.prototype.handleServerChanges=function(){return o(this,void 0,void 0,function(){var t,e,r,n,o,s,u,c,l=this;return i(this,function(i){switch(i.label){case 0:return(t=this.tracker.canHandleChangesRightNow()).acceptCommit&&t.newChange||this.emit(p.Event.WAITING_FOR_CAN_HANDLE_SERVER_CHANGES),t.acceptCommit||t.newChange?this.isHandling?(this.delayRun(this.handleServerChanges,200),[2]):this.handleServerChangeThrottleDelay>0&&(e=Date.now()-this.lastHandleServerChangeTime)<this.handleServerChangeThrottleDelay?(this.delayRun(this.handleServerChanges,e),[2]):(this.isHandling=!0,r=[],t.acceptCommit&&!t.newChange?this.changes.length>0&&this.changes[0].type===a.ACCEPT&&r.push(this.changes.shift()):t.acceptCommit&&t.newChange?(r=r.concat(this.changes).filter(function(t){return t.rev>l.tracker.rev}),this.changes=[]):console.error("Invalid canHandleChanges result:",t),this.isRevContinuous(r,this.tracker.rev)||this.emit(p.Event.WARNING,{message:"Changes discontinuous"}),this.emit(p.Event.CHANGES,r),n=this.classifyServerChanges(r),o=n.beforeList,s=n.accept,u=n.afterList,o.length>0?[4,this.tracker.applyChangesToBase(o,!0)]:[3,5]):(this.delayRun(this.handleServerChanges,200),[2]);case 1:c=i.sent(),i.label=2;case 2:return c?[3,5]:[4,p.delay(100)];case 3:return i.sent(),[4,this.tracker.applyChangesToBase(o,!0)];case 4:return c=i.sent(),[3,2];case 5:return s&&(this.tracker.applyPreparedChangesetToBase(s.rev),this.emit(p.Event.ACCEPT_COMMIT)),u.length>0?[4,this.tracker.applyChangesToBase(u,!1)]:[3,10];case 6:c=i.sent(),i.label=7;case 7:return c?[3,10]:[4,p.delay(100)];case 8:return i.sent(),[4,this.tracker.applyChangesToBase(u,!1)];case 9:return c=i.sent(),[3,7];case 10:return this.lastHandleServerChangeTime=Date.now(),this.isHandling=!1,t.acceptCommit&&t.newChange||this.delayRun(this.handleServerChanges,200),[2]}})})},e.prototype.classifyServerChanges=function(t){var e=[],r=null,n=[];return t.forEach(function(t){t.type!==a.NEW?t.type===a.ACCEPT&&(r=t):r?n.push(t):e.push(t)}),{beforeList:e,accept:r,afterList:n}},e.prototype.isRevContinuous=function(t,e){if(0===t.length)return!0;if(t[0].rev-e!=1)return!1;for(var r=1;r<t.length;r++)if(t[r].rev-t[r-1].rev!=1)return!1;return!0},e.prototype.initialVisibility=function(){var t=this;this.on("visible",function(e){t.visible=e,e?t.pull({toVisible:!0}):e||t.tracker.haveUnsavedChange()||t.closeEventSource()})},e}(d.Visible);e.Puller=m},function(t,e,r){t.exports=function(t){function e(t){let r,o=null;function i(...t){if(!i.enabled)return;const n=i,o=Number(new Date),a=o-(r||o);n.diff=a,n.prev=r,n.curr=o,r=o,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(r,o)=>{if("%%"===r)return"%";s++;const i=e.formatters[o];if("function"==typeof i){const e=t[s];r=i.call(n,e),t.splice(s,1),s--}return r}),e.formatArgs.call(n,t),(n.log||e.log).apply(n,t)}return i.namespace=t,i.useColors=e.useColors(),i.color=e.selectColor(t),i.extend=n,i.destroy=e.destroy,Object.defineProperty(i,"enabled",{enumerable:!0,configurable:!1,get:()=>null===o?e.enabled(t):o,set:t=>{o=t}}),"function"==typeof e.init&&e.init(i),i}function n(t,r){const n=e(this.namespace+(void 0===r?":":r)+t);return n.log=this.log,n}function o(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){const t=[...e.names.map(o),...e.skips.map(o).map(t=>"-"+t)].join(",");return e.enable(""),t},e.enable=function(t){let r;e.save(t),e.names=[],e.skips=[];const n=("string"==typeof t?t:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(t=n[r].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let r,n;for(r=0,n=e.skips.length;r<n;r++)if(e.skips[r].test(t))return!1;for(r=0,n=e.names.length;r<n;r++)if(e.names[r].test(t))return!0;return!1},e.humanize=r(51),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(r=>{e[r]=t[r]}),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let r=0;for(let e=0;e<t.length;e++)r=(r<<5)-r+t.charCodeAt(e),r|=0;return e.colors[Math.abs(r)%e.colors.length]},e.enable(e.load()),e}},function(t,e){var r=1e3,n=60*r,o=60*n,i=24*o,a=7*i,s=365.25*i;function u(t,e,r,n){var o=e>=1.5*r;return Math.round(t/r)+" "+n+(o?"s":"")}t.exports=function(t,e){e=e||{};var c=typeof t;if("string"===c&&t.length>0)return function(t){if((t=String(t)).length>100)return;var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(!e)return;var u=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*a;case"days":case"day":case"d":return u*i;case"hours":case"hour":case"hrs":case"hr":case"h":return u*o;case"minutes":case"minute":case"mins":case"min":case"m":return u*n;case"seconds":case"second":case"secs":case"sec":case"s":return u*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(t);if("number"===c&&isFinite(t))return e.long?function(t){var e=Math.abs(t);if(e>=i)return u(t,e,i,"day");if(e>=o)return u(t,e,o,"hour");if(e>=n)return u(t,e,n,"minute");if(e>=r)return u(t,e,r,"second");return t+" ms"}(t):function(t){var e=Math.abs(t);if(e>=i)return Math.round(t/i)+"d";if(e>=o)return Math.round(t/o)+"h";if(e>=n)return Math.round(t/n)+"m";if(e>=r)return Math.round(t/r)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,r){"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}},function(t,e,r){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var n=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var r,a,s=function(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),u=1;u<arguments.length;u++){for(var c in r=Object(arguments[u]))o.call(r,c)&&(s[c]=r[c]);if(n){a=n(r);for(var l=0;l<a.length;l++)i.call(r,a[l])&&(s[a[l]]=r[a[l]])}}return s}},function(t,e,r){"use strict";var n=new RegExp("%[a-f0-9]{2}","gi"),o=new RegExp("(%[a-f0-9]{2})+","gi");function i(t,e){try{return decodeURIComponent(t.join(""))}catch(t){}if(1===t.length)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],i(r),i(n))}function a(t){try{return decodeURIComponent(t)}catch(o){for(var e=t.match(n),r=1;r<e.length;r++)e=(t=i(e,r).join("")).match(n);return t}}t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=o.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var n=a(r[0]);n!==r[0]&&(e[r[0]]=n)}r=o.exec(t)}e["%C2"]="�";for(var i=Object.keys(e),s=0;s<i.length;s++){var u=i[s];t=t.replace(new RegExp(u,"g"),e[u])}return t}(t)}}},function(t,e){
/** @license
 * eventsource.js
 * Available under MIT License (MIT)
 * https://github.com/Yaffle/EventSource/
 */
var r,n=(r="undefined"!=typeof self?self:window).setTimeout.bind(r),o=r.clearTimeout.bind(r),i=r.XMLHttpRequest,a=r.XDomainRequest,s=r.document,u=r.Promise,c=r.fetch?r.fetch.bind(r):void 0,l=r.Response,f=r.TextDecoder,h=r.TextEncoder,p=r.AbortController,d=5e3;if(void 0==Object.create&&(Object.create=function(t){function e(){}return e.prototype=t,new e}),void 0!=u&&void 0==u.prototype.finally&&(u.prototype.finally=function(t){return this.then(function(e){return u.resolve(t()).then(function(){return e})},function(e){return u.resolve(t()).then(function(){throw e})})}),void 0!=c){var v=c;c=function(t,e){return u.resolve(v(t,e))}}function y(){this.bitsNeeded=0,this.codePoint=0}void 0==p&&(p=function(){this.signal=null,this.abort=function(){}}),y.prototype.decode=function(t){function e(t,e,r){if(1===r)return t>=128>>e&&t<<e<=2047;if(2===r)return t>=2048>>e&&t<<e<=55295||t>=57344>>e&&t<<e<=65535;if(3===r)return t>=65536>>e&&t<<e<=1114111;throw new Error}function r(t,e){if(6===t)return e>>6>15?3:e>31?2:1;if(12===t)return e>15?3:2;if(18===t)return 3;throw new Error}for(var n="",o=this.bitsNeeded,i=this.codePoint,a=0;a<t.length;a+=1){var s=t[a];0!==o&&(s<128||s>191||!e(i<<6|63&s,o-6,r(o,i)))&&(o=0,i=65533,n+=String.fromCharCode(i)),0===o?(s>=0&&s<=127?(o=0,i=s):s>=192&&s<=223?(o=6,i=31&s):s>=224&&s<=239?(o=12,i=15&s):s>=240&&s<=247?(o=18,i=7&s):(o=0,i=65533),0===o||e(i,o,r(o,i))||(o=0,i=65533)):(o-=6,i=i<<6|63&s),0===o&&(i<=65535?n+=String.fromCharCode(i):(n+=String.fromCharCode(55296+(i-65535-1>>10)),n+=String.fromCharCode(56320+(i-65535-1&1023))))}return this.bitsNeeded=o,this.codePoint=i,n};void 0!=f&&void 0!=h&&function(){try{return"test"===(new f).decode((new h).encode("test"),{stream:!0})}catch(t){console.log(t)}return!1}()||(f=y);var g=function(){};function m(t){this.withCredentials=!1,this.responseType="",this.readyState=0,this.status=0,this.statusText="",this.responseText="",this.onprogress=g,this.onreadystatechange=g,this._contentType="",this._xhr=t,this._sendTimeout=0,this._abort=g}function b(t){return t.replace(/[A-Z]/g,function(t){return String.fromCharCode(t.charCodeAt(0)+32)})}function _(t){for(var e=Object.create(null),r=t.split("\r\n"),n=0;n<r.length;n+=1){var o=r[n].split(": "),i=o.shift(),a=o.join(": ");e[b(i)]=a}this._map=e}function E(){}function w(t){this._headers=t}function O(){}function C(){this._listeners=Object.create(null)}function k(t){n(function(){throw t},0)}function S(t,e){for(var r in this.type=t,this.target=void 0,e)this.hasOwnProperty(r)||(this[r]=e[r])}function A(t,e){S.call(this,t),this.data=e.data,this.lastEventId=e.lastEventId}function T(t,e){S.call(this,t),this.status=e.status,this.statusText=e.statusText,this.headers=e.headers}m.prototype.open=function(t,e){this._abort(!0);var r=this,a=this._xhr,s=1,u=0;this._abort=function(t){0!==r._sendTimeout&&(o(r._sendTimeout),r._sendTimeout=0),1!==s&&2!==s&&3!==s||(s=4,a.onload=g,a.onerror=g,a.onabort=g,a.onprogress=g,a.onreadystatechange=g,a.abort(),0!==u&&(o(u),u=0),t||(r.readyState=4,r.onreadystatechange())),s=0};var c=function(){if(1===s){var t=0,e="",n=void 0;if("contentType"in a)t=200,e="OK",n=a.contentType;else try{t=a.status,e=a.statusText,n=a.getResponseHeader("Content-Type")}catch(r){t=0,e="",n=void 0}0!==t&&(s=2,r.readyState=2,r.status=t,r.statusText=e,r._contentType=n,r.onreadystatechange())}},l=function(){if(c(),2===s||3===s){s=3;var t="";try{t=a.responseText}catch(t){}r.readyState=3,r.responseText=t,r.onprogress()}},f=function(){l(),1!==s&&2!==s&&3!==s||(s=4,0!==u&&(o(u),u=0),r.readyState=4,r.onreadystatechange())},h=function(){u=n(function(){h()},500),3===a.readyState&&l()};a.onload=f,a.onerror=f,a.onabort=f,"sendAsBinary"in i.prototype||"mozAnon"in i.prototype||(a.onprogress=l),a.onreadystatechange=function(){void 0!=a&&(4===a.readyState?f():3===a.readyState?l():2===a.readyState&&c())},"contentType"in a&&(e+=(-1===e.indexOf("?")?"?":"&")+"padding=true"),a.open(t,e,!0),"readyState"in a&&(u=n(function(){h()},0))},m.prototype.abort=function(){this._abort(!1)},m.prototype.getResponseHeader=function(t){return this._contentType},m.prototype.setRequestHeader=function(t,e){var r=this._xhr;"setRequestHeader"in r&&r.setRequestHeader(t,e)},m.prototype.getAllResponseHeaders=function(){return void 0!=this._xhr.getAllResponseHeaders?this._xhr.getAllResponseHeaders():""},m.prototype.send=function(){if("ontimeout"in i.prototype||void 0==s||void 0==s.readyState||"complete"===s.readyState){var t=this._xhr;t.withCredentials=this.withCredentials,t.responseType=this.responseType;try{t.send(void 0)}catch(t){throw t}}else{var e=this;e._sendTimeout=n(function(){e._sendTimeout=0,e.send()},4)}},_.prototype.get=function(t){return this._map[b(t)]},E.prototype.open=function(t,e,r,i,a,s,u){t.open("GET",a);var c,l=0;function f(){c=n(function(){t.abort()},d)}for(var h in f(),t.onprogress=function(){var e=t.responseText.slice(l);l+=e.length,e.length>0&&(o(c),f()),r(e)},t.onreadystatechange=function(){if(2===t.readyState){var r=t.status,n=t.statusText,o=t.getResponseHeader("Content-Type"),a=t.getAllResponseHeaders();e(r,n,o,new _(a),function(){t.abort()})}else 4===t.readyState&&i()},t.withCredentials=s,t.responseType="text",u)Object.prototype.hasOwnProperty.call(u,h)&&t.setRequestHeader(h,u[h]);t.send()},w.prototype.get=function(t){return this._headers.get(t)},O.prototype.open=function(t,e,r,i,a,s,l){var h=new p,v=h.signal,y=new f;c(a,{headers:l,credentials:s?"include":"same-origin",signal:v,cache:"no-store"}).then(function(t){var i=t.body.getReader();return e(t.status,t.statusText,t.headers.get("Content-Type"),new w(t.headers),function(){h.abort(),i.cancel().catch(function(){})}),new u(function(t,e){var a=function(){new u(function(t,e){var r=n(function(){e(new Error("Reader read timeout")),r=null},d);i.read().then(function(e){r&&(o(r),t(e))},e)}).then(function(e){if(e.done)t(void 0);else{var n=y.decode(e.value,{stream:!0});r(n),a()}}).catch(function(t){e(t)})};a()})}).catch(function(){}).finally(function(){i()})},C.prototype.dispatchEvent=function(t){t.target=this;var e=this._listeners[t.type];if(void 0!=e)for(var r=e.length,n=0;n<r;n+=1){var o=e[n];try{"function"==typeof o.handleEvent?o.handleEvent(t):o.call(this,t)}catch(t){k(t)}}},C.prototype.addEventListener=function(t,e){t=String(t);var r=this._listeners,n=r[t];void 0==n&&(n=[],r[t]=n);for(var o=!1,i=0;i<n.length;i+=1)n[i]===e&&(o=!0);o||n.push(e)},C.prototype.removeEventListener=function(t,e){t=String(t);var r=this._listeners,n=r[t];if(void 0!=n){for(var o=[],i=0;i<n.length;i+=1)n[i]!==e&&o.push(n[i]);0===o.length?delete r[t]:r[t]=o}},A.prototype=Object.create(S.prototype),T.prototype=Object.create(S.prototype);var R=-1,j=0,N=1,x=2,I=-1,P=0,D=1,F=2,L=3,M=/^text\/event\-stream;?(\s*charset\=utf\-8)?$/i,U=function(t,e){var r=parseInt(t,10);return r!=r&&(r=e),H(r)},H=function(t){return Math.min(Math.max(t,1e3),18e6)},G=function(t,e,r){try{"function"==typeof e&&e.call(t,r)}catch(t){k(t)}};function $(t,e){C.call(this),this.onopen=void 0,this.onmessage=void 0,this.onerror=void 0,this.url=void 0,this.readyState=void 0,this.withCredentials=void 0,this._close=void 0,this.status=0,function(t,e,r){e=String(e);var s=void 0!=r&&Boolean(r.withCredentials),u=H(1e3),c=void 0!=r&&void 0!=r.heartbeatTimeout?U(r.heartbeatTimeout,45e3):H(45e3),l="",f=u,h=!1,p=void 0!=r&&void 0!=r.headers?JSON.parse(JSON.stringify(r.headers)):void 0,d=void 0!=r&&void 0!=r.Transport?r.Transport:void 0!=i&&"withCredentials"in i.prototype||void 0==a?i:a,v=B&&(void 0==r||void 0==r.Transport&&!r.forceXhr)?void 0:new m(new d),y=void 0==v?new O:new E,g=void 0,b=0,_=R,w="",C="",$="",q="",V=P,W=0,z=0,J=function(e,r,n,o,i){if(t.status=e,_===j)if(g=i,200===e&&void 0!=n&&M.test(n)){_=N,h=!0,f=u,t.readyState=N;var a=new T("open",{status:e,statusText:r,headers:o});t.dispatchEvent(a),G(t,t.onopen,a)}else{var s="";200!==e?(r&&(r=r.replace(/\s+/g," ")),s="EventSource's response has a status "+e+" "+r+" that is not 200. Aborting the connection."):s="EventSource's response has a Content-Type specifying an unsupported type: "+(void 0==n?"-":n.replace(/\s+/g," "))+". Aborting the connection.",k(new Error(s)),X();var a=new T("error",{status:e,statusText:r,headers:o});t.dispatchEvent(a),G(t,t.onerror,a)}},K=function(e){if(_===N){for(var r=-1,i=0;i<e.length;i+=1){var a=e.charCodeAt(i);a!=="\n".charCodeAt(0)&&a!=="\r".charCodeAt(0)||(r=i)}var s=(-1!==r?q:"")+e.slice(0,r+1);q=(-1===r?q:"")+e.slice(r+1),""!==s&&(h=!0);for(var p=0;p<s.length;p+=1){var a=s.charCodeAt(p);if(V===I&&a==="\n".charCodeAt(0))V=P;else if(V===I&&(V=P),a==="\r".charCodeAt(0)||a==="\n".charCodeAt(0)){if(V!==P){V===D&&(z=p+1);var d=s.slice(W,z-1),v=s.slice(z+(z<p&&s.charCodeAt(z)===" ".charCodeAt(0)?1:0),p);"data"===d?(w+="\n",w+=v):"id"===d?C=v:"event"===d?$=v:"retry"===d?(u=U(v,u),f=u):"heartbeatTimeout"===d&&(c=U(v,c),0!==b&&(o(b),b=n(function(){Q()},c)))}if(V===P){if(""!==w){l=C,""===$&&($="message");var y=new A($,{data:w.slice(1),lastEventId:C});if(t.dispatchEvent(y),"message"===$&&G(t,t.onmessage,y),_===x)return}w="",$=""}V=a==="\r".charCodeAt(0)?I:P}else V===P&&(W=p,V=D),V===D?a===":".charCodeAt(0)&&(z=p+1,V=F):V===F&&(V=L)}}},Y=function(){if(_===N||_===j){_=R,0!==b&&(o(b),b=0),b=n(function(){Q()},f),f=H(Math.min(16*u,2*f)),t.readyState=j;var e=new S("error",{status:t.status});t.dispatchEvent(e),G(t,t.onerror,e)}},X=function(){_=x,void 0!=g&&(g(),g=void 0),0!==b&&(o(b),b=0),t.readyState=x},Q=function(){if(b=0,_===R){h=!1,b=n(function(){Q()},c),_=j,w="",$="",C=l,q="",W=0,z=0,V=P;var t=e;"data:"!==e.slice(0,5)&&"blob:"!==e.slice(0,5)&&""!==l&&(t+=(-1===e.indexOf("?")?"?":"&")+"lastEventId="+encodeURIComponent(l));var r={Accept:"text/event-stream"};if(void 0!=p)for(var o in p)Object.prototype.hasOwnProperty.call(p,o)&&(r[o]=p[o]);try{y.open(v,J,K,Y,t,s,r)}catch(t){throw X(),t}}else h||void 0==g?(h=!1,b=n(function(){Q()},c)):(k(new Error("No activity within "+c+" milliseconds. Reconnecting.")),g(),g=void 0)};t.url=e,t.readyState=j,t.withCredentials=s,t._close=X,Q()}(this,t,e)}var B=void 0!=c&&void 0!=l&&"body"in l.prototype;$.prototype=Object.create(C.prototype),$.prototype.CONNECTING=j,$.prototype.OPEN=N,$.prototype.CLOSED=x,$.prototype.close=function(){this._close()},$.CONNECTING=j,$.OPEN=N,$.CLOSED=x,$.prototype.withCredentials=void 0,t.exports=$},function(t,e){function r(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=r,r.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),r=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-r:t+r}return 0|Math.min(t,this.max)},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(t){this.ms=t},r.prototype.setMax=function(t){this.max=t},r.prototype.setJitter=function(t){this.jitter=t}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(e){var r=t.call(this)||this;return r.editor=e,"undefined"!=typeof document?document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&r.emit("visible",!1),"visible"===document.visibilityState&&r.emit("visible",!0)}):r.editor&&r.editor.constructor&&r.editor.constructor.events&&"string"==typeof r.editor.constructor.events.VISIBILITY_CHANGE&&r.editor.on(r.editor.constructor.events.VISIBILITY_CHANGE,function(t){r.emit("visible",t)}),r}return n(e,t),e}(r(5).Base);e.Visible=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n};Object.defineProperty(e,"__esModule",{value:!0});var i,a=r(1),s=r(15),u=r(5),c=r(15);e.Status=c.Status,function(t){t[t.ONLINE=0]="ONLINE",t[t.OFFLINE=1]="OFFLINE",t[t.FORCE_OFFLINE=2]="FORCE_OFFLINE"}(i||(i={}));var l=function(t){function e(e){var r=e.timeoutThreshold,n=e.online,o=void 0===n||n,a=t.call(this)||this;return a.events={CHANGE:"change"},a.beforeSendRequestTime=0,a.receivePending=!1,a.timeoutThreshold=r,a.online=o?i.ONLINE:i.OFFLINE,a.status=o?s.Status.ONLINE:s.Status.OFFLINE,setTimeout(function(){a.status===s.Status.OFFLINE&&a.emitChange(a.status)},0),a}return n(e,t),e.prototype.onEvent=function(t){for(var e=this,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];switch(t){case a.Event.ACCEPT:this.online!==i.ONLINE&&(this.emitChange(s.Status.ONLINE),this.online=i.ONLINE),this.receivePending=!1,this.beforeSendRequestTime=0,clearTimeout(this.saveTimeout),this.emitChange(s.Status.ONLINE_SAVED);break;case a.Event.ERROR:case a.Event.ACCEPT_FAILED:this.emitChange(s.Status.ONLINE_SAVE_FAILED);break;case a.Event.NEW_CHANGE:this.online===i.ONLINE?this.emitChange(s.Status.ONLINE_SAVING):this.emitChange(s.Status.OFFLINE_SAVING);break;case a.Event.NEW_CHANGE_SAVE_TO_STORAGE_FAILED:this.online!==i.ONLINE&&this.emitChange(s.Status.OFFLINE_SAVE_FAILED);break;case a.Event.NEW_CHANGE_SAVED_TO_STORAGE:this.online!==i.ONLINE&&this.emitChange(s.Status.OFFLINE_SAVED);break;case a.Event.BEFORE_SEND_REQUEST:if(this.beforeSendRequestTime)return;this.beforeSendRequestTime=Date.now(),clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(function(){e.online=i.FORCE_OFFLINE,e.emitChange(s.Status.OFFLINE,{forceOffline:!0})},this.timeoutThreshold);break;case a.Event.CHANGES_PENDING:if(this.receivePending)return;this.receivePending=!0,this.status===s.Status.ONLINE_SAVING&&this.emitChange.apply(this,o([s.Status.ONLINE_SAVING],r)),this.beforeSendRequestTime&&(clearTimeout(this.saveTimeout),this.saveTimeout=setTimeout(function(){e.online=i.FORCE_OFFLINE,e.emitChange(s.Status.OFFLINE,{forceOffline:!0})},3*this.timeoutThreshold));break;case a.Event.SERVER_CHANGE_APPLIED:this.receivePending?this.saveStatus(s.Status.SERVER_CHANGE_APPLIED):this.emitChange(s.Status.SERVER_CHANGE_APPLIED);break;case a.Event.WAITING_FOR_CAN_HANDLE_SERVER_CHANGES:clearTimeout(this.saveTimeout);break;case a.Event.NETWORK_CHANGE:var u=r[0];u&&this.online===i.OFFLINE&&(this.online=i.ONLINE,this.emitChange(s.Status.ONLINE)),u||this.online!==i.ONLINE||(this.online=i.OFFLINE,this.emitChange(s.Status.OFFLINE))}},e.prototype.destroy=function(){clearTimeout(this.saveTimeout)},e.prototype.saveStatus=function(t){this.track("saveStatus changed to "+t),this.status=t},e.prototype.emitChange=function(t,e){this.saveStatus(t),this.emit(this.events.CHANGE,t,e)},e.events={CHANGE:"change"},e}(u.Base);e.SaveStatus=l},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(16),s=r(2),u=r(14),c=r(1),l=r(24),f=s("collab:sender"),h=function(t){function e(e){var r=t.call(this,{offlineTimeoutInMS:2.5*(e.retryInterval||5e3)})||this;return r.stopped=!1,r.retryInterval=5e3,r.url=e.url,r.clientId=e.clientId,r.tracker=e.tracker,r.interceptRequest=e.interceptRequest,e.retryInterval&&(r.retryInterval=e.retryInterval),r.tracker.on(c.Event.NEW_TRACKER_CHANGE,function(t){r.compose(t)}),r}return n(e,t),e.prototype.start=function(){this.tracker.tryToSendNewChange(!0)},e.prototype.stop=function(){this.stopped=!0},e.prototype.destroy=function(){this.stop(),this.superDestroy()},e.prototype.compose=function(t){return o(this,void 0,void 0,function(){var e;return i(this,function(r){switch(r.label){case 0:return e={changeset:t.delta,clientId:this.clientId,rev:t.rev,uuid:t.uuid},[4,this.sendRequest(e)];case 1:return r.sent(),[2]}})})},e.prototype.sendRequest=function(t,e){return void 0===e&&(e=!1),o(this,void 0,void 0,function(){var r,n,o,s,u,l,h=this;return i(this,function(i){switch(i.label){case 0:if(this.stopped)return[2];f("Sender send request",{payload:t,retry:e}),i.label=1;case 1:return i.trys.push([1,3,,4]),this.emit(c.Event.BEFORE_SEND_REQUEST),r=this.assembleUrl(this.url),[4,a.default({data:t,method:"post",url:r,withCredentials:!0})];case 2:return i.sent(),this.emit(c.Event.SEND_REQUEST_DONE),this.track("send request successfully"),this.updateNetworkStatus(!0),[3,4];case 3:return n=i.sent(),this.track("send request error",n.response),o=n.response,"4"===(s=String(o&&o.status))[0]&&"429"!==s?(u=o&&o.data&&o.data.errorCode||c.getErrorCodeByHttpStatus(s),l="Sender request error with code "+u,this.emit(c.Event.ACCEPT_FAILED,new c.CollaborationError(l,u,n)),this.emitError(l,u,n),[2]):(this.emit(c.Event.SEND_REQUEST_FAILED),setTimeout(function(){h.sendRequest(t,!0)},this.retryInterval),[3,4]);case 4:return[2]}})})},e.prototype.assembleUrl=function(t){var e=t.split("?"),r=e[0],n=e[1],o=n?u.parse(n):{},i=this.interceptRequest({url:r,method:"POST",query:o,headers:{}}),a=i.query||{},s="";return Object.keys(a).length>0&&(s="?"+u.stringify(a)),""+i.url+s},e}(l.NetworkDetectable);e.Sender=h},function(t,e,r){"use strict";var n=r(0),o=r(25),i=r(62),a=r(31);function s(t){var e=new i(t),r=o(i.prototype.request,e);return n.extend(r,i.prototype,e),n.extend(r,e),r}var u=s(r(28));u.Axios=i,u.create=function(t){return s(a(u.defaults,t))},u.Cancel=r(32),u.CancelToken=r(74),u.isCancel=r(27),u.all=function(t){return Promise.all(t)},u.spread=r(75),t.exports=u,t.exports.default=u},function(t,e){
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&null!=t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}},function(t,e,r){"use strict";var n=r(0),o=r(26),i=r(63),a=r(64),s=r(31);function u(t){this.defaults=t,this.interceptors={request:new i,response:new i}}u.prototype.request=function(t){"string"==typeof t?(t=arguments[1]||{}).url=arguments[0]:t=t||{},(t=s(this.defaults,t)).method=t.method?t.method.toLowerCase():"get";var e=[a,void 0],r=Promise.resolve(t);for(this.interceptors.request.forEach(function(t){e.unshift(t.fulfilled,t.rejected)}),this.interceptors.response.forEach(function(t){e.push(t.fulfilled,t.rejected)});e.length;)r=r.then(e.shift(),e.shift());return r},u.prototype.getUri=function(t){return t=s(this.defaults,t),o(t.url,t.params,t.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],function(t){u.prototype[t]=function(e,r){return this.request(n.merge(r||{},{method:t,url:e}))}}),n.forEach(["post","put","patch"],function(t){u.prototype[t]=function(e,r,o){return this.request(n.merge(o||{},{method:t,url:e,data:r}))}}),t.exports=u},function(t,e,r){"use strict";var n=r(0);function o(){this.handlers=[]}o.prototype.use=function(t,e){return this.handlers.push({fulfilled:t,rejected:e}),this.handlers.length-1},o.prototype.eject=function(t){this.handlers[t]&&(this.handlers[t]=null)},o.prototype.forEach=function(t){n.forEach(this.handlers,function(e){null!==e&&t(e)})},t.exports=o},function(t,e,r){"use strict";var n=r(0),o=r(65),i=r(27),a=r(28),s=r(72),u=r(73);function c(t){t.cancelToken&&t.cancelToken.throwIfRequested()}t.exports=function(t){return c(t),t.baseURL&&!s(t.url)&&(t.url=u(t.baseURL,t.url)),t.headers=t.headers||{},t.data=o(t.data,t.headers,t.transformRequest),t.headers=n.merge(t.headers.common||{},t.headers[t.method]||{},t.headers||{}),n.forEach(["delete","get","head","post","put","patch","common"],function(e){delete t.headers[e]}),(t.adapter||a.adapter)(t).then(function(e){return c(t),e.data=o(e.data,e.headers,t.transformResponse),e},function(e){return i(e)||(c(t),e&&e.response&&(e.response.data=o(e.response.data,e.response.headers,t.transformResponse))),Promise.reject(e)})}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e,r){return n.forEach(r,function(r){t=r(t,e)}),t}},function(t,e,r){"use strict";var n=r(0);t.exports=function(t,e){n.forEach(t,function(r,n){n!==e&&n.toUpperCase()===e.toUpperCase()&&(t[e]=r,delete t[n])})}},function(t,e,r){"use strict";var n=r(30);t.exports=function(t,e,r){var o=r.config.validateStatus;!o||o(r.status)?t(r):e(n("Request failed with status code "+r.status,r.config,null,r.request,r))}},function(t,e,r){"use strict";t.exports=function(t,e,r,n,o){return t.config=e,r&&(t.code=r),t.request=n,t.response=o,t.isAxiosError=!0,t.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},t}},function(t,e,r){"use strict";var n=r(0),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];t.exports=function(t){var e,r,i,a={};return t?(n.forEach(t.split("\n"),function(t){if(i=t.indexOf(":"),e=n.trim(t.substr(0,i)).toLowerCase(),r=n.trim(t.substr(i+1)),e){if(a[e]&&o.indexOf(e)>=0)return;a[e]="set-cookie"===e?(a[e]?a[e]:[]).concat([r]):a[e]?a[e]+", "+r:r}}),a):a}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?function(){var t,e=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function o(t){var n=t;return e&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return t=o(window.location.href),function(e){var r=n.isString(e)?o(e):e;return r.protocol===t.protocol&&r.host===t.host}}():function(){return!0}},function(t,e,r){"use strict";var n=r(0);t.exports=n.isStandardBrowserEnv()?{write:function(t,e,r,o,i,a){var s=[];s.push(t+"="+encodeURIComponent(e)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(o)&&s.push("path="+o),n.isString(i)&&s.push("domain="+i),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(t){var e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(t,e,r){"use strict";t.exports=function(t){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(t)}},function(t,e,r){"use strict";t.exports=function(t,e){return e?t.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):t}},function(t,e,r){"use strict";var n=r(32);function o(t){if("function"!=typeof t)throw new TypeError("executor must be a function.");var e;this.promise=new Promise(function(t){e=t});var r=this;t(function(t){r.reason||(r.reason=new n(t),e(r.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var t;return{token:new o(function(e){t=e}),cancel:t}},t.exports=o},function(t,e,r){"use strict";t.exports=function(t){return function(e){return t.apply(null,e)}}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=r(2),a=r(77),s=r(5),u=r(1),c=r(6),l=i("collab:tracker"),f="modoc",h=function(t){function e(e){var r=t.call(this)||this;if(r.type=f,r.storage={set:u.noop},r.modocUserSelectFeat=!1,r.waitingForAccept=!1,r.onChange=function(t){r.track("onChange"),"string"==typeof t&&(t=r.adaptor.unpack(t)),l.enabled&&r.debug("onChange",{delta:t,deltaString:r.adaptor.pack(t)}),r.userChange.delta=r.userChange.delta.compose(t),r.tryToSendNewChange(),r.saveData(),r.emit(u.Event.NEW_CHANGE),l.enabled&&r.debug("afterOnChange")},r.editor=e.editor,r.rev=e.rev,e.storage&&(r.storage=e.storage),e.type&&(r.type=e.type.toLowerCase()),e.modocUserSelectFeat&&(r.modocUserSelectFeat=e.modocUserSelectFeat),r.adaptor=e.adaptors?e.adaptors[r.type]:a.adaptors[r.type],!r.adaptor)throw new Error("options.type must be modoc or richdoc");r.committingChange=e.committingChange?{delta:r.adaptor.unpack(e.committingChange.delta),uuid:e.committingChange.uuid||u.uuid()}:{delta:r.adaptor.empty(),uuid:u.uuid()},r.userChange=e.userChange?{delta:r.adaptor.unpack(e.userChange.delta),uuid:e.userChange.uuid||u.uuid()}:{delta:r.adaptor.empty(),uuid:u.uuid()},(r.committingChange.delta.length>0||r.userChange.delta.length>0)&&r.saveData();var n=r.editor.constructor;return r.editor.on(n.events.CHANGE,r.onChange),r}return n(e,t),e.prototype.setCollaborator=function(t){this.collaborator=t},e.prototype.tryToSendNewChange=function(t){void 0===t&&(t=!1);var e=t&&!this.waitingForAccept&&this.committingChange.delta.length>0,r=0===this.committingChange.delta.length&&this.userChange.delta.length>0&&!this.waitingForAccept;(r||e)&&(r&&(this.committingChange=this.userChange,this.userChange={delta:this.adaptor.empty(),uuid:u.uuid()}),this.track("tryToSendNewChange successfully",{rev:this.rev,committingChangesetUuid:this.committingChange.uuid,userChangesetUuid:this.userChange.uuid}),this.emit(u.Event.NEW_TRACKER_CHANGE,{rev:this.rev,delta:this.adaptor.pack(this.committingChange.delta),uuid:this.committingChange.uuid}),this.waitingForAccept=!0)},e.prototype.canHandleChangesRightNow=function(){var t={acceptCommit:!0,newChange:!0};if(!this.editor.canHandleChanges)return t;var e=this.editor.canHandleChanges();return"boolean"==typeof e?t.acceptCommit=t.newChange=e:t=e,this.track("canHandleChangesRightNow",t),t},e.prototype.applyPreparedChangesetToBase=function(t){this.track("applyPreparedChangesetToBase",{rev:t}),this.committingChange={delta:this.adaptor.empty(),uuid:u.uuid()},this.waitingForAccept=!1,this.rev=t,this.emit(u.Event.ACCEPT),this.tryToSendNewChange(),this.saveData(),l.enabled&&this.debug("afterApplyPreparedChangesetToBase")},e.prototype.applyChangesToBase=function(t,e){if(0===t.length)return!0;this.track("applyChangesToBase",t.map(function(t){return{rev:t.rev,clientId:t.clientId}}));for(var r,n=u.last(t).rev,o=this.committingChange.delta,i=this.userChange.delta,a=0,s=t;a<s.length;a++){var c=s[a],f=this.adaptor.unpack(c.changeset),h=i.transform(o.transform(f,!e));i=o.transform(f,!0).transform(i,!0),o=f.transform(o,!1),r=r?r.compose(h):h,this.emit(u.Event.SERVER_CHANGE_PROCESSED,{change:h})}for(var p=[],d=0,v=t;d<v.length;d++){c=v[d];if(this.emit(u.Event.SERVER_CHANGE_APPLIED,c),this.modocUserSelectFeat&&this.collaborator&&c.clientId&&c.baseRev){var y=this.collaborator.getUserSelect(c.clientId,c.baseRev);y&&p.push(y)}}try{return!!this.canHandleChangesRightNow().newChange&&(this.committingChange.delta=o,this.userChange.delta=i,this.rev=n,this.modocUserSelectFeat?this.editor.applyChange(r,p):this.editor.applyChange(r),l.enabled&&this.debug("afterApplyChangesToBase",{messages:t}),!0)}catch(t){this.emitError("Apply change to editor error",u.ERROR.ERR_APPLY_CHANGE,t)}return!0},e.prototype.destroy=function(){var t=this.editor.constructor;this.editor.off(t.events.CHANGE,this.onChange)},e.prototype.getData=function(){return{rev:this.rev,committingChange:{delta:this.adaptor.pack(this.committingChange.delta),uuid:this.committingChange.uuid},userChange:{delta:this.adaptor.pack(this.userChange.delta),uuid:this.userChange.uuid}}},e.prototype.haveUnsavedChange=function(){return this.committingChange.delta.length>0||this.userChange.delta.length>0},e.prototype.saveData=function(){try{this.track("saveData"),this.storage.set(this.getData()),this.track("saveData successfully"),this.emit(u.Event.NEW_CHANGE_SAVED_TO_STORAGE)}catch(t){this.track("saveData error",t),this.emitError("Save data to storage error",u.ERROR.ERR_STORAGE_SET,t),this.emit(u.Event.NEW_CHANGE_SAVE_TO_STORAGE_FAILED)}},e.prototype.debug=function(t,e){void 0===e&&(e={}),l(t,c({},{rev:this.rev,committingChange:o({},this.committingChange),committingDeltaString:this.adaptor.pack(this.committingChange.delta),userChange:o({},this.userChange),userDeltaString:this.adaptor.pack(this.userChange.delta)},e))},e}(s.Base);e.Tracker=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(78),o=r(89);e.adaptors={modoc:n,richdoc:o}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(33);e.empty=function(){return new n.Delta([])},e.pack=function(t){return t.stringify()},e.unpack=function(t){return n.Delta.isDelta(t)?t:new n.Delta(t)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.keyToGul={color:"0",background:"1","font-size":"2",width:"3",height:"4",rowspan:"5",colspan:"6",align:"7",bold:"8",italic:"9",underline:"a",vertical:"b",strike:"c",wrap:"d",fixedRowsTop:"e",fixedColumnsLeft:"f",link:"g",format:"h",formula:"i",filter:"j","border-top":"k","border-right":"l","border-bottom":"m","border-left":"n",line:"o",guid:"p",author:"q",size:"r",list:"s",layout:"t",margin:"u",font:"v",header:"w",indent:"x",comment:"y","comment-block":"z","code-block":"A",name:"B",order:"C",autoFit:"D",userID:"E",nextIndex:"F",id:"G",colVisible:"H",rowVisible:"I",autoFormatter:"J",copyIndex:"K",manualAlign:"L",lock:"M",left:"N",top:"O"};var n=["color","background","font-size","width","height","rowspan","colspan","align","bold","italic","underline","vertical","strike","wrap","fixedRowsTop","fixedColumnsLeft","link","format","formula","filter","border-top","border-right","border-bottom","border-left","line","guid","author","size","list","layout","margin","font","header","indent","comment","comment-block","code-block","name","order","autoFit","userID","nextIndex","id","colVisible","rowVisible","autoFormatter","copyIndex","manualAlign","lock","left","top","cellValue"];function o(t){var e,r=t.charCodeAt(0);if(r>=48&&r<=57)e=n[r-48];else if(r>=65&&r<=90)e=n[r-29];else{if(!(r>=97&&r<=122))throw new Error('Unknown gul "'+t+'"');e=n[r-87]}return e}function i(t){var r=e.keyToGul[t];if(r)return r;var n=t.length.toString(36),o=n.length;if(o>2)throw new Error("Key length of attribute should <= 2: "+n);return""+(1===o?"$":"%")+n+t}e.getAttributeKeyByGul=o,e.getGulByAttributeKey=i,e.combinedAttributeWithValue=function(t,e){var r=i(t);return"string"==typeof e?r+":"+e:"number"==typeof e?r+"*"+e.toString():"boolean"==typeof e?r+(e?"1":"0"):r},e.keyValueToGul={81:"!","2*12":'"',"2*11":"#","2*10":"$","2*9":"%","2*8":"&","6*2":"'","6*3":"(","6*4":")","5*2":"*","5*3":"+","5*4":",","0:#ff0000":"-","0:#ffffff":".","b:bottom":"/","h:normal":"0",1:"1","1:#ffffff":"2","1:#ff0000":"3","1:#ffff00":"4","1:#00ffff":"5","7:left":"6","7:center":"7","7:right":"8","1*4":"9","d:text-wrap":":","d:text-no-wrap":";","h:YYYY/MM/DD":"<",'l:["",1]':"=",'n:["",1]':">",'k:["",1]':"?",'m:["",1]':"@",'l:["#2b2b2b",1]':"A",'n:["#2b2b2b",1]':"B",'k:["#2b2b2b",1]':"C",'m:["#2b2b2b",1]':"D"};var a=[["bold",!0],["font-size",12],["font-size",11],["font-size",10],["font-size",9],["font-size",8],["colspan",2],["colspan",3],["colspan",4],["rowspan",2],["rowspan",3],["rowspan",4],["color","#ff0000"],["color","#ffffff"],["vertical","bottom"],["format","normal"],["background",null],["background","#ffffff"],["background","#ff0000"],["background","#ffff00"],["background","#00ffff"],["align","left"],["align","center"],["align","right"],["background",4],["wrap","text-wrap"],["wrap","text-no-wrap"],["format","YYYY/MM/DD"],["border-right",'["",1]'],["border-left",'["",1]'],["border-top",'["",1]'],["border-bottom",'["",1]'],["border-right",'["#2b2b2b",1]'],["border-left",'["#2b2b2b",1]'],["border-top",'["#2b2b2b",1]'],["border-bottom",'["#2b2b2b",1]']];e.getGulByCombinedKeyValue=function(t){return e.keyValueToGul.hasOwnProperty(t)?e.keyValueToGul[t]:null},e.getKeyValueByGul=function(t){var e=t.charCodeAt(0)-33;return a[e]},e.parseCombinedAttributeValue=function(t){var e;if("$"===t[0]){var r=parseInt(t[1],36);e=t.substring(2,2+r),t=t.substring(1+r)}else"%"===t[0]?(r=parseInt(t[1]+t[2],36),e=t.substring(3,3+r),t=t.substring(2+r)):e=o(t[0]);if(1===t.length)return[e,null];var n=t[1];if("1"===n)return[e,!0];if("0"===n)return[e,!1];var i=t.substring(2);return[e,":"===n?i:Number(i)]}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.objectToKeyPaths=function t(e,r,n){void 0===n&&(n=[]);for(var o=0,i=Object.keys(e);o<i.length;o++){var a=i[o],s=e[a],u=r+"."+a;"object"==typeof s&&null!==s?t(s,u,n):n.push([u,s])}return n},e.keyPathToObject=function(t,e,r){for(var n=e.split("."),o=n.length,i=1;i<o-1;i++){var a=n[i],s=t[a];t="object"==typeof s&&null!==s?s:t[a]={}}var u=n[o-1];null===r&&void 0!==t[u]&&null!==t[u]||(t[u]=r)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(37),o=r(9),i=function(){function t(t,e,r,n){this.ops=t,this.pool=e,this.targetPool=r,this.operatorConstructor=n,this.cursor=0,this.offset=0}return t.prototype.isPoolCompatible=function(){return void 0===this.isCompatible&&(this.isCompatible=this.pool.isSubsetOf(this.targetPool)),this.isCompatible},t.prototype.hasNext=function(){return this.cursor<this.ops.length},t.prototype.remainingStrs=function(t){for(;this.hasNext();){var e=this.next();if(t.push(e)!==o.PushResult.REORDERED){var r=this.cursor;return this.cursor=this.ops.length,this.nextData=void 0,t.stringify()+this.ops.substring(r)}}return t.stringify(!0)},t.prototype.skip=function(t){void 0===t&&(t=1/0);var e=this.peekNext();if(null===e)throw new Error("No more operators");var r,n=this.offset;return t+n>=e.dataLength?(r=e.dataLength-n,this.nextData=void 0,this.cursor=e.opIndex+e.opLength,this.offset=0):(r=t,this.offset+=r),[r,n,e]},t.prototype.next=function(t,e){void 0===t&&(t=1/0);var r,o=this.skip(t),i=o[0],a=o[1],s=o[2];switch(s.dataType){case"number":r=i;break;case"string":r=this.ops.substring(s.dataIndex+1+a,s.dataIndex+1+a+i);break;default:var u=this.ops[s.dataIndex+1+a],c=this.ops.substring(s.dataIndex+1+1,s.dataIndex+1+s.actualLength);(f={})[n.initialToObjectKey[u]]=c,r=f}var l,f,h=this.ops.substring(s.dataIndex+1+s.actualLength,s.opIndex+s.opLength),p=this.targetPool,d=""!==h&&!this.isPoolCompatible();return 0!==a||i!==s.dataLength||d||(l=this.ops.substring(s.opIndex,s.dataIndex+1+s.actualLength)),d&&(h=p.packAttributes(this.pool.unpackAttributes(h))),new this.operatorConstructor({action:e||s.action,data:r,packedAttributes:h,pool:p},l)},t.prototype.peekAction=function(){var t=this.peekNext();return null===t?"retain":t.action},t.prototype.peekLength=function(){var t=this.peekNext();return null===t?1/0:t.dataLength-this.offset},t.prototype.peekNext=function(){if(!this.hasNext())return null;if(void 0===this.nextData){var t=void 0,e=void 0;e=this.cursor+1;for(var r=this.ops.length;e<r;){switch(this.ops[e]){case"!":t="insert";break;case"@":t="retain";break;case"#":t="remove"}if(void 0!==t)break;e+=1}var n=e,o=parseInt(this.ops.substring(this.cursor,n),36);e=n+1;for(var i=void 0;e<r;){switch(this.ops[e]){case"!":i="string";break;case"#":i="number";break;case"@":i="object"}if(void 0!==i)break;e+=1}var a=e,s=parseInt(this.ops.substring(n+1,a),36),u="number"===i?0:s,c="object"===i?1:s;this.nextData={action:t,dataIndex:a,dataLength:c,opIndex:n,opLength:o,dataType:i,actualLength:u}}return this.nextData},t}();e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(83),o=r(85),i=r(86),a=r(87),s=r(88),u=r(41);e.registerDataHandlers=function(t,e,r){var c=function(t,e){return function(r){return new r(t,e)}}(e,r);t.registerDataHandler("delta",c(o.default)),t.registerDataHandler("table",c(n.default)),t.registerDataHandler("presentation",c(a.default)),t.registerDataHandler("slide",c(i.default)),t.registerDataHandler("mindmap",c(i.default)),t.registerDataHandler("object",c(s.default)),t.registerDataHandler("form",c(u.default))}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(40),i=r(84),a=r(7),s=r(33),u=r(9),c=r(35),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.pack=function(t){var e=t.rows,r=t.cols,n=o.possibleDeltaInputToString(this.deltaConstructor,e),i=o.possibleDeltaInputToString(this.deltaConstructor,r);return n.length.toString(36)+"$"+n+i},e.prototype.toJSON=function(t){var e=this.parse(t),r=e[0],n=e[1];return{rows:null===r?null:r.toJSON(),cols:null===n?null:n.toJSON()}},e.prototype.explain=function(t,e){var r=t+"Rows:\n",n=this.parse(e),o=n[0],i=n[1];return r+=null===o?"[EMPTY]":o.explain(t),r+=t+"Cols:\n",r+=null===i?"[EMPTY]":i.explain(t)},e.prototype.parse=function(t){var e=t.indexOf("$"),r=parseInt(t.substring(0,e),36),n=e+1+r;return[0===r?null:new this.deltaConstructor(t.substring(e+1,n)),t.length===n?null:new this.deltaConstructor(t.substring(n))]},e.prototype.compose=function(t,e,r){var n=this.parse(t),o=n[0],a=n[1],s=this.parse(e),u=s[0],c=s[1],l=null===u?o:null===o?u:o.compose(u,r),f=i.reindexInnerDeltas(a,u),h=null===c?f:null===f?c:f.compose(c,r);return this.pack({rows:l,cols:h})},e.prototype.transform=function(t,e,r){var n=this.parse(t),o=n[0],a=n[1],s=this.parse(e),u=s[0],c=s[1],l=null===o||null===u?u:o.transform(u,r),f=null===o||null===u?o:u.transform(o,!r),h=i.reindexInnerDeltas(a,l),p=i.reindexInnerDeltas(c,f),d=null===h||null===p?p:h.transform(p,r);return this.pack({rows:l,cols:d})},e.prototype.invert=function(t,e){var r=this,n=this.parse(t),o=n[0],a=n[1],l=this.parse(e),f=l[0],h=l[1],p=f&&(null===o?new this.deltaConstructor([]):o).invert(f),d=i.invertInnerDeltas(a,f);if(null!==h){var v=null===a?new c.default([]):a;if(d){var y=i.DeltaToIndexModifiers(h);d=i.reindexDelta(d,y)}var g=i.reindexInnerDeltas(h,p);if(null===g)throw new Error("ASSERT: targetCols === null");var m=v.invert(g,function(t,e){if("delta"!==e.dataType)return t.invert(e);for(var n=new s.Pool,o=new u.default([]),i="number"===t.dataType?null:new r.deltaConstructor(t.getCustomData()).getIter({targetPool:n}),a=new r.deltaConstructor(e.getCustomData()).getIter({targetPool:n});a.hasNext();){var c=void 0,l=void 0;if(null!==i&&i.hasNext()){var f=Math.min(i.peekLength(),a.peekLength());c=i.next(f,"insert"),l=a.next(f)}else{var h=a.peekLength();c=new r.operatorConstructor({action:"insert",data:h}),l=a.next()}o.push(c.invert(l))}return t.invert(e,{delta:new r.deltaConstructor(o.stringify(!0),n).stringify()})});d=d?d.compose(m):m}return this.pack({rows:p,cols:d})},e}(a.default);e.default=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(9),o=r(34),i=r(18);function a(t){for(var e=[],r=-1,n=t.getIter();n.hasNext();){var o=n.next(),i=o.action,a=o.length;-1!==r&&e[r][0]===i?e[r][1]+=a:e[++r]=[i,a]}return e}function s(t,e){for(var r=t.getPoolCopy(),a=new n.default([]),s=t.getIter({sourcePool:r,targetPool:r}),u=new Array(e.length),c=0;c<e.length&&s.hasNext();c++){var l=u[c]||e[c],f=l[0],h=l[1];switch(f){case"insert":a.push(new i.default({action:"retain",data:h,packedAttributes:"",pool:r}));break;case"retain":(p=s.peekLength())>=h?a.push(s.next(h)):(a.push(s.next()),u[c]=["retain",h-p],c-=1);break;case"remove":var p;(p=s.peekLength())>=h?s.skip(h):(s.skip(),u[c]=["remove",h-p],c-=1)}}for(;s.hasNext();)a.push(s.next());return new o.Delta(a.stringify(!0),r)}e.DeltaToIndexModifiers=a,e.reindexDelta=s,e.reindexInnerDeltas=function(t,e){if(null===t||null===e)return t;var r=a(e);return 0===r.length?t:t.map(function(t){var e={action:t.action,data:t.data};if("remove"!==e.action&&t.hasAttributes()&&(e.attributes=t.getAttributes()),"delta"===t.dataType){var n=s(new o.Delta(t.getCustomData()),r);e.data=n.isEmpty()?1:{delta:n.stringify()}}else e.data=t.data;return e})},e.invertInnerDeltas=function(t,e){if(null===t||null===e)return null;for(var r=a(e),s=!1,u=0,c=r;u<c.length;u++)if("remove"===c[u][0]){s=!0;break}return s?t.map(function(t){var e={action:"retain",data:t.data};if(t.hasAttributes()&&(e.attributes=t.getAttributes()),"delta"===t.dataType){var a=function(t,e){for(var r=t.getPoolCopy(),a=new n.default([]),s=t.getIter({sourcePool:r,targetPool:r}),u=new Array(e.length),c=0;c<e.length&&s.hasNext();c++){var l=u[c]||e[c],f=l[0],h=l[1];switch(f){case"retain":var p=s.peekLength(),d=Math.min(h,p);a.push(new i.default({action:"retain",data:d,packedAttributes:"",pool:r})),s.skip(d),p<h&&(u[c]=["retain",h-p],c-=1);break;case"remove":(p=s.peekLength())>=h?a.push(s.next(h)):(a.push(s.next()),u[c]=["remove",h-p],c-=1)}}for(var v=0;s.hasNext();)v+=s.peekLength(),s.skip();return v>0&&a.push(new i.default({action:"retain",data:v,packedAttributes:"",pool:r})),new o.Delta(a.stringify(!0),r)}(new o.Delta(t.getCustomData()),r);e.data=a.isEmpty()?1:{delta:a.stringify()}}else e.data=t.data;return e}):null}},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(7),i=r(39),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){return this.parse(t).compose(this.parse(e),r).stringify()},e.prototype.transform=function(t,e,r){return this.parse(t).transform(this.parse(e),r).stringify()},e.prototype.invert=function(t,e){return this.parse(t).invert(this.parse(e)).stringify()},e.prototype.parse=function(t){return new this.deltaConstructor(t)},e.prototype.pack=function(t){if(Array.isArray(t))return new this.deltaConstructor(t).stringify();if(i.isDelta(t))return t.stringify();throw new Error("Unsupported delta value for packing "+t)},e.prototype.toJSON=function(t){return this.parse(t).toJSON()},e.prototype.explain=function(t,e){return this.parse(e).explain(t)},e}(o.default);e.default=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){for(var n=this.parse(t),o=this.parse(e),i=0,a=Object.keys(o);i<a.length;i++){var s=a[i],u=n[s],c=o[s];n[s]=void 0===u?c:u.compose(c,r)}return this.pack(n)},e.prototype.transform=function(t,e,r){for(var n=this.parse(t),o=this.parse(e),i=0,a=Object.keys(o);i<a.length;i++){var s=a[i],u=n[s];if(void 0!==u){var c=o[s];o[s]=u.transform(c,r)}}return this.pack(o)},e.prototype.invert=function(t,e){for(var r=this.parse(t),n=this.parse(e),o=0,i=Object.keys(n);o<i.length;o++){var a=i[o],s=r[a]||new this.deltaConstructor([]);n[a]=s.invert(n[a])}return this.pack(n)},e.prototype.parse=function(t){for(var e={},r=0;r<t.length;){var n=t.substring(r,r+8),o=t.indexOf("#",r+8),i=parseInt(t.substring(r+8,o),36),a=new this.deltaConstructor(t.substring(o+1,o+1+i));e[n]=a,r=o+1+i}return e},e.prototype.pack=function(t){for(var e="",r=0,n=Object.keys(t).sort();r<n.length;r++){var o=n[r];if(8!==o.length)throw new Error("element id length must equal to 8, got "+o);var i=t[o],a=Array.isArray(i)?new this.deltaConstructor(i):i;if(a.getIter().hasNext()){var s=a.stringify();e+=""+o+s.length.toString(36)+"#"+s}}return e},e.prototype.toJSON=function(t){for(var e={},r=this.parse(t),n=0,o=Object.keys(r);n<o.length;n++){var i=o[n],a=r[i];e[i]=a.toJSON()}return e},e.prototype.explain=function(t,e){for(var r=t+"Elements:\n",n=this.parse(e),o=0,i=Object.keys(n);o<i.length;o++){r+=n[i[o]].explain(t)}return r},e}(r(7).default);e.default=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.pack=function(e){return t.prototype.pack.call(this,Array.isArray(e)?e:[e.slides,e.layouts,e.notes])},e.prototype.toJSON=function(e){var r=t.prototype.toJSON.call(this,e);return{slides:r[0],layouts:r[1],notes:r[2]}},e.prototype.explain=function(t,e){var r=t+"Slides:\n",n=this.parse(e),o=n[0],i=n[1],a=n[2];return r+=o?o.explain(t):"[EMPTY]",r+=t+"Layouts:\n",r+=i?i.explain(t):"[EMPTY]",r+=t+"Notes:\n",r+=a?a.explain(t):"[EMPTY]"},e}(r(41).default);e.default=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(7),i=r(38),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.compose=function(t,e,r){return this.pack(i.merge(this.parse(t),this.parse(e),!r),r)},e.prototype.transform=function(t,e,r){return this.pack(i.transform(this.parse(t),this.parse(e),r),!1)},e.prototype.invert=function(t,e){return this.pack(i.invert(this.parse(t),this.parse(e)),!1)},e.prototype.parse=function(t){return JSON.parse(t)},e.prototype.pack=function(t,e){return e?JSON.stringify(t,function(t,e){return null===e?void 0:e}):JSON.stringify(t)},e.prototype.toJSON=function(t){return this.parse(t)},e.prototype.explain=function(t,e){return JSON.stringify(this.parse(e),null,t)},e}(o.default);e.default=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(90);e.empty=function(){return new n.Delta},e.pack=function(t){return n.pack(t)},e.unpack=function(t){return function(t,e){return t instanceof e}(t,n.Delta)?t:n.unpack(t)}},function(t,e,r){"use strict";var n=r(6),o=r(91);e.Attribute=r(10),e.Delta=r(11);var i={TableOperator:r(98),CellOperator:r(42),TextOperator:r(101),Operator:r(12)};n(e,i),e.pack=function(t){if("function"==typeof t.toJSON)return JSON.stringify(t);throw new Error("Only delta can be packed")},e.unpack=function(t){return e.Delta.unpack(JSON.parse(t))},e.print=function(t){t.print(!0)};var a=o(Object.keys(i),function(t,e){var r=i[e];return t[r.packId]=r,t},{});function s(t){var e=t[0].toString(),r=e[e.length-1];return a[e.slice(0,e.length-1)].unpack([r,t[1],t[2]])}e.Delta.operatorUnpacker=s,Object.keys(i).forEach(function(t){i[t].operatorUnpacker=s});var u=r(3);e.parsePosition=u.parsePosition,e.stringifyPosition=u.stringifyPosition},function(t,e,r){(function(t,r){var n=200,o="Expected a function",i="__lodash_hash_undefined__",a=1,s=2,u=1/0,c=9007199254740991,l="[object Arguments]",f="[object Array]",h="[object Boolean]",p="[object Date]",d="[object Error]",v="[object Function]",y="[object GeneratorFunction]",g="[object Map]",m="[object Number]",b="[object Object]",_="[object RegExp]",E="[object Set]",w="[object String]",O="[object Symbol]",C="[object ArrayBuffer]",k="[object DataView]",S=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,A=/^\w*$/,T=/^\./,R=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,j=/\\(\\)?/g,N=/^\[object .+?Constructor\]$/,x=/^(?:0|[1-9]\d*)$/,I={};I["[object Float32Array]"]=I["[object Float64Array]"]=I["[object Int8Array]"]=I["[object Int16Array]"]=I["[object Int32Array]"]=I["[object Uint8Array]"]=I["[object Uint8ClampedArray]"]=I["[object Uint16Array]"]=I["[object Uint32Array]"]=!0,I[l]=I[f]=I[C]=I[h]=I[k]=I[p]=I[d]=I[v]=I[g]=I[m]=I[b]=I[_]=I[E]=I[w]=I["[object WeakMap]"]=!1;var P="object"==typeof t&&t&&t.Object===Object&&t,D="object"==typeof self&&self&&self.Object===Object&&self,F=P||D||Function("return this")(),L="object"==typeof e&&e&&!e.nodeType&&e,M=L&&"object"==typeof r&&r&&!r.nodeType&&r,U=M&&M.exports===L&&P.process,H=function(){try{return U&&U.binding("util")}catch(t){}}(),G=H&&H.isTypedArray;function $(t,e,r,n){var o=-1,i=t?t.length:0;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function B(t,e){for(var r=-1,n=t?t.length:0;++r<n;)if(e(t[r],r,t))return!0;return!1}function q(t,e,r,n,o){return o(t,function(t,o,i){r=n?(n=!1,t):e(r,t,o,i)}),r}function V(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function W(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function z(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var J=Array.prototype,K=Function.prototype,Y=Object.prototype,X=F["__core-js_shared__"],Q=function(){var t=/[^.]+$/.exec(X&&X.keys&&X.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Z=K.toString,tt=Y.hasOwnProperty,et=Y.toString,rt=RegExp("^"+Z.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),nt=F.Symbol,ot=F.Uint8Array,it=Y.propertyIsEnumerable,at=J.splice,st=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),ut=Ht(F,"DataView"),ct=Ht(F,"Map"),lt=Ht(F,"Promise"),ft=Ht(F,"Set"),ht=Ht(F,"WeakMap"),pt=Ht(Object,"create"),dt=Jt(ut),vt=Jt(ct),yt=Jt(lt),gt=Jt(ft),mt=Jt(ht),bt=nt?nt.prototype:void 0,_t=bt?bt.valueOf:void 0,Et=bt?bt.toString:void 0;function wt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Ot(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Ct(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function kt(t){var e=-1,r=t?t.length:0;for(this.__data__=new Ct;++e<r;)this.add(t[e])}function St(t){this.__data__=new Ot(t)}function At(t,e){var r=Qt(t)||Xt(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!tt.call(t,i)||o&&("length"==i||$t(i,n))||r.push(i);return r}function Tt(t,e){for(var r=t.length;r--;)if(Yt(t[r][0],e))return r;return-1}wt.prototype.clear=function(){this.__data__=pt?pt(null):{}},wt.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},wt.prototype.get=function(t){var e=this.__data__;if(pt){var r=e[t];return r===i?void 0:r}return tt.call(e,t)?e[t]:void 0},wt.prototype.has=function(t){var e=this.__data__;return pt?void 0!==e[t]:tt.call(e,t)},wt.prototype.set=function(t,e){return this.__data__[t]=pt&&void 0===e?i:e,this},Ot.prototype.clear=function(){this.__data__=[]},Ot.prototype.delete=function(t){var e=this.__data__,r=Tt(e,t);return!(r<0||(r==e.length-1?e.pop():at.call(e,r,1),0))},Ot.prototype.get=function(t){var e=this.__data__,r=Tt(e,t);return r<0?void 0:e[r][1]},Ot.prototype.has=function(t){return Tt(this.__data__,t)>-1},Ot.prototype.set=function(t,e){var r=this.__data__,n=Tt(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},Ct.prototype.clear=function(){this.__data__={hash:new wt,map:new(ct||Ot),string:new wt}},Ct.prototype.delete=function(t){return Ut(this,t).delete(t)},Ct.prototype.get=function(t){return Ut(this,t).get(t)},Ct.prototype.has=function(t){return Ut(this,t).has(t)},Ct.prototype.set=function(t,e){return Ut(this,t).set(t,e),this},kt.prototype.add=kt.prototype.push=function(t){return this.__data__.set(t,i),this},kt.prototype.has=function(t){return this.__data__.has(t)},St.prototype.clear=function(){this.__data__=new Ot},St.prototype.delete=function(t){return this.__data__.delete(t)},St.prototype.get=function(t){return this.__data__.get(t)},St.prototype.has=function(t){return this.__data__.has(t)},St.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Ot){var o=r.__data__;if(!ct||o.length<n-1)return o.push([t,e]),this;r=this.__data__=new Ct(o)}return r.set(t,e),this};var Rt=function(t,e){return function(r,n){if(null==r)return r;if(!Zt(r))return t(r,n);for(var o=r.length,i=e?o:-1,a=Object(r);(e?i--:++i<o)&&!1!==n(a[i],i,a););return r}}(function(t,e){return t&&jt(t,e,ae)}),jt=function(t){return function(e,r,n){for(var o=-1,i=Object(e),a=n(e),s=a.length;s--;){var u=a[t?s:++o];if(!1===r(i[u],u,i))break}return e}}();function Nt(t,e){for(var r=0,n=(e=Bt(e,t)?[e]:Lt(e)).length;null!=t&&r<n;)t=t[zt(e[r++])];return r&&r==n?t:void 0}function xt(t,e){return null!=t&&e in Object(t)}function It(t,e,r,n,o){return t===e||(null==t||null==e||!re(t)&&!ne(e)?t!=t&&e!=e:function(t,e,r,n,o,i){var u=Qt(t),c=Qt(e),v=f,y=f;u||(v=(v=Gt(t))==l?b:v);c||(y=(y=Gt(e))==l?b:y);var S=v==b&&!V(t),A=y==b&&!V(e),T=v==y;if(T&&!S)return i||(i=new St),u||ie(t)?Mt(t,e,r,n,o,i):function(t,e,r,n,o,i,u){switch(r){case k:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case C:return!(t.byteLength!=e.byteLength||!n(new ot(t),new ot(e)));case h:case p:case m:return Yt(+t,+e);case d:return t.name==e.name&&t.message==e.message;case _:case w:return t==e+"";case g:var c=W;case E:var l=i&s;if(c||(c=z),t.size!=e.size&&!l)return!1;var f=u.get(t);if(f)return f==e;i|=a,u.set(t,e);var v=Mt(c(t),c(e),n,o,i,u);return u.delete(t),v;case O:if(_t)return _t.call(t)==_t.call(e)}return!1}(t,e,v,r,n,o,i);if(!(o&s)){var R=S&&tt.call(t,"__wrapped__"),j=A&&tt.call(e,"__wrapped__");if(R||j){var N=R?t.value():t,x=j?e.value():e;return i||(i=new St),r(N,x,n,o,i)}}if(!T)return!1;return i||(i=new St),function(t,e,r,n,o,i){var a=o&s,u=ae(t),c=u.length,l=ae(e).length;if(c!=l&&!a)return!1;for(var f=c;f--;){var h=u[f];if(!(a?h in e:tt.call(e,h)))return!1}var p=i.get(t);if(p&&i.get(e))return p==e;var d=!0;i.set(t,e),i.set(e,t);for(var v=a;++f<c;){h=u[f];var y=t[h],g=e[h];if(n)var m=a?n(g,y,h,e,t,i):n(y,g,h,t,e,i);if(!(void 0===m?y===g||r(y,g,n,o,i):m)){d=!1;break}v||(v="constructor"==h)}if(d&&!v){var b=t.constructor,_=e.constructor;b!=_&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof _&&_ instanceof _)&&(d=!1)}return i.delete(t),i.delete(e),d}(t,e,r,n,o,i)}(t,e,It,r,n,o))}function Pt(t){return!(!re(t)||function(t){return!!Q&&Q in t}(t))&&(te(t)||V(t)?rt:N).test(Jt(t))}function Dt(t){return"function"==typeof t?t:null==t?se:"object"==typeof t?Qt(t)?function(t,e){if(Bt(t)&&qt(e))return Vt(zt(t),e);return function(r){var n=function(t,e,r){var n=null==t?void 0:Nt(t,e);return void 0===n?r:n}(r,t);return void 0===n&&n===e?function(t,e){return null!=t&&function(t,e,r){var n,o=-1,i=(e=Bt(e,t)?[e]:Lt(e)).length;for(;++o<i;){var a=zt(e[o]);if(!(n=null!=t&&r(t,a)))break;t=t[a]}if(n)return n;return!!(i=t?t.length:0)&&ee(i)&&$t(a,i)&&(Qt(t)||Xt(t))}(t,e,xt)}(r,t):It(e,n,void 0,a|s)}}(t[0],t[1]):function(t){var e=function(t){var e=ae(t),r=e.length;for(;r--;){var n=e[r],o=t[n];e[r]=[n,o,qt(o)]}return e}(t);if(1==e.length&&e[0][2])return Vt(e[0][0],e[0][1]);return function(r){return r===t||function(t,e,r,n){var o=r.length,i=o,u=!n;if(null==t)return!i;for(t=Object(t);o--;){var c=r[o];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++o<i;){var l=(c=r[o])[0],f=t[l],h=c[1];if(u&&c[2]){if(void 0===f&&!(l in t))return!1}else{var p=new St;if(n)var d=n(f,h,l,t,e,p);if(!(void 0===d?It(h,f,n,a|s,p):d))return!1}}return!0}(r,t,e)}}(t):function(t){return Bt(t)?function(t){return function(e){return null==e?void 0:e[t]}}(zt(t)):function(t){return function(e){return Nt(e,t)}}(t)}(t)}function Ft(t){if(!function(t){var e=t&&t.constructor,r="function"==typeof e&&e.prototype||Y;return t===r}(t))return st(t);var e=[];for(var r in Object(t))tt.call(t,r)&&"constructor"!=r&&e.push(r);return e}function Lt(t){return Qt(t)?t:Wt(t)}function Mt(t,e,r,n,o,i){var u=o&s,c=t.length,l=e.length;if(c!=l&&!(u&&l>c))return!1;var f=i.get(t);if(f&&i.get(e))return f==e;var h=-1,p=!0,d=o&a?new kt:void 0;for(i.set(t,e),i.set(e,t);++h<c;){var v=t[h],y=e[h];if(n)var g=u?n(y,v,h,e,t,i):n(v,y,h,t,e,i);if(void 0!==g){if(g)continue;p=!1;break}if(d){if(!B(e,function(t,e){if(!d.has(e)&&(v===t||r(v,t,n,o,i)))return d.add(e)})){p=!1;break}}else if(v!==y&&!r(v,y,n,o,i)){p=!1;break}}return i.delete(t),i.delete(e),p}function Ut(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map}function Ht(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Pt(r)?r:void 0}var Gt=function(t){return et.call(t)};function $t(t,e){return!!(e=null==e?c:e)&&("number"==typeof t||x.test(t))&&t>-1&&t%1==0&&t<e}function Bt(t,e){if(Qt(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!oe(t))||(A.test(t)||!S.test(t)||null!=e&&t in Object(e))}function qt(t){return t==t&&!re(t)}function Vt(t,e){return function(r){return null!=r&&(r[t]===e&&(void 0!==e||t in Object(r)))}}(ut&&Gt(new ut(new ArrayBuffer(1)))!=k||ct&&Gt(new ct)!=g||lt&&"[object Promise]"!=Gt(lt.resolve())||ft&&Gt(new ft)!=E||ht&&"[object WeakMap]"!=Gt(new ht))&&(Gt=function(t){var e=et.call(t),r=e==b?t.constructor:void 0,n=r?Jt(r):void 0;if(n)switch(n){case dt:return k;case vt:return g;case yt:return"[object Promise]";case gt:return E;case mt:return"[object WeakMap]"}return e});var Wt=Kt(function(t){t=function(t){return null==t?"":function(t){if("string"==typeof t)return t;if(oe(t))return Et?Et.call(t):"";var e=t+"";return"0"==e&&1/t==-u?"-0":e}(t)}(t);var e=[];return T.test(t)&&e.push(""),t.replace(R,function(t,r,n,o){e.push(n?o.replace(j,"$1"):r||t)}),e});function zt(t){if("string"==typeof t||oe(t))return t;var e=t+"";return"0"==e&&1/t==-u?"-0":e}function Jt(t){if(null!=t){try{return Z.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Kt(t,e){if("function"!=typeof t||e&&"function"!=typeof e)throw new TypeError(o);var r=function(){var n=arguments,o=e?e.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=t.apply(this,n);return r.cache=i.set(o,a),a};return r.cache=new(Kt.Cache||Ct),r}function Yt(t,e){return t===e||t!=t&&e!=e}function Xt(t){return function(t){return ne(t)&&Zt(t)}(t)&&tt.call(t,"callee")&&(!it.call(t,"callee")||et.call(t)==l)}Kt.Cache=Ct;var Qt=Array.isArray;function Zt(t){return null!=t&&ee(t.length)&&!te(t)}function te(t){var e=re(t)?et.call(t):"";return e==v||e==y}function ee(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=c}function re(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function ne(t){return!!t&&"object"==typeof t}function oe(t){return"symbol"==typeof t||ne(t)&&et.call(t)==O}var ie=G?function(t){return function(e){return t(e)}}(G):function(t){return ne(t)&&ee(t.length)&&!!I[et.call(t)]};function ae(t){return Zt(t)?At(t):Ft(t)}function se(t){return t}r.exports=function(t,e,r){var n=Qt(t)?$:q,o=arguments.length<3;return n(t,Dt(e),r,o,Rt)}}).call(this,r(4),r(19)(t))},function(t,e,r){(function(t,r){var n=200,o="__lodash_hash_undefined__",i=9007199254740991,a="[object Arguments]",s="[object Boolean]",u="[object Date]",c="[object Function]",l="[object GeneratorFunction]",f="[object Map]",h="[object Number]",p="[object Object]",d="[object RegExp]",v="[object Set]",y="[object String]",g="[object Symbol]",m="[object ArrayBuffer]",b="[object DataView]",_="[object Float32Array]",E="[object Float64Array]",w="[object Int8Array]",O="[object Int16Array]",C="[object Int32Array]",k="[object Uint8Array]",S="[object Uint8ClampedArray]",A="[object Uint16Array]",T="[object Uint32Array]",R=/\w*$/,j=/^\[object .+?Constructor\]$/,N=/^(?:0|[1-9]\d*)$/,x={};x[a]=x["[object Array]"]=x[m]=x[b]=x[s]=x[u]=x[_]=x[E]=x[w]=x[O]=x[C]=x[f]=x[h]=x[p]=x[d]=x[v]=x[y]=x[g]=x[k]=x[S]=x[A]=x[T]=!0,x["[object Error]"]=x[c]=x["[object WeakMap]"]=!1;var I="object"==typeof t&&t&&t.Object===Object&&t,P="object"==typeof self&&self&&self.Object===Object&&self,D=I||P||Function("return this")(),F="object"==typeof e&&e&&!e.nodeType&&e,L=F&&"object"==typeof r&&r&&!r.nodeType&&r,M=L&&L.exports===F;function U(t,e){return t.set(e[0],e[1]),t}function H(t,e){return t.add(e),t}function G(t,e,r,n){var o=-1,i=t?t.length:0;for(n&&i&&(r=t[++o]);++o<i;)r=e(r,t[o],o,t);return r}function $(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}function B(t){var e=-1,r=Array(t.size);return t.forEach(function(t,n){r[++e]=[n,t]}),r}function q(t,e){return function(r){return t(e(r))}}function V(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var W=Array.prototype,z=Function.prototype,J=Object.prototype,K=D["__core-js_shared__"],Y=function(){var t=/[^.]+$/.exec(K&&K.keys&&K.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),X=z.toString,Q=J.hasOwnProperty,Z=J.toString,tt=RegExp("^"+X.call(Q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),et=M?D.Buffer:void 0,rt=D.Symbol,nt=D.Uint8Array,ot=q(Object.getPrototypeOf,Object),it=Object.create,at=J.propertyIsEnumerable,st=W.splice,ut=Object.getOwnPropertySymbols,ct=et?et.isBuffer:void 0,lt=q(Object.keys,Object),ft=Ft(D,"DataView"),ht=Ft(D,"Map"),pt=Ft(D,"Promise"),dt=Ft(D,"Set"),vt=Ft(D,"WeakMap"),yt=Ft(Object,"create"),gt=Gt(ft),mt=Gt(ht),bt=Gt(pt),_t=Gt(dt),Et=Gt(vt),wt=rt?rt.prototype:void 0,Ot=wt?wt.valueOf:void 0;function Ct(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function kt(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function St(t){var e=-1,r=t?t.length:0;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function At(t){this.__data__=new kt(t)}function Tt(t,e){var r=Bt(t)||function(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&qt(t)}(t)&&Q.call(t,"callee")&&(!at.call(t,"callee")||Z.call(t)==a)}(t)?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],n=r.length,o=!!n;for(var i in t)!e&&!Q.call(t,i)||o&&("length"==i||Ut(i,n))||r.push(i);return r}function Rt(t,e,r){var n=t[e];Q.call(t,e)&&$t(n,r)&&(void 0!==r||e in t)||(t[e]=r)}function jt(t,e){for(var r=t.length;r--;)if($t(t[r][0],e))return r;return-1}function Nt(t,e,r,n,o,i,j){var N;if(n&&(N=i?n(t,o,i,j):n(t)),void 0!==N)return N;if(!zt(t))return t;var I=Bt(t);if(I){if(N=function(t){var e=t.length,r=t.constructor(e);e&&"string"==typeof t[0]&&Q.call(t,"index")&&(r.index=t.index,r.input=t.input);return r}(t),!e)return function(t,e){var r=-1,n=t.length;e||(e=Array(n));for(;++r<n;)e[r]=t[r];return e}(t,N)}else{var P=Mt(t),D=P==c||P==l;if(Vt(t))return function(t,e){if(e)return t.slice();var r=new t.constructor(t.length);return t.copy(r),r}(t,e);if(P==p||P==a||D&&!i){if($(t))return i?t:{};if(N=function(t){return"function"!=typeof t.constructor||Ht(t)?{}:function(t){return zt(t)?it(t):{}}(ot(t))}(D?{}:t),!e)return function(t,e){return Pt(t,Lt(t),e)}(t,function(t,e){return t&&Pt(e,Jt(e),t)}(N,t))}else{if(!x[P])return i?t:{};N=function(t,e,r,n){var o=t.constructor;switch(e){case m:return It(t);case s:case u:return new o(+t);case b:return function(t,e){var r=e?It(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.byteLength)}(t,n);case _:case E:case w:case O:case C:case k:case S:case A:case T:return function(t,e){var r=e?It(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}(t,n);case f:return function(t,e,r){return G(e?r(B(t),!0):B(t),U,new t.constructor)}(t,n,r);case h:case y:return new o(t);case d:return function(t){var e=new t.constructor(t.source,R.exec(t));return e.lastIndex=t.lastIndex,e}(t);case v:return function(t,e,r){return G(e?r(V(t),!0):V(t),H,new t.constructor)}(t,n,r);case g:return function(t){return Ot?Object(Ot.call(t)):{}}(t)}}(t,P,Nt,e)}}j||(j=new At);var F=j.get(t);if(F)return F;if(j.set(t,N),!I)var L=r?function(t){return function(t,e,r){var n=e(t);return Bt(t)?n:function(t,e){for(var r=-1,n=e.length,o=t.length;++r<n;)t[o+r]=e[r];return t}(n,r(t))}(t,Jt,Lt)}(t):Jt(t);return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(L||t,function(o,i){L&&(o=t[i=o]),Rt(N,i,Nt(o,e,r,n,i,t,j))}),N}function xt(t){return!(!zt(t)||function(t){return!!Y&&Y in t}(t))&&(Wt(t)||$(t)?tt:j).test(Gt(t))}function It(t){var e=new t.constructor(t.byteLength);return new nt(e).set(new nt(t)),e}function Pt(t,e,r,n){r||(r={});for(var o=-1,i=e.length;++o<i;){var a=e[o],s=n?n(r[a],t[a],a,r,t):void 0;Rt(r,a,void 0===s?t[a]:s)}return r}function Dt(t,e){var r=t.__data__;return function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}(e)?r["string"==typeof e?"string":"hash"]:r.map}function Ft(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return xt(r)?r:void 0}Ct.prototype.clear=function(){this.__data__=yt?yt(null):{}},Ct.prototype.delete=function(t){return this.has(t)&&delete this.__data__[t]},Ct.prototype.get=function(t){var e=this.__data__;if(yt){var r=e[t];return r===o?void 0:r}return Q.call(e,t)?e[t]:void 0},Ct.prototype.has=function(t){var e=this.__data__;return yt?void 0!==e[t]:Q.call(e,t)},Ct.prototype.set=function(t,e){return this.__data__[t]=yt&&void 0===e?o:e,this},kt.prototype.clear=function(){this.__data__=[]},kt.prototype.delete=function(t){var e=this.__data__,r=jt(e,t);return!(r<0||(r==e.length-1?e.pop():st.call(e,r,1),0))},kt.prototype.get=function(t){var e=this.__data__,r=jt(e,t);return r<0?void 0:e[r][1]},kt.prototype.has=function(t){return jt(this.__data__,t)>-1},kt.prototype.set=function(t,e){var r=this.__data__,n=jt(r,t);return n<0?r.push([t,e]):r[n][1]=e,this},St.prototype.clear=function(){this.__data__={hash:new Ct,map:new(ht||kt),string:new Ct}},St.prototype.delete=function(t){return Dt(this,t).delete(t)},St.prototype.get=function(t){return Dt(this,t).get(t)},St.prototype.has=function(t){return Dt(this,t).has(t)},St.prototype.set=function(t,e){return Dt(this,t).set(t,e),this},At.prototype.clear=function(){this.__data__=new kt},At.prototype.delete=function(t){return this.__data__.delete(t)},At.prototype.get=function(t){return this.__data__.get(t)},At.prototype.has=function(t){return this.__data__.has(t)},At.prototype.set=function(t,e){var r=this.__data__;if(r instanceof kt){var o=r.__data__;if(!ht||o.length<n-1)return o.push([t,e]),this;r=this.__data__=new St(o)}return r.set(t,e),this};var Lt=ut?q(ut,Object):function(){return[]},Mt=function(t){return Z.call(t)};function Ut(t,e){return!!(e=null==e?i:e)&&("number"==typeof t||N.test(t))&&t>-1&&t%1==0&&t<e}function Ht(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||J)}function Gt(t){if(null!=t){try{return X.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function $t(t,e){return t===e||t!=t&&e!=e}(ft&&Mt(new ft(new ArrayBuffer(1)))!=b||ht&&Mt(new ht)!=f||pt&&"[object Promise]"!=Mt(pt.resolve())||dt&&Mt(new dt)!=v||vt&&"[object WeakMap]"!=Mt(new vt))&&(Mt=function(t){var e=Z.call(t),r=e==p?t.constructor:void 0,n=r?Gt(r):void 0;if(n)switch(n){case gt:return b;case mt:return f;case bt:return"[object Promise]";case _t:return v;case Et:return"[object WeakMap]"}return e});var Bt=Array.isArray;function qt(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}(t.length)&&!Wt(t)}var Vt=ct||function(){return!1};function Wt(t){var e=zt(t)?Z.call(t):"";return e==c||e==l}function zt(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function Jt(t){return qt(t)?Tt(t):function(t){if(!Ht(t))return lt(t);var e=[];for(var r in Object(t))Q.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}r.exports=function(t){return Nt(t,!0,!0)}}).call(this,r(4),r(19)(t))},function(t,e){var r=-1,n=1,o=0;function i(t,e,c,l){if(t===e)return t?[[o,t]]:[];if(null!=c){var d=function(t,e,r){var n="number"==typeof r?{index:r,length:0}:r.oldRange,o="number"==typeof r?null:r.newRange,i=t.length,a=e.length;if(0===n.length&&(null===o||0===o.length)){var s=n.index,u=t.slice(0,s),c=t.slice(s),l=o?o.index:null,f=s+a-i;if((null===l||l===f)&&!(f<0||f>a)){var h=e.slice(0,f),d=e.slice(f);if(d===c){var v=Math.min(s,f),y=u.slice(0,v),g=h.slice(0,v);if(y===g){var m=u.slice(v),b=h.slice(v);return p(y,m,b,c)}}}if(null===l||l===s){var _=s,h=e.slice(0,_),d=e.slice(_);if(h===u){var E=Math.min(i-_,a-_),w=c.slice(c.length-E),O=d.slice(d.length-E);if(w===O){var m=c.slice(0,c.length-E),b=d.slice(0,d.length-E);return p(u,m,b,w)}}}}if(n.length>0&&o&&0===o.length){var y=t.slice(0,n.index),w=t.slice(n.index+n.length),v=y.length,E=w.length;if(!(a<v+E)){var g=e.slice(0,v),O=e.slice(a-E);if(y===g&&w===O){var m=t.slice(v,i-E),b=e.slice(v,a-E);return p(y,m,b,w)}}}return null}(t,e,c);if(d)return d}var v=s(t,e),y=t.substring(0,v);v=u(t=t.substring(v),e=e.substring(v));var g=t.substring(t.length-v),m=function(t,e){var c;if(!t)return[[n,e]];if(!e)return[[r,t]];var l=t.length>e.length?t:e,f=t.length>e.length?e:t,h=l.indexOf(f);if(-1!==h)return c=[[n,l.substring(0,h)],[o,f],[n,l.substring(h+f.length)]],t.length>e.length&&(c[0][0]=c[2][0]=r),c;if(1===f.length)return[[r,t],[n,e]];var p=function(t,e){var r=t.length>e.length?t:e,n=t.length>e.length?e:t;if(r.length<4||2*n.length<r.length)return null;function o(t,e,r){for(var n,o,i,a,c=t.substring(r,r+Math.floor(t.length/4)),l=-1,f="";-1!==(l=e.indexOf(c,l+1));){var h=s(t.substring(r),e.substring(l)),p=u(t.substring(0,r),e.substring(0,l));f.length<p+h&&(f=e.substring(l-p,l)+e.substring(l,l+h),n=t.substring(0,r-p),o=t.substring(r+h),i=e.substring(0,l-p),a=e.substring(l+h))}return 2*f.length>=t.length?[n,o,i,a,f]:null}var i,a,c,l,f,h=o(r,n,Math.ceil(r.length/4)),p=o(r,n,Math.ceil(r.length/2));if(!h&&!p)return null;i=p?h&&h[4].length>p[4].length?h:p:h;t.length>e.length?(a=i[0],c=i[1],l=i[2],f=i[3]):(l=i[0],f=i[1],a=i[2],c=i[3]);var d=i[4];return[a,c,l,f,d]}(t,e);if(p){var d=p[0],v=p[1],y=p[2],g=p[3],m=p[4],b=i(d,y),_=i(v,g);return b.concat([[o,m]],_)}return function(t,e){for(var o=t.length,i=e.length,s=Math.ceil((o+i)/2),u=s,c=2*s,l=new Array(c),f=new Array(c),h=0;h<c;h++)l[h]=-1,f[h]=-1;l[u+1]=0,f[u+1]=0;for(var p=o-i,d=p%2!=0,v=0,y=0,g=0,m=0,b=0;b<s;b++){for(var _=-b+v;_<=b-y;_+=2){for(var E=u+_,w=(A=_===-b||_!==b&&l[E-1]<l[E+1]?l[E+1]:l[E-1]+1)-_;A<o&&w<i&&t.charAt(A)===e.charAt(w);)A++,w++;if(l[E]=A,A>o)y+=2;else if(w>i)v+=2;else if(d){var O=u+p-_;if(O>=0&&O<c&&-1!==f[O]){var C=o-f[O];if(A>=C)return a(t,e,A,w)}}}for(var k=-b+g;k<=b-m;k+=2){for(var O=u+k,S=(C=k===-b||k!==b&&f[O-1]<f[O+1]?f[O+1]:f[O-1]+1)-k;C<o&&S<i&&t.charAt(o-C-1)===e.charAt(i-S-1);)C++,S++;if(f[O]=C,C>o)m+=2;else if(S>i)g+=2;else if(!d){var E=u+p-k;if(E>=0&&E<c&&-1!==l[E]){var A=l[E],w=u+A-E;if(A>=(C=o-C))return a(t,e,A,w)}}}}return[[r,t],[n,e]]}(t,e)}(t=t.substring(0,t.length-v),e=e.substring(0,e.length-v));return y&&m.unshift([o,y]),g&&m.push([o,g]),function t(e,i){e.push([o,""]);var a=0;var c=0;var l=0;var p="";var d="";var v;for(;a<e.length;)if(a<e.length-1&&!e[a][1])e.splice(a,1);else switch(e[a][0]){case n:l++,d+=e[a][1],a++;break;case r:c++,p+=e[a][1],a++;break;case o:var y=a-l-c-1;if(i){if(y>=0&&h(e[y][1])){var g=e[y][1].slice(-1);if(e[y][1]=e[y][1].slice(0,-1),p=g+p,d=g+d,!e[y][1]){e.splice(y,1),a--;var m=y-1;e[m]&&e[m][0]===n&&(l++,d=e[m][1]+d,m--),e[m]&&e[m][0]===r&&(c++,p=e[m][1]+p,m--),y=m}}if(f(e[a][1])){var g=e[a][1].charAt(0);e[a][1]=e[a][1].slice(1),p+=g,d+=g}}if(a<e.length-1&&!e[a][1]){e.splice(a,1);break}if(p.length>0||d.length>0){p.length>0&&d.length>0&&(0!==(v=s(d,p))&&(y>=0?e[y][1]+=d.substring(0,v):(e.splice(0,0,[o,d.substring(0,v)]),a++),d=d.substring(v),p=p.substring(v)),0!==(v=u(d,p))&&(e[a][1]=d.substring(d.length-v)+e[a][1],d=d.substring(0,d.length-v),p=p.substring(0,p.length-v)));var b=l+c;0===p.length&&0===d.length?(e.splice(a-b,b),a-=b):0===p.length?(e.splice(a-b,b,[n,d]),a=a-b+1):0===d.length?(e.splice(a-b,b,[r,p]),a=a-b+1):(e.splice(a-b,b,[r,p],[n,d]),a=a-b+2)}0!==a&&e[a-1][0]===o?(e[a-1][1]+=e[a][1],e.splice(a,1)):a++,l=0,c=0,p="",d=""}""===e[e.length-1][1]&&e.pop();var _=!1;a=1;for(;a<e.length-1;)e[a-1][0]===o&&e[a+1][0]===o&&(e[a][1].substring(e[a][1].length-e[a-1][1].length)===e[a-1][1]?(e[a][1]=e[a-1][1]+e[a][1].substring(0,e[a][1].length-e[a-1][1].length),e[a+1][1]=e[a-1][1]+e[a+1][1],e.splice(a-1,1),_=!0):e[a][1].substring(0,e[a+1][1].length)==e[a+1][1]&&(e[a-1][1]+=e[a+1][1],e[a][1]=e[a][1].substring(e[a+1][1].length)+e[a+1][1],e.splice(a+1,1),_=!0)),a++;_&&t(e,i)}(m,l),m}function a(t,e,r,n){var o=t.substring(0,r),a=e.substring(0,n),s=t.substring(r),u=e.substring(n),c=i(o,a),l=i(s,u);return c.concat(l)}function s(t,e){if(!t||!e||t.charAt(0)!==e.charAt(0))return 0;for(var r=0,n=Math.min(t.length,e.length),o=n,i=0;r<o;)t.substring(i,o)==e.substring(i,o)?i=r=o:n=o,o=Math.floor((n-r)/2+r);return c(t.charCodeAt(o-1))&&o--,o}function u(t,e){if(!t||!e||t.slice(-1)!==e.slice(-1))return 0;for(var r=0,n=Math.min(t.length,e.length),o=n,i=0;r<o;)t.substring(t.length-o,t.length-i)==e.substring(e.length-o,e.length-i)?i=r=o:n=o,o=Math.floor((n-r)/2+r);return l(t.charCodeAt(t.length-o))&&o--,o}function c(t){return t>=55296&&t<=56319}function l(t){return t>=56320&&t<=57343}function f(t){return l(t.charCodeAt(0))}function h(t){return c(t.charCodeAt(t.length-1))}function p(t,e,i,a){return h(t)||f(a)?null:function(t){for(var e=[],r=0;r<t.length;r++)t[r][1].length>0&&e.push(t[r]);return e}([[o,t],[r,e],[n,i],[o,a]])}function d(t,e,r){return i(t,e,r,!0)}d.INSERT=n,d.DELETE=r,d.EQUAL=o,t.exports=d},function(t,e,r){var n=Array.prototype.slice,o=r(95),i=r(96),a=t.exports=function(t,e,r){return r||(r={}),t===e||(t instanceof Date&&e instanceof Date?t.getTime()===e.getTime():!t||!e||"object"!=typeof t&&"object"!=typeof e?r.strict?t===e:t==e:function(t,e,r){var c,l;if(s(t)||s(e))return!1;if(t.prototype!==e.prototype)return!1;if(i(t))return!!i(e)&&(t=n.call(t),e=n.call(e),a(t,e,r));if(u(t)){if(!u(e))return!1;if(t.length!==e.length)return!1;for(c=0;c<t.length;c++)if(t[c]!==e[c])return!1;return!0}try{var f=o(t),h=o(e)}catch(t){return!1}if(f.length!=h.length)return!1;for(f.sort(),h.sort(),c=f.length-1;c>=0;c--)if(f[c]!=h[c])return!1;for(c=f.length-1;c>=0;c--)if(l=f[c],!a(t[l],e[l],r))return!1;return typeof t==typeof e}(t,e,r))};function s(t){return null===t||void 0===t}function u(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length)&&("function"==typeof t.copy&&"function"==typeof t.slice&&!(t.length>0&&"number"!=typeof t[0]))}},function(t,e){function r(t){var e=[];for(var r in t)e.push(r);return e}(t.exports="function"==typeof Object.keys?Object.keys:r).shim=r},function(t,e){var r="[object Arguments]"==function(){return Object.prototype.toString.call(arguments)}();function n(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function o(t){return t&&"object"==typeof t&&"number"==typeof t.length&&Object.prototype.hasOwnProperty.call(t,"callee")&&!Object.prototype.propertyIsEnumerable.call(t,"callee")||!1}(e=t.exports=r?n:o).supported=n,e.unsupported=o},function(t,e,r){(function(e){var r="Expected a function",n="__lodash_placeholder__",o=1,i=2,a=4,s=8,u=16,c=32,l=64,f=128,h=512,p=1/0,d=9007199254740991,v=1.7976931348623157e308,y=NaN,g=[["ary",f],["bind",o],["bindKey",i],["curry",s],["curryRight",u],["flip",h],["partial",c],["partialRight",l],["rearg",256]],m="[object Function]",b="[object GeneratorFunction]",_="[object Symbol]",E=/^\s+|\s+$/g,w=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,O=/\{\n\/\* \[wrapped with (.+)\] \*/,C=/,? & /,k=/^[-+]0x[0-9a-f]+$/i,S=/^0b[01]+$/i,A=/^\[object .+?Constructor\]$/,T=/^0o[0-7]+$/i,R=/^(?:0|[1-9]\d*)$/,j=parseInt,N="object"==typeof e&&e&&e.Object===Object&&e,x="object"==typeof self&&self&&self.Object===Object&&self,I=N||x||Function("return this")();function P(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function D(t,e){return!!(t?t.length:0)&&function(t,e,r){if(e!=e)return function(t,e,r,n){var o=t.length,i=r+(n?1:-1);for(;n?i--:++i<o;)if(e(t[i],i,t))return i;return-1}(t,F,r);var n=r-1,o=t.length;for(;++n<o;)if(t[n]===e)return n;return-1}(t,e,0)>-1}function F(t){return t!=t}function L(t,e){for(var r=-1,o=t.length,i=0,a=[];++r<o;){var s=t[r];s!==e&&s!==n||(t[r]=n,a[i++]=r)}return a}var M=Function.prototype,U=Object.prototype,H=I["__core-js_shared__"],G=function(){var t=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),$=M.toString,B=U.hasOwnProperty,q=U.toString,V=RegExp("^"+$.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),W=Object.create,z=Math.max,J=Math.min,K=function(){var t=rt(Object,"defineProperty"),e=rt.name;return e&&e.length>2?t:void 0}();function Y(t){return!(!at(t)||function(t){return!!G&&G in t}(t))&&(function(t){var e=at(t)?q.call(t):"";return e==m||e==b}(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?V:A).test(function(t){if(null!=t){try{return $.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}function X(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var r=function(t){return at(t)?W(t):{}}(t.prototype),n=t.apply(r,e);return at(n)?n:r}}function Q(t,e,r,n,a,c,l,p,d,v){var y=e&f,g=e&o,m=e&i,b=e&(s|u),_=e&h,E=m?void 0:X(t);return function o(){for(var i=arguments.length,s=Array(i),u=i;u--;)s[u]=arguments[u];if(b)var f=et(o),h=function(t,e){for(var r=t.length,n=0;r--;)t[r]===e&&n++;return n}(s,f);if(n&&(s=function(t,e,r,n){for(var o=-1,i=t.length,a=r.length,s=-1,u=e.length,c=z(i-a,0),l=Array(u+c),f=!n;++s<u;)l[s]=e[s];for(;++o<a;)(f||o<i)&&(l[r[o]]=t[o]);for(;c--;)l[s++]=t[o++];return l}(s,n,a,b)),c&&(s=function(t,e,r,n){for(var o=-1,i=t.length,a=-1,s=r.length,u=-1,c=e.length,l=z(i-s,0),f=Array(l+c),h=!n;++o<l;)f[o]=t[o];for(var p=o;++u<c;)f[p+u]=e[u];for(;++a<s;)(h||o<i)&&(f[p+r[a]]=t[o++]);return f}(s,c,l,b)),i-=h,b&&i<v){var w=L(s,f);return Z(t,e,Q,o.placeholder,r,s,w,p,d,v-i)}var O=g?r:this,C=m?O[t]:t;return i=s.length,p?s=function(t,e){for(var r=t.length,n=J(e.length,r),o=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(t);n--;){var i=e[n];t[n]=nt(i,r)?o[i]:void 0}return t}(s,p):_&&i>1&&s.reverse(),y&&d<i&&(s.length=d),this&&this!==I&&this instanceof o&&(C=E||X(C)),C.apply(O,s)}}function Z(t,e,r,n,u,f,h,p,d,v){var y=e&s;e|=y?c:l,(e&=~(y?l:c))&a||(e&=~(o|i));var g=r(t,e,u,y?f:void 0,y?h:void 0,y?void 0:f,y?void 0:h,p,d,v);return g.placeholder=n,ot(g,t,e)}function tt(t,e,n,a,f,h,p,d){var v=e&i;if(!v&&"function"!=typeof t)throw new TypeError(r);var y=a?a.length:0;if(y||(e&=~(c|l),a=f=void 0),p=void 0===p?p:z(ut(p),0),d=void 0===d?d:ut(d),y-=f?f.length:0,e&l){var g=a,m=f;a=f=void 0}var b=[t,e,n,a,f,g,m,h,p,d];if(t=b[0],e=b[1],n=b[2],a=b[3],f=b[4],!(d=b[9]=null==b[9]?v?0:t.length:z(b[9]-y,0))&&e&(s|u)&&(e&=~(s|u)),e&&e!=o)_=e==s||e==u?function(t,e,r){var n=X(t);return function o(){for(var i=arguments.length,a=Array(i),s=i,u=et(o);s--;)a[s]=arguments[s];var c=i<3&&a[0]!==u&&a[i-1]!==u?[]:L(a,u);return(i-=c.length)<r?Z(t,e,Q,o.placeholder,void 0,a,c,void 0,void 0,r-i):P(this&&this!==I&&this instanceof o?n:t,this,a)}}(t,e,d):e!=c&&e!=(o|c)||f.length?Q.apply(void 0,b):function(t,e,r,n){var i=e&o,a=X(t);return function e(){for(var o=-1,s=arguments.length,u=-1,c=n.length,l=Array(c+s),f=this&&this!==I&&this instanceof e?a:t;++u<c;)l[u]=n[u];for(;s--;)l[u++]=arguments[++o];return P(f,i?r:this,l)}}(t,e,n,a);else var _=function(t,e,r){var n=e&o,i=X(t);return function e(){return(this&&this!==I&&this instanceof e?i:t).apply(n?r:this,arguments)}}(t,e,n);return ot(_,t,e)}function et(t){return t.placeholder}function rt(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return Y(r)?r:void 0}function nt(t,e){return!!(e=null==e?d:e)&&("number"==typeof t||R.test(t))&&t>-1&&t%1==0&&t<e}var ot=K?function(t,e,r){var n=e+"";return K(t,"toString",{configurable:!0,enumerable:!1,value:function(t){return function(){return t}}(function(t,e){var r=e.length,n=r-1;return e[n]=(r>1?"& ":"")+e[n],e=e.join(r>2?", ":" "),t.replace(w,"{\n/* [wrapped with "+e+"] */\n")}(n,function(t,e){return function(t,e){for(var r=-1,n=t?t.length:0;++r<n&&!1!==e(t[r],r,t););}(g,function(r){var n="_."+r[0];e&r[1]&&!D(t,n)&&t.push(n)}),t.sort()}(function(t){var e=t.match(O);return e?e[1].split(C):[]}(n),r)))})}:function(t){return t};var it=function(t,e){return e=z(void 0===e?t.length-1:e,0),function(){for(var r=arguments,n=-1,o=z(r.length-e,0),i=Array(o);++n<o;)i[n]=r[e+n];n=-1;for(var a=Array(e+1);++n<e;)a[n]=r[n];return a[e]=i,P(t,this,a)}}(function(t,e,r){var n=o;if(r.length){var i=L(r,et(it));n|=c}return tt(t,n,e,r,i)});function at(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function st(t){return t?(t=function(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&q.call(t)==_}(t))return y;if(at(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=at(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(E,"");var r=S.test(t);return r||T.test(t)?j(t.slice(2),r?2:8):k.test(t)?y:+t}(t))===p||t===-p?(t<0?-1:1)*v:t==t?t:0:0===t?t:0}function ut(t){var e=st(t),r=e%1;return e==e?r?e-r:e:0}it.placeholder={},t.exports=it}).call(this,r(4))},function(t,e,r){"use strict";var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}(),i=function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0};function a(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var s=r(12),u=r(11),c=r(3),l=r(99),f=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),a(r=a(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,s),o(e,[{key:"freeze",value:function(){c.freeze(this.data),c.freeze(this.data.rows),c.freeze(this.data.cols)}},{key:"name",value:function(){return"TableOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return{table:this.data}}},{key:"skipDiff",value:function(){return!0}},{key:"_genericSet",value:function(t){var r=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_genericSet",this).call(this,t),n=r.changed,o=r.op;if("object"==typeof o.data){if(o.data.rows||(o.data.rows=new u),o.data.cols||(o.data.cols=new u),o.data.cells||(o.data.cells={}),"function"!=typeof o.data.cells.name&&(o.data.cells=new l({action:o.action,cells:o.data.cells})),"function"!=typeof o.data.rows.pack)throw new Error("rows should be a Delta");if("function"!=typeof o.data.cols.pack)throw new Error("cols should be a Delta");"retain"===o.action&&o.data.rows.isEmpty()&&o.data.cols.isEmpty()&&!Object.keys(o.data.cells).length&&(o.data=1)}if("insert"===o.action){if(!o.data.rows.isDocument())throw new Error("rows should be a document");if(!o.data.cols.isDocument())throw new Error("cols should be a document")}return{changed:n,op:o}}},{key:"pack",value:function(){var t=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"pack",this).call(this);if("object"==typeof t[1]){var r=t[1],n=r.cells,o=r.rows,a=r.cols;if(t[1]=[n.pack()],o.isEmpty()&&a.isEmpty())return t;a.isEmpty()?t[1].push(o.pack()):(t[1].push(o.isEmpty()?0:o.pack()),t[1].push(a.pack()))}return t}},{key:"compose",value:function(t){var r=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"compose",this).call(this,t);if("number"==typeof this.data||"number"==typeof t.data)return r;var n={rows:r.data.rows.compose(t.data.rows),cols:r.data.cols.compose(t.data.cols)},o=new l({cells:r.data.cells,action:r.action});return o.composeWithMutations(t.data),t.data.cells.forEach(function(e){var r=o.get(e),n=t.data.cells.get(e);o.set(e,r.compose(n))}),n.cells=o,r.set({data:n})}},{key:"invert",value:function(t){var r=this,n=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"invert",this).call(this,t);if("number"==typeof this.data||"number"==typeof t.data)return n;var o={rows:this.data.rows.invert(t.data.rows),cols:this.data.cols.invert(t.data.cols)},a=new l({cells:t.data.cells,action:n.action});a.composeWithMutations(o,function(e,n){try{return r.data.cells.get(n).invert(e)}catch(e){throw new Error(e.message+": "+t.getAttributes().id+", "+n)}});var s=t.data.rows.isEmpty(),u=t.data.cols.isEmpty();return s&&u||this.data.cells.forEach(function(e){var n=c.parsePosition(e),o=n.row,i=n.col;null!==t.data.rows.composePosition(o)&&null!==t.data.cols.composePosition(i)||a.set(e,r.data.cells.get(e))}),o.cells=a,n.set({data:o})}},{key:"transform",value:function(t,r){var n=this,o=i(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"transform",this).call(this,t,r);if("number"==typeof this.data||"number"==typeof t.data)return o;var a={rows:o.data.rows.transform(this.data.rows,!r),cols:o.data.cols.transform(this.data.cols,!r)},s={rows:this.data.rows.transform(t.data.rows,r),cols:this.data.cols.transform(t.data.cols,r)},u=new l({cells:t.data.cells,action:o.action});u.composeWithMutations(a);var f=t.data.rows.isEmpty(),h=t.data.cols.isEmpty();return this.data.cells.forEach(function(t){var e=c.parsePosition(t),o=e.row,i=e.col;if(f||(o=s.rows.composePosition(o)),h||(i=s.cols.composePosition(i)),null!==o&&null!==i){var a=c.stringifyPosition(o,i);u.set(a,n.data.cells.get(t).transform(u.get(a),r))}}),s.cells=u,o.set({data:s})}}],[{key:"unpack",value:function(t){if(Array.isArray(t[1])){var r=n(t[1],3),o=r[0],a=r[1],s=r[2];t[1]={rows:a?u.unpack(a):null,cols:s?u.unpack(s):null,cells:o}}return i(e.__proto__||Object.getPrototypeOf(e),"unpack",this).call(this,t)}}]),e}();f.packId=3,t.exports=f},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();var o=r(42),i=r(11),a=r(3),s=r(100),u=function(){function t(e){var r=e.cells,n=e.action;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cells={},"function"==typeof r.name)for(var o in this.proto=r.proto,r.cells)r.cells.hasOwnProperty(o)&&(this.cells[o]=r.cells[o]);else this.proto=r;this.action=n}return n(t,[{key:"name",value:function(){return"CellManager"}},{key:"keys",value:function(){var t=[];return this.forEach(function(e){t.push(e)}),t}},{key:"get",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=void 0;return(n=void 0===this.cells[t]?this.proto[t]:this.cells[t])?(e&&Array.isArray(n)&&(n=this.cells[t]=o.operatorUnpacker(n)),n.action&&n.action!==this.action&&(n=this.cells[t]=n.set({action:this.action}))):n=r?null:new o({action:this.action,data:"insert"===this.action?new i:1}),n&&1===n.constructor.packId&&(n=new o({action:n.action,attributes:n.attributes,data:n.data})),n}},{key:"forEach",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var r in this.cells)!this.cells.hasOwnProperty(r)||e&&null===this.cells[r]||t(r);for(var n in this.proto)this.proto.hasOwnProperty(n)&&!this.cells.hasOwnProperty(n)&&null!==this.proto[n]&&t(n)}},{key:"some",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];for(var r in this.cells)if(this.cells.hasOwnProperty(r)&&t(r))return!0;if(!e)for(var n in this.proto)if(this.proto.hasOwnProperty(n)&&!this.cells.hasOwnProperty(n)&&t(n))return!0;return!1}},{key:"set",value:function(t,e){this.cells[t]=e||null}},{key:"composeWithMutations",value:function(t,e){var r=this,n=t.rows,o=t.cols,i=n.isEmpty(),s=o.isEmpty();if(!i||!s||e){var u={},c={row:{},col:{}};this.forEach(function(t){var l=a.parsePosition(t),f=l.row,h=l.col;if(i||(void 0===c.row[f]&&(c.row[f]=n.composePosition(f)),f=c.row[f]),s||(void 0===c.col[h]&&(c.col[h]=o.composePosition(h)),h=c.col[h]),u[t]||(u[t]=null),null!==f&&null!==h){var p=a.stringifyPosition(f,h),d=r.get(t,!0,!e);u[p]=e?e(d,p):d}},!1),this.cells=u}}},{key:"pack",value:function(){var t=this,e={};return this.forEach(function(r){var n=t.get(r,!1);Array.isArray(n)?e[r]=n:(n.attributes||n.data.isEmpty&&!n.data.isEmpty())&&(e[r]=n.pack())}),s(e)?0:e}}]),t}();t.exports=u},function(t,e,r){(function(t,r){var n=9007199254740991,o="[object Arguments]",i="[object Function]",a="[object GeneratorFunction]",s="[object Map]",u="[object Set]",c=/^\[object .+?Constructor\]$/,l="object"==typeof t&&t&&t.Object===Object&&t,f="object"==typeof self&&self&&self.Object===Object&&self,h=l||f||Function("return this")(),p="object"==typeof e&&e&&!e.nodeType&&e,d=p&&"object"==typeof r&&r&&!r.nodeType&&r,v=d&&d.exports===p;var y=Function.prototype,g=Object.prototype,m=h["__core-js_shared__"],b=function(){var t=/[^.]+$/.exec(m&&m.keys&&m.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),_=y.toString,E=g.hasOwnProperty,w=g.toString,O=RegExp("^"+_.call(E).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),C=v?h.Buffer:void 0,k=g.propertyIsEnumerable,S=C?C.isBuffer:void 0,A=function(t,e){return function(r){return t(e(r))}}(Object.keys,Object),T=H(h,"DataView"),R=H(h,"Map"),j=H(h,"Promise"),N=H(h,"Set"),x=H(h,"WeakMap"),I=!k.call({valueOf:1},"valueOf"),P=$(T),D=$(R),F=$(j),L=$(N),M=$(x);function U(t){return!(!J(t)||function(t){return!!b&&b in t}(t))&&(z(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t)?O:c).test($(t))}function H(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return U(r)?r:void 0}var G=function(t){return w.call(t)};function $(t){if(null!=t){try{return _.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function B(t){return function(t){return function(t){return!!t&&"object"==typeof t}(t)&&V(t)}(t)&&E.call(t,"callee")&&(!k.call(t,"callee")||w.call(t)==o)}(T&&"[object DataView]"!=G(new T(new ArrayBuffer(1)))||R&&G(new R)!=s||j&&"[object Promise]"!=G(j.resolve())||N&&G(new N)!=u||x&&"[object WeakMap]"!=G(new x))&&(G=function(t){var e=w.call(t),r="[object Object]"==e?t.constructor:void 0,n=r?$(r):void 0;if(n)switch(n){case P:return"[object DataView]";case D:return s;case F:return"[object Promise]";case L:return u;case M:return"[object WeakMap]"}return e});var q=Array.isArray;function V(t){return null!=t&&function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}(t.length)&&!z(t)}var W=S||function(){return!1};function z(t){var e=J(t)?w.call(t):"";return e==i||e==a}function J(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}r.exports=function(t){if(V(t)&&(q(t)||"string"==typeof t||"function"==typeof t.splice||W(t)||B(t)))return!t.length;var e=G(t);if(e==s||e==u)return!t.size;if(I||function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||g)}(t))return!A(t).length;for(var r in t)if(E.call(t,r))return!1;return!0}}).call(this,r(4),r(19)(t))},function(t,e,r){"use strict";var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var i=r(12),a=function(t){function e(t){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o(r=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t)),r)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i),n(e,[{key:"name",value:function(){return"TextOperator"}},{key:"getEmbedObject",value:function(){if("object"!=typeof this.data)throw new Error("data is not an embed object");return this.data}},{key:"setData",value:function(t){switch(function t(e,r,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,r);if(void 0===o){var i=Object.getPrototypeOf(e);return null===i?void 0:t(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setData",this).call(this,t),this.action){case"insert":if("string"!=typeof this.data&&"object"!=typeof this.data)throw new Error('data should be a string or an object for "insert" action, got '+this.data);break;case"retain":if("number"!=typeof this.data)throw new Error('data should be a number for "'+this.action+'" action, got '+this.data)}return this}}]),e}();a.packId=2,t.exports=a},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var i=r(16),a=r(2),s=r(8),u=r(14),c=r(1),l=a("collab:collaborator"),f=function(t){function e(e){var r=t.call(this)||this;return r.users=[],r.clients={},r.modocUserSelectFeat=!1,r.clientId=e.clientId,e.modocUserSelectFeat&&(r.modocUserSelectFeat=e.modocUserSelectFeat),r.onUserSelect=e.modocUserSelectFeat?r._onUserSelect.bind(r):c.debounce(r._onUserSelect.bind(r),1e3,!1),r.puller=e.puller,r.editor=e.editor,r.tracker=e.tracker,r.clientUserSelect=new Map,r.interceptRequest=e.interceptRequest,r.puller.on(c.Event.COLLABORATOR,function(t){l("get data from puller",t),t.forEach(function(t){var e=t.type,n=t.data;e===c.Event.LEAVE?r.onLeave(n):e===c.Event.ENTER?r.onEnter(n):e===c.Event.SELECT?r.onSelect(n):e===c.Event.FILE_META&&r.onFileMeta(n)})}),r.editor&&e.url&&(r.url=e.url,r.editor.on("userSelect",function(t){t&&t.data&&(t.data.baseRev=r.tracker.rev),r.onUserSelect(t)})),r}return n(e,t),e.prototype.destroy=function(){this.editor.off("userSelect",this.onUserSelect)},e.prototype.getUserSelect=function(t,e){if(l("get user select for changes",t,e,this.clientUserSelect.get(t)),this.clientUserSelect.has(t)){var r=this.clientUserSelect.get(t);if(r.editorSelectData&&r.baseRev<=e)return clearTimeout(this.clientUserSelect.get(t).timer),this.clientUserSelect.delete(t),o(o({},r.editorSelectData),{clientId:t})}},e.prototype.handleUserSelect=function(t,e){var r=this;if(l("client:"+e+" handle user select",t),t.hasOwnProperty("baseRev")&&t.hasOwnProperty("isContent")){if(t.isContent){this.clientUserSelect.has(e)&&clearTimeout(this.clientUserSelect.get(e).timer);var n=setTimeout(function(){r.clientUserSelect.delete(e)},1e4);this.clientUserSelect.set(e,{editorSelectData:t,timer:n,baseRev:t.baseRev})}else this.tracker.rev===t.baseRev&&this.editor.onUserSelect(o(o({},t),{clientId:e}));l("client user select",e,this.clientUserSelect.get(e))}else this.editor.onUserSelect(t)},e.prototype.findUser=function(t){return this.users.find(function(e){return t===e.user.id})},e.prototype.onEnter=function(t){if(l("user enter",t),this.clients[t.clientId])l("client",t.clientId,"already here");else{this.clients[t.clientId]={user:t.user};var e=this.findUser(t.user.id);if(e)return e.clients.push({clientId:t.clientId}),void(this.modocUserSelectFeat&&this.editor.onUserEnter({collaborators:[],enterUsers:[o(o({},t.user),{color:this.getColor(t.user.id),clientId:t.clientId})]}));var r={clients:[{clientId:t.clientId}],user:t.user};this.users.push(r),this.emit(c.Event.ENTER,{user:t.user}),this.editor&&this.editor.onUserEnter&&this.editor.onUserEnter({collaborators:[],enterUsers:[o(o({},t.user),{color:this.getColor(t.user.id),clientId:t.clientId})]})}},e.prototype.onLeave=function(t){l("user leave",t);var e=this.clients[t.clientId];if(e){var r=e.user.id;delete this.clients[t.clientId];var n=this.findUser(r);if(n){var i=n.clients.findIndex(function(e){return e.clientId===t.clientId});if(i>-1&&n.clients.splice(i,1),0===n.clients.length){l("clientId",t.clientId,"onUserLeave",e);var a=this.users.findIndex(function(t){return t.user.id===n.user.id});a>-1&&this.users.splice(a,1),this.emit(c.Event.LEAVE,{user:n.user})}(0===n.clients.length||1===n.clients.length&&n.user.isMe||this.modocUserSelectFeat)&&this.editor&&this.editor.onUserLeave&&this.editor.onUserLeave({collaborators:[],leaveUsers:[o(o({},n.user),{color:this.getColor(n.user.id),clientId:t.clientId})]})}else l("no such user",r)}else l("no such client",t.clientId)},e.prototype.onSelect=function(t){var e=t.clientId,r=t.user,n=t.select;if(l("on user select",e,r,n),this.clients[e])if(e!==this.clientId){this.clients[e].select=n;var i=this.findUser(r.id);if(i){var a=i.clients.find(function(t){return t.clientId===e});a&&(a.select=n);var s=o(o({userInfo:o(o({},i.user),{color:this.getColor(i.user.id)})},n),{clientId:e});this.editor&&this.editor.onUserSelect&&this.handleUserSelect(s,e)}else l("no such user",r)}else l("self client");else l("no such client",e)},e.prototype.onFileMeta=function(t){var e=t.clientId,r=t.data;l("on file meta, clientId:",e,", data:",r),e!==this.clientId?this.editor&&this.editor.handleFileMeta&&this.editor.handleFileMeta(r):l("self client")},e.prototype.getColor=function(t){return c.colors[t%c.colors.length]},e.prototype.assembleUrl=function(t,e){var r=t.split("?"),n=r[0],o=r[1],i=u.parse(o);i.clientId=e;var a=this.interceptRequest({url:n,method:"POST",query:i,headers:{}});return a.url+"?"+u.stringify(a.query||{})},e.prototype._onUserSelect=function(t){var e=this,r=this.assembleUrl(this.url,this.clientId);return i.default({data:t,method:"post",url:r}).catch(function(t){e.emit(c.Event.WARNING,{message:t.message})})},e.events={ENTER:"enter",LEAVE:"leave",SELECT:"select"},e}(s.EventEmitter);e.Collaborator=f},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(2),i=r(8),a=r(1),s=o("collab:external-datasource"),u=function(t){function e(e){var r=t.call(this)||this;return r.puller=e.puller,r.editor=e.editor,r.editor&&("function"==typeof r.editor.handleExternalDataChanges?r.puller.on(a.Event.EXTERNAL_CHANGES,function(t){s("get external file changed notifications from puller",t),r.onMessage(t)}):s("Editor doesnot have method handleExternalDataChanges")),r}return n(e,t),e.prototype.destroy=function(){},e.prototype.onMessage=function(t){t.length>0&&this.editor.handleExternalDataChanges(t)},e}(i.EventEmitter);e.ExternalDatasource=u},function(t,e,r){"use strict";var n=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=r(2),i=r(8),a=r(1),s=o("collab:shimo-scripts"),u=function(t){function e(e){var r=t.call(this)||this;return r.puller=e.puller,r.editor=e.editor,r.editor&&("function"==typeof r.editor.handleShimoScriptsEvent?r.puller.on(a.Event.SHIMO_SCRIPTS,function(t){s("get shimo scripts data from puller",t),r.onMessage(t)}):s("Editor does not have method handleShimoScriptsEvent")),r}return n(e,t),e.prototype.destroy=function(){},e.prototype.onMessage=function(t){t&&this.editor.handleShimoScriptsEvent(t)},e}(i.EventEmitter);e.ShimoScriptsHandler=u},function(t,e,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):function(t){return t instanceof r?t:new r(function(e){e(t)})}(t.value).then(a,s)}u((n=n.apply(t,e||[])).next())})},i=this&&this.__generator||function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var a=r(16),s=r(2)("collab:reporter"),u=function(){function t(t){void 0===t&&(t={}),this.enable=!1,this.queue=[],this.maxBodySize=4096,this.sendInterval=1e4,this.lastSendBodySize=0,this.stopped=!1,this.enable=Boolean(t.enable),this.env=t.env||{},this.url=t.url||"/api/log/track",this.sendInterval=t.sendInterval||this.sendInterval}return t.prototype.report=function(t){if(this.enable)try{if(t=n(n({},t),{time:new Date}),0===this.queue.length||this.lastSendBodySize>this.maxBodySize)return this.queue.push([t]),void(this.lastSendBodySize=JSON.stringify(t).length);this.queue[this.queue.length-1].push(t),this.lastSendBodySize+=JSON.stringify(t).length}catch(t){a.default.post(this.url,n(n({},this.env),{tag:"collab_reporter",type:"push error",message:t.message+t.stack}))}},t.prototype.start=function(){this.trySend()},t.prototype.stop=function(){this.stopped=!0},t.prototype.trySend=function(t){return o(this,void 0,void 0,function(){var e;return i(this,function(r){switch(r.label){case 0:if(this.stopped)return[2];if(0===this.queue.length&&!t)return this.delaySend(),[2];e=t||this.queue.shift(),r.label=1;case 1:return r.trys.push([1,3,,4]),s((t?"re":"")+"send request with "+e.length+" items"),[4,a.default.post(this.url,n(n({tag:"collab_reporter"},this.env),{items:e}))];case 2:return r.sent(),this.delaySend(),[3,4];case 3:return r.sent(),s("send request error, retry"),this.delaySend(e),[3,4];case 4:return[2]}})})},t.prototype.delaySend=function(t){var e=this;setTimeout(function(){e.trySend(t)},this.sendInterval)},t}();e.Reporter=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.noopAdaptor=function(t){return t}}]);