!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="https://assets.smcdn.cn/sheet/",n(n.s=2295)}({0:function(t,e){t.exports=React},1:function(t,e,n){"use strict";var r=function(){return(r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},o=function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(a,c)}s((r=r.apply(t,e||[])).next())})},i=function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},a=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,c=i.length;a<c;a++,o++)r[o]=i[a];return r};Object.defineProperty(e,"__esModule",{value:!0});var c=n(18),s=n(38),u={},l=function(t){return u[t]||(u[t]=d()),u[t]};e.getS18n=l;var p=function(){u={}};e.DEBUG_reset=p;var f=function(){return u};e.DEBUG_getInstances=f;var d=function(){var t,e,n="zh-CN",u="zh-CN",d={},h=function(t,e){if(!c.isValidLocaleResource(e))throw new Error("fetched locale resource is invalid");d[t]=r(r({},d[t]||{}),e)},_=function(t,n){return o(void 0,void 0,void 0,function(){var r;return i(this,function(o){switch(o.label){case 0:return!n&&d[t]?[3,2]:e?[4,e(t)]:[3,2];case 1:r=o.sent(),h(t,r),o.label=2;case 2:return[2]}})})},y=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("string"==typeof t[0]){var r=t[0],o=t[1],i=o&&"string"==typeof o._?o._:void 0,c=i?r+"#"+i:r;if(!c)return"";var l=s.getTextResult(c,d[n]);if("string"==typeof l)return l;var p=s.getTextResult(c,d[u]);return"string"==typeof p?p:r}if(t[0]&&"number"==typeof t[0].length){var f=t[0],h=t.slice(1);return s.getInterpolateResult(f,h,d[n])||s.getInterpolateResult(f,h,d[u])||s.interweave(f,h)}return console.warn.apply(console,a(["[s18n] invalid input:"],t)),""};return y.configure=function(n){if(n.fetchLocale){if("function"!=typeof n.fetchLocale)throw new TypeError("fetchLocale should be an async function that resolves with locale resource");e=n.fetchLocale}if(n.fetchLocaleSync){if("function"!=typeof n.fetchLocaleSync)throw new TypeError("fetchLocaleSync should be a function that returns locale resource");t=n.fetchLocaleSync}},y.addLocaleResource=h,y.setLocaleAsync=function(t,e){return o(void 0,void 0,void 0,function(){return i(this,function(r){switch(r.label){case 0:if("string"!=typeof t)throw new Error("'locale' is required");return[4,_(t)];case 1:return r.sent(),n=t,"string"==typeof e&&(_(e),u=e),[2]}})})},y.setLocaleSync=function(e){if("string"!=typeof e)throw new Error("'locale' is required");if(t){var r=t(e);h(e,r)}n=e},y.getLocale=function(){return n},y.DEBUG_getLocaleResources=function(){return d},y.getS18n=l,y.DEBUG_reset=p,y.DEBUG_getInstances=f,y},h=l("__default_namespace__");t.exports=h,e.default=h},10:function(t,e){t.exports=function(t){return!!t&&"object"==typeof t}},100:function(t,e){t.exports=function(t){return this.__data__.get(t)}},101:function(t,e){t.exports=function(t){return this.__data__.has(t)}},102:function(t,e,n){var r=n(13),o=n(31),i=200;t.exports=function(t,e){var n=this.__data__;return n instanceof r&&n.__data__.length==i&&(n=this.__data__=new o(n.__data__)),n.set(t,e),this}},103:function(t,e,n){var r=n(104),o=n(13),i=n(40);t.exports=function(){this.__data__={hash:new r,map:new(i||o),string:new r}}},104:function(t,e,n){var r=n(105),o=n(106),i=n(107),a=n(108),c=n(109);function s(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=c,t.exports=s},105:function(t,e,n){var r=n(15);t.exports=function(){this.__data__=r?r(null):{}}},106:function(t,e){t.exports=function(t){return this.has(t)&&delete this.__data__[t]}},107:function(t,e,n){var r=n(15),o="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===o?void 0:n}return i.call(e,t)?e[t]:void 0}},108:function(t,e,n){var r=n(15),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:o.call(e,t)}},109:function(t,e,n){var r=n(15),o="__lodash_hash_undefined__";t.exports=function(t,e){return this.__data__[t]=r&&void 0===e?o:e,this}},110:function(t,e,n){var r=n(16);t.exports=function(t){return r(this,t).delete(t)}},111:function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},112:function(t,e,n){var r=n(16);t.exports=function(t){return r(this,t).get(t)}},113:function(t,e,n){var r=n(16);t.exports=function(t){return r(this,t).has(t)}},114:function(t,e,n){var r=n(16);t.exports=function(t,e){return r(this,t).set(t,e),this}},116:function(t,e,n){var r=n(122);t.exports=function(t){var e=r(t),n=e%1;return e==e?n?e-n:e:0}},1193:function(t,e,n){"use strict";e.b=function(t,e){for(var n=[],r=0;r<t.length;r++){var i=t[r];"string"!=typeof i&&n.push(o.a.createElement(i,d(d({},e),{key:r})))}return n},e.e=function(t,e){if(e.getMobileContextmenu)for(var n=e.getMobileMenuConfig().component,r=0;r<h.length;r++){var o=h[r];o===t&&(h[r]=n)}},e.d=function(){return h.filter(function(t){return"string"==typeof t})},n.d(e,"a",function(){return _}),e.c=function(t){for(var e=h.filter(function(e){return"string"!=typeof e&&e.isVisible(t)}),n=window.innerWidth,r=0,o=0;o<e.length;o++){var i=e[o],a=[].concat(i.getMenuText(t)),c=Object(f.a)(a);if((r+=c)>n){var s=r-c+y>n?o-1:o;return[e.slice(0,s),e.slice(s)]}}return[e,[]]};var r=n(0),o=n.n(r),i=n(2300),a=n(2301),c=n(2302),s=n(2303),u=n(2304),l=n(2305),p=n(2306),f=n(2307),d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},h=[c.a,a.a,s.a,i.a,u.a,p.a,l.a];var _=16,y=25},12:function(t,e,n){var r=n(41),o=n(81),i=n(68),a=n(17),c=n(34),s=n(36);t.exports=function(t){var e=s(t);if(!e&&!a(t))return o(t);var n=i(t),u=!!n,l=n||[],p=l.length;for(var f in t)!r(t,f)||u&&("length"==f||c(f,p))||e&&"constructor"==f||l.push(f);return l}},120:function(t,e){var n="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,n),this}},121:function(t,e){t.exports=function(t){return this.__data__.has(t)}},122:function(t,e,n){var r=n(61),o=1/0,i=1.7976931348623157e308;t.exports=function(t){return t?(t=r(t))===o||t===-o?(t<0?-1:1)*i:t==t?t:0:0===t?t:0}},126:function(t,e,n){var r=n(46),o=n(57),i=n(128),a=n(129),c=n(42),s=n(5),u=n(28),l=n(130),p=2,f="[object Arguments]",d="[object Array]",h="[object Object]",_=Object.prototype.hasOwnProperty;t.exports=function(t,e,n,y,m,g){var v=s(t),b=s(e),w=d,x=d;v||(w=(w=c(t))==f?h:w),b||(x=(x=c(e))==f?h:x);var C=w==h&&!u(t),S=x==h&&!u(e),O=w==x;if(O&&!C)return g||(g=new r),v||l(t)?o(t,e,n,y,m,g):i(t,e,w,n,y,m,g);if(!(m&p)){var j=C&&_.call(t,"__wrapped__"),E=S&&_.call(e,"__wrapped__");if(j||E){var P=j?t.value():t,T=E?e.value():e;return g||(g=new r),n(P,T,y,m,g)}}return!!O&&(g||(g=new r),a(t,e,n,y,m,g))}},127:function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}},128:function(t,e,n){var r=n(47),o=n(67),i=n(57),a=n(48),c=n(45),s=1,u=2,l="[object Boolean]",p="[object Date]",f="[object Error]",d="[object Map]",h="[object Number]",_="[object RegExp]",y="[object Set]",m="[object String]",g="[object Symbol]",v="[object ArrayBuffer]",b="[object DataView]",w=r?r.prototype:void 0,x=w?w.valueOf:void 0;t.exports=function(t,e,n,r,w,C,S){switch(n){case b:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case v:return!(t.byteLength!=e.byteLength||!r(new o(t),new o(e)));case l:case p:return+t==+e;case f:return t.name==e.name&&t.message==e.message;case h:return t!=+t?e!=+e:t==+e;case _:case m:return t==e+"";case d:var O=a;case y:var j=C&u;if(O||(O=c),t.size!=e.size&&!j)return!1;var E=S.get(t);return E?E==e:(C|=s,S.set(t,e),i(O(t),O(e),r,w,C,S));case g:if(x)return x.call(t)==x.call(e)}return!1}},129:function(t,e,n){var r=n(41),o=n(12),i=2;t.exports=function(t,e,n,a,c,s){var u=c&i,l=o(t),p=l.length;if(p!=o(e).length&&!u)return!1;for(var f=p;f--;){var d=l[f];if(!(u?d in e:r(e,d)))return!1}var h=s.get(t);if(h)return h==e;var _=!0;s.set(t,e);for(var y=u;++f<p;){var m=t[d=l[f]],g=e[d];if(a)var v=u?a(g,m,d,e,t,s):a(m,g,d,t,e,s);if(!(void 0===v?m===g||n(m,g,a,c,s):v)){_=!1;break}y||(y="constructor"==d)}if(_&&!y){var b=t.constructor,w=e.constructor;b!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof b&&b instanceof b&&"function"==typeof w&&w instanceof w)&&(_=!1)}return s.delete(t),_}},13:function(t,e,n){var r=n(93),o=n(94),i=n(95),a=n(96),c=n(97);function s(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=c,t.exports=s},130:function(t,e,n){var r=n(20),o=n(10),i={};i["[object Float32Array]"]=i["[object Float64Array]"]=i["[object Int8Array]"]=i["[object Int16Array]"]=i["[object Int32Array]"]=i["[object Uint8Array]"]=i["[object Uint8ClampedArray]"]=i["[object Uint16Array]"]=i["[object Uint32Array]"]=!0,i["[object Arguments]"]=i["[object Array]"]=i["[object ArrayBuffer]"]=i["[object Boolean]"]=i["[object DataView]"]=i["[object Date]"]=i["[object Error]"]=i["[object Function]"]=i["[object Map]"]=i["[object Number]"]=i["[object Object]"]=i["[object RegExp]"]=i["[object Set]"]=i["[object String]"]=i["[object WeakMap]"]=!1;var a=Object.prototype.toString;t.exports=function(t){return o(t)&&r(t.length)&&!!i[a.call(t)]}},131:function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},14:function(t,e,n){var r=n(33);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},141:function(t,e,n){var r=n(92),o=n(171);t.exports=function t(e,n,i,a,c){var s=-1,u=e.length;for(i||(i=o),c||(c=[]);++s<u;){var l=e[s];n>0&&i(l)?n>1?t(l,n-1,i,a,c):r(c,l):a||(c[c.length]=l)}return c}},144:function(t,e){t.exports=Zepto},145:function(t,e,n){"use strict";n.p=("string"==typeof __SM_CDN_HOST__?__SM_CDN_HOST__:"https://assets.smcdn.cn")+"/sheet/"},147:function(t,e,n){var r=n(6),o=n(180),i=n(61),a="Expected a function",c=Math.max,s=Math.min;t.exports=function(t,e,n){var u,l,p,f,d,h=0,_=0,y=!1,m=!1,g=!0;if("function"!=typeof t)throw new TypeError(a);function v(e){var n=u,r=l;return u=l=void 0,_=e,f=t.apply(r,n)}function b(t){var n=t-h;return!h||n>=e||n<0||m&&t-_>=p}function w(){var t=o();if(b(t))return x(t);d=setTimeout(w,function(t){var n=e-(t-h);return m?s(n,p-(t-_)):n}(t))}function x(t){return clearTimeout(d),d=void 0,g&&u?v(t):(u=l=void 0,f)}function C(){var t=o(),n=b(t);if(u=arguments,l=this,h=t,n){if(void 0===d)return function(t){return _=t,d=setTimeout(w,e),y?v(t):f}(h);if(m)return clearTimeout(d),d=setTimeout(w,e),v(h)}return void 0===d&&(d=setTimeout(w,e)),f}return e=i(e)||0,r(n)&&(y=!!n.leading,p=(m="maxWait"in n)?c(i(n.maxWait)||0,e):p,g="trailing"in n?!!n.trailing:g),C.cancel=function(){void 0!==d&&clearTimeout(d),h=_=0,u=l=d=void 0},C.flush=function(){return void 0===d?f:x(o())},C}},15:function(t,e,n){var r=n(8)(Object,"create");t.exports=r},155:function(t,e,n){"use strict";e.a=function(){return{hAlign:[{icon:"left",value:"left"},{icon:"center",value:"center"},{icon:"right",value:"right"}],vAlign:[{icon:"top",value:"top"},{icon:"middle",value:"middle"},{icon:"bottom",value:"bottom"}],bius:[{icon:"bold",selectedKey:"boldSelected",key:"bold"},{icon:"italic",selectedKey:"italicSelected",key:"italic"},{icon:"underline",selectedKey:"underlineSelected",key:"underline"},{icon:"strike-through",selectedKey:"strikeThroughSelected",key:"strike"}],clear:[{text:o()("清除内容"),type:"content"},{text:o()("清除样式"),type:"style"},{text:o()("清除所有格式"),type:"allFormat"}],wrap:[{icon:"single-line",type:"text-no-wrap"},{icon:"auto-wrap",type:"text-wrap"},{icon:"multi-line",type:"text-linebreak-overflow"}],fontSize:[{text:"9",value:9},{text:"10",value:10},{text:"11",value:11},{text:"12",value:12},{text:"14",value:14},{text:"18",value:18},{text:"24",value:24},{text:"30",value:30},{text:"36",value:36}],border:[[{icon:"border-all",type:"all"},{icon:"border-outline",type:"outline"},{icon:"border-inside",type:"inside"},{icon:"border-none",type:"none"},{icon:"border-diagonal-down",type:"diagonalDown"}],[{icon:"border-left",type:"left"},{icon:"border-right",type:"right"},{icon:"border-top",type:"top"},{icon:"border-bottom",type:"bottom"},{icon:"border-diagonal-up",type:"diagonalUp"}],[{icon:"border-normal",value:1},{icon:"border-bold",value:2},{icon:"border-long-dashed",value:4},{icon:"border-short-dashed",value:7}]],merge:[{icon:"merge",text:o()("合并单元格"),type:"merge"},{icon:"un-merge",text:o()("取消合并"),type:"unMerge"}],insertDeleteCells:[[{icon:"insert-cell-right",text:o()("插入单元格 右移"),direction:"right"},{icon:"insert-cell-down",text:o()("插入单元格 下移"),direction:"down"}],[{icon:"delete-cell-left",text:o()("删除单元格 左移"),direction:"left"},{icon:"delete-cell-top",text:o()("删除单元格 上移"),direction:"up"}]],sort:[{icon:"sort-ascend",text:o()("升序"),type:"asc"},{icon:"sort-descend",text:o()("降序"),type:"desc"}],frozen:[[{icon:"frozen-row",text:o()("冻结首行"),type:"row"},{icon:"frozen-col",text:o()("冻结首列"),type:"col"}],[{icon:"un-frozen",text:o()("取消冻结"),type:"cancel"}]],insertDeleteRowCol:[[{icon:"insert-row-up",type:"row",isDelete:!1,direction:"up"},{icon:"insert-row-down",type:"row",isDelete:!1,direction:"down"}],[{icon:"delete-row",type:"row",isDelete:!0}],[{icon:"insert-col-left",type:"col",isDelete:!1,direction:"left"},{icon:"insert-col-right",type:"col",isDelete:!1,direction:"right"}],[{icon:"delete-col",type:"col",isDelete:!0}]],visible:[{icon:"hide-row",text:o()("隐藏选中行"),type:"row"},{icon:"hide-col",text:o()("隐藏选中列"),type:"col"}],image:[{icon:"cell-image",text:o()("单元格图片"),type:"cellImage"},{icon:"float-image",text:o()("浮动图片"),type:"floatingImage"}]}};var r=n(1),o=n.n(r)},16:function(t,e,n){var r=n(111);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},161:function(t,e,n){var r=n(66);t.exports=function(t,e){return r(t,e)}},162:function(t,e,n){var r=n(74),o=n(141),i=n(172),a=n(78),c=n(30),s=a(function(t,e){return null==t?{}:i(t,r(o(e,1),c))});t.exports=s},17:function(t,e,n){var r=n(73),o=n(19),i=n(20);t.exports=function(t){return null!=t&&i(r(t))&&!o(t)}},171:function(t,e,n){var r=n(29),o=n(5);t.exports=function(t){return o(t)||r(t)}},172:function(t,e,n){var r=n(65);t.exports=function(t,e){return t=Object(t),r(e,function(e,n){return n in t&&(e[n]=t[n]),e},{})}},18:function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(37);e.isValidLocaleResource=function(t){return!!t&&(!Array.isArray(t)&&("object"===(void 0===t?"undefined":r(t))&&Object.keys(t).every(function(e){var n=t[e];return null==n||"string"==typeof n||"object"===(void 0===n?"undefined":r(n))})))},e.sourceTextToKey=function(t){switch(t.type){case"string":var e=t.id,n=t.text;return e?n+"#"+e:n;case"interpolated":var r=t.textParts.length;return 1===r?t.textParts[0]:2===r?t.textParts[0]+"%s"+t.textParts[1]:t.textParts.map(function(e,n){return n===t.textParts.length-1?e:e+"%"+(n+1)}).join("");default:return o.assertNever(t)}}},180:function(t,e){var n=Date.now;t.exports=n},19:function(t,e,n){var r=n(6),o="[object Function]",i="[object GeneratorFunction]",a=Object.prototype.toString;t.exports=function(t){var e=r(t)?a.call(t):"";return e==o||e==i}},2:function(t,e){t.exports=shimo.sdk.sheet},20:function(t,e){var n=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}},22:function(t,e,n){var r=n(10),o="[object Symbol]",i=Object.prototype.toString;t.exports=function(t){return"symbol"==typeof t||r(t)&&i.call(t)==o}},2295:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(145),o=(n.n(r),n(1)),i=n.n(o),a=(n(2296),n(2)),c=(n.n(a),n(0)),s=n.n(c),u=n(3),l=n.n(u),p=n(2299),f=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},h=a.sheets,_=h.root,y=h.path,m=h.Plugin,g=y.setByPath,v="MobileContextmenu",b=function(t){function e(n){var r=t.call(this,{name:v,Constructor:e,config:n})||this;return r.__render=function(){l.a.render(s.a.createElement(p.a,d({emitter:r},r.options)),r.pluginContainer)},r.options=n,r.install(),r.__render(),r}return f(e,t),e.prototype.setLocale=function(t){i.a.setLocaleSync(t)},e}(m);e.default=b,g(_,"shimo.sdk.sheet.plugins.MobileContextmenu",b)},2296:function(t,e,n){"use strict";var r=n(1),o=n.n(r),i=n(2297),a=n.n(i),c=n(2298),s=n.n(c);o.a.addLocaleResource("en-US",a.a),o.a.addLocaleResource("ja-JP",s.a),o.a.setLocaleSync({en:"en-US",jp:"ja-JP"}[document.documentElement.lang]||document.documentElement.lang||"zh-CN")},2297:function(t,e){t.exports={"清除":"Clear","复制":"Copy","剪切":"Cut","查看大图":"Preview image","嵌入单元格":"Embed cell","转为浮动图片":"Convert to floating image","粘贴":"Paste","正在粘贴，请稍等...":"Pasting, please wait...","删除行":"Delete row","删除列":"Delete column","单元格操作":"Cell operation","行操作":"Row operation","列操作":"Col operation"}},2298:function(t,e){t.exports={"清除":"クリアー","复制":"コピーする","剪切":"カット","查看大图":"大きな画像を見る","嵌入单元格":"埋め込みセル","转为浮动图片":"フローティング画像に変換","粘贴":"貼り付け","正在粘贴，请稍等...":"貼り付けています・・・","删除行":"行を削除","删除列":"列を削除","单元格操作":"セル操作","行操作":"ライン操作","列操作":"カラム操作"}},2299:function(t,e,n){"use strict";(function(t){var r=n(2),o=(n.n(r),n(0)),i=n.n(o),a=n(314),c=n.n(a),s=n(147),u=n.n(s),l=n(1193),p=n(2308),f=(n.n(p),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},h=r.sheets.Core,_=r.sheets.Events,y=r.sheets.range.isRangeVisible,m=h.Spread.Sheets.Events,g=m.CellClick,v=m.CellLongTapped,b=m.EditStarted,w=m.TopRowChanged,x=m.LeftColumnChanged,C=m.FloatingObjectTapped,S=m.FloatingObjectMoved,O=m.FloatingObjectResized,j=m.SpreadResized,E=function(e){function n(n){var r=e.call(this,n)||this;return r.pluginsInConfig={},r.menuType="",r.reRender=c()(function(){return r.forceUpdate()},150,{trailing:!0,leading:!1}),r.delayRenderPluginsConfig=u()(function(){Object.keys(r.pluginsInConfig).forEach(function(t){Object(l.e)(t,r.pluginsInConfig[t])}),r.pluginsInConfig={},r.forceUpdate()},1e3,{leading:!1,trailing:!0}),r.__onCellTap=function(t,e){var n=e.isSelectionTouched,o=e.sheet,i=e.row,a=e.col;n&&!r.state.show?r.__showContextmenu(o,void 0,{row:i,col:a}):r.setState({show:!1,showMoreMenu:!1})},r.__onCellLongTap=function(t,e){var n=e.sheet,o=e.row,i=e.col;r.state.show||r.__showContextmenu(n,void 0,{row:o,col:i})},r.__onPluginInstalled=function(t){var e=t.name,n=t.instance;r.pluginsInConfig[e]=n,r.delayRenderPluginsConfig()},r.__hideContextmenu=function(){r.setState({show:!1,showMoreMenu:!1}),r.menuType=""},r.__onSelectionChanged=function(t){var e=t.sheet,n=t.newSelections;if(e&&n&&1===n.length){var o=n[0];o.rowCount===e.getRowCount()&&o.colCount===e.getColumnCount()&&r.__showContextmenu(e)}},r.__updateFloatingPicMenu=function(){if("floatingPicture"===r.menuType&&r.state.show){var t=r.editor.spread.gcSpread.getActiveSheet(),e=t.pictures.getSelected();e.length&&r.__showContextmenu(t,e[0])}},r.__onFloatingObjectTapped=function(t,e){var n=e.sheet,o=e.floatingObject;"1"===o.typeName&&setTimeout(function(){return r.__showContextmenu(n,o)})},r.__onFloatingObjectMovedOrResized=function(t,e){var n=e.sheet,o=e.floatingObjects[0];if(r.state.show&&"floatingPicture"===r.menuType&&o.startsWith("picture")){var i=n.pictures.get(o);setTimeout(function(){return r.__showContextmenu(n,i)})}},r.__toggleMoreMenu=function(t){t.stopPropagation();var e=r.state,n=e.showMoreMenu,o=e.menuAngelState.left;r.setState({showMoreMenu:!n},function(){r.setState({menuLeft:r.__getMenuLeftPos(o,innerWidth)})})},r.__onResized=function(){setTimeout(function(){return r.__adjustMenu()})},r.__adjustMenu=function(){if(r.state.show){var e=r.editor.spread.gcSpread.getActiveSheet();if("floatingPicture"===r.menuType){var n=e.pictures.getSelected(),o=n[0];o&&t("div[name="+o.name()+"]").length?r.__showContextmenu(e,n[0]):r.setState({show:!1})}else{var i=e.getSelections()[0],a=i.row,c=i.col,s=i.rowCount,u=i.colCount;y(e,a,c,s,u)?r.__showContextmenu(e,void 0,{row:i.row,col:i.col}):r.setState({show:!1})}}},r.editor=n.editor,r.state={show:!1,menuAngelState:{left:0,top:0,isUp:!0},menuLeft:0,showMoreMenu:!1},r}return f(n,e),Object.defineProperty(n.prototype,"permission",{get:function(){var t=this.props.editor.spread.getActiveSheet().gcSheet,e=t.getSelections();return{canEditSheet:Boolean(t&&t.isEditable()),canReadRange:Boolean(t&&t.isRangeReadable(e)),canEditRange:Boolean(t&&t.isRangeEditable(e))}},enumerable:!0,configurable:!0}),n.prototype.componentDidMount=function(){this.__bindSpreadEvents(),this.editor.on(_.AfterChangeApplied,this.__updateFloatingPicMenu),this.editor.on(_.SheetSwitched,this.__hideContextmenu),this.editor.on(_.AfterSelectionChanged,this.__onSelectionChanged),this.editor.on(_.PermissionChanged,this.reRender)},n.prototype.componentWillUnmount=function(){this.__unbindSpreadEvents(),this.editor.off(_.AfterChangeApplied,this.__updateFloatingPicMenu),this.editor.off(_.SheetSwitched,this.__hideContextmenu),this.editor.off(_.AfterSelectionChanged,this.__onSelectionChanged),this.editor.off(_.PermissionChanged,this.reRender)},n.prototype.render=function(){var t=this.state,e=t.show,n=t.menuAngelState,r=t.menuLeft,o=t.showMoreMenu;if(!e)return null;var a=this.permission,c=n.left,s=n.top,u=n.isUp,p=u?s-32:s+6,f=d(d({},this.props),{permission:a,isFloatingPictureSelected:"floatingPicture"===this.menuType}),h=Object(l.c)(f),_=h[0],y=h[1],m=o&&y.length?y:_;return[i.a.createElement("div",{ref:"contextmenu",key:"contextmenu",style:{top:p,left:r},className:"m-contextmenu",onClick:this.__hideContextmenu},e&&Object(l.b)(m,f),e&&y.length?i.a.createElement("div",{onClick:this.__toggleMoreMenu,className:"m-contextmenu-item m-contextmenu-toggler-"+(o?"left":"right")}):null),e&&i.a.createElement("div",{style:{left:c,top:s},key:"angel",className:"m-contextmenu-angel"+(u?" up-angel":" down-angel")})]},n.prototype.__bindSpreadEvents=function(){var t=this.editor.spread.gcSpread;t.bind(g,this.__onCellTap),t.bind(C,this.__onFloatingObjectTapped),t.bind(S,this.__onFloatingObjectMovedOrResized),t.bind(O,this.__onFloatingObjectMovedOrResized),t.bind(v,this.__onCellLongTap),t.bind(b,this.__hideContextmenu),t.bind(w,this.__hideContextmenu),t.bind(x,this.__hideContextmenu),t.bind(j,this.__onResized)},n.prototype.__unbindSpreadEvents=function(){var t=this.editor.spread.gcSpread;t.unbind(g,this.__onCellTap),t.unbind(C,this.__onFloatingObjectTapped),t.unbind(S,this.__onFloatingObjectMovedOrResized),t.unbind(O,this.__onFloatingObjectMovedOrResized),t.unbind(v,this.__onCellLongTap),t.unbind(b,this.__hideContextmenu),t.unbind(w,this.__hideContextmenu),t.unbind(x,this.__hideContextmenu),t.unbind(j,this.__onResized)},n.prototype.__replacePluginsConfig=function(){var t=this;Object(l.d)().forEach(function(e){var n=t.editor.pluginManager.get(e);n&&(t.pluginsInConfig[e]=n.instance)}),this.delayRenderPluginsConfig()},n.prototype.__showContextmenu=function(t,e,n){var r,o=this,i=t._getSheetLayout(),a=i.x,c=i.y,s=i.width,u=i.height,l=i._rowHeaderWidth,p=i._colHeaderHeight,f=i._frozenHeight,d=i._frozenWidth,h=c+p+32+6+3,_=u-32-6-3,y=a+l,m=c+p;if(e)r=e.getContainerRect();else if(n){var g=t.getSelections()[0],v=d?0:t.getViewportLeftColumn(1),b=t.getViewportRightColumn(1),w=f?0:t.getViewportTopRow(1),x=t.getViewportBottomRow(1),C=g.rowCount,S=g.colCount,O=Math.max(0,g.row),j=Math.max(0,g.col),E=Math.max(O,w),P=Math.max(j,v),T=Math.min(O+C,x),k=Math.min(j+S,b),A=t.getCellRect(E,P),R=t.getCellRect(T,k);r={startY:Math.max(A.y,m),startX:Math.max(A.x,y),endX:R.x>0&&j+S<=b?R.x:s,endY:R.y>0&&O+C<=x?R.y:u}}else r={startX:y,endX:s,startY:m,endY:u};var M=r.startX,F=r.startY,I=(r.endX-M-12)/2+M,U=0,L=!0;F>=h?U=F-6-3:r.endY<=_?(U=r.endY,L=!1):(U=m+6,L=!1),this.menuType=e?"floatingPicture":"cell";var N=document.querySelector(".sm-sheet-view");N&&(U+=N.getBoundingClientRect().top),this.setState({show:!0,menuAngelState:{left:I,top:U,isUp:L}},function(){o.setState({menuLeft:o.__getMenuLeftPos(I,s)})})},n.prototype.__getMenuLeftPos=function(t,e){var n=this.refs.contextmenu.offsetWidth,r=Math.max(t-(n-12)/2,5);return r+n>e&&(r=e-n-5),r},n}(i.a.PureComponent);e.a=E}).call(e,n(144))},2300:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(1),a=n.n(i),c=n(2),s=(n.n(c),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),u=c.sheets.track,l=function(t){function e(e){var n=t.call(this,e)||this;return n.__clear=function(){u(2,"18005");var t=n.props.editor.spread.getActiveSheet();t.actions.doDelete(t.gcSheet)},n}return s(e,t),e.prototype.render=function(){return e.isVisible(this.props)?o.a.createElement("div",{onClick:this.__clear,className:"m-contextmenu-item"},e.getMenuText()):null},e.getMenuText=function(){return a()("清除")},e.isVisible=function(t){var e=t.permission,n=e.canEditRange,r=e.canEditSheet,o=t.isFloatingPictureSelected;return n||o&&r},e}(o.a.Component);e.a=l},2301:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(1),a=n.n(i),c=n(2),s=(n.n(c),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),u=c.sheets.clipboard,l=c.sheets.track,p=c.sheets.utils,f=u.doMobileCopyOrCut,d=p.showAlert,h=function(t){function e(e){var n=t.call(this,e)||this;return n.__doCopy=function(){var t=n.props,e=t.isFloatingPictureSelected,r=t.setClipboardData;l(2,"18003");var o=n.props.editor.permissions.query.shimo.getFilePermission();if(!(!o||!o.permissions||o.permissions.copyable))return d({title:a()("根据企业设置，你没有权限复制内容，请联系文件所有者或企业管理员")});f(n.props.editor,!1,e,r)},n}return s(e,t),e.prototype.render=function(){return e.isVisible(this.props)?o.a.createElement("div",{onClick:this.__doCopy,className:"m-contextmenu-item"},e.getMenuText()):null},e.getMenuText=function(){return a()("复制")},e.isVisible=function(t){var e=t.permission.canReadRange,n=t.isFloatingPictureSelected;return e||n},e}(o.a.Component);e.a=h},2302:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(1),a=n.n(i),c=n(2),s=(n.n(c),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),u=c.sheets.clipboard,l=c.sheets.track,p=c.sheets.utils,f=u.doMobileCopyOrCut,d=p.showAlert,h=function(t){function e(e){var n=t.call(this,e)||this;return n.__doCut=function(){var t=n.props,e=t.isFloatingPictureSelected,r=t.setClipboardData;l(2,"18002");var o=n.props.editor.permissions.query.shimo.getFilePermission();if(!(!o||!o.permissions||o.permissions.copyable))return d({title:a()("根据企业设置，你没有权限复制内容，请联系文件所有者或企业管理员")});f(n.props.editor,!0,e,r)},n}return s(e,t),e.prototype.render=function(){return e.isVisible(this.props)?o.a.createElement("div",{onClick:this.__doCut,className:"m-contextmenu-item"},e.getMenuText()):null},e.getMenuText=function(){return a()("剪切")},e.isVisible=function(t){var e=t.permission,n=e.canEditRange,r=e.canEditSheet,o=t.isFloatingPictureSelected;return n||o&&r},e}(o.a.Component);e.a=h},2303:function(t,e,n){"use strict";var r,o=n(0),i=n.n(o),a=n(1),c=n.n(a),s=n(2),u=(n.n(s),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),l=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{s(r.next(t))}catch(t){i(t)}}function c(t){try{s(r.throw(t))}catch(t){i(t)}}function s(t){t.done?o(t.value):function(t){return t instanceof n?t:new n(function(e){e(t)})}(t.value).then(a,c)}s((r=r.apply(t,e||[])).next())})},p=this&&this.__generator||function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},f=s.sheets.utils,d=s.sheets.Hooks,h=s.sheets.track,_=f.showAlert,y=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.render=function(){var t=this;return(void 0===r?e.isVisible(this.props):r)?i.a.createElement("div",{onClick:function(){return t.__doPaste()},className:"m-contextmenu-item"},e.getMenuText()):null},e.getMenuText=function(){return c()("粘贴")},e.isVisible=function(t){var e=t.permission.canEditRange,n=t.isClipboardContainsData,o=t.editor.spread.gcSpread.getActiveSheet(),i=n?n():!!o._clipboardHelper._clipboardHtml;return r=e&&i},e.prototype.__doPaste=function(){return l(this,void 0,Promise,function(){var t,e,n,r,o,i,a,s,u,l;return p(this,function(p){switch(p.label){case 0:return t=this.props,e=t.editor,n=t.getClipboardData,r=e.spread.gcSpread.getActiveSheet(),(o=e.hookManager.triggerHook(d.GetCustomActionMessage,{action:"paste"},""))?[2,_({title:o})]:(h(2,"18004"),_({title:c()("正在粘贴，请稍等..."),duration:500}),n?[4,n()]:[3,2]);case 1:return i=p.sent(),a=i.text,s=i.html,u=i.imageUrl,l=s,s||a||!u||(l="<img src="+u+" />"),[2,r._clipboardHelper._pasteHandler(void 0,{innerHtml:l,innerText:a,isInApp:!0})];case 2:return setTimeout(function(){return r._clipboardHelper._doInternalPaste(r._clipboardHelper._clipboardHtml)}),[2]}})})},e}(i.a.Component);e.a=y},2304:function(t,e,n){"use strict";var r,o=n(0),i=n.n(o),a=n(1),c=n.n(a),s=n(2),u=(n.n(s),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),l=s.sheets.Core,p=s.sheets.image,f=s.sheets.utils,d=s.sheets.track,h=f.downloadFile,_=l.Spread.Sheets.Events,y=_.FloatingObjectPreview,m=_.PreviewCellImage,g=p.floatingPictureToImgCell,v=p.imgCellToFloatingPicture,b=p.getImageDownloadUrl,w=p.getSelectionImagesSrc,x=p.getRangesFirstImgCellPosition,C=function(t){function e(e){var n=t.call(this,e)||this;return n.__convertImages=function(){var t=n.props,e=t.editor,r=t.isFloatingPictureSelected,o=e.spread.getActiveSheet().gcSheet,i=o.getSelections();r?(d(2,"18007"),g(e,o,o.pictures.getSelected())):i.length>0&&(d(2,"18006"),v(e,o,i))},n.__downloadImages=function(){var t=n.props,e=t.editor,r=t.isFloatingPictureSelected,o=e.spread.getActiveSheet().gcSheet;if(r){o.pictures.getSelected().forEach(function(t){var n=t.src(),r=b(e.downloadConfig,n);h(r)})}else{var i=o.getSelections();w(o,i).forEach(function(t){var n=b(e.downloadConfig,t);h(n)})}},n.__previewImage=function(){var t=n.props,e=t.editor,o=t.isFloatingPictureSelected,i=t.viewImage,a=e.spread.getActiveSheet().gcSheet,c=a.getSelections();if(d(2,"18047"),o){var s=a.pictures.getSelected()[0];i?i(s.name()):a._trigger(y,{sheet:a,floatingObject:s})}else if(c.length>0&&r){var u=r.row,l=r.col;i?i([u,l].join("_")):a._trigger(m,{sheet:a,row:u,col:l})}},n}return u(e,t),e.prototype.render=function(){var t=e.getMenuText(this.props);return e.isVisible(this.props)?[i.a.createElement("div",{key:"img-preview",onClick:this.__previewImage,className:"m-contextmenu-item"},t[0]),i.a.createElement("div",{key:"img-convert",onClick:this.__convertImages,className:"m-contextmenu-item"},t[1])]:null},e.getMenuText=function(t){var e=t.isFloatingPictureSelected;return[c()("查看大图"),e?c()("嵌入单元格"):c()("转为浮动图片")]},e.isVisible=function(t){var e=t.isFloatingPictureSelected,n=t.editor.spread.gcSpread.getActiveSheet(),o=t.permission.canEditSheet,i=!0;if(e)i=o;else{var a=n.getSelections();i=!!(r=x(n,a))}return i},e}(i.a.Component);e.a=C},2305:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(1),a=n.n(i),c=n(2),s=(n.n(c),n(323)),u=n(919),l=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=c.sheets.track,f=c.sheets.range.RangeType,d=function(t){function e(n){var r=t.call(this,n)||this;return r.__setToolbarActiveTab=function(){p(2,"18045");var t=r.props,n=t.editor,o=t.showNativeToolbarPanel,i=n.pluginManager.get("MobileToolbar"),a=e.getSelectionType(r.props).isCell;i?i.instance.emit(s.a.SetActiveTabIndex,a?u.a.Cell:u.a.RowCol):o&&o(a?"cell":"rowCol")},r}return l(e,t),e.prototype.render=function(){return o.a.createElement("div",{onClick:this.__setToolbarActiveTab,className:"m-contextmenu-item"},e.getMenuText(this.props))},e.getMenuText=function(t){var n=e.getSelectionType(t),r=n.isCell,o=n.isRow,i=n.isCol;return r?a()("单元格操作"):o?a()("行操作"):i?a()("列操作"):""},e.isVisible=function(t){var n=t.editor.spread.getActiveSheet().gcSheet,r=t.permission.canEditSheet,o=n.getSelections(),i=e.getSelectionType(t),a=i.isCell,c=i.isRow,s=i.isCol;return r&&o.length>0&&(a||c||s)},e.getSelectionType=function(t){var e=t.editor.spread.getActiveSheet().getSelections();if(e.length)switch(e[0].type){case f.CellRange:return{isCell:!0,isRow:!1,isCol:!1};case f.MultipleColumns:return{isCell:!1,isRow:!1,isCol:!0};case f.MultipleRows:return{isCell:!1,isRow:!0,isCol:!1}}return{isCell:!1,isRow:!1,isCol:!1}},e}(o.a.Component);e.a=d},2306:function(t,e,n){"use strict";var r,o=n(0),i=n.n(o),a=n(1),c=n.n(a),s=n(2),u=(n.n(s),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),l=s.sheets.track,p=s.sheets.range.RangeType,f=function(t){function e(n){var o=t.call(this,n)||this;return o.__deleteRowOrCol=function(){var t=(r||e.getSelectionType(o.props)).isRow;l(2,t?"18048":"18049");var n=o.props.editor.spread.getActiveSheet();t?n.removeRows():n.removeColumns()},o}return u(e,t),e.prototype.render=function(){return e.isVisible(this.props)?i.a.createElement("div",{onClick:this.__deleteRowOrCol,className:"m-contextmenu-item"},e.getMenuText(this.props)):null},e.getMenuText=function(t){var n=r||e.getSelectionType(t),o=n.isRow,i=n.isCol;return o?c()("删除行"):i?c()("删除列"):""},e.isVisible=function(t){var n=t.permission.canEditRange,o=(r=e.getSelectionType(t)).isRow,i=r.isCol;return n&&(o||i)},e.getSelectionType=function(t){var e=t.editor.spread.getActiveSheet().getSelections();if(e.length)switch(e[0].type){case p.MultipleColumns:return{isRow:!1,isCol:!0};case p.MultipleRows:return{isRow:!0,isCol:!1}}return{isRow:!1,isCol:!1}},e}(i.a.Component);e.a=f},2307:function(t,e,n){"use strict";e.a=function(t){var e=document.createElement("canvas").getContext("2d");return e.font="12px Arial",t.reduce(function(t,n){return t+=e.measureText(n).width+2*r.a+1},0)};var r=n(1193)},2308:function(t,e,n){var r=n(2309);"string"==typeof r&&(r=[[t.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(25)(r,o);r.locals&&(t.exports=r.locals)},2309:function(t,e,n){(t.exports=n(24)(!1)).push([t.i,".m-contextmenu {\n  position: fixed;\n  height: 32px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  opacity: 0.9;\n  border-radius: 4px;\n  background-color: #41464b;\n  overflow-x: auto;\n  user-select: none;\n  -webkit-user-select: none; }\n  .m-contextmenu .m-contextmenu-item {\n    height: 100%;\n    font-size: 12px;\n    font-weight: 500;\n    text-align: center;\n    color: #ffffff;\n    padding: 0 16px;\n    display: flex;\n    align-items: center;\n    word-break: keep-all;\n    user-select: none;\n    -webkit-user-select: none; }\n    .m-contextmenu .m-contextmenu-item.m-contextmenu-toggler-right, .m-contextmenu .m-contextmenu-item.m-contextmenu-toggler-left {\n      padding: 0 8px; }\n      .m-contextmenu .m-contextmenu-item.m-contextmenu-toggler-right:after, .m-contextmenu .m-contextmenu-item.m-contextmenu-toggler-left:after {\n        content: '';\n        display: block;\n        border-top: 6px solid transparent;\n        border-bottom: 6px solid transparent; }\n    .m-contextmenu .m-contextmenu-item.m-contextmenu-toggler-right:after {\n      border-left: 8px solid #ffffff; }\n    .m-contextmenu .m-contextmenu-item.m-contextmenu-toggler-left:after {\n      border-right: 8px solid #ffffff; }\n  .m-contextmenu > .m-contextmenu-item:not(:first-child) {\n    border-left: 1px solid rgba(255, 255, 255, 0.4); }\n\n.m-contextmenu-angel {\n  position: fixed;\n  border: 6px solid #41464b;\n  opacity: 0.9;\n  border-width: 6px;\n  border-left-color: transparent;\n  border-right-color: transparent; }\n  .m-contextmenu-angel.up-angel {\n    border-bottom: none; }\n  .m-contextmenu-angel.down-angel {\n    border-top: none; }\n",""])},24:function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var o=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(r),i=r.sources.map(function(t){return"/*# sourceURL="+r.sourceRoot+t+" */"});return[n].concat(i).concat([o]).join("\n")}return[n].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+n+"}":n}).join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},25:function(t,e,n){var r={},o=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),i=function(t){var e={};return function(t){if("function"==typeof t)return t();if(void 0===e[t]){var n=function(t){return document.querySelector(t)}.call(this,t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),a=null,c=0,s=[],u=n(91);function l(t,e){for(var n=0;n<t.length;n++){var o=t[n],i=r[o.id];if(i){i.refs++;for(var a=0;a<i.parts.length;a++)i.parts[a](o.parts[a]);for(;a<o.parts.length;a++)i.parts.push(y(o.parts[a],e))}else{var c=[];for(a=0;a<o.parts.length;a++)c.push(y(o.parts[a],e));r[o.id]={id:o.id,refs:1,parts:c}}}}function p(t,e){for(var n=[],r={},o=0;o<t.length;o++){var i=t[o],a=e.base?i[0]+e.base:i[0],c={css:i[1],media:i[2],sourceMap:i[3]};r[a]?r[a].parts.push(c):n.push(r[a]={id:a,parts:[c]})}return n}function f(t,e){var n=i(t.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=s[s.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),s.push(e);else if("bottom"===t.insertAt)n.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=i(t.insertInto+" "+t.insertAt.before);n.insertBefore(e,o)}}function d(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=s.indexOf(t);e>=0&&s.splice(e,1)}function h(t){var e=document.createElement("style");return t.attrs.type="text/css",_(e,t.attrs),f(t,e),e}function _(t,e){Object.keys(e).forEach(function(n){t.setAttribute(n,e[n])})}function y(t,e){var n,r,o,i;if(e.transform&&t.css){if(!(i=e.transform(t.css)))return function(){};t.css=i}if(e.singleton){var s=c++;n=a||(a=h(e)),r=g.bind(null,n,s,!1),o=g.bind(null,n,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",_(e,t.attrs),f(t,e),e}(e),r=function(t,e,n){var r=n.css,o=n.sourceMap,i=void 0===e.convertToAbsoluteUrls&&o;(e.convertToAbsoluteUrls||i)&&(r=u(r));o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var a=new Blob([r],{type:"text/css"}),c=t.href;t.href=URL.createObjectURL(a),c&&URL.revokeObjectURL(c)}.bind(null,n,e),o=function(){d(n),n.href&&URL.revokeObjectURL(n.href)}):(n=h(e),r=function(t,e){var n=e.css,r=e.media;r&&t.setAttribute("media",r);if(t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}.bind(null,n),o=function(){d(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=o()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var n=p(t,e);return l(n,e),function(t){for(var o=[],i=0;i<n.length;i++){var a=n[i];(c=r[a.id]).refs--,o.push(c)}t&&l(p(t,e),e);for(i=0;i<o.length;i++){var c;if(0===(c=o[i]).refs){for(var s=0;s<c.parts.length;s++)c.parts[s]();delete r[c.id]}}}};var m=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}();function g(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=m(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}},26:function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(n=window)}t.exports=n},28:function(t,e){t.exports=function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}},29:function(t,e,n){var r=n(63),o="[object Arguments]",i=Object.prototype,a=i.hasOwnProperty,c=i.toString,s=i.propertyIsEnumerable;t.exports=function(t){return r(t)&&a.call(t,"callee")&&(!s.call(t,"callee")||c.call(t)==o)}},3:function(t,e){t.exports=ReactDOM},30:function(t,e,n){var r=n(22),o=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-o?"-0":e}},31:function(t,e,n){var r=n(103),o=n(110),i=n(112),a=n(113),c=n(114);function s(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}s.prototype.clear=r,s.prototype.delete=o,s.prototype.get=i,s.prototype.has=a,s.prototype.set=c,t.exports=s},314:function(t,e,n){var r=n(147),o=n(6),i="Expected a function";t.exports=function(t,e,n){var a=!0,c=!0;if("function"!=typeof t)throw new TypeError(i);return o(n)&&(a="leading"in n?!!n.leading:a,c="trailing"in n?!!n.trailing:c),r(t,e,{leading:a,maxWait:e,trailing:c})}},32:function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},323:function(t,e,n){"use strict";var r;!function(t){t.HideToolbar="HideToolbar",t.ToggleTabContent="ToggleTabContent",t.ShowFormulaPanel="ShowFormulaPanel",t.SetActiveTabIndex="SetActiveTabIndex"}(r||(r={})),e.a=r},33:function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},34:function(t,e){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){return!!(e=null==e?n:e)&&("number"==typeof t||r.test(t))&&t>-1&&t%1==0&&t<e}},36:function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},37:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.assertNever=function(t){throw new Error("unexpected type: "+JSON.stringify(t))}},38:function(t,e,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};Object.defineProperty(e,"__esModule",{value:!0});var o=n(18);e.interweave=function(t,e){return t.map(function(n,r){return r===t.length-1?n:""+n+e[r]}).join("")},e.getTextResult=function(t,e){return e&&e[t]};var i=/%(s|\d)/g;e.getInterpolateResult=function(t,e,n){try{if(!n)return;var a=o.sourceTextToKey({type:"interpolated",textParts:t}),c=n[a];if(!c)return;var s={},u=0;a.replace(i,function(t){return s[t]=e[u],u+=1,t});return"string"==typeof c?function(t,e){return t.replace(i,function(n){return null!==e[n]?String(e[n]):(console.warn("[s18n] interpolation failed:",{str:t,valueMap:e}),n)})}(c,s):"object"===(void 0===c?"undefined":r(c))?void 0:void console.warn("[s18n] Unexpected value: "+JSON.stringify(c))}catch(r){var l={parts:t,values:e,resource:n};return console.error("[s18n] error when translating: ",l),void console.error(r)}}},39:function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},4:function(t,e,n){(function(t,r){var o=n(87),i={function:!0,object:!0},a=i[typeof e]&&e&&!e.nodeType?e:void 0,c=i[typeof t]&&t&&!t.nodeType?t:void 0,s=o(a&&c&&"object"==typeof r&&r),u=o(i[typeof self]&&self),l=o(i[typeof window]&&window),p=o(i[typeof this]&&this),f=s||l!==(p&&p.window)&&l||u||p||Function("return this")();t.exports=f}).call(e,n(32)(t),n(26))},40:function(t,e,n){var r=n(8)(n(4),"Map");t.exports=r},41:function(t,e,n){var r=n(54),o=Object.prototype.hasOwnProperty;t.exports=function(t,e){return o.call(t,e)||"object"==typeof t&&e in t&&null===r(t)}},42:function(t,e,n){var r=n(88),o=n(40),i=n(89),a=n(69),c=n(90),s=n(39),u=Object.prototype.toString,l=s(r),p=s(o),f=s(i),d=s(a),h=s(c);function _(t){return u.call(t)}(r&&"[object DataView]"!=_(new r(new ArrayBuffer(1)))||o&&"[object Map]"!=_(new o)||i&&"[object Promise]"!=_(i.resolve())||a&&"[object Set]"!=_(new a)||c&&"[object WeakMap]"!=_(new c))&&(_=function(t){var e=u.call(t),n="[object Object]"==e?t.constructor:void 0,r=n?s(n):void 0;if(r)switch(r){case l:return"[object DataView]";case p:return"[object Map]";case f:return"[object Promise]";case d:return"[object Set]";case h:return"[object WeakMap]"}return e}),t.exports=_},44:function(t,e,n){var r=n(5),o=n(10),i="[object String]",a=Object.prototype.toString;t.exports=function(t){return"string"==typeof t||!r(t)&&o(t)&&a.call(t)==i}},448:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.render=function(){var t=this.props.className,e="m-menu-group-wrapper"+(t?" "+t:"");return o.a.createElement("div",{className:e},this.props.children)},e}(o.a.Component);e.a=a},45:function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},452:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.render=function(){var t=this.props.checked;return o.a.createElement("input",{checked:t,onChange:this.props.onChange,type:"checkbox",className:"m-toggle-button"})},e}(o.a.Component);e.a=a},453:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(62),a=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=[["#0d0115","#ff2910","#ff9a00","#ffdb00","#a2e232","#27d9f2","#48a7f1","#ab30d3"],["#ffffff","#fddbd5","#feeacf","#fff1cd","#d3e9d5","#ddf3f3","#cee0f0","#dfdaed"],["#f7f7f7","#ececed","#d9dadb","#c6c7c9","#a0a2a5","#676b6f","#41464b","#2c3033"]],s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return a(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.selectedColor,r=e.colors,a=e.disabled;return(r||c).map(function(e,r){return o.a.createElement(i.a,{disabled:a,key:r,className:"m-color-group"},e.map(function(e,r){return o.a.createElement("div",{key:r,onClick:function(){return t.__onClick(e)},className:"m-color-item-wrapper"+(n&&n===e?" m-color-item-selected":"")},o.a.createElement("span",{className:"m-color-item-bg",style:{background:""+e}}))}))})},e.prototype.__onClick=function(t){this.props.onSelect&&this.props.onSelect(t)},e}(o.a.Component);e.a=s},46:function(t,e,n){var r=n(13),o=n(98),i=n(99),a=n(100),c=n(101),s=n(102);function u(t){this.__data__=new r(t)}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=c,u.prototype.set=s,t.exports=u},47:function(t,e,n){var r=n(4).Symbol;t.exports=r},48:function(t,e){t.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,r){n[++e]=[r,t]}),n}},49:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.__onClick=function(t){e.props.onClick&&e.props.onClick(t)},e}return i(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.icon,r=e.text;return o.a.createElement("span",{onClick:function(e){return t.__onClick(e)},key:"icon",className:this.__getClassName()},n&&o.a.createElement("i",{className:"icon-"+n}),r&&o.a.createElement("span",null,r))},e.prototype.__getClassName=function(){var t=this.props,e=t.icon,n=t.text,r=t.selected,o=t.disabled,i=t.hasTapBtn;return(n&&e?"m-icon-text-button":n?"m-text-button":"m-icon-button")+(r?" m-menu-selected":"")+(o?" m-menu-disabled":"")+(i?" m-menu-btn":"")},e}(o.a.Component);e.a=a},5:function(t,e){var n=Array.isArray;t.exports=n},50:function(t,e,n){"use strict";n.d(e,"a",function(){return l});var r=n(0),o=n.n(r),i=n(161),a=n.n(i),c=n(162),s=n.n(c),u=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=!1,e.permissionUpdateKeys=["canEditRange"],e.reRender=function(){e.forceUpdate()},e}return u(e,t),e.prototype.shouldComponentUpdate=function(t,e){return e!==this.state||(!0===this.selectionUpdateKeys||(!1!==this.selectionUpdateKeys&&!a()(s()(t.selection,this.selectionUpdateKeys),s()(this.props.selection,this.selectionUpdateKeys))||(!a()(s()(t.permission,this.permissionUpdateKeys),s()(this.props.permission,this.permissionUpdateKeys))||!a()(t.isEditing,this.props.isEditing))))},e}(o.a.Component)},511:function(t,e,n){var r=n(141);t.exports=function(t){return t&&t.length?r(t,1):[]}},54:function(t,e){var n=Object.getPrototypeOf;t.exports=function(t){return n(Object(t))}},55:function(t,e){t.exports=function(t){return function(e){return null==e?void 0:e[t]}}},57:function(t,e,n){var r=n(76),o=n(127),i=1,a=2;t.exports=function(t,e,n,c,s,u){var l=s&a,p=t.length,f=e.length;if(p!=f&&!(l&&f>p))return!1;var d=u.get(t);if(d)return d==e;var h=-1,_=!0,y=s&i?new r:void 0;for(u.set(t,e);++h<p;){var m=t[h],g=e[h];if(c)var v=l?c(g,m,h,e,t,u):c(m,g,h,t,e,u);if(void 0!==v){if(v)continue;_=!1;break}if(y){if(!o(e,function(t,e){if(!y.has(e)&&(m===t||n(m,t,c,s,u)))return y.add(e)})){_=!1;break}}else if(m!==g&&!n(m,g,c,s,u)){_=!1;break}}return u.delete(t),_}},6:function(t,e){t.exports=function(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}},61:function(t,e,n){var r=n(19),o=n(6),i=n(22),a=NaN,c=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,l=/^0o[0-7]+$/i,p=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(i(t))return a;if(o(t)){var e=r(t.valueOf)?t.valueOf():t;t=o(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(c,"");var n=u.test(t);return n||l.test(t)?p(t.slice(2),n?2:8):s.test(t)?a:+t}},62:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.render=function(){var t=this,e=this.props,n=e.disabled,r=e.className,i="m-menu-group-item"+(r?" "+r:"")+(n?" m-menu-disabled":"");return o.a.createElement("div",{className:i,onClick:function(){return t.__onClick()}},this.props.children)},e.prototype.__onClick=function(){this.props.onClick&&this.props.onClick()},e}(o.a.Component);e.a=a},63:function(t,e,n){var r=n(17),o=n(10);t.exports=function(t){return o(t)&&r(t)}},65:function(t,e){t.exports=function(t,e,n,r){var o=-1,i=t.length;for(r&&i&&(n=t[++o]);++o<i;)n=e(n,t[o],o,t);return n}},66:function(t,e,n){var r=n(126),o=n(6),i=n(10);t.exports=function t(e,n,a,c,s){return e===n||(null==e||null==n||!o(e)&&!i(n)?e!=e&&n!=n:r(e,n,t,a,c,s))}},67:function(t,e,n){var r=n(4).Uint8Array;t.exports=r},68:function(t,e,n){var r=n(82),o=n(29),i=n(5),a=n(20),c=n(44);t.exports=function(t){var e=t?t.length:void 0;return a(e)&&(i(t)||c(t)||o(t))?r(e,String):null}},69:function(t,e,n){var r=n(8)(n(4),"Set");t.exports=r},702:function(t,e,n){"use strict";n.d(e,"d",function(){return R}),e.a=function(t,e){return t.reduce(function(t,n,r){if(n instanceof Array){var i=n.filter(function(t){return"string"!=typeof t});i.length&&t.push(o.a.createElement(k.a,{key:r},i.filter(function(t){return"string"!=typeof t}).map(function(t,n){return o.a.createElement(t,A(A({},e),{key:n}))})))}else"string"!=typeof n&&t.push(o.a.createElement(n,A(A({},e),{key:r})));return t},[])},e.c=function(t,e){if(e.getMobileMenuConfig)for(var n=e.getMobileMenuConfig().component,r=0;r<R.length;r++)for(var o=R[r].components,i=0;i<o.length;i++){var a=o[i];if(a instanceof Array){var c=a.findIndex(function(e){return e===t});c>-1&&(a[c]=n)}else a===t&&(o[i]=n)}},e.b=function(){var t=[];return R.forEach(function(e){var n=e.components,r=T()(n).filter(function(t){return"string"==typeof t});t.push.apply(t,r)}),t};var r=n(0),o=n.n(r),i=n(920),a=n(921),c=n(922),s=n(923),u=n(925),l=n(926),p=n(927),f=n(928),d=n(929),h=n(930),_=n(931),y=n(932),m=n(933),g=n(934),v=n(935),b=n(936),w=n(937),x=n(938),C=n(939),S=n(940),O=n(941),j=n(942),E=n(943),P=n(511),T=n.n(P),k=n(75),A=this&&this.__assign||function(){return(A=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},R=[{icon:"text",components:[i.a,a.a,l.a,s.a,c.a,u.a]},{icon:"cell",components:[p.a,f.a,d.a,_.a,y.a,h.a]},{icon:"row-col",components:[m.a,g.a,v.a,b.a]},{icon:"insert",components:[w.a,["MentionPlugin"],[x.a,"Attachment"],S.a,C.a,["Comment","Remarks"]]},{icon:"view",components:[["FilterViewport"],E.a,["HighlightPosition",O.a,j.a]]}]},73:function(t,e,n){var r=n(55)("length");t.exports=r},74:function(t,e){t.exports=function(t,e){for(var n=-1,r=t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}},75:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.render=function(){var t=this.props.className,e="m-menu-group"+(t?" "+t:"")+(this.props.flex?" m-menu-group-flex":"");return o.a.createElement("div",{className:e},this.props.children)},e}(o.a.Component);e.a=a},76:function(t,e,n){var r=n(31),o=n(120),i=n(121);function a(t){var e=-1,n=t?t.length:0;for(this.__data__=new r;++e<n;)this.add(t[e])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,t.exports=a},78:function(t,e,n){var r=n(131),o=n(116),i="Expected a function",a=Math.max;t.exports=function(t,e){if("function"!=typeof t)throw new TypeError(i);return e=a(void 0===e?t.length-1:o(e),0),function(){for(var n=arguments,o=-1,i=a(n.length-e,0),c=Array(i);++o<i;)c[o]=n[e+o];switch(e){case 0:return t.call(this,c);case 1:return t.call(this,n[0],c);case 2:return t.call(this,n[0],n[1],c)}var s=Array(e+1);for(o=-1;++o<e;)s[o]=n[o];return s[e]=c,r(t,this,s)}}},8:function(t,e,n){var r=n(86);t.exports=function(t,e){var n=t[e];return r(n)?n:void 0}},81:function(t,e){var n=Object.keys;t.exports=function(t){return n(Object(t))}},82:function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},86:function(t,e,n){var r=n(19),o=n(28),i=n(6),a=n(39),c=/^\[object .+?Constructor\]$/,s=Object.prototype,u=Function.prototype.toString,l=s.hasOwnProperty,p=RegExp("^"+u.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!!i(t)&&(r(t)||o(t)?p:c).test(a(t))}},87:function(t,e){t.exports=function(t){return t&&t.Object===Object?t:null}},88:function(t,e,n){var r=n(8)(n(4),"DataView");t.exports=r},89:function(t,e,n){var r=n(8)(n(4),"Promise");t.exports=r},90:function(t,e,n){var r=n(8)(n(4),"WeakMap");t.exports=r},91:function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var n=e.protocol+"//"+e.host,r=n+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var o,i=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?t:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},919:function(t,e,n){"use strict";n.d(e,"a",function(){return r});var r,o=n(0),i=n.n(o),a=n(702),c=n(2),s=(n.n(c),n(323)),u=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=this&&this.__assign||function(){return(l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},p=c.sheets.Core,f=c.sheets.Events,d=p.Spread.Sheets.Events,h=d.EditStarted,_=d.CellClick;!function(t){t[t.None=-1]="None",t[t.Text=0]="Text",t[t.Cell=1]="Cell",t[t.RowCol=2]="RowCol",t[t.Insert=3]="Insert",t[t.View=4]="View"}(r||(r={}));var y=function(t){function e(e){var n=t.call(this,e)||this;return n.isToolbarHidden=!1,n.scrollTopMap={},n.__toggleSelectedTab=function(t){var e,r=n.state.currentTabIndex,o=t!==r||!n.state.showTabContent,i=n.refs.tabContent;Object.assign(n.scrollTopMap,((e={})[r]=i.scrollTop,e)),n.setState({currentTabIndex:t,showTabContent:o},function(){o&&(i.scrollTop=n.scrollTopMap[t]||0)}),n.props.emitter.emit(s.a.ToggleTabContent,{isShow:o})},n.__showTabHeader=function(){var t=n.props.editor.spread.gcSpread.getActiveSheet();n.isToolbarHidden=!1,t.isEditing()||n.setState({showTabHeader:!0})},n.__onKeyBoardToggle=function(t){if(t){var e=n.props.editor.spread.gcSpread.getActiveSheet();n.isToolbarHidden||e.isEditing()||n.setState({showTabHeader:!0})}},n.__hideTabPanel=function(t){t&&t.isToolbarHidden&&(n.isToolbarHidden=!0),n.setState({showTabHeader:!1,showTabContent:!1})},n.__toggleTabContent=function(t){var e=t.isShow;n.setState({showTabContent:e})},n.__setActiveTabIndex=function(t){n.setState({showTabHeader:!0,showTabContent:!0,currentTabIndex:t})},n.state={currentTabIndex:r.None,showTabHeader:!0,showTabContent:!1},n}return u(e,t),e.prototype.componentDidMount=function(){this.props.emitter.on(s.a.HideToolbar,this.__hideTabPanel),this.props.emitter.on(s.a.ToggleTabContent,this.__toggleTabContent),this.props.emitter.on(s.a.SetActiveTabIndex,this.__setActiveTabIndex),this.props.editor.on(f.ToggleMobileKeyboard,this.__onKeyBoardToggle);var t=this.props.editor.spread.gcSpread;t.bind(h,this.__hideTabPanel),t.bind(_,this.__showTabHeader)},e.prototype.componentWillUnmount=function(){this.props.emitter.off(s.a.HideToolbar,this.__hideTabPanel),this.props.emitter.off(s.a.ToggleTabContent,this.__toggleTabContent),this.props.emitter.off(s.a.SetActiveTabIndex,this.__setActiveTabIndex),this.props.editor.off(f.ToggleMobileKeyboard,this.__onKeyBoardToggle);var t=this.props.editor.spread.gcSpread;t.unbind(h,this.__hideTabPanel),t.unbind(_,this.__showTabHeader)},e.prototype.render=function(){var t=this,e=this.state,n=e.showTabHeader,r=e.currentTabIndex,o=e.showTabContent;return i.a.createElement("div",{ref:"tabPanel",className:"m-tab-panel"+(o?"":" hide-tab-content")},i.a.createElement("div",{className:"m-tab-header"+(n?"":" hide-tab-header")},a.d.map(function(e,n){return i.a.createElement("span",{key:n,className:"m-tab-icon m-icon",onClick:function(){return t.__toggleSelectedTab(n)}},i.a.createElement("i",{className:"icon-"+e.icon}))})),o&&this.tabSelected,i.a.createElement("div",{className:"m-tab-content",ref:"tabContent"},a.d.map(function(e,n){return i.a.createElement("div",{className:"m-tab-wrapper",key:n},n===r&&Object(a.a)(e.components,l({},t.props)))})))},Object.defineProperty(e.prototype,"tabSelected",{get:function(){var t=this.state.currentTabIndex,e=1/a.d.length*100+"%";return i.a.createElement("div",{className:"m-tab-selected",style:{width:e,transform:"translateX("+100*t+"%)"}},i.a.createElement("span",{className:"selected-flag"}))},enumerable:!0,configurable:!0}),e}(i.a.Component);e.b=y},92:function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},920:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(75),c=n(448),s=n(155),u=n(50),l=n(2),p=(n.n(l),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),f=l.sheets.track,d=Object(s.a)(),h=d.vAlign,_=d.hAlign,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["align","vertical"],e.__setTextAlign=function(t,n){var r=e.props.editor.spread.getActiveSheet();"vertical"===n&&"middle"===t&&(t=null),f(2,"align"===n?"18008":"18009"),r.actions.setStyle(r.gcSheet,r.getGcSelections(),n,t)},e}return p(e,t),Object.defineProperty(e.prototype,"HAlign",{get:function(){var t=this;return o.a.createElement(a.a,{flex:!0},_.map(function(e,n){return o.a.createElement(i.a,{selected:e.value===t.props.selection.align,onClick:function(){return t.__setTextAlign(e.value,"align")},key:n,icon:e.icon,disabled:!t.props.permission.canEditRange})}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"VAlign",{get:function(){var t=this;return o.a.createElement(a.a,{flex:!0},h.map(function(e,n){return o.a.createElement(i.a,{selected:e.value===t.props.selection.vertical,onClick:function(){return t.__setTextAlign(e.value,"vertical")},key:n,icon:e.icon,disabled:!t.props.permission.canEditRange})}))},enumerable:!0,configurable:!0}),e.prototype.render=function(){return o.a.createElement(c.a,null,this.HAlign,this.VAlign)},e}(u.a);e.a=y},921:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(75),c=n(155),s=n(50),u=n(2),l=(n.n(u),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),p=u.sheets.track,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["boldSelected","italicSelected","underlineSelected","strikeThroughSelected"],e.__isSelected=function(t){return!!e.props.selection[t]},e.__setBius=function(t){p(2,"18010");var n=e.props.editor.spread.getActiveSheet(),r=!e.props.selection[t.selectedKey];n.actions.setStyle(n.gcSheet,n.getGcSelections(),t.key,r)},e}return l(e,t),e.prototype.render=function(){var t=this,e=Object(c.a)().bius;return o.a.createElement(a.a,{flex:!0},e.map(function(e,n){return o.a.createElement(i.a,{onClick:function(){return t.__setBius(e)},selected:t.__isSelected(e.selectedKey),key:n,icon:e.icon,disabled:!t.props.permission.canEditRange})}))},e}(s.a);e.a=f},922:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(75),c=n(155),s=n(50),u=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.render=function(){var t=this,e=Object(c.a)().clear;return o.a.createElement(a.a,{flex:!0},e.map(function(e,n){return o.a.createElement(i.a,{disabled:!t.props.permission.canEditRange,onClick:function(){return t.__clear(e.type)},key:n,text:e.text})}))},e.prototype.__clear=function(t){var e=this.props.editor.spread.getActiveSheet(),n=e.getGcSelections();0!==n.length&&("content"===t?e.actions.doDelete(e.gcSheet):e.clearFormat(n,"style"===t))},e}(s.a);e.a=l},923:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(75),a=n(924),c=n(155),s=n(50),u=n(2),l=(n.n(u),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),p=Object(c.a)().fontSize,f=u.sheets.menu,d=u.sheets.track,h=f.getMenuModel,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["fontSize"],e.__changeFontSize=function(t){d(2,"18012");var n=e.props.editor.spread.getActiveSheet();n.actions.setStyle(n.gcSheet,n.getGcSelections(),"font-size",t===h().menuDefault.fontSize?null:t)},e}return l(e,t),e.prototype.render=function(){return o.a.createElement(i.a,null,o.a.createElement(a.a,{disabled:!this.props.permission.canEditRange,onChange:this.__changeFontSize,items:p,selectedValue:this.props.selection.fontSize}))},e}(s.a);e.a=_},924:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=5,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.updateSliderPosition=function(){var t=e.props,n=t.items,r=t.selectedValue,o=e.refs.slider,i=n.findIndex(function(t){return t.value===r});i<=-1||!o||(i<=1?o.scrollLeft=0:i>=n.length-3?o.scrollLeft=o.scrollWidth-o.offsetWidth:o.scrollLeft=o.offsetWidth/a*(i-2))},e}return i(e,t),e.prototype.componentDidMount=function(){this.updateSliderPosition()},e.prototype.componentDidUpdate=function(){this.updateSliderPosition()},e.prototype.render=function(){var t=this,e=this.props,n=e.items,r=e.selectedValue,i=e.disabled;return o.a.createElement("div",{className:"m-slider-wrapper"+(i?" m-slider-disabled":"")},o.a.createElement("div",{className:"m-slider-minus",onClick:function(){return t.__scroll("right")}},o.a.createElement("i",{className:"icon-arrow-right"})),o.a.createElement("div",{className:"m-slider-list-wrapper",ref:"slider"},n.map(function(e,n){return o.a.createElement("span",{className:"m-slider-list"+(r===e.value?" m-slider-selected":""),key:n,onClick:function(){return t.props.onChange(e.value)}},e.text)})),o.a.createElement("div",{className:"m-slider-add",onClick:function(){return t.__scroll("left")}},o.a.createElement("i",{className:"icon-arrow-right"})))},e.prototype.__scroll=function(t){var e=this.refs.slider,n=e.offsetWidth/a,r=Math.round(e.scrollLeft/n);"left"===t&&r===this.props.items.length-a||"right"===t&&0===r||(e.scrollLeft=(r+("left"===t?1:-1))*n)},e}(o.a.Component);e.a=c},925:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(75),a=n(62),c=n(50),s=n(2),u=(n.n(s),n(1)),l=n.n(u),p=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=s.sheets.menu,d=s.sheets.font,h=s.sheets.track,_=f.getMenuModel,y=d.getFontsLoadMonitor,m=d.getFontManager,g=d.getFontDownloader,v=d.FontLoadEvents,b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["fontFamily"],e.permissionUpdateKeys=["canEditRange"],e}return p(e,t),e.prototype.componentDidMount=function(){g().on(v.FontLoadSucceed,this.reRender)},e.prototype.render=function(){var t=this,e=this.fontStatus,n=this.props.permission.canEditRange;return o.a.createElement(i.a,{className:"m-font-family"},_().menuItems["font-family"].map(function(r,i){var c=e[r.key],s=!r.value||c.isEnable,u=r.detectFontFamily===t.props.selection.fontFamily;return o.a.createElement(a.a,{key:i,disabled:!s||!n,onClick:function(){return t.__changeFontFamily(r.value)}},r.displayText?o.a.createElement("span",{className:"m-font-display-text"},r.display):o.a.createElement("span",{className:"m-font-img icon-"+r.key}),u&&o.a.createElement("i",{className:"icon-checked"}),!s&&(r.supportDownload?o.a.createElement("span",{onClick:function(e){return t.__downloadFont(e,r.value)},className:"font-download-status"},c.isLoading?l()("下载中"):l()("下载")):o.a.createElement("span",{className:"no-font"},l()("系统暂无此字体"))))}))},Object.defineProperty(e.prototype,"fontStatus",{get:function(){var t=_().menuItems["font-family"],e=m(),n={};return t.forEach(function(t){if(t.value){var r=e.getFontInfo(t.value);n[t.key]={isLoading:!!r&&r.isLoading,isEnable:!!r&&r.isEnable}}}),n},enumerable:!0,configurable:!0}),e.prototype.__downloadFont=function(t,e){t.stopPropagation(),y().queueLoadFonts(e),this.forceUpdate()},e.prototype.__changeFontFamily=function(t){h(2,"18013");var e=this.props.editor.spread.getActiveSheet(),n=t===_().menuDefault.fontFamily;e.actions.setStyle(e.gcSheet,e.getGcSelections(),"font-family",n?null:t)},e}(c.a);e.a=b},926:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(75),a=n(453),c=n(50),s=n(2),u=(n.n(s),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),l=s.sheets.track,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["color"],e.__onSelect=function(t){l(2,"18011");var n=e.props.editor.spread.getActiveSheet();n.actions.setStyle(n.gcSheet,n.getGcSelections(),"color",t)},e}return u(e,t),e.prototype.render=function(){return o.a.createElement(i.a,null,o.a.createElement(a.a,{disabled:!this.props.permission.canEditRange,onSelect:this.__onSelect,selectedColor:this.props.selection.color}))},e}(c.a);e.a=p},927:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(75),a=n(453),c=n(50),s=n(2),u=(n.n(s),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),l=s.sheets.track,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["background"],e.__onSelect=function(t){l(2,"18014");var n=e.props.editor.spread.getActiveSheet();n.actions.setStyle(n.gcSheet,n.getGcSelections(),"background",t)},e}return u(e,t),e.prototype.render=function(){return o.a.createElement(i.a,null,o.a.createElement(a.a,{disabled:!this.props.permission.canEditRange,onSelect:this.__onSelect,selectedColor:this.props.selection.background}))},e}(c.a);e.a=p},928:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(75),c=n(155),s=n(50),u=n(2),l=(n.n(u),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),p=u.sheets.track,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["wrap"],e}return l(e,t),e.prototype.render=function(){var t=this,e=Object(c.a)().wrap;return o.a.createElement(a.a,{flex:!0},e.map(function(e,n){return o.a.createElement(i.a,{selected:e.type===t.props.selection.wrap,onClick:function(){return t.__setWrap(e.type)},key:n,icon:e.icon,disabled:!t.props.permission.canEditRange})}))},e.prototype.__setWrap=function(t){p(2,"18015");var e=this.props.editor.spread.getActiveSheet();e.actions.setStyle(e.gcSheet,e.getGcSelections(),"wrap","text-no-wrap"===t?null:t)},e}(s.a);e.a=f},929:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(155),c=n(75),s=n(62),u=n(50),l=n(2),p=(n.n(l),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},d=l.sheets.menu.getMenuModel,h=l.sheets.track,_=Object(a.a)().border,y=d().menuDefault,m=y.borderColor,g=y.borderStyle,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectedBorderType="",e.selectedBorderStyle="",e.__isSelected=function(t){return t.type?t.type===e.selectedBorderType:t.value===e.selectedBorderStyle},e.__changeBorder=function(t){var n,r=e.props.editor.spread.getActiveSheet(),o=r.getGcSelections();h(2,"18016"),t.type?(e.selectedBorderType=t.type,n=[t.type,m,e.selectedBorderStyle||g]):(e.selectedBorderStyle=t.value,e.selectedBorderType&&(n=[e.selectedBorderType,m,e.selectedBorderStyle])),e.forceUpdate(),n&&r.actions.setBorder(r.gcSheet,o,n)},e}return p(e,t),e.prototype.render=function(){var t=this;return o.a.createElement(c.a,{className:"m-menu-border"},_.map(function(e,n){return o.a.createElement(s.a,{key:n,disabled:!t.props.permission.canEditRange},e.map(function(e,n){return o.a.createElement(i.a,f({selected:t.__isSelected(e),onClick:function(){return t.__changeBorder(e)},key:n},e))}))}))},e}(u.a);e.a=v},93:function(t,e){t.exports=function(){this.__data__=[]}},930:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(62),c=n(75),s=n(50),u=n(2),l=(n.n(u),n(1)),p=n.n(l),f=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=u.sheets,h=d.menu,_=d.track,y=h.getMenuModel,m=h.getFormatMenuItems,g=function(t){function e(e){var n=t.call(this,e)||this;return n.selectionUpdateKeys=["format"],n.state={showFormatterList:!1},n}return f(e,t),e.prototype.render=function(){var t=this,e=this.state.showFormatterList;return o.a.createElement(c.a,null,o.a.createElement(a.a,{disabled:!this.props.permission.canEditRange,className:"m-formatter-btn"+(e?" show-formatter-list":""),onClick:function(){return t.__toggleFormatterItems()}},o.a.createElement(i.a,{icon:"format",text:p()("数据格式"),hasTapBtn:!0}),this.FormatBtn),this.state.showFormatterList&&this.FormatterList)},Object.defineProperty(e.prototype,"FormatBtn",{get:function(){return o.a.createElement("span",{className:"m-format-toggler"},o.a.createElement("span",null,this.formatCategory),o.a.createElement("i",{className:"icon-arrow-right"+(this.state.showFormatterList?" show-list":"")}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"FormatterList",{get:function(){var t=this;return this.formatItems.map(function(e,n){var r=e.value===(t.props.selection.format||"General");return o.a.createElement("div",{key:n,className:"m-formatter-list",onClick:function(){return t.__setFormat(e)}},o.a.createElement("i",{className:r?"icon-checked":""}),o.a.createElement("span",{className:"m-formatter-list-item"},o.a.createElement("span",{className:"m-formatter-list-item-label"},e.label),o.a.createElement("span",{className:"m-formatter-list-item-display"},e.display)))})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatCategory",{get:function(){var t=y().formatCategories,e="";for(var n in t)if(-1!==t[n].values.indexOf(this.props.selection.format)){e=t[n].name;break}return e||p()("自定义")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formatItems",{get:function(){if(!this.props.editor.spread)return y().menuItems.format;var t=this.props.editor.spread.getActiveSheet(),e=this.props.selection.selectedCell,n=e.activeRow,r=e.activeCol,o=m(n,r,t.gcSheet);return o.pop(),o},enumerable:!0,configurable:!0}),e.prototype.__toggleFormatterItems=function(){this.setState({showFormatterList:!this.state.showFormatterList})},e.prototype.__setFormat=function(t){_(2,"18020");var e={format:t.value,precision:t.precision||null};"General"===e.format&&(e.autoFormatter=null);var n=this.props.editor.spread.getActiveSheet();n.actions.setBulkStyle(n.gcSheet,n.getGcSelections(),e)},e}(s.a);e.a=g},931:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(155),c=n(75),s=n(62),u=n(50),l=n(2),p=(n.n(l),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},d=l.sheets.track,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["selectionIsMergedCells","hasPivotTableInRange"],e}return p(e,t),e.prototype.render=function(){var t=this,e=this.props.selection.hasPivotTableInRange,n=this.props.permission.canEditRange,r=Object(a.a)().merge;return o.a.createElement(c.a,null,r.map(function(r,a){return o.a.createElement(s.a,{key:a},o.a.createElement(i.a,f({disabled:!n||e,onClick:function(){return t.__mergeOrUnMerge(r.type)}},r)))}))},e.prototype.__mergeOrUnMerge=function(t){d(2,"merge"===t?"18017":"18018");var e=this.props.editor.spread.getActiveSheet(),n="merge"===t?"all":"unMerge";e.actions.mergeOrUnmergeCells(n)},e}(u.a);e.a=h},932:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(155),a=n(75),c=n(49),s=n(62),u=n(50),l=n(448),p=n(2),f=(n.n(p),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),d=this&&this.__assign||function(){return(d=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},h=p.sheets.track,_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f(e,t),e.prototype.render=function(){var t=this,e=Object(i.a)().insertDeleteCells;return o.a.createElement(l.a,null,e.map(function(e,n){return o.a.createElement(a.a,{key:n},e.map(function(e,n){return o.a.createElement(s.a,{key:n},o.a.createElement(c.a,d({onClick:function(){return t.__insertOrDeleteCells(e.direction)},disabled:!t.props.permission.canEditRange},e)))}))}))},e.prototype.__insertOrDeleteCells=function(t){var e=this.props.editor.spread.getActiveSheet();h(2,"18019"),"right"===t||"down"===t?e.actions.addCells(e,e.getCurSelection(),t):e.actions.deleteCells(e,e.getCurSelection(),t)},e}(u.a);e.a=_},933:function(t,e,n){"use strict";var r,o=n(0),i=n.n(o),a=n(49),c=n(155),s=n(75),u=n(62),l=n(50),p=n(448),f=n(2),d=(n.n(f),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),h=this&&this.__assign||function(){return(h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},_=f.sheets.selection,y=_.getSortSelection,m=_.isValidSortSelection,g=f.sheets.track;!function(t){t.asc="asc",t.desc="desc"}(r||(r={}));var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return d(e,t),e.prototype.render=function(){var t=this,e=Object(c.a)().sort;return i.a.createElement(p.a,null,e.map(function(e,n){return i.a.createElement(s.a,{key:n},i.a.createElement(u.a,{disabled:t.disabled},i.a.createElement(a.a,h({onClick:function(){return t.__doSort(e.type)}},e))))}))},Object.defineProperty(e.prototype,"disabled",{get:function(){var t=this.props.editor.spread.gcSpread.getActiveSheet();return!!t&&!t.isRangeEditable(0,0,t.getRowCount(),t.getColumnCount())},enumerable:!0,configurable:!0}),e.prototype.__doSort=function(t){var e=this.props.editor.spread.getActiveSheet(),n=y(e.gcSheet,!1),r=n.selection,o=n.sortIndex;m(e.gcSheet,r,this.props.editor)&&(g(2,"18021"),e.sort(r,o,t,{skipValidate:!0}))},e}(l.a);e.a=v},934:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(155),c=n(75),s=n(62),u=n(50),l=n(2),p=(n.n(l),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},d=l.sheets.track,h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return p(e,t),e.prototype.render=function(){var t=this;return Object(a.a)().frozen.map(function(e,n){return o.a.createElement(c.a,{key:n},e.map(function(e,n){return o.a.createElement(s.a,{disabled:t.__isFrozenDisabled(e.type),key:n},o.a.createElement(i.a,f({onClick:function(){return t.__setFrozen(e.type)}},e)))}))})},e.prototype.__isFrozenDisabled=function(t){return!this.props.permission.canEditSheet||"cancel"===t&&!this.props.editor.spread.getActiveSheet().isFrozen()},e.prototype.__setFrozen=function(t){d(2,"cancel"===t?"18023":"18022");var e="row"===t?{row:1}:"col"===t?{col:1}:{row:0,col:0};this.props.editor.spread.getActiveSheet().freezeRowOrCol(e),this.forceUpdate()},e}(u.a);e.a=h},935:function(t,e,n){"use strict";var r,o,i,a,c,s,u=n(0),l=n.n(u),p=n(1),f=n.n(p),d=n(49),h=n(155),_=n(75),y=n(62),m=n(50),g=n(2),v=(n.n(g),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),b=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},w=g.sheets.direction.Direction,x=Object(h.a)().insertDeleteRowCol,C=g.sheets.track,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["selectedCell"],e}return v(e,t),e.prototype.render=function(){var t=this;return x.map(function(e,n){return l.a.createElement(_.a,{key:n},e.map(function(e,n){return l.a.createElement(y.a,{disabled:t.__isDisabled("row"===e.type),key:n},l.a.createElement(d.a,{onClick:function(){return t.__insertOrDeleteRowCol(e)},icon:e.icon,text:t.__getIconText(e.icon)}))}))})},e.prototype.__getIconText=function(t){var e=this.__getDisplayCount(),n=e.rowCount,u=e.colCount;switch(t){case"insert-row-up":return f()(r||(r=b(["在上方插入","行"],["在上方插入","行"])),n);case"insert-row-down":return f()(o||(o=b(["在下方插入","行"],["在下方插入","行"])),n);case"delete-row":return f()(i||(i=b(["删除","行"],["删除","行"])),n);case"insert-col-left":return f()(a||(a=b(["在左侧插入","列"],["在左侧插入","列"])),u);case"insert-col-right":return f()(c||(c=b(["在右侧插入","列"],["在右侧插入","列"])),u);case"delete-col":return f()(s||(s=b(["删除","列"],["删除","列"])),u);default:return""}},e.prototype.__getDisplayCount=function(){var t=this.props.editor.spread.getActiveSheet().getCurSelection(),e=t.rowCount,n=void 0===e?1:e,r=t.colCount,o=void 0===r?1:r;return{rowCount:Math.min(100,n),colCount:Math.min(100,o)}},e.prototype.__isDisabled=function(t){var e=this.props.editor.spread.getActiveSheet(),n=e.getCurSelection(),r=n.row,o=n.col,i=n.rowCount,a=n.colCount,c={row:t?r:0,col:t?0:o,rowCount:t?i:e.getRowCount(),colCount:t?e.getColumnCount():a},s=t?i===e.getRowCount():a===e.getColumnCount();return!e.gcSheet.isRangeEditable(c)||s},e.prototype.__insertOrDeleteRowCol=function(t){var e,n,r=this.props.editor.spread.getActiveSheet(),o=t.direction,i=t.type,a=t.isDelete,c="row"===i,s=this.__getDisplayCount(),u=s.rowCount,l=s.colCount,p=c?u:l,f=r.getCurSelection(),d=f.row,h=f.col,_=f.rowCount,y=f.colCount;a?(e=c?d:h,n=c?r.removeRows:r.removeColumns,C(2,c?"18025":"18027")):(e=c?o===w.Up?d:d+_-1:o===w.Left?h:h+y-1,n=c?r.addRows:r.addColumns,C(2,c?"18024":"18026")),n.call(r,e,p,o)},e}(m.a);e.a=S},936:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(155),c=n(75),s=n(62),u=n(50),l=n(2),p=(n.n(l),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},d=l.sheets.track,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["selectedCell"],e}return p(e,t),e.prototype.render=function(){var t=this,e=Object(a.a)().visible;return o.a.createElement(c.a,null,e.map(function(e,n){return o.a.createElement(s.a,{key:n},o.a.createElement(i.a,f({onClick:function(){return t.__hideRowOrCol(e.type)},disabled:t.__disabledHidden(e.type)},e)))}))},e.prototype.__disabledHidden=function(t){var e=this.props.editor.spread.getActiveSheet().gcSheet.getSelections();if(e&&1===e.length){var n=this.props.permission.canEditRange,r=e[0],o=r.row,i=r.col;return"row"===t?!(-1===i&&-1!==o&&n):!(-1===o&&-1!==i&&n)}return!0},e.prototype.__hideRowOrCol=function(t){d(2,"row"===t?"18028":"18029"),this.props.editor.spread.getActiveSheet().hideRowOrCols(t)},e}(u.a);e.a=h},937:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(155),c=n(75),s=n(62),u=n(50),l=n(2),p=(n.n(l),n(1)),f=n.n(p),d=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=this&&this.__assign||function(){return(h=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},_=l.sheets,y=_.utils,m=_.image,g=_.track,v=y.showAlert,b=y.confirm,w=m.uploadImage,x=m.fakeUploadImage,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.permissionUpdateKeys=["canEditRange","canEditSheet"],e.selectionUpdateKeys=!0,e.__uploadImage=function(t){x()(function(n){n.target.files.length>0&&e.__doUpload(n,t)})},e.__doUpload=function(t,n){g(2,"cellImage"===n?"18030":"18031");var r=e.props.editor,o=r.spread.getActiveSheet();o.actions.uploadImage(o.gcSheet,function(){return w(t,r.uploadConfig)},n),e.forceUpdate()},e}return d(e,t),e.prototype.render=function(){var t=this;return o.a.createElement(c.a,null,Object(a.a)().image.map(function(e,n){return o.a.createElement(s.a,{key:n,disabled:t.__disableUploadImage(e.type)},o.a.createElement(i.a,h({onClick:function(){return t.__onBeforeUpload(e.type)}},e)))}))},Object.defineProperty(e.prototype,"cellImageDisabled",{get:function(){return!this.props.permission.canEditRange||this.props.selection.isDateMentionCell||this.props.selection.hasPivotTableInRange},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"floatingImageDisabled",{get:function(){return!this.props.permission.canEditSheet},enumerable:!0,configurable:!0}),e.prototype.__disableUploadImage=function(t){return"cellImage"===t?this.cellImageDisabled:this.floatingImageDisabled},e.prototype.__onBeforeUpload=function(t){var e=this,n=this.props.selection,r=n.selectedCell.cellValue,o=n.isCSEFormulaCell,i=""===r||null==r;o&&"cellImage"===t?v({title:f()("您选择的单元格里包含数组公式，无法上传图片"),type:"error"}):i||"cellImage"!==t?this.__uploadImage(t):b({title:f()("上传图片"),description:f()("上传图片会覆盖单元格中已有的内容，确定上传吗？"),confirmFun:function(){return e.__uploadImage(t)}})},e}(u.a);e.a=C},938:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(62),c=n(50),s=n(2),u=(n.n(s),n(1)),l=n.n(u),p=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),f=s.sheets.cell,d=s.sheets.alert,h=s.sheets.sheet,_=s.sheets.track,y=f.isMentionCell,m=h.getActiveCell,g=d.showAlert,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["isLink","isFormula","isCheckbox","isDateMentionCell","isArrayComputedCell","isPivotTableExcludedCell"],e}return p(e,t),e.prototype.render=function(){var t=this;return o.a.createElement(a.a,null,o.a.createElement(i.a,{onClick:function(){return t.__insertLink()},disabled:this.disabled,icon:"link",text:l()("链接")}))},Object.defineProperty(e.prototype,"disabled",{get:function(){var t=this.props.selection;return!this.props.permission.canEditRange||t.isFormula||t.isCheckbox||t.isDateMentionCell||t.isArrayComputedCell&&!t.isPivotTableExcludedCell},enumerable:!0,configurable:!0}),e.prototype.__insertLink=function(){var t=this.props.editor.spread.getActiveSheet(),e=t.gcSheet.getSelections()[0]||m(t.gcSheet),n=e.row,r=e.col;if(y(t.gcSheet,n,r))return g({title:l()("包含 @ 的单元格不能插入链接"),type:"error"});_(2,"18033"),t.actions.showInsertLinkDialog(t.gcSheet)},e}(c.a);e.a=v},939:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(75),c=n(50),s=n(62),u=n(323),l=n(1),p=n.n(l),f=n(2),d=(n.n(f),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),h=f.sheets.track,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["isLink","isCheckbox","hasPivotTableInRange","isPivotTableExcludedCell"],e}return d(e,t),e.prototype.render=function(){var t=this;return o.a.createElement(a.a,null,o.a.createElement(s.a,null,o.a.createElement(i.a,{onClick:function(){return t.__showFormulaPanel()},disabled:this.disabled,icon:"formula",text:p()("公式")})))},Object.defineProperty(e.prototype,"disabled",{get:function(){var t=this.props,e=t.permission,n=t.selection;return!e.canEditRange||n.isLink||n.isCheckbox||n.hasPivotTableInRange&&!n.isPivotTableExcludedCell},enumerable:!0,configurable:!0}),e.prototype.__showFormulaPanel=function(){h(2,"18037"),this.props.emitter.emit(u.a.ShowFormulaPanel)},e}(c.a);e.a=_},94:function(t,e,n){var r=n(14),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():o.call(e,n,1),0))}},940:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(75),c=n(50),s=n(62),u=n(1),l=n.n(u),p=n(2),f=(n.n(p),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),d=p.sheets.track,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["isCheckbox","isDateMentionCell","isArrayComputedCell","isCSEFormulaCell","isPivotTableExcludedCell","hasCSEFormulaCellsInRange"],e}return f(e,t),e.prototype.render=function(){var t=this;return o.a.createElement(a.a,null,o.a.createElement(s.a,null,o.a.createElement(i.a,{onClick:function(){return t.__insertCheckbox()},disabled:this.disabled,icon:"checkbox",text:l()("复选框")})))},Object.defineProperty(e.prototype,"disabled",{get:function(){var t=this.props.selection;return!this.props.permission.canEditRange||t.isArrayComputedCell&&!t.isPivotTableExcludedCell||t.isDateMentionCell||t.isCSEFormulaCell||t.hasCSEFormulaCellsInRange},enumerable:!0,configurable:!0}),e.prototype.__insertCheckbox=function(){d(2,"18036"),this.props.editor.spread.getActiveSheet().insertCheckbox()},e}(c.a);e.a=h},941:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(1),c=n.n(a),s=n(62),u=n(452),l=n(50),p=n(2),f=(n.n(p),this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}()),d=p.sheets.track,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selectionUpdateKeys=["hideGridLine"],e.permissionUpdateKeys=["canEditSheet"],e}return f(e,t),e.prototype.render=function(){var t=this;return o.a.createElement(s.a,{disabled:this.disabled},o.a.createElement(i.a,{icon:"gridline",text:c()("网格线"),hasTapBtn:!0}),o.a.createElement(u.a,{checked:!this.hideGridLine,onChange:function(){return t.__toggleGridLine()}}))},Object.defineProperty(e.prototype,"disabled",{get:function(){return!this.props.permission.canEditSheet},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hideGridLine",{get:function(){return this.props.selection.hideGridLine},enumerable:!0,configurable:!0}),e.prototype.__toggleGridLine=function(){d(2,"18043");var t=this.props.editor,e=t.spread.getActiveSheet(),n=t.spread.getActiveSheet().gcSheet,r=!this.hideGridLine,o={fnName:"tableAttrs2Cs",params:[e.guid,{hideGridLine:r}]};return Object.assign(n.options.gridline,{showHorizontalGridline:!r,showVerticalGridline:!r}),n.repaint(),t.calcOperator({operator:[o],label:"gridLine"})},e}(l.a);e.a=h},942:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(62),c=n(452),s=n(323),u=n(2),l=(n.n(u),n(1)),p=n.n(l),f=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),d=u.sheets.Core.Spread.Sheets.Events.EditStarted,h=u.sheets.track,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.showStatisticPanel=!1,e.__toggleStatisticPanel=function(){h(2,"18044");var t=document.querySelector(".m-statistic-panel");t&&(t.style.bottom="315px",t.style.display=e.showStatisticPanel?"none":"flex",e.showStatisticPanel=!e.showStatisticPanel),e.forceUpdate()},e.__resetPanelPosition=function(t){var e=t.isShow,n=document.querySelector(".m-statistic-panel");n&&(n.style.bottom=e?"315px":"50px")},e}return f(e,t),e.prototype.componentDidMount=function(){var t=document.querySelector(".m-statistic-panel");t&&(this.showStatisticPanel="flex"===t.style.display,this.showStatisticPanel&&this.forceUpdate()),this.props.emitter.on(s.a.ToggleTabContent,this.__resetPanelPosition),this.props.editor.spread.gcSpread.bind(d,this.__resetPanelPosition.bind(this,!1))},e.prototype.render=function(){var t=this;return o.a.createElement(a.a,null,o.a.createElement(i.a,{onClick:this.__toggleStatisticPanel,icon:"statistic",text:p()("快捷计算"),hasTapBtn:!0}),o.a.createElement(c.a,{checked:this.showStatisticPanel,onChange:function(){return t.__toggleStatisticPanel()}}))},e}(o.a.Component);e.a=_},943:function(t,e,n){"use strict";var r=n(0),o=n.n(r),i=n(49),a=n(75),c=n(62),s=n(50),u=n(1),l=n.n(u),p=n(2),f=(n.n(p),n(323)),d=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=p.sheets.track,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.permissionUpdateKeys=["canReadSheet"],e.__onSearch=function(){h(2,"18041"),e.props.emitter.emit(f.a.HideToolbar),e.props.editor.emit(p.sheets.Events.ToggleSearch)},e}return d(e,t),e.prototype.render=function(){return o.a.createElement(a.a,null,o.a.createElement(c.a,null,o.a.createElement(i.a,{onClick:this.__onSearch,disabled:!this.props.permission.canReadSheet,icon:"search",text:l()("查找替换")})))},e}(s.a);e.a=_},95:function(t,e,n){var r=n(14);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},96:function(t,e,n){var r=n(14);t.exports=function(t){return r(this.__data__,t)>-1}},97:function(t,e,n){var r=n(14);t.exports=function(t,e){var n=this.__data__,o=r(n,t);return o<0?n.push([t,e]):n[o][1]=e,this}},98:function(t,e,n){var r=n(13);t.exports=function(){this.__data__=new r}},99:function(t,e){t.exports=function(t){return this.__data__.delete(t)}}})});